var T=Object.defineProperty;var D=(r,e,i)=>e in r?T(r,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):r[e]=i;var a=(r,e,i)=>(D(r,typeof e!="symbol"?e+"":e,i),i);import{l as f,p as V}from"./vendor.7b0d4df6.js";const I=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))s(t);new MutationObserver(t=>{for(const n of t)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function i(t){const n={};return t.integrity&&(n.integrity=t.integrity),t.referrerpolicy&&(n.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?n.credentials="include":t.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(t){if(t.ep)return;t.ep=!0;const n=i(t);fetch(t.href,n)}};I();function p(r,e,i,s){return Math.min(i/r,s/e)}class z{constructor(){a(this,"constraints",{audio:!1,video:{facingMode:"user"}});a(this,"video");a(this,"stream");a(this,"image_buffer");a(this,"canvas");a(this,"video_container");a(this,"constrainDimensions",(e,i)=>{});a(this,"getVideoTrack",()=>{var e,i;return(i=(e=this.stream)==null?void 0:e.getVideoTracks())==null?void 0:i[0]});a(this,"getCapabilities",()=>{var e;return(e=this.getVideoTrack())==null?void 0:e.getCapabilities()});a(this,"getMaxHeight",()=>{var e;return(e=this.getCapabilities())==null?void 0:e.height.max});a(this,"getMaxWidth",()=>{var e;return(e=this.getCapabilities())==null?void 0:e.width.max});a(this,"getMaxDimensions",()=>[this.getMaxWidth(),this.getMaxHeight()]);a(this,"getMaxDimensionsConstraints",()=>({width:this.getMaxWidth(),height:this.getMaxHeight()}));a(this,"getDimensions",()=>({width:this.getWidth(),height:this.getHeight()}));a(this,"getWidth",()=>{var e,i;return(i=(e=this.getVideoTrack())==null?void 0:e.getSettings())==null?void 0:i.width});a(this,"getHeight",()=>{var e,i;return(i=(e=this.getVideoTrack())==null?void 0:e.getSettings())==null?void 0:i.height});a(this,"grabFrame",()=>{var e;return((e=this.image_buffer)==null?void 0:e.grabFrame())||Promise.resolve(null)});a(this,"getSnapshot",()=>{var e;return((e=this.image_buffer)==null?void 0:e.takePhoto())||Promise.resolve(null)});a(this,"pixels",[[]]);a(this,"getPixels",()=>{let e=1,i=this.canvas.width*e,s=this.canvas.height*e,t=this.canvas.getContext("2d");return this.grabFrame().then(n=>(t.drawImage(n,0,0,i,s),t.getImageData(0,0,i,s))).then(n=>{let o=f.exports.chunk(f.exports.chunk(n.data,4),i);return o=o.map(h=>h.reverse()),this.pixels=o[0].map((h,l)=>o.map(c=>c[l])),this.pixels}).catch(n=>this.pixels)});a(this,"getPixels2",(e,i)=>{if(this.video){let s=this.video.offsetWidth,t=this.video.offsetHeight,n=100;this.canvas.width=s,this.canvas.height=t;let o=p(s,t,e,i);s*=o,t*=o;let h=p(s,t,n,n);s*=h,t*=h;let l=this.canvas.getContext("2d");l.drawImage(this.video,0,0,s,t);let c=l.getImageData(0,0,s,t),g=f.exports.chunk(f.exports.chunk(c.data,4),s);g=g.map(d=>d.reverse()),this.pixels=g[0].map((d,v)=>g.map(w=>w[v]))}return this.pixels});this.video_container=document.createElement("div"),this.canvas=document.createElement("canvas"),navigator.mediaDevices.getUserMedia(this.constraints).then(e=>{this.video=document.createElement("video"),this.video.playsInline=!0,this.video_container.append(this.video),this.video_container.style.position="absolute",this.video_container.style.visibility="hidden",this.video_container.style.height="0px",this.video_container.style.width="0px",this.video_container.style.overflow="hidden",document.body.append(this.video_container),this.stream=e,this.video.srcObject=e;try{this.image_buffer=new ImageCapture(this.getVideoTrack())}catch{}return this.video.onloadedmetadata=i=>{let s=this.getMaxDimensionsConstraints();return this.getVideoTrack().applyConstraints(s),this.canvas.width=s.width,this.canvas.height=s.height,this.video.play()}}).catch(function(e){console.log("uh it didnt work"),alert(e)})}}const x='@W\xD1$9806532ba4c7?1=~"-;:,.   ',L=1.5;document.createElement("canvas");let y,S=!0;const N=()=>{y=new z},O=r=>{let e;document.body.style.backgroundColor="black",r.setup=()=>{let t=window.innerWidth,n=window.innerHeight;e=r.createCanvas(t,n),N()};function i(){}window.addEventListener("resize",i),r.draw=()=>{if(y&&S){let[h,l]=[document.body.offsetWidth,document.body.offsetHeight];console.log("setting canvas to "+h+","+l),r.resizeCanvas(h,l),r.clear(0,0,0,255);let c=y.getPixels2(h,l);s(r,c)}let t=window.innerWidth/2,n=window.innerHeight/2,o=[(window.innerWidth-t)/2,(window.innerHeight-n)/2];r.translate(...o)};function s(t,n){t.resetMatrix(),t.clear(0,0,0,255),t.background(0),t.fill(255,255,255);let o=n.length,h=n[0].length,l=p(o,h,e.width,e.height),c=o*l,g=h*l,d=Math.min(c/o,g/h),v=(e.width-d*o)/2,w=(e.height-d*h)/2;for(let u=0;u<o;u++)for(let m=0;m<h;m++){let[_,k,C,F]=n[u][m],M=Math.floor((_+k+C)/3);t.noStroke();let W=u*d+v,E=m*d+w,H=L*d;t.textSize(H),t.textAlign(t.CENTER,t.CENTER);let P=x.length,b;b=x.length-Math.floor(M/255*P),t.text(x[b],W+d*.5,E+d*.5)}}};new V(O,document.body);document.body.onclick=()=>{};
