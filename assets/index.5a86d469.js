var $6=Object.defineProperty;var N6=(r,e,t)=>e in r?$6(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var Er=(r,e,t)=>(N6(r,typeof e!="symbol"?e+"":e,t),t);function A6(r,e){return e.forEach(function(t){t&&typeof t!="string"&&!Array.isArray(t)&&Object.keys(t).forEach(function(n){if(n!=="default"&&!(n in r)){var s=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(r,n,s.get?s:{enumerable:!0,get:function(){return t[n]}})}})}),Object.freeze(r)}const R6=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function t(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerpolicy&&(o.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?o.credentials="include":s.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(s){if(s.ep)return;s.ep=!0;const o=t(s);fetch(s.href,o)}};R6();var Pr=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function D6(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function ug(r){throw new Error('Could not dynamically require "'+r+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var fC={exports:{}};/*! p5.js v1.4.1 February 02, 2022 */(function(r,e){(function(t){r.exports=t()})(function(){var t;return function n(s,o,a){function i(h,d){if(!o[h]){if(!s[h]){var c=typeof ug=="function"&&ug;if(!d&&c)return c(h,!0);if(l)return l(h,!0);var f=new Error("Cannot find module '"+h+"'");throw f.code="MODULE_NOT_FOUND",f}var p=o[h]={exports:{}};s[h][0].call(p.exports,function(m){return i(s[h][1][m]||m)},p,p.exports,n,s,o,a)}return o[h].exports}for(var l=typeof ug=="function"&&ug,u=0;u<a.length;u++)i(a[u]);return i}({1:[function(n,s,o){o.byteLength=function(p){var m=c(p),g=m[0],y=m[1];return 3*(g+y)/4-y},o.toByteArray=function(p){var m,g,y=c(p),v=y[0],b=y[1],w=new l(function(C,N){return 3*(C+N)/4-N}(v,b)),_=0,I=0<b?v-4:v;for(g=0;g<I;g+=4)m=i[p.charCodeAt(g)]<<18|i[p.charCodeAt(g+1)]<<12|i[p.charCodeAt(g+2)]<<6|i[p.charCodeAt(g+3)],w[_++]=m>>16&255,w[_++]=m>>8&255,w[_++]=255&m;return b===2&&(m=i[p.charCodeAt(g)]<<2|i[p.charCodeAt(g+1)]>>4,w[_++]=255&m),b===1&&(m=i[p.charCodeAt(g)]<<10|i[p.charCodeAt(g+1)]<<4|i[p.charCodeAt(g+2)]>>2,w[_++]=m>>8&255,w[_++]=255&m),w},o.fromByteArray=function(p){for(var m,g=p.length,y=g%3,v=[],b=0,w=g-y;b<w;b+=16383)v.push(f(p,b,w<b+16383?w:b+16383));return y==1?(m=p[g-1],v.push(a[m>>2]+a[m<<4&63]+"==")):y==2&&(m=(p[g-2]<<8)+p[g-1],v.push(a[m>>10]+a[m>>4&63]+a[m<<2&63]+"=")),v.join("")};for(var a=[],i=[],l=typeof Uint8Array!="undefined"?Uint8Array:Array,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",h=0,d=u.length;h<d;++h)a[h]=u[h],i[u.charCodeAt(h)]=h;function c(p){var m=p.length;if(0<m%4)throw new Error("Invalid string. Length must be a multiple of 4");var g=p.indexOf("=");return g===-1&&(g=m),[g,g===m?0:4-g%4]}function f(p,m,g){for(var y,v,b=[],w=m;w<g;w+=3)y=(p[w]<<16&16711680)+(p[w+1]<<8&65280)+(255&p[w+2]),b.push(a[(v=y)>>18&63]+a[v>>12&63]+a[v>>6&63]+a[63&v]);return b.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},{}],2:[function(n,s,o){},{}],3:[function(n,s,o){arguments[4][2][0].apply(o,arguments)},{dup:2}],4:[function(n,s,o){(function(c){var i=n("base64-js"),l=n("ieee754"),u=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;o.Buffer=c,o.SlowBuffer=function(j){return+j!=j&&(j=0),c.alloc(+j)},o.INSPECT_MAX_BYTES=50;var h=2147483647;function d(j){if(h<j)throw new RangeError('The value "'+j+'" is invalid for option "size"');var W=new Uint8Array(j);return Object.setPrototypeOf(W,c.prototype),W}function c(j,W,J){if(typeof j!="number")return f(j,W,J);if(typeof W=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return m(j)}function f(j,W,J){if(typeof j=="string")return function(he,Fe){if(typeof Fe=="string"&&Fe!==""||(Fe="utf8"),!c.isEncoding(Fe))throw new TypeError("Unknown encoding: "+Fe);var me=0|v(he,Fe),Le=d(me),De=Le.write(he,Fe);return De!==me&&(Le=Le.slice(0,De)),Le}(j,W);if(ArrayBuffer.isView(j))return g(j);if(j==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof j);if(Oe(j,ArrayBuffer)||j&&Oe(j.buffer,ArrayBuffer))return function(he,Fe,me){if(Fe<0||he.byteLength<Fe)throw new RangeError('"offset" is outside of buffer bounds');if(he.byteLength<Fe+(me||0))throw new RangeError('"length" is outside of buffer bounds');var Le;return Le=Fe===void 0&&me===void 0?new Uint8Array(he):me===void 0?new Uint8Array(he,Fe):new Uint8Array(he,Fe,me),Object.setPrototypeOf(Le,c.prototype),Le}(j,W,J);if(typeof j=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var ie=j.valueOf&&j.valueOf();if(ie!=null&&ie!==j)return c.from(ie,W,J);var ve=function(he){if(c.isBuffer(he)){var Fe=0|y(he.length),me=d(Fe);return me.length===0||he.copy(me,0,0,Fe),me}if(he.length!==void 0)return typeof he.length!="number"||Se(he.length)?d(0):g(he);if(he.type==="Buffer"&&Array.isArray(he.data))return g(he.data)}(j);if(ve)return ve;if(typeof Symbol!="undefined"&&Symbol.toPrimitive!=null&&typeof j[Symbol.toPrimitive]=="function")return c.from(j[Symbol.toPrimitive]("string"),W,J);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof j)}function p(j){if(typeof j!="number")throw new TypeError('"size" argument must be of type number');if(j<0)throw new RangeError('The value "'+j+'" is invalid for option "size"')}function m(j){return p(j),d(j<0?0:0|y(j))}function g(j){for(var W=j.length<0?0:0|y(j.length),J=d(W),ie=0;ie<W;ie+=1)J[ie]=255&j[ie];return J}function y(j){if(h<=j)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+h.toString(16)+" bytes");return 0|j}function v(j,W){if(c.isBuffer(j))return j.length;if(ArrayBuffer.isView(j)||Oe(j,ArrayBuffer))return j.byteLength;if(typeof j!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof j);var J=j.length,ie=2<arguments.length&&arguments[2]===!0;if(!ie&&J===0)return 0;for(var ve=!1;;)switch(W){case"ascii":case"latin1":case"binary":return J;case"utf8":case"utf-8":return be(j).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*J;case"hex":return J>>>1;case"base64":return we(j).length;default:if(ve)return ie?-1:be(j).length;W=(""+W).toLowerCase(),ve=!0}}function b(j,W,J){var ie=j[W];j[W]=j[J],j[J]=ie}function w(j,W,J,ie,ve){if(j.length===0)return-1;if(typeof J=="string"?(ie=J,J=0):2147483647<J?J=2147483647:J<-2147483648&&(J=-2147483648),Se(J=+J)&&(J=ve?0:j.length-1),J<0&&(J=j.length+J),J>=j.length){if(ve)return-1;J=j.length-1}else if(J<0){if(!ve)return-1;J=0}if(typeof W=="string"&&(W=c.from(W,ie)),c.isBuffer(W))return W.length===0?-1:_(j,W,J,ie,ve);if(typeof W=="number")return W&=255,typeof Uint8Array.prototype.indexOf=="function"?ve?Uint8Array.prototype.indexOf.call(j,W,J):Uint8Array.prototype.lastIndexOf.call(j,W,J):_(j,[W],J,ie,ve);throw new TypeError("val must be string, number or Buffer")}function _(j,W,J,ie,ve){var he,Fe=1,me=j.length,Le=W.length;if(ie!==void 0&&((ie=String(ie).toLowerCase())==="ucs2"||ie==="ucs-2"||ie==="utf16le"||ie==="utf-16le")){if(j.length<2||W.length<2)return-1;me/=Fe=2,Le/=2,J/=2}function De(Je,xt){return Fe===1?Je[xt]:Je.readUInt16BE(xt*Fe)}if(ve){var Ne=-1;for(he=J;he<me;he++)if(De(j,he)===De(W,Ne===-1?0:he-Ne)){if(Ne===-1&&(Ne=he),he-Ne+1===Le)return Ne*Fe}else Ne!==-1&&(he-=he-Ne),Ne=-1}else for(me<J+Le&&(J=me-Le),he=J;0<=he;he--){for(var rt=!0,tt=0;tt<Le;tt++)if(De(j,he+tt)!==De(W,tt)){rt=!1;break}if(rt)return he}return-1}function I(j,W,J,ie){J=Number(J)||0;var ve=j.length-J;ie?ve<(ie=Number(ie))&&(ie=ve):ie=ve;var he=W.length;he/2<ie&&(ie=he/2);for(var Fe=0;Fe<ie;++Fe){var me=parseInt(W.substr(2*Fe,2),16);if(Se(me))return Fe;j[J+Fe]=me}return Fe}function C(j,W,J,ie){return ye(function(ve){for(var he=[],Fe=0;Fe<ve.length;++Fe)he.push(255&ve.charCodeAt(Fe));return he}(W),j,J,ie)}function N(j,W,J,ie){return ye(function(ve,he){for(var Fe,me,Le,De=[],Ne=0;Ne<ve.length&&!((he-=2)<0);++Ne)Fe=ve.charCodeAt(Ne),me=Fe>>8,Le=Fe%256,De.push(Le),De.push(me);return De}(W,j.length-J),j,J,ie)}function O(j,W,J){return W===0&&J===j.length?i.fromByteArray(j):i.fromByteArray(j.slice(W,J))}function D(j,W,J){J=Math.min(j.length,J);for(var ie=[],ve=W;ve<J;){var he,Fe,me,Le,De=j[ve],Ne=null,rt=239<De?4:223<De?3:191<De?2:1;if(ve+rt<=J)switch(rt){case 1:De<128&&(Ne=De);break;case 2:(192&(he=j[ve+1]))==128&&127<(Le=(31&De)<<6|63&he)&&(Ne=Le);break;case 3:he=j[ve+1],Fe=j[ve+2],(192&he)==128&&(192&Fe)==128&&2047<(Le=(15&De)<<12|(63&he)<<6|63&Fe)&&(Le<55296||57343<Le)&&(Ne=Le);break;case 4:he=j[ve+1],Fe=j[ve+2],me=j[ve+3],(192&he)==128&&(192&Fe)==128&&(192&me)==128&&65535<(Le=(15&De)<<18|(63&he)<<12|(63&Fe)<<6|63&me)&&Le<1114112&&(Ne=Le)}Ne===null?(Ne=65533,rt=1):65535<Ne&&(Ne-=65536,ie.push(Ne>>>10&1023|55296),Ne=56320|1023&Ne),ie.push(Ne),ve+=rt}return function(tt){var Je=tt.length;if(Je<=M)return String.fromCharCode.apply(String,tt);for(var xt="",Pt=0;Pt<Je;)xt+=String.fromCharCode.apply(String,tt.slice(Pt,Pt+=M));return xt}(ie)}o.kMaxLength=h,(c.TYPED_ARRAY_SUPPORT=function(){try{var j=new Uint8Array(1),W={foo:function(){return 42}};return Object.setPrototypeOf(W,Uint8Array.prototype),Object.setPrototypeOf(j,W),j.foo()===42}catch{return!1}}())||typeof console=="undefined"||typeof console.error!="function"||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(c.prototype,"parent",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.buffer}}),Object.defineProperty(c.prototype,"offset",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.byteOffset}}),typeof Symbol!="undefined"&&Symbol.species!=null&&c[Symbol.species]===c&&Object.defineProperty(c,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),c.poolSize=8192,c.from=function(j,W,J){return f(j,W,J)},Object.setPrototypeOf(c.prototype,Uint8Array.prototype),Object.setPrototypeOf(c,Uint8Array),c.alloc=function(j,W,J){return ve=W,he=J,p(ie=j),ie<=0?d(ie):ve!==void 0?typeof he=="string"?d(ie).fill(ve,he):d(ie).fill(ve):d(ie);var ie,ve,he},c.allocUnsafe=function(j){return m(j)},c.allocUnsafeSlow=function(j){return m(j)},c.isBuffer=function(j){return j!=null&&j._isBuffer===!0&&j!==c.prototype},c.compare=function(j,W){if(Oe(j,Uint8Array)&&(j=c.from(j,j.offset,j.byteLength)),Oe(W,Uint8Array)&&(W=c.from(W,W.offset,W.byteLength)),!c.isBuffer(j)||!c.isBuffer(W))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(j===W)return 0;for(var J=j.length,ie=W.length,ve=0,he=Math.min(J,ie);ve<he;++ve)if(j[ve]!==W[ve]){J=j[ve],ie=W[ve];break}return J<ie?-1:ie<J?1:0},c.isEncoding=function(j){switch(String(j).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(j,W){if(!Array.isArray(j))throw new TypeError('"list" argument must be an Array of Buffers');if(j.length===0)return c.alloc(0);var J;if(W===void 0)for(J=W=0;J<j.length;++J)W+=j[J].length;var ie=c.allocUnsafe(W),ve=0;for(J=0;J<j.length;++J){var he=j[J];if(Oe(he,Uint8Array)&&(he=c.from(he)),!c.isBuffer(he))throw new TypeError('"list" argument must be an Array of Buffers');he.copy(ie,ve),ve+=he.length}return ie},c.byteLength=v,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var j=this.length;if(j%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var W=0;W<j;W+=2)b(this,W,W+1);return this},c.prototype.swap32=function(){var j=this.length;if(j%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var W=0;W<j;W+=4)b(this,W,W+3),b(this,W+1,W+2);return this},c.prototype.swap64=function(){var j=this.length;if(j%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var W=0;W<j;W+=8)b(this,W,W+7),b(this,W+1,W+6),b(this,W+2,W+5),b(this,W+3,W+4);return this},c.prototype.toLocaleString=c.prototype.toString=function(){var j=this.length;return j===0?"":arguments.length===0?D(this,0,j):function(W,J,ie){var ve=!1;if((J===void 0||J<0)&&(J=0),J>this.length||((ie===void 0||ie>this.length)&&(ie=this.length),ie<=0)||(ie>>>=0)<=(J>>>=0))return"";for(W=W||"utf8";;)switch(W){case"hex":return B(this,J,ie);case"utf8":case"utf-8":return D(this,J,ie);case"ascii":return P(this,J,ie);case"latin1":case"binary":return F(this,J,ie);case"base64":return O(this,J,ie);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return z(this,J,ie);default:if(ve)throw new TypeError("Unknown encoding: "+W);W=(W+"").toLowerCase(),ve=!0}}.apply(this,arguments)},c.prototype.equals=function(j){if(!c.isBuffer(j))throw new TypeError("Argument must be a Buffer");return this===j||c.compare(this,j)===0},c.prototype.inspect=function(){var j="",W=o.INSPECT_MAX_BYTES;return j=this.toString("hex",0,W).replace(/(.{2})/g,"$1 ").trim(),this.length>W&&(j+=" ... "),"<Buffer "+j+">"},u&&(c.prototype[u]=c.prototype.inspect),c.prototype.compare=function(j,W,J,ie,ve){if(Oe(j,Uint8Array)&&(j=c.from(j,j.offset,j.byteLength)),!c.isBuffer(j))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof j);if(W===void 0&&(W=0),J===void 0&&(J=j?j.length:0),ie===void 0&&(ie=0),ve===void 0&&(ve=this.length),W<0||J>j.length||ie<0||ve>this.length)throw new RangeError("out of range index");if(ve<=ie&&J<=W)return 0;if(ve<=ie)return-1;if(J<=W)return 1;if(this===j)return 0;for(var he=(ve>>>=0)-(ie>>>=0),Fe=(J>>>=0)-(W>>>=0),me=Math.min(he,Fe),Le=this.slice(ie,ve),De=j.slice(W,J),Ne=0;Ne<me;++Ne)if(Le[Ne]!==De[Ne]){he=Le[Ne],Fe=De[Ne];break}return he<Fe?-1:Fe<he?1:0},c.prototype.includes=function(j,W,J){return this.indexOf(j,W,J)!==-1},c.prototype.indexOf=function(j,W,J){return w(this,j,W,J,!0)},c.prototype.lastIndexOf=function(j,W,J){return w(this,j,W,J,!1)},c.prototype.write=function(j,W,J,ie){if(W===void 0)ie="utf8",J=this.length,W=0;else if(J===void 0&&typeof W=="string")ie=W,J=this.length,W=0;else{if(!isFinite(W))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");W>>>=0,isFinite(J)?(J>>>=0,ie===void 0&&(ie="utf8")):(ie=J,J=void 0)}var ve=this.length-W;if((J===void 0||ve<J)&&(J=ve),0<j.length&&(J<0||W<0)||W>this.length)throw new RangeError("Attempt to write outside buffer bounds");ie=ie||"utf8";for(var he,Fe,me,Le,De,Ne,rt=!1;;)switch(ie){case"hex":return I(this,j,W,J);case"utf8":case"utf-8":return De=W,Ne=J,ye(be(j,(Le=this).length-De),Le,De,Ne);case"ascii":return C(this,j,W,J);case"latin1":case"binary":return C(this,j,W,J);case"base64":return he=this,Fe=W,me=J,ye(we(j),he,Fe,me);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return N(this,j,W,J);default:if(rt)throw new TypeError("Unknown encoding: "+ie);ie=(""+ie).toLowerCase(),rt=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var M=4096;function P(j,W,J){var ie="";J=Math.min(j.length,J);for(var ve=W;ve<J;++ve)ie+=String.fromCharCode(127&j[ve]);return ie}function F(j,W,J){var ie="";J=Math.min(j.length,J);for(var ve=W;ve<J;++ve)ie+=String.fromCharCode(j[ve]);return ie}function B(j,W,J){var ie=j.length;(!W||W<0)&&(W=0),(!J||J<0||ie<J)&&(J=ie);for(var ve="",he=W;he<J;++he)ve+=Ee[j[he]];return ve}function z(j,W,J){for(var ie=j.slice(W,J),ve="",he=0;he<ie.length;he+=2)ve+=String.fromCharCode(ie[he]+256*ie[he+1]);return ve}function Z(j,W,J){if(j%1!=0||j<0)throw new RangeError("offset is not uint");if(J<j+W)throw new RangeError("Trying to access beyond buffer length")}function Q(j,W,J,ie,ve,he){if(!c.isBuffer(j))throw new TypeError('"buffer" argument must be a Buffer instance');if(ve<W||W<he)throw new RangeError('"value" argument is out of bounds');if(J+ie>j.length)throw new RangeError("Index out of range")}function K(j,W,J,ie){if(J+ie>j.length)throw new RangeError("Index out of range");if(J<0)throw new RangeError("Index out of range")}function ne(j,W,J,ie,ve){return W=+W,J>>>=0,ve||K(j,0,J,4),l.write(j,W,J,ie,23,4),J+4}function re(j,W,J,ie,ve){return W=+W,J>>>=0,ve||K(j,0,J,8),l.write(j,W,J,ie,52,8),J+8}c.prototype.slice=function(j,W){var J=this.length;(j=~~j)<0?(j+=J)<0&&(j=0):J<j&&(j=J),(W=W===void 0?J:~~W)<0?(W+=J)<0&&(W=0):J<W&&(W=J),W<j&&(W=j);var ie=this.subarray(j,W);return Object.setPrototypeOf(ie,c.prototype),ie},c.prototype.readUIntLE=function(j,W,J){j>>>=0,W>>>=0,J||Z(j,W,this.length);for(var ie=this[j],ve=1,he=0;++he<W&&(ve*=256);)ie+=this[j+he]*ve;return ie},c.prototype.readUIntBE=function(j,W,J){j>>>=0,W>>>=0,J||Z(j,W,this.length);for(var ie=this[j+--W],ve=1;0<W&&(ve*=256);)ie+=this[j+--W]*ve;return ie},c.prototype.readUInt8=function(j,W){return j>>>=0,W||Z(j,1,this.length),this[j]},c.prototype.readUInt16LE=function(j,W){return j>>>=0,W||Z(j,2,this.length),this[j]|this[j+1]<<8},c.prototype.readUInt16BE=function(j,W){return j>>>=0,W||Z(j,2,this.length),this[j]<<8|this[j+1]},c.prototype.readUInt32LE=function(j,W){return j>>>=0,W||Z(j,4,this.length),(this[j]|this[j+1]<<8|this[j+2]<<16)+16777216*this[j+3]},c.prototype.readUInt32BE=function(j,W){return j>>>=0,W||Z(j,4,this.length),16777216*this[j]+(this[j+1]<<16|this[j+2]<<8|this[j+3])},c.prototype.readIntLE=function(j,W,J){j>>>=0,W>>>=0,J||Z(j,W,this.length);for(var ie=this[j],ve=1,he=0;++he<W&&(ve*=256);)ie+=this[j+he]*ve;return(ve*=128)<=ie&&(ie-=Math.pow(2,8*W)),ie},c.prototype.readIntBE=function(j,W,J){j>>>=0,W>>>=0,J||Z(j,W,this.length);for(var ie=W,ve=1,he=this[j+--ie];0<ie&&(ve*=256);)he+=this[j+--ie]*ve;return(ve*=128)<=he&&(he-=Math.pow(2,8*W)),he},c.prototype.readInt8=function(j,W){return j>>>=0,W||Z(j,1,this.length),128&this[j]?-1*(255-this[j]+1):this[j]},c.prototype.readInt16LE=function(j,W){j>>>=0,W||Z(j,2,this.length);var J=this[j]|this[j+1]<<8;return 32768&J?4294901760|J:J},c.prototype.readInt16BE=function(j,W){j>>>=0,W||Z(j,2,this.length);var J=this[j+1]|this[j]<<8;return 32768&J?4294901760|J:J},c.prototype.readInt32LE=function(j,W){return j>>>=0,W||Z(j,4,this.length),this[j]|this[j+1]<<8|this[j+2]<<16|this[j+3]<<24},c.prototype.readInt32BE=function(j,W){return j>>>=0,W||Z(j,4,this.length),this[j]<<24|this[j+1]<<16|this[j+2]<<8|this[j+3]},c.prototype.readFloatLE=function(j,W){return j>>>=0,W||Z(j,4,this.length),l.read(this,j,!0,23,4)},c.prototype.readFloatBE=function(j,W){return j>>>=0,W||Z(j,4,this.length),l.read(this,j,!1,23,4)},c.prototype.readDoubleLE=function(j,W){return j>>>=0,W||Z(j,8,this.length),l.read(this,j,!0,52,8)},c.prototype.readDoubleBE=function(j,W){return j>>>=0,W||Z(j,8,this.length),l.read(this,j,!1,52,8)},c.prototype.writeUIntLE=function(j,W,J,ie){j=+j,W>>>=0,J>>>=0,ie||Q(this,j,W,J,Math.pow(2,8*J)-1,0);var ve=1,he=0;for(this[W]=255&j;++he<J&&(ve*=256);)this[W+he]=j/ve&255;return W+J},c.prototype.writeUIntBE=function(j,W,J,ie){j=+j,W>>>=0,J>>>=0,ie||Q(this,j,W,J,Math.pow(2,8*J)-1,0);var ve=J-1,he=1;for(this[W+ve]=255&j;0<=--ve&&(he*=256);)this[W+ve]=j/he&255;return W+J},c.prototype.writeUInt8=function(j,W,J){return j=+j,W>>>=0,J||Q(this,j,W,1,255,0),this[W]=255&j,W+1},c.prototype.writeUInt16LE=function(j,W,J){return j=+j,W>>>=0,J||Q(this,j,W,2,65535,0),this[W]=255&j,this[W+1]=j>>>8,W+2},c.prototype.writeUInt16BE=function(j,W,J){return j=+j,W>>>=0,J||Q(this,j,W,2,65535,0),this[W]=j>>>8,this[W+1]=255&j,W+2},c.prototype.writeUInt32LE=function(j,W,J){return j=+j,W>>>=0,J||Q(this,j,W,4,4294967295,0),this[W+3]=j>>>24,this[W+2]=j>>>16,this[W+1]=j>>>8,this[W]=255&j,W+4},c.prototype.writeUInt32BE=function(j,W,J){return j=+j,W>>>=0,J||Q(this,j,W,4,4294967295,0),this[W]=j>>>24,this[W+1]=j>>>16,this[W+2]=j>>>8,this[W+3]=255&j,W+4},c.prototype.writeIntLE=function(j,W,J,ie){if(j=+j,W>>>=0,!ie){var ve=Math.pow(2,8*J-1);Q(this,j,W,J,ve-1,-ve)}var he=0,Fe=1,me=0;for(this[W]=255&j;++he<J&&(Fe*=256);)j<0&&me===0&&this[W+he-1]!==0&&(me=1),this[W+he]=(j/Fe>>0)-me&255;return W+J},c.prototype.writeIntBE=function(j,W,J,ie){if(j=+j,W>>>=0,!ie){var ve=Math.pow(2,8*J-1);Q(this,j,W,J,ve-1,-ve)}var he=J-1,Fe=1,me=0;for(this[W+he]=255&j;0<=--he&&(Fe*=256);)j<0&&me===0&&this[W+he+1]!==0&&(me=1),this[W+he]=(j/Fe>>0)-me&255;return W+J},c.prototype.writeInt8=function(j,W,J){return j=+j,W>>>=0,J||Q(this,j,W,1,127,-128),j<0&&(j=255+j+1),this[W]=255&j,W+1},c.prototype.writeInt16LE=function(j,W,J){return j=+j,W>>>=0,J||Q(this,j,W,2,32767,-32768),this[W]=255&j,this[W+1]=j>>>8,W+2},c.prototype.writeInt16BE=function(j,W,J){return j=+j,W>>>=0,J||Q(this,j,W,2,32767,-32768),this[W]=j>>>8,this[W+1]=255&j,W+2},c.prototype.writeInt32LE=function(j,W,J){return j=+j,W>>>=0,J||Q(this,j,W,4,2147483647,-2147483648),this[W]=255&j,this[W+1]=j>>>8,this[W+2]=j>>>16,this[W+3]=j>>>24,W+4},c.prototype.writeInt32BE=function(j,W,J){return j=+j,W>>>=0,J||Q(this,j,W,4,2147483647,-2147483648),j<0&&(j=4294967295+j+1),this[W]=j>>>24,this[W+1]=j>>>16,this[W+2]=j>>>8,this[W+3]=255&j,W+4},c.prototype.writeFloatLE=function(j,W,J){return ne(this,j,W,!0,J)},c.prototype.writeFloatBE=function(j,W,J){return ne(this,j,W,!1,J)},c.prototype.writeDoubleLE=function(j,W,J){return re(this,j,W,!0,J)},c.prototype.writeDoubleBE=function(j,W,J){return re(this,j,W,!1,J)},c.prototype.copy=function(j,W,J,ie){if(!c.isBuffer(j))throw new TypeError("argument should be a Buffer");if(J=J||0,ie||ie===0||(ie=this.length),W>=j.length&&(W=j.length),W=W||0,0<ie&&ie<J&&(ie=J),ie===J||j.length===0||this.length===0)return 0;if(W<0)throw new RangeError("targetStart out of bounds");if(J<0||J>=this.length)throw new RangeError("Index out of range");if(ie<0)throw new RangeError("sourceEnd out of bounds");ie>this.length&&(ie=this.length),j.length-W<ie-J&&(ie=j.length-W+J);var ve=ie-J;if(this===j&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(W,J,ie);else if(this===j&&J<W&&W<ie)for(var he=ve-1;0<=he;--he)j[he+W]=this[he+J];else Uint8Array.prototype.set.call(j,this.subarray(J,ie),W);return ve},c.prototype.fill=function(j,W,J,ie){if(typeof j=="string"){if(typeof W=="string"?(ie=W,W=0,J=this.length):typeof J=="string"&&(ie=J,J=this.length),ie!==void 0&&typeof ie!="string")throw new TypeError("encoding must be a string");if(typeof ie=="string"&&!c.isEncoding(ie))throw new TypeError("Unknown encoding: "+ie);if(j.length===1){var ve=j.charCodeAt(0);(ie==="utf8"&&ve<128||ie==="latin1")&&(j=ve)}}else typeof j=="number"?j&=255:typeof j=="boolean"&&(j=Number(j));if(W<0||this.length<W||this.length<J)throw new RangeError("Out of range index");if(J<=W)return this;var he;if(W>>>=0,J=J===void 0?this.length:J>>>0,typeof(j=j||0)=="number")for(he=W;he<J;++he)this[he]=j;else{var Fe=c.isBuffer(j)?j:c.from(j,ie),me=Fe.length;if(me===0)throw new TypeError('The value "'+j+'" is invalid for argument "value"');for(he=0;he<J-W;++he)this[he+W]=Fe[he%me]}return this};var ce=/[^+/0-9A-Za-z-_]/g;function be(j,W){var J;W=W||1/0;for(var ie=j.length,ve=null,he=[],Fe=0;Fe<ie;++Fe){if(55295<(J=j.charCodeAt(Fe))&&J<57344){if(!ve){if(56319<J){-1<(W-=3)&&he.push(239,191,189);continue}if(Fe+1===ie){-1<(W-=3)&&he.push(239,191,189);continue}ve=J;continue}if(J<56320){-1<(W-=3)&&he.push(239,191,189),ve=J;continue}J=65536+(ve-55296<<10|J-56320)}else ve&&-1<(W-=3)&&he.push(239,191,189);if(ve=null,J<128){if(--W<0)break;he.push(J)}else if(J<2048){if((W-=2)<0)break;he.push(J>>6|192,63&J|128)}else if(J<65536){if((W-=3)<0)break;he.push(J>>12|224,J>>6&63|128,63&J|128)}else{if(!(J<1114112))throw new Error("Invalid code point");if((W-=4)<0)break;he.push(J>>18|240,J>>12&63|128,J>>6&63|128,63&J|128)}}return he}function we(j){return i.toByteArray(function(W){if((W=(W=W.split("=")[0]).trim().replace(ce,"")).length<2)return"";for(;W.length%4!=0;)W+="=";return W}(j))}function ye(j,W,J,ie){for(var ve=0;ve<ie&&!(ve+J>=W.length||ve>=j.length);++ve)W[ve+J]=j[ve];return ve}function Oe(j,W){return j instanceof W||j!=null&&j.constructor!=null&&j.constructor.name!=null&&j.constructor.name===W.name}function Se(j){return j!=j}var Ee=function(){for(var j="0123456789abcdef",W=new Array(256),J=0;J<16;++J)for(var ie=16*J,ve=0;ve<16;++ve)W[ie+ve]=j[J]+j[ve];return W}()}).call(this,n("buffer").Buffer)},{"base64-js":1,buffer:4,ieee754:236}],5:[function(n,s,o){s.exports=function(a){if(typeof a!="function")throw TypeError(String(a)+" is not a function");return a}},{}],6:[function(n,s,o){var a=n("../internals/is-object");s.exports=function(i){if(!a(i)&&i!==null)throw TypeError("Can't set "+String(i)+" as a prototype");return i}},{"../internals/is-object":74}],7:[function(n,s,o){var a=n("../internals/well-known-symbol"),i=n("../internals/object-create"),l=n("../internals/object-define-property"),u=a("unscopables"),h=Array.prototype;h[u]==null&&l.f(h,u,{configurable:!0,value:i(null)}),s.exports=function(d){h[u][d]=!0}},{"../internals/object-create":90,"../internals/object-define-property":92,"../internals/well-known-symbol":146}],8:[function(n,s,o){var a=n("../internals/string-multibyte").charAt;s.exports=function(i,l,u){return l+(u?a(i,l).length:1)}},{"../internals/string-multibyte":123}],9:[function(n,s,o){s.exports=function(a,i,l){if(!(a instanceof i))throw TypeError("Incorrect "+(l?l+" ":"")+"invocation");return a}},{}],10:[function(n,s,o){var a=n("../internals/is-object");s.exports=function(i){if(!a(i))throw TypeError(String(i)+" is not an object");return i}},{"../internals/is-object":74}],11:[function(n,s,o){s.exports=typeof ArrayBuffer!="undefined"&&typeof DataView!="undefined"},{}],12:[function(n,s,o){function a(K){return d(K)&&c(Q,f(K))}var i,l=n("../internals/array-buffer-native"),u=n("../internals/descriptors"),h=n("../internals/global"),d=n("../internals/is-object"),c=n("../internals/has"),f=n("../internals/classof"),p=n("../internals/create-non-enumerable-property"),m=n("../internals/redefine"),g=n("../internals/object-define-property").f,y=n("../internals/object-get-prototype-of"),v=n("../internals/object-set-prototype-of"),b=n("../internals/well-known-symbol"),w=n("../internals/uid"),_=h.Int8Array,I=_&&_.prototype,C=h.Uint8ClampedArray,N=C&&C.prototype,O=_&&y(_),D=I&&y(I),M=Object.prototype,P=M.isPrototypeOf,F=b("toStringTag"),B=w("TYPED_ARRAY_TAG"),z=l&&!!v&&f(h.opera)!=="Opera",Z=!1,Q={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8};for(i in Q)h[i]||(z=!1);if((!z||typeof O!="function"||O===Function.prototype)&&(O=function(){throw TypeError("Incorrect invocation")},z))for(i in Q)h[i]&&v(h[i],O);if((!z||!D||D===M)&&(D=O.prototype,z))for(i in Q)h[i]&&v(h[i].prototype,D);if(z&&y(N)!==D&&v(N,D),u&&!c(D,F))for(i in Z=!0,g(D,F,{get:function(){return d(this)?this[B]:void 0}}),Q)h[i]&&p(h[i],B,i);s.exports={NATIVE_ARRAY_BUFFER_VIEWS:z,TYPED_ARRAY_TAG:Z&&B,aTypedArray:function(K){if(a(K))return K;throw TypeError("Target is not a typed array")},aTypedArrayConstructor:function(K){if(v){if(P.call(O,K))return K}else for(var ne in Q)if(c(Q,i)){var re=h[ne];if(re&&(K===re||P.call(re,K)))return K}throw TypeError("Target is not a typed array constructor")},exportTypedArrayMethod:function(K,ne,re){if(u){if(re)for(var ce in Q){var be=h[ce];be&&c(be.prototype,K)&&delete be.prototype[K]}D[K]&&!re||m(D,K,re?ne:z&&I[K]||ne)}},exportTypedArrayStaticMethod:function(K,ne,re){var ce,be;if(u){if(v){if(re)for(ce in Q)(be=h[ce])&&c(be,K)&&delete be[K];if(O[K]&&!re)return;try{return m(O,K,re?ne:z&&_[K]||ne)}catch{}}for(ce in Q)!(be=h[ce])||be[K]&&!re||m(be,K,ne)}},isView:function(K){var ne=f(K);return ne==="DataView"||c(Q,ne)},isTypedArray:a,TypedArray:O,TypedArrayPrototype:D}},{"../internals/array-buffer-native":11,"../internals/classof":29,"../internals/create-non-enumerable-property":37,"../internals/descriptors":42,"../internals/global":59,"../internals/has":60,"../internals/is-object":74,"../internals/object-define-property":92,"../internals/object-get-prototype-of":97,"../internals/object-set-prototype-of":101,"../internals/redefine":108,"../internals/uid":143,"../internals/well-known-symbol":146}],13:[function(n,s,o){function a(De){return[255&De]}function i(De){return[255&De,De>>8&255]}function l(De){return[255&De,De>>8&255,De>>16&255,De>>24&255]}function u(De){return De[3]<<24|De[2]<<16|De[1]<<8|De[0]}function h(De){return W(De,23,4)}function d(De){return W(De,52,8)}function c(De,Ne){F(De[ce],Ne,{get:function(){return Q(this)[Ne]}})}function f(De,Ne,rt,tt){var Je=N(rt),xt=Q(De);if(Je+Ne>xt.byteLength)throw j(be);var Pt=Q(xt.buffer).bytes,Dt=Je+xt.byteOffset,St=Pt.slice(Dt,Dt+Ne);return tt?St:St.reverse()}function p(De,Ne,rt,tt,Je,xt){var Pt=N(rt),Dt=Q(De);if(Pt+Ne>Dt.byteLength)throw j(be);for(var St=Q(Dt.buffer).bytes,Jt=Pt+Dt.byteOffset,ht=tt(+Je),ct=0;ct<Ne;ct++)St[Jt+ct]=ht[xt?ct:Ne-ct-1]}var m=n("../internals/global"),g=n("../internals/descriptors"),y=n("../internals/array-buffer-native"),v=n("../internals/create-non-enumerable-property"),b=n("../internals/redefine-all"),w=n("../internals/fails"),_=n("../internals/an-instance"),I=n("../internals/to-integer"),C=n("../internals/to-length"),N=n("../internals/to-index"),O=n("../internals/ieee754"),D=n("../internals/object-get-prototype-of"),M=n("../internals/object-set-prototype-of"),P=n("../internals/object-get-own-property-names").f,F=n("../internals/object-define-property").f,B=n("../internals/array-fill"),z=n("../internals/set-to-string-tag"),Z=n("../internals/internal-state"),Q=Z.get,K=Z.set,ne="ArrayBuffer",re="DataView",ce="prototype",be="Wrong index",we=m[ne],ye=we,Oe=m[re],Se=Oe&&Oe[ce],Ee=Object.prototype,j=m.RangeError,W=O.pack,J=O.unpack;if(y){if(!w(function(){we(1)})||!w(function(){new we(-1)})||w(function(){return new we,new we(1.5),new we(NaN),we.name!=ne})){for(var ie,ve=(ye=function(De){return _(this,ye),new we(N(De))})[ce]=we[ce],he=P(we),Fe=0;he.length>Fe;)(ie=he[Fe++])in ye||v(ye,ie,we[ie]);ve.constructor=ye}M&&D(Se)!==Ee&&M(Se,Ee);var me=new Oe(new ye(2)),Le=Se.setInt8;me.setInt8(0,2147483648),me.setInt8(1,2147483649),!me.getInt8(0)&&me.getInt8(1)||b(Se,{setInt8:function(De,Ne){Le.call(this,De,Ne<<24>>24)},setUint8:function(De,Ne){Le.call(this,De,Ne<<24>>24)}},{unsafe:!0})}else ye=function(De){_(this,ye,ne);var Ne=N(De);K(this,{bytes:B.call(new Array(Ne),0),byteLength:Ne}),g||(this.byteLength=Ne)},Oe=function(De,Ne,rt){_(this,Oe,re),_(De,ye,re);var tt=Q(De).byteLength,Je=I(Ne);if(Je<0||tt<Je)throw j("Wrong offset");if(tt<Je+(rt=rt===void 0?tt-Je:C(rt)))throw j("Wrong length");K(this,{buffer:De,byteLength:rt,byteOffset:Je}),g||(this.buffer=De,this.byteLength=rt,this.byteOffset=Je)},g&&(c(ye,"byteLength"),c(Oe,"buffer"),c(Oe,"byteLength"),c(Oe,"byteOffset")),b(Oe[ce],{getInt8:function(De){return f(this,1,De)[0]<<24>>24},getUint8:function(De){return f(this,1,De)[0]},getInt16:function(De,Ne){var rt=f(this,2,De,1<arguments.length?Ne:void 0);return(rt[1]<<8|rt[0])<<16>>16},getUint16:function(De,Ne){var rt=f(this,2,De,1<arguments.length?Ne:void 0);return rt[1]<<8|rt[0]},getInt32:function(De,Ne){return u(f(this,4,De,1<arguments.length?Ne:void 0))},getUint32:function(De,Ne){return u(f(this,4,De,1<arguments.length?Ne:void 0))>>>0},getFloat32:function(De,Ne){return J(f(this,4,De,1<arguments.length?Ne:void 0),23)},getFloat64:function(De,Ne){return J(f(this,8,De,1<arguments.length?Ne:void 0),52)},setInt8:function(De,Ne){p(this,1,De,a,Ne)},setUint8:function(De,Ne){p(this,1,De,a,Ne)},setInt16:function(De,Ne,rt){p(this,2,De,i,Ne,2<arguments.length?rt:void 0)},setUint16:function(De,Ne,rt){p(this,2,De,i,Ne,2<arguments.length?rt:void 0)},setInt32:function(De,Ne,rt){p(this,4,De,l,Ne,2<arguments.length?rt:void 0)},setUint32:function(De,Ne,rt){p(this,4,De,l,Ne,2<arguments.length?rt:void 0)},setFloat32:function(De,Ne,rt){p(this,4,De,h,Ne,2<arguments.length?rt:void 0)},setFloat64:function(De,Ne,rt){p(this,8,De,d,Ne,2<arguments.length?rt:void 0)}});z(ye,ne),z(Oe,re),s.exports={ArrayBuffer:ye,DataView:Oe}},{"../internals/an-instance":9,"../internals/array-buffer-native":11,"../internals/array-fill":15,"../internals/create-non-enumerable-property":37,"../internals/descriptors":42,"../internals/fails":50,"../internals/global":59,"../internals/ieee754":65,"../internals/internal-state":70,"../internals/object-define-property":92,"../internals/object-get-own-property-names":95,"../internals/object-get-prototype-of":97,"../internals/object-set-prototype-of":101,"../internals/redefine-all":107,"../internals/set-to-string-tag":117,"../internals/to-index":131,"../internals/to-integer":133,"../internals/to-length":134}],14:[function(n,s,o){var a=n("../internals/to-object"),i=n("../internals/to-absolute-index"),l=n("../internals/to-length"),u=Math.min;s.exports=[].copyWithin||function(h,d,c){var f=a(this),p=l(f.length),m=i(h,p),g=i(d,p),y=2<arguments.length?c:void 0,v=u((y===void 0?p:i(y,p))-g,p-m),b=1;for(g<m&&m<g+v&&(b=-1,g+=v-1,m+=v-1);0<v--;)g in f?f[m]=f[g]:delete f[m],m+=b,g+=b;return f}},{"../internals/to-absolute-index":130,"../internals/to-length":134,"../internals/to-object":135}],15:[function(n,s,o){var a=n("../internals/to-object"),i=n("../internals/to-absolute-index"),l=n("../internals/to-length");s.exports=function(u,h,d){for(var c=a(this),f=l(c.length),p=arguments.length,m=i(1<p?h:void 0,f),g=2<p?d:void 0,y=g===void 0?f:i(g,f);m<y;)c[m++]=u;return c}},{"../internals/to-absolute-index":130,"../internals/to-length":134,"../internals/to-object":135}],16:[function(n,s,o){var a=n("../internals/array-iteration").forEach,i=n("../internals/array-method-is-strict"),l=n("../internals/array-method-uses-to-length"),u=i("forEach"),h=l("forEach");s.exports=u&&h?[].forEach:function(d,c){return a(this,d,1<arguments.length?c:void 0)}},{"../internals/array-iteration":19,"../internals/array-method-is-strict":22,"../internals/array-method-uses-to-length":23}],17:[function(n,s,o){var a=n("../internals/function-bind-context"),i=n("../internals/to-object"),l=n("../internals/call-with-safe-iteration-closing"),u=n("../internals/is-array-iterator-method"),h=n("../internals/to-length"),d=n("../internals/create-property"),c=n("../internals/get-iterator-method");s.exports=function(f,p,m){var g,y,v,b,w,_,I=i(f),C=typeof this=="function"?this:Array,N=arguments.length,O=1<N?p:void 0,D=O!==void 0,M=c(I),P=0;if(D&&(O=a(O,2<N?m:void 0,2)),M==null||C==Array&&u(M))for(y=new C(g=h(I.length));P<g;P++)_=D?O(I[P],P):I[P],d(y,P,_);else for(w=(b=M.call(I)).next,y=new C;!(v=w.call(b)).done;P++)_=D?l(b,O,[v.value,P],!0):v.value,d(y,P,_);return y.length=P,y}},{"../internals/call-with-safe-iteration-closing":26,"../internals/create-property":39,"../internals/function-bind-context":54,"../internals/get-iterator-method":57,"../internals/is-array-iterator-method":71,"../internals/to-length":134,"../internals/to-object":135}],18:[function(n,s,o){function a(h){return function(d,c,f){var p,m=i(d),g=l(m.length),y=u(f,g);if(h&&c!=c){for(;y<g;)if((p=m[y++])!=p)return!0}else for(;y<g;y++)if((h||y in m)&&m[y]===c)return h||y||0;return!h&&-1}}var i=n("../internals/to-indexed-object"),l=n("../internals/to-length"),u=n("../internals/to-absolute-index");s.exports={includes:a(!0),indexOf:a(!1)}},{"../internals/to-absolute-index":130,"../internals/to-indexed-object":132,"../internals/to-length":134}],19:[function(n,s,o){function a(f){var p=f==1,m=f==2,g=f==3,y=f==4,v=f==6,b=f==5||v;return function(w,_,I,C){for(var N,O,D=u(w),M=l(D),P=i(_,I,3),F=h(M.length),B=0,z=C||d,Z=p?z(w,F):m?z(w,0):void 0;B<F;B++)if((b||B in M)&&(O=P(N=M[B],B,D),f)){if(p)Z[B]=O;else if(O)switch(f){case 3:return!0;case 5:return N;case 6:return B;case 2:c.call(Z,N)}else if(y)return!1}return v?-1:g||y?y:Z}}var i=n("../internals/function-bind-context"),l=n("../internals/indexed-object"),u=n("../internals/to-object"),h=n("../internals/to-length"),d=n("../internals/array-species-create"),c=[].push;s.exports={forEach:a(0),map:a(1),filter:a(2),some:a(3),every:a(4),find:a(5),findIndex:a(6)}},{"../internals/array-species-create":25,"../internals/function-bind-context":54,"../internals/indexed-object":66,"../internals/to-length":134,"../internals/to-object":135}],20:[function(n,s,o){var a=n("../internals/to-indexed-object"),i=n("../internals/to-integer"),l=n("../internals/to-length"),u=n("../internals/array-method-is-strict"),h=n("../internals/array-method-uses-to-length"),d=Math.min,c=[].lastIndexOf,f=!!c&&1/[1].lastIndexOf(1,-0)<0,p=u("lastIndexOf"),m=h("indexOf",{ACCESSORS:!0,1:0}),g=f||!p||!m;s.exports=g?function(y,v){if(f)return c.apply(this,arguments)||0;var b=a(this),w=l(b.length),_=w-1;for(1<arguments.length&&(_=d(_,i(v))),_<0&&(_=w+_);0<=_;_--)if(_ in b&&b[_]===y)return _||0;return-1}:c},{"../internals/array-method-is-strict":22,"../internals/array-method-uses-to-length":23,"../internals/to-indexed-object":132,"../internals/to-integer":133,"../internals/to-length":134}],21:[function(n,s,o){var a=n("../internals/fails"),i=n("../internals/well-known-symbol"),l=n("../internals/engine-v8-version"),u=i("species");s.exports=function(h){return 51<=l||!a(function(){var d=[];return(d.constructor={})[u]=function(){return{foo:1}},d[h](Boolean).foo!==1})}},{"../internals/engine-v8-version":47,"../internals/fails":50,"../internals/well-known-symbol":146}],22:[function(n,s,o){var a=n("../internals/fails");s.exports=function(i,l){var u=[][i];return!!u&&a(function(){u.call(null,l||function(){throw 1},1)})}},{"../internals/fails":50}],23:[function(n,s,o){function a(c){throw c}var i=n("../internals/descriptors"),l=n("../internals/fails"),u=n("../internals/has"),h=Object.defineProperty,d={};s.exports=function(c,f){if(u(d,c))return d[c];var p=[][c],m=!!u(f=f||{},"ACCESSORS")&&f.ACCESSORS,g=u(f,0)?f[0]:a,y=u(f,1)?f[1]:void 0;return d[c]=!!p&&!l(function(){if(m&&!i)return!0;var v={length:-1};m?h(v,1,{enumerable:!0,get:a}):v[1]=1,p.call(v,g,y)})}},{"../internals/descriptors":42,"../internals/fails":50,"../internals/has":60}],24:[function(n,s,o){function a(d){return function(c,f,p,m){i(f);var g=l(c),y=u(g),v=h(g.length),b=d?v-1:0,w=d?-1:1;if(p<2)for(;;){if(b in y){m=y[b],b+=w;break}if(b+=w,d?b<0:v<=b)throw TypeError("Reduce of empty array with no initial value")}for(;d?0<=b:b<v;b+=w)b in y&&(m=f(m,y[b],b,g));return m}}var i=n("../internals/a-function"),l=n("../internals/to-object"),u=n("../internals/indexed-object"),h=n("../internals/to-length");s.exports={left:a(!1),right:a(!0)}},{"../internals/a-function":5,"../internals/indexed-object":66,"../internals/to-length":134,"../internals/to-object":135}],25:[function(n,s,o){var a=n("../internals/is-object"),i=n("../internals/is-array"),l=n("../internals/well-known-symbol")("species");s.exports=function(u,h){var d;return i(u)&&(typeof(d=u.constructor)!="function"||d!==Array&&!i(d.prototype)?a(d)&&(d=d[l])===null&&(d=void 0):d=void 0),new(d===void 0?Array:d)(h===0?0:h)}},{"../internals/is-array":72,"../internals/is-object":74,"../internals/well-known-symbol":146}],26:[function(n,s,o){var a=n("../internals/an-object");s.exports=function(i,l,u,h){try{return h?l(a(u)[0],u[1]):l(u)}catch(c){var d=i.return;throw d!==void 0&&a(d.call(i)),c}}},{"../internals/an-object":10}],27:[function(n,s,o){var a=n("../internals/well-known-symbol")("iterator"),i=!1;try{var l=0,u={next:function(){return{done:!!l++}},return:function(){i=!0}};u[a]=function(){return this},Array.from(u,function(){throw 2})}catch{}s.exports=function(h,d){if(!d&&!i)return!1;var c=!1;try{var f={};f[a]=function(){return{next:function(){return{done:c=!0}}}},h(f)}catch{}return c}},{"../internals/well-known-symbol":146}],28:[function(n,s,o){var a={}.toString;s.exports=function(i){return a.call(i).slice(8,-1)}},{}],29:[function(n,s,o){var a=n("../internals/to-string-tag-support"),i=n("../internals/classof-raw"),l=n("../internals/well-known-symbol")("toStringTag"),u=i(function(){return arguments}())=="Arguments";s.exports=a?i:function(h){var d,c,f;return h===void 0?"Undefined":h===null?"Null":typeof(c=function(p,m){try{return p[m]}catch{}}(d=Object(h),l))=="string"?c:u?i(d):(f=i(d))=="Object"&&typeof d.callee=="function"?"Arguments":f}},{"../internals/classof-raw":28,"../internals/to-string-tag-support":139,"../internals/well-known-symbol":146}],30:[function(n,s,o){var a=n("../internals/object-define-property").f,i=n("../internals/object-create"),l=n("../internals/redefine-all"),u=n("../internals/function-bind-context"),h=n("../internals/an-instance"),d=n("../internals/iterate"),c=n("../internals/define-iterator"),f=n("../internals/set-species"),p=n("../internals/descriptors"),m=n("../internals/internal-metadata").fastKey,g=n("../internals/internal-state"),y=g.set,v=g.getterFor;s.exports={getConstructor:function(b,w,_,I){function C(M,P,F){var B,z,Z=O(M),Q=D(M,P);return Q?Q.value=F:(Z.last=Q={index:z=m(P,!0),key:P,value:F,previous:B=Z.last,next:void 0,removed:!1},Z.first||(Z.first=Q),B&&(B.next=Q),p?Z.size++:M.size++,z!=="F"&&(Z.index[z]=Q)),M}var N=b(function(M,P){h(M,N,w),y(M,{type:w,index:i(null),first:void 0,last:void 0,size:0}),p||(M.size=0),P!=null&&d(P,M[I],M,_)}),O=v(w),D=function(M,P){var F,B=O(M),z=m(P);if(z!=="F")return B.index[z];for(F=B.first;F;F=F.next)if(F.key==P)return F};return l(N.prototype,{clear:function(){for(var M=O(this),P=M.index,F=M.first;F;)F.removed=!0,F.previous&&(F.previous=F.previous.next=void 0),delete P[F.index],F=F.next;M.first=M.last=void 0,p?M.size=0:this.size=0},delete:function(M){var P=O(this),F=D(this,M);if(F){var B=F.next,z=F.previous;delete P.index[F.index],F.removed=!0,z&&(z.next=B),B&&(B.previous=z),P.first==F&&(P.first=B),P.last==F&&(P.last=z),p?P.size--:this.size--}return!!F},forEach:function(M,P){for(var F,B=O(this),z=u(M,1<arguments.length?P:void 0,3);F=F?F.next:B.first;)for(z(F.value,F.key,this);F&&F.removed;)F=F.previous},has:function(M){return!!D(this,M)}}),l(N.prototype,_?{get:function(M){var P=D(this,M);return P&&P.value},set:function(M,P){return C(this,M===0?0:M,P)}}:{add:function(M){return C(this,M=M===0?0:M,M)}}),p&&a(N.prototype,"size",{get:function(){return O(this).size}}),N},setStrong:function(b,w,_){var I=w+" Iterator",C=v(w),N=v(I);c(b,w,function(O,D){y(this,{type:I,target:O,state:C(O),kind:D,last:void 0})},function(){for(var O=N(this),D=O.kind,M=O.last;M&&M.removed;)M=M.previous;return O.target&&(O.last=M=M?M.next:O.state.first)?D=="keys"?{value:M.key,done:!1}:D=="values"?{value:M.value,done:!1}:{value:[M.key,M.value],done:!1}:{value:O.target=void 0,done:!0}},_?"entries":"values",!_,!0),f(w)}}},{"../internals/an-instance":9,"../internals/define-iterator":40,"../internals/descriptors":42,"../internals/function-bind-context":54,"../internals/internal-metadata":69,"../internals/internal-state":70,"../internals/iterate":77,"../internals/object-create":90,"../internals/object-define-property":92,"../internals/redefine-all":107,"../internals/set-species":116}],31:[function(n,s,o){var a=n("../internals/export"),i=n("../internals/global"),l=n("../internals/is-forced"),u=n("../internals/redefine"),h=n("../internals/internal-metadata"),d=n("../internals/iterate"),c=n("../internals/an-instance"),f=n("../internals/is-object"),p=n("../internals/fails"),m=n("../internals/check-correctness-of-iteration"),g=n("../internals/set-to-string-tag"),y=n("../internals/inherit-if-required");s.exports=function(v,b,w){function _(K){var ne=D[K];u(D,K,K=="add"?function(re){return ne.call(this,re===0?0:re),this}:K=="delete"?function(re){return!(C&&!f(re))&&ne.call(this,re===0?0:re)}:K=="get"?function(re){return C&&!f(re)?void 0:ne.call(this,re===0?0:re)}:K=="has"?function(re){return!(C&&!f(re))&&ne.call(this,re===0?0:re)}:function(re,ce){return ne.call(this,re===0?0:re,ce),this})}var I=v.indexOf("Map")!==-1,C=v.indexOf("Weak")!==-1,N=I?"set":"add",O=i[v],D=O&&O.prototype,M=O,P={};if(l(v,typeof O!="function"||!(C||D.forEach&&!p(function(){new O().entries().next()}))))M=w.getConstructor(b,v,I,N),h.REQUIRED=!0;else if(l(v,!0)){var F=new M,B=F[N](C?{}:-0,1)!=F,z=p(function(){F.has(1)}),Z=m(function(K){new O(K)}),Q=!C&&p(function(){for(var K=new O,ne=5;ne--;)K[N](ne,ne);return!K.has(-0)});Z||(((M=b(function(K,ne){c(K,M,v);var re=y(new O,K,M);return ne!=null&&d(ne,re[N],re,I),re})).prototype=D).constructor=M),(z||Q)&&(_("delete"),_("has"),I&&_("get")),(Q||B)&&_(N),C&&D.clear&&delete D.clear}return P[v]=M,a({global:!0,forced:M!=O},P),g(M,v),C||w.setStrong(M,v,I),M}},{"../internals/an-instance":9,"../internals/check-correctness-of-iteration":27,"../internals/export":49,"../internals/fails":50,"../internals/global":59,"../internals/inherit-if-required":67,"../internals/internal-metadata":69,"../internals/is-forced":73,"../internals/is-object":74,"../internals/iterate":77,"../internals/redefine":108,"../internals/set-to-string-tag":117}],32:[function(n,s,o){var a=n("../internals/has"),i=n("../internals/own-keys"),l=n("../internals/object-get-own-property-descriptor"),u=n("../internals/object-define-property");s.exports=function(h,d){for(var c=i(d),f=u.f,p=l.f,m=0;m<c.length;m++){var g=c[m];a(h,g)||f(h,g,p(d,g))}}},{"../internals/has":60,"../internals/object-define-property":92,"../internals/object-get-own-property-descriptor":93,"../internals/own-keys":103}],33:[function(n,s,o){var a=n("../internals/well-known-symbol")("match");s.exports=function(i){var l=/./;try{"/./"[i](l)}catch{try{return l[a]=!1,"/./"[i](l)}catch{}}return!1}},{"../internals/well-known-symbol":146}],34:[function(n,s,o){var a=n("../internals/fails");s.exports=!a(function(){function i(){}return i.prototype.constructor=null,Object.getPrototypeOf(new i)!==i.prototype})},{"../internals/fails":50}],35:[function(n,s,o){var a=n("../internals/require-object-coercible"),i=/"/g;s.exports=function(l,u,h,d){var c=String(a(l)),f="<"+u;return h!==""&&(f+=" "+h+'="'+String(d).replace(i,"&quot;")+'"'),f+">"+c+"</"+u+">"}},{"../internals/require-object-coercible":113}],36:[function(n,s,o){function a(){return this}var i=n("../internals/iterators-core").IteratorPrototype,l=n("../internals/object-create"),u=n("../internals/create-property-descriptor"),h=n("../internals/set-to-string-tag"),d=n("../internals/iterators");s.exports=function(c,f,p){var m=f+" Iterator";return c.prototype=l(i,{next:u(1,p)}),h(c,m,!1,!0),d[m]=a,c}},{"../internals/create-property-descriptor":38,"../internals/iterators":79,"../internals/iterators-core":78,"../internals/object-create":90,"../internals/set-to-string-tag":117}],37:[function(n,s,o){var a=n("../internals/descriptors"),i=n("../internals/object-define-property"),l=n("../internals/create-property-descriptor");s.exports=a?function(u,h,d){return i.f(u,h,l(1,d))}:function(u,h,d){return u[h]=d,u}},{"../internals/create-property-descriptor":38,"../internals/descriptors":42,"../internals/object-define-property":92}],38:[function(n,s,o){s.exports=function(a,i){return{enumerable:!(1&a),configurable:!(2&a),writable:!(4&a),value:i}}},{}],39:[function(n,s,o){var a=n("../internals/to-primitive"),i=n("../internals/object-define-property"),l=n("../internals/create-property-descriptor");s.exports=function(u,h,d){var c=a(h);c in u?i.f(u,c,l(0,d)):u[c]=d}},{"../internals/create-property-descriptor":38,"../internals/object-define-property":92,"../internals/to-primitive":138}],40:[function(n,s,o){function a(){return this}var i=n("../internals/export"),l=n("../internals/create-iterator-constructor"),u=n("../internals/object-get-prototype-of"),h=n("../internals/object-set-prototype-of"),d=n("../internals/set-to-string-tag"),c=n("../internals/create-non-enumerable-property"),f=n("../internals/redefine"),p=n("../internals/well-known-symbol"),m=n("../internals/is-pure"),g=n("../internals/iterators"),y=n("../internals/iterators-core"),v=y.IteratorPrototype,b=y.BUGGY_SAFARI_ITERATORS,w=p("iterator"),_="values",I="entries";s.exports=function(C,N,O,D,M,P,F){l(O,N,D);function B(ye){if(ye===M&&be)return be;if(!b&&ye in re)return re[ye];switch(ye){case"keys":case _:case I:return function(){return new O(this,ye)}}return function(){return new O(this)}}var z,Z,Q,K=N+" Iterator",ne=!1,re=C.prototype,ce=re[w]||re["@@iterator"]||M&&re[M],be=!b&&ce||B(M),we=N=="Array"&&re.entries||ce;if(we&&(z=u(we.call(new C)),v!==Object.prototype&&z.next&&(m||u(z)===v||(h?h(z,v):typeof z[w]!="function"&&c(z,w,a)),d(z,K,!0,!0),m&&(g[K]=a))),M==_&&ce&&ce.name!==_&&(ne=!0,be=function(){return ce.call(this)}),m&&!F||re[w]===be||c(re,w,be),g[N]=be,M)if(Z={values:B(_),keys:P?be:B("keys"),entries:B(I)},F)for(Q in Z)!b&&!ne&&Q in re||f(re,Q,Z[Q]);else i({target:N,proto:!0,forced:b||ne},Z);return Z}},{"../internals/create-iterator-constructor":36,"../internals/create-non-enumerable-property":37,"../internals/export":49,"../internals/is-pure":75,"../internals/iterators":79,"../internals/iterators-core":78,"../internals/object-get-prototype-of":97,"../internals/object-set-prototype-of":101,"../internals/redefine":108,"../internals/set-to-string-tag":117,"../internals/well-known-symbol":146}],41:[function(n,s,o){var a=n("../internals/path"),i=n("../internals/has"),l=n("../internals/well-known-symbol-wrapped"),u=n("../internals/object-define-property").f;s.exports=function(h){var d=a.Symbol||(a.Symbol={});i(d,h)||u(d,h,{value:l.f(h)})}},{"../internals/has":60,"../internals/object-define-property":92,"../internals/path":104,"../internals/well-known-symbol-wrapped":145}],42:[function(n,s,o){var a=n("../internals/fails");s.exports=!a(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7})},{"../internals/fails":50}],43:[function(n,s,o){var a=n("../internals/global"),i=n("../internals/is-object"),l=a.document,u=i(l)&&i(l.createElement);s.exports=function(h){return u?l.createElement(h):{}}},{"../internals/global":59,"../internals/is-object":74}],44:[function(n,s,o){s.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},{}],45:[function(n,s,o){var a=n("../internals/engine-user-agent");s.exports=/(iphone|ipod|ipad).*applewebkit/i.test(a)},{"../internals/engine-user-agent":46}],46:[function(n,s,o){var a=n("../internals/get-built-in");s.exports=a("navigator","userAgent")||""},{"../internals/get-built-in":56}],47:[function(n,s,o){var a,i,l=n("../internals/global"),u=n("../internals/engine-user-agent"),h=l.process,d=h&&h.versions,c=d&&d.v8;c?i=(a=c.split("."))[0]+a[1]:u&&(!(a=u.match(/Edge\/(\d+)/))||74<=a[1])&&(a=u.match(/Chrome\/(\d+)/))&&(i=a[1]),s.exports=i&&+i},{"../internals/engine-user-agent":46,"../internals/global":59}],48:[function(n,s,o){s.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},{}],49:[function(n,s,o){var a=n("../internals/global"),i=n("../internals/object-get-own-property-descriptor").f,l=n("../internals/create-non-enumerable-property"),u=n("../internals/redefine"),h=n("../internals/set-global"),d=n("../internals/copy-constructor-properties"),c=n("../internals/is-forced");s.exports=function(f,p){var m,g,y,v,b,w=f.target,_=f.global,I=f.stat;if(m=_?a:I?a[w]||h(w,{}):(a[w]||{}).prototype)for(g in p){if(v=p[g],y=f.noTargetGet?(b=i(m,g))&&b.value:m[g],!c(_?g:w+(I?".":"#")+g,f.forced)&&y!==void 0){if(typeof v==typeof y)continue;d(v,y)}(f.sham||y&&y.sham)&&l(v,"sham",!0),u(m,g,v,f)}}},{"../internals/copy-constructor-properties":32,"../internals/create-non-enumerable-property":37,"../internals/global":59,"../internals/is-forced":73,"../internals/object-get-own-property-descriptor":93,"../internals/redefine":108,"../internals/set-global":115}],50:[function(n,s,o){s.exports=function(a){try{return!!a()}catch{return!0}}},{}],51:[function(n,s,o){n("../modules/es.regexp.exec");var a=n("../internals/redefine"),i=n("../internals/fails"),l=n("../internals/well-known-symbol"),u=n("../internals/regexp-exec"),h=n("../internals/create-non-enumerable-property"),d=l("species"),c=!i(function(){var y=/./;return y.exec=function(){var v=[];return v.groups={a:"7"},v},"".replace(y,"$<a>")!=="7"}),f="a".replace(/./,"$0")==="$0",p=l("replace"),m=!!/./[p]&&/./[p]("a","$0")==="",g=!i(function(){var y=/(?:)/,v=y.exec;y.exec=function(){return v.apply(this,arguments)};var b="ab".split(y);return b.length!==2||b[0]!=="a"||b[1]!=="b"});s.exports=function(y,v,b,w){var _=l(y),I=!i(function(){var P={};return P[_]=function(){return 7},""[y](P)!=7}),C=I&&!i(function(){var P=!1,F=/a/;return y==="split"&&((F={constructor:{}}).constructor[d]=function(){return F},F.flags="",F[_]=/./[_]),F.exec=function(){return P=!0,null},F[_](""),!P});if(!I||!C||y==="replace"&&(!c||!f||m)||y==="split"&&!g){var N=/./[_],O=b(_,""[y],function(P,F,B,z,Z){return F.exec===u?I&&!Z?{done:!0,value:N.call(F,B,z)}:{done:!0,value:P.call(B,F,z)}:{done:!1}},{REPLACE_KEEPS_$0:f,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:m}),D=O[0],M=O[1];a(String.prototype,y,D),a(RegExp.prototype,_,v==2?function(P,F){return M.call(P,this,F)}:function(P){return M.call(P,this)})}w&&h(RegExp.prototype[_],"sham",!0)}},{"../internals/create-non-enumerable-property":37,"../internals/fails":50,"../internals/redefine":108,"../internals/regexp-exec":110,"../internals/well-known-symbol":146,"../modules/es.regexp.exec":181}],52:[function(n,s,o){var a=n("../internals/is-array"),i=n("../internals/to-length"),l=n("../internals/function-bind-context"),u=function(h,d,c,f,p,m,g,y){for(var v,b=p,w=0,_=!!g&&l(g,y,3);w<f;){if(w in c){if(v=_?_(c[w],w,d):c[w],0<m&&a(v))b=u(h,d,v,i(v.length),b,m-1)-1;else{if(9007199254740991<=b)throw TypeError("Exceed the acceptable array length");h[b]=v}b++}w++}return b};s.exports=u},{"../internals/function-bind-context":54,"../internals/is-array":72,"../internals/to-length":134}],53:[function(n,s,o){var a=n("../internals/fails");s.exports=!a(function(){return Object.isExtensible(Object.preventExtensions({}))})},{"../internals/fails":50}],54:[function(n,s,o){var a=n("../internals/a-function");s.exports=function(i,l,u){if(a(i),l===void 0)return i;switch(u){case 0:return function(){return i.call(l)};case 1:return function(h){return i.call(l,h)};case 2:return function(h,d){return i.call(l,h,d)};case 3:return function(h,d,c){return i.call(l,h,d,c)}}return function(){return i.apply(l,arguments)}}},{"../internals/a-function":5}],55:[function(n,s,o){var a=n("../internals/a-function"),i=n("../internals/is-object"),l=[].slice,u={};s.exports=Function.bind||function(h){var d=a(this),c=l.call(arguments,1),f=function(){var p=c.concat(l.call(arguments));return this instanceof f?function(m,g,y){if(!(g in u)){for(var v=[],b=0;b<g;b++)v[b]="a["+b+"]";u[g]=Function("C,a","return new C("+v.join(",")+")")}return u[g](m,y)}(d,p.length,p):d.apply(h,p)};return i(d.prototype)&&(f.prototype=d.prototype),f}},{"../internals/a-function":5,"../internals/is-object":74}],56:[function(n,s,o){function a(u){return typeof u=="function"?u:void 0}var i=n("../internals/path"),l=n("../internals/global");s.exports=function(u,h){return arguments.length<2?a(i[u])||a(l[u]):i[u]&&i[u][h]||l[u]&&l[u][h]}},{"../internals/global":59,"../internals/path":104}],57:[function(n,s,o){var a=n("../internals/classof"),i=n("../internals/iterators"),l=n("../internals/well-known-symbol")("iterator");s.exports=function(u){if(u!=null)return u[l]||u["@@iterator"]||i[a(u)]}},{"../internals/classof":29,"../internals/iterators":79,"../internals/well-known-symbol":146}],58:[function(n,s,o){var a=n("../internals/an-object"),i=n("../internals/get-iterator-method");s.exports=function(l){var u=i(l);if(typeof u!="function")throw TypeError(String(l)+" is not iterable");return a(u.call(l))}},{"../internals/an-object":10,"../internals/get-iterator-method":57}],59:[function(n,s,o){(function(a){function i(l){return l&&l.Math==Math&&l}s.exports=i(typeof globalThis=="object"&&globalThis)||i(typeof window=="object"&&window)||i(typeof self=="object"&&self)||i(typeof a=="object"&&a)||Function("return this")()}).call(this,typeof Pr!="undefined"?Pr:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],60:[function(n,s,o){var a={}.hasOwnProperty;s.exports=function(i,l){return a.call(i,l)}},{}],61:[function(n,s,o){s.exports={}},{}],62:[function(n,s,o){var a=n("../internals/global");s.exports=function(i,l){var u=a.console;u&&u.error&&(arguments.length===1?u.error(i):u.error(i,l))}},{"../internals/global":59}],63:[function(n,s,o){var a=n("../internals/get-built-in");s.exports=a("document","documentElement")},{"../internals/get-built-in":56}],64:[function(n,s,o){var a=n("../internals/descriptors"),i=n("../internals/fails"),l=n("../internals/document-create-element");s.exports=!a&&!i(function(){return Object.defineProperty(l("div"),"a",{get:function(){return 7}}).a!=7})},{"../internals/descriptors":42,"../internals/document-create-element":43,"../internals/fails":50}],65:[function(n,s,o){var a=Math.abs,i=Math.pow,l=Math.floor,u=Math.log,h=Math.LN2;s.exports={pack:function(d,c,f){var p,m,g,y=new Array(f),v=8*f-c-1,b=(1<<v)-1,w=b>>1,_=c===23?i(2,-24)-i(2,-77):0,I=d<0||d===0&&1/d<0?1:0,C=0;for((d=a(d))!=d||d===1/0?(m=d!=d?1:0,p=b):(p=l(u(d)/h),d*(g=i(2,-p))<1&&(p--,g*=2),2<=(d+=1<=p+w?_/g:_*i(2,1-w))*g&&(p++,g/=2),b<=p+w?(m=0,p=b):1<=p+w?(m=(d*g-1)*i(2,c),p+=w):(m=d*i(2,w-1)*i(2,c),p=0));8<=c;y[C++]=255&m,m/=256,c-=8);for(p=p<<c|m,v+=c;0<v;y[C++]=255&p,p/=256,v-=8);return y[--C]|=128*I,y},unpack:function(d,c){var f,p=d.length,m=8*p-c-1,g=(1<<m)-1,y=g>>1,v=m-7,b=p-1,w=d[b--],_=127&w;for(w>>=7;0<v;_=256*_+d[b],b--,v-=8);for(f=_&(1<<-v)-1,_>>=-v,v+=c;0<v;f=256*f+d[b],b--,v-=8);if(_===0)_=1-y;else{if(_===g)return f?NaN:w?-1/0:1/0;f+=i(2,c),_-=y}return(w?-1:1)*f*i(2,_-c)}}},{}],66:[function(n,s,o){var a=n("../internals/fails"),i=n("../internals/classof-raw"),l="".split;s.exports=a(function(){return!Object("z").propertyIsEnumerable(0)})?function(u){return i(u)=="String"?l.call(u,""):Object(u)}:Object},{"../internals/classof-raw":28,"../internals/fails":50}],67:[function(n,s,o){var a=n("../internals/is-object"),i=n("../internals/object-set-prototype-of");s.exports=function(l,u,h){var d,c;return i&&typeof(d=u.constructor)=="function"&&d!==h&&a(c=d.prototype)&&c!==h.prototype&&i(l,c),l}},{"../internals/is-object":74,"../internals/object-set-prototype-of":101}],68:[function(n,s,o){var a=n("../internals/shared-store"),i=Function.toString;typeof a.inspectSource!="function"&&(a.inspectSource=function(l){return i.call(l)}),s.exports=a.inspectSource},{"../internals/shared-store":119}],69:[function(n,s,o){function a(y){h(y,f,{value:{objectID:"O"+ ++p,weakData:{}}})}var i=n("../internals/hidden-keys"),l=n("../internals/is-object"),u=n("../internals/has"),h=n("../internals/object-define-property").f,d=n("../internals/uid"),c=n("../internals/freezing"),f=d("meta"),p=0,m=Object.isExtensible||function(){return!0},g=s.exports={REQUIRED:!1,fastKey:function(y,v){if(!l(y))return typeof y=="symbol"?y:(typeof y=="string"?"S":"P")+y;if(!u(y,f)){if(!m(y))return"F";if(!v)return"E";a(y)}return y[f].objectID},getWeakData:function(y,v){if(!u(y,f)){if(!m(y))return!0;if(!v)return!1;a(y)}return y[f].weakData},onFreeze:function(y){return c&&g.REQUIRED&&m(y)&&!u(y,f)&&a(y),y}};i[f]=!0},{"../internals/freezing":53,"../internals/has":60,"../internals/hidden-keys":61,"../internals/is-object":74,"../internals/object-define-property":92,"../internals/uid":143}],70:[function(n,s,o){var a,i,l,u=n("../internals/native-weak-map"),h=n("../internals/global"),d=n("../internals/is-object"),c=n("../internals/create-non-enumerable-property"),f=n("../internals/has"),p=n("../internals/shared-key"),m=n("../internals/hidden-keys"),g=h.WeakMap;if(u){var y=new g,v=y.get,b=y.has,w=y.set;a=function(I,C){return w.call(y,I,C),C},i=function(I){return v.call(y,I)||{}},l=function(I){return b.call(y,I)}}else{var _=p("state");m[_]=!0,a=function(I,C){return c(I,_,C),C},i=function(I){return f(I,_)?I[_]:{}},l=function(I){return f(I,_)}}s.exports={set:a,get:i,has:l,enforce:function(I){return l(I)?i(I):a(I,{})},getterFor:function(I){return function(C){var N;if(!d(C)||(N=i(C)).type!==I)throw TypeError("Incompatible receiver, "+I+" required");return N}}}},{"../internals/create-non-enumerable-property":37,"../internals/global":59,"../internals/has":60,"../internals/hidden-keys":61,"../internals/is-object":74,"../internals/native-weak-map":85,"../internals/shared-key":118}],71:[function(n,s,o){var a=n("../internals/well-known-symbol"),i=n("../internals/iterators"),l=a("iterator"),u=Array.prototype;s.exports=function(h){return h!==void 0&&(i.Array===h||u[l]===h)}},{"../internals/iterators":79,"../internals/well-known-symbol":146}],72:[function(n,s,o){var a=n("../internals/classof-raw");s.exports=Array.isArray||function(i){return a(i)=="Array"}},{"../internals/classof-raw":28}],73:[function(n,s,o){function a(f,p){var m=h[u(f)];return m==c||m!=d&&(typeof p=="function"?i(p):!!p)}var i=n("../internals/fails"),l=/#|\.prototype\./,u=a.normalize=function(f){return String(f).replace(l,".").toLowerCase()},h=a.data={},d=a.NATIVE="N",c=a.POLYFILL="P";s.exports=a},{"../internals/fails":50}],74:[function(n,s,o){s.exports=function(a){return typeof a=="object"?a!==null:typeof a=="function"}},{}],75:[function(n,s,o){s.exports=!1},{}],76:[function(n,s,o){var a=n("../internals/is-object"),i=n("../internals/classof-raw"),l=n("../internals/well-known-symbol")("match");s.exports=function(u){var h;return a(u)&&((h=u[l])!==void 0?!!h:i(u)=="RegExp")}},{"../internals/classof-raw":28,"../internals/is-object":74,"../internals/well-known-symbol":146}],77:[function(n,s,o){function a(f,p){this.stopped=f,this.result=p}var i=n("../internals/an-object"),l=n("../internals/is-array-iterator-method"),u=n("../internals/to-length"),h=n("../internals/function-bind-context"),d=n("../internals/get-iterator-method"),c=n("../internals/call-with-safe-iteration-closing");(s.exports=function(f,p,m,g,y){var v,b,w,_,I,C,N,O=h(p,m,g?2:1);if(y)v=f;else{if(typeof(b=d(f))!="function")throw TypeError("Target is not iterable");if(l(b)){for(w=0,_=u(f.length);w<_;w++)if((I=g?O(i(N=f[w])[0],N[1]):O(f[w]))&&I instanceof a)return I;return new a(!1)}v=b.call(f)}for(C=v.next;!(N=C.call(v)).done;)if(typeof(I=c(v,O,N.value,g))=="object"&&I&&I instanceof a)return I;return new a(!1)}).stop=function(f){return new a(!0,f)}},{"../internals/an-object":10,"../internals/call-with-safe-iteration-closing":26,"../internals/function-bind-context":54,"../internals/get-iterator-method":57,"../internals/is-array-iterator-method":71,"../internals/to-length":134}],78:[function(n,s,o){var a,i,l,u=n("../internals/object-get-prototype-of"),h=n("../internals/create-non-enumerable-property"),d=n("../internals/has"),c=n("../internals/well-known-symbol"),f=n("../internals/is-pure"),p=c("iterator"),m=!1;[].keys&&("next"in(l=[].keys())?(i=u(u(l)))!==Object.prototype&&(a=i):m=!0),a==null&&(a={}),f||d(a,p)||h(a,p,function(){return this}),s.exports={IteratorPrototype:a,BUGGY_SAFARI_ITERATORS:m}},{"../internals/create-non-enumerable-property":37,"../internals/has":60,"../internals/is-pure":75,"../internals/object-get-prototype-of":97,"../internals/well-known-symbol":146}],79:[function(n,s,o){arguments[4][61][0].apply(o,arguments)},{dup:61}],80:[function(n,s,o){s.exports=Math.sign||function(a){return(a=+a)==0||a!=a?a:a<0?-1:1}},{}],81:[function(n,s,o){var a,i,l,u,h,d,c,f,p=n("../internals/global"),m=n("../internals/object-get-own-property-descriptor").f,g=n("../internals/classof-raw"),y=n("../internals/task").set,v=n("../internals/engine-is-ios"),b=p.MutationObserver||p.WebKitMutationObserver,w=p.process,_=p.Promise,I=g(w)=="process",C=m(p,"queueMicrotask"),N=C&&C.value;N||(a=function(){var O,D;for(I&&(O=w.domain)&&O.exit();i;){D=i.fn,i=i.next;try{D()}catch(M){throw i?u():l=void 0,M}}l=void 0,O&&O.enter()},u=I?function(){w.nextTick(a)}:b&&!v?(h=!0,d=document.createTextNode(""),new b(a).observe(d,{characterData:!0}),function(){d.data=h=!h}):_&&_.resolve?(c=_.resolve(void 0),f=c.then,function(){f.call(c,a)}):function(){y.call(p,a)}),s.exports=N||function(O){var D={fn:O,next:void 0};l&&(l.next=D),i||(i=D,u()),l=D}},{"../internals/classof-raw":28,"../internals/engine-is-ios":45,"../internals/global":59,"../internals/object-get-own-property-descriptor":93,"../internals/task":128}],82:[function(n,s,o){var a=n("../internals/global");s.exports=a.Promise},{"../internals/global":59}],83:[function(n,s,o){var a=n("../internals/fails");s.exports=!!Object.getOwnPropertySymbols&&!a(function(){return!String(Symbol())})},{"../internals/fails":50}],84:[function(n,s,o){var a=n("../internals/fails"),i=n("../internals/well-known-symbol"),l=n("../internals/is-pure"),u=i("iterator");s.exports=!a(function(){var h=new URL("b?a=1&b=2&c=3","http://a"),d=h.searchParams,c="";return h.pathname="c%20d",d.forEach(function(f,p){d.delete("b"),c+=p+f}),l&&!h.toJSON||!d.sort||h.href!=="http://a/c%20d?a=1&c=3"||d.get("c")!=="3"||String(new URLSearchParams("?a=1"))!=="a=1"||!d[u]||new URL("https://a@b").username!=="a"||new URLSearchParams(new URLSearchParams("a=b")).get("a")!=="b"||new URL("http://\u0442\u0435\u0441\u0442").host!=="xn--e1aybc"||new URL("http://a#\u0431").hash!=="#%D0%B1"||c!=="a1c3"||new URL("http://x",void 0).host!=="x"})},{"../internals/fails":50,"../internals/is-pure":75,"../internals/well-known-symbol":146}],85:[function(n,s,o){var a=n("../internals/global"),i=n("../internals/inspect-source"),l=a.WeakMap;s.exports=typeof l=="function"&&/native code/.test(i(l))},{"../internals/global":59,"../internals/inspect-source":68}],86:[function(n,s,o){function a(l){var u,h;this.promise=new l(function(d,c){if(u!==void 0||h!==void 0)throw TypeError("Bad Promise constructor");u=d,h=c}),this.resolve=i(u),this.reject=i(h)}var i=n("../internals/a-function");s.exports.f=function(l){return new a(l)}},{"../internals/a-function":5}],87:[function(n,s,o){var a=n("../internals/is-regexp");s.exports=function(i){if(a(i))throw TypeError("The method doesn't accept regular expressions");return i}},{"../internals/is-regexp":76}],88:[function(n,s,o){var a=n("../internals/global").isFinite;s.exports=Number.isFinite||function(i){return typeof i=="number"&&a(i)}},{"../internals/global":59}],89:[function(n,s,o){var a=n("../internals/descriptors"),i=n("../internals/fails"),l=n("../internals/object-keys"),u=n("../internals/object-get-own-property-symbols"),h=n("../internals/object-property-is-enumerable"),d=n("../internals/to-object"),c=n("../internals/indexed-object"),f=Object.assign,p=Object.defineProperty;s.exports=!f||i(function(){if(a&&f({b:1},f(p({},"a",{enumerable:!0,get:function(){p(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var m={},g={},y=Symbol(),v="abcdefghijklmnopqrst";return m[y]=7,v.split("").forEach(function(b){g[b]=b}),f({},m)[y]!=7||l(f({},g)).join("")!=v})?function(m,g){for(var y=d(m),v=arguments.length,b=1,w=u.f,_=h.f;b<v;)for(var I,C=c(arguments[b++]),N=w?l(C).concat(w(C)):l(C),O=N.length,D=0;D<O;)I=N[D++],a&&!_.call(C,I)||(y[I]=C[I]);return y}:f},{"../internals/descriptors":42,"../internals/fails":50,"../internals/indexed-object":66,"../internals/object-get-own-property-symbols":96,"../internals/object-keys":99,"../internals/object-property-is-enumerable":100,"../internals/to-object":135}],90:[function(n,s,o){function a(){}function i(w){return"<script>"+w+"</"+y+">"}var l,u=n("../internals/an-object"),h=n("../internals/object-define-properties"),d=n("../internals/enum-bug-keys"),c=n("../internals/hidden-keys"),f=n("../internals/html"),p=n("../internals/document-create-element"),m=n("../internals/shared-key"),g="prototype",y="script",v=m("IE_PROTO"),b=function(){try{l=document.domain&&new ActiveXObject("htmlfile")}catch{}var w,_;b=l?function(C){C.write(i("")),C.close();var N=C.parentWindow.Object;return C=null,N}(l):((_=p("iframe")).style.display="none",f.appendChild(_),_.src=String("javascript:"),(w=_.contentWindow.document).open(),w.write(i("document.F=Object")),w.close(),w.F);for(var I=d.length;I--;)delete b[g][d[I]];return b()};c[v]=!0,s.exports=Object.create||function(w,_){var I;return w!==null?(a[g]=u(w),I=new a,a[g]=null,I[v]=w):I=b(),_===void 0?I:h(I,_)}},{"../internals/an-object":10,"../internals/document-create-element":43,"../internals/enum-bug-keys":48,"../internals/hidden-keys":61,"../internals/html":63,"../internals/object-define-properties":91,"../internals/shared-key":118}],91:[function(n,s,o){var a=n("../internals/descriptors"),i=n("../internals/object-define-property"),l=n("../internals/an-object"),u=n("../internals/object-keys");s.exports=a?Object.defineProperties:function(h,d){l(h);for(var c,f=u(d),p=f.length,m=0;m<p;)i.f(h,c=f[m++],d[c]);return h}},{"../internals/an-object":10,"../internals/descriptors":42,"../internals/object-define-property":92,"../internals/object-keys":99}],92:[function(n,s,o){var a=n("../internals/descriptors"),i=n("../internals/ie8-dom-define"),l=n("../internals/an-object"),u=n("../internals/to-primitive"),h=Object.defineProperty;o.f=a?h:function(d,c,f){if(l(d),c=u(c,!0),l(f),i)try{return h(d,c,f)}catch{}if("get"in f||"set"in f)throw TypeError("Accessors not supported");return"value"in f&&(d[c]=f.value),d}},{"../internals/an-object":10,"../internals/descriptors":42,"../internals/ie8-dom-define":64,"../internals/to-primitive":138}],93:[function(n,s,o){var a=n("../internals/descriptors"),i=n("../internals/object-property-is-enumerable"),l=n("../internals/create-property-descriptor"),u=n("../internals/to-indexed-object"),h=n("../internals/to-primitive"),d=n("../internals/has"),c=n("../internals/ie8-dom-define"),f=Object.getOwnPropertyDescriptor;o.f=a?f:function(p,m){if(p=u(p),m=h(m,!0),c)try{return f(p,m)}catch{}if(d(p,m))return l(!i.f.call(p,m),p[m])}},{"../internals/create-property-descriptor":38,"../internals/descriptors":42,"../internals/has":60,"../internals/ie8-dom-define":64,"../internals/object-property-is-enumerable":100,"../internals/to-indexed-object":132,"../internals/to-primitive":138}],94:[function(n,s,o){var a=n("../internals/to-indexed-object"),i=n("../internals/object-get-own-property-names").f,l={}.toString,u=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];s.exports.f=function(h){return u&&l.call(h)=="[object Window]"?function(d){try{return i(d)}catch{return u.slice()}}(h):i(a(h))}},{"../internals/object-get-own-property-names":95,"../internals/to-indexed-object":132}],95:[function(n,s,o){var a=n("../internals/object-keys-internal"),i=n("../internals/enum-bug-keys").concat("length","prototype");o.f=Object.getOwnPropertyNames||function(l){return a(l,i)}},{"../internals/enum-bug-keys":48,"../internals/object-keys-internal":98}],96:[function(n,s,o){o.f=Object.getOwnPropertySymbols},{}],97:[function(n,s,o){var a=n("../internals/has"),i=n("../internals/to-object"),l=n("../internals/shared-key"),u=n("../internals/correct-prototype-getter"),h=l("IE_PROTO"),d=Object.prototype;s.exports=u?Object.getPrototypeOf:function(c){return c=i(c),a(c,h)?c[h]:typeof c.constructor=="function"&&c instanceof c.constructor?c.constructor.prototype:c instanceof Object?d:null}},{"../internals/correct-prototype-getter":34,"../internals/has":60,"../internals/shared-key":118,"../internals/to-object":135}],98:[function(n,s,o){var a=n("../internals/has"),i=n("../internals/to-indexed-object"),l=n("../internals/array-includes").indexOf,u=n("../internals/hidden-keys");s.exports=function(h,d){var c,f=i(h),p=0,m=[];for(c in f)!a(u,c)&&a(f,c)&&m.push(c);for(;d.length>p;)a(f,c=d[p++])&&(~l(m,c)||m.push(c));return m}},{"../internals/array-includes":18,"../internals/has":60,"../internals/hidden-keys":61,"../internals/to-indexed-object":132}],99:[function(n,s,o){var a=n("../internals/object-keys-internal"),i=n("../internals/enum-bug-keys");s.exports=Object.keys||function(l){return a(l,i)}},{"../internals/enum-bug-keys":48,"../internals/object-keys-internal":98}],100:[function(n,s,o){var a={}.propertyIsEnumerable,i=Object.getOwnPropertyDescriptor,l=i&&!a.call({1:2},1);o.f=l?function(u){var h=i(this,u);return!!h&&h.enumerable}:a},{}],101:[function(n,s,o){var a=n("../internals/an-object"),i=n("../internals/a-possible-prototype");s.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var l,u=!1,h={};try{(l=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(h,[]),u=h instanceof Array}catch{}return function(d,c){return a(d),i(c),u?l.call(d,c):d.__proto__=c,d}}():void 0)},{"../internals/a-possible-prototype":6,"../internals/an-object":10}],102:[function(n,s,o){var a=n("../internals/to-string-tag-support"),i=n("../internals/classof");s.exports=a?{}.toString:function(){return"[object "+i(this)+"]"}},{"../internals/classof":29,"../internals/to-string-tag-support":139}],103:[function(n,s,o){var a=n("../internals/get-built-in"),i=n("../internals/object-get-own-property-names"),l=n("../internals/object-get-own-property-symbols"),u=n("../internals/an-object");s.exports=a("Reflect","ownKeys")||function(h){var d=i.f(u(h)),c=l.f;return c?d.concat(c(h)):d}},{"../internals/an-object":10,"../internals/get-built-in":56,"../internals/object-get-own-property-names":95,"../internals/object-get-own-property-symbols":96}],104:[function(n,s,o){var a=n("../internals/global");s.exports=a},{"../internals/global":59}],105:[function(n,s,o){s.exports=function(a){try{return{error:!1,value:a()}}catch(i){return{error:!0,value:i}}}},{}],106:[function(n,s,o){var a=n("../internals/an-object"),i=n("../internals/is-object"),l=n("../internals/new-promise-capability");s.exports=function(u,h){if(a(u),i(h)&&h.constructor===u)return h;var d=l.f(u);return(0,d.resolve)(h),d.promise}},{"../internals/an-object":10,"../internals/is-object":74,"../internals/new-promise-capability":86}],107:[function(n,s,o){var a=n("../internals/redefine");s.exports=function(i,l,u){for(var h in l)a(i,h,l[h],u);return i}},{"../internals/redefine":108}],108:[function(n,s,o){var a=n("../internals/global"),i=n("../internals/create-non-enumerable-property"),l=n("../internals/has"),u=n("../internals/set-global"),h=n("../internals/inspect-source"),d=n("../internals/internal-state"),c=d.get,f=d.enforce,p=String(String).split("String");(s.exports=function(m,g,y,v){var b=!!v&&!!v.unsafe,w=!!v&&!!v.enumerable,_=!!v&&!!v.noTargetGet;typeof y=="function"&&(typeof g!="string"||l(y,"name")||i(y,"name",g),f(y).source=p.join(typeof g=="string"?g:"")),m!==a?(b?!_&&m[g]&&(w=!0):delete m[g],w?m[g]=y:i(m,g,y)):w?m[g]=y:u(g,y)})(Function.prototype,"toString",function(){return typeof this=="function"&&c(this).source||h(this)})},{"../internals/create-non-enumerable-property":37,"../internals/global":59,"../internals/has":60,"../internals/inspect-source":68,"../internals/internal-state":70,"../internals/set-global":115}],109:[function(n,s,o){var a=n("./classof-raw"),i=n("./regexp-exec");s.exports=function(l,u){var h=l.exec;if(typeof h=="function"){var d=h.call(l,u);if(typeof d!="object")throw TypeError("RegExp exec method returned something other than an Object or null");return d}if(a(l)!=="RegExp")throw TypeError("RegExp#exec called on incompatible receiver");return i.call(l,u)}},{"./classof-raw":28,"./regexp-exec":110}],110:[function(n,s,o){var a,i,l=n("./regexp-flags"),u=n("./regexp-sticky-helpers"),h=RegExp.prototype.exec,d=String.prototype.replace,c=h,f=(a=/a/,i=/b*/g,h.call(a,"a"),h.call(i,"a"),a.lastIndex!==0||i.lastIndex!==0),p=u.UNSUPPORTED_Y||u.BROKEN_CARET,m=/()??/.exec("")[1]!==void 0;(f||m||p)&&(c=function(g){var y,v,b,w,_=this,I=p&&_.sticky,C=l.call(_),N=_.source,O=0,D=g;return I&&((C=C.replace("y","")).indexOf("g")===-1&&(C+="g"),D=String(g).slice(_.lastIndex),0<_.lastIndex&&(!_.multiline||_.multiline&&g[_.lastIndex-1]!==`
`)&&(N="(?: "+N+")",D=" "+D,O++),v=new RegExp("^(?:"+N+")",C)),m&&(v=new RegExp("^"+N+"$(?!\\s)",C)),f&&(y=_.lastIndex),b=h.call(I?v:_,D),I?b?(b.input=b.input.slice(O),b[0]=b[0].slice(O),b.index=_.lastIndex,_.lastIndex+=b[0].length):_.lastIndex=0:f&&b&&(_.lastIndex=_.global?b.index+b[0].length:y),m&&b&&1<b.length&&d.call(b[0],v,function(){for(w=1;w<arguments.length-2;w++)arguments[w]===void 0&&(b[w]=void 0)}),b}),s.exports=c},{"./regexp-flags":111,"./regexp-sticky-helpers":112}],111:[function(n,s,o){var a=n("../internals/an-object");s.exports=function(){var i=a(this),l="";return i.global&&(l+="g"),i.ignoreCase&&(l+="i"),i.multiline&&(l+="m"),i.dotAll&&(l+="s"),i.unicode&&(l+="u"),i.sticky&&(l+="y"),l}},{"../internals/an-object":10}],112:[function(n,s,o){var a=n("./fails");function i(l,u){return RegExp(l,u)}o.UNSUPPORTED_Y=a(function(){var l=i("a","y");return l.lastIndex=2,l.exec("abcd")!=null}),o.BROKEN_CARET=a(function(){var l=i("^r","gy");return l.lastIndex=2,l.exec("str")!=null})},{"./fails":50}],113:[function(n,s,o){s.exports=function(a){if(a==null)throw TypeError("Can't call method on "+a);return a}},{}],114:[function(n,s,o){s.exports=Object.is||function(a,i){return a===i?a!==0||1/a==1/i:a!=a&&i!=i}},{}],115:[function(n,s,o){var a=n("../internals/global"),i=n("../internals/create-non-enumerable-property");s.exports=function(l,u){try{i(a,l,u)}catch{a[l]=u}return u}},{"../internals/create-non-enumerable-property":37,"../internals/global":59}],116:[function(n,s,o){var a=n("../internals/get-built-in"),i=n("../internals/object-define-property"),l=n("../internals/well-known-symbol"),u=n("../internals/descriptors"),h=l("species");s.exports=function(d){var c=a(d),f=i.f;u&&c&&!c[h]&&f(c,h,{configurable:!0,get:function(){return this}})}},{"../internals/descriptors":42,"../internals/get-built-in":56,"../internals/object-define-property":92,"../internals/well-known-symbol":146}],117:[function(n,s,o){var a=n("../internals/object-define-property").f,i=n("../internals/has"),l=n("../internals/well-known-symbol")("toStringTag");s.exports=function(u,h,d){u&&!i(u=d?u:u.prototype,l)&&a(u,l,{configurable:!0,value:h})}},{"../internals/has":60,"../internals/object-define-property":92,"../internals/well-known-symbol":146}],118:[function(n,s,o){var a=n("../internals/shared"),i=n("../internals/uid"),l=a("keys");s.exports=function(u){return l[u]||(l[u]=i(u))}},{"../internals/shared":120,"../internals/uid":143}],119:[function(n,s,o){var a=n("../internals/global"),i=n("../internals/set-global"),l="__core-js_shared__",u=a[l]||i(l,{});s.exports=u},{"../internals/global":59,"../internals/set-global":115}],120:[function(n,s,o){var a=n("../internals/is-pure"),i=n("../internals/shared-store");(s.exports=function(l,u){return i[l]||(i[l]=u!==void 0?u:{})})("versions",[]).push({version:"3.6.5",mode:a?"pure":"global",copyright:"\xA9 2020 Denis Pushkarev (zloirock.ru)"})},{"../internals/is-pure":75,"../internals/shared-store":119}],121:[function(n,s,o){var a=n("../internals/an-object"),i=n("../internals/a-function"),l=n("../internals/well-known-symbol")("species");s.exports=function(u,h){var d,c=a(u).constructor;return c===void 0||(d=a(c)[l])==null?h:i(d)}},{"../internals/a-function":5,"../internals/an-object":10,"../internals/well-known-symbol":146}],122:[function(n,s,o){var a=n("../internals/fails");s.exports=function(i){return a(function(){var l=""[i]('"');return l!==l.toLowerCase()||3<l.split('"').length})}},{"../internals/fails":50}],123:[function(n,s,o){function a(u){return function(h,d){var c,f,p=String(l(h)),m=i(d),g=p.length;return m<0||g<=m?u?"":void 0:(c=p.charCodeAt(m))<55296||56319<c||m+1===g||(f=p.charCodeAt(m+1))<56320||57343<f?u?p.charAt(m):c:u?p.slice(m,m+2):f-56320+(c-55296<<10)+65536}}var i=n("../internals/to-integer"),l=n("../internals/require-object-coercible");s.exports={codeAt:a(!1),charAt:a(!0)}},{"../internals/require-object-coercible":113,"../internals/to-integer":133}],124:[function(n,s,o){function a(m){return m+22+75*(m<26)}function i(m,g,y){var v=0;for(m=y?f(m/700):m>>1,m+=f(m/g);455<m;v+=36)m=f(m/35);return f(v+36*m/(m+38))}function l(m){var g,y,v=[],b=(m=function(Z){for(var Q=[],K=0,ne=Z.length;K<ne;){var re=Z.charCodeAt(K++);if(55296<=re&&re<=56319&&K<ne){var ce=Z.charCodeAt(K++);(64512&ce)==56320?Q.push(((1023&re)<<10)+(1023&ce)+65536):(Q.push(re),K--)}else Q.push(re)}return Q}(m)).length,w=128,_=0,I=72;for(g=0;g<m.length;g++)(y=m[g])<128&&v.push(p(y));var C=v.length,N=C;for(C&&v.push("-");N<b;){var O=u;for(g=0;g<m.length;g++)w<=(y=m[g])&&y<O&&(O=y);var D=N+1;if(O-w>f((u-_)/D))throw RangeError(c);for(_+=(O-w)*D,w=O,g=0;g<m.length;g++){if((y=m[g])<w&&++_>u)throw RangeError(c);if(y==w){for(var M=_,P=36;;P+=36){var F=P<=I?1:I+26<=P?26:P-I;if(M<F)break;var B=M-F,z=36-F;v.push(p(a(F+B%z))),M=f(B/z)}v.push(p(a(M))),I=i(_,D,N==C),_=0,++N}}++_,++w}return v.join("")}var u=2147483647,h=/[^\0-\u007E]/,d=/[.\u3002\uFF0E\uFF61]/g,c="Overflow: input needs wider integers to process",f=Math.floor,p=String.fromCharCode;s.exports=function(m){var g,y,v=[],b=m.toLowerCase().replace(d,".").split(".");for(g=0;g<b.length;g++)y=b[g],v.push(h.test(y)?"xn--"+l(y):y);return v.join(".")}},{}],125:[function(n,s,o){var a=n("../internals/to-integer"),i=n("../internals/require-object-coercible");s.exports="".repeat||function(l){var u=String(i(this)),h="",d=a(l);if(d<0||d==1/0)throw RangeError("Wrong number of repetitions");for(;0<d;(d>>>=1)&&(u+=u))1&d&&(h+=u);return h}},{"../internals/require-object-coercible":113,"../internals/to-integer":133}],126:[function(n,s,o){var a=n("../internals/fails"),i=n("../internals/whitespaces");s.exports=function(l){return a(function(){return!!i[l]()||"\u200B\x85\u180E"[l]()!="\u200B\x85\u180E"||i[l].name!==l})}},{"../internals/fails":50,"../internals/whitespaces":147}],127:[function(n,s,o){function a(d){return function(c){var f=String(i(c));return 1&d&&(f=f.replace(u,"")),2&d&&(f=f.replace(h,"")),f}}var i=n("../internals/require-object-coercible"),l="["+n("../internals/whitespaces")+"]",u=RegExp("^"+l+l+"*"),h=RegExp(l+l+"*$");s.exports={start:a(1),end:a(2),trim:a(3)}},{"../internals/require-object-coercible":113,"../internals/whitespaces":147}],128:[function(n,s,o){function a(F){if(M.hasOwnProperty(F)){var B=M[F];delete M[F],B()}}function i(F){return function(){a(F)}}function l(F){a(F.data)}function u(F){f.postMessage(F+"",w.protocol+"//"+w.host)}var h,d,c,f=n("../internals/global"),p=n("../internals/fails"),m=n("../internals/classof-raw"),g=n("../internals/function-bind-context"),y=n("../internals/html"),v=n("../internals/document-create-element"),b=n("../internals/engine-is-ios"),w=f.location,_=f.setImmediate,I=f.clearImmediate,C=f.process,N=f.MessageChannel,O=f.Dispatch,D=0,M={},P="onreadystatechange";_&&I||(_=function(F){for(var B=[],z=1;z<arguments.length;)B.push(arguments[z++]);return M[++D]=function(){(typeof F=="function"?F:Function(F)).apply(void 0,B)},h(D),D},I=function(F){delete M[F]},m(C)=="process"?h=function(F){C.nextTick(i(F))}:O&&O.now?h=function(F){O.now(i(F))}:N&&!b?(c=(d=new N).port2,d.port1.onmessage=l,h=g(c.postMessage,c,1)):!f.addEventListener||typeof postMessage!="function"||f.importScripts||p(u)||w.protocol==="file:"?h=P in v("script")?function(F){y.appendChild(v("script"))[P]=function(){y.removeChild(this),a(F)}}:function(F){setTimeout(i(F),0)}:(h=u,f.addEventListener("message",l,!1))),s.exports={set:_,clear:I}},{"../internals/classof-raw":28,"../internals/document-create-element":43,"../internals/engine-is-ios":45,"../internals/fails":50,"../internals/function-bind-context":54,"../internals/global":59,"../internals/html":63}],129:[function(n,s,o){var a=n("../internals/classof-raw");s.exports=function(i){if(typeof i!="number"&&a(i)!="Number")throw TypeError("Incorrect invocation");return+i}},{"../internals/classof-raw":28}],130:[function(n,s,o){var a=n("../internals/to-integer"),i=Math.max,l=Math.min;s.exports=function(u,h){var d=a(u);return d<0?i(d+h,0):l(d,h)}},{"../internals/to-integer":133}],131:[function(n,s,o){var a=n("../internals/to-integer"),i=n("../internals/to-length");s.exports=function(l){if(l===void 0)return 0;var u=a(l),h=i(u);if(u!==h)throw RangeError("Wrong length or index");return h}},{"../internals/to-integer":133,"../internals/to-length":134}],132:[function(n,s,o){var a=n("../internals/indexed-object"),i=n("../internals/require-object-coercible");s.exports=function(l){return a(i(l))}},{"../internals/indexed-object":66,"../internals/require-object-coercible":113}],133:[function(n,s,o){var a=Math.ceil,i=Math.floor;s.exports=function(l){return isNaN(l=+l)?0:(0<l?i:a)(l)}},{}],134:[function(n,s,o){var a=n("../internals/to-integer"),i=Math.min;s.exports=function(l){return 0<l?i(a(l),9007199254740991):0}},{"../internals/to-integer":133}],135:[function(n,s,o){var a=n("../internals/require-object-coercible");s.exports=function(i){return Object(a(i))}},{"../internals/require-object-coercible":113}],136:[function(n,s,o){var a=n("../internals/to-positive-integer");s.exports=function(i,l){var u=a(i);if(u%l)throw RangeError("Wrong offset");return u}},{"../internals/to-positive-integer":137}],137:[function(n,s,o){var a=n("../internals/to-integer");s.exports=function(i){var l=a(i);if(l<0)throw RangeError("The argument can't be less than 0");return l}},{"../internals/to-integer":133}],138:[function(n,s,o){var a=n("../internals/is-object");s.exports=function(i,l){if(!a(i))return i;var u,h;if(l&&typeof(u=i.toString)=="function"&&!a(h=u.call(i))||typeof(u=i.valueOf)=="function"&&!a(h=u.call(i))||!l&&typeof(u=i.toString)=="function"&&!a(h=u.call(i)))return h;throw TypeError("Can't convert object to primitive value")}},{"../internals/is-object":74}],139:[function(n,s,o){var a={};a[n("../internals/well-known-symbol")("toStringTag")]="z",s.exports=String(a)==="[object z]"},{"../internals/well-known-symbol":146}],140:[function(n,s,o){function a(Ne,rt){for(var tt=0,Je=rt.length,xt=new(Fe(Ne))(Je);tt<Je;)xt[tt]=rt[tt++];return xt}function i(Ne,rt){ye(Ne,rt,{get:function(){return be(this)[rt]}})}function l(Ne){var rt;return Ne instanceof j||(rt=D(Ne))=="ArrayBuffer"||rt=="SharedArrayBuffer"}function u(Ne,rt){return me(Ne)&&typeof rt!="symbol"&&rt in Ne&&String(+rt)==String(rt)}function h(Ne,rt){return u(Ne,rt=N(rt,!0))?b(2,Ne[rt]):Oe(Ne,rt)}function d(Ne,rt,tt){return!(u(Ne,rt=N(rt,!0))&&M(tt)&&O(tt,"value"))||O(tt,"get")||O(tt,"set")||tt.configurable||O(tt,"writable")&&!tt.writable||O(tt,"enumerable")&&!tt.enumerable?ye(Ne,rt,tt):(Ne[rt]=tt.value,Ne)}var c=n("../internals/export"),f=n("../internals/global"),p=n("../internals/descriptors"),m=n("../internals/typed-array-constructors-require-wrappers"),g=n("../internals/array-buffer-view-core"),y=n("../internals/array-buffer"),v=n("../internals/an-instance"),b=n("../internals/create-property-descriptor"),w=n("../internals/create-non-enumerable-property"),_=n("../internals/to-length"),I=n("../internals/to-index"),C=n("../internals/to-offset"),N=n("../internals/to-primitive"),O=n("../internals/has"),D=n("../internals/classof"),M=n("../internals/is-object"),P=n("../internals/object-create"),F=n("../internals/object-set-prototype-of"),B=n("../internals/object-get-own-property-names").f,z=n("../internals/typed-array-from"),Z=n("../internals/array-iteration").forEach,Q=n("../internals/set-species"),K=n("../internals/object-define-property"),ne=n("../internals/object-get-own-property-descriptor"),re=n("../internals/internal-state"),ce=n("../internals/inherit-if-required"),be=re.get,we=re.set,ye=K.f,Oe=ne.f,Se=Math.round,Ee=f.RangeError,j=y.ArrayBuffer,W=y.DataView,J=g.NATIVE_ARRAY_BUFFER_VIEWS,ie=g.TYPED_ARRAY_TAG,ve=g.TypedArray,he=g.TypedArrayPrototype,Fe=g.aTypedArrayConstructor,me=g.isTypedArray,Le="BYTES_PER_ELEMENT",De="Wrong length";p?(J||(ne.f=h,K.f=d,i(he,"buffer"),i(he,"byteOffset"),i(he,"byteLength"),i(he,"length")),c({target:"Object",stat:!0,forced:!J},{getOwnPropertyDescriptor:h,defineProperty:d}),s.exports=function(Ne,rt,tt){function Je(Ft,Be){ye(Ft,Be,{get:function(){return qt=Be,(Y=be(this)).view[Dt](qt*xt+Y.byteOffset,!0);var qt,Y},set:function(qt){return Y=Be,le=qt,ee=be(this),tt&&(le=(le=Se(le))<0?0:255<le?255:255&le),void ee.view[St](Y*xt+ee.byteOffset,le,!0);var Y,le,ee},enumerable:!0})}var xt=Ne.match(/\d+$/)[0]/8,Pt=Ne+(tt?"Clamped":"")+"Array",Dt="get"+Ne,St="set"+Ne,Jt=f[Pt],ht=Jt,ct=ht&&ht.prototype,At={};J?m&&(ht=rt(function(Ft,Be,qt,Y){return v(Ft,ht,Pt),ce(M(Be)?l(Be)?Y!==void 0?new Jt(Be,C(qt,xt),Y):qt!==void 0?new Jt(Be,C(qt,xt)):new Jt(Be):me(Be)?a(ht,Be):z.call(ht,Be):new Jt(I(Be)),Ft,ht)}),F&&F(ht,ve),Z(B(Jt),function(Ft){Ft in ht||w(ht,Ft,Jt[Ft])}),ht.prototype=ct):(ht=rt(function(Ft,Be,qt,Y){v(Ft,ht,Pt);var le,ee,ue,Ae=0,Ke=0;if(M(Be)){if(!l(Be))return me(Be)?a(ht,Be):z.call(ht,Be);le=Be,Ke=C(qt,xt);var ot=Be.byteLength;if(Y===void 0){if(ot%xt||(ee=ot-Ke)<0)throw Ee(De)}else if(ot<(ee=_(Y)*xt)+Ke)throw Ee(De);ue=ee/xt}else ue=I(Be),le=new j(ee=ue*xt);for(we(Ft,{buffer:le,byteOffset:Ke,byteLength:ee,length:ue,view:new W(le)});Ae<ue;)Je(Ft,Ae++)}),F&&F(ht,ve),ct=ht.prototype=P(he)),ct.constructor!==ht&&w(ct,"constructor",ht),ie&&w(ct,ie,Pt),At[Pt]=ht,c({global:!0,forced:ht!=Jt,sham:!J},At),Le in ht||w(ht,Le,xt),Le in ct||w(ct,Le,xt),Q(Pt)}):s.exports=function(){}},{"../internals/an-instance":9,"../internals/array-buffer":13,"../internals/array-buffer-view-core":12,"../internals/array-iteration":19,"../internals/classof":29,"../internals/create-non-enumerable-property":37,"../internals/create-property-descriptor":38,"../internals/descriptors":42,"../internals/export":49,"../internals/global":59,"../internals/has":60,"../internals/inherit-if-required":67,"../internals/internal-state":70,"../internals/is-object":74,"../internals/object-create":90,"../internals/object-define-property":92,"../internals/object-get-own-property-descriptor":93,"../internals/object-get-own-property-names":95,"../internals/object-set-prototype-of":101,"../internals/set-species":116,"../internals/to-index":131,"../internals/to-length":134,"../internals/to-offset":136,"../internals/to-primitive":138,"../internals/typed-array-constructors-require-wrappers":141,"../internals/typed-array-from":142}],141:[function(n,s,o){var a=n("../internals/global"),i=n("../internals/fails"),l=n("../internals/check-correctness-of-iteration"),u=n("../internals/array-buffer-view-core").NATIVE_ARRAY_BUFFER_VIEWS,h=a.ArrayBuffer,d=a.Int8Array;s.exports=!u||!i(function(){d(1)})||!i(function(){new d(-1)})||!l(function(c){new d,new d(null),new d(1.5),new d(c)},!0)||i(function(){return new d(new h(2),1,void 0).length!==1})},{"../internals/array-buffer-view-core":12,"../internals/check-correctness-of-iteration":27,"../internals/fails":50,"../internals/global":59}],142:[function(n,s,o){var a=n("../internals/to-object"),i=n("../internals/to-length"),l=n("../internals/get-iterator-method"),u=n("../internals/is-array-iterator-method"),h=n("../internals/function-bind-context"),d=n("../internals/array-buffer-view-core").aTypedArrayConstructor;s.exports=function(c,f,p){var m,g,y,v,b,w,_=a(c),I=arguments.length,C=1<I?f:void 0,N=C!==void 0,O=l(_);if(O!=null&&!u(O))for(w=(b=O.call(_)).next,_=[];!(v=w.call(b)).done;)_.push(v.value);for(N&&2<I&&(C=h(C,p,2)),g=i(_.length),y=new(d(this))(g),m=0;m<g;m++)y[m]=N?C(_[m],m):_[m];return y}},{"../internals/array-buffer-view-core":12,"../internals/function-bind-context":54,"../internals/get-iterator-method":57,"../internals/is-array-iterator-method":71,"../internals/to-length":134,"../internals/to-object":135}],143:[function(n,s,o){var a=0,i=Math.random();s.exports=function(l){return"Symbol("+String(l===void 0?"":l)+")_"+(++a+i).toString(36)}},{}],144:[function(n,s,o){var a=n("../internals/native-symbol");s.exports=a&&!Symbol.sham&&typeof Symbol.iterator=="symbol"},{"../internals/native-symbol":83}],145:[function(n,s,o){var a=n("../internals/well-known-symbol");o.f=a},{"../internals/well-known-symbol":146}],146:[function(n,s,o){var a=n("../internals/global"),i=n("../internals/shared"),l=n("../internals/has"),u=n("../internals/uid"),h=n("../internals/native-symbol"),d=n("../internals/use-symbol-as-uid"),c=i("wks"),f=a.Symbol,p=d?f:f&&f.withoutSetter||u;s.exports=function(m){return l(c,m)||(h&&l(f,m)?c[m]=f[m]:c[m]=p("Symbol."+m)),c[m]}},{"../internals/global":59,"../internals/has":60,"../internals/native-symbol":83,"../internals/shared":120,"../internals/uid":143,"../internals/use-symbol-as-uid":144}],147:[function(n,s,o){s.exports=`	
\v\f\r \xA0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF`},{}],148:[function(n,s,o){var a=n("../internals/export"),i=n("../internals/global"),l=n("../internals/array-buffer"),u=n("../internals/set-species"),h="ArrayBuffer",d=l[h];a({global:!0,forced:i[h]!==d},{ArrayBuffer:d}),u(h)},{"../internals/array-buffer":13,"../internals/export":49,"../internals/global":59,"../internals/set-species":116}],149:[function(n,s,o){function a(C){if(!h(C))return!1;var N=C[v];return N!==void 0?!!N:u(C)}var i=n("../internals/export"),l=n("../internals/fails"),u=n("../internals/is-array"),h=n("../internals/is-object"),d=n("../internals/to-object"),c=n("../internals/to-length"),f=n("../internals/create-property"),p=n("../internals/array-species-create"),m=n("../internals/array-method-has-species-support"),g=n("../internals/well-known-symbol"),y=n("../internals/engine-v8-version"),v=g("isConcatSpreadable"),b=9007199254740991,w="Maximum allowed index exceeded",_=51<=y||!l(function(){var C=[];return C[v]=!1,C.concat()[0]!==C}),I=m("concat");i({target:"Array",proto:!0,forced:!_||!I},{concat:function(C){var N,O,D,M,P,F=d(this),B=p(F,0),z=0;for(N=-1,D=arguments.length;N<D;N++)if(a(P=N===-1?F:arguments[N])){if(M=c(P.length),b<z+M)throw TypeError(w);for(O=0;O<M;O++,z++)O in P&&f(B,z,P[O])}else{if(b<=z)throw TypeError(w);f(B,z++,P)}return B.length=z,B}})},{"../internals/array-method-has-species-support":21,"../internals/array-species-create":25,"../internals/create-property":39,"../internals/engine-v8-version":47,"../internals/export":49,"../internals/fails":50,"../internals/is-array":72,"../internals/is-object":74,"../internals/to-length":134,"../internals/to-object":135,"../internals/well-known-symbol":146}],150:[function(n,s,o){var a=n("../internals/export"),i=n("../internals/array-iteration").every,l=n("../internals/array-method-is-strict"),u=n("../internals/array-method-uses-to-length"),h=l("every"),d=u("every");a({target:"Array",proto:!0,forced:!h||!d},{every:function(c,f){return i(this,c,1<arguments.length?f:void 0)}})},{"../internals/array-iteration":19,"../internals/array-method-is-strict":22,"../internals/array-method-uses-to-length":23,"../internals/export":49}],151:[function(n,s,o){var a=n("../internals/export"),i=n("../internals/array-fill"),l=n("../internals/add-to-unscopables");a({target:"Array",proto:!0},{fill:i}),l("fill")},{"../internals/add-to-unscopables":7,"../internals/array-fill":15,"../internals/export":49}],152:[function(n,s,o){var a=n("../internals/export"),i=n("../internals/array-iteration").filter,l=n("../internals/array-method-has-species-support"),u=n("../internals/array-method-uses-to-length"),h=l("filter"),d=u("filter");a({target:"Array",proto:!0,forced:!h||!d},{filter:function(c,f){return i(this,c,1<arguments.length?f:void 0)}})},{"../internals/array-iteration":19,"../internals/array-method-has-species-support":21,"../internals/array-method-uses-to-length":23,"../internals/export":49}],153:[function(n,s,o){var a=n("../internals/export"),i=n("../internals/flatten-into-array"),l=n("../internals/to-object"),u=n("../internals/to-length"),h=n("../internals/a-function"),d=n("../internals/array-species-create");a({target:"Array",proto:!0},{flatMap:function(c,f){var p,m=l(this),g=u(m.length);return h(c),(p=d(m,0)).length=i(p,m,m,g,0,1,c,1<arguments.length?f:void 0),p}})},{"../internals/a-function":5,"../internals/array-species-create":25,"../internals/export":49,"../internals/flatten-into-array":52,"../internals/to-length":134,"../internals/to-object":135}],154:[function(n,s,o){var a=n("../internals/export"),i=n("../internals/array-for-each");a({target:"Array",proto:!0,forced:[].forEach!=i},{forEach:i})},{"../internals/array-for-each":16,"../internals/export":49}],155:[function(n,s,o){var a=n("../internals/export"),i=n("../internals/array-from");a({target:"Array",stat:!0,forced:!n("../internals/check-correctness-of-iteration")(function(l){Array.from(l)})},{from:i})},{"../internals/array-from":17,"../internals/check-correctness-of-iteration":27,"../internals/export":49}],156:[function(n,s,o){var a=n("../internals/export"),i=n("../internals/array-includes").includes,l=n("../internals/add-to-unscopables");a({target:"Array",proto:!0,forced:!n("../internals/array-method-uses-to-length")("indexOf",{ACCESSORS:!0,1:0})},{includes:function(u,h){return i(this,u,1<arguments.length?h:void 0)}}),l("includes")},{"../internals/add-to-unscopables":7,"../internals/array-includes":18,"../internals/array-method-uses-to-length":23,"../internals/export":49}],157:[function(n,s,o){var a=n("../internals/export"),i=n("../internals/array-includes").indexOf,l=n("../internals/array-method-is-strict"),u=n("../internals/array-method-uses-to-length"),h=[].indexOf,d=!!h&&1/[1].indexOf(1,-0)<0,c=l("indexOf"),f=u("indexOf",{ACCESSORS:!0,1:0});a({target:"Array",proto:!0,forced:d||!c||!f},{indexOf:function(p,m){return d?h.apply(this,arguments)||0:i(this,p,1<arguments.length?m:void 0)}})},{"../internals/array-includes":18,"../internals/array-method-is-strict":22,"../internals/array-method-uses-to-length":23,"../internals/export":49}],158:[function(n,s,o){var a=n("../internals/to-indexed-object"),i=n("../internals/add-to-unscopables"),l=n("../internals/iterators"),u=n("../internals/internal-state"),h=n("../internals/define-iterator"),d="Array Iterator",c=u.set,f=u.getterFor(d);s.exports=h(Array,"Array",function(p,m){c(this,{type:d,target:a(p),index:0,kind:m})},function(){var p=f(this),m=p.target,g=p.kind,y=p.index++;return!m||y>=m.length?{value:p.target=void 0,done:!0}:g=="keys"?{value:y,done:!1}:g=="values"?{value:m[y],done:!1}:{value:[y,m[y]],done:!1}},"values"),l.Arguments=l.Array,i("keys"),i("values"),i("entries")},{"../internals/add-to-unscopables":7,"../internals/define-iterator":40,"../internals/internal-state":70,"../internals/iterators":79,"../internals/to-indexed-object":132}],159:[function(n,s,o){var a=n("../internals/export"),i=n("../internals/indexed-object"),l=n("../internals/to-indexed-object"),u=n("../internals/array-method-is-strict"),h=[].join,d=i!=Object,c=u("join",",");a({target:"Array",proto:!0,forced:d||!c},{join:function(f){return h.call(l(this),f===void 0?",":f)}})},{"../internals/array-method-is-strict":22,"../internals/export":49,"../internals/indexed-object":66,"../internals/to-indexed-object":132}],160:[function(n,s,o){var a=n("../internals/export"),i=n("../internals/array-last-index-of");a({target:"Array",proto:!0,forced:i!==[].lastIndexOf},{lastIndexOf:i})},{"../internals/array-last-index-of":20,"../internals/export":49}],161:[function(n,s,o){var a=n("../internals/export"),i=n("../internals/array-iteration").map,l=n("../internals/array-method-has-species-support"),u=n("../internals/array-method-uses-to-length"),h=l("map"),d=u("map");a({target:"Array",proto:!0,forced:!h||!d},{map:function(c,f){return i(this,c,1<arguments.length?f:void 0)}})},{"../internals/array-iteration":19,"../internals/array-method-has-species-support":21,"../internals/array-method-uses-to-length":23,"../internals/export":49}],162:[function(n,s,o){var a=n("../internals/export"),i=n("../internals/is-object"),l=n("../internals/is-array"),u=n("../internals/to-absolute-index"),h=n("../internals/to-length"),d=n("../internals/to-indexed-object"),c=n("../internals/create-property"),f=n("../internals/well-known-symbol"),p=n("../internals/array-method-has-species-support"),m=n("../internals/array-method-uses-to-length"),g=p("slice"),y=m("slice",{ACCESSORS:!0,0:0,1:2}),v=f("species"),b=[].slice,w=Math.max;a({target:"Array",proto:!0,forced:!g||!y},{slice:function(_,I){var C,N,O,D=d(this),M=h(D.length),P=u(_,M),F=u(I===void 0?M:I,M);if(l(D)&&(typeof(C=D.constructor)!="function"||C!==Array&&!l(C.prototype)?i(C)&&(C=C[v])===null&&(C=void 0):C=void 0,C===Array||C===void 0))return b.call(D,P,F);for(N=new(C===void 0?Array:C)(w(F-P,0)),O=0;P<F;P++,O++)P in D&&c(N,O,D[P]);return N.length=O,N}})},{"../internals/array-method-has-species-support":21,"../internals/array-method-uses-to-length":23,"../internals/create-property":39,"../internals/export":49,"../internals/is-array":72,"../internals/is-object":74,"../internals/to-absolute-index":130,"../internals/to-indexed-object":132,"../internals/to-length":134,"../internals/well-known-symbol":146}],163:[function(n,s,o){var a=n("../internals/export"),i=n("../internals/array-iteration").some,l=n("../internals/array-method-is-strict"),u=n("../internals/array-method-uses-to-length"),h=l("some"),d=u("some");a({target:"Array",proto:!0,forced:!h||!d},{some:function(c,f){return i(this,c,1<arguments.length?f:void 0)}})},{"../internals/array-iteration":19,"../internals/array-method-is-strict":22,"../internals/array-method-uses-to-length":23,"../internals/export":49}],164:[function(n,s,o){var a=n("../internals/export"),i=n("../internals/to-absolute-index"),l=n("../internals/to-integer"),u=n("../internals/to-length"),h=n("../internals/to-object"),d=n("../internals/array-species-create"),c=n("../internals/create-property"),f=n("../internals/array-method-has-species-support"),p=n("../internals/array-method-uses-to-length"),m=f("splice"),g=p("splice",{ACCESSORS:!0,0:0,1:2}),y=Math.max,v=Math.min;a({target:"Array",proto:!0,forced:!m||!g},{splice:function(b,w){var _,I,C,N,O,D,M=h(this),P=u(M.length),F=i(b,P),B=arguments.length;if(B===0?_=I=0:I=B===1?(_=0,P-F):(_=B-2,v(y(l(w),0),P-F)),9007199254740991<P+_-I)throw TypeError("Maximum allowed length exceeded");for(C=d(M,I),N=0;N<I;N++)(O=F+N)in M&&c(C,N,M[O]);if(_<(C.length=I)){for(N=F;N<P-I;N++)D=N+_,(O=N+I)in M?M[D]=M[O]:delete M[D];for(N=P;P-I+_<N;N--)delete M[N-1]}else if(I<_)for(N=P-I;F<N;N--)D=N+_-1,(O=N+I-1)in M?M[D]=M[O]:delete M[D];for(N=0;N<_;N++)M[N+F]=arguments[N+2];return M.length=P-I+_,C}})},{"../internals/array-method-has-species-support":21,"../internals/array-method-uses-to-length":23,"../internals/array-species-create":25,"../internals/create-property":39,"../internals/export":49,"../internals/to-absolute-index":130,"../internals/to-integer":133,"../internals/to-length":134,"../internals/to-object":135}],165:[function(n,s,o){n("../internals/add-to-unscopables")("flatMap")},{"../internals/add-to-unscopables":7}],166:[function(n,s,o){var a=n("../internals/descriptors"),i=n("../internals/object-define-property").f,l=Function.prototype,u=l.toString,h=/^\s*function ([^ (]*)/;!a||"name"in l||i(l,"name",{configurable:!0,get:function(){try{return u.call(this).match(h)[1]}catch{return""}}})},{"../internals/descriptors":42,"../internals/object-define-property":92}],167:[function(n,s,o){var a=n("../internals/collection"),i=n("../internals/collection-strong");s.exports=a("Map",function(l){return function(u){return l(this,arguments.length?u:void 0)}},i)},{"../internals/collection":31,"../internals/collection-strong":30}],168:[function(n,s,o){var a=n("../internals/export"),i=Math.hypot,l=Math.abs,u=Math.sqrt;a({target:"Math",stat:!0,forced:!!i&&i(1/0,NaN)!==1/0},{hypot:function(h,d){for(var c,f,p=0,m=0,g=arguments.length,y=0;m<g;)y<(c=l(arguments[m++]))?(p=p*(f=y/c)*f+1,y=c):p+=0<c?(f=c/y)*f:c;return y===1/0?1/0:y*u(p)}})},{"../internals/export":49}],169:[function(n,s,o){n("../internals/export")({target:"Math",stat:!0},{sign:n("../internals/math-sign")})},{"../internals/export":49,"../internals/math-sign":80}],170:[function(n,s,o){function a(F){var B,z,Z,Q,K,ne,re,ce,be=p(F,!1);if(typeof be=="string"&&2<be.length){if((B=(be=w(be)).charCodeAt(0))===43||B===45){if((z=be.charCodeAt(2))===88||z===120)return NaN}else if(B===48){switch(be.charCodeAt(1)){case 66:case 98:Z=2,Q=49;break;case 79:case 111:Z=8,Q=55;break;default:return+be}for(ne=(K=be.slice(2)).length,re=0;re<ne;re++)if((ce=K.charCodeAt(re))<48||Q<ce)return NaN;return parseInt(K,Z)}}return+be}var i=n("../internals/descriptors"),l=n("../internals/global"),u=n("../internals/is-forced"),h=n("../internals/redefine"),d=n("../internals/has"),c=n("../internals/classof-raw"),f=n("../internals/inherit-if-required"),p=n("../internals/to-primitive"),m=n("../internals/fails"),g=n("../internals/object-create"),y=n("../internals/object-get-own-property-names").f,v=n("../internals/object-get-own-property-descriptor").f,b=n("../internals/object-define-property").f,w=n("../internals/string-trim").trim,_="Number",I=l[_],C=I.prototype,N=c(g(C))==_;if(u(_,!I(" 0o1")||!I("0b1")||I("+0x1"))){for(var O,D=function(F){var B=arguments.length<1?0:F,z=this;return z instanceof D&&(N?m(function(){C.valueOf.call(z)}):c(z)!=_)?f(new I(a(B)),z,D):a(B)},M=i?y(I):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),P=0;M.length>P;P++)d(I,O=M[P])&&!d(D,O)&&b(D,O,v(I,O));(D.prototype=C).constructor=D,h(l,_,D)}},{"../internals/classof-raw":28,"../internals/descriptors":42,"../internals/fails":50,"../internals/global":59,"../internals/has":60,"../internals/inherit-if-required":67,"../internals/is-forced":73,"../internals/object-create":90,"../internals/object-define-property":92,"../internals/object-get-own-property-descriptor":93,"../internals/object-get-own-property-names":95,"../internals/redefine":108,"../internals/string-trim":127,"../internals/to-primitive":138}],171:[function(n,s,o){n("../internals/export")({target:"Number",stat:!0},{isFinite:n("../internals/number-is-finite")})},{"../internals/export":49,"../internals/number-is-finite":88}],172:[function(n,s,o){var a=n("../internals/export"),i=n("../internals/to-integer"),l=n("../internals/this-number-value"),u=n("../internals/string-repeat"),h=n("../internals/fails"),d=1 .toFixed,c=Math.floor,f=function(p,m,g){return m===0?g:m%2==1?f(p,m-1,g*p):f(p*p,m/2,g)};a({target:"Number",proto:!0,forced:d&&(8e-5 .toFixed(3)!=="0.000"||.9 .toFixed(0)!=="1"||1.255 .toFixed(2)!=="1.25"||0xde0b6b3a7640080 .toFixed(0)!=="1000000000000000128")||!h(function(){d.call({})})},{toFixed:function(p){function m(M,P){for(var F=-1,B=P;++F<6;)B+=M*N[F],N[F]=B%1e7,B=c(B/1e7)}function g(M){for(var P=6,F=0;0<=--P;)F+=N[P],N[P]=c(F/M),F=F%M*1e7}function y(){for(var M=6,P="";0<=--M;)if(P!==""||M===0||N[M]!==0){var F=String(N[M]);P=P===""?F:P+u.call("0",7-F.length)+F}return P}var v,b,w,_,I=l(this),C=i(p),N=[0,0,0,0,0,0],O="",D="0";if(C<0||20<C)throw RangeError("Incorrect fraction digits");if(I!=I)return"NaN";if(I<=-1e21||1e21<=I)return String(I);if(I<0&&(O="-",I=-I),1e-21<I)if(b=(v=function(M){for(var P=0,F=M;4096<=F;)P+=12,F/=4096;for(;2<=F;)P+=1,F/=2;return P}(I*f(2,69,1))-69)<0?I*f(2,-v,1):I/f(2,v,1),b*=4503599627370496,0<(v=52-v)){for(m(0,b),w=C;7<=w;)m(1e7,0),w-=7;for(m(f(10,w,1),0),w=v-1;23<=w;)g(1<<23),w-=23;g(1<<w),m(1,1),g(2),D=y()}else m(0,b),m(1<<-v,0),D=y()+u.call("0",C);return D=0<C?O+((_=D.length)<=C?"0."+u.call("0",C-_)+D:D.slice(0,_-C)+"."+D.slice(_-C)):O+D}})},{"../internals/export":49,"../internals/fails":50,"../internals/string-repeat":125,"../internals/this-number-value":129,"../internals/to-integer":133}],173:[function(n,s,o){var a=n("../internals/export"),i=n("../internals/object-assign");a({target:"Object",stat:!0,forced:Object.assign!==i},{assign:i})},{"../internals/export":49,"../internals/object-assign":89}],174:[function(n,s,o){var a=n("../internals/export"),i=n("../internals/fails"),l=n("../internals/object-get-own-property-names-external").f;a({target:"Object",stat:!0,forced:i(function(){return!Object.getOwnPropertyNames(1)})},{getOwnPropertyNames:l})},{"../internals/export":49,"../internals/fails":50,"../internals/object-get-own-property-names-external":94}],175:[function(n,s,o){var a=n("../internals/export"),i=n("../internals/fails"),l=n("../internals/to-object"),u=n("../internals/object-get-prototype-of"),h=n("../internals/correct-prototype-getter");a({target:"Object",stat:!0,forced:i(function(){u(1)}),sham:!h},{getPrototypeOf:function(d){return u(l(d))}})},{"../internals/correct-prototype-getter":34,"../internals/export":49,"../internals/fails":50,"../internals/object-get-prototype-of":97,"../internals/to-object":135}],176:[function(n,s,o){var a=n("../internals/export"),i=n("../internals/to-object"),l=n("../internals/object-keys");a({target:"Object",stat:!0,forced:n("../internals/fails")(function(){l(1)})},{keys:function(u){return l(i(u))}})},{"../internals/export":49,"../internals/fails":50,"../internals/object-keys":99,"../internals/to-object":135}],177:[function(n,s,o){var a=n("../internals/to-string-tag-support"),i=n("../internals/redefine"),l=n("../internals/object-to-string");a||i(Object.prototype,"toString",l,{unsafe:!0})},{"../internals/object-to-string":102,"../internals/redefine":108,"../internals/to-string-tag-support":139}],178:[function(n,s,o){function a(ht){var ct;return!(!N(ht)||typeof(ct=ht.then)!="function")&&ct}function i(ht,ct,At){if(!ct.notified){ct.notified=!0;var Ft=ct.reactions;Q(function(){for(var Be=ct.value,qt=ct.state==1,Y=0;Ft.length>Y;){var le,ee,ue,Ae=Ft[Y++],Ke=qt?Ae.ok:Ae.fail,ot=Ae.resolve,vt=Ae.reject,Pe=Ae.domain;try{Ke?(qt||(ct.rejection===2&&St(ht,ct),ct.rejection=1),Ke===!0?le=Be:(Pe&&Pe.enter(),le=Ke(Be),Pe&&(Pe.exit(),ue=!0)),le===Ae.promise?vt(ve("Promise-chain cycle")):(ee=a(le))?ee.call(le,ot,vt):ot(le)):vt(Be)}catch(Mt){Pe&&!ue&&Pe.exit(),vt(Mt)}}ct.reactions=[],ct.notified=!1,At&&!ct.rejection&&Pt(ht,ct)})}}function l(ht,ct,At){var Ft,Be;rt?((Ft=he.createEvent("Event")).promise=ct,Ft.reason=At,Ft.initEvent(ht,!1,!0),y.dispatchEvent(Ft)):Ft={promise:ct,reason:At},(Be=y["on"+ht])?Be(Ft):ht===tt&&ne("Unhandled promise rejection",At)}function u(ht,ct,At,Ft){return function(Be){ht(ct,At,Be,Ft)}}function h(ht,ct,At,Ft){ct.done||(ct.done=!0,Ft&&(ct=Ft),ct.value=At,ct.state=2,i(ht,ct,!0))}var d,c,f,p,m=n("../internals/export"),g=n("../internals/is-pure"),y=n("../internals/global"),v=n("../internals/get-built-in"),b=n("../internals/native-promise-constructor"),w=n("../internals/redefine"),_=n("../internals/redefine-all"),I=n("../internals/set-to-string-tag"),C=n("../internals/set-species"),N=n("../internals/is-object"),O=n("../internals/a-function"),D=n("../internals/an-instance"),M=n("../internals/classof-raw"),P=n("../internals/inspect-source"),F=n("../internals/iterate"),B=n("../internals/check-correctness-of-iteration"),z=n("../internals/species-constructor"),Z=n("../internals/task").set,Q=n("../internals/microtask"),K=n("../internals/promise-resolve"),ne=n("../internals/host-report-errors"),re=n("../internals/new-promise-capability"),ce=n("../internals/perform"),be=n("../internals/internal-state"),we=n("../internals/is-forced"),ye=n("../internals/well-known-symbol"),Oe=n("../internals/engine-v8-version"),Se=ye("species"),Ee="Promise",j=be.get,W=be.set,J=be.getterFor(Ee),ie=b,ve=y.TypeError,he=y.document,Fe=y.process,me=v("fetch"),Le=re.f,De=Le,Ne=M(Fe)=="process",rt=!!(he&&he.createEvent&&y.dispatchEvent),tt="unhandledrejection",Je=we(Ee,function(){if(P(ie)===String(ie)&&(Oe===66||!Ne&&typeof PromiseRejectionEvent!="function")||g&&!ie.prototype.finally)return!0;if(51<=Oe&&/native code/.test(ie))return!1;function ht(At){At(function(){},function(){})}var ct=ie.resolve(1);return(ct.constructor={})[Se]=ht,!(ct.then(function(){})instanceof ht)}),xt=Je||!B(function(ht){ie.all(ht).catch(function(){})}),Pt=function(ht,ct){Z.call(y,function(){var At,Ft=ct.value;if(Dt(ct)&&(At=ce(function(){Ne?Fe.emit("unhandledRejection",Ft,ht):l(tt,ht,Ft)}),ct.rejection=Ne||Dt(ct)?2:1,At.error))throw At.value})},Dt=function(ht){return ht.rejection!==1&&!ht.parent},St=function(ht,ct){Z.call(y,function(){Ne?Fe.emit("rejectionHandled",ht):l("rejectionhandled",ht,ct.value)})},Jt=function(ht,ct,At,Ft){if(!ct.done){ct.done=!0,Ft&&(ct=Ft);try{if(ht===At)throw ve("Promise can't be resolved itself");var Be=a(At);Be?Q(function(){var qt={done:!1};try{Be.call(At,u(Jt,ht,qt,ct),u(h,ht,qt,ct))}catch(Y){h(ht,qt,Y,ct)}}):(ct.value=At,ct.state=1,i(ht,ct,!1))}catch(qt){h(ht,{done:!1},qt,ct)}}};Je&&(ie=function(ht){D(this,ie,Ee),O(ht),d.call(this);var ct=j(this);try{ht(u(Jt,this,ct),u(h,this,ct))}catch(At){h(this,ct,At)}},(d=function(){W(this,{type:Ee,done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})}).prototype=_(ie.prototype,{then:function(ht,ct){var At=J(this),Ft=Le(z(this,ie));return Ft.ok=typeof ht!="function"||ht,Ft.fail=typeof ct=="function"&&ct,Ft.domain=Ne?Fe.domain:void 0,At.parent=!0,At.reactions.push(Ft),At.state!=0&&i(this,At,!1),Ft.promise},catch:function(ht){return this.then(void 0,ht)}}),c=function(){var ht=new d,ct=j(ht);this.promise=ht,this.resolve=u(Jt,ht,ct),this.reject=u(h,ht,ct)},re.f=Le=function(ht){return ht===ie||ht===f?new c(ht):De(ht)},g||typeof b!="function"||(p=b.prototype.then,w(b.prototype,"then",function(ht,ct){var At=this;return new ie(function(Ft,Be){p.call(At,Ft,Be)}).then(ht,ct)},{unsafe:!0}),typeof me=="function"&&m({global:!0,enumerable:!0,forced:!0},{fetch:function(ht){return K(ie,me.apply(y,arguments))}}))),m({global:!0,wrap:!0,forced:Je},{Promise:ie}),I(ie,Ee,!1,!0),C(Ee),f=v(Ee),m({target:Ee,stat:!0,forced:Je},{reject:function(ht){var ct=Le(this);return ct.reject.call(void 0,ht),ct.promise}}),m({target:Ee,stat:!0,forced:g||Je},{resolve:function(ht){return K(g&&this===f?ie:this,ht)}}),m({target:Ee,stat:!0,forced:xt},{all:function(ht){var ct=this,At=Le(ct),Ft=At.resolve,Be=At.reject,qt=ce(function(){var Y=O(ct.resolve),le=[],ee=0,ue=1;F(ht,function(Ae){var Ke=ee++,ot=!1;le.push(void 0),ue++,Y.call(ct,Ae).then(function(vt){ot||(ot=!0,le[Ke]=vt,--ue||Ft(le))},Be)}),--ue||Ft(le)});return qt.error&&Be(qt.value),At.promise},race:function(ht){var ct=this,At=Le(ct),Ft=At.reject,Be=ce(function(){var qt=O(ct.resolve);F(ht,function(Y){qt.call(ct,Y).then(At.resolve,Ft)})});return Be.error&&Ft(Be.value),At.promise}})},{"../internals/a-function":5,"../internals/an-instance":9,"../internals/check-correctness-of-iteration":27,"../internals/classof-raw":28,"../internals/engine-v8-version":47,"../internals/export":49,"../internals/get-built-in":56,"../internals/global":59,"../internals/host-report-errors":62,"../internals/inspect-source":68,"../internals/internal-state":70,"../internals/is-forced":73,"../internals/is-object":74,"../internals/is-pure":75,"../internals/iterate":77,"../internals/microtask":81,"../internals/native-promise-constructor":82,"../internals/new-promise-capability":86,"../internals/perform":105,"../internals/promise-resolve":106,"../internals/redefine":108,"../internals/redefine-all":107,"../internals/set-species":116,"../internals/set-to-string-tag":117,"../internals/species-constructor":121,"../internals/task":128,"../internals/well-known-symbol":146}],179:[function(n,s,o){var a=n("../internals/export"),i=n("../internals/get-built-in"),l=n("../internals/a-function"),u=n("../internals/an-object"),h=n("../internals/is-object"),d=n("../internals/object-create"),c=n("../internals/function-bind"),f=n("../internals/fails"),p=i("Reflect","construct"),m=f(function(){function v(){}return!(p(function(){},[],v)instanceof v)}),g=!f(function(){p(function(){})}),y=m||g;a({target:"Reflect",stat:!0,forced:y,sham:y},{construct:function(v,b,w){l(v),u(b);var _=arguments.length<3?v:l(w);if(g&&!m)return p(v,b,_);if(v==_){switch(b.length){case 0:return new v;case 1:return new v(b[0]);case 2:return new v(b[0],b[1]);case 3:return new v(b[0],b[1],b[2]);case 4:return new v(b[0],b[1],b[2],b[3])}var I=[null];return I.push.apply(I,b),new(c.apply(v,I))}var C=_.prototype,N=d(h(C)?C:Object.prototype),O=Function.apply.call(v,N,b);return h(O)?O:N}})},{"../internals/a-function":5,"../internals/an-object":10,"../internals/export":49,"../internals/fails":50,"../internals/function-bind":55,"../internals/get-built-in":56,"../internals/is-object":74,"../internals/object-create":90}],180:[function(n,s,o){var a=n("../internals/descriptors"),i=n("../internals/global"),l=n("../internals/is-forced"),u=n("../internals/inherit-if-required"),h=n("../internals/object-define-property").f,d=n("../internals/object-get-own-property-names").f,c=n("../internals/is-regexp"),f=n("../internals/regexp-flags"),p=n("../internals/regexp-sticky-helpers"),m=n("../internals/redefine"),g=n("../internals/fails"),y=n("../internals/internal-state").set,v=n("../internals/set-species"),b=n("../internals/well-known-symbol")("match"),w=i.RegExp,_=w.prototype,I=/a/g,C=/a/g,N=new w(I)!==I,O=p.UNSUPPORTED_Y;if(a&&l("RegExp",!N||O||g(function(){return C[b]=!1,w(I)!=I||w(C)==C||w(I,"i")!="/a/i"}))){let B=function(z){z in D||h(D,z,{configurable:!0,get:function(){return w[z]},set:function(Z){w[z]=Z}})};for(var F=B,D=function(z,Z){var Q,K=this instanceof D,ne=c(z),re=Z===void 0;if(!K&&ne&&z.constructor===D&&re)return z;N?ne&&!re&&(z=z.source):z instanceof D&&(re&&(Z=f.call(z)),z=z.source),O&&(Q=!!Z&&-1<Z.indexOf("y"))&&(Z=Z.replace(/y/g,""));var ce=u(N?new w(z,Z):w(z,Z),K?this:_,D);return O&&Q&&y(ce,{sticky:Q}),ce},M=d(w),P=0;M.length>P;)B(M[P++]);(_.constructor=D).prototype=_,m(i,"RegExp",D)}v("RegExp")},{"../internals/descriptors":42,"../internals/fails":50,"../internals/global":59,"../internals/inherit-if-required":67,"../internals/internal-state":70,"../internals/is-forced":73,"../internals/is-regexp":76,"../internals/object-define-property":92,"../internals/object-get-own-property-names":95,"../internals/redefine":108,"../internals/regexp-flags":111,"../internals/regexp-sticky-helpers":112,"../internals/set-species":116,"../internals/well-known-symbol":146}],181:[function(n,s,o){var a=n("../internals/export"),i=n("../internals/regexp-exec");a({target:"RegExp",proto:!0,forced:/./.exec!==i},{exec:i})},{"../internals/export":49,"../internals/regexp-exec":110}],182:[function(n,s,o){var a=n("../internals/redefine"),i=n("../internals/an-object"),l=n("../internals/fails"),u=n("../internals/regexp-flags"),h="toString",d=RegExp.prototype,c=d[h],f=l(function(){return c.call({source:"a",flags:"b"})!="/a/b"}),p=c.name!=h;(f||p)&&a(RegExp.prototype,h,function(){var m=i(this),g=String(m.source),y=m.flags;return"/"+g+"/"+String(y===void 0&&m instanceof RegExp&&!("flags"in d)?u.call(m):y)},{unsafe:!0})},{"../internals/an-object":10,"../internals/fails":50,"../internals/redefine":108,"../internals/regexp-flags":111}],183:[function(n,s,o){var a=n("../internals/collection"),i=n("../internals/collection-strong");s.exports=a("Set",function(l){return function(u){return l(this,arguments.length?u:void 0)}},i)},{"../internals/collection":31,"../internals/collection-strong":30}],184:[function(n,s,o){var a,i=n("../internals/export"),l=n("../internals/object-get-own-property-descriptor").f,u=n("../internals/to-length"),h=n("../internals/not-a-regexp"),d=n("../internals/require-object-coercible"),c=n("../internals/correct-is-regexp-logic"),f=n("../internals/is-pure"),p="".endsWith,m=Math.min,g=c("endsWith");i({target:"String",proto:!0,forced:!!(f||g||!(a=l(String.prototype,"endsWith"))||a.writable)&&!g},{endsWith:function(y,v){var b=String(d(this));h(y);var w=1<arguments.length?v:void 0,_=u(b.length),I=w===void 0?_:m(u(w),_),C=String(y);return p?p.call(b,C,I):b.slice(I-C.length,I)===C}})},{"../internals/correct-is-regexp-logic":33,"../internals/export":49,"../internals/is-pure":75,"../internals/not-a-regexp":87,"../internals/object-get-own-property-descriptor":93,"../internals/require-object-coercible":113,"../internals/to-length":134}],185:[function(n,s,o){var a=n("../internals/export"),i=n("../internals/not-a-regexp"),l=n("../internals/require-object-coercible");a({target:"String",proto:!0,forced:!n("../internals/correct-is-regexp-logic")("includes")},{includes:function(u,h){return!!~String(l(this)).indexOf(i(u),1<arguments.length?h:void 0)}})},{"../internals/correct-is-regexp-logic":33,"../internals/export":49,"../internals/not-a-regexp":87,"../internals/require-object-coercible":113}],186:[function(n,s,o){var a=n("../internals/string-multibyte").charAt,i=n("../internals/internal-state"),l=n("../internals/define-iterator"),u="String Iterator",h=i.set,d=i.getterFor(u);l(String,"String",function(c){h(this,{type:u,string:String(c),index:0})},function(){var c,f=d(this),p=f.string,m=f.index;return m>=p.length?{value:void 0,done:!0}:(c=a(p,m),f.index+=c.length,{value:c,done:!1})})},{"../internals/define-iterator":40,"../internals/internal-state":70,"../internals/string-multibyte":123}],187:[function(n,s,o){var a=n("../internals/fix-regexp-well-known-symbol-logic"),i=n("../internals/an-object"),l=n("../internals/to-length"),u=n("../internals/require-object-coercible"),h=n("../internals/advance-string-index"),d=n("../internals/regexp-exec-abstract");a("match",1,function(c,f,p){return[function(m){var g=u(this),y=m==null?void 0:m[c];return y!==void 0?y.call(m,g):new RegExp(m)[c](String(g))},function(m){var g=p(f,m,this);if(g.done)return g.value;var y=i(m),v=String(this);if(!y.global)return d(y,v);for(var b,w=y.unicode,_=[],I=y.lastIndex=0;(b=d(y,v))!==null;){var C=String(b[0]);(_[I]=C)===""&&(y.lastIndex=h(v,l(y.lastIndex),w)),I++}return I===0?null:_}]})},{"../internals/advance-string-index":8,"../internals/an-object":10,"../internals/fix-regexp-well-known-symbol-logic":51,"../internals/regexp-exec-abstract":109,"../internals/require-object-coercible":113,"../internals/to-length":134}],188:[function(n,s,o){n("../internals/export")({target:"String",proto:!0},{repeat:n("../internals/string-repeat")})},{"../internals/export":49,"../internals/string-repeat":125}],189:[function(n,s,o){var a=n("../internals/fix-regexp-well-known-symbol-logic"),i=n("../internals/an-object"),l=n("../internals/to-object"),u=n("../internals/to-length"),h=n("../internals/to-integer"),d=n("../internals/require-object-coercible"),c=n("../internals/advance-string-index"),f=n("../internals/regexp-exec-abstract"),p=Math.max,m=Math.min,g=Math.floor,y=/\$([$&'`]|\d\d?|<[^>]*>)/g,v=/\$([$&'`]|\d\d?)/g;a("replace",2,function(b,w,_,I){var C=I.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,N=I.REPLACE_KEEPS_$0,O=C?"$":"$0";return[function(M,P){var F=d(this),B=M==null?void 0:M[b];return B!==void 0?B.call(M,F,P):w.call(String(F),M,P)},function(M,P){if(!C&&N||typeof P=="string"&&P.indexOf(O)===-1){var F=_(w,M,this,P);if(F.done)return F.value}var B=i(M),z=String(this),Z=typeof P=="function";Z||(P=String(P));var Q=B.global;if(Q){var K=B.unicode;B.lastIndex=0}for(var ne=[];;){var re=f(B,z);if(re===null||(ne.push(re),!Q))break;String(re[0])===""&&(B.lastIndex=c(z,u(B.lastIndex),K))}for(var ce,be="",we=0,ye=0;ye<ne.length;ye++){re=ne[ye];for(var Oe=String(re[0]),Se=p(m(h(re.index),z.length),0),Ee=[],j=1;j<re.length;j++)Ee.push((ce=re[j])===void 0?ce:String(ce));var W=re.groups;if(Z){var J=[Oe].concat(Ee,Se,z);W!==void 0&&J.push(W);var ie=String(P.apply(void 0,J))}else ie=D(Oe,z,Se,Ee,W,P);we<=Se&&(be+=z.slice(we,Se)+ie,we=Se+Oe.length)}return be+z.slice(we)}];function D(M,P,F,B,z,Z){var Q=F+M.length,K=B.length,ne=v;return z!==void 0&&(z=l(z),ne=y),w.call(Z,ne,function(re,ce){var be;switch(ce.charAt(0)){case"$":return"$";case"&":return M;case"`":return P.slice(0,F);case"'":return P.slice(Q);case"<":be=z[ce.slice(1,-1)];break;default:var we=+ce;if(we==0)return re;if(K<we){var ye=g(we/10);return ye===0?re:ye<=K?B[ye-1]===void 0?ce.charAt(1):B[ye-1]+ce.charAt(1):re}be=B[we-1]}return be===void 0?"":be})}})},{"../internals/advance-string-index":8,"../internals/an-object":10,"../internals/fix-regexp-well-known-symbol-logic":51,"../internals/regexp-exec-abstract":109,"../internals/require-object-coercible":113,"../internals/to-integer":133,"../internals/to-length":134,"../internals/to-object":135}],190:[function(n,s,o){var a=n("../internals/fix-regexp-well-known-symbol-logic"),i=n("../internals/an-object"),l=n("../internals/require-object-coercible"),u=n("../internals/same-value"),h=n("../internals/regexp-exec-abstract");a("search",1,function(d,c,f){return[function(p){var m=l(this),g=p==null?void 0:p[d];return g!==void 0?g.call(p,m):new RegExp(p)[d](String(m))},function(p){var m=f(c,p,this);if(m.done)return m.value;var g=i(p),y=String(this),v=g.lastIndex;u(v,0)||(g.lastIndex=0);var b=h(g,y);return u(g.lastIndex,v)||(g.lastIndex=v),b===null?-1:b.index}]})},{"../internals/an-object":10,"../internals/fix-regexp-well-known-symbol-logic":51,"../internals/regexp-exec-abstract":109,"../internals/require-object-coercible":113,"../internals/same-value":114}],191:[function(n,s,o){var a=n("../internals/fix-regexp-well-known-symbol-logic"),i=n("../internals/is-regexp"),l=n("../internals/an-object"),u=n("../internals/require-object-coercible"),h=n("../internals/species-constructor"),d=n("../internals/advance-string-index"),c=n("../internals/to-length"),f=n("../internals/regexp-exec-abstract"),p=n("../internals/regexp-exec"),m=n("../internals/fails"),g=[].push,y=Math.min,v=4294967295,b=!m(function(){return!RegExp(v,"y")});a("split",2,function(w,_,I){var C;return C="abbc".split(/(b)*/)[1]=="c"||"test".split(/(?:)/,-1).length!=4||"ab".split(/(?:ab)*/).length!=2||".".split(/(.?)(.?)/).length!=4||1<".".split(/()()/).length||"".split(/.?/).length?function(N,O){var D=String(u(this)),M=O===void 0?v:O>>>0;if(M==0)return[];if(N===void 0)return[D];if(!i(N))return _.call(D,N,M);for(var P,F,B,z=[],Z=(N.ignoreCase?"i":"")+(N.multiline?"m":"")+(N.unicode?"u":"")+(N.sticky?"y":""),Q=0,K=new RegExp(N.source,Z+"g");(P=p.call(K,D))&&!(Q<(F=K.lastIndex)&&(z.push(D.slice(Q,P.index)),1<P.length&&P.index<D.length&&g.apply(z,P.slice(1)),B=P[0].length,Q=F,z.length>=M));)K.lastIndex===P.index&&K.lastIndex++;return Q===D.length?!B&&K.test("")||z.push(""):z.push(D.slice(Q)),z.length>M?z.slice(0,M):z}:"0".split(void 0,0).length?function(N,O){return N===void 0&&O===0?[]:_.call(this,N,O)}:_,[function(N,O){var D=u(this),M=N==null?void 0:N[w];return M!==void 0?M.call(N,D,O):C.call(String(D),N,O)},function(N,O){var D=I(C,N,this,O,C!==_);if(D.done)return D.value;var M=l(N),P=String(this),F=h(M,RegExp),B=M.unicode,z=(M.ignoreCase?"i":"")+(M.multiline?"m":"")+(M.unicode?"u":"")+(b?"y":"g"),Z=new F(b?M:"^(?:"+M.source+")",z),Q=O===void 0?v:O>>>0;if(Q==0)return[];if(P.length===0)return f(Z,P)===null?[P]:[];for(var K=0,ne=0,re=[];ne<P.length;){Z.lastIndex=b?ne:0;var ce,be=f(Z,b?P:P.slice(ne));if(be===null||(ce=y(c(Z.lastIndex+(b?0:ne)),P.length))===K)ne=d(P,ne,B);else{if(re.push(P.slice(K,ne)),re.length===Q)return re;for(var we=1;we<=be.length-1;we++)if(re.push(be[we]),re.length===Q)return re;ne=K=ce}}return re.push(P.slice(K)),re}]},!b)},{"../internals/advance-string-index":8,"../internals/an-object":10,"../internals/fails":50,"../internals/fix-regexp-well-known-symbol-logic":51,"../internals/is-regexp":76,"../internals/regexp-exec":110,"../internals/regexp-exec-abstract":109,"../internals/require-object-coercible":113,"../internals/species-constructor":121,"../internals/to-length":134}],192:[function(n,s,o){var a=n("../internals/export"),i=n("../internals/create-html");a({target:"String",proto:!0,forced:n("../internals/string-html-forced")("sub")},{sub:function(){return i(this,"sub","","")}})},{"../internals/create-html":35,"../internals/export":49,"../internals/string-html-forced":122}],193:[function(n,s,o){var a=n("../internals/export"),i=n("../internals/string-trim").trim;a({target:"String",proto:!0,forced:n("../internals/string-trim-forced")("trim")},{trim:function(){return i(this)}})},{"../internals/export":49,"../internals/string-trim":127,"../internals/string-trim-forced":126}],194:[function(n,s,o){var a=n("../internals/export"),i=n("../internals/descriptors"),l=n("../internals/global"),u=n("../internals/has"),h=n("../internals/is-object"),d=n("../internals/object-define-property").f,c=n("../internals/copy-constructor-properties"),f=l.Symbol;if(i&&typeof f=="function"&&(!("description"in f.prototype)||f().description!==void 0)){var p={},m=function(w){var _=arguments.length<1||w===void 0?void 0:String(w),I=this instanceof m?new f(_):_===void 0?f():f(_);return _===""&&(p[I]=!0),I};c(m,f);var g=m.prototype=f.prototype;g.constructor=m;var y=g.toString,v=String(f("test"))=="Symbol(test)",b=/^Symbol\((.*)\)[^)]+$/;d(g,"description",{configurable:!0,get:function(){var w=h(this)?this.valueOf():this,_=y.call(w);if(u(p,w))return"";var I=v?_.slice(7,-1):_.replace(b,"$1");return I===""?void 0:I}}),a({global:!0,forced:!0},{Symbol:m})}},{"../internals/copy-constructor-properties":32,"../internals/descriptors":42,"../internals/export":49,"../internals/global":59,"../internals/has":60,"../internals/is-object":74,"../internals/object-define-property":92}],195:[function(n,s,o){n("../internals/define-well-known-symbol")("iterator")},{"../internals/define-well-known-symbol":41}],196:[function(n,s,o){function a(ee,ue){var Ae=Pt[ee]=D(De[ve]);return Fe(Ae,{type:ie,tag:ee,description:ue}),p||(Ae.description=ue),Ae}function i(ee,ue){_(ee);var Ae=C(ue),Ke=M(Ae).concat(le(Ae));return W(Ke,function(ot){p&&!Y.call(Ae,ot)||qt(ee,ot,Ae[ot])}),ee}function l(ee,ue){var Ae=C(ee),Ke=N(ue,!0);if(Ae!==Le||!v(Pt,Ke)||v(Dt,Ke)){var ot=rt(Ae,Ke);return!ot||!v(Pt,Ke)||v(Ae,J)&&Ae[J][Ke]||(ot.enumerable=!0),ot}}function u(ee){var ue=Je(C(ee)),Ae=[];return W(ue,function(Ke){v(Pt,Ke)||v(be,Ke)||Ae.push(Ke)}),Ae}var h=n("../internals/export"),d=n("../internals/global"),c=n("../internals/get-built-in"),f=n("../internals/is-pure"),p=n("../internals/descriptors"),m=n("../internals/native-symbol"),g=n("../internals/use-symbol-as-uid"),y=n("../internals/fails"),v=n("../internals/has"),b=n("../internals/is-array"),w=n("../internals/is-object"),_=n("../internals/an-object"),I=n("../internals/to-object"),C=n("../internals/to-indexed-object"),N=n("../internals/to-primitive"),O=n("../internals/create-property-descriptor"),D=n("../internals/object-create"),M=n("../internals/object-keys"),P=n("../internals/object-get-own-property-names"),F=n("../internals/object-get-own-property-names-external"),B=n("../internals/object-get-own-property-symbols"),z=n("../internals/object-get-own-property-descriptor"),Z=n("../internals/object-define-property"),Q=n("../internals/object-property-is-enumerable"),K=n("../internals/create-non-enumerable-property"),ne=n("../internals/redefine"),re=n("../internals/shared"),ce=n("../internals/shared-key"),be=n("../internals/hidden-keys"),we=n("../internals/uid"),ye=n("../internals/well-known-symbol"),Oe=n("../internals/well-known-symbol-wrapped"),Se=n("../internals/define-well-known-symbol"),Ee=n("../internals/set-to-string-tag"),j=n("../internals/internal-state"),W=n("../internals/array-iteration").forEach,J=ce("hidden"),ie="Symbol",ve="prototype",he=ye("toPrimitive"),Fe=j.set,me=j.getterFor(ie),Le=Object[ve],De=d.Symbol,Ne=c("JSON","stringify"),rt=z.f,tt=Z.f,Je=F.f,xt=Q.f,Pt=re("symbols"),Dt=re("op-symbols"),St=re("string-to-symbol-registry"),Jt=re("symbol-to-string-registry"),ht=re("wks"),ct=d.QObject,At=!ct||!ct[ve]||!ct[ve].findChild,Ft=p&&y(function(){return D(tt({},"a",{get:function(){return tt(this,"a",{value:7}).a}})).a!=7})?function(ee,ue,Ae){var Ke=rt(Le,ue);Ke&&delete Le[ue],tt(ee,ue,Ae),Ke&&ee!==Le&&tt(Le,ue,Ke)}:tt,Be=g?function(ee){return typeof ee=="symbol"}:function(ee){return Object(ee)instanceof De},qt=function(ee,ue,Ae){ee===Le&&qt(Dt,ue,Ae),_(ee);var Ke=N(ue,!0);return _(Ae),v(Pt,Ke)?(Ae.enumerable?(v(ee,J)&&ee[J][Ke]&&(ee[J][Ke]=!1),Ae=D(Ae,{enumerable:O(0,!1)})):(v(ee,J)||tt(ee,J,O(1,{})),ee[J][Ke]=!0),Ft(ee,Ke,Ae)):tt(ee,Ke,Ae)},Y=function(ee){var ue=N(ee,!0),Ae=xt.call(this,ue);return!(this===Le&&v(Pt,ue)&&!v(Dt,ue))&&(!(Ae||!v(this,ue)||!v(Pt,ue)||v(this,J)&&this[J][ue])||Ae)},le=function(ee){var ue=ee===Le,Ae=Je(ue?Dt:C(ee)),Ke=[];return W(Ae,function(ot){!v(Pt,ot)||ue&&!v(Le,ot)||Ke.push(Pt[ot])}),Ke};m||(ne((De=function(ee){if(this instanceof De)throw TypeError("Symbol is not a constructor");var ue=arguments.length&&ee!==void 0?String(ee):void 0,Ae=we(ue),Ke=function(ot){this===Le&&Ke.call(Dt,ot),v(this,J)&&v(this[J],Ae)&&(this[J][Ae]=!1),Ft(this,Ae,O(1,ot))};return p&&At&&Ft(Le,Ae,{configurable:!0,set:Ke}),a(Ae,ue)})[ve],"toString",function(){return me(this).tag}),ne(De,"withoutSetter",function(ee){return a(we(ee),ee)}),Q.f=Y,Z.f=qt,z.f=l,P.f=F.f=u,B.f=le,Oe.f=function(ee){return a(ye(ee),ee)},p&&(tt(De[ve],"description",{configurable:!0,get:function(){return me(this).description}}),f||ne(Le,"propertyIsEnumerable",Y,{unsafe:!0}))),h({global:!0,wrap:!0,forced:!m,sham:!m},{Symbol:De}),W(M(ht),function(ee){Se(ee)}),h({target:ie,stat:!0,forced:!m},{for:function(ee){var ue=String(ee);if(v(St,ue))return St[ue];var Ae=De(ue);return St[ue]=Ae,Jt[Ae]=ue,Ae},keyFor:function(ee){if(!Be(ee))throw TypeError(ee+" is not a symbol");if(v(Jt,ee))return Jt[ee]},useSetter:function(){At=!0},useSimple:function(){At=!1}}),h({target:"Object",stat:!0,forced:!m,sham:!p},{create:function(ee,ue){return ue===void 0?D(ee):i(D(ee),ue)},defineProperty:qt,defineProperties:i,getOwnPropertyDescriptor:l}),h({target:"Object",stat:!0,forced:!m},{getOwnPropertyNames:u,getOwnPropertySymbols:le}),h({target:"Object",stat:!0,forced:y(function(){B.f(1)})},{getOwnPropertySymbols:function(ee){return B.f(I(ee))}}),Ne&&h({target:"JSON",stat:!0,forced:!m||y(function(){var ee=De();return Ne([ee])!="[null]"||Ne({a:ee})!="{}"||Ne(Object(ee))!="{}"})},{stringify:function(ee,ue,Ae){for(var Ke,ot=[ee],vt=1;vt<arguments.length;)ot.push(arguments[vt++]);if((w(Ke=ue)||ee!==void 0)&&!Be(ee))return b(ue)||(ue=function(Pe,Mt){if(typeof Ke=="function"&&(Mt=Ke.call(this,Pe,Mt)),!Be(Mt))return Mt}),ot[1]=ue,Ne.apply(null,ot)}}),De[ve][he]||K(De[ve],he,De[ve].valueOf),Ee(De,ie),be[J]=!0},{"../internals/an-object":10,"../internals/array-iteration":19,"../internals/create-non-enumerable-property":37,"../internals/create-property-descriptor":38,"../internals/define-well-known-symbol":41,"../internals/descriptors":42,"../internals/export":49,"../internals/fails":50,"../internals/get-built-in":56,"../internals/global":59,"../internals/has":60,"../internals/hidden-keys":61,"../internals/internal-state":70,"../internals/is-array":72,"../internals/is-object":74,"../internals/is-pure":75,"../internals/native-symbol":83,"../internals/object-create":90,"../internals/object-define-property":92,"../internals/object-get-own-property-descriptor":93,"../internals/object-get-own-property-names":95,"../internals/object-get-own-property-names-external":94,"../internals/object-get-own-property-symbols":96,"../internals/object-keys":99,"../internals/object-property-is-enumerable":100,"../internals/redefine":108,"../internals/set-to-string-tag":117,"../internals/shared":120,"../internals/shared-key":118,"../internals/to-indexed-object":132,"../internals/to-object":135,"../internals/to-primitive":138,"../internals/uid":143,"../internals/use-symbol-as-uid":144,"../internals/well-known-symbol":146,"../internals/well-known-symbol-wrapped":145}],197:[function(n,s,o){var a=n("../internals/array-buffer-view-core"),i=n("../internals/array-copy-within"),l=a.aTypedArray;(0,a.exportTypedArrayMethod)("copyWithin",function(u,h,d){return i.call(l(this),u,h,2<arguments.length?d:void 0)})},{"../internals/array-buffer-view-core":12,"../internals/array-copy-within":14}],198:[function(n,s,o){var a=n("../internals/array-buffer-view-core"),i=n("../internals/array-iteration").every,l=a.aTypedArray;(0,a.exportTypedArrayMethod)("every",function(u,h){return i(l(this),u,1<arguments.length?h:void 0)})},{"../internals/array-buffer-view-core":12,"../internals/array-iteration":19}],199:[function(n,s,o){var a=n("../internals/array-buffer-view-core"),i=n("../internals/array-fill"),l=a.aTypedArray;(0,a.exportTypedArrayMethod)("fill",function(u){return i.apply(l(this),arguments)})},{"../internals/array-buffer-view-core":12,"../internals/array-fill":15}],200:[function(n,s,o){var a=n("../internals/array-buffer-view-core"),i=n("../internals/array-iteration").filter,l=n("../internals/species-constructor"),u=a.aTypedArray,h=a.aTypedArrayConstructor;(0,a.exportTypedArrayMethod)("filter",function(d,c){for(var f=i(u(this),d,1<arguments.length?c:void 0),p=l(this,this.constructor),m=0,g=f.length,y=new(h(p))(g);m<g;)y[m]=f[m++];return y})},{"../internals/array-buffer-view-core":12,"../internals/array-iteration":19,"../internals/species-constructor":121}],201:[function(n,s,o){var a=n("../internals/array-buffer-view-core"),i=n("../internals/array-iteration").findIndex,l=a.aTypedArray;(0,a.exportTypedArrayMethod)("findIndex",function(u,h){return i(l(this),u,1<arguments.length?h:void 0)})},{"../internals/array-buffer-view-core":12,"../internals/array-iteration":19}],202:[function(n,s,o){var a=n("../internals/array-buffer-view-core"),i=n("../internals/array-iteration").find,l=a.aTypedArray;(0,a.exportTypedArrayMethod)("find",function(u,h){return i(l(this),u,1<arguments.length?h:void 0)})},{"../internals/array-buffer-view-core":12,"../internals/array-iteration":19}],203:[function(n,s,o){n("../internals/typed-array-constructor")("Float32",function(a){return function(i,l,u){return a(this,i,l,u)}})},{"../internals/typed-array-constructor":140}],204:[function(n,s,o){n("../internals/typed-array-constructor")("Float64",function(a){return function(i,l,u){return a(this,i,l,u)}})},{"../internals/typed-array-constructor":140}],205:[function(n,s,o){var a=n("../internals/array-buffer-view-core"),i=n("../internals/array-iteration").forEach,l=a.aTypedArray;(0,a.exportTypedArrayMethod)("forEach",function(u,h){i(l(this),u,1<arguments.length?h:void 0)})},{"../internals/array-buffer-view-core":12,"../internals/array-iteration":19}],206:[function(n,s,o){var a=n("../internals/array-buffer-view-core"),i=n("../internals/array-includes").includes,l=a.aTypedArray;(0,a.exportTypedArrayMethod)("includes",function(u,h){return i(l(this),u,1<arguments.length?h:void 0)})},{"../internals/array-buffer-view-core":12,"../internals/array-includes":18}],207:[function(n,s,o){var a=n("../internals/array-buffer-view-core"),i=n("../internals/array-includes").indexOf,l=a.aTypedArray;(0,a.exportTypedArrayMethod)("indexOf",function(u,h){return i(l(this),u,1<arguments.length?h:void 0)})},{"../internals/array-buffer-view-core":12,"../internals/array-includes":18}],208:[function(n,s,o){n("../internals/typed-array-constructor")("Int16",function(a){return function(i,l,u){return a(this,i,l,u)}})},{"../internals/typed-array-constructor":140}],209:[function(n,s,o){n("../internals/typed-array-constructor")("Int32",function(a){return function(i,l,u){return a(this,i,l,u)}})},{"../internals/typed-array-constructor":140}],210:[function(n,s,o){function a(){return c.call(m(this))}var i=n("../internals/global"),l=n("../internals/array-buffer-view-core"),u=n("../modules/es.array.iterator"),h=n("../internals/well-known-symbol")("iterator"),d=i.Uint8Array,c=u.values,f=u.keys,p=u.entries,m=l.aTypedArray,g=l.exportTypedArrayMethod,y=d&&d.prototype[h],v=!!y&&(y.name=="values"||y.name==null);g("entries",function(){return p.call(m(this))}),g("keys",function(){return f.call(m(this))}),g("values",a,!v),g(h,a,!v)},{"../internals/array-buffer-view-core":12,"../internals/global":59,"../internals/well-known-symbol":146,"../modules/es.array.iterator":158}],211:[function(n,s,o){var a=n("../internals/array-buffer-view-core"),i=a.aTypedArray,l=a.exportTypedArrayMethod,u=[].join;l("join",function(h){return u.apply(i(this),arguments)})},{"../internals/array-buffer-view-core":12}],212:[function(n,s,o){var a=n("../internals/array-buffer-view-core"),i=n("../internals/array-last-index-of"),l=a.aTypedArray;(0,a.exportTypedArrayMethod)("lastIndexOf",function(u){return i.apply(l(this),arguments)})},{"../internals/array-buffer-view-core":12,"../internals/array-last-index-of":20}],213:[function(n,s,o){var a=n("../internals/array-buffer-view-core"),i=n("../internals/array-iteration").map,l=n("../internals/species-constructor"),u=a.aTypedArray,h=a.aTypedArrayConstructor;(0,a.exportTypedArrayMethod)("map",function(d,c){return i(u(this),d,1<arguments.length?c:void 0,function(f,p){return new(h(l(f,f.constructor)))(p)})})},{"../internals/array-buffer-view-core":12,"../internals/array-iteration":19,"../internals/species-constructor":121}],214:[function(n,s,o){var a=n("../internals/array-buffer-view-core"),i=n("../internals/array-reduce").right,l=a.aTypedArray;(0,a.exportTypedArrayMethod)("reduceRight",function(u,h){return i(l(this),u,arguments.length,1<arguments.length?h:void 0)})},{"../internals/array-buffer-view-core":12,"../internals/array-reduce":24}],215:[function(n,s,o){var a=n("../internals/array-buffer-view-core"),i=n("../internals/array-reduce").left,l=a.aTypedArray;(0,a.exportTypedArrayMethod)("reduce",function(u,h){return i(l(this),u,arguments.length,1<arguments.length?h:void 0)})},{"../internals/array-buffer-view-core":12,"../internals/array-reduce":24}],216:[function(n,s,o){var a=n("../internals/array-buffer-view-core"),i=a.aTypedArray,l=a.exportTypedArrayMethod,u=Math.floor;l("reverse",function(){for(var h,d=i(this).length,c=u(d/2),f=0;f<c;)h=this[f],this[f++]=this[--d],this[d]=h;return this})},{"../internals/array-buffer-view-core":12}],217:[function(n,s,o){var a=n("../internals/array-buffer-view-core"),i=n("../internals/to-length"),l=n("../internals/to-offset"),u=n("../internals/to-object"),h=n("../internals/fails"),d=a.aTypedArray;(0,a.exportTypedArrayMethod)("set",function(c,f){d(this);var p=l(1<arguments.length?f:void 0,1),m=this.length,g=u(c),y=i(g.length),v=0;if(m<y+p)throw RangeError("Wrong length");for(;v<y;)this[p+v]=g[v++]},h(function(){new Int8Array(1).set({})}))},{"../internals/array-buffer-view-core":12,"../internals/fails":50,"../internals/to-length":134,"../internals/to-object":135,"../internals/to-offset":136}],218:[function(n,s,o){var a=n("../internals/array-buffer-view-core"),i=n("../internals/species-constructor"),l=n("../internals/fails"),u=a.aTypedArray,h=a.aTypedArrayConstructor,d=a.exportTypedArrayMethod,c=[].slice;d("slice",function(f,p){for(var m=c.call(u(this),f,p),g=i(this,this.constructor),y=0,v=m.length,b=new(h(g))(v);y<v;)b[y]=m[y++];return b},l(function(){new Int8Array(1).slice()}))},{"../internals/array-buffer-view-core":12,"../internals/fails":50,"../internals/species-constructor":121}],219:[function(n,s,o){var a=n("../internals/array-buffer-view-core"),i=n("../internals/array-iteration").some,l=a.aTypedArray;(0,a.exportTypedArrayMethod)("some",function(u,h){return i(l(this),u,1<arguments.length?h:void 0)})},{"../internals/array-buffer-view-core":12,"../internals/array-iteration":19}],220:[function(n,s,o){var a=n("../internals/array-buffer-view-core"),i=a.aTypedArray,l=a.exportTypedArrayMethod,u=[].sort;l("sort",function(h){return u.call(i(this),h)})},{"../internals/array-buffer-view-core":12}],221:[function(n,s,o){var a=n("../internals/array-buffer-view-core"),i=n("../internals/to-length"),l=n("../internals/to-absolute-index"),u=n("../internals/species-constructor"),h=a.aTypedArray;(0,a.exportTypedArrayMethod)("subarray",function(d,c){var f=h(this),p=f.length,m=l(d,p);return new(u(f,f.constructor))(f.buffer,f.byteOffset+m*f.BYTES_PER_ELEMENT,i((c===void 0?p:l(c,p))-m))})},{"../internals/array-buffer-view-core":12,"../internals/species-constructor":121,"../internals/to-absolute-index":130,"../internals/to-length":134}],222:[function(n,s,o){var a=n("../internals/global"),i=n("../internals/array-buffer-view-core"),l=n("../internals/fails"),u=a.Int8Array,h=i.aTypedArray,d=i.exportTypedArrayMethod,c=[].toLocaleString,f=[].slice,p=!!u&&l(function(){c.call(new u(1))});d("toLocaleString",function(){return c.apply(p?f.call(h(this)):h(this),arguments)},l(function(){return[1,2].toLocaleString()!=new u([1,2]).toLocaleString()})||!l(function(){u.prototype.toLocaleString.call([1,2])}))},{"../internals/array-buffer-view-core":12,"../internals/fails":50,"../internals/global":59}],223:[function(n,s,o){var a=n("../internals/array-buffer-view-core").exportTypedArrayMethod,i=n("../internals/fails"),l=n("../internals/global").Uint8Array,u=l&&l.prototype||{},h=[].toString,d=[].join;i(function(){h.call({})})&&(h=function(){return d.call(this)}),a("toString",h,u.toString!=h)},{"../internals/array-buffer-view-core":12,"../internals/fails":50,"../internals/global":59}],224:[function(n,s,o){n("../internals/typed-array-constructor")("Uint16",function(a){return function(i,l,u){return a(this,i,l,u)}})},{"../internals/typed-array-constructor":140}],225:[function(n,s,o){n("../internals/typed-array-constructor")("Uint32",function(a){return function(i,l,u){return a(this,i,l,u)}})},{"../internals/typed-array-constructor":140}],226:[function(n,s,o){n("../internals/typed-array-constructor")("Uint8",function(a){return function(i,l,u){return a(this,i,l,u)}})},{"../internals/typed-array-constructor":140}],227:[function(n,s,o){n("../internals/typed-array-constructor")("Uint8",function(a){return function(i,l,u){return a(this,i,l,u)}},!0)},{"../internals/typed-array-constructor":140}],228:[function(n,s,o){var a=n("../internals/global"),i=n("../internals/dom-iterables"),l=n("../internals/array-for-each"),u=n("../internals/create-non-enumerable-property");for(var h in i){var d=a[h],c=d&&d.prototype;if(c&&c.forEach!==l)try{u(c,"forEach",l)}catch{c.forEach=l}}},{"../internals/array-for-each":16,"../internals/create-non-enumerable-property":37,"../internals/dom-iterables":44,"../internals/global":59}],229:[function(n,s,o){var a=n("../internals/global"),i=n("../internals/dom-iterables"),l=n("../modules/es.array.iterator"),u=n("../internals/create-non-enumerable-property"),h=n("../internals/well-known-symbol"),d=h("iterator"),c=h("toStringTag"),f=l.values;for(var p in i){var m=a[p],g=m&&m.prototype;if(g){if(g[d]!==f)try{u(g,d,f)}catch{g[d]=f}if(g[c]||u(g,c,p),i[p]){for(var y in l)if(g[y]!==l[y])try{u(g,y,l[y])}catch{g[y]=l[y]}}}}},{"../internals/create-non-enumerable-property":37,"../internals/dom-iterables":44,"../internals/global":59,"../internals/well-known-symbol":146,"../modules/es.array.iterator":158}],230:[function(n,s,o){n("../modules/es.array.iterator");function a(ie){try{return decodeURIComponent(ie)}catch{return ie}}function i(ie){var ve,he=ie.replace(ye," "),Fe=4;try{return decodeURIComponent(he)}catch{for(;Fe;)he=he.replace((ve=Fe--,Oe[ve-1]||(Oe[ve-1]=RegExp("((?:%[\\da-f]{2}){"+ve+"})","gi"))),a);return he}}function l(ie){return Ee[ie]}function u(ie){return encodeURIComponent(ie).replace(Se,l)}function h(ie,ve){if(ve)for(var he,Fe,me=ve.split("&"),Le=0;Le<me.length;)(he=me[Le++]).length&&(Fe=he.split("="),ie.push({key:i(Fe.shift()),value:i(Fe.join("="))}))}function d(ie){this.entries.length=0,h(this.entries,ie)}function c(ie,ve){if(ie<ve)throw TypeError("Not enough arguments")}var f=n("../internals/export"),p=n("../internals/get-built-in"),m=n("../internals/native-url"),g=n("../internals/redefine"),y=n("../internals/redefine-all"),v=n("../internals/set-to-string-tag"),b=n("../internals/create-iterator-constructor"),w=n("../internals/internal-state"),_=n("../internals/an-instance"),I=n("../internals/has"),C=n("../internals/function-bind-context"),N=n("../internals/classof"),O=n("../internals/an-object"),D=n("../internals/is-object"),M=n("../internals/object-create"),P=n("../internals/create-property-descriptor"),F=n("../internals/get-iterator"),B=n("../internals/get-iterator-method"),z=n("../internals/well-known-symbol"),Z=p("fetch"),Q=p("Headers"),K=z("iterator"),ne="URLSearchParams",re=ne+"Iterator",ce=w.set,be=w.getterFor(ne),we=w.getterFor(re),ye=/\+/g,Oe=Array(4),Se=/[!'()~]|%20/g,Ee={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},j=b(function(ie,ve){ce(this,{type:re,iterator:F(be(ie).entries),kind:ve})},"Iterator",function(){var ie=we(this),ve=ie.kind,he=ie.iterator.next(),Fe=he.value;return he.done||(he.value=ve==="keys"?Fe.key:ve==="values"?Fe.value:[Fe.key,Fe.value]),he}),W=function(ie){_(this,W,ne);var ve,he,Fe,me,Le,De,Ne,rt,tt,Je=0<arguments.length?ie:void 0,xt=[];if(ce(this,{type:ne,entries:xt,updateURL:function(){},updateSearchParams:d}),Je!==void 0)if(D(Je))if(typeof(ve=B(Je))=="function")for(Fe=(he=ve.call(Je)).next;!(me=Fe.call(he)).done;){if((Ne=(De=(Le=F(O(me.value))).next).call(Le)).done||(rt=De.call(Le)).done||!De.call(Le).done)throw TypeError("Expected sequence with length 2");xt.push({key:Ne.value+"",value:rt.value+""})}else for(tt in Je)I(Je,tt)&&xt.push({key:tt,value:Je[tt]+""});else h(xt,typeof Je=="string"?Je.charAt(0)==="?"?Je.slice(1):Je:Je+"")},J=W.prototype;y(J,{append:function(ie,ve){c(arguments.length,2);var he=be(this);he.entries.push({key:ie+"",value:ve+""}),he.updateURL()},delete:function(ie){c(arguments.length,1);for(var ve=be(this),he=ve.entries,Fe=ie+"",me=0;me<he.length;)he[me].key===Fe?he.splice(me,1):me++;ve.updateURL()},get:function(ie){c(arguments.length,1);for(var ve=be(this).entries,he=ie+"",Fe=0;Fe<ve.length;Fe++)if(ve[Fe].key===he)return ve[Fe].value;return null},getAll:function(ie){c(arguments.length,1);for(var ve=be(this).entries,he=ie+"",Fe=[],me=0;me<ve.length;me++)ve[me].key===he&&Fe.push(ve[me].value);return Fe},has:function(ie){c(arguments.length,1);for(var ve=be(this).entries,he=ie+"",Fe=0;Fe<ve.length;)if(ve[Fe++].key===he)return!0;return!1},set:function(ie,ve){c(arguments.length,1);for(var he,Fe=be(this),me=Fe.entries,Le=!1,De=ie+"",Ne=ve+"",rt=0;rt<me.length;rt++)(he=me[rt]).key===De&&(Le?me.splice(rt--,1):(Le=!0,he.value=Ne));Le||me.push({key:De,value:Ne}),Fe.updateURL()},sort:function(){var ie,ve,he,Fe=be(this),me=Fe.entries,Le=me.slice();for(he=me.length=0;he<Le.length;he++){for(ie=Le[he],ve=0;ve<he;ve++)if(me[ve].key>ie.key){me.splice(ve,0,ie);break}ve===he&&me.push(ie)}Fe.updateURL()},forEach:function(ie,ve){for(var he,Fe=be(this).entries,me=C(ie,1<arguments.length?ve:void 0,3),Le=0;Le<Fe.length;)me((he=Fe[Le++]).value,he.key,this)},keys:function(){return new j(this,"keys")},values:function(){return new j(this,"values")},entries:function(){return new j(this,"entries")}},{enumerable:!0}),g(J,K,J.entries),g(J,"toString",function(){for(var ie,ve=be(this).entries,he=[],Fe=0;Fe<ve.length;)ie=ve[Fe++],he.push(u(ie.key)+"="+u(ie.value));return he.join("&")},{enumerable:!0}),v(W,ne),f({global:!0,forced:!m},{URLSearchParams:W}),m||typeof Z!="function"||typeof Q!="function"||f({global:!0,enumerable:!0,forced:!0},{fetch:function(ie,ve){var he,Fe,me,Le=[ie];return 1<arguments.length&&(D(he=ve)&&(Fe=he.body,N(Fe)===ne&&((me=he.headers?new Q(he.headers):new Q).has("content-type")||me.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"),he=M(he,{body:P(0,String(Fe)),headers:P(0,me)}))),Le.push(he)),Z.apply(this,Le)}}),s.exports={URLSearchParams:W,getState:be}},{"../internals/an-instance":9,"../internals/an-object":10,"../internals/classof":29,"../internals/create-iterator-constructor":36,"../internals/create-property-descriptor":38,"../internals/export":49,"../internals/function-bind-context":54,"../internals/get-built-in":56,"../internals/get-iterator":58,"../internals/get-iterator-method":57,"../internals/has":60,"../internals/internal-state":70,"../internals/is-object":74,"../internals/native-url":84,"../internals/object-create":90,"../internals/redefine":108,"../internals/redefine-all":107,"../internals/set-to-string-tag":117,"../internals/well-known-symbol":146,"../modules/es.array.iterator":158}],231:[function(n,s,o){n("../modules/es.string.iterator");function a(Re,gt){var Lt,kt,Xt;if(gt.charAt(0)=="["){if(gt.charAt(gt.length-1)!="]"||!(Lt=De(gt.slice(1,-1))))return we;Re.host=Lt}else if(Dt(Re)){if(gt=M(gt),ve.test(gt)||(Lt=Le(gt))===null)return we;Re.host=Lt}else{if(he.test(gt))return we;for(Lt="",kt=O(gt),Xt=0;Xt<kt.length;Xt++)Lt+=xt(kt[Xt],Ne);Re.host=Lt}}function i(Re){var gt,Lt,kt,Xt;if(typeof Re=="number"){for(gt=[],Lt=0;Lt<4;Lt++)gt.unshift(Re%256),Re=re(Re/256);return gt.join(".")}if(typeof Re!="object")return Re;for(gt="",kt=function(yt){for(var _n=null,En=1,Yn=null,Cn=0,Bt=0;Bt<8;Bt++)yt[Bt]!==0?(En<Cn&&(_n=Yn,En=Cn),Yn=null,Cn=0):(Yn===null&&(Yn=Bt),++Cn);return En<Cn&&(_n=Yn,En=Cn),_n}(Re),Lt=0;Lt<8;Lt++)Xt&&Re[Lt]===0||(Xt=Xt&&!1,kt===Lt?(gt+=Lt?":":"::",Xt=!0):(gt+=Re[Lt].toString(16),Lt<7&&(gt+=":")));return"["+gt+"]"}function l(Re){return Re.username!=""||Re.password!=""}function u(Re){return!Re.host||Re.cannotBeABaseURL||Re.scheme=="file"}function h(Re,gt){var Lt;return Re.length==2&&Oe.test(Re.charAt(0))&&((Lt=Re.charAt(1))==":"||!gt&&Lt=="|")}function d(Re){var gt;return 1<Re.length&&h(Re.slice(0,2))&&(Re.length==2||(gt=Re.charAt(2))==="/"||gt==="\\"||gt==="?"||gt==="#")}function c(Re){var gt=Re.path,Lt=gt.length;!Lt||Re.scheme=="file"&&Lt==1&&h(gt[0],!0)||gt.pop()}function f(Re,gt,Lt,kt){var Xt,yt,_n,En,Yn,Cn,Bt=Lt||St,mr=0,an="",gs=!1,Xo=!1,Ko=!1;for(Lt||(Re.scheme="",Re.username="",Re.password="",Re.host=null,Re.port=null,Re.path=[],Re.query=null,Re.fragment=null,Re.cannotBeABaseURL=!1,gt=gt.replace(Fe,"")),gt=gt.replace(me,""),Xt=O(gt);mr<=Xt.length;){switch(yt=Xt[mr],Bt){case St:if(!yt||!Oe.test(yt)){if(Lt)return be;Bt=ht;continue}an+=yt.toLowerCase(),Bt=Jt;break;case Jt:if(yt&&(Se.test(yt)||yt=="+"||yt=="-"||yt=="."))an+=yt.toLowerCase();else{if(yt!=":"){if(Lt)return be;an="",Bt=ht,mr=0;continue}if(Lt&&(Dt(Re)!=C(Pt,an)||an=="file"&&(l(Re)||Re.port!==null)||Re.scheme=="file"&&!Re.host))return;if(Re.scheme=an,Lt)return void(Dt(Re)&&Pt[Re.scheme]==Re.port&&(Re.port=null));an="",Re.scheme=="file"?Bt=Ke:Dt(Re)&&kt&&kt.scheme==Re.scheme?Bt=ct:Dt(Re)?Bt=qt:Xt[mr+1]=="/"?(Bt=At,mr++):(Re.cannotBeABaseURL=!0,Re.path.push(""),Bt=en)}break;case ht:if(!kt||kt.cannotBeABaseURL&&yt!="#")return be;if(kt.cannotBeABaseURL&&yt=="#"){Re.scheme=kt.scheme,Re.path=kt.path.slice(),Re.query=kt.query,Re.fragment="",Re.cannotBeABaseURL=!0,Bt=mn;break}Bt=kt.scheme=="file"?Ke:Ft;continue;case ct:if(yt!="/"||Xt[mr+1]!="/"){Bt=Ft;continue}Bt=Y,mr++;break;case At:if(yt=="/"){Bt=le;break}Bt=Mt;continue;case Ft:if(Re.scheme=kt.scheme,yt==m)Re.username=kt.username,Re.password=kt.password,Re.host=kt.host,Re.port=kt.port,Re.path=kt.path.slice(),Re.query=kt.query;else if(yt=="/"||yt=="\\"&&Dt(Re))Bt=Be;else if(yt=="?")Re.username=kt.username,Re.password=kt.password,Re.host=kt.host,Re.port=kt.port,Re.path=kt.path.slice(),Re.query="",Bt=dn;else{if(yt!="#"){Re.username=kt.username,Re.password=kt.password,Re.host=kt.host,Re.port=kt.port,Re.path=kt.path.slice(),Re.path.pop(),Bt=Mt;continue}Re.username=kt.username,Re.password=kt.password,Re.host=kt.host,Re.port=kt.port,Re.path=kt.path.slice(),Re.query=kt.query,Re.fragment="",Bt=mn}break;case Be:if(!Dt(Re)||yt!="/"&&yt!="\\"){if(yt!="/"){Re.username=kt.username,Re.password=kt.password,Re.host=kt.host,Re.port=kt.port,Bt=Mt;continue}Bt=le}else Bt=Y;break;case qt:if(Bt=Y,yt!="/"||an.charAt(mr+1)!="/")continue;mr++;break;case Y:if(yt=="/"||yt=="\\")break;Bt=le;continue;case le:if(yt=="@"){gs&&(an="%40"+an),gs=!0,_n=O(an);for(var Cs=0;Cs<_n.length;Cs++){var yi=_n[Cs];if(yi!=":"||Ko){var Sa=xt(yi,Je);Ko?Re.password+=Sa:Re.username+=Sa}else Ko=!0}an=""}else if(yt==m||yt=="/"||yt=="?"||yt=="#"||yt=="\\"&&Dt(Re)){if(gs&&an=="")return"Invalid authority";mr-=O(an).length+1,an="",Bt=ee}else an+=yt;break;case ee:case ue:if(Lt&&Re.scheme=="file"){Bt=vt;continue}if(yt!=":"||Xo){if(yt==m||yt=="/"||yt=="?"||yt=="#"||yt=="\\"&&Dt(Re)){if(Dt(Re)&&an=="")return we;if(Lt&&an==""&&(l(Re)||Re.port!==null))return;if(En=a(Re,an))return En;if(an="",Bt=Pe,Lt)return;continue}yt=="["?Xo=!0:yt=="]"&&(Xo=!1),an+=yt}else{if(an=="")return we;if(En=a(Re,an))return En;if(an="",Bt=Ae,Lt==ue)return}break;case Ae:if(!Ee.test(yt)){if(yt==m||yt=="/"||yt=="?"||yt=="#"||yt=="\\"&&Dt(Re)||Lt){if(an!=""){var Ji=parseInt(an,10);if(65535<Ji)return ye;Re.port=Dt(Re)&&Ji===Pt[Re.scheme]?null:Ji,an=""}if(Lt)return;Bt=Pe;continue}return ye}an+=yt;break;case Ke:if(Re.scheme="file",yt=="/"||yt=="\\")Bt=ot;else{if(!kt||kt.scheme!="file"){Bt=Mt;continue}if(yt==m)Re.host=kt.host,Re.path=kt.path.slice(),Re.query=kt.query;else if(yt=="?")Re.host=kt.host,Re.path=kt.path.slice(),Re.query="",Bt=dn;else{if(yt!="#"){d(Xt.slice(mr).join(""))||(Re.host=kt.host,Re.path=kt.path.slice(),c(Re)),Bt=Mt;continue}Re.host=kt.host,Re.path=kt.path.slice(),Re.query=kt.query,Re.fragment="",Bt=mn}}break;case ot:if(yt=="/"||yt=="\\"){Bt=vt;break}kt&&kt.scheme=="file"&&!d(Xt.slice(mr).join(""))&&(h(kt.path[0],!0)?Re.path.push(kt.path[0]):Re.host=kt.host),Bt=Mt;continue;case vt:if(yt==m||yt=="/"||yt=="\\"||yt=="?"||yt=="#"){if(!Lt&&h(an))Bt=Mt;else if(an==""){if(Re.host="",Lt)return;Bt=Pe}else{if(En=a(Re,an))return En;if(Re.host=="localhost"&&(Re.host=""),Lt)return;an="",Bt=Pe}continue}an+=yt;break;case Pe:if(Dt(Re)){if(Bt=Mt,yt!="/"&&yt!="\\")continue}else if(Lt||yt!="?")if(Lt||yt!="#"){if(yt!=m&&(Bt=Mt,yt!="/"))continue}else Re.fragment="",Bt=mn;else Re.query="",Bt=dn;break;case Mt:if(yt==m||yt=="/"||yt=="\\"&&Dt(Re)||!Lt&&(yt=="?"||yt=="#")){if((Cn=(Cn=an).toLowerCase())===".."||Cn==="%2e."||Cn===".%2e"||Cn==="%2e%2e"?(c(Re),yt=="/"||yt=="\\"&&Dt(Re)||Re.path.push("")):(Yn=an)==="."||Yn.toLowerCase()==="%2e"?yt=="/"||yt=="\\"&&Dt(Re)||Re.path.push(""):(Re.scheme=="file"&&!Re.path.length&&h(an)&&(Re.host&&(Re.host=""),an=an.charAt(0)+":"),Re.path.push(an)),an="",Re.scheme=="file"&&(yt==m||yt=="?"||yt=="#"))for(;1<Re.path.length&&Re.path[0]==="";)Re.path.shift();yt=="?"?(Re.query="",Bt=dn):yt=="#"&&(Re.fragment="",Bt=mn)}else an+=xt(yt,tt);break;case en:yt=="?"?(Re.query="",Bt=dn):yt=="#"?(Re.fragment="",Bt=mn):yt!=m&&(Re.path[0]+=xt(yt,Ne));break;case dn:Lt||yt!="#"?yt!=m&&(yt=="'"&&Dt(Re)?Re.query+="%27":Re.query+=yt=="#"?"%23":xt(yt,Ne)):(Re.fragment="",Bt=mn);break;case mn:yt!=m&&(Re.fragment+=xt(yt,rt))}mr++}}function p(Re,gt){return{get:Re,set:gt,configurable:!0,enumerable:!0}}var m,g=n("../internals/export"),y=n("../internals/descriptors"),v=n("../internals/native-url"),b=n("../internals/global"),w=n("../internals/object-define-properties"),_=n("../internals/redefine"),I=n("../internals/an-instance"),C=n("../internals/has"),N=n("../internals/object-assign"),O=n("../internals/array-from"),D=n("../internals/string-multibyte").codeAt,M=n("../internals/string-punycode-to-ascii"),P=n("../internals/set-to-string-tag"),F=n("../modules/web.url-search-params"),B=n("../internals/internal-state"),z=b.URL,Z=F.URLSearchParams,Q=F.getState,K=B.set,ne=B.getterFor("URL"),re=Math.floor,ce=Math.pow,be="Invalid scheme",we="Invalid host",ye="Invalid port",Oe=/[A-Za-z]/,Se=/[\d+-.A-Za-z]/,Ee=/\d/,j=/^(0x|0X)/,W=/^[0-7]+$/,J=/^\d+$/,ie=/^[\dA-Fa-f]+$/,ve=/[\u0000\u0009\u000A\u000D #%/:?@[\\]]/,he=/[\u0000\u0009\u000A\u000D #/:?@[\\]]/,Fe=/^[\u0000-\u001F ]+|[\u0000-\u001F ]+$/g,me=/[\u0009\u000A\u000D]/g,Le=function(Re){var gt,Lt,kt,Xt,yt,_n,En,Yn=Re.split(".");if(Yn.length&&Yn[Yn.length-1]==""&&Yn.pop(),4<(gt=Yn.length))return Re;for(Lt=[],kt=0;kt<gt;kt++){if((Xt=Yn[kt])=="")return Re;if(yt=10,1<Xt.length&&Xt.charAt(0)=="0"&&(yt=j.test(Xt)?16:8,Xt=Xt.slice(yt==8?1:2)),Xt==="")_n=0;else{if(!(yt==10?J:yt==8?W:ie).test(Xt))return Re;_n=parseInt(Xt,yt)}Lt.push(_n)}for(kt=0;kt<gt;kt++)if(_n=Lt[kt],kt==gt-1){if(_n>=ce(256,5-gt))return null}else if(255<_n)return null;for(En=Lt.pop(),kt=0;kt<Lt.length;kt++)En+=Lt[kt]*ce(256,3-kt);return En},De=function(Re){function gt(){return Re.charAt(an)}var Lt,kt,Xt,yt,_n,En,Yn,Cn=[0,0,0,0,0,0,0,0],Bt=0,mr=null,an=0;if(gt()==":"){if(Re.charAt(1)!=":")return;an+=2,mr=++Bt}for(;gt();){if(Bt==8)return;if(gt()!=":"){for(Lt=kt=0;kt<4&&ie.test(gt());)Lt=16*Lt+parseInt(gt(),16),an++,kt++;if(gt()=="."){if(kt==0||(an-=kt,6<Bt))return;for(Xt=0;gt();){if(yt=null,0<Xt){if(!(gt()=="."&&Xt<4))return;an++}if(!Ee.test(gt()))return;for(;Ee.test(gt());){if(_n=parseInt(gt(),10),yt===null)yt=_n;else{if(yt==0)return;yt=10*yt+_n}if(255<yt)return;an++}Cn[Bt]=256*Cn[Bt]+yt,++Xt!=2&&Xt!=4||Bt++}if(Xt!=4)return;break}if(gt()==":"){if(an++,!gt())return}else if(gt())return;Cn[Bt++]=Lt}else{if(mr!==null)return;an++,mr=++Bt}}if(mr!==null)for(En=Bt-mr,Bt=7;Bt!=0&&0<En;)Yn=Cn[Bt],Cn[Bt--]=Cn[mr+En-1],Cn[mr+--En]=Yn;else if(Bt!=8)return;return Cn},Ne={},rt=N({},Ne,{" ":1,'"':1,"<":1,">":1,"`":1}),tt=N({},rt,{"#":1,"?":1,"{":1,"}":1}),Je=N({},tt,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),xt=function(Re,gt){var Lt=D(Re,0);return 32<Lt&&Lt<127&&!C(gt,Re)?Re:encodeURIComponent(Re)},Pt={ftp:21,file:null,http:80,https:443,ws:80,wss:443},Dt=function(Re){return C(Pt,Re.scheme)},St={},Jt={},ht={},ct={},At={},Ft={},Be={},qt={},Y={},le={},ee={},ue={},Ae={},Ke={},ot={},vt={},Pe={},Mt={},en={},dn={},mn={},hn=function(Re,gt){var Lt,kt,Xt=I(this,hn,"URL"),yt=1<arguments.length?gt:void 0,_n=String(Re),En=K(Xt,{type:"URL"});if(yt!==void 0){if(yt instanceof hn)Lt=ne(yt);else if(kt=f(Lt={},String(yt)))throw TypeError(kt)}if(kt=f(En,_n,null,Lt))throw TypeError(kt);var Yn=En.searchParams=new Z,Cn=Q(Yn);Cn.updateSearchParams(En.query),Cn.updateURL=function(){En.query=String(Yn)||null},y||(Xt.href=jn.call(Xt),Xt.origin=Ps.call(Xt),Xt.protocol=ms.call(Xt),Xt.username=Es.call(Xt),Xt.password=Ho.call(Xt),Xt.host=zr.call(Xt),Xt.hostname=js.call(Xt),Xt.port=gi.call(Xt),Xt.pathname=cr.call(Xt),Xt.search=as.call(Xt),Xt.searchParams=qo.call(Xt),Xt.hash=wa.call(Xt))},gn=hn.prototype,jn=function(){var Re=ne(this),gt=Re.scheme,Lt=Re.username,kt=Re.password,Xt=Re.host,yt=Re.port,_n=Re.path,En=Re.query,Yn=Re.fragment,Cn=gt+":";return Xt!==null?(Cn+="//",l(Re)&&(Cn+=Lt+(kt?":"+kt:"")+"@"),Cn+=i(Xt),yt!==null&&(Cn+=":"+yt)):gt=="file"&&(Cn+="//"),Cn+=Re.cannotBeABaseURL?_n[0]:_n.length?"/"+_n.join("/"):"",En!==null&&(Cn+="?"+En),Yn!==null&&(Cn+="#"+Yn),Cn},Ps=function(){var Re=ne(this),gt=Re.scheme,Lt=Re.port;if(gt=="blob")try{return new URL(gt.path[0]).origin}catch{return"null"}return gt!="file"&&Dt(Re)?gt+"://"+i(Re.host)+(Lt!==null?":"+Lt:""):"null"},ms=function(){return ne(this).scheme+":"},Es=function(){return ne(this).username},Ho=function(){return ne(this).password},zr=function(){var Re=ne(this),gt=Re.host,Lt=Re.port;return gt===null?"":Lt===null?i(gt):i(gt)+":"+Lt},js=function(){var Re=ne(this).host;return Re===null?"":i(Re)},gi=function(){var Re=ne(this).port;return Re===null?"":String(Re)},cr=function(){var Re=ne(this),gt=Re.path;return Re.cannotBeABaseURL?gt[0]:gt.length?"/"+gt.join("/"):""},as=function(){var Re=ne(this).query;return Re?"?"+Re:""},qo=function(){return ne(this).searchParams},wa=function(){var Re=ne(this).fragment;return Re?"#"+Re:""};if(y&&w(gn,{href:p(jn,function(Re){var gt=ne(this),Lt=String(Re),kt=f(gt,Lt);if(kt)throw TypeError(kt);Q(gt.searchParams).updateSearchParams(gt.query)}),origin:p(Ps),protocol:p(ms,function(Re){var gt=ne(this);f(gt,String(Re)+":",St)}),username:p(Es,function(Re){var gt=ne(this),Lt=O(String(Re));if(!u(gt)){gt.username="";for(var kt=0;kt<Lt.length;kt++)gt.username+=xt(Lt[kt],Je)}}),password:p(Ho,function(Re){var gt=ne(this),Lt=O(String(Re));if(!u(gt)){gt.password="";for(var kt=0;kt<Lt.length;kt++)gt.password+=xt(Lt[kt],Je)}}),host:p(zr,function(Re){var gt=ne(this);gt.cannotBeABaseURL||f(gt,String(Re),ee)}),hostname:p(js,function(Re){var gt=ne(this);gt.cannotBeABaseURL||f(gt,String(Re),ue)}),port:p(gi,function(Re){var gt=ne(this);u(gt)||((Re=String(Re))==""?gt.port=null:f(gt,Re,Ae))}),pathname:p(cr,function(Re){var gt=ne(this);gt.cannotBeABaseURL||(gt.path=[],f(gt,Re+"",Pe))}),search:p(as,function(Re){var gt=ne(this);(Re=String(Re))==""?gt.query=null:(Re.charAt(0)=="?"&&(Re=Re.slice(1)),gt.query="",f(gt,Re,dn)),Q(gt.searchParams).updateSearchParams(gt.query)}),searchParams:p(qo),hash:p(wa,function(Re){var gt=ne(this);(Re=String(Re))!=""?(Re.charAt(0)=="#"&&(Re=Re.slice(1)),gt.fragment="",f(gt,Re,mn)):gt.fragment=null})}),_(gn,"toJSON",function(){return jn.call(this)},{enumerable:!0}),_(gn,"toString",function(){return jn.call(this)},{enumerable:!0}),z){var ho=z.createObjectURL,ko=z.revokeObjectURL;ho&&_(hn,"createObjectURL",function(Re){return ho.apply(z,arguments)}),ko&&_(hn,"revokeObjectURL",function(Re){return ko.apply(z,arguments)})}P(hn,"URL"),g({global:!0,forced:!v,sham:!y},{URL:hn})},{"../internals/an-instance":9,"../internals/array-from":17,"../internals/descriptors":42,"../internals/export":49,"../internals/global":59,"../internals/has":60,"../internals/internal-state":70,"../internals/native-url":84,"../internals/object-assign":89,"../internals/object-define-properties":91,"../internals/redefine":108,"../internals/set-to-string-tag":117,"../internals/string-multibyte":123,"../internals/string-punycode-to-ascii":124,"../modules/es.string.iterator":186,"../modules/web.url-search-params":230}],232:[function(n,s,o){s.exports=n("./").polyfill()},{"./":233}],233:[function(n,s,o){(function(a,i){var l,u;l=this,u=function(){function h(me){return typeof me=="function"}var d=Array.isArray?Array.isArray:function(me){return Object.prototype.toString.call(me)==="[object Array]"},c=0,f=void 0,p=void 0,m=function(me,Le){I[c]=me,I[c+1]=Le,(c+=2)===2&&(p?p(C):P())},g=typeof window!="undefined"?window:void 0,y=g||{},v=y.MutationObserver||y.WebKitMutationObserver,b=typeof self=="undefined"&&a!==void 0&&{}.toString.call(a)==="[object process]",w=typeof Uint8ClampedArray!="undefined"&&typeof importScripts!="undefined"&&typeof MessageChannel!="undefined";function _(){var me=setTimeout;return function(){return me(C,1)}}var I=new Array(1e3);function C(){for(var me=0;me<c;me+=2)(0,I[me])(I[me+1]),I[me]=void 0,I[me+1]=void 0;c=0}var N,O,D,M,P=void 0;function F(me,Le){var De=this,Ne=new this.constructor(Z);Ne[z]===void 0&&J(Ne);var rt=De._state;if(rt){var tt=arguments[rt-1];m(function(){return j(rt,Ne,tt,De._result)})}else Se(De,Ne,me,Le);return Ne}function B(me){if(me&&typeof me=="object"&&me.constructor===this)return me;var Le=new this(Z);return be(Le,me),Le}P=b?function(){return a.nextTick(C)}:v?(O=0,D=new v(C),M=document.createTextNode(""),D.observe(M,{characterData:!0}),function(){M.data=O=++O%2}):w?((N=new MessageChannel).port1.onmessage=C,function(){return N.port2.postMessage(0)}):g===void 0&&typeof n=="function"?function(){try{var me=Function("return this")().require("vertx");return(f=me.runOnLoop||me.runOnContext)!==void 0?function(){f(C)}:_()}catch{return _()}}():_();var z=Math.random().toString(36).substring(2);function Z(){}var Q=void 0,K=1,ne=2;function re(me,Le,De){m(function(Ne){var rt=!1,tt=function(Je,xt,Pt,Dt){try{Je.call(xt,Pt,Dt)}catch(St){return St}}(De,Le,function(Je){rt||(rt=!0,Le!==Je?be(Ne,Je):ye(Ne,Je))},function(Je){rt||(rt=!0,Oe(Ne,Je))},Ne._label);!rt&&tt&&(rt=!0,Oe(Ne,tt))},me)}function ce(me,Le,De){var Ne,rt;Le.constructor===me.constructor&&De===F&&Le.constructor.resolve===B?(Ne=me,(rt=Le)._state===K?ye(Ne,rt._result):rt._state===ne?Oe(Ne,rt._result):Se(rt,void 0,function(tt){return be(Ne,tt)},function(tt){return Oe(Ne,tt)})):De===void 0?ye(me,Le):h(De)?re(me,Le,De):ye(me,Le)}function be(me,Le){if(me===Le)Oe(me,new TypeError("You cannot resolve a promise with itself"));else if(rt=typeof(Ne=Le),Ne===null||rt!="object"&&rt!="function")ye(me,Le);else{var De=void 0;try{De=Le.then}catch(tt){return void Oe(me,tt)}ce(me,Le,De)}var Ne,rt}function we(me){me._onerror&&me._onerror(me._result),Ee(me)}function ye(me,Le){me._state===Q&&(me._result=Le,me._state=K,me._subscribers.length!==0&&m(Ee,me))}function Oe(me,Le){me._state===Q&&(me._state=ne,me._result=Le,m(we,me))}function Se(me,Le,De,Ne){var rt=me._subscribers,tt=rt.length;me._onerror=null,rt[tt]=Le,rt[tt+K]=De,rt[tt+ne]=Ne,tt===0&&me._state&&m(Ee,me)}function Ee(me){var Le=me._subscribers,De=me._state;if(Le.length!==0){for(var Ne=void 0,rt=void 0,tt=me._result,Je=0;Je<Le.length;Je+=3)Ne=Le[Je],rt=Le[Je+De],Ne?j(De,Ne,rt,tt):rt(tt);me._subscribers.length=0}}function j(me,Le,De,Ne){var rt=h(De),tt=void 0,Je=void 0,xt=!0;if(rt){try{tt=De(Ne)}catch(Pt){xt=!1,Je=Pt}if(Le===tt)return void Oe(Le,new TypeError("A promises callback cannot return that same promise."))}else tt=Ne;Le._state!==Q||(rt&&xt?be(Le,tt):xt===!1?Oe(Le,Je):me===K?ye(Le,tt):me===ne&&Oe(Le,tt))}var W=0;function J(me){me[z]=W++,me._state=void 0,me._result=void 0,me._subscribers=[]}var ie=(ve.prototype._enumerate=function(me){for(var Le=0;this._state===Q&&Le<me.length;Le++)this._eachEntry(me[Le],Le)},ve.prototype._eachEntry=function(me,Le){var De=this._instanceConstructor,Ne=De.resolve;if(Ne===B){var rt=void 0,tt=void 0,Je=!1;try{rt=me.then}catch(Pt){Je=!0,tt=Pt}if(rt===F&&me._state!==Q)this._settledAt(me._state,Le,me._result);else if(typeof rt!="function")this._remaining--,this._result[Le]=me;else if(De===he){var xt=new De(Z);Je?Oe(xt,tt):ce(xt,me,rt),this._willSettleAt(xt,Le)}else this._willSettleAt(new De(function(Pt){return Pt(me)}),Le)}else this._willSettleAt(Ne(me),Le)},ve.prototype._settledAt=function(me,Le,De){var Ne=this.promise;Ne._state===Q&&(this._remaining--,me===ne?Oe(Ne,De):this._result[Le]=De),this._remaining===0&&ye(Ne,this._result)},ve.prototype._willSettleAt=function(me,Le){var De=this;Se(me,void 0,function(Ne){return De._settledAt(K,Le,Ne)},function(Ne){return De._settledAt(ne,Le,Ne)})},ve);function ve(me,Le){this._instanceConstructor=me,this.promise=new me(Z),this.promise[z]||J(this.promise),d(Le)?(this.length=Le.length,this._remaining=Le.length,this._result=new Array(this.length),this.length===0?ye(this.promise,this._result):(this.length=this.length||0,this._enumerate(Le),this._remaining===0&&ye(this.promise,this._result))):Oe(this.promise,new Error("Array Methods must be provided an Array"))}var he=(Fe.prototype.catch=function(me){return this.then(null,me)},Fe.prototype.finally=function(me){var Le=this.constructor;return h(me)?this.then(function(De){return Le.resolve(me()).then(function(){return De})},function(De){return Le.resolve(me()).then(function(){throw De})}):this.then(me,me)},Fe);function Fe(me){this[z]=W++,this._result=this._state=void 0,this._subscribers=[],Z!==me&&(typeof me!="function"&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof Fe?function(Le,De){try{De(function(Ne){be(Le,Ne)},function(Ne){Oe(Le,Ne)})}catch(Ne){Oe(Le,Ne)}}(this,me):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return he.prototype.then=F,he.all=function(me){return new ie(this,me).promise},he.race=function(me){var Le=this;return d(me)?new Le(function(De,Ne){for(var rt=me.length,tt=0;tt<rt;tt++)Le.resolve(me[tt]).then(De,Ne)}):new Le(function(De,Ne){return Ne(new TypeError("You must pass an array to race."))})},he.resolve=B,he.reject=function(me){var Le=new this(Z);return Oe(Le,me),Le},he._setScheduler=function(me){p=me},he._setAsap=function(me){m=me},he._asap=m,he.polyfill=function(){var me=void 0;if(i!==void 0)me=i;else if(typeof self!="undefined")me=self;else try{me=Function("return this")()}catch{throw new Error("polyfill failed because global object is unavailable in this environment")}var Le=me.Promise;if(Le){var De=null;try{De=Object.prototype.toString.call(Le.resolve())}catch{}if(De==="[object Promise]"&&!Le.cast)return}me.Promise=he},he.Promise=he},typeof o=="object"&&s!==void 0?s.exports=u():l.ES6Promise=u()}).call(this,n("_process"),typeof Pr!="undefined"?Pr:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{_process:241}],234:[function(n,s,o){(function(a,i){if(o!==void 0&&s!==void 0)i(o,s);else{var l={exports:{}};i(l.exports,l),a.fetchJsonp=l.exports}})(this,function(a,i){var l=5e3,u="callback";function h(c){try{delete window[c]}catch{window[c]=void 0}}function d(c){var f=document.getElementById(c);f&&document.getElementsByTagName("head")[0].removeChild(f)}i.exports=function(c){var f=arguments.length<=1||arguments[1]===void 0?{}:arguments[1],p=c,m=f.timeout||l,g=f.jsonpCallback||u,y=void 0;return new Promise(function(v,b){var w=f.jsonpCallbackFunction||"jsonp_"+Date.now()+"_"+Math.ceil(1e5*Math.random()),_=g+"_"+w;window[w]=function(C){v({ok:!0,json:function(){return Promise.resolve(C)}}),y&&clearTimeout(y),d(_),h(w)},p+=p.indexOf("?")===-1?"?":"&";var I=document.createElement("script");I.setAttribute("src",""+p+g+"="+w),f.charset&&I.setAttribute("charset",f.charset),I.id=_,document.getElementsByTagName("head")[0].appendChild(I),y=setTimeout(function(){b(new Error("JSONP request to "+c+" timed out")),h(w),d(_),window[w]=function(){h(w)}},m),I.onerror=function(){b(new Error("JSONP request to "+c+" failed")),h(w),d(_),y&&clearTimeout(y)}})}})},{}],235:[function(n,s,o){var a=a||function(i){if(!(i===void 0||typeof navigator!="undefined"&&/MSIE [1-9]\./.test(navigator.userAgent))){var l=i.document,u=function(){return i.URL||i.webkitURL||i},h=l.createElementNS("http://www.w3.org/1999/xhtml","a"),d="download"in h,c=/constructor/i.test(i.HTMLElement)||i.safari,f=/CriOS\/[\d]+/.test(navigator.userAgent),p=function(b){(i.setImmediate||i.setTimeout)(function(){throw b},0)},m=function(b){setTimeout(function(){typeof b=="string"?u().revokeObjectURL(b):b.remove()},4e4)},g=function(b){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(b.type)?new Blob([String.fromCharCode(65279),b],{type:b.type}):b},y=function(b,w,_){_||(b=g(b));function I(){(function(D,M,P){for(var F=(M=[].concat(M)).length;F--;){var B=D["on"+M[F]];if(typeof B=="function")try{B.call(D,P||D)}catch(z){p(z)}}})(N,"writestart progress write writeend".split(" "))}var C,N=this,O=b.type==="application/octet-stream";if(N.readyState=N.INIT,d)return C=u().createObjectURL(b),void setTimeout(function(){var D,M;h.href=C,h.download=w,D=h,M=new MouseEvent("click"),D.dispatchEvent(M),I(),m(C),N.readyState=N.DONE});(function(){if((f||O&&c)&&i.FileReader){var D=new FileReader;return D.onloadend=function(){var M=f?D.result:D.result.replace(/^data:[^;]*;/,"data:attachment/file;");i.open(M,"_blank")||(i.location.href=M),M=void 0,N.readyState=N.DONE,I()},D.readAsDataURL(b),N.readyState=N.INIT}C=C||u().createObjectURL(b),O?i.location.href=C:i.open(C,"_blank")||(i.location.href=C),N.readyState=N.DONE,I(),m(C)})()},v=y.prototype;return typeof navigator!="undefined"&&navigator.msSaveOrOpenBlob?function(b,w,_){return w=w||b.name||"download",_||(b=g(b)),navigator.msSaveOrOpenBlob(b,w)}:(v.abort=function(){},v.readyState=v.INIT=0,v.WRITING=1,v.DONE=2,v.error=v.onwritestart=v.onprogress=v.onwrite=v.onabort=v.onerror=v.onwriteend=null,function(b,w,_){return new y(b,w||b.name||"download",_)})}}(typeof self!="undefined"&&self||typeof window!="undefined"&&window||this.content);s!==void 0&&s.exports?s.exports.saveAs=a:t!=null},{}],236:[function(n,s,o){o.read=function(a,i,l,u,h){var d,c,f=8*h-u-1,p=(1<<f)-1,m=p>>1,g=-7,y=l?h-1:0,v=l?-1:1,b=a[i+y];for(y+=v,d=b&(1<<-g)-1,b>>=-g,g+=f;0<g;d=256*d+a[i+y],y+=v,g-=8);for(c=d&(1<<-g)-1,d>>=-g,g+=u;0<g;c=256*c+a[i+y],y+=v,g-=8);if(d===0)d=1-m;else{if(d===p)return c?NaN:1/0*(b?-1:1);c+=Math.pow(2,u),d-=m}return(b?-1:1)*c*Math.pow(2,d-u)},o.write=function(a,i,l,u,h,d){var c,f,p,m=8*d-h-1,g=(1<<m)-1,y=g>>1,v=h===23?Math.pow(2,-24)-Math.pow(2,-77):0,b=u?0:d-1,w=u?1:-1,_=i<0||i===0&&1/i<0?1:0;for(i=Math.abs(i),isNaN(i)||i===1/0?(f=isNaN(i)?1:0,c=g):(c=Math.floor(Math.log(i)/Math.LN2),i*(p=Math.pow(2,-c))<1&&(c--,p*=2),2<=(i+=1<=c+y?v/p:v*Math.pow(2,1-y))*p&&(c++,p/=2),g<=c+y?(f=0,c=g):1<=c+y?(f=(i*p-1)*Math.pow(2,h),c+=y):(f=i*Math.pow(2,y-1)*Math.pow(2,h),c=0));8<=h;a[l+b]=255&f,b+=w,f/=256,h-=8);for(c=c<<h|f,m+=h;0<m;a[l+b]=255&c,b+=w,c/=256,m-=8);a[l+b-w]|=128*_}},{}],237:[function(n,s,o){var a;function i(Y,le){return Y.b===le.b&&Y.a===le.a}function l(Y,le){return Y.b<le.b||Y.b===le.b&&Y.a<=le.a}function u(Y,le,ee){var ue=le.b-Y.b,Ae=ee.b-le.b;return 0<ue+Ae?ue<Ae?le.a-Y.a+ue/(ue+Ae)*(Y.a-ee.a):le.a-ee.a+Ae/(ue+Ae)*(ee.a-Y.a):0}function h(Y,le,ee){var ue=le.b-Y.b,Ae=ee.b-le.b;return 0<ue+Ae?(le.a-ee.a)*ue+(le.a-Y.a)*Ae:0}function d(Y,le){return Y.a<le.a||Y.a===le.a&&Y.b<=le.b}function c(Y,le,ee){var ue=le.a-Y.a,Ae=ee.a-le.a;return 0<ue+Ae?ue<Ae?le.b-Y.b+ue/(ue+Ae)*(Y.b-ee.b):le.b-ee.b+Ae/(ue+Ae)*(ee.b-Y.b):0}function f(Y,le,ee){var ue=le.a-Y.a,Ae=ee.a-le.a;return 0<ue+Ae?(le.b-ee.b)*ue+(le.b-Y.b)*Ae:0}function p(Y,le,ee,ue){return(Y=Y<0?0:Y)<=(ee=ee<0?0:ee)?ee===0?(le+ue)/2:le+Y/(Y+ee)*(ue-le):ue+ee/(Y+ee)*(le-ue)}function m(Y){var le=w(Y.b);return I(le,Y.c),I(le.b,Y.c),C(le,Y.a),le}function g(Y,le){var ee=!1,ue=!1;Y!==le&&(le.a!==Y.a&&(ue=!0,O(le.a,Y.a)),le.d!==Y.d&&(ee=!0,D(le.d,Y.d)),_(le,Y),ue||(I(le,Y.a),Y.a.c=Y),ee||(C(le,Y.d),Y.d.a=Y))}function y(Y){var le=Y.b,ee=!1;Y.d!==Y.b.d&&(ee=!0,D(Y.d,Y.b.d)),Y.c===Y?O(Y.a,null):(Y.b.d.a=Ne(Y),Y.a.c=Y.c,_(Y,Ne(Y)),ee||C(Y,Y.d)),le.c===le?(O(le.a,null),D(le.d,null)):(Y.d.a=Ne(le),le.a.c=le.c,_(le,Ne(le))),N(Y)}function v(Y){var le=w(Y),ee=le.b;return _(le,Y.e),le.a=Y.b.a,I(ee,le.a),le.d=ee.d=Y.d,le=le.b,_(Y.b,Ne(Y.b)),_(Y.b,le),Y.b.a=le.a,le.b.a.c=le.b,le.b.d=Y.b.d,le.f=Y.f,le.b.f=Y.b.f,le}function b(Y,le){var ee=!1,ue=w(Y),Ae=ue.b;return le.d!==Y.d&&(ee=!0,D(le.d,Y.d)),_(ue,Y.e),_(Ae,le),ue.a=Y.b.a,Ae.a=le.a,ue.d=Ae.d=Y.d,Y.d.a=Ae,ee||C(ue,Y.d),ue}function w(Y){var le=new De,ee=new De,ue=Y.b.h;return(((ee.h=ue).b.h=le).h=Y).b.h=ee,le.b=ee,((le.c=le).e=ee).b=le,(ee.c=ee).e=le}function _(Y,le){var ee=Y.c,ue=le.c;ee.b.e=le,(ue.b.e=Y).c=ue,le.c=ee}function I(Y,le){var ee=le.f,ue=new tt(le,ee);for(ee.e=ue,ee=(le.f=ue).c=Y;ee.a=ue,(ee=ee.c)!==Y;);}function C(Y,le){var ee=le.d,ue=new Le(le,ee);for(ee.b=ue,(le.d=ue).a=Y,ue.c=le.c,ee=Y;ee.d=ue,(ee=ee.e)!==Y;);}function N(Y){var le=Y.h;Y=Y.b.h,(le.b.h=Y).b.h=le}function O(Y,le){for(var ee=Y.c,ue=ee;ue.a=le,(ue=ue.c)!==ee;);ee=Y.f,((ue=Y.e).f=ee).e=ue}function D(Y,le){for(var ee=Y.a,ue=ee;ue.d=le,(ue=ue.e)!==ee;);ee=Y.d,((ue=Y.b).d=ee).b=ue}function M(Y){var le=0;return Math.abs(Y[1])>Math.abs(Y[0])&&(le=1),Math.abs(Y[2])>Math.abs(Y[le])&&(le=2),le}function P(Y,le){Y.f+=le.f,Y.b.f+=le.b.f}function F(Y,le,ee){return Y=Y.a,le=le.a,ee=ee.a,le.b.a===Y?ee.b.a===Y?l(le.a,ee.a)?h(ee.b.a,le.a,ee.a)<=0:0<=h(le.b.a,ee.a,le.a):h(ee.b.a,Y,ee.a)<=0:ee.b.a===Y?0<=h(le.b.a,Y,le.a):(le=u(le.b.a,Y,le.a),(Y=u(ee.b.a,Y,ee.a))<=le)}function B(Y){Y.a.i=null;var le=Y.e;le.a.c=le.c,le.c.a=le.a,Y.e=null}function z(Y,le){y(Y.a),Y.c=!1,(Y.a=le).i=Y}function Z(Y){for(var le=Y.a.a;(Y=qt(Y)).a.a===le;);return Y.c&&(z(Y,le=b(Be(Y).a.b,Y.a.e)),Y=qt(Y)),Y}function Q(Y,le,ee){var ue=new Ft;return ue.a=ee,ue.e=ie(Y.f,le.e,ue),ee.i=ue}function K(Y,le){switch(Y.s){case 100130:return(1&le)!=0;case 100131:return le!==0;case 100132:return 0<le;case 100133:return le<0;case 100134:return 2<=le||le<=-2}return!1}function ne(Y){var le=Y.a,ee=le.d;ee.c=Y.d,ee.a=le,B(Y)}function re(Y,le,ee){for(le=(Y=le).a;Y!==ee;){Y.c=!1;var ue=Be(Y),Ae=ue.a;if(Ae.a!==le.a){if(!ue.c){ne(Y);break}z(ue,Ae=b(le.c.b,Ae.b))}le.c!==Ae&&(g(Ne(Ae),Ae),g(le,Ae)),ne(Y),le=ue.a,Y=ue}return le}function ce(Y,le,ee,ue,Ae,Ke){for(var ot=!0;Q(Y,le,ee.b),(ee=ee.c)!==ue;);for(Ae===null&&(Ae=Be(le).a.b.c);(ee=(ue=Be(le)).a.b).a===Ae.a;)ee.c!==Ae&&(g(Ne(ee),ee),g(Ne(Ae),ee)),ue.f=le.f-ee.f,ue.d=K(Y,ue.f),le.b=!0,!ot&&Oe(Y,le)&&(P(ee,Ae),B(le),y(Ae)),ot=!1,le=ue,Ae=ee;le.b=!0,Ke&&Ee(Y,le)}function be(Y,le,ee,ue,Ae){var Ke=[le.g[0],le.g[1],le.g[2]];le.d=null,le.d=Y.o&&Y.o(Ke,ee,ue,Y.c)||null,le.d===null&&(Ae?Y.n||(me(Y,100156),Y.n=!0):le.d=ee[0])}function we(Y,le,ee){var ue=[null,null,null,null];ue[0]=le.a.d,ue[1]=ee.a.d,be(Y,le.a,ue,[.5,.5,0,0],!1),g(le,ee)}function ye(Y,le,ee,ue,Ae){var Ke=Math.abs(le.b-Y.b)+Math.abs(le.a-Y.a),ot=Math.abs(ee.b-Y.b)+Math.abs(ee.a-Y.a),vt=Ae+1;ue[Ae]=.5*ot/(Ke+ot),ue[vt]=.5*Ke/(Ke+ot),Y.g[0]+=ue[Ae]*le.g[0]+ue[vt]*ee.g[0],Y.g[1]+=ue[Ae]*le.g[1]+ue[vt]*ee.g[1],Y.g[2]+=ue[Ae]*le.g[2]+ue[vt]*ee.g[2]}function Oe(Y,le){var ee=Be(le),ue=le.a,Ae=ee.a;if(l(ue.a,Ae.a)){if(0<h(Ae.b.a,ue.a,Ae.a))return!1;if(i(ue.a,Ae.a)){if(ue.a!==Ae.a){ee=Y.e;var Ke=ue.a.h;if(0<=Ke){var ot=(ee=ee.b).d,vt=ee.e,Pe=ee.c,Mt=Pe[Ke];ot[Mt]=ot[ee.a],(Pe[ot[Mt]]=Mt)<=--ee.a&&(Mt<=1||l(vt[ot[Mt>>1]],vt[ot[Mt]])?ct(ee,Mt):At(ee,Mt)),vt[Ke]=null,Pe[Ke]=ee.b,ee.b=Ke}else for(ee.c[-(Ke+1)]=null;0<ee.a&&ee.c[ee.d[ee.a-1]]===null;)--ee.a;we(Y,Ne(Ae),ue)}}else v(Ae.b),g(ue,Ne(Ae)),le.b=ee.b=!0}else{if(h(ue.b.a,Ae.a,ue.a)<0)return!1;qt(le).b=le.b=!0,v(ue.b),g(Ne(Ae),ue)}return!0}function Se(Y,le){var ee=Be(le),ue=le.a,Ae=ee.a,Ke=ue.a,ot=Ae.a,vt=ue.b.a,Pe=Ae.b.a,Mt=new tt;if(h(vt,Y.a,Ke),h(Pe,Y.a,ot),Ke===ot||Math.min(Ke.a,vt.a)>Math.max(ot.a,Pe.a))return!1;if(l(Ke,ot)){if(0<h(Pe,Ke,ot))return!1}else if(h(vt,ot,Ke)<0)return!1;var en,dn,mn=vt,hn=Ke,gn=Pe,jn=ot;if(l(mn,hn)||(en=mn,mn=hn,hn=en),l(gn,jn)||(en=gn,gn=jn,jn=en),l(mn,gn)||(en=mn,mn=gn,gn=en,en=hn,hn=jn,jn=en),l(gn,hn)?l(hn,jn)?((en=u(mn,gn,hn))+(dn=u(gn,hn,jn))<0&&(en=-en,dn=-dn),Mt.b=p(en,gn.b,dn,hn.b)):((en=h(mn,gn,hn))+(dn=-h(mn,jn,hn))<0&&(en=-en,dn=-dn),Mt.b=p(en,gn.b,dn,jn.b)):Mt.b=(gn.b+hn.b)/2,d(mn,hn)||(en=mn,mn=hn,hn=en),d(gn,jn)||(en=gn,gn=jn,jn=en),d(mn,gn)||(en=mn,mn=gn,gn=en,en=hn,hn=jn,jn=en),d(gn,hn)?d(hn,jn)?((en=c(mn,gn,hn))+(dn=c(gn,hn,jn))<0&&(en=-en,dn=-dn),Mt.a=p(en,gn.a,dn,hn.a)):((en=f(mn,gn,hn))+(dn=-f(mn,jn,hn))<0&&(en=-en,dn=-dn),Mt.a=p(en,gn.a,dn,jn.a)):Mt.a=(gn.a+hn.a)/2,l(Mt,Y.a)&&(Mt.b=Y.a.b,Mt.a=Y.a.a),mn=l(Ke,ot)?Ke:ot,l(mn,Mt)&&(Mt.b=mn.b,Mt.a=mn.a),i(Mt,Ke)||i(Mt,ot))return Oe(Y,le),!1;if(!i(vt,Y.a)&&0<=h(vt,Y.a,Mt)||!i(Pe,Y.a)&&h(Pe,Y.a,Mt)<=0){if(Pe===Y.a)return v(ue.b),g(Ae.b,ue),ue=Be(le=Z(le)).a,re(Y,Be(le),ee),ce(Y,le,Ne(ue),ue,ue,!0),!0;if(vt!==Y.a)return 0<=h(vt,Y.a,Mt)&&(qt(le).b=le.b=!0,v(ue.b),ue.a.b=Y.a.b,ue.a.a=Y.a.a),h(Pe,Y.a,Mt)<=0&&(le.b=ee.b=!0,v(Ae.b),Ae.a.b=Y.a.b,Ae.a.a=Y.a.a),!1;for(v(Ae.b),g(ue.e,Ne(Ae)),ot=(Ke=ee=le).a.b.a;(Ke=qt(Ke)).a.b.a===ot;);return Ke=Be(le=Ke).a.b.c,ee.a=Ne(Ae),ce(Y,le,(Ae=re(Y,ee,null)).c,ue.b.c,Ke,!0),!0}return v(ue.b),v(Ae.b),g(Ne(Ae),ue),ue.a.b=Mt.b,ue.a.a=Mt.a,ue.a.h=xt(Y.e,ue.a),ue=ue.a,Ae=[0,0,0,0],Mt=[Ke.d,vt.d,ot.d,Pe.d],ue.g[0]=ue.g[1]=ue.g[2]=0,ye(ue,Ke,vt,Ae,0),ye(ue,ot,Pe,Ae,2),be(Y,ue,Mt,Ae,!0),qt(le).b=le.b=ee.b=!0,!1}function Ee(Y,le){for(var ee=Be(le);;){for(;ee.b;)ee=Be(le=ee);if(!le.b&&((le=qt(ee=le))===null||!le.b))break;le.b=!1;var ue,Ae=le.a,Ke=ee.a;if(ue=Ae.b.a!==Ke.b.a)e:{var ot=Be(ue=le),vt=ue.a,Pe=ot.a,Mt=void 0;if(l(vt.b.a,Pe.b.a)){if(h(vt.b.a,Pe.b.a,vt.a)<0){ue=!1;break e}qt(ue).b=ue.b=!0,Mt=v(vt),g(Pe.b,Mt),Mt.d.c=ue.d}else{if(0<h(Pe.b.a,vt.b.a,Pe.a)){ue=!1;break e}ue.b=ot.b=!0,Mt=v(Pe),g(vt.e,Pe.b),Mt.b.d.c=ue.d}ue=!0}if(ue&&(ee.c?(B(ee),y(Ke),Ke=(ee=Be(le)).a):le.c&&(B(le),y(Ae),Ae=(le=qt(ee)).a)),Ae.a!==Ke.a){if(Ae.b.a===Ke.b.a||le.c||ee.c||Ae.b.a!==Y.a&&Ke.b.a!==Y.a)Oe(Y,le);else if(Se(Y,le))break}Ae.a===Ke.a&&Ae.b.a===Ke.b.a&&(P(Ke,Ae),B(le),y(Ae),le=qt(ee))}}function j(Y,le){for(var ee=(Y.a=le).c;ee.i===null;)if((ee=ee.c)===le.c){ee=Y;var ue=le;(ot=new Ft).a=ue.c.b;for(var Ae=(Pe=ee.f).a;(Ae=Ae.a).b!==null&&!Pe.c(Pe.b,ot,Ae.b););var Ke=Be(Pe=Ae.b),ot=Pe.a;if(Ae=Ke.a,h(ot.b.a,ue,ot.a)===0)i((ot=Pe.a).a,ue)||i(ot.b.a,ue)||(v(ot.b),Pe.c&&(y(ot.c),Pe.c=!1),g(ue.c,ot),j(ee,ue));else{var vt=l(Ae.b.a,ot.b.a)?Pe:Ke;Ke=void 0,Pe.d||vt.c?(Ke=vt===Pe?b(ue.c.b,ot.e):b(Ae.b.c.b,ue.c).b,vt.c?z(vt,Ke):((Pe=Q(ot=ee,Pe,Ke)).f=qt(Pe).f+Pe.a.f,Pe.d=K(ot,Pe.f)),j(ee,ue)):ce(ee,Pe,ue.c,ue.c,null,!0)}return}if(Pe=(ot=Be(ee=Z(ee.i))).a,(ot=re(Y,ot,null)).c===Pe){ot=(Pe=ot).c,Ae=Be(ee),Ke=ee.a,vt=Ae.a;var Pe,Mt=!1;Ke.b.a!==vt.b.a&&Se(Y,ee),i(Ke.a,Y.a)&&(g(Ne(ot),Ke),ot=Be(ee=Z(ee)).a,re(Y,Be(ee),Ae),Mt=!0),i(vt.a,Y.a)&&(g(Pe,Ne(vt)),Pe=re(Y,Ae,null),Mt=!0),Mt?ce(Y,ee,Pe.c,ot,ot,!0):(ue=l(vt.a,Ke.a)?Ne(vt):Ke,ce(Y,ee,ue=b(Pe.c.b,ue),ue.c,ue.c,!1),ue.b.i.c=!0,Ee(Y,ee))}else ce(Y,ee,ot.c,Pe,Pe,!0)}function W(Y,le){var ee=new Ft,ue=m(Y.b);ue.a.b=4e150,ue.a.a=le,ue.b.a.b=-4e150,ue.b.a.a=le,Y.a=ue.b.a,ee.a=ue,ee.f=0,ee.d=!1,ee.c=!1,ee.h=!0,ee.b=!1,ue=ie(ue=Y.f,ue.a,ee),ee.e=ue}function J(Y){this.a=new ve,this.b=Y,this.c=F}function ie(Y,le,ee){for(;(le=le.c).b!==null&&!Y.c(Y.b,le.b,ee););return Y=new ve(ee,le.a,le),le.a.c=Y,le.a=Y}function ve(Y,le,ee){this.b=Y||null,this.a=le||this,this.c=ee||this}function he(){this.d=0,this.p=this.b=this.q=null,this.j=[0,0,0],this.s=100130,this.n=!1,this.o=this.a=this.e=this.f=null,this.m=!1,this.c=this.r=this.i=this.k=this.l=this.h=null}function Fe(Y,le){if(Y.d!==le)for(;Y.d!==le;)if(Y.d<le)switch(Y.d){case 0:me(Y,100151),Y.u(null);break;case 1:me(Y,100152),Y.t()}else switch(Y.d){case 2:me(Y,100154),Y.v();break;case 1:me(Y,100153),Y.w()}}function me(Y,le){Y.p&&Y.p(le,Y.c)}function Le(Y,le){this.b=Y||this,this.d=le||this,this.a=null,this.c=!1}function De(){(this.h=this).i=this.d=this.a=this.e=this.c=this.b=null,this.f=0}function Ne(Y){return Y.b.e}function rt(){this.c=new tt,this.a=new Le,this.b=new De,this.d=new De,this.b.b=this.d,this.d.b=this.b}function tt(Y,le){this.e=Y||this,this.f=le||this,this.d=this.c=null,this.g=[0,0,0],this.h=this.a=this.b=0}function Je(){this.c=[],this.d=null,this.a=0,this.e=!1,this.b=new Dt}function xt(Y,le){if(Y.e){var ee,ue=Y.b,Ae=++ue.a;return 2*Ae>ue.f&&(ue.f*=2,ue.c=St(ue.c,ue.f+1)),ue.b===0?ee=Ae:(ee=ue.b,ue.b=ue.c[ue.b]),ue.e[ee]=le,ue.c[ee]=Ae,ue.d[Ae]=ee,ue.h&&At(ue,Ae),ee}return ue=Y.a++,Y.c[ue]=le,-(ue+1)}function Pt(Y){if(Y.a===0)return ht(Y.b);var le=Y.c[Y.d[Y.a-1]];if(Y.b.a!==0&&l(Jt(Y.b),le))return ht(Y.b);for(;--Y.a,0<Y.a&&Y.c[Y.d[Y.a-1]]===null;);return le}function Dt(){this.d=St([0],33),this.e=[null,null],this.c=[0,0],this.a=0,this.f=32,this.b=0,this.h=!1,this.d[1]=1}function St(Y,le){for(var ee=Array(le),ue=0;ue<Y.length;ue++)ee[ue]=Y[ue];for(;ue<le;ue++)ee[ue]=0;return ee}function Jt(Y){return Y.e[Y.d[1]]}function ht(Y){var le=Y.d,ee=Y.e,ue=Y.c,Ae=le[1],Ke=ee[Ae];return 0<Y.a&&(le[1]=le[Y.a],ue[le[1]]=1,ee[Ae]=null,ue[Ae]=Y.b,Y.b=Ae,0<--Y.a&&ct(Y,1)),Ke}function ct(Y,le){for(var ee=Y.d,ue=Y.e,Ae=Y.c,Ke=le,ot=ee[Ke];;){var vt=Ke<<1;vt<Y.a&&l(ue[ee[vt+1]],ue[ee[vt]])&&(vt+=1);var Pe=ee[vt];if(vt>Y.a||l(ue[ot],ue[Pe])){Ae[ee[Ke]=ot]=Ke;break}Ae[ee[Ke]=Pe]=Ke,Ke=vt}}function At(Y,le){for(var ee=Y.d,ue=Y.e,Ae=Y.c,Ke=le,ot=ee[Ke];;){var vt=Ke>>1,Pe=ee[vt];if(vt==0||l(ue[Pe],ue[ot])){Ae[ee[Ke]=ot]=Ke;break}Ae[ee[Ke]=Pe]=Ke,Ke=vt}}function Ft(){this.e=this.a=null,this.f=0,this.c=this.b=this.h=this.d=!1}function Be(Y){return Y.e.c.b}function qt(Y){return Y.e.a.b}(a=he.prototype).x=function(){Fe(this,0)},a.B=function(Y,le){switch(Y){case 100142:return;case 100140:switch(le){case 100130:case 100131:case 100132:case 100133:case 100134:return void(this.s=le)}break;case 100141:return void(this.m=!!le);default:return void me(this,100900)}me(this,100901)},a.y=function(Y){switch(Y){case 100142:return 0;case 100140:return this.s;case 100141:return this.m;default:me(this,100900)}return!1},a.A=function(Y,le,ee){this.j[0]=Y,this.j[1]=le,this.j[2]=ee},a.z=function(Y,le){var ee=le||null;switch(Y){case 100100:case 100106:this.h=ee;break;case 100104:case 100110:this.l=ee;break;case 100101:case 100107:this.k=ee;break;case 100102:case 100108:this.i=ee;break;case 100103:case 100109:this.p=ee;break;case 100105:case 100111:this.o=ee;break;case 100112:this.r=ee;break;default:me(this,100900)}},a.C=function(Y,le){var ee=!1,ue=[0,0,0];Fe(this,2);for(var Ae=0;Ae<3;++Ae){var Ke=Y[Ae];Ke<-1e150&&(Ke=-1e150,ee=!0),1e150<Ke&&(Ke=1e150,ee=!0),ue[Ae]=Ke}ee&&me(this,100155),(ee=this.q)===null?g(ee=m(this.b),ee.b):(v(ee),ee=ee.e),ee.a.d=le,ee.a.g[0]=ue[0],ee.a.g[1]=ue[1],ee.a.g[2]=ue[2],ee.f=1,ee.b.f=-1,this.q=ee},a.u=function(Y){Fe(this,0),this.d=1,this.b=new rt,this.c=Y},a.t=function(){Fe(this,1),this.d=2,this.q=null},a.v=function(){Fe(this,2),this.d=1},a.w=function(){Fe(this,1),this.d=0;var Y,le,ee=!1,ue=[Pe=this.j[0],Ae=this.j[1],ot=this.j[2]];if(Pe===0&&Ae===0&&ot===0){for(var Ae=[-2e150,-2e150,-2e150],Ke=[2e150,2e150,2e150],ot=[],vt=[],Pe=(ee=this.b.c).e;Pe!==ee;Pe=Pe.e)for(var Mt=0;Mt<3;++Mt){var en=Pe.g[Mt];en<Ke[Mt]&&(Ke[Mt]=en,vt[Mt]=Pe),en>Ae[Mt]&&(Ae[Mt]=en,ot[Mt]=Pe)}if(Pe=0,Ae[1]-Ke[1]>Ae[0]-Ke[0]&&(Pe=1),Ae[2]-Ke[2]>Ae[Pe]-Ke[Pe]&&(Pe=2),Ke[Pe]>=Ae[Pe])ue[0]=0,ue[1]=0,ue[2]=1;else{for(Ae=0,Ke=vt[Pe],ot=ot[Pe],vt=[0,0,0],Ke=[Ke.g[0]-ot.g[0],Ke.g[1]-ot.g[1],Ke.g[2]-ot.g[2]],Mt=[0,0,0],Pe=ee.e;Pe!==ee;Pe=Pe.e)Mt[0]=Pe.g[0]-ot.g[0],Mt[1]=Pe.g[1]-ot.g[1],Mt[2]=Pe.g[2]-ot.g[2],vt[0]=Ke[1]*Mt[2]-Ke[2]*Mt[1],vt[1]=Ke[2]*Mt[0]-Ke[0]*Mt[2],vt[2]=Ke[0]*Mt[1]-Ke[1]*Mt[0],Ae<(en=vt[0]*vt[0]+vt[1]*vt[1]+vt[2]*vt[2])&&(Ae=en,ue[0]=vt[0],ue[1]=vt[1],ue[2]=vt[2]);Ae<=0&&(ue[0]=ue[1]=ue[2]=0,ue[M(Ke)]=1)}ee=!0}for(vt=M(ue),Pe=this.b.c,Ae=(vt+1)%3,ot=(vt+2)%3,vt=0<ue[vt]?1:-1,ue=Pe.e;ue!==Pe;ue=ue.e)ue.b=ue.g[Ae],ue.a=vt*ue.g[ot];if(ee){for(ue=0,Pe=(ee=this.b.a).b;Pe!==ee;Pe=Pe.b)if(!((Ae=Pe.a).f<=0))for(;ue+=(Ae.a.b-Ae.b.a.b)*(Ae.a.a+Ae.b.a.a),(Ae=Ae.e)!==Pe.a;);if(ue<0)for(ee=(ue=this.b.c).e;ee!==ue;ee=ee.e)ee.a=-ee.a}for(this.n=!1,Pe=(ue=this.b.b).h;Pe!==ue;Pe=ee)ee=Pe.h,Ae=Pe.e,i(Pe.a,Pe.b.a)&&Pe.e.e!==Pe&&(we(this,Ae,Pe),y(Pe),Ae=(Pe=Ae).e),Ae.e===Pe&&(Ae!==Pe&&(Ae!==ee&&Ae!==ee.b||(ee=ee.h),y(Ae)),Pe!==ee&&Pe!==ee.b||(ee=ee.h),y(Pe));for(this.e=ue=new Je,Pe=(ee=this.b.c).e;Pe!==ee;Pe=Pe.e)Pe.h=xt(ue,Pe);for(function(dn){dn.d=[];for(var mn=0;mn<dn.a;mn++)dn.d[mn]=mn;dn.d.sort(function(hn){return function(gn,jn){return l(hn[gn],hn[jn])?1:-1}}(dn.c)),dn.e=!0,function(hn){for(var gn=hn.a;1<=gn;--gn)ct(hn,gn);hn.h=!0}(dn.b)}(ue),this.f=new J(this),W(this,-4e150),W(this,4e150);(ue=Pt(this.e))!==null;){for(;;){e:if(Pe=this.e,Pe.a===0)ee=Jt(Pe.b);else if(ee=Pe.c[Pe.d[Pe.a-1]],Pe.b.a!==0&&(Pe=Jt(Pe.b),l(Pe,ee))){ee=Pe;break e}if(ee===null||!i(ee,ue))break;ee=Pt(this.e),we(this,ue.c,ee.c)}j(this,ue)}for(this.a=this.f.a.a.b.a.a,ue=0;(ee=this.f.a.a.b)!==null;)ee.h||++ue,B(ee);for(this.f=null,(ue=this.e).b=null,ue.d=null,this.e=ue.c=null,Pe=(ue=this.b).a.b;Pe!==ue.a;Pe=ee)ee=Pe.b,(Pe=Pe.a).e.e===Pe&&(P(Pe.c,Pe),y(Pe));if(!this.n){if(ue=this.b,this.m)for(Pe=ue.b.h;Pe!==ue.b;Pe=ee)ee=Pe.h,Pe.b.d.c!==Pe.d.c?Pe.f=Pe.d.c?1:-1:y(Pe);else for(Pe=ue.a.b;Pe!==ue.a;Pe=ee)if(ee=Pe.b,Pe.c){for(Pe=Pe.a;l(Pe.b.a,Pe.a);Pe=Pe.c.b);for(;l(Pe.a,Pe.b.a);Pe=Pe.e);for(Ae=Pe.c.b,ot=void 0;Pe.e!==Ae;)if(l(Pe.b.a,Ae.a)){for(;Ae.e!==Pe&&(l((le=Ae.e).b.a,le.a)||h(Ae.a,Ae.b.a,Ae.e.b.a)<=0);)Ae=(ot=b(Ae.e,Ae)).b;Ae=Ae.c.b}else{for(;Ae.e!==Pe&&(l((Y=Pe.c.b).a,Y.b.a)||0<=h(Pe.b.a,Pe.a,Pe.c.b.a));)Pe=(ot=b(Pe,Pe.c.b)).b;Pe=Pe.e}for(;Ae.e.e!==Pe;)Ae=(ot=b(Ae.e,Ae)).b}if(this.h||this.i||this.k||this.l)if(this.m){for(ee=(ue=this.b).a.b;ee!==ue.a;ee=ee.b)if(ee.c){for(this.h&&this.h(2,this.c),Pe=ee.a;this.k&&this.k(Pe.a.d,this.c),(Pe=Pe.e)!==ee.a;);this.i&&this.i(this.c)}}else{for(ue=this.b,ee=!!this.l,Pe=!1,Ae=-1,ot=ue.a.d;ot!==ue.a;ot=ot.d)if(ot.c)for(Pe||(this.h&&this.h(4,this.c),Pe=!0),vt=ot.a;ee&&Ae!==(Ke=vt.b.d.c?0:1)&&(Ae=Ke,this.l&&this.l(!!Ae,this.c)),this.k&&this.k(vt.a.d,this.c),(vt=vt.e)!==ot.a;);Pe&&this.i&&this.i(this.c)}if(this.r){for(Pe=(ue=this.b).a.b;Pe!==ue.a;Pe=ee)if(ee=Pe.b,!Pe.c){for(ot=(Ae=Pe.a).e,vt=void 0;ot=(vt=ot).e,(vt.d=null)===vt.b.d&&(vt.c===vt?O(vt.a,null):(vt.a.c=vt.c,_(vt,Ne(vt))),(Ke=vt.b).c===Ke?O(Ke.a,null):(Ke.a.c=Ke.c,_(Ke,Ne(Ke))),N(vt)),vt!==Ae;);Ae=Pe.d,((Pe=Pe.b).d=Ae).b=Pe}return this.r(this.b),void(this.c=this.b=null)}}this.b=this.c=null},this.libtess={GluTesselator:he,windingRule:{GLU_TESS_WINDING_ODD:100130,GLU_TESS_WINDING_NONZERO:100131,GLU_TESS_WINDING_POSITIVE:100132,GLU_TESS_WINDING_NEGATIVE:100133,GLU_TESS_WINDING_ABS_GEQ_TWO:100134},primitiveType:{GL_LINE_LOOP:2,GL_TRIANGLES:4,GL_TRIANGLE_STRIP:5,GL_TRIANGLE_FAN:6},errorType:{GLU_TESS_MISSING_BEGIN_POLYGON:100151,GLU_TESS_MISSING_END_POLYGON:100153,GLU_TESS_MISSING_BEGIN_CONTOUR:100152,GLU_TESS_MISSING_END_CONTOUR:100154,GLU_TESS_COORD_TOO_LARGE:100155,GLU_TESS_NEED_COMBINE_CALLBACK:100156},gluEnum:{GLU_TESS_MESH:100112,GLU_TESS_TOLERANCE:100142,GLU_TESS_WINDING_RULE:100140,GLU_TESS_BOUNDARY_ONLY:100141,GLU_INVALID_ENUM:100900,GLU_INVALID_VALUE:100901,GLU_TESS_BEGIN:100100,GLU_TESS_VERTEX:100101,GLU_TESS_END:100102,GLU_TESS_ERROR:100103,GLU_TESS_EDGE_FLAG:100104,GLU_TESS_COMBINE:100105,GLU_TESS_BEGIN_DATA:100106,GLU_TESS_VERTEX_DATA:100107,GLU_TESS_END_DATA:100108,GLU_TESS_ERROR_DATA:100109,GLU_TESS_EDGE_FLAG_DATA:100110,GLU_TESS_COMBINE_DATA:100111}},he.prototype.gluDeleteTess=he.prototype.x,he.prototype.gluTessProperty=he.prototype.B,he.prototype.gluGetTessProperty=he.prototype.y,he.prototype.gluTessNormal=he.prototype.A,he.prototype.gluTessCallback=he.prototype.z,he.prototype.gluTessVertex=he.prototype.C,he.prototype.gluTessBeginPolygon=he.prototype.u,he.prototype.gluTessBeginContour=he.prototype.t,he.prototype.gluTessEndContour=he.prototype.v,he.prototype.gluTessEndPolygon=he.prototype.w,s!==void 0&&(s.exports=this.libtess)},{}],238:[function(n,s,o){function a(i,l,u,h){for(var d=i[l++],c=1<<d,f=1+c,p=1+f,m=d+1,g=(1<<m)-1,y=0,v=0,b=0,w=i[l++],_=new Int32Array(4096),I=null;;){for(;y<16&&w!==0;)v|=i[l++]<<y,y+=8,w===1?w=i[l++]:--w;if(y<m)break;var C=v&g;if(v>>=m,y-=m,C!=c){if(C==f)break;for(var N=C<p?C:I,O=0,D=N;c<D;)D=_[D]>>8,++O;var M=D;if(h<b+O+(N!==C?1:0))return void console.log("Warning, gif stream longer than expected.");u[b++]=M;var P=b+=O;for(N!==C&&(u[b++]=M),D=N;O--;)D=_[D],u[--P]=255&D,D>>=8;I!==null&&p<4096&&(_[p++]=I<<8|M,g+1<=p&&m<12&&(++m,g=g<<1|1)),I=C}else p=1+f,g=(1<<(m=d+1))-1,I=null}return b!==h&&console.log("Warning, gif stream shorter than expected."),u}try{o.GifWriter=function(i,l,u,h){var d=0,c=(h=h===void 0?{}:h).loop===void 0?null:h.loop,f=h.palette===void 0?null:h.palette;if(l<=0||u<=0||65535<l||65535<u)throw new Error("Width/Height invalid.");function p(I){var C=I.length;if(C<2||256<C||C&C-1)throw new Error("Invalid code/color length, must be power of 2 and 2 .. 256.");return C}i[d++]=71,i[d++]=73,i[d++]=70,i[d++]=56,i[d++]=57,i[d++]=97;var m=0,g=0;if(f!==null){for(var y=p(f);y>>=1;)++m;if(y=1<<m,--m,h.background!==void 0){if(y<=(g=h.background))throw new Error("Background index out of range.");if(g===0)throw new Error("Background index explicitly passed as 0.")}}if(i[d++]=255&l,i[d++]=l>>8&255,i[d++]=255&u,i[d++]=u>>8&255,i[d++]=(f!==null?128:0)|m,i[d++]=g,i[d++]=0,f!==null)for(var v=0,b=f.length;v<b;++v){var w=f[v];i[d++]=w>>16&255,i[d++]=w>>8&255,i[d++]=255&w}if(c!==null){if(c<0||65535<c)throw new Error("Loop count invalid.");i[d++]=33,i[d++]=255,i[d++]=11,i[d++]=78,i[d++]=69,i[d++]=84,i[d++]=83,i[d++]=67,i[d++]=65,i[d++]=80,i[d++]=69,i[d++]=50,i[d++]=46,i[d++]=48,i[d++]=3,i[d++]=1,i[d++]=255&c,i[d++]=c>>8&255,i[d++]=0}var _=!1;this.addFrame=function(I,C,N,O,D,M){if(_===!0&&(--d,_=!1),M=M===void 0?{}:M,I<0||C<0||65535<I||65535<C)throw new Error("x/y invalid.");if(N<=0||O<=0||65535<N||65535<O)throw new Error("Width/Height invalid.");if(D.length<N*O)throw new Error("Not enough pixels for the frame size.");var P=!0,F=M.palette;if(F==null&&(P=!1,F=f),F==null)throw new Error("Must supply either a local or global palette.");for(var B=p(F),z=0;B>>=1;)++z;B=1<<z;var Z=M.delay===void 0?0:M.delay,Q=M.disposal===void 0?0:M.disposal;if(Q<0||3<Q)throw new Error("Disposal out of range.");var K=!1,ne=0;if(M.transparent!==void 0&&M.transparent!==null&&(K=!0,(ne=M.transparent)<0||B<=ne))throw new Error("Transparent color index.");if(Q===0&&!K&&Z===0||(i[d++]=33,i[d++]=249,i[d++]=4,i[d++]=Q<<2|(K===!0?1:0),i[d++]=255&Z,i[d++]=Z>>8&255,i[d++]=ne,i[d++]=0),i[d++]=44,i[d++]=255&I,i[d++]=I>>8&255,i[d++]=255&C,i[d++]=C>>8&255,i[d++]=255&N,i[d++]=N>>8&255,i[d++]=255&O,i[d++]=O>>8&255,i[d++]=P===!0?128|z-1:0,P===!0)for(var re=0,ce=F.length;re<ce;++re){var be=F[re];i[d++]=be>>16&255,i[d++]=be>>8&255,i[d++]=255&be}return d=function(we,ye,Oe,Se){we[ye++]=Oe;var Ee=ye++,j=1<<Oe,W=j-1,J=1+j,ie=1+J,ve=Oe+1,he=0,Fe=0;function me(Dt){for(;Dt<=he;)we[ye++]=255&Fe,Fe>>=8,he-=8,ye===Ee+256&&(we[Ee]=255,Ee=ye++)}function Le(Dt){Fe|=Dt<<he,he+=ve,me(8)}var De=Se[0]&W,Ne={};Le(j);for(var rt=1,tt=Se.length;rt<tt;++rt){var Je=Se[rt]&W,xt=De<<8|Je,Pt=Ne[xt];if(Pt===void 0){for(Fe|=De<<he,he+=ve;8<=he;)we[ye++]=255&Fe,Fe>>=8,he-=8,ye===Ee+256&&(we[Ee]=255,Ee=ye++);ie===4096?(Le(j),ie=1+J,ve=Oe+1,Ne={}):(1<<ve<=ie&&++ve,Ne[xt]=ie++),De=Je}else De=Pt}return Le(De),Le(J),me(1),Ee+1===ye?we[Ee]=0:(we[Ee]=ye-Ee-1,we[ye++]=0),ye}(i,d,z<2?2:z,D)},this.end=function(){return _===!1&&(i[d++]=59,_=!0),d},this.getOutputBuffer=function(){return i},this.setOutputBuffer=function(I){i=I},this.getOutputBufferPosition=function(){return d},this.setOutputBufferPosition=function(I){d=I}},o.GifReader=function(i){var l=0;if(i[l++]!==71||i[l++]!==73||i[l++]!==70||i[l++]!==56||(i[l++]+1&253)!=56||i[l++]!==97)throw new Error("Invalid GIF 87a/89a header.");var u=i[l++]|i[l++]<<8,h=i[l++]|i[l++]<<8,d=i[l++],c=d>>7,f=1<<1+(7&d);i[l++],i[l++];var p=null,m=null;c&&(p=l,l+=3*(m=f));var g=!0,y=[],v=0,b=null,w=0,_=null;for(this.width=u,this.height=h;g&&l<i.length;)switch(i[l++]){case 33:switch(i[l++]){case 255:if(i[l]!==11||i[l+1]==78&&i[l+2]==69&&i[l+3]==84&&i[l+4]==83&&i[l+5]==67&&i[l+6]==65&&i[l+7]==80&&i[l+8]==69&&i[l+9]==50&&i[l+10]==46&&i[l+11]==48&&i[l+12]==3&&i[l+13]==1&&i[l+16]==0)l+=14,_=i[l++]|i[l++]<<8,l++;else for(l+=12;;){if(!(0<=(K=i[l++])))throw Error("Invalid block size");if(K===0)break;l+=K}break;case 249:if(i[l++]!==4||i[l+4]!==0)throw new Error("Invalid graphics extension block.");var I=i[l++];v=i[l++]|i[l++]<<8,b=i[l++],(1&I)==0&&(b=null),w=I>>2&7,l++;break;case 254:for(;;){if(!(0<=(K=i[l++])))throw Error("Invalid block size");if(K===0)break;l+=K}break;default:throw new Error("Unknown graphic control label: 0x"+i[l-1].toString(16))}break;case 44:var C=i[l++]|i[l++]<<8,N=i[l++]|i[l++]<<8,O=i[l++]|i[l++]<<8,D=i[l++]|i[l++]<<8,M=i[l++],P=M>>6&1,F=1<<1+(7&M),B=p,z=m,Z=!1;M>>7&&(Z=!0,B=l,l+=3*(z=F));var Q=l;for(l++;;){var K;if(!(0<=(K=i[l++])))throw Error("Invalid block size");if(K===0)break;l+=K}y.push({x:C,y:N,width:O,height:D,has_local_palette:Z,palette_offset:B,palette_size:z,data_offset:Q,data_length:l-Q,transparent_index:b,interlaced:!!P,delay:v,disposal:w});break;case 59:g=!1;break;default:throw new Error("Unknown gif block: 0x"+i[l-1].toString(16))}this.numFrames=function(){return y.length},this.loopCount=function(){return _},this.frameInfo=function(ne){if(ne<0||ne>=y.length)throw new Error("Frame index out of range.");return y[ne]},this.decodeAndBlitFrameBGRA=function(ne,re){var ce=this.frameInfo(ne),be=ce.width*ce.height,we=new Uint8Array(be);a(i,ce.data_offset,we,be);var ye=ce.palette_offset,Oe=ce.transparent_index;Oe===null&&(Oe=256);var Se=ce.width,Ee=u-Se,j=Se,W=4*(ce.y*u+ce.x),J=4*((ce.y+ce.height)*u+ce.x),ie=W,ve=4*Ee;ce.interlaced===!0&&(ve+=4*u*7);for(var he=8,Fe=0,me=we.length;Fe<me;++Fe){var Le=we[Fe];if(j===0&&(j=Se,J<=(ie+=ve)&&(ve=4*Ee+4*u*(he-1),ie=W+(Se+Ee)*(he<<1),he>>=1)),Le===Oe)ie+=4;else{var De=i[ye+3*Le],Ne=i[ye+3*Le+1],rt=i[ye+3*Le+2];re[ie++]=rt,re[ie++]=Ne,re[ie++]=De,re[ie++]=255}--j}},this.decodeAndBlitFrameRGBA=function(ne,re){var ce=this.frameInfo(ne),be=ce.width*ce.height,we=new Uint8Array(be);a(i,ce.data_offset,we,be);var ye=ce.palette_offset,Oe=ce.transparent_index;Oe===null&&(Oe=256);var Se=ce.width,Ee=u-Se,j=Se,W=4*(ce.y*u+ce.x),J=4*((ce.y+ce.height)*u+ce.x),ie=W,ve=4*Ee;ce.interlaced===!0&&(ve+=4*u*7);for(var he=8,Fe=0,me=we.length;Fe<me;++Fe){var Le=we[Fe];if(j===0&&(j=Se,J<=(ie+=ve)&&(ve=4*Ee+4*u*(he-1),ie=W+(Se+Ee)*(he<<1),he>>=1)),Le===Oe)ie+=4;else{var De=i[ye+3*Le],Ne=i[ye+3*Le+1],rt=i[ye+3*Le+2];re[ie++]=De,re[ie++]=Ne,re[ie++]=rt,re[ie++]=255}--j}}}}catch{}},{}],239:[function(n,s,o){(function(a){var i,l;i=this,l=function(u){function h(S){if(this==null)throw TypeError();var k=String(this),E=k.length,A=S?Number(S):0;if(A!=A&&(A=0),!(A<0||E<=A)){var L,V=k.charCodeAt(A);return 55296<=V&&V<=56319&&A+1<E&&56320<=(L=k.charCodeAt(A+1))&&L<=57343?1024*(V-55296)+L-56320+65536:V}}var d;String.prototype.codePointAt||((d=function(){try{var S={},k=Object.defineProperty,E=k(S,S,S)&&k}catch{}return E}())?d(String.prototype,"codePointAt",{value:h,configurable:!0,writable:!0}):String.prototype.codePointAt=h);var c=0,f=-3;function p(){this.table=new Uint16Array(16),this.trans=new Uint16Array(288)}function m(S,k){this.source=S,this.sourceIndex=0,this.tag=0,this.bitcount=0,this.dest=k,this.destLen=0,this.ltree=new p,this.dtree=new p}var g=new p,y=new p,v=new Uint8Array(30),b=new Uint16Array(30),w=new Uint8Array(30),_=new Uint16Array(30),I=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),C=new p,N=new Uint8Array(320);function O(S,k,E,A){var L,V;for(L=0;L<E;++L)S[L]=0;for(L=0;L<30-E;++L)S[L+E]=L/E|0;for(V=A,L=0;L<30;++L)k[L]=V,V+=1<<S[L]}var D=new Uint16Array(16);function M(S,k,E,A){var L,V;for(L=0;L<16;++L)S.table[L]=0;for(L=0;L<A;++L)S.table[k[E+L]]++;for(L=V=S.table[0]=0;L<16;++L)D[L]=V,V+=S.table[L];for(L=0;L<A;++L)k[E+L]&&(S.trans[D[k[E+L]]++]=L)}function P(S){S.bitcount--||(S.tag=S.source[S.sourceIndex++],S.bitcount=7);var k=1&S.tag;return S.tag>>>=1,k}function F(S,k,E){if(!k)return E;for(;S.bitcount<24;)S.tag|=S.source[S.sourceIndex++]<<S.bitcount,S.bitcount+=8;var A=S.tag&65535>>>16-k;return S.tag>>>=k,S.bitcount-=k,A+E}function B(S,k){for(;S.bitcount<24;)S.tag|=S.source[S.sourceIndex++]<<S.bitcount,S.bitcount+=8;for(var E=0,A=0,L=0,V=S.tag;A=2*A+(1&V),V>>>=1,++L,E+=k.table[L],0<=(A-=k.table[L]););return S.tag=V,S.bitcount-=L,k.trans[E+A]}function z(S,k,E){var A,L,V,q,se,ae;for(A=F(S,5,257),L=F(S,5,1),V=F(S,4,4),q=0;q<19;++q)N[q]=0;for(q=0;q<V;++q){var _e=F(S,3,0);N[I[q]]=_e}for(M(C,N,0,19),se=0;se<A+L;){var je=B(S,C);switch(je){case 16:var qe=N[se-1];for(ae=F(S,2,3);ae;--ae)N[se++]=qe;break;case 17:for(ae=F(S,3,3);ae;--ae)N[se++]=0;break;case 18:for(ae=F(S,7,11);ae;--ae)N[se++]=0;break;default:N[se++]=je}}M(k,N,0,A),M(E,N,A,L)}function Z(S,k,E){for(;;){var A,L,V,q,se=B(S,k);if(se===256)return c;if(se<256)S.dest[S.destLen++]=se;else for(A=F(S,v[se-=257],b[se]),L=B(S,E),q=V=S.destLen-F(S,w[L],_[L]);q<V+A;++q)S.dest[S.destLen++]=S.dest[q]}}function Q(S){for(var k,E;8<S.bitcount;)S.sourceIndex--,S.bitcount-=8;if((k=256*(k=S.source[S.sourceIndex+1])+S.source[S.sourceIndex])!==(65535&~(256*S.source[S.sourceIndex+3]+S.source[S.sourceIndex+2])))return f;for(S.sourceIndex+=4,E=k;E;--E)S.dest[S.destLen++]=S.source[S.sourceIndex++];return S.bitcount=0,c}(function(S,k){var E;for(E=0;E<7;++E)S.table[E]=0;for(S.table[7]=24,S.table[8]=152,S.table[9]=112,E=0;E<24;++E)S.trans[E]=256+E;for(E=0;E<144;++E)S.trans[24+E]=E;for(E=0;E<8;++E)S.trans[168+E]=280+E;for(E=0;E<112;++E)S.trans[176+E]=144+E;for(E=0;E<5;++E)k.table[E]=0;for(k.table[5]=32,E=0;E<32;++E)k.trans[E]=E})(g,y),O(v,b,4,3),O(w,_,2,1),v[28]=0,b[28]=258;var K=function(S,k){var E,A,L=new m(S,k);do{switch(E=P(L),F(L,2,0)){case 0:A=Q(L);break;case 1:A=Z(L,g,y);break;case 2:z(L,L.ltree,L.dtree),A=Z(L,L.ltree,L.dtree);break;default:A=f}if(A!==c)throw new Error("Data error")}while(!E);return L.destLen<L.dest.length?typeof L.dest.slice=="function"?L.dest.slice(0,L.destLen):L.dest.subarray(0,L.destLen):L.dest};function ne(S,k,E,A,L){return Math.pow(1-L,3)*S+3*Math.pow(1-L,2)*L*k+3*(1-L)*Math.pow(L,2)*E+Math.pow(L,3)*A}function re(){this.x1=Number.NaN,this.y1=Number.NaN,this.x2=Number.NaN,this.y2=Number.NaN}function ce(){this.commands=[],this.fill="black",this.stroke=null,this.strokeWidth=1}function be(S){throw new Error(S)}function we(S,k){S||be(k)}re.prototype.isEmpty=function(){return isNaN(this.x1)||isNaN(this.y1)||isNaN(this.x2)||isNaN(this.y2)},re.prototype.addPoint=function(S,k){typeof S=="number"&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=S,this.x2=S),S<this.x1&&(this.x1=S),S>this.x2&&(this.x2=S)),typeof k=="number"&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=k,this.y2=k),k<this.y1&&(this.y1=k),k>this.y2&&(this.y2=k))},re.prototype.addX=function(S){this.addPoint(S,null)},re.prototype.addY=function(S){this.addPoint(null,S)},re.prototype.addBezier=function(S,k,E,A,L,V,q,se){var ae=[S,k],_e=[E,A],je=[L,V],qe=[q,se];this.addPoint(S,k),this.addPoint(q,se);for(var ge=0;ge<=1;ge++){var $t=6*ae[ge]-12*_e[ge]+6*je[ge],wt=-3*ae[ge]+9*_e[ge]-9*je[ge]+3*qe[ge],mt=3*_e[ge]-3*ae[ge];if(wt!=0){var st=Math.pow($t,2)-4*mt*wt;if(!(st<0)){var dt=(-$t+Math.sqrt(st))/(2*wt);0<dt&&dt<1&&(ge===0&&this.addX(ne(ae[ge],_e[ge],je[ge],qe[ge],dt)),ge===1&&this.addY(ne(ae[ge],_e[ge],je[ge],qe[ge],dt)));var Zt=(-$t-Math.sqrt(st))/(2*wt);0<Zt&&Zt<1&&(ge===0&&this.addX(ne(ae[ge],_e[ge],je[ge],qe[ge],Zt)),ge===1&&this.addY(ne(ae[ge],_e[ge],je[ge],qe[ge],Zt)))}}else{if($t==0)continue;var zt=-mt/$t;0<zt&&zt<1&&(ge===0&&this.addX(ne(ae[ge],_e[ge],je[ge],qe[ge],zt)),ge===1&&this.addY(ne(ae[ge],_e[ge],je[ge],qe[ge],zt)))}}},re.prototype.addQuad=function(S,k,E,A,L,V){var q=S+.6666666666666666*(E-S),se=k+2/3*(A-k),ae=q+1/3*(L-S),_e=se+1/3*(V-k);this.addBezier(S,k,q,se,ae,_e,L,V)},ce.prototype.moveTo=function(S,k){this.commands.push({type:"M",x:S,y:k})},ce.prototype.lineTo=function(S,k){this.commands.push({type:"L",x:S,y:k})},ce.prototype.curveTo=ce.prototype.bezierCurveTo=function(S,k,E,A,L,V){this.commands.push({type:"C",x1:S,y1:k,x2:E,y2:A,x:L,y:V})},ce.prototype.quadTo=ce.prototype.quadraticCurveTo=function(S,k,E,A){this.commands.push({type:"Q",x1:S,y1:k,x:E,y:A})},ce.prototype.close=ce.prototype.closePath=function(){this.commands.push({type:"Z"})},ce.prototype.extend=function(S){if(S.commands)S=S.commands;else if(S instanceof re){var k=S;return this.moveTo(k.x1,k.y1),this.lineTo(k.x2,k.y1),this.lineTo(k.x2,k.y2),this.lineTo(k.x1,k.y2),void this.close()}Array.prototype.push.apply(this.commands,S)},ce.prototype.getBoundingBox=function(){for(var S=new re,k=0,E=0,A=0,L=0,V=0;V<this.commands.length;V++){var q=this.commands[V];switch(q.type){case"M":S.addPoint(q.x,q.y),k=A=q.x,E=L=q.y;break;case"L":S.addPoint(q.x,q.y),A=q.x,L=q.y;break;case"Q":S.addQuad(A,L,q.x1,q.y1,q.x,q.y),A=q.x,L=q.y;break;case"C":S.addBezier(A,L,q.x1,q.y1,q.x2,q.y2,q.x,q.y),A=q.x,L=q.y;break;case"Z":A=k,L=E;break;default:throw new Error("Unexpected path command "+q.type)}}return S.isEmpty()&&S.addPoint(0,0),S},ce.prototype.draw=function(S){S.beginPath();for(var k=0;k<this.commands.length;k+=1){var E=this.commands[k];E.type==="M"?S.moveTo(E.x,E.y):E.type==="L"?S.lineTo(E.x,E.y):E.type==="C"?S.bezierCurveTo(E.x1,E.y1,E.x2,E.y2,E.x,E.y):E.type==="Q"?S.quadraticCurveTo(E.x1,E.y1,E.x,E.y):E.type==="Z"&&S.closePath()}this.fill&&(S.fillStyle=this.fill,S.fill()),this.stroke&&(S.strokeStyle=this.stroke,S.lineWidth=this.strokeWidth,S.stroke())},ce.prototype.toPathData=function(S){function k(){for(var V,q=arguments,se="",ae=0;ae<arguments.length;ae+=1){var _e=q[ae];0<=_e&&0<ae&&(se+=" "),se+=(V=_e,Math.round(V)===V?""+Math.round(V):V.toFixed(S))}return se}S=S!==void 0?S:2;for(var E="",A=0;A<this.commands.length;A+=1){var L=this.commands[A];L.type==="M"?E+="M"+k(L.x,L.y):L.type==="L"?E+="L"+k(L.x,L.y):L.type==="C"?E+="C"+k(L.x1,L.y1,L.x2,L.y2,L.x,L.y):L.type==="Q"?E+="Q"+k(L.x1,L.y1,L.x,L.y):L.type==="Z"&&(E+="Z")}return E},ce.prototype.toSVG=function(S){var k='<path d="';return k+=this.toPathData(S),k+='"',this.fill&&this.fill!=="black"&&(this.fill===null?k+=' fill="none"':k+=' fill="'+this.fill+'"'),this.stroke&&(k+=' stroke="'+this.stroke+'" stroke-width="'+this.strokeWidth+'"'),k+="/>"},ce.prototype.toDOMElement=function(S){var k=this.toPathData(S),E=document.createElementNS("http://www.w3.org/2000/svg","path");return E.setAttribute("d",k),E};var ye={fail:be,argument:we,assert:we},Oe={},Se={},Ee={};function j(S){return function(){return S}}Se.BYTE=function(S){return ye.argument(0<=S&&S<=255,"Byte value should be between 0 and 255."),[S]},Ee.BYTE=j(1),Se.CHAR=function(S){return[S.charCodeAt(0)]},Ee.CHAR=j(1),Se.CHARARRAY=function(S){for(var k=[],E=0;E<S.length;E+=1)k[E]=S.charCodeAt(E);return k},Ee.CHARARRAY=function(S){return S.length},Se.USHORT=function(S){return[S>>8&255,255&S]},Ee.USHORT=j(2),Se.SHORT=function(S){return 32768<=S&&(S=-(65536-S)),[S>>8&255,255&S]},Ee.SHORT=j(2),Se.UINT24=function(S){return[S>>16&255,S>>8&255,255&S]},Ee.UINT24=j(3),Se.ULONG=function(S){return[S>>24&255,S>>16&255,S>>8&255,255&S]},Ee.ULONG=j(4),Se.LONG=function(S){return 2147483648<=S&&(S=-(4294967296-S)),[S>>24&255,S>>16&255,S>>8&255,255&S]},Ee.LONG=j(4),Se.FIXED=Se.ULONG,Ee.FIXED=Ee.ULONG,Se.FWORD=Se.SHORT,Ee.FWORD=Ee.SHORT,Se.UFWORD=Se.USHORT,Ee.UFWORD=Ee.USHORT,Se.LONGDATETIME=function(S){return[0,0,0,0,S>>24&255,S>>16&255,S>>8&255,255&S]},Ee.LONGDATETIME=j(8),Se.TAG=function(S){return ye.argument(S.length===4,"Tag should be exactly 4 ASCII characters."),[S.charCodeAt(0),S.charCodeAt(1),S.charCodeAt(2),S.charCodeAt(3)]},Ee.TAG=j(4),Se.Card8=Se.BYTE,Ee.Card8=Ee.BYTE,Se.Card16=Se.USHORT,Ee.Card16=Ee.USHORT,Se.OffSize=Se.BYTE,Ee.OffSize=Ee.BYTE,Se.SID=Se.USHORT,Ee.SID=Ee.USHORT,Se.NUMBER=function(S){return-107<=S&&S<=107?[S+139]:108<=S&&S<=1131?[247+((S-=108)>>8),255&S]:-1131<=S&&S<=-108?[251+((S=-S-108)>>8),255&S]:-32768<=S&&S<=32767?Se.NUMBER16(S):Se.NUMBER32(S)},Ee.NUMBER=function(S){return Se.NUMBER(S).length},Se.NUMBER16=function(S){return[28,S>>8&255,255&S]},Ee.NUMBER16=j(3),Se.NUMBER32=function(S){return[29,S>>24&255,S>>16&255,S>>8&255,255&S]},Ee.NUMBER32=j(5),Se.REAL=function(S){var k=S.toString(),E=/\.(\d*?)(?:9{5,20}|0{5,20})\d{0,2}(?:e(.+)|$)/.exec(k);if(E){var A=parseFloat("1e"+((E[2]?+E[2]:0)+E[1].length));k=(Math.round(S*A)/A).toString()}for(var L="",V=0,q=k.length;V<q;V+=1){var se=k[V];L+=se==="e"?k[++V]==="-"?"c":"b":se==="."?"a":se==="-"?"e":se}for(var ae=[30],_e=0,je=(L+=1&L.length?"f":"ff").length;_e<je;_e+=2)ae.push(parseInt(L.substr(_e,2),16));return ae},Ee.REAL=function(S){return Se.REAL(S).length},Se.NAME=Se.CHARARRAY,Ee.NAME=Ee.CHARARRAY,Se.STRING=Se.CHARARRAY,Ee.STRING=Ee.CHARARRAY,Oe.UTF8=function(S,k,E){for(var A=[],L=E,V=0;V<L;V++,k+=1)A[V]=S.getUint8(k);return String.fromCharCode.apply(null,A)},Oe.UTF16=function(S,k,E){for(var A=[],L=E/2,V=0;V<L;V++,k+=2)A[V]=S.getUint16(k);return String.fromCharCode.apply(null,A)},Se.UTF16=function(S){for(var k=[],E=0;E<S.length;E+=1){var A=S.charCodeAt(E);k[k.length]=A>>8&255,k[k.length]=255&A}return k},Ee.UTF16=function(S){return 2*S.length};var W={"x-mac-croatian":"\xC4\xC5\xC7\xC9\xD1\xD6\xDC\xE1\xE0\xE2\xE4\xE3\xE5\xE7\xE9\xE8\xEA\xEB\xED\xEC\xEE\xEF\xF1\xF3\xF2\xF4\xF6\xF5\xFA\xF9\xFB\xFC\u2020\xB0\xA2\xA3\xA7\u2022\xB6\xDF\xAE\u0160\u2122\xB4\xA8\u2260\u017D\xD8\u221E\xB1\u2264\u2265\u2206\xB5\u2202\u2211\u220F\u0161\u222B\xAA\xBA\u03A9\u017E\xF8\xBF\xA1\xAC\u221A\u0192\u2248\u0106\xAB\u010C\u2026\xA0\xC0\xC3\xD5\u0152\u0153\u0110\u2014\u201C\u201D\u2018\u2019\xF7\u25CA\uF8FF\xA9\u2044\u20AC\u2039\u203A\xC6\xBB\u2013\xB7\u201A\u201E\u2030\xC2\u0107\xC1\u010D\xC8\xCD\xCE\xCF\xCC\xD3\xD4\u0111\xD2\xDA\xDB\xD9\u0131\u02C6\u02DC\xAF\u03C0\xCB\u02DA\xB8\xCA\xE6\u02C7","x-mac-cyrillic":"\u0410\u0411\u0412\u0413\u0414\u0415\u0416\u0417\u0418\u0419\u041A\u041B\u041C\u041D\u041E\u041F\u0420\u0421\u0422\u0423\u0424\u0425\u0426\u0427\u0428\u0429\u042A\u042B\u042C\u042D\u042E\u042F\u2020\xB0\u0490\xA3\xA7\u2022\xB6\u0406\xAE\xA9\u2122\u0402\u0452\u2260\u0403\u0453\u221E\xB1\u2264\u2265\u0456\xB5\u0491\u0408\u0404\u0454\u0407\u0457\u0409\u0459\u040A\u045A\u0458\u0405\xAC\u221A\u0192\u2248\u2206\xAB\xBB\u2026\xA0\u040B\u045B\u040C\u045C\u0455\u2013\u2014\u201C\u201D\u2018\u2019\xF7\u201E\u040E\u045E\u040F\u045F\u2116\u0401\u0451\u044F\u0430\u0431\u0432\u0433\u0434\u0435\u0436\u0437\u0438\u0439\u043A\u043B\u043C\u043D\u043E\u043F\u0440\u0441\u0442\u0443\u0444\u0445\u0446\u0447\u0448\u0449\u044A\u044B\u044C\u044D\u044E","x-mac-gaelic":"\xC4\xC5\xC7\xC9\xD1\xD6\xDC\xE1\xE0\xE2\xE4\xE3\xE5\xE7\xE9\xE8\xEA\xEB\xED\xEC\xEE\xEF\xF1\xF3\xF2\xF4\xF6\xF5\xFA\xF9\xFB\xFC\u2020\xB0\xA2\xA3\xA7\u2022\xB6\xDF\xAE\xA9\u2122\xB4\xA8\u2260\xC6\xD8\u1E02\xB1\u2264\u2265\u1E03\u010A\u010B\u1E0A\u1E0B\u1E1E\u1E1F\u0120\u0121\u1E40\xE6\xF8\u1E41\u1E56\u1E57\u027C\u0192\u017F\u1E60\xAB\xBB\u2026\xA0\xC0\xC3\xD5\u0152\u0153\u2013\u2014\u201C\u201D\u2018\u2019\u1E61\u1E9B\xFF\u0178\u1E6A\u20AC\u2039\u203A\u0176\u0177\u1E6B\xB7\u1EF2\u1EF3\u204A\xC2\xCA\xC1\xCB\xC8\xCD\xCE\xCF\xCC\xD3\xD4\u2663\xD2\xDA\xDB\xD9\u0131\xDD\xFD\u0174\u0175\u1E84\u1E85\u1E80\u1E81\u1E82\u1E83","x-mac-greek":"\xC4\xB9\xB2\xC9\xB3\xD6\xDC\u0385\xE0\xE2\xE4\u0384\xA8\xE7\xE9\xE8\xEA\xEB\xA3\u2122\xEE\xEF\u2022\xBD\u2030\xF4\xF6\xA6\u20AC\xF9\xFB\xFC\u2020\u0393\u0394\u0398\u039B\u039E\u03A0\xDF\xAE\xA9\u03A3\u03AA\xA7\u2260\xB0\xB7\u0391\xB1\u2264\u2265\xA5\u0392\u0395\u0396\u0397\u0399\u039A\u039C\u03A6\u03AB\u03A8\u03A9\u03AC\u039D\xAC\u039F\u03A1\u2248\u03A4\xAB\xBB\u2026\xA0\u03A5\u03A7\u0386\u0388\u0153\u2013\u2015\u201C\u201D\u2018\u2019\xF7\u0389\u038A\u038C\u038E\u03AD\u03AE\u03AF\u03CC\u038F\u03CD\u03B1\u03B2\u03C8\u03B4\u03B5\u03C6\u03B3\u03B7\u03B9\u03BE\u03BA\u03BB\u03BC\u03BD\u03BF\u03C0\u03CE\u03C1\u03C3\u03C4\u03B8\u03C9\u03C2\u03C7\u03C5\u03B6\u03CA\u03CB\u0390\u03B0\xAD","x-mac-icelandic":"\xC4\xC5\xC7\xC9\xD1\xD6\xDC\xE1\xE0\xE2\xE4\xE3\xE5\xE7\xE9\xE8\xEA\xEB\xED\xEC\xEE\xEF\xF1\xF3\xF2\xF4\xF6\xF5\xFA\xF9\xFB\xFC\xDD\xB0\xA2\xA3\xA7\u2022\xB6\xDF\xAE\xA9\u2122\xB4\xA8\u2260\xC6\xD8\u221E\xB1\u2264\u2265\xA5\xB5\u2202\u2211\u220F\u03C0\u222B\xAA\xBA\u03A9\xE6\xF8\xBF\xA1\xAC\u221A\u0192\u2248\u2206\xAB\xBB\u2026\xA0\xC0\xC3\xD5\u0152\u0153\u2013\u2014\u201C\u201D\u2018\u2019\xF7\u25CA\xFF\u0178\u2044\u20AC\xD0\xF0\xDE\xFE\xFD\xB7\u201A\u201E\u2030\xC2\xCA\xC1\xCB\xC8\xCD\xCE\xCF\xCC\xD3\xD4\uF8FF\xD2\xDA\xDB\xD9\u0131\u02C6\u02DC\xAF\u02D8\u02D9\u02DA\xB8\u02DD\u02DB\u02C7","x-mac-inuit":"\u1403\u1404\u1405\u1406\u140A\u140B\u1431\u1432\u1433\u1434\u1438\u1439\u1449\u144E\u144F\u1450\u1451\u1455\u1456\u1466\u146D\u146E\u146F\u1470\u1472\u1473\u1483\u148B\u148C\u148D\u148E\u1490\u1491\xB0\u14A1\u14A5\u14A6\u2022\xB6\u14A7\xAE\xA9\u2122\u14A8\u14AA\u14AB\u14BB\u14C2\u14C3\u14C4\u14C5\u14C7\u14C8\u14D0\u14EF\u14F0\u14F1\u14F2\u14F4\u14F5\u1505\u14D5\u14D6\u14D7\u14D8\u14DA\u14DB\u14EA\u1528\u1529\u152A\u152B\u152D\u2026\xA0\u152E\u153E\u1555\u1556\u1557\u2013\u2014\u201C\u201D\u2018\u2019\u1558\u1559\u155A\u155D\u1546\u1547\u1548\u1549\u154B\u154C\u1550\u157F\u1580\u1581\u1582\u1583\u1584\u1585\u158F\u1590\u1591\u1592\u1593\u1594\u1595\u1671\u1672\u1673\u1674\u1675\u1676\u1596\u15A0\u15A1\u15A2\u15A3\u15A4\u15A5\u15A6\u157C\u0141\u0142","x-mac-ce":"\xC4\u0100\u0101\xC9\u0104\xD6\xDC\xE1\u0105\u010C\xE4\u010D\u0106\u0107\xE9\u0179\u017A\u010E\xED\u010F\u0112\u0113\u0116\xF3\u0117\xF4\xF6\xF5\xFA\u011A\u011B\xFC\u2020\xB0\u0118\xA3\xA7\u2022\xB6\xDF\xAE\xA9\u2122\u0119\xA8\u2260\u0123\u012E\u012F\u012A\u2264\u2265\u012B\u0136\u2202\u2211\u0142\u013B\u013C\u013D\u013E\u0139\u013A\u0145\u0146\u0143\xAC\u221A\u0144\u0147\u2206\xAB\xBB\u2026\xA0\u0148\u0150\xD5\u0151\u014C\u2013\u2014\u201C\u201D\u2018\u2019\xF7\u25CA\u014D\u0154\u0155\u0158\u2039\u203A\u0159\u0156\u0157\u0160\u201A\u201E\u0161\u015A\u015B\xC1\u0164\u0165\xCD\u017D\u017E\u016A\xD3\xD4\u016B\u016E\xDA\u016F\u0170\u0171\u0172\u0173\xDD\xFD\u0137\u017B\u0141\u017C\u0122\u02C7",macintosh:"\xC4\xC5\xC7\xC9\xD1\xD6\xDC\xE1\xE0\xE2\xE4\xE3\xE5\xE7\xE9\xE8\xEA\xEB\xED\xEC\xEE\xEF\xF1\xF3\xF2\xF4\xF6\xF5\xFA\xF9\xFB\xFC\u2020\xB0\xA2\xA3\xA7\u2022\xB6\xDF\xAE\xA9\u2122\xB4\xA8\u2260\xC6\xD8\u221E\xB1\u2264\u2265\xA5\xB5\u2202\u2211\u220F\u03C0\u222B\xAA\xBA\u03A9\xE6\xF8\xBF\xA1\xAC\u221A\u0192\u2248\u2206\xAB\xBB\u2026\xA0\xC0\xC3\xD5\u0152\u0153\u2013\u2014\u201C\u201D\u2018\u2019\xF7\u25CA\xFF\u0178\u2044\u20AC\u2039\u203A\uFB01\uFB02\u2021\xB7\u201A\u201E\u2030\xC2\xCA\xC1\xCB\xC8\xCD\xCE\xCF\xCC\xD3\xD4\uF8FF\xD2\xDA\xDB\xD9\u0131\u02C6\u02DC\xAF\u02D8\u02D9\u02DA\xB8\u02DD\u02DB\u02C7","x-mac-romanian":"\xC4\xC5\xC7\xC9\xD1\xD6\xDC\xE1\xE0\xE2\xE4\xE3\xE5\xE7\xE9\xE8\xEA\xEB\xED\xEC\xEE\xEF\xF1\xF3\xF2\xF4\xF6\xF5\xFA\xF9\xFB\xFC\u2020\xB0\xA2\xA3\xA7\u2022\xB6\xDF\xAE\xA9\u2122\xB4\xA8\u2260\u0102\u0218\u221E\xB1\u2264\u2265\xA5\xB5\u2202\u2211\u220F\u03C0\u222B\xAA\xBA\u03A9\u0103\u0219\xBF\xA1\xAC\u221A\u0192\u2248\u2206\xAB\xBB\u2026\xA0\xC0\xC3\xD5\u0152\u0153\u2013\u2014\u201C\u201D\u2018\u2019\xF7\u25CA\xFF\u0178\u2044\u20AC\u2039\u203A\u021A\u021B\u2021\xB7\u201A\u201E\u2030\xC2\xCA\xC1\xCB\xC8\xCD\xCE\xCF\xCC\xD3\xD4\uF8FF\xD2\xDA\xDB\xD9\u0131\u02C6\u02DC\xAF\u02D8\u02D9\u02DA\xB8\u02DD\u02DB\u02C7","x-mac-turkish":"\xC4\xC5\xC7\xC9\xD1\xD6\xDC\xE1\xE0\xE2\xE4\xE3\xE5\xE7\xE9\xE8\xEA\xEB\xED\xEC\xEE\xEF\xF1\xF3\xF2\xF4\xF6\xF5\xFA\xF9\xFB\xFC\u2020\xB0\xA2\xA3\xA7\u2022\xB6\xDF\xAE\xA9\u2122\xB4\xA8\u2260\xC6\xD8\u221E\xB1\u2264\u2265\xA5\xB5\u2202\u2211\u220F\u03C0\u222B\xAA\xBA\u03A9\xE6\xF8\xBF\xA1\xAC\u221A\u0192\u2248\u2206\xAB\xBB\u2026\xA0\xC0\xC3\xD5\u0152\u0153\u2013\u2014\u201C\u201D\u2018\u2019\xF7\u25CA\xFF\u0178\u011E\u011F\u0130\u0131\u015E\u015F\u2021\xB7\u201A\u201E\u2030\xC2\xCA\xC1\xCB\xC8\xCD\xCE\xCF\xCC\xD3\xD4\uF8FF\xD2\xDA\xDB\xD9\uF8A0\u02C6\u02DC\xAF\u02D8\u02D9\u02DA\xB8\u02DD\u02DB\u02C7"};Oe.MACSTRING=function(S,k,E,A){var L=W[A];if(L!==void 0){for(var V="",q=0;q<E;q++){var se=S.getUint8(k+q);V+=se<=127?String.fromCharCode(se):L[127&se]}return V}};var J,ie=typeof WeakMap=="function"&&new WeakMap;function ve(S){return-128<=S&&S<=127}function he(S,k,E){for(var A=0,L=S.length;k<L&&A<64&&S[k]===0;)++k,++A;return E.push(128|A-1),k}function Fe(S,k,E){for(var A=0,L=S.length,V=k;V<L&&A<64;){var q=S[V];if(!ve(q)||q===0&&V+1<L&&S[V+1]===0)break;++V,++A}E.push(A-1);for(var se=k;se<V;++se)E.push(S[se]+256&255);return V}function me(S,k,E){for(var A=0,L=S.length,V=k;V<L&&A<64;){var q=S[V];if(q===0||ve(q)&&V+1<L&&ve(S[V+1]))break;++V,++A}E.push(64|A-1);for(var se=k;se<V;++se){var ae=S[se];E.push(ae+65536>>8&255,ae+256&255)}return V}Se.MACSTRING=function(S,k){var E=function(q){if(!J)for(var se in J={},W)J[se]=new String(se);var ae=J[q];if(ae!==void 0){if(ie){var _e=ie.get(ae);if(_e!==void 0)return _e}var je=W[q];if(je!==void 0){for(var qe={},ge=0;ge<je.length;ge++)qe[je.charCodeAt(ge)]=ge+128;return ie&&ie.set(ae,qe),qe}}}(k);if(E!==void 0){for(var A=[],L=0;L<S.length;L++){var V=S.charCodeAt(L);if(128<=V&&(V=E[V])===void 0)return;A[L]=V}return A}},Ee.MACSTRING=function(S,k){var E=Se.MACSTRING(S,k);return E!==void 0?E.length:0},Se.VARDELTAS=function(S){for(var k=0,E=[];k<S.length;){var A=S[k];k=A===0?he(S,k,E):-128<=A&&A<=127?Fe(S,k,E):me(S,k,E)}return E},Se.INDEX=function(S){for(var k=1,E=[k],A=[],L=0;L<S.length;L+=1){var V=Se.OBJECT(S[L]);Array.prototype.push.apply(A,V),k+=V.length,E.push(k)}if(A.length===0)return[0,0];for(var q=[],se=1+Math.floor(Math.log(k)/Math.log(2))/8|0,ae=[void 0,Se.BYTE,Se.USHORT,Se.UINT24,Se.ULONG][se],_e=0;_e<E.length;_e+=1){var je=ae(E[_e]);Array.prototype.push.apply(q,je)}return Array.prototype.concat(Se.Card16(S.length),Se.OffSize(se),q,A)},Ee.INDEX=function(S){return Se.INDEX(S).length},Se.DICT=function(S){for(var k=[],E=Object.keys(S),A=E.length,L=0;L<A;L+=1){var V=parseInt(E[L],0),q=S[V];k=(k=k.concat(Se.OPERAND(q.value,q.type))).concat(Se.OPERATOR(V))}return k},Ee.DICT=function(S){return Se.DICT(S).length},Se.OPERATOR=function(S){return S<1200?[S]:[12,S-1200]},Se.OPERAND=function(S,k){var E=[];if(Array.isArray(k))for(var A=0;A<k.length;A+=1)ye.argument(S.length===k.length,"Not enough arguments given for type"+k),E=E.concat(Se.OPERAND(S[A],k[A]));else if(k==="SID")E=E.concat(Se.NUMBER(S));else if(k==="offset")E=E.concat(Se.NUMBER32(S));else if(k==="number")E=E.concat(Se.NUMBER(S));else{if(k!=="real")throw new Error("Unknown operand type "+k);E=E.concat(Se.REAL(S))}return E},Se.OP=Se.BYTE,Ee.OP=Ee.BYTE;var Le=typeof WeakMap=="function"&&new WeakMap;function De(S,k,E){for(var A=0;A<k.length;A+=1){var L=k[A];this[L.name]=L.value}if(this.tableName=S,this.fields=k,E)for(var V=Object.keys(E),q=0;q<V.length;q+=1){var se=V[q],ae=E[se];this[se]!==void 0&&(this[se]=ae)}}function Ne(S,k,E){E===void 0&&(E=k.length);var A=new Array(k.length+1);A[0]={name:S+"Count",type:"USHORT",value:E};for(var L=0;L<k.length;L++)A[L+1]={name:S+L,type:"USHORT",value:k[L]};return A}function rt(S,k,E){var A=k.length,L=new Array(A+1);L[0]={name:S+"Count",type:"USHORT",value:A};for(var V=0;V<A;V++)L[V+1]={name:S+V,type:"TABLE",value:E(k[V],V)};return L}function tt(S,k,E){var A=k.length,L=[];L[0]={name:S+"Count",type:"USHORT",value:A};for(var V=0;V<A;V++)L=L.concat(E(k[V],V));return L}function Je(S){S.format===1?De.call(this,"coverageTable",[{name:"coverageFormat",type:"USHORT",value:1}].concat(Ne("glyph",S.glyphs))):ye.assert(!1,"Can't create coverage table format 2 yet.")}function xt(S){De.call(this,"scriptListTable",tt("scriptRecord",S,function(k,E){var A=k.script,L=A.defaultLangSys;return ye.assert(!!L,"Unable to write GSUB: script "+k.tag+" has no default language system."),[{name:"scriptTag"+E,type:"TAG",value:k.tag},{name:"script"+E,type:"TABLE",value:new De("scriptTable",[{name:"defaultLangSys",type:"TABLE",value:new De("defaultLangSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:L.reqFeatureIndex}].concat(Ne("featureIndex",L.featureIndexes)))}].concat(tt("langSys",A.langSysRecords,function(V,q){var se=V.langSys;return[{name:"langSysTag"+q,type:"TAG",value:V.tag},{name:"langSys"+q,type:"TABLE",value:new De("langSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:se.reqFeatureIndex}].concat(Ne("featureIndex",se.featureIndexes)))}]})))}]}))}function Pt(S){De.call(this,"featureListTable",tt("featureRecord",S,function(k,E){var A=k.feature;return[{name:"featureTag"+E,type:"TAG",value:k.tag},{name:"feature"+E,type:"TABLE",value:new De("featureTable",[{name:"featureParams",type:"USHORT",value:A.featureParams}].concat(Ne("lookupListIndex",A.lookupListIndexes)))}]}))}function Dt(S,k){De.call(this,"lookupListTable",rt("lookup",S,function(E){var A=k[E.lookupType];return ye.assert(!!A,"Unable to write GSUB lookup type "+E.lookupType+" tables."),new De("lookupTable",[{name:"lookupType",type:"USHORT",value:E.lookupType},{name:"lookupFlag",type:"USHORT",value:E.lookupFlag}].concat(rt("subtable",E.subtables,A)))}))}Se.CHARSTRING=function(S){if(Le){var k=Le.get(S);if(k!==void 0)return k}for(var E=[],A=S.length,L=0;L<A;L+=1){var V=S[L];E=E.concat(Se[V.type](V.value))}return Le&&Le.set(S,E),E},Ee.CHARSTRING=function(S){return Se.CHARSTRING(S).length},Se.OBJECT=function(S){var k=Se[S.type];return ye.argument(k!==void 0,"No encoding function for type "+S.type),k(S.value)},Ee.OBJECT=function(S){var k=Ee[S.type];return ye.argument(k!==void 0,"No sizeOf function for type "+S.type),k(S.value)},Se.TABLE=function(S){for(var k=[],E=S.fields.length,A=[],L=[],V=0;V<E;V+=1){var q=S.fields[V],se=Se[q.type];ye.argument(se!==void 0,"No encoding function for field type "+q.type+" ("+q.name+")");var ae=S[q.name];ae===void 0&&(ae=q.value);var _e=se(ae);q.type==="TABLE"?(L.push(k.length),k=k.concat([0,0]),A.push(_e)):k=k.concat(_e)}for(var je=0;je<A.length;je+=1){var qe=L[je],ge=k.length;ye.argument(ge<65536,"Table "+S.tableName+" too big."),k[qe]=ge>>8,k[qe+1]=255&ge,k=k.concat(A[je])}return k},Ee.TABLE=function(S){for(var k=0,E=S.fields.length,A=0;A<E;A+=1){var L=S.fields[A],V=Ee[L.type];ye.argument(V!==void 0,"No sizeOf function for field type "+L.type+" ("+L.name+")");var q=S[L.name];q===void 0&&(q=L.value),k+=V(q),L.type==="TABLE"&&(k+=2)}return k},Se.RECORD=Se.TABLE,Ee.RECORD=Ee.TABLE,Se.LITERAL=function(S){return S},Ee.LITERAL=function(S){return S.length},De.prototype.encode=function(){return Se.TABLE(this)},De.prototype.sizeOf=function(){return Ee.TABLE(this)};var St={Table:De,Record:De,Coverage:(Je.prototype=Object.create(De.prototype)).constructor=Je,ScriptList:(xt.prototype=Object.create(De.prototype)).constructor=xt,FeatureList:(Pt.prototype=Object.create(De.prototype)).constructor=Pt,LookupList:(Dt.prototype=Object.create(De.prototype)).constructor=Dt,ushortList:Ne,tableList:rt,recordList:tt};function Jt(S,k){return S.getUint8(k)}function ht(S,k){return S.getUint16(k,!1)}function ct(S,k){return S.getUint32(k,!1)}function At(S,k){return S.getInt16(k,!1)+S.getUint16(k+2,!1)/65535}var Ft={byte:1,uShort:2,short:2,uLong:4,fixed:4,longDateTime:8,tag:4};function Be(S,k){this.data=S,this.offset=k,this.relativeOffset=0}Be.prototype.parseByte=function(){var S=this.data.getUint8(this.offset+this.relativeOffset);return this.relativeOffset+=1,S},Be.prototype.parseChar=function(){var S=this.data.getInt8(this.offset+this.relativeOffset);return this.relativeOffset+=1,S},Be.prototype.parseCard8=Be.prototype.parseByte,Be.prototype.parseCard16=Be.prototype.parseUShort=function(){var S=this.data.getUint16(this.offset+this.relativeOffset);return this.relativeOffset+=2,S},Be.prototype.parseSID=Be.prototype.parseUShort,Be.prototype.parseOffset16=Be.prototype.parseUShort,Be.prototype.parseShort=function(){var S=this.data.getInt16(this.offset+this.relativeOffset);return this.relativeOffset+=2,S},Be.prototype.parseF2Dot14=function(){var S=this.data.getInt16(this.offset+this.relativeOffset)/16384;return this.relativeOffset+=2,S},Be.prototype.parseOffset32=Be.prototype.parseULong=function(){var S=ct(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,S},Be.prototype.parseFixed=function(){var S=At(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,S},Be.prototype.parseString=function(S){var k=this.data,E=this.offset+this.relativeOffset,A="";this.relativeOffset+=S;for(var L=0;L<S;L++)A+=String.fromCharCode(k.getUint8(E+L));return A},Be.prototype.parseTag=function(){return this.parseString(4)},Be.prototype.parseLongDateTime=function(){var S=ct(this.data,this.offset+this.relativeOffset+4);return S-=2082844800,this.relativeOffset+=8,S},Be.prototype.parseVersion=function(S){var k=ht(this.data,this.offset+this.relativeOffset),E=ht(this.data,this.offset+this.relativeOffset+2);return this.relativeOffset+=4,S===void 0&&(S=4096),k+E/S/10},Be.prototype.skip=function(S,k){k===void 0&&(k=1),this.relativeOffset+=Ft[S]*k},Be.prototype.parseULongList=function(S){S===void 0&&(S=this.parseULong());for(var k=new Array(S),E=this.data,A=this.offset+this.relativeOffset,L=0;L<S;L++)k[L]=E.getUint32(A),A+=4;return this.relativeOffset+=4*S,k},Be.prototype.parseOffset16List=Be.prototype.parseUShortList=function(S){S===void 0&&(S=this.parseUShort());for(var k=new Array(S),E=this.data,A=this.offset+this.relativeOffset,L=0;L<S;L++)k[L]=E.getUint16(A),A+=2;return this.relativeOffset+=2*S,k},Be.prototype.parseShortList=function(S){for(var k=new Array(S),E=this.data,A=this.offset+this.relativeOffset,L=0;L<S;L++)k[L]=E.getInt16(A),A+=2;return this.relativeOffset+=2*S,k},Be.prototype.parseByteList=function(S){for(var k=new Array(S),E=this.data,A=this.offset+this.relativeOffset,L=0;L<S;L++)k[L]=E.getUint8(A++);return this.relativeOffset+=S,k},Be.prototype.parseList=function(S,k){k||(k=S,S=this.parseUShort());for(var E=new Array(S),A=0;A<S;A++)E[A]=k.call(this);return E},Be.prototype.parseList32=function(S,k){k||(k=S,S=this.parseULong());for(var E=new Array(S),A=0;A<S;A++)E[A]=k.call(this);return E},Be.prototype.parseRecordList=function(S,k){k||(k=S,S=this.parseUShort());for(var E=new Array(S),A=Object.keys(k),L=0;L<S;L++){for(var V={},q=0;q<A.length;q++){var se=A[q],ae=k[se];V[se]=ae.call(this)}E[L]=V}return E},Be.prototype.parseRecordList32=function(S,k){k||(k=S,S=this.parseULong());for(var E=new Array(S),A=Object.keys(k),L=0;L<S;L++){for(var V={},q=0;q<A.length;q++){var se=A[q],ae=k[se];V[se]=ae.call(this)}E[L]=V}return E},Be.prototype.parseStruct=function(S){if(typeof S=="function")return S.call(this);for(var k=Object.keys(S),E={},A=0;A<k.length;A++){var L=k[A],V=S[L];E[L]=V.call(this)}return E},Be.prototype.parseValueRecord=function(S){if(S===void 0&&(S=this.parseUShort()),S!==0){var k={};return 1&S&&(k.xPlacement=this.parseShort()),2&S&&(k.yPlacement=this.parseShort()),4&S&&(k.xAdvance=this.parseShort()),8&S&&(k.yAdvance=this.parseShort()),16&S&&(k.xPlaDevice=void 0,this.parseShort()),32&S&&(k.yPlaDevice=void 0,this.parseShort()),64&S&&(k.xAdvDevice=void 0,this.parseShort()),128&S&&(k.yAdvDevice=void 0,this.parseShort()),k}},Be.prototype.parseValueRecordList=function(){for(var S=this.parseUShort(),k=this.parseUShort(),E=new Array(k),A=0;A<k;A++)E[A]=this.parseValueRecord(S);return E},Be.prototype.parsePointer=function(S){var k=this.parseOffset16();if(0<k)return new Be(this.data,this.offset+k).parseStruct(S)},Be.prototype.parsePointer32=function(S){var k=this.parseOffset32();if(0<k)return new Be(this.data,this.offset+k).parseStruct(S)},Be.prototype.parseListOfLists=function(S){for(var k=this.parseOffset16List(),E=k.length,A=this.relativeOffset,L=new Array(E),V=0;V<E;V++){var q=k[V];if(q!==0)if(this.relativeOffset=q,S){for(var se=this.parseOffset16List(),ae=new Array(se.length),_e=0;_e<se.length;_e++)this.relativeOffset=q+se[_e],ae[_e]=S.call(this);L[V]=ae}else L[V]=this.parseUShortList();else L[V]=void 0}return this.relativeOffset=A,L},Be.prototype.parseCoverage=function(){var S=this.offset+this.relativeOffset,k=this.parseUShort(),E=this.parseUShort();if(k===1)return{format:1,glyphs:this.parseUShortList(E)};if(k!==2)throw new Error("0x"+S.toString(16)+": Coverage format must be 1 or 2.");for(var A=new Array(E),L=0;L<E;L++)A[L]={start:this.parseUShort(),end:this.parseUShort(),index:this.parseUShort()};return{format:2,ranges:A}},Be.prototype.parseClassDef=function(){var S=this.offset+this.relativeOffset,k=this.parseUShort();if(k===1)return{format:1,startGlyph:this.parseUShort(),classes:this.parseUShortList()};if(k===2)return{format:2,ranges:this.parseRecordList({start:Be.uShort,end:Be.uShort,classId:Be.uShort})};throw new Error("0x"+S.toString(16)+": ClassDef format must be 1 or 2.")},Be.list=function(S,k){return function(){return this.parseList(S,k)}},Be.list32=function(S,k){return function(){return this.parseList32(S,k)}},Be.recordList=function(S,k){return function(){return this.parseRecordList(S,k)}},Be.recordList32=function(S,k){return function(){return this.parseRecordList32(S,k)}},Be.pointer=function(S){return function(){return this.parsePointer(S)}},Be.pointer32=function(S){return function(){return this.parsePointer32(S)}},Be.tag=Be.prototype.parseTag,Be.byte=Be.prototype.parseByte,Be.uShort=Be.offset16=Be.prototype.parseUShort,Be.uShortList=Be.prototype.parseUShortList,Be.uLong=Be.offset32=Be.prototype.parseULong,Be.uLongList=Be.prototype.parseULongList,Be.struct=Be.prototype.parseStruct,Be.coverage=Be.prototype.parseCoverage,Be.classDef=Be.prototype.parseClassDef;var qt={reserved:Be.uShort,reqFeatureIndex:Be.uShort,featureIndexes:Be.uShortList};Be.prototype.parseScriptList=function(){return this.parsePointer(Be.recordList({tag:Be.tag,script:Be.pointer({defaultLangSys:Be.pointer(qt),langSysRecords:Be.recordList({tag:Be.tag,langSys:Be.pointer(qt)})})}))||[]},Be.prototype.parseFeatureList=function(){return this.parsePointer(Be.recordList({tag:Be.tag,feature:Be.pointer({featureParams:Be.offset16,lookupListIndexes:Be.uShortList})}))||[]},Be.prototype.parseLookupList=function(S){return this.parsePointer(Be.list(Be.pointer(function(){var k=this.parseUShort();ye.argument(1<=k&&k<=9,"GPOS/GSUB lookup type "+k+" unknown.");var E=this.parseUShort(),A=16&E;return{lookupType:k,lookupFlag:E,subtables:this.parseList(Be.pointer(S[k])),markFilteringSet:A?this.parseUShort():void 0}})))||[]},Be.prototype.parseFeatureVariationsList=function(){return this.parsePointer32(function(){var S=this.parseUShort(),k=this.parseUShort();return ye.argument(S===1&&k<1,"GPOS/GSUB feature variations table unknown."),this.parseRecordList32({conditionSetOffset:Be.offset32,featureTableSubstitutionOffset:Be.offset32})})||[]};var Y={getByte:Jt,getCard8:Jt,getUShort:ht,getCard16:ht,getShort:function(S,k){return S.getInt16(k,!1)},getULong:ct,getFixed:At,getTag:function(S,k){for(var E="",A=k;A<k+4;A+=1)E+=String.fromCharCode(S.getInt8(A));return E},getOffset:function(S,k,E){for(var A=0,L=0;L<E;L+=1)A<<=8,A+=S.getUint8(k+L);return A},getBytes:function(S,k,E){for(var A=[],L=k;L<E;L+=1)A.push(S.getUint8(L));return A},bytesToString:function(S){for(var k="",E=0;E<S.length;E+=1)k+=String.fromCharCode(S[E]);return k},Parser:Be},le={parse:function(S,k){var E={};E.version=Y.getUShort(S,k),ye.argument(E.version===0,"cmap table version should be 0."),E.numTables=Y.getUShort(S,k+2);for(var A=-1,L=E.numTables-1;0<=L;--L){var V=Y.getUShort(S,k+4+8*L),q=Y.getUShort(S,k+4+8*L+2);if(V===3&&(q===0||q===1||q===10)||V===0&&(q===0||q===1||q===2||q===3||q===4)){A=Y.getULong(S,k+4+8*L+4);break}}if(A===-1)throw new Error("No valid cmap sub-tables found.");var se=new Y.Parser(S,k+A);if(E.format=se.parseUShort(),E.format===12)(function(ae,_e){var je;_e.parseUShort(),ae.length=_e.parseULong(),ae.language=_e.parseULong(),ae.groupCount=je=_e.parseULong(),ae.glyphIndexMap={};for(var qe=0;qe<je;qe+=1)for(var ge=_e.parseULong(),$t=_e.parseULong(),wt=_e.parseULong(),mt=ge;mt<=$t;mt+=1)ae.glyphIndexMap[mt]=wt,wt++})(E,se);else{if(E.format!==4)throw new Error("Only format 4 and 12 cmap tables are supported (found format "+E.format+").");(function(ae,_e,je,qe,ge){var $t;ae.length=_e.parseUShort(),ae.language=_e.parseUShort(),ae.segCount=$t=_e.parseUShort()>>1,_e.skip("uShort",3),ae.glyphIndexMap={};for(var wt=new Y.Parser(je,qe+ge+14),mt=new Y.Parser(je,qe+ge+16+2*$t),st=new Y.Parser(je,qe+ge+16+4*$t),dt=new Y.Parser(je,qe+ge+16+6*$t),Zt=qe+ge+16+8*$t,zt=0;zt<$t-1;zt+=1)for(var Bn=void 0,un=wt.parseUShort(),yn=mt.parseUShort(),Or=st.parseShort(),Zn=dt.parseUShort(),qn=yn;qn<=un;qn+=1)Zn!==0?(Zt=dt.offset+dt.relativeOffset-2,Zt+=Zn,Zt+=2*(qn-yn),(Bn=Y.getUShort(je,Zt))!==0&&(Bn=Bn+Or&65535)):Bn=qn+Or&65535,ae.glyphIndexMap[qn]=Bn})(E,se,S,k,A)}return E},make:function(S){var k,E=!0;for(k=S.length-1;0<k;--k)if(65535<S.get(k).unicode){console.log("Adding CMAP format 12 (needed!)"),E=!1;break}var A=[{name:"version",type:"USHORT",value:0},{name:"numTables",type:"USHORT",value:E?1:2},{name:"platformID",type:"USHORT",value:3},{name:"encodingID",type:"USHORT",value:1},{name:"offset",type:"ULONG",value:E?12:20}];E||(A=A.concat([{name:"cmap12PlatformID",type:"USHORT",value:3},{name:"cmap12EncodingID",type:"USHORT",value:10},{name:"cmap12Offset",type:"ULONG",value:0}])),A=A.concat([{name:"format",type:"USHORT",value:4},{name:"cmap4Length",type:"USHORT",value:0},{name:"language",type:"USHORT",value:0},{name:"segCountX2",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);var L,V,q,se=new St.Table("cmap",A);for(se.segments=[],k=0;k<S.length;k+=1){for(var ae=S.get(k),_e=0;_e<ae.unicodes.length;_e+=1)L=se,V=ae.unicodes[_e],q=k,L.segments.push({end:V,start:V,delta:-(V-q),offset:0,glyphIndex:q});se.segments=se.segments.sort(function(Bn,un){return Bn.start-un.start})}se.segments.push({end:65535,start:65535,delta:1,offset:0});var je=se.segments.length,qe=0,ge=[],$t=[],wt=[],mt=[],st=[],dt=[];for(k=0;k<je;k+=1){var Zt=se.segments[k];Zt.end<=65535&&Zt.start<=65535?(ge=ge.concat({name:"end_"+k,type:"USHORT",value:Zt.end}),$t=$t.concat({name:"start_"+k,type:"USHORT",value:Zt.start}),wt=wt.concat({name:"idDelta_"+k,type:"SHORT",value:Zt.delta}),mt=mt.concat({name:"idRangeOffset_"+k,type:"USHORT",value:Zt.offset}),Zt.glyphId!==void 0&&(st=st.concat({name:"glyph_"+k,type:"USHORT",value:Zt.glyphId}))):qe+=1,E||Zt.glyphIndex===void 0||(dt=(dt=(dt=dt.concat({name:"cmap12Start_"+k,type:"ULONG",value:Zt.start})).concat({name:"cmap12End_"+k,type:"ULONG",value:Zt.end})).concat({name:"cmap12Glyph_"+k,type:"ULONG",value:Zt.glyphIndex}))}if(se.segCountX2=2*(je-qe),se.searchRange=2*Math.pow(2,Math.floor(Math.log(je-qe)/Math.log(2))),se.entrySelector=Math.log(se.searchRange/2)/Math.log(2),se.rangeShift=se.segCountX2-se.searchRange,se.fields=se.fields.concat(ge),se.fields.push({name:"reservedPad",type:"USHORT",value:0}),se.fields=se.fields.concat($t),se.fields=se.fields.concat(wt),se.fields=se.fields.concat(mt),se.fields=se.fields.concat(st),se.cmap4Length=14+2*ge.length+2+2*$t.length+2*wt.length+2*mt.length+2*st.length,!E){var zt=16+4*dt.length;se.cmap12Offset=20+se.cmap4Length,se.fields=se.fields.concat([{name:"cmap12Format",type:"USHORT",value:12},{name:"cmap12Reserved",type:"USHORT",value:0},{name:"cmap12Length",type:"ULONG",value:zt},{name:"cmap12Language",type:"ULONG",value:0},{name:"cmap12nGroups",type:"ULONG",value:dt.length/3}]),se.fields=se.fields.concat(dt)}return se}},ee=[".notdef","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","endash","dagger","daggerdbl","periodcentered","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","questiondown","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","ring","cedilla","hungarumlaut","ogonek","caron","emdash","AE","ordfeminine","Lslash","Oslash","OE","ordmasculine","ae","dotlessi","lslash","oslash","oe","germandbls","onesuperior","logicalnot","mu","trademark","Eth","onehalf","plusminus","Thorn","onequarter","divide","brokenbar","degree","thorn","threequarters","twosuperior","registered","minus","eth","multiply","threesuperior","copyright","Aacute","Acircumflex","Adieresis","Agrave","Aring","Atilde","Ccedilla","Eacute","Ecircumflex","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Ntilde","Oacute","Ocircumflex","Odieresis","Ograve","Otilde","Scaron","Uacute","Ucircumflex","Udieresis","Ugrave","Yacute","Ydieresis","Zcaron","aacute","acircumflex","adieresis","agrave","aring","atilde","ccedilla","eacute","ecircumflex","edieresis","egrave","iacute","icircumflex","idieresis","igrave","ntilde","oacute","ocircumflex","odieresis","ograve","otilde","scaron","uacute","ucircumflex","udieresis","ugrave","yacute","ydieresis","zcaron","exclamsmall","Hungarumlautsmall","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","266 ff","onedotenleader","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","commasuperior","threequartersemdash","periodsuperior","questionsmall","asuperior","bsuperior","centsuperior","dsuperior","esuperior","isuperior","lsuperior","msuperior","nsuperior","osuperior","rsuperior","ssuperior","tsuperior","ff","ffi","ffl","parenleftinferior","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","exclamdownsmall","centoldstyle","Lslashsmall","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","Dotaccentsmall","Macronsmall","figuredash","hypheninferior","Ogoneksmall","Ringsmall","Cedillasmall","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","zerosuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall","001.000","001.001","001.002","001.003","Black","Bold","Book","Light","Medium","Regular","Roman","Semibold"],ue=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","","endash","dagger","daggerdbl","periodcentered","","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","","questiondown","","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","","ring","cedilla","","hungarumlaut","ogonek","caron","emdash","","","","","","","","","","","","","","","","","AE","","ordfeminine","","","","","Lslash","Oslash","OE","ordmasculine","","","","","","ae","","","","dotlessi","","","lslash","oslash","oe","germandbls"],Ae=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclamsmall","Hungarumlautsmall","","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","twodotenleader","onedotenleader","comma","hyphen","period","fraction","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","colon","semicolon","commasuperior","threequartersemdash","periodsuperior","questionsmall","","asuperior","bsuperior","centsuperior","dsuperior","esuperior","","","isuperior","","","lsuperior","msuperior","nsuperior","osuperior","","","rsuperior","ssuperior","tsuperior","","ff","fi","fl","ffi","ffl","parenleftinferior","","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdownsmall","centoldstyle","Lslashsmall","","","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","","Dotaccentsmall","","","Macronsmall","","","figuredash","hypheninferior","","","Ogoneksmall","Ringsmall","Cedillasmall","","","","onequarter","onehalf","threequarters","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","","","zerosuperior","onesuperior","twosuperior","threesuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall"],Ke=[".notdef",".null","nonmarkingreturn","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quotesingle","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","grave","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","Adieresis","Aring","Ccedilla","Eacute","Ntilde","Odieresis","Udieresis","aacute","agrave","acircumflex","adieresis","atilde","aring","ccedilla","eacute","egrave","ecircumflex","edieresis","iacute","igrave","icircumflex","idieresis","ntilde","oacute","ograve","ocircumflex","odieresis","otilde","uacute","ugrave","ucircumflex","udieresis","dagger","degree","cent","sterling","section","bullet","paragraph","germandbls","registered","copyright","trademark","acute","dieresis","notequal","AE","Oslash","infinity","plusminus","lessequal","greaterequal","yen","mu","partialdiff","summation","product","pi","integral","ordfeminine","ordmasculine","Omega","ae","oslash","questiondown","exclamdown","logicalnot","radical","florin","approxequal","Delta","guillemotleft","guillemotright","ellipsis","nonbreakingspace","Agrave","Atilde","Otilde","OE","oe","endash","emdash","quotedblleft","quotedblright","quoteleft","quoteright","divide","lozenge","ydieresis","Ydieresis","fraction","currency","guilsinglleft","guilsinglright","fi","fl","daggerdbl","periodcentered","quotesinglbase","quotedblbase","perthousand","Acircumflex","Ecircumflex","Aacute","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Oacute","Ocircumflex","apple","Ograve","Uacute","Ucircumflex","Ugrave","dotlessi","circumflex","tilde","macron","breve","dotaccent","ring","cedilla","hungarumlaut","ogonek","caron","Lslash","lslash","Scaron","scaron","Zcaron","zcaron","brokenbar","Eth","eth","Yacute","yacute","Thorn","thorn","minus","multiply","onesuperior","twosuperior","threesuperior","onehalf","onequarter","threequarters","franc","Gbreve","gbreve","Idotaccent","Scedilla","scedilla","Cacute","cacute","Ccaron","ccaron","dcroat"];function ot(S){this.font=S}function vt(S){this.cmap=S}function Pe(S,k){this.encoding=S,this.charset=k}function Mt(S){switch(S.version){case 1:this.names=Ke.slice();break;case 2:this.names=new Array(S.numberOfGlyphs);for(var k=0;k<S.numberOfGlyphs;k++)S.glyphNameIndex[k]<Ke.length?this.names[k]=Ke[S.glyphNameIndex[k]]:this.names[k]=S.names[S.glyphNameIndex[k]-Ke.length];break;case 2.5:this.names=new Array(S.numberOfGlyphs);for(var E=0;E<S.numberOfGlyphs;E++)this.names[E]=Ke[E+S.glyphNameIndex[E]];break;case 3:default:this.names=[]}}ot.prototype.charToGlyphIndex=function(S){var k=S.codePointAt(0),E=this.font.glyphs;if(E){for(var A=0;A<E.length;A+=1)for(var L=E.get(A),V=0;V<L.unicodes.length;V+=1)if(L.unicodes[V]===k)return A}return null},vt.prototype.charToGlyphIndex=function(S){return this.cmap.glyphIndexMap[S.codePointAt(0)]||0},Pe.prototype.charToGlyphIndex=function(S){var k=S.codePointAt(0),E=this.encoding[k];return this.charset.indexOf(E)},Mt.prototype.nameToGlyphIndex=function(S){return this.names.indexOf(S)},Mt.prototype.glyphIndexToName=function(S){return this.names[S]};var en={line:function(S,k,E,A,L){S.beginPath(),S.moveTo(k,E),S.lineTo(A,L),S.stroke()}};function dn(S){this.bindConstructorValues(S)}function mn(S,k,E){Object.defineProperty(S,k,{get:function(){return S.path,S[E]},set:function(A){S[E]=A},enumerable:!0,configurable:!0})}function hn(S,k){if(this.font=S,this.glyphs={},Array.isArray(k))for(var E=0;E<k.length;E++)this.glyphs[E]=k[E];this.length=k&&k.length||0}dn.prototype.bindConstructorValues=function(S){var k,E;this.index=S.index||0,this.name=S.name||null,this.unicode=S.unicode||void 0,this.unicodes=S.unicodes||S.unicode!==void 0?[S.unicode]:[],S.xMin&&(this.xMin=S.xMin),S.yMin&&(this.yMin=S.yMin),S.xMax&&(this.xMax=S.xMax),S.yMax&&(this.yMax=S.yMax),S.advanceWidth&&(this.advanceWidth=S.advanceWidth),Object.defineProperty(this,"path",(k=S.path,E=k||new ce,{configurable:!0,get:function(){return typeof E=="function"&&(E=E()),E},set:function(A){E=A}}))},dn.prototype.addUnicode=function(S){this.unicodes.length===0&&(this.unicode=S),this.unicodes.push(S)},dn.prototype.getBoundingBox=function(){return this.path.getBoundingBox()},dn.prototype.getPath=function(S,k,E,A,L){var V,q;S=S!==void 0?S:0,k=k!==void 0?k:0,E=E!==void 0?E:72;var se=(A=A||{}).xScale,ae=A.yScale;if(A.hinting&&L&&L.hinting&&(q=this.path&&L.hinting.exec(this,E)),q)V=L.hinting.getCommands(q),S=Math.round(S),k=Math.round(k),se=ae=1;else{V=this.path.commands;var _e=1/this.path.unitsPerEm*E;se===void 0&&(se=_e),ae===void 0&&(ae=_e)}for(var je=new ce,qe=0;qe<V.length;qe+=1){var ge=V[qe];ge.type==="M"?je.moveTo(S+ge.x*se,k+-ge.y*ae):ge.type==="L"?je.lineTo(S+ge.x*se,k+-ge.y*ae):ge.type==="Q"?je.quadraticCurveTo(S+ge.x1*se,k+-ge.y1*ae,S+ge.x*se,k+-ge.y*ae):ge.type==="C"?je.curveTo(S+ge.x1*se,k+-ge.y1*ae,S+ge.x2*se,k+-ge.y2*ae,S+ge.x*se,k+-ge.y*ae):ge.type==="Z"&&je.closePath()}return je},dn.prototype.getContours=function(){if(this.points===void 0)return[];for(var S=[],k=[],E=0;E<this.points.length;E+=1){var A=this.points[E];k.push(A),A.lastPointOfContour&&(S.push(k),k=[])}return ye.argument(k.length===0,"There are still points left in the current contour."),S},dn.prototype.getMetrics=function(){for(var S=this.path.commands,k=[],E=[],A=0;A<S.length;A+=1){var L=S[A];L.type!=="Z"&&(k.push(L.x),E.push(L.y)),L.type!=="Q"&&L.type!=="C"||(k.push(L.x1),E.push(L.y1)),L.type==="C"&&(k.push(L.x2),E.push(L.y2))}var V={xMin:Math.min.apply(null,k),yMin:Math.min.apply(null,E),xMax:Math.max.apply(null,k),yMax:Math.max.apply(null,E),leftSideBearing:this.leftSideBearing};return isFinite(V.xMin)||(V.xMin=0),isFinite(V.xMax)||(V.xMax=this.advanceWidth),isFinite(V.yMin)||(V.yMin=0),isFinite(V.yMax)||(V.yMax=0),V.rightSideBearing=this.advanceWidth-V.leftSideBearing-(V.xMax-V.xMin),V},dn.prototype.draw=function(S,k,E,A,L){this.getPath(k,E,A,L).draw(S)},dn.prototype.drawPoints=function(S,k,E,A){function L(qe,ge,$t,wt){var mt=2*Math.PI;S.beginPath();for(var st=0;st<qe.length;st+=1)S.moveTo(ge+qe[st].x*wt,$t+qe[st].y*wt),S.arc(ge+qe[st].x*wt,$t+qe[st].y*wt,2,0,mt,!1);S.closePath(),S.fill()}k=k!==void 0?k:0,E=E!==void 0?E:0,A=A!==void 0?A:24;for(var V=1/this.path.unitsPerEm*A,q=[],se=[],ae=this.path,_e=0;_e<ae.commands.length;_e+=1){var je=ae.commands[_e];je.x!==void 0&&q.push({x:je.x,y:-je.y}),je.x1!==void 0&&se.push({x:je.x1,y:-je.y1}),je.x2!==void 0&&se.push({x:je.x2,y:-je.y2})}S.fillStyle="blue",L(q,k,E,V),S.fillStyle="red",L(se,k,E,V)},dn.prototype.drawMetrics=function(S,k,E,A){var L;k=k!==void 0?k:0,E=E!==void 0?E:0,A=A!==void 0?A:24,L=1/this.path.unitsPerEm*A,S.lineWidth=1,S.strokeStyle="black",en.line(S,k,-1e4,k,1e4),en.line(S,-1e4,E,1e4,E);var V=this.xMin||0,q=this.yMin||0,se=this.xMax||0,ae=this.yMax||0,_e=this.advanceWidth||0;S.strokeStyle="blue",en.line(S,k+V*L,-1e4,k+V*L,1e4),en.line(S,k+se*L,-1e4,k+se*L,1e4),en.line(S,-1e4,E+-q*L,1e4,E+-q*L),en.line(S,-1e4,E+-ae*L,1e4,E+-ae*L),S.strokeStyle="green",en.line(S,k+_e*L,-1e4,k+_e*L,1e4)},hn.prototype.get=function(S){return typeof this.glyphs[S]=="function"&&(this.glyphs[S]=this.glyphs[S]()),this.glyphs[S]},hn.prototype.push=function(S,k){this.glyphs[S]=k,this.length++};var gn={GlyphSet:hn,glyphLoader:function(S,k){return new dn({index:k,font:S})},ttfGlyphLoader:function(S,k,E,A,L,V){return function(){var q=new dn({index:k,font:S});return q.path=function(){E(q,A,L);var se=V(S.glyphs,q);return se.unitsPerEm=S.unitsPerEm,se},mn(q,"xMin","_xMin"),mn(q,"xMax","_xMax"),mn(q,"yMin","_yMin"),mn(q,"yMax","_yMax"),q}},cffGlyphLoader:function(S,k,E,A){return function(){var L=new dn({index:k,font:S});return L.path=function(){var V=E(S,L,A);return V.unitsPerEm=S.unitsPerEm,V},L}}};function jn(S,k){if(S===k)return!0;if(Array.isArray(S)&&Array.isArray(k)){if(S.length!==k.length)return!1;for(var E=0;E<S.length;E+=1)if(!jn(S[E],k[E]))return!1;return!0}return!1}function Ps(S){return S.length<1240?107:S.length<33900?1131:32768}function ms(S,k,E){var A,L,V=[],q=[],se=Y.getCard16(S,k);if(se!==0){var ae=Y.getByte(S,k+2);A=k+(se+1)*ae+2;for(var _e=k+3,je=0;je<se+1;je+=1)V.push(Y.getOffset(S,_e,ae)),_e+=ae;L=A+V[se]}else L=k+2;for(var qe=0;qe<V.length-1;qe+=1){var ge=Y.getBytes(S,A+V[qe],A+V[qe+1]);E&&(ge=E(ge)),q.push(ge)}return{objects:q,startOffset:k,endOffset:L}}function Es(S,k){if(k===28)return S.parseByte()<<8|S.parseByte();if(k===29)return S.parseByte()<<24|S.parseByte()<<16|S.parseByte()<<8|S.parseByte();if(k===30)return function(E){for(var A="",L=["0","1","2","3","4","5","6","7","8","9",".","E","E-",null,"-"];;){var V=E.parseByte(),q=V>>4,se=15&V;if(q==15||(A+=L[q],se==15))break;A+=L[se]}return parseFloat(A)}(S);if(32<=k&&k<=246)return k-139;if(247<=k&&k<=250)return 256*(k-247)+S.parseByte()+108;if(251<=k&&k<=254)return 256*-(k-251)-S.parseByte()-108;throw new Error("Invalid b0 "+k)}function Ho(S,k,E){k=k!==void 0?k:0;var A=new Y.Parser(S,k),L=[],V=[];for(E=E!==void 0?E:S.length;A.relativeOffset<E;){var q=A.parseByte();q<=21?(q===12&&(q=1200+A.parseByte()),L.push([q,V]),V=[]):V.push(Es(A,q))}return function(se){for(var ae={},_e=0;_e<se.length;_e+=1){var je=se[_e][0],qe=se[_e][1],ge=void 0;if(ge=qe.length===1?qe[0]:qe,ae.hasOwnProperty(je)&&!isNaN(ae[je]))throw new Error("Object "+ae+" already has key "+je);ae[je]=ge}return ae}(L)}function zr(S,k){return k=k<=390?ee[k]:S[k-391]}function js(S,k,E){for(var A,L={},V=0;V<k.length;V+=1){var q=k[V];if(Array.isArray(q.type)){var se=[];se.length=q.type.length;for(var ae=0;ae<q.type.length;ae++)(A=S[q.op]!==void 0?S[q.op][ae]:void 0)===void 0&&(A=q.value!==void 0&&q.value[ae]!==void 0?q.value[ae]:null),q.type[ae]==="SID"&&(A=zr(E,A)),se[ae]=A;L[q.name]=se}else(A=S[q.op])===void 0&&(A=q.value!==void 0?q.value:null),q.type==="SID"&&(A=zr(E,A)),L[q.name]=A}return L}var gi=[{name:"version",op:0,type:"SID"},{name:"notice",op:1,type:"SID"},{name:"copyright",op:1200,type:"SID"},{name:"fullName",op:2,type:"SID"},{name:"familyName",op:3,type:"SID"},{name:"weight",op:4,type:"SID"},{name:"isFixedPitch",op:1201,type:"number",value:0},{name:"italicAngle",op:1202,type:"number",value:0},{name:"underlinePosition",op:1203,type:"number",value:-100},{name:"underlineThickness",op:1204,type:"number",value:50},{name:"paintType",op:1205,type:"number",value:0},{name:"charstringType",op:1206,type:"number",value:2},{name:"fontMatrix",op:1207,type:["real","real","real","real","real","real"],value:[.001,0,0,.001,0,0]},{name:"uniqueId",op:13,type:"number"},{name:"fontBBox",op:5,type:["number","number","number","number"],value:[0,0,0,0]},{name:"strokeWidth",op:1208,type:"number",value:0},{name:"xuid",op:14,type:[],value:null},{name:"charset",op:15,type:"offset",value:0},{name:"encoding",op:16,type:"offset",value:0},{name:"charStrings",op:17,type:"offset",value:0},{name:"private",op:18,type:["number","offset"],value:[0,0]},{name:"ros",op:1230,type:["SID","SID","number"]},{name:"cidFontVersion",op:1231,type:"number",value:0},{name:"cidFontRevision",op:1232,type:"number",value:0},{name:"cidFontType",op:1233,type:"number",value:0},{name:"cidCount",op:1234,type:"number",value:8720},{name:"uidBase",op:1235,type:"number"},{name:"fdArray",op:1236,type:"offset"},{name:"fdSelect",op:1237,type:"offset"},{name:"fontName",op:1238,type:"SID"}],cr=[{name:"subrs",op:19,type:"offset",value:0},{name:"defaultWidthX",op:20,type:"number",value:0},{name:"nominalWidthX",op:21,type:"number",value:0}];function as(S,k,E,A){return js(Ho(S,k,E),cr,A)}function qo(S,k,E,A){for(var L,V,q=[],se=0;se<E.length;se+=1){var ae=new DataView(new Uint8Array(E[se]).buffer),_e=(V=A,js(Ho(L=ae,0,L.byteLength),gi,V));_e._subrs=[],_e._subrsBias=0;var je=_e.private[0],qe=_e.private[1];if(je!==0&&qe!==0){var ge=as(S,qe+k,je,A);if(_e._defaultWidthX=ge.defaultWidthX,_e._nominalWidthX=ge.nominalWidthX,ge.subrs!==0){var $t=ms(S,qe+ge.subrs+k);_e._subrs=$t.objects,_e._subrsBias=Ps(_e._subrs)}_e._privateDict=ge}q.push(_e)}return q}function wa(S,k,E){var A,L,V,q,se,ae,_e,je,qe=new ce,ge=[],$t=0,wt=!1,mt=!1,st=0,dt=0;if(S.isCIDFont){var Zt=S.tables.cff.topDict._fdSelect[k.index],zt=S.tables.cff.topDict._fdArray[Zt];se=zt._subrs,ae=zt._subrsBias,_e=zt._defaultWidthX,je=zt._nominalWidthX}else se=S.tables.cff.topDict._subrs,ae=S.tables.cff.topDict._subrsBias,_e=S.tables.cff.topDict._defaultWidthX,je=S.tables.cff.topDict._nominalWidthX;var Bn=_e;function un(Or,Zn){mt&&qe.closePath(),qe.moveTo(Or,Zn),mt=!0}function yn(){ge.length%2==0||wt||(Bn=ge.shift()+je),$t+=ge.length>>1,ge.length=0,wt=!0}return function Or(Zn){for(var qn,Fn,Ve,it,nt,Ot,Ht,vn,$n,Tn,Qn,Xr,Vn=0;Vn<Zn.length;){var fr=Zn[Vn];switch(Vn+=1,fr){case 1:case 3:yn();break;case 4:1<ge.length&&!wt&&(Bn=ge.shift()+je,wt=!0),dt+=ge.pop(),un(st,dt);break;case 5:for(;0<ge.length;)st+=ge.shift(),dt+=ge.shift(),qe.lineTo(st,dt);break;case 6:for(;0<ge.length&&(st+=ge.shift(),qe.lineTo(st,dt),ge.length!==0);)dt+=ge.shift(),qe.lineTo(st,dt);break;case 7:for(;0<ge.length&&(dt+=ge.shift(),qe.lineTo(st,dt),ge.length!==0);)st+=ge.shift(),qe.lineTo(st,dt);break;case 8:for(;0<ge.length;)A=st+ge.shift(),L=dt+ge.shift(),V=A+ge.shift(),q=L+ge.shift(),st=V+ge.shift(),dt=q+ge.shift(),qe.curveTo(A,L,V,q,st,dt);break;case 10:nt=ge.pop()+ae,(Ot=se[nt])&&Or(Ot);break;case 11:return;case 12:switch(fr=Zn[Vn],Vn+=1,fr){case 35:A=st+ge.shift(),L=dt+ge.shift(),V=A+ge.shift(),q=L+ge.shift(),Ht=V+ge.shift(),vn=q+ge.shift(),$n=Ht+ge.shift(),Tn=vn+ge.shift(),Qn=$n+ge.shift(),Xr=Tn+ge.shift(),st=Qn+ge.shift(),dt=Xr+ge.shift(),ge.shift(),qe.curveTo(A,L,V,q,Ht,vn),qe.curveTo($n,Tn,Qn,Xr,st,dt);break;case 34:A=st+ge.shift(),L=dt,V=A+ge.shift(),q=L+ge.shift(),Ht=V+ge.shift(),vn=q,$n=Ht+ge.shift(),Tn=q,Qn=$n+ge.shift(),Xr=dt,st=Qn+ge.shift(),qe.curveTo(A,L,V,q,Ht,vn),qe.curveTo($n,Tn,Qn,Xr,st,dt);break;case 36:A=st+ge.shift(),L=dt+ge.shift(),V=A+ge.shift(),q=L+ge.shift(),Ht=V+ge.shift(),vn=q,$n=Ht+ge.shift(),Tn=q,Qn=$n+ge.shift(),Xr=Tn+ge.shift(),st=Qn+ge.shift(),qe.curveTo(A,L,V,q,Ht,vn),qe.curveTo($n,Tn,Qn,Xr,st,dt);break;case 37:A=st+ge.shift(),L=dt+ge.shift(),V=A+ge.shift(),q=L+ge.shift(),Ht=V+ge.shift(),vn=q+ge.shift(),$n=Ht+ge.shift(),Tn=vn+ge.shift(),Qn=$n+ge.shift(),Xr=Tn+ge.shift(),Math.abs(Qn-st)>Math.abs(Xr-dt)?st=Qn+ge.shift():dt=Xr+ge.shift(),qe.curveTo(A,L,V,q,Ht,vn),qe.curveTo($n,Tn,Qn,Xr,st,dt);break;default:console.log("Glyph "+k.index+": unknown operator 1200"+fr),ge.length=0}break;case 14:0<ge.length&&!wt&&(Bn=ge.shift()+je,wt=!0),mt&&(qe.closePath(),mt=!1);break;case 18:yn();break;case 19:case 20:yn(),Vn+=$t+7>>3;break;case 21:2<ge.length&&!wt&&(Bn=ge.shift()+je,wt=!0),dt+=ge.pop(),un(st+=ge.pop(),dt);break;case 22:1<ge.length&&!wt&&(Bn=ge.shift()+je,wt=!0),un(st+=ge.pop(),dt);break;case 23:yn();break;case 24:for(;2<ge.length;)A=st+ge.shift(),L=dt+ge.shift(),V=A+ge.shift(),q=L+ge.shift(),st=V+ge.shift(),dt=q+ge.shift(),qe.curveTo(A,L,V,q,st,dt);st+=ge.shift(),dt+=ge.shift(),qe.lineTo(st,dt);break;case 25:for(;6<ge.length;)st+=ge.shift(),dt+=ge.shift(),qe.lineTo(st,dt);A=st+ge.shift(),L=dt+ge.shift(),V=A+ge.shift(),q=L+ge.shift(),st=V+ge.shift(),dt=q+ge.shift(),qe.curveTo(A,L,V,q,st,dt);break;case 26:for(ge.length%2&&(st+=ge.shift());0<ge.length;)A=st,L=dt+ge.shift(),V=A+ge.shift(),q=L+ge.shift(),st=V,dt=q+ge.shift(),qe.curveTo(A,L,V,q,st,dt);break;case 27:for(ge.length%2&&(dt+=ge.shift());0<ge.length;)A=st+ge.shift(),L=dt,V=A+ge.shift(),q=L+ge.shift(),st=V+ge.shift(),dt=q,qe.curveTo(A,L,V,q,st,dt);break;case 28:qn=Zn[Vn],Fn=Zn[Vn+1],ge.push((qn<<24|Fn<<16)>>16),Vn+=2;break;case 29:nt=ge.pop()+S.gsubrsBias,(Ot=S.gsubrs[nt])&&Or(Ot);break;case 30:for(;0<ge.length&&(A=st,L=dt+ge.shift(),V=A+ge.shift(),q=L+ge.shift(),st=V+ge.shift(),dt=q+(ge.length===1?ge.shift():0),qe.curveTo(A,L,V,q,st,dt),ge.length!==0);)A=st+ge.shift(),L=dt,V=A+ge.shift(),q=L+ge.shift(),dt=q+ge.shift(),st=V+(ge.length===1?ge.shift():0),qe.curveTo(A,L,V,q,st,dt);break;case 31:for(;0<ge.length&&(A=st+ge.shift(),L=dt,V=A+ge.shift(),q=L+ge.shift(),dt=q+ge.shift(),st=V+(ge.length===1?ge.shift():0),qe.curveTo(A,L,V,q,st,dt),ge.length!==0);)A=st,L=dt+ge.shift(),V=A+ge.shift(),q=L+ge.shift(),st=V+ge.shift(),dt=q+(ge.length===1?ge.shift():0),qe.curveTo(A,L,V,q,st,dt);break;default:fr<32?console.log("Glyph "+k.index+": unknown operator "+fr):fr<247?ge.push(fr-139):fr<251?(qn=Zn[Vn],Vn+=1,ge.push(256*(fr-247)+qn+108)):fr<255?(qn=Zn[Vn],Vn+=1,ge.push(256*-(fr-251)-qn-108)):(qn=Zn[Vn],Fn=Zn[Vn+1],Ve=Zn[Vn+2],it=Zn[Vn+3],Vn+=4,ge.push((qn<<24|Fn<<16|Ve<<8|it)/65536))}}}(E),k.advanceWidth=Bn,qe}function ho(S,k){var E,A=ee.indexOf(S);return 0<=A&&(E=A),0<=(A=k.indexOf(S))?E=A+ee.length:(E=ee.length+k.length,k.push(S)),E}function ko(S,k,E){for(var A={},L=0;L<S.length;L+=1){var V=S[L],q=k[V.name];q===void 0||jn(q,V.value)||(V.type==="SID"&&(q=ho(q,E)),A[V.op]={name:V.name,type:V.type,value:q})}return A}function Re(S,k){var E=new St.Record("Top DICT",[{name:"dict",type:"DICT",value:{}}]);return E.dict=ko(gi,S,k),E}function gt(S){var k=new St.Record("Top DICT INDEX",[{name:"topDicts",type:"INDEX",value:[]}]);return k.topDicts=[{name:"topDict_0",type:"TABLE",value:S}],k}function Lt(S){var k=[],E=S.path;k.push({name:"width",type:"NUMBER",value:S.advanceWidth});for(var A=0,L=0,V=0;V<E.commands.length;V+=1){var q=void 0,se=void 0,ae=E.commands[V];if(ae.type==="Q"&&(ae={type:"C",x:ae.x,y:ae.y,x1:1/3*A+2/3*ae.x1,y1:1/3*L+2/3*ae.y1,x2:1/3*ae.x+2/3*ae.x1,y2:1/3*ae.y+2/3*ae.y1}),ae.type==="M")q=Math.round(ae.x-A),se=Math.round(ae.y-L),k.push({name:"dx",type:"NUMBER",value:q}),k.push({name:"dy",type:"NUMBER",value:se}),k.push({name:"rmoveto",type:"OP",value:21}),A=Math.round(ae.x),L=Math.round(ae.y);else if(ae.type==="L")q=Math.round(ae.x-A),se=Math.round(ae.y-L),k.push({name:"dx",type:"NUMBER",value:q}),k.push({name:"dy",type:"NUMBER",value:se}),k.push({name:"rlineto",type:"OP",value:5}),A=Math.round(ae.x),L=Math.round(ae.y);else if(ae.type==="C"){var _e=Math.round(ae.x1-A),je=Math.round(ae.y1-L),qe=Math.round(ae.x2-ae.x1),ge=Math.round(ae.y2-ae.y1);q=Math.round(ae.x-ae.x2),se=Math.round(ae.y-ae.y2),k.push({name:"dx1",type:"NUMBER",value:_e}),k.push({name:"dy1",type:"NUMBER",value:je}),k.push({name:"dx2",type:"NUMBER",value:qe}),k.push({name:"dy2",type:"NUMBER",value:ge}),k.push({name:"dx",type:"NUMBER",value:q}),k.push({name:"dy",type:"NUMBER",value:se}),k.push({name:"rrcurveto",type:"OP",value:8}),A=Math.round(ae.x),L=Math.round(ae.y)}}return k.push({name:"endchar",type:"OP",value:14}),k}var kt={parse:function(S,k,E){E.tables.cff={};var A,L,V,q=ms(S,(A=S,L=k,(V={}).formatMajor=Y.getCard8(A,L),V.formatMinor=Y.getCard8(A,L+1),V.size=Y.getCard8(A,L+2),V.offsetSize=Y.getCard8(A,L+3),V.startOffset=L,V.endOffset=L+4,V).endOffset,Y.bytesToString),se=ms(S,q.endOffset),ae=ms(S,se.endOffset,Y.bytesToString),_e=ms(S,ae.endOffset);E.gsubrs=_e.objects,E.gsubrsBias=Ps(E.gsubrs);var je=qo(S,k,se.objects,ae.objects);if(je.length!==1)throw new Error("CFF table has too many fonts in 'FontSet' - count of fonts NameIndex.length = "+je.length);var qe=je[0];if((E.tables.cff.topDict=qe)._privateDict&&(E.defaultWidthX=qe._privateDict.defaultWidthX,E.nominalWidthX=qe._privateDict.nominalWidthX),qe.ros[0]!==void 0&&qe.ros[1]!==void 0&&(E.isCIDFont=!0),E.isCIDFont){var ge=qe.fdArray,$t=qe.fdSelect;if(ge===0||$t===0)throw new Error("Font is marked as a CID font, but FDArray and/or FDSelect information is missing");var wt=qo(S,k,ms(S,ge+=k).objects,ae.objects);qe._fdArray=wt,$t+=k,qe._fdSelect=function(yn,Or,Zn,qn){var Fn,Ve=[],it=new Y.Parser(yn,Or),nt=it.parseCard8();if(nt===0)for(var Ot=0;Ot<Zn;Ot++){if(qn<=(Fn=it.parseCard8()))throw new Error("CFF table CID Font FDSelect has bad FD index value "+Fn+" (FD count "+qn+")");Ve.push(Fn)}else{if(nt!==3)throw new Error("CFF Table CID Font FDSelect table has unsupported format "+nt);var Ht,vn=it.parseCard16(),$n=it.parseCard16();if($n!==0)throw new Error("CFF Table CID Font FDSelect format 3 range has bad initial GID "+$n);for(var Tn=0;Tn<vn;Tn++){if(Fn=it.parseCard8(),Ht=it.parseCard16(),qn<=Fn)throw new Error("CFF table CID Font FDSelect has bad FD index value "+Fn+" (FD count "+qn+")");if(Zn<Ht)throw new Error("CFF Table CID Font FDSelect format 3 range has bad GID "+Ht);for(;$n<Ht;$n++)Ve.push(Fn);$n=Ht}if(Ht!==Zn)throw new Error("CFF Table CID Font FDSelect format 3 range has bad final GID "+Ht)}return Ve}(S,$t,E.numGlyphs,wt.length)}var mt=k+qe.private[1],st=as(S,mt,qe.private[0],ae.objects);if(E.defaultWidthX=st.defaultWidthX,E.nominalWidthX=st.nominalWidthX,st.subrs!==0){var dt=ms(S,mt+st.subrs);E.subrs=dt.objects,E.subrsBias=Ps(E.subrs)}else E.subrs=[],E.subrsBias=0;var Zt=ms(S,k+qe.charStrings);E.nGlyphs=Zt.objects.length;var zt=function(yn,Or,Zn,qn){var Fn,Ve,it=new Y.Parser(yn,Or);--Zn;var nt=[".notdef"],Ot=it.parseCard8();if(Ot===0)for(var Ht=0;Ht<Zn;Ht+=1)Fn=it.parseSID(),nt.push(zr(qn,Fn));else if(Ot===1)for(;nt.length<=Zn;){Fn=it.parseSID(),Ve=it.parseCard8();for(var vn=0;vn<=Ve;vn+=1)nt.push(zr(qn,Fn)),Fn+=1}else{if(Ot!==2)throw new Error("Unknown charset format "+Ot);for(;nt.length<=Zn;){Fn=it.parseSID(),Ve=it.parseCard16();for(var $n=0;$n<=Ve;$n+=1)nt.push(zr(qn,Fn)),Fn+=1}}return nt}(S,k+qe.charset,E.nGlyphs,ae.objects);qe.encoding===0?E.cffEncoding=new Pe(ue,zt):qe.encoding===1?E.cffEncoding=new Pe(Ae,zt):E.cffEncoding=function(yn,Or,Zn){var qn,Fn={},Ve=new Y.Parser(yn,Or),it=Ve.parseCard8();if(it===0)for(var nt=Ve.parseCard8(),Ot=0;Ot<nt;Ot+=1)Fn[qn=Ve.parseCard8()]=Ot;else{if(it!==1)throw new Error("Unknown encoding format "+it);var Ht=Ve.parseCard8();qn=1;for(var vn=0;vn<Ht;vn+=1)for(var $n=Ve.parseCard8(),Tn=Ve.parseCard8(),Qn=$n;Qn<=$n+Tn;Qn+=1)Fn[Qn]=qn,qn+=1}return new Pe(Fn,Zn)}(S,k+qe.encoding,zt),E.encoding=E.encoding||E.cffEncoding,E.glyphs=new gn.GlyphSet(E);for(var Bn=0;Bn<E.nGlyphs;Bn+=1){var un=Zt.objects[Bn];E.glyphs.push(Bn,gn.cffGlyphLoader(E,Bn,wa,un))}},make:function(S,k){for(var E,A=new St.Table("CFF ",[{name:"header",type:"RECORD"},{name:"nameIndex",type:"RECORD"},{name:"topDictIndex",type:"RECORD"},{name:"stringIndex",type:"RECORD"},{name:"globalSubrIndex",type:"RECORD"},{name:"charsets",type:"RECORD"},{name:"charStringsIndex",type:"RECORD"},{name:"privateDict",type:"RECORD"}]),L=1/k.unitsPerEm,V={version:k.version,fullName:k.fullName,familyName:k.familyName,weight:k.weightName,fontBBox:k.fontBBox||[0,0,0,0],fontMatrix:[L,0,0,L,0,0],charset:999,encoding:0,charStrings:999,private:[0,999]},q=[],se=1;se<S.length;se+=1)E=S.get(se),q.push(E.name);var ae=[];A.header=new St.Record("Header",[{name:"major",type:"Card8",value:1},{name:"minor",type:"Card8",value:0},{name:"hdrSize",type:"Card8",value:4},{name:"major",type:"Card8",value:1}]),A.nameIndex=function(wt){var mt=new St.Record("Name INDEX",[{name:"names",type:"INDEX",value:[]}]);mt.names=[];for(var st=0;st<wt.length;st+=1)mt.names.push({name:"name_"+st,type:"NAME",value:wt[st]});return mt}([k.postScriptName]);var _e,je,qe,ge=Re(V,ae);A.topDictIndex=gt(ge),A.globalSubrIndex=new St.Record("Global Subr INDEX",[{name:"subrs",type:"INDEX",value:[]}]),A.charsets=function(wt,mt){for(var st=new St.Record("Charsets",[{name:"format",type:"Card8",value:0}]),dt=0;dt<wt.length;dt+=1){var Zt=ho(wt[dt],mt);st.fields.push({name:"glyph_"+dt,type:"SID",value:Zt})}return st}(q,ae),A.charStringsIndex=function(wt){for(var mt=new St.Record("CharStrings INDEX",[{name:"charStrings",type:"INDEX",value:[]}]),st=0;st<wt.length;st+=1){var dt=wt.get(st),Zt=Lt(dt);mt.charStrings.push({name:dt.name,type:"CHARSTRING",value:Zt})}return mt}(S),A.privateDict=(_e={},je=ae,(qe=new St.Record("Private DICT",[{name:"dict",type:"DICT",value:{}}])).dict=ko(cr,_e,je),qe),A.stringIndex=function(wt){var mt=new St.Record("String INDEX",[{name:"strings",type:"INDEX",value:[]}]);mt.strings=[];for(var st=0;st<wt.length;st+=1)mt.strings.push({name:"string_"+st,type:"STRING",value:wt[st]});return mt}(ae);var $t=A.header.sizeOf()+A.nameIndex.sizeOf()+A.topDictIndex.sizeOf()+A.stringIndex.sizeOf()+A.globalSubrIndex.sizeOf();return V.charset=$t,V.encoding=0,V.charStrings=V.charset+A.charsets.sizeOf(),V.private[1]=V.charStrings+A.charStringsIndex.sizeOf(),ge=Re(V,ae),A.topDictIndex=gt(ge),A}},Xt={parse:function(S,k){var E={},A=new Y.Parser(S,k);return E.version=A.parseVersion(),E.fontRevision=Math.round(1e3*A.parseFixed())/1e3,E.checkSumAdjustment=A.parseULong(),E.magicNumber=A.parseULong(),ye.argument(E.magicNumber===1594834165,"Font header has wrong magic number."),E.flags=A.parseUShort(),E.unitsPerEm=A.parseUShort(),E.created=A.parseLongDateTime(),E.modified=A.parseLongDateTime(),E.xMin=A.parseShort(),E.yMin=A.parseShort(),E.xMax=A.parseShort(),E.yMax=A.parseShort(),E.macStyle=A.parseUShort(),E.lowestRecPPEM=A.parseUShort(),E.fontDirectionHint=A.parseShort(),E.indexToLocFormat=A.parseShort(),E.glyphDataFormat=A.parseShort(),E},make:function(S){var k=Math.round(new Date().getTime()/1e3)+2082844800,E=k;return S.createdTimestamp&&(E=S.createdTimestamp+2082844800),new St.Table("head",[{name:"version",type:"FIXED",value:65536},{name:"fontRevision",type:"FIXED",value:65536},{name:"checkSumAdjustment",type:"ULONG",value:0},{name:"magicNumber",type:"ULONG",value:1594834165},{name:"flags",type:"USHORT",value:0},{name:"unitsPerEm",type:"USHORT",value:1e3},{name:"created",type:"LONGDATETIME",value:E},{name:"modified",type:"LONGDATETIME",value:k},{name:"xMin",type:"SHORT",value:0},{name:"yMin",type:"SHORT",value:0},{name:"xMax",type:"SHORT",value:0},{name:"yMax",type:"SHORT",value:0},{name:"macStyle",type:"USHORT",value:0},{name:"lowestRecPPEM",type:"USHORT",value:0},{name:"fontDirectionHint",type:"SHORT",value:2},{name:"indexToLocFormat",type:"SHORT",value:0},{name:"glyphDataFormat",type:"SHORT",value:0}],S)}},yt={parse:function(S,k){var E={},A=new Y.Parser(S,k);return E.version=A.parseVersion(),E.ascender=A.parseShort(),E.descender=A.parseShort(),E.lineGap=A.parseShort(),E.advanceWidthMax=A.parseUShort(),E.minLeftSideBearing=A.parseShort(),E.minRightSideBearing=A.parseShort(),E.xMaxExtent=A.parseShort(),E.caretSlopeRise=A.parseShort(),E.caretSlopeRun=A.parseShort(),E.caretOffset=A.parseShort(),A.relativeOffset+=8,E.metricDataFormat=A.parseShort(),E.numberOfHMetrics=A.parseUShort(),E},make:function(S){return new St.Table("hhea",[{name:"version",type:"FIXED",value:65536},{name:"ascender",type:"FWORD",value:0},{name:"descender",type:"FWORD",value:0},{name:"lineGap",type:"FWORD",value:0},{name:"advanceWidthMax",type:"UFWORD",value:0},{name:"minLeftSideBearing",type:"FWORD",value:0},{name:"minRightSideBearing",type:"FWORD",value:0},{name:"xMaxExtent",type:"FWORD",value:0},{name:"caretSlopeRise",type:"SHORT",value:1},{name:"caretSlopeRun",type:"SHORT",value:0},{name:"caretOffset",type:"SHORT",value:0},{name:"reserved1",type:"SHORT",value:0},{name:"reserved2",type:"SHORT",value:0},{name:"reserved3",type:"SHORT",value:0},{name:"reserved4",type:"SHORT",value:0},{name:"metricDataFormat",type:"SHORT",value:0},{name:"numberOfHMetrics",type:"USHORT",value:0}],S)}},_n={parse:function(S,k,E,A,L){for(var V,q,se=new Y.Parser(S,k),ae=0;ae<A;ae+=1){ae<E&&(V=se.parseUShort(),q=se.parseShort());var _e=L.get(ae);_e.advanceWidth=V,_e.leftSideBearing=q}},make:function(S){for(var k=new St.Table("hmtx",[]),E=0;E<S.length;E+=1){var A=S.get(E),L=A.advanceWidth||0,V=A.leftSideBearing||0;k.fields.push({name:"advanceWidth_"+E,type:"USHORT",value:L}),k.fields.push({name:"leftSideBearing_"+E,type:"SHORT",value:V})}return k}},En={make:function(S){for(var k=new St.Table("ltag",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"numTags",type:"ULONG",value:S.length}]),E="",A=12+4*S.length,L=0;L<S.length;++L){var V=E.indexOf(S[L]);V<0&&(V=E.length,E+=S[L]),k.fields.push({name:"offset "+L,type:"USHORT",value:A+V}),k.fields.push({name:"length "+L,type:"USHORT",value:S[L].length})}return k.fields.push({name:"stringPool",type:"CHARARRAY",value:E}),k},parse:function(S,k){var E=new Y.Parser(S,k),A=E.parseULong();ye.argument(A===1,"Unsupported ltag table version."),E.skip("uLong",1);for(var L=E.parseULong(),V=[],q=0;q<L;q++){for(var se="",ae=k+E.parseUShort(),_e=E.parseUShort(),je=ae;je<ae+_e;++je)se+=String.fromCharCode(S.getInt8(je));V.push(se)}return V}},Yn={parse:function(S,k){var E={},A=new Y.Parser(S,k);return E.version=A.parseVersion(),E.numGlyphs=A.parseUShort(),E.version===1&&(E.maxPoints=A.parseUShort(),E.maxContours=A.parseUShort(),E.maxCompositePoints=A.parseUShort(),E.maxCompositeContours=A.parseUShort(),E.maxZones=A.parseUShort(),E.maxTwilightPoints=A.parseUShort(),E.maxStorage=A.parseUShort(),E.maxFunctionDefs=A.parseUShort(),E.maxInstructionDefs=A.parseUShort(),E.maxStackElements=A.parseUShort(),E.maxSizeOfInstructions=A.parseUShort(),E.maxComponentElements=A.parseUShort(),E.maxComponentDepth=A.parseUShort()),E},make:function(S){return new St.Table("maxp",[{name:"version",type:"FIXED",value:20480},{name:"numGlyphs",type:"USHORT",value:S}])}},Cn=["copyright","fontFamily","fontSubfamily","uniqueID","fullName","version","postScriptName","trademark","manufacturer","designer","description","manufacturerURL","designerURL","license","licenseURL","reserved","preferredFamily","preferredSubfamily","compatibleFullName","sampleText","postScriptFindFontName","wwsFamily","wwsSubfamily"],Bt={0:"en",1:"fr",2:"de",3:"it",4:"nl",5:"sv",6:"es",7:"da",8:"pt",9:"no",10:"he",11:"ja",12:"ar",13:"fi",14:"el",15:"is",16:"mt",17:"tr",18:"hr",19:"zh-Hant",20:"ur",21:"hi",22:"th",23:"ko",24:"lt",25:"pl",26:"hu",27:"es",28:"lv",29:"se",30:"fo",31:"fa",32:"ru",33:"zh",34:"nl-BE",35:"ga",36:"sq",37:"ro",38:"cz",39:"sk",40:"si",41:"yi",42:"sr",43:"mk",44:"bg",45:"uk",46:"be",47:"uz",48:"kk",49:"az-Cyrl",50:"az-Arab",51:"hy",52:"ka",53:"mo",54:"ky",55:"tg",56:"tk",57:"mn-CN",58:"mn",59:"ps",60:"ks",61:"ku",62:"sd",63:"bo",64:"ne",65:"sa",66:"mr",67:"bn",68:"as",69:"gu",70:"pa",71:"or",72:"ml",73:"kn",74:"ta",75:"te",76:"si",77:"my",78:"km",79:"lo",80:"vi",81:"id",82:"tl",83:"ms",84:"ms-Arab",85:"am",86:"ti",87:"om",88:"so",89:"sw",90:"rw",91:"rn",92:"ny",93:"mg",94:"eo",128:"cy",129:"eu",130:"ca",131:"la",132:"qu",133:"gn",134:"ay",135:"tt",136:"ug",137:"dz",138:"jv",139:"su",140:"gl",141:"af",142:"br",143:"iu",144:"gd",145:"gv",146:"ga",147:"to",148:"el-polyton",149:"kl",150:"az",151:"nn"},mr={0:0,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:5,11:1,12:4,13:0,14:6,15:0,16:0,17:0,18:0,19:2,20:4,21:9,22:21,23:3,24:29,25:29,26:29,27:29,28:29,29:0,30:0,31:4,32:7,33:25,34:0,35:0,36:0,37:0,38:29,39:29,40:0,41:5,42:7,43:7,44:7,45:7,46:7,47:7,48:7,49:7,50:4,51:24,52:23,53:7,54:7,55:7,56:7,57:27,58:7,59:4,60:4,61:4,62:4,63:26,64:9,65:9,66:9,67:13,68:13,69:11,70:10,71:12,72:17,73:16,74:14,75:15,76:18,77:19,78:20,79:22,80:30,81:0,82:0,83:0,84:4,85:28,86:28,87:28,88:0,89:0,90:0,91:0,92:0,93:0,94:0,128:0,129:0,130:0,131:0,132:0,133:0,134:0,135:7,136:4,137:26,138:0,139:0,140:0,141:0,142:0,143:28,144:0,145:0,146:0,147:0,148:6,149:0,150:0,151:0},an={1078:"af",1052:"sq",1156:"gsw",1118:"am",5121:"ar-DZ",15361:"ar-BH",3073:"ar",2049:"ar-IQ",11265:"ar-JO",13313:"ar-KW",12289:"ar-LB",4097:"ar-LY",6145:"ary",8193:"ar-OM",16385:"ar-QA",1025:"ar-SA",10241:"ar-SY",7169:"aeb",14337:"ar-AE",9217:"ar-YE",1067:"hy",1101:"as",2092:"az-Cyrl",1068:"az",1133:"ba",1069:"eu",1059:"be",2117:"bn",1093:"bn-IN",8218:"bs-Cyrl",5146:"bs",1150:"br",1026:"bg",1027:"ca",3076:"zh-HK",5124:"zh-MO",2052:"zh",4100:"zh-SG",1028:"zh-TW",1155:"co",1050:"hr",4122:"hr-BA",1029:"cs",1030:"da",1164:"prs",1125:"dv",2067:"nl-BE",1043:"nl",3081:"en-AU",10249:"en-BZ",4105:"en-CA",9225:"en-029",16393:"en-IN",6153:"en-IE",8201:"en-JM",17417:"en-MY",5129:"en-NZ",13321:"en-PH",18441:"en-SG",7177:"en-ZA",11273:"en-TT",2057:"en-GB",1033:"en",12297:"en-ZW",1061:"et",1080:"fo",1124:"fil",1035:"fi",2060:"fr-BE",3084:"fr-CA",1036:"fr",5132:"fr-LU",6156:"fr-MC",4108:"fr-CH",1122:"fy",1110:"gl",1079:"ka",3079:"de-AT",1031:"de",5127:"de-LI",4103:"de-LU",2055:"de-CH",1032:"el",1135:"kl",1095:"gu",1128:"ha",1037:"he",1081:"hi",1038:"hu",1039:"is",1136:"ig",1057:"id",1117:"iu",2141:"iu-Latn",2108:"ga",1076:"xh",1077:"zu",1040:"it",2064:"it-CH",1041:"ja",1099:"kn",1087:"kk",1107:"km",1158:"quc",1159:"rw",1089:"sw",1111:"kok",1042:"ko",1088:"ky",1108:"lo",1062:"lv",1063:"lt",2094:"dsb",1134:"lb",1071:"mk",2110:"ms-BN",1086:"ms",1100:"ml",1082:"mt",1153:"mi",1146:"arn",1102:"mr",1148:"moh",1104:"mn",2128:"mn-CN",1121:"ne",1044:"nb",2068:"nn",1154:"oc",1096:"or",1123:"ps",1045:"pl",1046:"pt",2070:"pt-PT",1094:"pa",1131:"qu-BO",2155:"qu-EC",3179:"qu",1048:"ro",1047:"rm",1049:"ru",9275:"smn",4155:"smj-NO",5179:"smj",3131:"se-FI",1083:"se",2107:"se-SE",8251:"sms",6203:"sma-NO",7227:"sms",1103:"sa",7194:"sr-Cyrl-BA",3098:"sr",6170:"sr-Latn-BA",2074:"sr-Latn",1132:"nso",1074:"tn",1115:"si",1051:"sk",1060:"sl",11274:"es-AR",16394:"es-BO",13322:"es-CL",9226:"es-CO",5130:"es-CR",7178:"es-DO",12298:"es-EC",17418:"es-SV",4106:"es-GT",18442:"es-HN",2058:"es-MX",19466:"es-NI",6154:"es-PA",15370:"es-PY",10250:"es-PE",20490:"es-PR",3082:"es",1034:"es",21514:"es-US",14346:"es-UY",8202:"es-VE",2077:"sv-FI",1053:"sv",1114:"syr",1064:"tg",2143:"tzm",1097:"ta",1092:"tt",1098:"te",1054:"th",1105:"bo",1055:"tr",1090:"tk",1152:"ug",1058:"uk",1070:"hsb",1056:"ur",2115:"uz-Cyrl",1091:"uz",1066:"vi",1106:"cy",1160:"wo",1157:"sah",1144:"ii",1130:"yo"};function gs(S,k,E){switch(S){case 0:if(k===65535)return"und";if(E)return E[k];break;case 1:return Bt[k];case 3:return an[k]}}var Xo="utf-16",Ko={0:"macintosh",1:"x-mac-japanese",2:"x-mac-chinesetrad",3:"x-mac-korean",6:"x-mac-greek",7:"x-mac-cyrillic",9:"x-mac-devanagai",10:"x-mac-gurmukhi",11:"x-mac-gujarati",12:"x-mac-oriya",13:"x-mac-bengali",14:"x-mac-tamil",15:"x-mac-telugu",16:"x-mac-kannada",17:"x-mac-malayalam",18:"x-mac-sinhalese",19:"x-mac-burmese",20:"x-mac-khmer",21:"x-mac-thai",22:"x-mac-lao",23:"x-mac-georgian",24:"x-mac-armenian",25:"x-mac-chinesesimp",26:"x-mac-tibetan",27:"x-mac-mongolian",28:"x-mac-ethiopic",29:"x-mac-ce",30:"x-mac-vietnamese",31:"x-mac-extarabic"},Cs={15:"x-mac-icelandic",17:"x-mac-turkish",18:"x-mac-croatian",24:"x-mac-ce",25:"x-mac-ce",26:"x-mac-ce",27:"x-mac-ce",28:"x-mac-ce",30:"x-mac-icelandic",37:"x-mac-romanian",38:"x-mac-ce",39:"x-mac-ce",40:"x-mac-ce",143:"x-mac-inuit",146:"x-mac-gaelic"};function yi(S,k,E){switch(S){case 0:return Xo;case 1:return Cs[E]||Ko[k];case 3:if(k===1||k===10)return Xo}}function Sa(S){var k={};for(var E in S)k[S[E]]=parseInt(E);return k}function Ji(S,k,E,A,L,V){return new St.Record("NameRecord",[{name:"platformID",type:"USHORT",value:S},{name:"encodingID",type:"USHORT",value:k},{name:"languageID",type:"USHORT",value:E},{name:"nameID",type:"USHORT",value:A},{name:"length",type:"USHORT",value:L},{name:"offset",type:"USHORT",value:V}])}function ol(S,k){var E=function(V,q){var se=V.length,ae=q.length-se+1;e:for(var _e=0;_e<ae;_e++)for(;_e<ae;_e++){for(var je=0;je<se;je++)if(q[_e+je]!==V[je])continue e;return _e}return-1}(S,k);if(E<0){E=k.length;for(var A=0,L=S.length;A<L;++A)k.push(S[A])}return E}var ju={parse:function(S,k,E){for(var A={},L=new Y.Parser(S,k),V=L.parseUShort(),q=L.parseUShort(),se=L.offset+L.parseUShort(),ae=0;ae<q;ae++){var _e=L.parseUShort(),je=L.parseUShort(),qe=L.parseUShort(),ge=L.parseUShort(),$t=Cn[ge]||ge,wt=L.parseUShort(),mt=L.parseUShort(),st=gs(_e,qe,E),dt=yi(_e,je,qe);if(dt!==void 0&&st!==void 0){var Zt=void 0;if(Zt=dt===Xo?Oe.UTF16(S,se+mt,wt):Oe.MACSTRING(S,se+mt,wt,dt)){var zt=A[$t];zt===void 0&&(zt=A[$t]={}),zt[st]=Zt}}}return V===1&&L.parseUShort(),A},make:function(S,k){var E,A=[],L={},V=Sa(Cn);for(var q in S){var se=V[q];if(se===void 0&&(se=q),E=parseInt(se),isNaN(E))throw new Error('Name table entry "'+q+'" does not exist, see nameTableNames for complete list.');L[E]=S[q],A.push(E)}for(var ae=Sa(Bt),_e=Sa(an),je=[],qe=[],ge=0;ge<A.length;ge++){var $t=L[E=A[ge]];for(var wt in $t){var mt=$t[wt],st=1,dt=ae[wt],Zt=mr[dt],zt=yi(st,Zt,dt),Bn=Se.MACSTRING(mt,zt);Bn===void 0&&(st=0,(dt=k.indexOf(wt))<0&&(dt=k.length,k.push(wt)),Zt=4,Bn=Se.UTF16(mt));var un=ol(Bn,qe);je.push(Ji(st,Zt,dt,E,Bn.length,un));var yn=_e[wt];if(yn!==void 0){var Or=Se.UTF16(mt),Zn=ol(Or,qe);je.push(Ji(3,1,yn,E,Or.length,Zn))}}}je.sort(function(Ve,it){return Ve.platformID-it.platformID||Ve.encodingID-it.encodingID||Ve.languageID-it.languageID||Ve.nameID-it.nameID});for(var qn=new St.Table("name",[{name:"format",type:"USHORT",value:0},{name:"count",type:"USHORT",value:je.length},{name:"stringOffset",type:"USHORT",value:6+12*je.length}]),Fn=0;Fn<je.length;Fn++)qn.fields.push({name:"record_"+Fn,type:"RECORD",value:je[Fn]});return qn.fields.push({name:"strings",type:"LITERAL",value:qe}),qn}},Ll=[{begin:0,end:127},{begin:128,end:255},{begin:256,end:383},{begin:384,end:591},{begin:592,end:687},{begin:688,end:767},{begin:768,end:879},{begin:880,end:1023},{begin:11392,end:11519},{begin:1024,end:1279},{begin:1328,end:1423},{begin:1424,end:1535},{begin:42240,end:42559},{begin:1536,end:1791},{begin:1984,end:2047},{begin:2304,end:2431},{begin:2432,end:2559},{begin:2560,end:2687},{begin:2688,end:2815},{begin:2816,end:2943},{begin:2944,end:3071},{begin:3072,end:3199},{begin:3200,end:3327},{begin:3328,end:3455},{begin:3584,end:3711},{begin:3712,end:3839},{begin:4256,end:4351},{begin:6912,end:7039},{begin:4352,end:4607},{begin:7680,end:7935},{begin:7936,end:8191},{begin:8192,end:8303},{begin:8304,end:8351},{begin:8352,end:8399},{begin:8400,end:8447},{begin:8448,end:8527},{begin:8528,end:8591},{begin:8592,end:8703},{begin:8704,end:8959},{begin:8960,end:9215},{begin:9216,end:9279},{begin:9280,end:9311},{begin:9312,end:9471},{begin:9472,end:9599},{begin:9600,end:9631},{begin:9632,end:9727},{begin:9728,end:9983},{begin:9984,end:10175},{begin:12288,end:12351},{begin:12352,end:12447},{begin:12448,end:12543},{begin:12544,end:12591},{begin:12592,end:12687},{begin:43072,end:43135},{begin:12800,end:13055},{begin:13056,end:13311},{begin:44032,end:55215},{begin:55296,end:57343},{begin:67840,end:67871},{begin:19968,end:40959},{begin:57344,end:63743},{begin:12736,end:12783},{begin:64256,end:64335},{begin:64336,end:65023},{begin:65056,end:65071},{begin:65040,end:65055},{begin:65104,end:65135},{begin:65136,end:65279},{begin:65280,end:65519},{begin:65520,end:65535},{begin:3840,end:4095},{begin:1792,end:1871},{begin:1920,end:1983},{begin:3456,end:3583},{begin:4096,end:4255},{begin:4608,end:4991},{begin:5024,end:5119},{begin:5120,end:5759},{begin:5760,end:5791},{begin:5792,end:5887},{begin:6016,end:6143},{begin:6144,end:6319},{begin:10240,end:10495},{begin:40960,end:42127},{begin:5888,end:5919},{begin:66304,end:66351},{begin:66352,end:66383},{begin:66560,end:66639},{begin:118784,end:119039},{begin:119808,end:120831},{begin:1044480,end:1048573},{begin:65024,end:65039},{begin:917504,end:917631},{begin:6400,end:6479},{begin:6480,end:6527},{begin:6528,end:6623},{begin:6656,end:6687},{begin:11264,end:11359},{begin:11568,end:11647},{begin:19904,end:19967},{begin:43008,end:43055},{begin:65536,end:65663},{begin:65856,end:65935},{begin:66432,end:66463},{begin:66464,end:66527},{begin:66640,end:66687},{begin:66688,end:66735},{begin:67584,end:67647},{begin:68096,end:68191},{begin:119552,end:119647},{begin:73728,end:74751},{begin:119648,end:119679},{begin:7040,end:7103},{begin:7168,end:7247},{begin:7248,end:7295},{begin:43136,end:43231},{begin:43264,end:43311},{begin:43312,end:43359},{begin:43520,end:43615},{begin:65936,end:65999},{begin:66e3,end:66047},{begin:66208,end:66271},{begin:127024,end:127135}],_a={parse:function(S,k){var E={},A=new Y.Parser(S,k);E.version=A.parseUShort(),E.xAvgCharWidth=A.parseShort(),E.usWeightClass=A.parseUShort(),E.usWidthClass=A.parseUShort(),E.fsType=A.parseUShort(),E.ySubscriptXSize=A.parseShort(),E.ySubscriptYSize=A.parseShort(),E.ySubscriptXOffset=A.parseShort(),E.ySubscriptYOffset=A.parseShort(),E.ySuperscriptXSize=A.parseShort(),E.ySuperscriptYSize=A.parseShort(),E.ySuperscriptXOffset=A.parseShort(),E.ySuperscriptYOffset=A.parseShort(),E.yStrikeoutSize=A.parseShort(),E.yStrikeoutPosition=A.parseShort(),E.sFamilyClass=A.parseShort(),E.panose=[];for(var L=0;L<10;L++)E.panose[L]=A.parseByte();return E.ulUnicodeRange1=A.parseULong(),E.ulUnicodeRange2=A.parseULong(),E.ulUnicodeRange3=A.parseULong(),E.ulUnicodeRange4=A.parseULong(),E.achVendID=String.fromCharCode(A.parseByte(),A.parseByte(),A.parseByte(),A.parseByte()),E.fsSelection=A.parseUShort(),E.usFirstCharIndex=A.parseUShort(),E.usLastCharIndex=A.parseUShort(),E.sTypoAscender=A.parseShort(),E.sTypoDescender=A.parseShort(),E.sTypoLineGap=A.parseShort(),E.usWinAscent=A.parseUShort(),E.usWinDescent=A.parseUShort(),1<=E.version&&(E.ulCodePageRange1=A.parseULong(),E.ulCodePageRange2=A.parseULong()),2<=E.version&&(E.sxHeight=A.parseShort(),E.sCapHeight=A.parseShort(),E.usDefaultChar=A.parseUShort(),E.usBreakChar=A.parseUShort(),E.usMaxContent=A.parseUShort()),E},make:function(S){return new St.Table("OS/2",[{name:"version",type:"USHORT",value:3},{name:"xAvgCharWidth",type:"SHORT",value:0},{name:"usWeightClass",type:"USHORT",value:0},{name:"usWidthClass",type:"USHORT",value:0},{name:"fsType",type:"USHORT",value:0},{name:"ySubscriptXSize",type:"SHORT",value:650},{name:"ySubscriptYSize",type:"SHORT",value:699},{name:"ySubscriptXOffset",type:"SHORT",value:0},{name:"ySubscriptYOffset",type:"SHORT",value:140},{name:"ySuperscriptXSize",type:"SHORT",value:650},{name:"ySuperscriptYSize",type:"SHORT",value:699},{name:"ySuperscriptXOffset",type:"SHORT",value:0},{name:"ySuperscriptYOffset",type:"SHORT",value:479},{name:"yStrikeoutSize",type:"SHORT",value:49},{name:"yStrikeoutPosition",type:"SHORT",value:258},{name:"sFamilyClass",type:"SHORT",value:0},{name:"bFamilyType",type:"BYTE",value:0},{name:"bSerifStyle",type:"BYTE",value:0},{name:"bWeight",type:"BYTE",value:0},{name:"bProportion",type:"BYTE",value:0},{name:"bContrast",type:"BYTE",value:0},{name:"bStrokeVariation",type:"BYTE",value:0},{name:"bArmStyle",type:"BYTE",value:0},{name:"bLetterform",type:"BYTE",value:0},{name:"bMidline",type:"BYTE",value:0},{name:"bXHeight",type:"BYTE",value:0},{name:"ulUnicodeRange1",type:"ULONG",value:0},{name:"ulUnicodeRange2",type:"ULONG",value:0},{name:"ulUnicodeRange3",type:"ULONG",value:0},{name:"ulUnicodeRange4",type:"ULONG",value:0},{name:"achVendID",type:"CHARARRAY",value:"XXXX"},{name:"fsSelection",type:"USHORT",value:0},{name:"usFirstCharIndex",type:"USHORT",value:0},{name:"usLastCharIndex",type:"USHORT",value:0},{name:"sTypoAscender",type:"SHORT",value:0},{name:"sTypoDescender",type:"SHORT",value:0},{name:"sTypoLineGap",type:"SHORT",value:0},{name:"usWinAscent",type:"USHORT",value:0},{name:"usWinDescent",type:"USHORT",value:0},{name:"ulCodePageRange1",type:"ULONG",value:0},{name:"ulCodePageRange2",type:"ULONG",value:0},{name:"sxHeight",type:"SHORT",value:0},{name:"sCapHeight",type:"SHORT",value:0},{name:"usDefaultChar",type:"USHORT",value:0},{name:"usBreakChar",type:"USHORT",value:0},{name:"usMaxContext",type:"USHORT",value:0}],S)},unicodeRanges:Ll,getUnicodeRange:function(S){for(var k=0;k<Ll.length;k+=1){var E=Ll[k];if(S>=E.begin&&S<E.end)return k}return-1}},Bu={parse:function(S,k){var E={},A=new Y.Parser(S,k);switch(E.version=A.parseVersion(),E.italicAngle=A.parseFixed(),E.underlinePosition=A.parseShort(),E.underlineThickness=A.parseShort(),E.isFixedPitch=A.parseULong(),E.minMemType42=A.parseULong(),E.maxMemType42=A.parseULong(),E.minMemType1=A.parseULong(),E.maxMemType1=A.parseULong(),E.version){case 1:E.names=Ke.slice();break;case 2:E.numberOfGlyphs=A.parseUShort(),E.glyphNameIndex=new Array(E.numberOfGlyphs);for(var L=0;L<E.numberOfGlyphs;L++)E.glyphNameIndex[L]=A.parseUShort();E.names=[];for(var V=0;V<E.numberOfGlyphs;V++)if(E.glyphNameIndex[V]>=Ke.length){var q=A.parseChar();E.names.push(A.parseString(q))}break;case 2.5:E.numberOfGlyphs=A.parseUShort(),E.offset=new Array(E.numberOfGlyphs);for(var se=0;se<E.numberOfGlyphs;se++)E.offset[se]=A.parseChar()}return E},make:function(){return new St.Table("post",[{name:"version",type:"FIXED",value:196608},{name:"italicAngle",type:"FIXED",value:0},{name:"underlinePosition",type:"FWORD",value:0},{name:"underlineThickness",type:"FWORD",value:0},{name:"isFixedPitch",type:"ULONG",value:0},{name:"minMemType42",type:"ULONG",value:0},{name:"maxMemType42",type:"ULONG",value:0},{name:"minMemType1",type:"ULONG",value:0},{name:"maxMemType1",type:"ULONG",value:0}])}},Bs=new Array(9);Bs[1]=function(){var S=this.offset+this.relativeOffset,k=this.parseUShort();return k===1?{substFormat:1,coverage:this.parsePointer(Be.coverage),deltaGlyphId:this.parseUShort()}:k===2?{substFormat:2,coverage:this.parsePointer(Be.coverage),substitute:this.parseOffset16List()}:void ye.assert(!1,"0x"+S.toString(16)+": lookup type 1 format must be 1 or 2.")},Bs[2]=function(){var S=this.parseUShort();return ye.argument(S===1,"GSUB Multiple Substitution Subtable identifier-format must be 1"),{substFormat:S,coverage:this.parsePointer(Be.coverage),sequences:this.parseListOfLists()}},Bs[3]=function(){var S=this.parseUShort();return ye.argument(S===1,"GSUB Alternate Substitution Subtable identifier-format must be 1"),{substFormat:S,coverage:this.parsePointer(Be.coverage),alternateSets:this.parseListOfLists()}},Bs[4]=function(){var S=this.parseUShort();return ye.argument(S===1,"GSUB ligature table identifier-format must be 1"),{substFormat:S,coverage:this.parsePointer(Be.coverage),ligatureSets:this.parseListOfLists(function(){return{ligGlyph:this.parseUShort(),components:this.parseUShortList(this.parseUShort()-1)}})}};var Io={sequenceIndex:Be.uShort,lookupListIndex:Be.uShort};Bs[5]=function(){var S=this.offset+this.relativeOffset,k=this.parseUShort();if(k===1)return{substFormat:k,coverage:this.parsePointer(Be.coverage),ruleSets:this.parseListOfLists(function(){var L=this.parseUShort(),V=this.parseUShort();return{input:this.parseUShortList(L-1),lookupRecords:this.parseRecordList(V,Io)}})};if(k===2)return{substFormat:k,coverage:this.parsePointer(Be.coverage),classDef:this.parsePointer(Be.classDef),classSets:this.parseListOfLists(function(){var L=this.parseUShort(),V=this.parseUShort();return{classes:this.parseUShortList(L-1),lookupRecords:this.parseRecordList(V,Io)}})};if(k===3){var E=this.parseUShort(),A=this.parseUShort();return{substFormat:k,coverages:this.parseList(E,Be.pointer(Be.coverage)),lookupRecords:this.parseRecordList(A,Io)}}ye.assert(!1,"0x"+S.toString(16)+": lookup type 5 format must be 1, 2 or 3.")},Bs[6]=function(){var S=this.offset+this.relativeOffset,k=this.parseUShort();return k===1?{substFormat:1,coverage:this.parsePointer(Be.coverage),chainRuleSets:this.parseListOfLists(function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(Io)}})}:k===2?{substFormat:2,coverage:this.parsePointer(Be.coverage),backtrackClassDef:this.parsePointer(Be.classDef),inputClassDef:this.parsePointer(Be.classDef),lookaheadClassDef:this.parsePointer(Be.classDef),chainClassSet:this.parseListOfLists(function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(Io)}})}:k===3?{substFormat:3,backtrackCoverage:this.parseList(Be.pointer(Be.coverage)),inputCoverage:this.parseList(Be.pointer(Be.coverage)),lookaheadCoverage:this.parseList(Be.pointer(Be.coverage)),lookupRecords:this.parseRecordList(Io)}:void ye.assert(!1,"0x"+S.toString(16)+": lookup type 6 format must be 1, 2 or 3.")},Bs[7]=function(){var S=this.parseUShort();ye.argument(S===1,"GSUB Extension Substitution subtable identifier-format must be 1");var k=this.parseUShort(),E=new Be(this.data,this.offset+this.parseULong());return{substFormat:1,lookupType:k,extension:Bs[k].call(E)}},Bs[8]=function(){var S=this.parseUShort();return ye.argument(S===1,"GSUB Reverse Chaining Contextual Single Substitution Subtable identifier-format must be 1"),{substFormat:S,coverage:this.parsePointer(Be.coverage),backtrackCoverage:this.parseList(Be.pointer(Be.coverage)),lookaheadCoverage:this.parseList(Be.pointer(Be.coverage)),substitutes:this.parseUShortList()}};var Yr=new Array(9);Yr[1]=function(S){return S.substFormat===1?new St.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new St.Coverage(S.coverage)},{name:"deltaGlyphID",type:"USHORT",value:S.deltaGlyphId}]):new St.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:2},{name:"coverage",type:"TABLE",value:new St.Coverage(S.coverage)}].concat(St.ushortList("substitute",S.substitute)))},Yr[3]=function(S){return ye.assert(S.substFormat===1,"Lookup type 3 substFormat must be 1."),new St.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new St.Coverage(S.coverage)}].concat(St.tableList("altSet",S.alternateSets,function(k){return new St.Table("alternateSetTable",St.ushortList("alternate",k))})))},Yr[4]=function(S){return ye.assert(S.substFormat===1,"Lookup type 4 substFormat must be 1."),new St.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new St.Coverage(S.coverage)}].concat(St.tableList("ligSet",S.ligatureSets,function(k){return new St.Table("ligatureSetTable",St.tableList("ligature",k,function(E){return new St.Table("ligatureTable",[{name:"ligGlyph",type:"USHORT",value:E.ligGlyph}].concat(St.ushortList("component",E.components,E.components.length+1)))}))})))};var Uu={parse:function(S,k){var E=new Be(S,k=k||0),A=E.parseVersion(1);return ye.argument(A===1||A===1.1,"Unsupported GSUB table version."),A===1?{version:A,scripts:E.parseScriptList(),features:E.parseFeatureList(),lookups:E.parseLookupList(Bs)}:{version:A,scripts:E.parseScriptList(),features:E.parseFeatureList(),lookups:E.parseLookupList(Bs),variations:E.parseFeatureVariationsList()}},make:function(S){return new St.Table("GSUB",[{name:"version",type:"ULONG",value:65536},{name:"scripts",type:"TABLE",value:new St.ScriptList(S.scripts)},{name:"features",type:"TABLE",value:new St.FeatureList(S.features)},{name:"lookups",type:"TABLE",value:new St.LookupList(S.lookups,Yr)}])}},Pl={parse:function(S,k){var E=new Y.Parser(S,k),A=E.parseULong();ye.argument(A===1,"Unsupported META table version."),E.parseULong(),E.parseULong();for(var L=E.parseULong(),V={},q=0;q<L;q++){var se=E.parseTag(),ae=E.parseULong(),_e=E.parseULong(),je=Oe.UTF8(S,k+ae,_e);V[se]=je}return V},make:function(S){var k=Object.keys(S).length,E="",A=16+12*k,L=new St.Table("meta",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"offset",type:"ULONG",value:A},{name:"numTags",type:"ULONG",value:k}]);for(var V in S){var q=E.length;E+=S[V],L.fields.push({name:"tag "+V,type:"TAG",value:V}),L.fields.push({name:"offset "+V,type:"ULONG",value:A+q}),L.fields.push({name:"length "+V,type:"ULONG",value:S[V].length})}return L.fields.push({name:"stringPool",type:"CHARARRAY",value:E}),L}};function Ta(S){return Math.log(S)/Math.log(2)|0}function ka(S){for(;S.length%4!=0;)S.push(0);for(var k=0,E=0;E<S.length;E+=4)k+=(S[E]<<24)+(S[E+1]<<16)+(S[E+2]<<8)+S[E+3];return k%=Math.pow(2,32)}function zu(S,k,E,A){return new St.Record("Table Record",[{name:"tag",type:"TAG",value:S!==void 0?S:""},{name:"checkSum",type:"ULONG",value:k!==void 0?k:0},{name:"offset",type:"ULONG",value:E!==void 0?E:0},{name:"length",type:"ULONG",value:A!==void 0?A:0}])}function Vu(S){var k=new St.Table("sfnt",[{name:"version",type:"TAG",value:"OTTO"},{name:"numTables",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);k.tables=S,k.numTables=S.length;var E=Math.pow(2,Ta(k.numTables));k.searchRange=16*E,k.entrySelector=Ta(E),k.rangeShift=16*k.numTables-k.searchRange;for(var A=[],L=[],V=k.sizeOf()+zu().sizeOf()*k.numTables;V%4!=0;)V+=1,L.push({name:"padding",type:"BYTE",value:0});for(var q=0;q<S.length;q+=1){var se=S[q];ye.argument(se.tableName.length===4,"Table name"+se.tableName+" is invalid.");var ae=se.sizeOf(),_e=zu(se.tableName,ka(se.encode()),V,ae);for(A.push({name:_e.tag+" Table Record",type:"RECORD",value:_e}),L.push({name:se.tableName+" table",type:"RECORD",value:se}),V+=ae,ye.argument(!isNaN(V),"Something went wrong calculating the offset.");V%4!=0;)V+=1,L.push({name:"padding",type:"BYTE",value:0})}return A.sort(function(je,qe){return je.value.tag>qe.value.tag?1:-1}),k.fields=k.fields.concat(A),k.fields=k.fields.concat(L),k}function jl(S,k,E){for(var A=0;A<k.length;A+=1){var L=S.charToGlyphIndex(k[A]);if(0<L)return S.glyphs.get(L).getMetrics()}return E}var Bl={make:Vu,fontToTable:function(S){for(var k,E=[],A=[],L=[],V=[],q=[],se=[],ae=[],_e=0,je=0,qe=0,ge=0,$t=0,wt=0;wt<S.glyphs.length;wt+=1){var mt=S.glyphs.get(wt),st=0|mt.unicode;if(isNaN(mt.advanceWidth))throw new Error("Glyph "+mt.name+" ("+wt+"): advanceWidth is not a number.");(st<k||k===void 0)&&0<st&&(k=st),_e<st&&(_e=st);var dt=_a.getUnicodeRange(st);if(dt<32)je|=1<<dt;else if(dt<64)qe|=1<<dt-32;else if(dt<96)ge|=1<<dt-64;else{if(!(dt<123))throw new Error("Unicode ranges bits > 123 are reserved for internal usage");$t|=1<<dt-96}if(mt.name!==".notdef"){var Zt=mt.getMetrics();E.push(Zt.xMin),A.push(Zt.yMin),L.push(Zt.xMax),V.push(Zt.yMax),se.push(Zt.leftSideBearing),ae.push(Zt.rightSideBearing),q.push(mt.advanceWidth)}}var zt={xMin:Math.min.apply(null,E),yMin:Math.min.apply(null,A),xMax:Math.max.apply(null,L),yMax:Math.max.apply(null,V),advanceWidthMax:Math.max.apply(null,q),advanceWidthAvg:function(Hl){for(var jd=0,ql=0;ql<Hl.length;ql+=1)jd+=Hl[ql];return jd/Hl.length}(q),minLeftSideBearing:Math.min.apply(null,se),maxLeftSideBearing:Math.max.apply(null,se),minRightSideBearing:Math.min.apply(null,ae)};zt.ascender=S.ascender,zt.descender=S.descender;var Bn=Xt.make({flags:3,unitsPerEm:S.unitsPerEm,xMin:zt.xMin,yMin:zt.yMin,xMax:zt.xMax,yMax:zt.yMax,lowestRecPPEM:3,createdTimestamp:S.createdTimestamp}),un=yt.make({ascender:zt.ascender,descender:zt.descender,advanceWidthMax:zt.advanceWidthMax,minLeftSideBearing:zt.minLeftSideBearing,minRightSideBearing:zt.minRightSideBearing,xMaxExtent:zt.maxLeftSideBearing+(zt.xMax-zt.xMin),numberOfHMetrics:S.glyphs.length}),yn=Yn.make(S.glyphs.length),Or=_a.make({xAvgCharWidth:Math.round(zt.advanceWidthAvg),usWeightClass:S.tables.os2.usWeightClass,usWidthClass:S.tables.os2.usWidthClass,usFirstCharIndex:k,usLastCharIndex:_e,ulUnicodeRange1:je,ulUnicodeRange2:qe,ulUnicodeRange3:ge,ulUnicodeRange4:$t,fsSelection:S.tables.os2.fsSelection,sTypoAscender:zt.ascender,sTypoDescender:zt.descender,sTypoLineGap:0,usWinAscent:zt.yMax,usWinDescent:Math.abs(zt.yMin),ulCodePageRange1:1,sxHeight:jl(S,"xyvw",{yMax:Math.round(zt.ascender/2)}).yMax,sCapHeight:jl(S,"HIKLEFJMNTZBDPRAGOQSUVWXY",zt).yMax,usDefaultChar:S.hasChar(" ")?32:0,usBreakChar:S.hasChar(" ")?32:0}),Zn=_n.make(S.glyphs),qn=le.make(S.glyphs),Fn=S.getEnglishName("fontFamily"),Ve=S.getEnglishName("fontSubfamily"),it=Fn+" "+Ve,nt=S.getEnglishName("postScriptName");nt=nt||Fn.replace(/\s/g,"")+"-"+Ve;var Ot={};for(var Ht in S.names)Ot[Ht]=S.names[Ht];Ot.uniqueID||(Ot.uniqueID={en:S.getEnglishName("manufacturer")+":"+it}),Ot.postScriptName||(Ot.postScriptName={en:nt}),Ot.preferredFamily||(Ot.preferredFamily=S.names.fontFamily),Ot.preferredSubfamily||(Ot.preferredSubfamily=S.names.fontSubfamily);var vn=[],$n=ju.make(Ot,vn),Tn=0<vn.length?En.make(vn):void 0,Qn=Bu.make(),Xr=kt.make(S.glyphs,{version:S.getEnglishName("version"),fullName:it,familyName:Fn,weightName:Ve,postScriptName:nt,unitsPerEm:S.unitsPerEm,fontBBox:[0,zt.yMin,zt.ascender,zt.advanceWidthMax]}),Vn=S.metas&&0<Object.keys(S.metas).length?Pl.make(S.metas):void 0,fr=[Bn,un,yn,Or,$n,qn,Qn,Xr,Zn];Tn&&fr.push(Tn),S.tables.gsub&&fr.push(Uu.make(S.tables.gsub)),Vn&&fr.push(Vn);for(var Si=Vu(fr),ri=ka(Si.encode()),_i=Si.fields,zs=!1,Jn=0;Jn<_i.length;Jn+=1)if(_i[Jn].name==="head table"){_i[Jn].value.checkSumAdjustment=2981146554-ri,zs=!0;break}if(!zs)throw new Error("Could not find head table with checkSum to adjust.");return Si},computeCheckSum:ka};function Yo(S,k){for(var E=0,A=S.length-1;E<=A;){var L=E+A>>>1,V=S[L].tag;if(V===k)return L;V<k?E=1+L:A=L-1}return-E-1}function Ia(S,k){for(var E=0,A=S.length-1;E<=A;){var L=E+A>>>1,V=S[L];if(V===k)return L;V<k?E=1+L:A=L-1}return-E-1}function Ul(S,k){for(var E,A=0,L=S.length-1;A<=L;){var V=A+L>>>1,q=(E=S[V]).start;if(q===k)return E;q<k?A=1+V:L=V-1}if(0<A)return k>(E=S[A-1]).end?0:E}function il(S,k){this.font=S,this.tableName=k}function Zo(S){il.call(this,S,"gpos")}function fo(S){il.call(this,S,"gsub")}function ah(S,k){var E=S.length;if(E!==k.length)return!1;for(var A=0;A<E;A++)if(S[A]!==k[A])return!1;return!0}function Gu(S,k,E){for(var A=S.subtables,L=0;L<A.length;L++){var V=A[L];if(V.substFormat===k)return V}if(E)return A.push(E),E}function lh(S){for(var k=new ArrayBuffer(S.length),E=new Uint8Array(k),A=0;A<S.length;++A)E[A]=S[A];return k}function vi(S,k){if(!S)throw k}function Ea(S,k,E,A,L){var V;return V=0<(k&A)?(V=S.parseByte(),(k&L)==0&&(V=-V),E+V):0<(k&L)?E:E+S.parseShort()}function uh(S,k,E){var A,L,V=new Y.Parser(k,E);if(S.numberOfContours=V.parseShort(),S._xMin=V.parseShort(),S._yMin=V.parseShort(),S._xMax=V.parseShort(),S._yMax=V.parseShort(),0<S.numberOfContours){for(var q=S.endPointIndices=[],se=0;se<S.numberOfContours;se+=1)q.push(V.parseUShort());S.instructionLength=V.parseUShort(),S.instructions=[];for(var ae=0;ae<S.instructionLength;ae+=1)S.instructions.push(V.parseByte());var _e=q[q.length-1]+1;A=[];for(var je=0;je<_e;je+=1)if(L=V.parseByte(),A.push(L),0<(8&L))for(var qe=V.parseByte(),ge=0;ge<qe;ge+=1)A.push(L),je+=1;if(ye.argument(A.length===_e,"Bad flags."),0<q.length){var $t,wt=[];if(0<_e){for(var mt=0;mt<_e;mt+=1)L=A[mt],($t={}).onCurve=!!(1&L),$t.lastPointOfContour=0<=q.indexOf(mt),wt.push($t);for(var st=0,dt=0;dt<_e;dt+=1)L=A[dt],($t=wt[dt]).x=Ea(V,L,st,2,16),st=$t.x;for(var Zt=0,zt=0;zt<_e;zt+=1)L=A[zt],($t=wt[zt]).y=Ea(V,L,Zt,4,32),Zt=$t.y}S.points=wt}else S.points=[]}else if(S.numberOfContours===0)S.points=[];else{S.isComposite=!0,S.points=[],S.components=[];for(var Bn=!0;Bn;){A=V.parseUShort();var un={glyphIndex:V.parseUShort(),xScale:1,scale01:0,scale10:0,yScale:1,dx:0,dy:0};0<(1&A)?0<(2&A)?(un.dx=V.parseShort(),un.dy=V.parseShort()):un.matchedPoints=[V.parseUShort(),V.parseUShort()]:0<(2&A)?(un.dx=V.parseChar(),un.dy=V.parseChar()):un.matchedPoints=[V.parseByte(),V.parseByte()],0<(8&A)?un.xScale=un.yScale=V.parseF2Dot14():0<(64&A)?(un.xScale=V.parseF2Dot14(),un.yScale=V.parseF2Dot14()):0<(128&A)&&(un.xScale=V.parseF2Dot14(),un.scale01=V.parseF2Dot14(),un.scale10=V.parseF2Dot14(),un.yScale=V.parseF2Dot14()),S.components.push(un),Bn=!!(32&A)}if(256&A){S.instructionLength=V.parseUShort(),S.instructions=[];for(var yn=0;yn<S.instructionLength;yn+=1)S.instructions.push(V.parseByte())}}}function Wu(S,k){for(var E=[],A=0;A<S.length;A+=1){var L=S[A],V={x:k.xScale*L.x+k.scale01*L.y+k.dx,y:k.scale10*L.x+k.yScale*L.y+k.dy,onCurve:L.onCurve,lastPointOfContour:L.lastPointOfContour};E.push(V)}return E}function ch(S){var k=new ce;if(!S)return k;for(var E=function(qe){for(var ge=[],$t=[],wt=0;wt<qe.length;wt+=1){var mt=qe[wt];$t.push(mt),mt.lastPointOfContour&&(ge.push($t),$t=[])}return ye.argument($t.length===0,"There are still points left in the current contour."),ge}(S),A=0;A<E.length;++A){var L=E[A],V=null,q=L[L.length-1],se=L[0];if(q.onCurve)k.moveTo(q.x,q.y);else if(se.onCurve)k.moveTo(se.x,se.y);else{var ae={x:.5*(q.x+se.x),y:.5*(q.y+se.y)};k.moveTo(ae.x,ae.y)}for(var _e=0;_e<L.length;++_e)if(V=q,q=se,se=L[(_e+1)%L.length],q.onCurve)k.lineTo(q.x,q.y);else{var je=se;V.onCurve||(.5*(q.x+V.x),.5*(q.y+V.y)),se.onCurve||(je={x:.5*(q.x+se.x),y:.5*(q.y+se.y)}),k.quadraticCurveTo(q.x,q.y,je.x,je.y)}k.closePath()}return k}function Ld(S,k){if(k.isComposite)for(var E=0;E<k.components.length;E+=1){var A=k.components[E],L=S.get(A.glyphIndex);if(L.getPath(),L.points){var V=void 0;if(A.matchedPoints===void 0)V=Wu(L.points,A);else{if(A.matchedPoints[0]>k.points.length-1||A.matchedPoints[1]>L.points.length-1)throw Error("Matched points out of range in "+k.name);var q=k.points[A.matchedPoints[0]],se=L.points[A.matchedPoints[1]],ae={xScale:A.xScale,scale01:A.scale01,scale10:A.scale10,yScale:A.yScale,dx:0,dy:0};se=Wu([se],ae)[0],ae.dx=q.x-se.x,ae.dy=q.y-se.y,V=Wu(L.points,ae)}k.points=k.points.concat(V)}}return ch(k.points)}(Zo.prototype=il.prototype={searchTag:Yo,binSearch:Ia,getTable:function(S){var k=this.font.tables[this.tableName];return!k&&S&&(k=this.font.tables[this.tableName]=this.createDefaultTable()),k},getScriptNames:function(){var S=this.getTable();return S?S.scripts.map(function(k){return k.tag}):[]},getDefaultScriptName:function(){var S=this.getTable();if(S){for(var k=!1,E=0;E<S.scripts.length;E++){var A=S.scripts[E].tag;if(A==="DFLT")return A;A==="latn"&&(k=!0)}return k?"latn":void 0}},getScriptTable:function(S,k){var E=this.getTable(k);if(E){S=S||"DFLT";var A=E.scripts,L=Yo(E.scripts,S);if(0<=L)return A[L].script;if(k){var V={tag:S,script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}};return A.splice(-1-L,0,V),V.script}}},getLangSysTable:function(S,k,E){var A=this.getScriptTable(S,E);if(A){if(!k||k==="dflt"||k==="DFLT")return A.defaultLangSys;var L=Yo(A.langSysRecords,k);if(0<=L)return A.langSysRecords[L].langSys;if(E){var V={tag:k,langSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]}};return A.langSysRecords.splice(-1-L,0,V),V.langSys}}},getFeatureTable:function(S,k,E,A){var L=this.getLangSysTable(S,k,A);if(L){for(var V,q=L.featureIndexes,se=this.font.tables[this.tableName].features,ae=0;ae<q.length;ae++)if((V=se[q[ae]]).tag===E)return V.feature;if(A){var _e=se.length;return ye.assert(_e===0||E>=se[_e-1].tag,"Features must be added in alphabetical order."),V={tag:E,feature:{params:0,lookupListIndexes:[]}},se.push(V),q.push(_e),V.feature}}},getLookupTables:function(S,k,E,A,L){var V=this.getFeatureTable(S,k,E,L),q=[];if(V){for(var se,ae=V.lookupListIndexes,_e=this.font.tables[this.tableName].lookups,je=0;je<ae.length;je++)(se=_e[ae[je]]).lookupType===A&&q.push(se);if(q.length===0&&L){se={lookupType:A,lookupFlag:0,subtables:[],markFilteringSet:void 0};var qe=_e.length;return _e.push(se),ae.push(qe),[se]}}return q},getGlyphClass:function(S,k){switch(S.format){case 1:return S.startGlyph<=k&&k<S.startGlyph+S.classes.length?S.classes[k-S.startGlyph]:0;case 2:var E=Ul(S.ranges,k);return E?E.classId:0}},getCoverageIndex:function(S,k){switch(S.format){case 1:var E=Ia(S.glyphs,k);return 0<=E?E:-1;case 2:var A=Ul(S.ranges,k);return A?A.index+k-A.start:-1}},expandCoverage:function(S){if(S.format===1)return S.glyphs;for(var k=[],E=S.ranges,A=0;A<E.length;A++)for(var L=E[A],V=L.start,q=L.end,se=V;se<=q;se++)k.push(se);return k}}).init=function(){var S=this.getDefaultScriptName();this.defaultKerningTables=this.getKerningTables(S)},Zo.prototype.getKerningValue=function(S,k,E){for(var A=0;A<S.length;A++)for(var L=S[A].subtables,V=0;V<L.length;V++){var q=L[V],se=this.getCoverageIndex(q.coverage,k);if(!(se<0))switch(q.posFormat){case 1:for(var ae=q.pairSets[se],_e=0;_e<ae.length;_e++){var je=ae[_e];if(je.secondGlyph===E)return je.value1&&je.value1.xAdvance||0}break;case 2:var qe=this.getGlyphClass(q.classDef1,k),ge=this.getGlyphClass(q.classDef2,E),$t=q.classRecords[qe][ge];return $t.value1&&$t.value1.xAdvance||0}}return 0},Zo.prototype.getKerningTables=function(S,k){if(this.font.tables.gpos)return this.getLookupTables(S,k,"kern",2)},(fo.prototype=il.prototype).createDefaultTable=function(){return{version:1,scripts:[{tag:"DFLT",script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}}],features:[],lookups:[]}},fo.prototype.getSingle=function(S,k,E){for(var A=[],L=this.getLookupTables(k,E,S,1),V=0;V<L.length;V++)for(var q=L[V].subtables,se=0;se<q.length;se++){var ae=q[se],_e=this.expandCoverage(ae.coverage),je=void 0;if(ae.substFormat===1){var qe=ae.deltaGlyphId;for(je=0;je<_e.length;je++){var ge=_e[je];A.push({sub:ge,by:ge+qe})}}else{var $t=ae.substitute;for(je=0;je<_e.length;je++)A.push({sub:_e[je],by:$t[je]})}}return A},fo.prototype.getAlternates=function(S,k,E){for(var A=[],L=this.getLookupTables(k,E,S,3),V=0;V<L.length;V++)for(var q=L[V].subtables,se=0;se<q.length;se++)for(var ae=q[se],_e=this.expandCoverage(ae.coverage),je=ae.alternateSets,qe=0;qe<_e.length;qe++)A.push({sub:_e[qe],by:je[qe]});return A},fo.prototype.getLigatures=function(S,k,E){for(var A=[],L=this.getLookupTables(k,E,S,4),V=0;V<L.length;V++)for(var q=L[V].subtables,se=0;se<q.length;se++)for(var ae=q[se],_e=this.expandCoverage(ae.coverage),je=ae.ligatureSets,qe=0;qe<_e.length;qe++)for(var ge=_e[qe],$t=je[qe],wt=0;wt<$t.length;wt++){var mt=$t[wt];A.push({sub:[ge].concat(mt.components),by:mt.ligGlyph})}return A},fo.prototype.addSingle=function(S,k,E,A){var L=Gu(this.getLookupTables(E,A,S,1,!0)[0],2,{substFormat:2,coverage:{format:1,glyphs:[]},substitute:[]});ye.assert(L.coverage.format===1,"Ligature: unable to modify coverage table format "+L.coverage.format);var V=k.sub,q=this.binSearch(L.coverage.glyphs,V);q<0&&(q=-1-q,L.coverage.glyphs.splice(q,0,V),L.substitute.splice(q,0,0)),L.substitute[q]=k.by},fo.prototype.addAlternate=function(S,k,E,A){var L=Gu(this.getLookupTables(E,A,S,3,!0)[0],1,{substFormat:1,coverage:{format:1,glyphs:[]},alternateSets:[]});ye.assert(L.coverage.format===1,"Ligature: unable to modify coverage table format "+L.coverage.format);var V=k.sub,q=this.binSearch(L.coverage.glyphs,V);q<0&&(q=-1-q,L.coverage.glyphs.splice(q,0,V),L.alternateSets.splice(q,0,0)),L.alternateSets[q]=k.by},fo.prototype.addLigature=function(S,k,E,A){var L=this.getLookupTables(E,A,S,4,!0)[0],V=L.subtables[0];V||(V={substFormat:1,coverage:{format:1,glyphs:[]},ligatureSets:[]},L.subtables[0]=V),ye.assert(V.coverage.format===1,"Ligature: unable to modify coverage table format "+V.coverage.format);var q=k.sub[0],se=k.sub.slice(1),ae={ligGlyph:k.by,components:se},_e=this.binSearch(V.coverage.glyphs,q);if(0<=_e){for(var je=V.ligatureSets[_e],qe=0;qe<je.length;qe++)if(ah(je[qe].components,se))return;je.push(ae)}else _e=-1-_e,V.coverage.glyphs.splice(_e,0,q),V.ligatureSets.splice(_e,0,[ae])},fo.prototype.getFeature=function(S,k,E){if(/ss\d\d/.test(S))return this.getSingle(S,k,E);switch(S){case"aalt":case"salt":return this.getSingle(S,k,E).concat(this.getAlternates(S,k,E));case"dlig":case"liga":case"rlig":return this.getLigatures(S,k,E)}},fo.prototype.add=function(S,k,E,A){if(/ss\d\d/.test(S))return this.addSingle(S,k,E,A);switch(S){case"aalt":case"salt":return typeof k.by=="number"?this.addSingle(S,k,E,A):this.addAlternate(S,k,E,A);case"dlig":case"liga":case"rlig":return this.addLigature(S,k,E,A)}};var zl,Eo,Hu,ea,Ys={getPath:ch,parse:function(S,k,E,A){for(var L=new gn.GlyphSet(A),V=0;V<E.length-1;V+=1){var q=E[V];q!==E[V+1]?L.push(V,gn.ttfGlyphLoader(A,V,uh,S,k+q,Ld)):L.push(V,gn.glyphLoader(A,V))}return L}};function hh(S){this.font=S,this.getCommands=function(k){return Ys.getPath(k).commands},this._fpgmState=this._prepState=void 0,this._errorState=0}function Pd(S){return S}function hr(S){return Math.sign(S)*Math.round(Math.abs(S))}function dr(S){return Math.sign(S)*Math.round(Math.abs(2*S))/2}function qu(S){return Math.sign(S)*(Math.round(Math.abs(S)+.5)-.5)}function Xu(S){return Math.sign(S)*Math.ceil(Math.abs(S))}function Ca(S){return Math.sign(S)*Math.floor(Math.abs(S))}function Ku(S){var k=this.srPeriod,E=this.srPhase,A=1;return S<0&&(S=-S,A=-1),S+=this.srThreshold-E,S=Math.trunc(S/k)*k,(S+=E)<0?E*A:S*A}var Zs={x:1,y:0,axis:"x",distance:function(S,k,E,A){return(E?S.xo:S.x)-(A?k.xo:k.x)},interpolate:function(S,k,E,A){var L,V,q,se,ae,_e,je;if(!A||A===this)return L=S.xo-k.xo,V=S.xo-E.xo,ae=k.x-k.xo,_e=E.x-E.xo,(je=(q=Math.abs(L))+(se=Math.abs(V)))===0?void(S.x=S.xo+(ae+_e)/2):void(S.x=S.xo+(ae*se+_e*q)/je);L=A.distance(S,k,!0,!0),V=A.distance(S,E,!0,!0),ae=A.distance(k,k,!1,!0),_e=A.distance(E,E,!1,!0),(je=(q=Math.abs(L))+(se=Math.abs(V)))!==0?Zs.setRelative(S,S,(ae*se+_e*q)/je,A,!0):Zs.setRelative(S,S,(ae+_e)/2,A,!0)},normalSlope:Number.NEGATIVE_INFINITY,setRelative:function(S,k,E,A,L){if(A&&A!==this){var V=L?k.xo:k.x,q=L?k.yo:k.y,se=V+E*A.x,ae=q+E*A.y;S.x=se+(S.y-ae)/A.normalSlope}else S.x=(L?k.xo:k.x)+E},slope:0,touch:function(S){S.xTouched=!0},touched:function(S){return S.xTouched},untouch:function(S){S.xTouched=!1}},Qo={x:0,y:1,axis:"y",distance:function(S,k,E,A){return(E?S.yo:S.y)-(A?k.yo:k.y)},interpolate:function(S,k,E,A){var L,V,q,se,ae,_e,je;if(!A||A===this)return L=S.yo-k.yo,V=S.yo-E.yo,ae=k.y-k.yo,_e=E.y-E.yo,(je=(q=Math.abs(L))+(se=Math.abs(V)))===0?void(S.y=S.yo+(ae+_e)/2):void(S.y=S.yo+(ae*se+_e*q)/je);L=A.distance(S,k,!0,!0),V=A.distance(S,E,!0,!0),ae=A.distance(k,k,!1,!0),_e=A.distance(E,E,!1,!0),(je=(q=Math.abs(L))+(se=Math.abs(V)))!==0?Qo.setRelative(S,S,(ae*se+_e*q)/je,A,!0):Qo.setRelative(S,S,(ae+_e)/2,A,!0)},normalSlope:0,setRelative:function(S,k,E,A,L){if(A&&A!==this){var V=L?k.xo:k.x,q=L?k.yo:k.y,se=V+E*A.x,ae=q+E*A.y;S.y=ae+A.normalSlope*(S.x-se)}else S.y=(L?k.yo:k.y)+E},slope:Number.POSITIVE_INFINITY,touch:function(S){S.yTouched=!0},touched:function(S){return S.yTouched},untouch:function(S){S.yTouched=!1}};function $a(S,k){this.x=S,this.y=k,this.axis=void 0,this.slope=k/S,this.normalSlope=-S/k,Object.freeze(this)}function Jo(S,k){var E=Math.sqrt(S*S+k*k);return k/=E,(S/=E)===1&&k===0?Zs:S===0&&k===1?Qo:new $a(S,k)}function gr(S,k,E,A){this.x=this.xo=Math.round(64*S)/64,this.y=this.yo=Math.round(64*k)/64,this.lastPointOfContour=E,this.onCurve=A,this.prevPointOnContour=void 0,this.nextPointOnContour=void 0,this.xTouched=!1,this.yTouched=!1,Object.preventExtensions(this)}Object.freeze(Zs),Object.freeze(Qo),$a.prototype.distance=function(S,k,E,A){return this.x*Zs.distance(S,k,E,A)+this.y*Qo.distance(S,k,E,A)},$a.prototype.interpolate=function(S,k,E,A){var L,V,q,se,ae,_e,je;q=A.distance(S,k,!0,!0),se=A.distance(S,E,!0,!0),L=A.distance(k,k,!1,!0),V=A.distance(E,E,!1,!0),(je=(ae=Math.abs(q))+(_e=Math.abs(se)))!==0?this.setRelative(S,S,(L*_e+V*ae)/je,A,!0):this.setRelative(S,S,(L+V)/2,A,!0)},$a.prototype.setRelative=function(S,k,E,A,L){A=A||this;var V=L?k.xo:k.x,q=L?k.yo:k.y,se=V+E*A.x,ae=q+E*A.y,_e=A.normalSlope,je=this.slope,qe=S.x,ge=S.y;S.x=(je*qe-_e*se+ae-ge)/(je-_e),S.y=je*(S.x-qe)+ge},$a.prototype.touch=function(S){S.xTouched=!0,S.yTouched=!0},gr.prototype.nextTouched=function(S){for(var k=this.nextPointOnContour;!S.touched(k)&&k!==this;)k=k.nextPointOnContour;return k},gr.prototype.prevTouched=function(S){for(var k=this.prevPointOnContour;!S.touched(k)&&k!==this;)k=k.prevPointOnContour;return k};var bi=Object.freeze(new gr(0,0)),ta={cvCutIn:17/16,deltaBase:9,deltaShift:.125,loop:1,minDis:1,autoFlip:!0};function ei(S,k){switch(this.env=S,this.stack=[],this.prog=k,S){case"glyf":this.zp0=this.zp1=this.zp2=1,this.rp0=this.rp1=this.rp2=0;case"prep":this.fv=this.pv=this.dpv=Zs,this.round=hr}}function ti(S){for(var k=S.tZone=new Array(S.gZone.length),E=0;E<k.length;E++)k[E]=new gr(0,0)}function $s(S,k){var E,A=S.prog,L=S.ip,V=1;do if((E=A[++L])===88)V++;else if(E===89)V--;else if(E===64)L+=A[L+1]+1;else if(E===65)L+=2*A[L+1]+1;else if(176<=E&&E<=183)L+=E-176+1;else if(184<=E&&E<=191)L+=2*(E-184+1);else if(k&&V===1&&E===27)break;while(0<V);S.ip=L}function Yu(S,k){u.DEBUG&&console.log(k.step,"SVTCA["+S.axis+"]"),k.fv=k.pv=k.dpv=S}function Vl(S,k){u.DEBUG&&console.log(k.step,"SPVTCA["+S.axis+"]"),k.pv=k.dpv=S}function Zu(S,k){u.DEBUG&&console.log(k.step,"SFVTCA["+S.axis+"]"),k.fv=S}function Qu(S,k){var E,A,L=k.stack,V=L.pop(),q=L.pop(),se=k.z2[V],ae=k.z1[q];u.DEBUG&&console.log("SPVTL["+S+"]",V,q),A=S?(E=se.y-ae.y,ae.x-se.x):(E=ae.x-se.x,ae.y-se.y),k.pv=k.dpv=Jo(E,A)}function al(S,k){var E,A,L=k.stack,V=L.pop(),q=L.pop(),se=k.z2[V],ae=k.z1[q];u.DEBUG&&console.log("SFVTL["+S+"]",V,q),A=S?(E=se.y-ae.y,ae.x-se.x):(E=ae.x-se.x,ae.y-se.y),k.fv=Jo(E,A)}function ll(S){u.DEBUG&&console.log(S.step,"POP[]"),S.stack.pop()}function Ns(S,k){var E=k.stack.pop(),A=k.z0[E],L=k.fv,V=k.pv;u.DEBUG&&console.log(k.step,"MDAP["+S+"]",E);var q=V.distance(A,bi);S&&(q=k.round(q)),L.setRelative(A,bi,q,V),L.touch(A),k.rp0=k.rp1=E}function dh(S,k){var E,A,L,V=k.z2,q=V.length-2;u.DEBUG&&console.log(k.step,"IUP["+S.axis+"]");for(var se=0;se<q;se++)E=V[se],S.touched(E)||(A=E.prevTouched(S))!==E&&(A===(L=E.nextTouched(S))&&S.setRelative(E,E,S.distance(A,A,!1,!0),S,!0),S.interpolate(E,A,L,S))}function Us(S,k){for(var E=k.stack,A=S?k.rp1:k.rp2,L=(S?k.z0:k.z1)[A],V=k.fv,q=k.pv,se=k.loop,ae=k.z2;se--;){var _e=E.pop(),je=ae[_e],qe=q.distance(L,L,!1,!0);V.setRelative(je,je,qe,q),V.touch(je),u.DEBUG&&console.log(k.step,(1<k.loop?"loop "+(k.loop-se)+": ":"")+"SHP["+(S?"rp1":"rp2")+"]",_e)}k.loop=1}function fh(S,k){var E=k.stack,A=S?k.rp1:k.rp2,L=(S?k.z0:k.z1)[A],V=k.fv,q=k.pv,se=E.pop(),ae=k.z2[k.contours[se]],_e=ae;u.DEBUG&&console.log(k.step,"SHC["+S+"]",se);for(var je=q.distance(L,L,!1,!0);_e!==L&&V.setRelative(_e,_e,je,q),(_e=_e.nextPointOnContour)!==ae;);}function Gl(S,k){var E,A,L=k.stack,V=S?k.rp1:k.rp2,q=(S?k.z0:k.z1)[V],se=k.fv,ae=k.pv,_e=L.pop();switch(u.DEBUG&&console.log(k.step,"SHZ["+S+"]",_e),_e){case 0:E=k.tZone;break;case 1:E=k.gZone;break;default:throw new Error("Invalid zone")}for(var je=ae.distance(q,q,!1,!0),qe=E.length-2,ge=0;ge<qe;ge++)A=E[ge],se.setRelative(A,A,je,ae)}function ni(S,k){var E=k.stack,A=E.pop()/64,L=E.pop(),V=k.z1[L],q=k.z0[k.rp0],se=k.fv,ae=k.pv;se.setRelative(V,q,A,ae),se.touch(V),u.DEBUG&&console.log(k.step,"MSIRP["+S+"]",A,L),k.rp1=k.rp0,k.rp2=L,S&&(k.rp0=L)}function ul(S,k){var E=k.stack,A=E.pop(),L=E.pop(),V=k.z0[L],q=k.fv,se=k.pv,ae=k.cvt[A];u.DEBUG&&console.log(k.step,"MIAP["+S+"]",A,"(",ae,")",L);var _e=se.distance(V,bi);S&&(Math.abs(_e-ae)<k.cvCutIn&&(_e=ae),_e=k.round(_e)),q.setRelative(V,bi,_e,se),k.zp0===0&&(V.xo=V.x,V.yo=V.y),q.touch(V),k.rp0=k.rp1=L}function Na(S,k){var E=k.stack,A=E.pop(),L=k.z2[A];u.DEBUG&&console.log(k.step,"GC["+S+"]",A),E.push(64*k.dpv.distance(L,bi,S,!1))}function Sr(S,k){var E=k.stack,A=E.pop(),L=E.pop(),V=k.z1[A],q=k.z0[L],se=k.dpv.distance(q,V,S,S);u.DEBUG&&console.log(k.step,"MD["+S+"]",A,L,"->",se),k.stack.push(Math.round(64*se))}function Co(S,k){var E=k.stack,A=E.pop(),L=k.fv,V=k.pv,q=k.ppem,se=k.deltaBase+16*(S-1),ae=k.deltaShift,_e=k.z0;u.DEBUG&&console.log(k.step,"DELTAP["+S+"]",A,E);for(var je=0;je<A;je++){var qe=E.pop(),ge=E.pop();if(se+((240&ge)>>4)===q){var $t=(15&ge)-8;0<=$t&&$t++,u.DEBUG&&console.log(k.step,"DELTAPFIX",qe,"by",$t*ae);var wt=_e[qe];L.setRelative(wt,wt,$t*ae,V)}}}function Aa(S,k){var E=k.stack,A=E.pop();u.DEBUG&&console.log(k.step,"ROUND[]"),E.push(64*k.round(A/64))}function Ra(S,k){var E=k.stack,A=E.pop(),L=k.ppem,V=k.deltaBase+16*(S-1),q=k.deltaShift;u.DEBUG&&console.log(k.step,"DELTAC["+S+"]",A,E);for(var se=0;se<A;se++){var ae=E.pop(),_e=E.pop();if(V+((240&_e)>>4)===L){var je=(15&_e)-8;0<=je&&je++;var qe=je*q;u.DEBUG&&console.log(k.step,"DELTACFIX",ae,"by",qe),k.cvt[ae]+=qe}}}function Wl(S,k){var E,A,L=k.stack,V=L.pop(),q=L.pop(),se=k.z2[V],ae=k.z1[q];u.DEBUG&&console.log(k.step,"SDPVTL["+S+"]",V,q),A=S?(E=se.y-ae.y,ae.x-se.x):(E=ae.x-se.x,ae.y-se.y),k.dpv=Jo(E,A)}function xi(S,k){var E=k.stack,A=k.prog,L=k.ip;u.DEBUG&&console.log(k.step,"PUSHB["+S+"]");for(var V=0;V<S;V++)E.push(A[++L]);k.ip=L}function wi(S,k){var E=k.ip,A=k.prog,L=k.stack;u.DEBUG&&console.log(k.ip,"PUSHW["+S+"]");for(var V=0;V<S;V++){var q=A[++E]<<8|A[++E];32768&q&&(q=-(1+(65535^q))),L.push(q)}k.ip=E}function Qt(S,k,E,A,L,V){var q,se,ae,_e,je=V.stack,qe=S&&je.pop(),ge=je.pop(),$t=V.rp0,wt=V.z0[$t],mt=V.z1[ge],st=V.minDis,dt=V.fv,Zt=V.dpv;ae=0<=(se=q=Zt.distance(mt,wt,!0,!0))?1:-1,se=Math.abs(se),S&&(_e=V.cvt[qe],A&&Math.abs(se-_e)<V.cvCutIn&&(se=_e)),E&&se<st&&(se=st),A&&(se=V.round(se)),dt.setRelative(mt,wt,ae*se,Zt),dt.touch(mt),u.DEBUG&&console.log(V.step,(S?"MIRP[":"MDRP[")+(k?"M":"m")+(E?">":"_")+(A?"R":"_")+(L===0?"Gr":L===1?"Bl":L===2?"Wh":"")+"]",S?qe+"("+V.cvt[qe]+","+_e+")":"",ge,"(d =",q,"->",ae*se,")"),V.rp1=V.rp0,V.rp2=ge,k&&(V.rp0=ge)}hh.prototype.exec=function(S,k){if(typeof k!="number")throw new Error("Point size is not a number!");if(!(2<this._errorState)){var E=this.font,A=this._prepState;if(!A||A.ppem!==k){var L=this._fpgmState;if(!L){ei.prototype=ta,(L=this._fpgmState=new ei("fpgm",E.tables.fpgm)).funcs=[],L.font=E,u.DEBUG&&(console.log("---EXEC FPGM---"),L.step=-1);try{Eo(L)}catch(_e){return console.log("Hinting error in FPGM:"+_e),void(this._errorState=3)}}ei.prototype=L,(A=this._prepState=new ei("prep",E.tables.prep)).ppem=k;var V=E.tables.cvt;if(V)for(var q=A.cvt=new Array(V.length),se=k/E.unitsPerEm,ae=0;ae<V.length;ae++)q[ae]=V[ae]*se;else A.cvt=[];u.DEBUG&&(console.log("---EXEC PREP---"),A.step=-1);try{Eo(A)}catch(_e){this._errorState<2&&console.log("Hinting error in PREP:"+_e),this._errorState=2}}if(!(1<this._errorState))try{return Hu(S,A)}catch(_e){return this._errorState<1&&(console.log("Hinting error:"+_e),console.log("Note: further hinting errors are silenced")),void(this._errorState=1)}}},Hu=function(S,k){var E,A,L,V=k.ppem/k.font.unitsPerEm,q=V,se=S.components;if(ei.prototype=k,se){var ae=k.font;A=[],E=[];for(var _e=0;_e<se.length;_e++){var je=se[_e],qe=ae.glyphs.get(je.glyphIndex);L=new ei("glyf",qe.instructions),u.DEBUG&&(console.log("---EXEC COMP "+_e+"---"),L.step=-1),ea(qe,L,V,q);for(var ge=Math.round(je.dx*V),$t=Math.round(je.dy*q),wt=L.gZone,mt=L.contours,st=0;st<wt.length;st++){var dt=wt[st];dt.xTouched=dt.yTouched=!1,dt.xo=dt.x=dt.x+ge,dt.yo=dt.y=dt.y+$t}var Zt=A.length;A.push.apply(A,wt);for(var zt=0;zt<mt.length;zt++)E.push(mt[zt]+Zt)}S.instructions&&!L.inhibitGridFit&&((L=new ei("glyf",S.instructions)).gZone=L.z0=L.z1=L.z2=A,L.contours=E,A.push(new gr(0,0),new gr(Math.round(S.advanceWidth*V),0)),u.DEBUG&&(console.log("---EXEC COMPOSITE---"),L.step=-1),Eo(L),A.length-=2)}else L=new ei("glyf",S.instructions),u.DEBUG&&(console.log("---EXEC GLYPH---"),L.step=-1),ea(S,L,V,q),A=L.gZone;return A},ea=function(S,k,E,A){for(var L,V,q,se=S.points||[],ae=se.length,_e=k.gZone=k.z0=k.z1=k.z2=[],je=k.contours=[],qe=0;qe<ae;qe++)L=se[qe],_e[qe]=new gr(L.x*E,L.y*A,L.lastPointOfContour,L.onCurve);for(var ge=0;ge<ae;ge++)L=_e[ge],V||(V=L,je.push(ge)),L.lastPointOfContour?((L.nextPointOnContour=V).prevPointOnContour=L,V=void 0):(q=_e[ge+1],(L.nextPointOnContour=q).prevPointOnContour=L);if(!k.inhibitGridFit){if(u.DEBUG){console.log("PROCESSING GLYPH",k.stack);for(var $t=0;$t<ae;$t++)console.log($t,_e[$t].x,_e[$t].y)}if(_e.push(new gr(0,0),new gr(Math.round(S.advanceWidth*E),0)),Eo(k),_e.length-=2,u.DEBUG){console.log("FINISHED GLYPH",k.stack);for(var wt=0;wt<ae;wt++)console.log(wt,_e[wt].x,_e[wt].y)}}},Eo=function(S){var k=S.prog;if(k){var E,A=k.length;for(S.ip=0;S.ip<A;S.ip++){if(u.DEBUG&&S.step++,!(E=zl[k[S.ip]]))throw new Error("unknown instruction: 0x"+Number(k[S.ip]).toString(16));E(S)}}},zl=[Yu.bind(void 0,Qo),Yu.bind(void 0,Zs),Vl.bind(void 0,Qo),Vl.bind(void 0,Zs),Zu.bind(void 0,Qo),Zu.bind(void 0,Zs),Qu.bind(void 0,0),Qu.bind(void 0,1),al.bind(void 0,0),al.bind(void 0,1),function(S){var k=S.stack,E=k.pop(),A=k.pop();u.DEBUG&&console.log(S.step,"SPVFS[]",E,A),S.pv=S.dpv=Jo(A,E)},function(S){var k=S.stack,E=k.pop(),A=k.pop();u.DEBUG&&console.log(S.step,"SPVFS[]",E,A),S.fv=Jo(A,E)},function(S){var k=S.stack,E=S.pv;u.DEBUG&&console.log(S.step,"GPV[]"),k.push(16384*E.x),k.push(16384*E.y)},function(S){var k=S.stack,E=S.fv;u.DEBUG&&console.log(S.step,"GFV[]"),k.push(16384*E.x),k.push(16384*E.y)},function(S){S.fv=S.pv,u.DEBUG&&console.log(S.step,"SFVTPV[]")},function(S){var k=S.stack,E=k.pop(),A=k.pop(),L=k.pop(),V=k.pop(),q=k.pop(),se=S.z0,ae=S.z1,_e=se[E],je=se[A],qe=ae[L],ge=ae[V],$t=S.z2[q];u.DEBUG&&console.log("ISECT[], ",E,A,L,V,q);var wt=_e.x,mt=_e.y,st=je.x,dt=je.y,Zt=qe.x,zt=qe.y,Bn=ge.x,un=ge.y,yn=(wt-st)*(zt-un)-(mt-dt)*(Zt-Bn),Or=wt*dt-mt*st,Zn=Zt*un-zt*Bn;$t.x=(Or*(Zt-Bn)-Zn*(wt-st))/yn,$t.y=(Or*(zt-un)-Zn*(mt-dt))/yn},function(S){S.rp0=S.stack.pop(),u.DEBUG&&console.log(S.step,"SRP0[]",S.rp0)},function(S){S.rp1=S.stack.pop(),u.DEBUG&&console.log(S.step,"SRP1[]",S.rp1)},function(S){S.rp2=S.stack.pop(),u.DEBUG&&console.log(S.step,"SRP2[]",S.rp2)},function(S){var k=S.stack.pop();switch(u.DEBUG&&console.log(S.step,"SZP0[]",k),S.zp0=k){case 0:S.tZone||ti(S),S.z0=S.tZone;break;case 1:S.z0=S.gZone;break;default:throw new Error("Invalid zone pointer")}},function(S){var k=S.stack.pop();switch(u.DEBUG&&console.log(S.step,"SZP1[]",k),S.zp1=k){case 0:S.tZone||ti(S),S.z1=S.tZone;break;case 1:S.z1=S.gZone;break;default:throw new Error("Invalid zone pointer")}},function(S){var k=S.stack.pop();switch(u.DEBUG&&console.log(S.step,"SZP2[]",k),S.zp2=k){case 0:S.tZone||ti(S),S.z2=S.tZone;break;case 1:S.z2=S.gZone;break;default:throw new Error("Invalid zone pointer")}},function(S){var k=S.stack.pop();switch(u.DEBUG&&console.log(S.step,"SZPS[]",k),S.zp0=S.zp1=S.zp2=k,k){case 0:S.tZone||ti(S),S.z0=S.z1=S.z2=S.tZone;break;case 1:S.z0=S.z1=S.z2=S.gZone;break;default:throw new Error("Invalid zone pointer")}},function(S){S.loop=S.stack.pop(),u.DEBUG&&console.log(S.step,"SLOOP[]",S.loop)},function(S){u.DEBUG&&console.log(S.step,"RTG[]"),S.round=hr},function(S){u.DEBUG&&console.log(S.step,"RTHG[]"),S.round=qu},function(S){var k=S.stack.pop();u.DEBUG&&console.log(S.step,"SMD[]",k),S.minDis=k/64},function(S){u.DEBUG&&console.log(S.step,"ELSE[]"),$s(S,!1)},function(S){var k=S.stack.pop();u.DEBUG&&console.log(S.step,"JMPR[]",k),S.ip+=k-1},function(S){var k=S.stack.pop();u.DEBUG&&console.log(S.step,"SCVTCI[]",k),S.cvCutIn=k/64},void 0,void 0,function(S){var k=S.stack;u.DEBUG&&console.log(S.step,"DUP[]"),k.push(k[k.length-1])},ll,function(S){u.DEBUG&&console.log(S.step,"CLEAR[]"),S.stack.length=0},function(S){var k=S.stack,E=k.pop(),A=k.pop();u.DEBUG&&console.log(S.step,"SWAP[]"),k.push(E),k.push(A)},function(S){var k=S.stack;u.DEBUG&&console.log(S.step,"DEPTH[]"),k.push(k.length)},function(S){var k=S.stack,E=k.pop();u.DEBUG&&console.log(S.step,"CINDEX[]",E),k.push(k[k.length-E])},function(S){var k=S.stack,E=k.pop();u.DEBUG&&console.log(S.step,"MINDEX[]",E),k.push(k.splice(k.length-E,1)[0])},void 0,void 0,void 0,function(S){var k=S.stack,E=k.pop(),A=k.pop();u.DEBUG&&console.log(S.step,"LOOPCALL[]",E,A);var L=S.ip,V=S.prog;S.prog=S.funcs[E];for(var q=0;q<A;q++)Eo(S),u.DEBUG&&console.log(++S.step,q+1<A?"next loopcall":"done loopcall",q);S.ip=L,S.prog=V},function(S){var k=S.stack.pop();u.DEBUG&&console.log(S.step,"CALL[]",k);var E=S.ip,A=S.prog;S.prog=S.funcs[k],Eo(S),S.ip=E,S.prog=A,u.DEBUG&&console.log(++S.step,"returning from",k)},function(S){if(S.env!=="fpgm")throw new Error("FDEF not allowed here");var k=S.stack,E=S.prog,A=S.ip,L=k.pop(),V=A;for(u.DEBUG&&console.log(S.step,"FDEF[]",L);E[++A]!==45;);S.ip=A,S.funcs[L]=E.slice(V+1,A)},void 0,Ns.bind(void 0,0),Ns.bind(void 0,1),dh.bind(void 0,Qo),dh.bind(void 0,Zs),Us.bind(void 0,0),Us.bind(void 0,1),fh.bind(void 0,0),fh.bind(void 0,1),Gl.bind(void 0,0),Gl.bind(void 0,1),function(S){for(var k=S.stack,E=S.loop,A=S.fv,L=k.pop()/64,V=S.z2;E--;){var q=k.pop(),se=V[q];u.DEBUG&&console.log(S.step,(1<S.loop?"loop "+(S.loop-E)+": ":"")+"SHPIX[]",q,L),A.setRelative(se,se,L),A.touch(se)}S.loop=1},function(S){for(var k=S.stack,E=S.rp1,A=S.rp2,L=S.loop,V=S.z0[E],q=S.z1[A],se=S.fv,ae=S.dpv,_e=S.z2;L--;){var je=k.pop(),qe=_e[je];u.DEBUG&&console.log(S.step,(1<S.loop?"loop "+(S.loop-L)+": ":"")+"IP[]",je,E,"<->",A),se.interpolate(qe,V,q,ae),se.touch(qe)}S.loop=1},ni.bind(void 0,0),ni.bind(void 0,1),function(S){for(var k=S.stack,E=S.rp0,A=S.z0[E],L=S.loop,V=S.fv,q=S.pv,se=S.z1;L--;){var ae=k.pop(),_e=se[ae];u.DEBUG&&console.log(S.step,(1<S.loop?"loop "+(S.loop-L)+": ":"")+"ALIGNRP[]",ae),V.setRelative(_e,A,0,q),V.touch(_e)}S.loop=1},function(S){u.DEBUG&&console.log(S.step,"RTDG[]"),S.round=dr},ul.bind(void 0,0),ul.bind(void 0,1),function(S){var k=S.prog,E=S.ip,A=S.stack,L=k[++E];u.DEBUG&&console.log(S.step,"NPUSHB[]",L);for(var V=0;V<L;V++)A.push(k[++E]);S.ip=E},function(S){var k=S.ip,E=S.prog,A=S.stack,L=E[++k];u.DEBUG&&console.log(S.step,"NPUSHW[]",L);for(var V=0;V<L;V++){var q=E[++k]<<8|E[++k];32768&q&&(q=-(1+(65535^q))),A.push(q)}S.ip=k},function(S){var k=S.stack,E=S.store;E=E||(S.store=[]);var A=k.pop(),L=k.pop();u.DEBUG&&console.log(S.step,"WS",A,L),E[L]=A},function(S){var k=S.stack,E=S.store,A=k.pop();u.DEBUG&&console.log(S.step,"RS",A);var L=E&&E[A]||0;k.push(L)},function(S){var k=S.stack,E=k.pop(),A=k.pop();u.DEBUG&&console.log(S.step,"WCVTP",E,A),S.cvt[A]=E/64},function(S){var k=S.stack,E=k.pop();u.DEBUG&&console.log(S.step,"RCVT",E),k.push(64*S.cvt[E])},Na.bind(void 0,0),Na.bind(void 0,1),void 0,Sr.bind(void 0,0),Sr.bind(void 0,1),function(S){u.DEBUG&&console.log(S.step,"MPPEM[]"),S.stack.push(S.ppem)},void 0,function(S){u.DEBUG&&console.log(S.step,"FLIPON[]"),S.autoFlip=!0},void 0,void 0,function(S){var k=S.stack,E=k.pop(),A=k.pop();u.DEBUG&&console.log(S.step,"LT[]",E,A),k.push(A<E?1:0)},function(S){var k=S.stack,E=k.pop(),A=k.pop();u.DEBUG&&console.log(S.step,"LTEQ[]",E,A),k.push(A<=E?1:0)},function(S){var k=S.stack,E=k.pop(),A=k.pop();u.DEBUG&&console.log(S.step,"GT[]",E,A),k.push(E<A?1:0)},function(S){var k=S.stack,E=k.pop(),A=k.pop();u.DEBUG&&console.log(S.step,"GTEQ[]",E,A),k.push(E<=A?1:0)},function(S){var k=S.stack,E=k.pop(),A=k.pop();u.DEBUG&&console.log(S.step,"EQ[]",E,A),k.push(E===A?1:0)},function(S){var k=S.stack,E=k.pop(),A=k.pop();u.DEBUG&&console.log(S.step,"NEQ[]",E,A),k.push(E!==A?1:0)},function(S){var k=S.stack,E=k.pop();u.DEBUG&&console.log(S.step,"ODD[]",E),k.push(Math.trunc(E)%2?1:0)},function(S){var k=S.stack,E=k.pop();u.DEBUG&&console.log(S.step,"EVEN[]",E),k.push(Math.trunc(E)%2?0:1)},function(S){var k=S.stack.pop();u.DEBUG&&console.log(S.step,"IF[]",k),k||($s(S,!0),u.DEBUG&&console.log(S.step,"EIF[]"))},function(S){u.DEBUG&&console.log(S.step,"EIF[]")},function(S){var k=S.stack,E=k.pop(),A=k.pop();u.DEBUG&&console.log(S.step,"AND[]",E,A),k.push(E&&A?1:0)},function(S){var k=S.stack,E=k.pop(),A=k.pop();u.DEBUG&&console.log(S.step,"OR[]",E,A),k.push(E||A?1:0)},function(S){var k=S.stack,E=k.pop();u.DEBUG&&console.log(S.step,"NOT[]",E),k.push(E?0:1)},Co.bind(void 0,1),function(S){var k=S.stack.pop();u.DEBUG&&console.log(S.step,"SDB[]",k),S.deltaBase=k},function(S){var k=S.stack.pop();u.DEBUG&&console.log(S.step,"SDS[]",k),S.deltaShift=Math.pow(.5,k)},function(S){var k=S.stack,E=k.pop(),A=k.pop();u.DEBUG&&console.log(S.step,"ADD[]",E,A),k.push(A+E)},function(S){var k=S.stack,E=k.pop(),A=k.pop();u.DEBUG&&console.log(S.step,"SUB[]",E,A),k.push(A-E)},function(S){var k=S.stack,E=k.pop(),A=k.pop();u.DEBUG&&console.log(S.step,"DIV[]",E,A),k.push(64*A/E)},function(S){var k=S.stack,E=k.pop(),A=k.pop();u.DEBUG&&console.log(S.step,"MUL[]",E,A),k.push(A*E/64)},function(S){var k=S.stack,E=k.pop();u.DEBUG&&console.log(S.step,"ABS[]",E),k.push(Math.abs(E))},function(S){var k=S.stack,E=k.pop();u.DEBUG&&console.log(S.step,"NEG[]",E),k.push(-E)},function(S){var k=S.stack,E=k.pop();u.DEBUG&&console.log(S.step,"FLOOR[]",E),k.push(64*Math.floor(E/64))},function(S){var k=S.stack,E=k.pop();u.DEBUG&&console.log(S.step,"CEILING[]",E),k.push(64*Math.ceil(E/64))},Aa.bind(void 0,0),Aa.bind(void 0,1),Aa.bind(void 0,2),Aa.bind(void 0,3),void 0,void 0,void 0,void 0,function(S){var k=S.stack,E=k.pop(),A=k.pop();u.DEBUG&&console.log(S.step,"WCVTF[]",E,A),S.cvt[A]=E*S.ppem/S.font.unitsPerEm},Co.bind(void 0,2),Co.bind(void 0,3),Ra.bind(void 0,1),Ra.bind(void 0,2),Ra.bind(void 0,3),function(S){var k,E=S.stack.pop();switch(u.DEBUG&&console.log(S.step,"SROUND[]",E),S.round=Ku,192&E){case 0:k=.5;break;case 64:k=1;break;case 128:k=2;break;default:throw new Error("invalid SROUND value")}switch(S.srPeriod=k,48&E){case 0:S.srPhase=0;break;case 16:S.srPhase=.25*k;break;case 32:S.srPhase=.5*k;break;case 48:S.srPhase=.75*k;break;default:throw new Error("invalid SROUND value")}E&=15,S.srThreshold=E===0?0:(E/8-.5)*k},function(S){var k,E=S.stack.pop();switch(u.DEBUG&&console.log(S.step,"S45ROUND[]",E),S.round=Ku,192&E){case 0:k=Math.sqrt(2)/2;break;case 64:k=Math.sqrt(2);break;case 128:k=2*Math.sqrt(2);break;default:throw new Error("invalid S45ROUND value")}switch(S.srPeriod=k,48&E){case 0:S.srPhase=0;break;case 16:S.srPhase=.25*k;break;case 32:S.srPhase=.5*k;break;case 48:S.srPhase=.75*k;break;default:throw new Error("invalid S45ROUND value")}E&=15,S.srThreshold=E===0?0:(E/8-.5)*k},void 0,void 0,function(S){u.DEBUG&&console.log(S.step,"ROFF[]"),S.round=Pd},void 0,function(S){u.DEBUG&&console.log(S.step,"RUTG[]"),S.round=Xu},function(S){u.DEBUG&&console.log(S.step,"RDTG[]"),S.round=Ca},ll,ll,void 0,void 0,void 0,void 0,void 0,function(S){var k=S.stack.pop();u.DEBUG&&console.log(S.step,"SCANCTRL[]",k)},Wl.bind(void 0,0),Wl.bind(void 0,1),function(S){var k=S.stack,E=k.pop(),A=0;u.DEBUG&&console.log(S.step,"GETINFO[]",E),1&E&&(A=35),32&E&&(A|=4096),k.push(A)},void 0,function(S){var k=S.stack,E=k.pop(),A=k.pop(),L=k.pop();u.DEBUG&&console.log(S.step,"ROLL[]"),k.push(A),k.push(E),k.push(L)},function(S){var k=S.stack,E=k.pop(),A=k.pop();u.DEBUG&&console.log(S.step,"MAX[]",E,A),k.push(Math.max(A,E))},function(S){var k=S.stack,E=k.pop(),A=k.pop();u.DEBUG&&console.log(S.step,"MIN[]",E,A),k.push(Math.min(A,E))},function(S){var k=S.stack.pop();u.DEBUG&&console.log(S.step,"SCANTYPE[]",k)},function(S){var k=S.stack.pop(),E=S.stack.pop();switch(u.DEBUG&&console.log(S.step,"INSTCTRL[]",k,E),k){case 1:return void(S.inhibitGridFit=!!E);case 2:return void(S.ignoreCvt=!!E);default:throw new Error("invalid INSTCTRL[] selector")}},void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,xi.bind(void 0,1),xi.bind(void 0,2),xi.bind(void 0,3),xi.bind(void 0,4),xi.bind(void 0,5),xi.bind(void 0,6),xi.bind(void 0,7),xi.bind(void 0,8),wi.bind(void 0,1),wi.bind(void 0,2),wi.bind(void 0,3),wi.bind(void 0,4),wi.bind(void 0,5),wi.bind(void 0,6),wi.bind(void 0,7),wi.bind(void 0,8),Qt.bind(void 0,0,0,0,0,0),Qt.bind(void 0,0,0,0,0,1),Qt.bind(void 0,0,0,0,0,2),Qt.bind(void 0,0,0,0,0,3),Qt.bind(void 0,0,0,0,1,0),Qt.bind(void 0,0,0,0,1,1),Qt.bind(void 0,0,0,0,1,2),Qt.bind(void 0,0,0,0,1,3),Qt.bind(void 0,0,0,1,0,0),Qt.bind(void 0,0,0,1,0,1),Qt.bind(void 0,0,0,1,0,2),Qt.bind(void 0,0,0,1,0,3),Qt.bind(void 0,0,0,1,1,0),Qt.bind(void 0,0,0,1,1,1),Qt.bind(void 0,0,0,1,1,2),Qt.bind(void 0,0,0,1,1,3),Qt.bind(void 0,0,1,0,0,0),Qt.bind(void 0,0,1,0,0,1),Qt.bind(void 0,0,1,0,0,2),Qt.bind(void 0,0,1,0,0,3),Qt.bind(void 0,0,1,0,1,0),Qt.bind(void 0,0,1,0,1,1),Qt.bind(void 0,0,1,0,1,2),Qt.bind(void 0,0,1,0,1,3),Qt.bind(void 0,0,1,1,0,0),Qt.bind(void 0,0,1,1,0,1),Qt.bind(void 0,0,1,1,0,2),Qt.bind(void 0,0,1,1,0,3),Qt.bind(void 0,0,1,1,1,0),Qt.bind(void 0,0,1,1,1,1),Qt.bind(void 0,0,1,1,1,2),Qt.bind(void 0,0,1,1,1,3),Qt.bind(void 0,1,0,0,0,0),Qt.bind(void 0,1,0,0,0,1),Qt.bind(void 0,1,0,0,0,2),Qt.bind(void 0,1,0,0,0,3),Qt.bind(void 0,1,0,0,1,0),Qt.bind(void 0,1,0,0,1,1),Qt.bind(void 0,1,0,0,1,2),Qt.bind(void 0,1,0,0,1,3),Qt.bind(void 0,1,0,1,0,0),Qt.bind(void 0,1,0,1,0,1),Qt.bind(void 0,1,0,1,0,2),Qt.bind(void 0,1,0,1,0,3),Qt.bind(void 0,1,0,1,1,0),Qt.bind(void 0,1,0,1,1,1),Qt.bind(void 0,1,0,1,1,2),Qt.bind(void 0,1,0,1,1,3),Qt.bind(void 0,1,1,0,0,0),Qt.bind(void 0,1,1,0,0,1),Qt.bind(void 0,1,1,0,0,2),Qt.bind(void 0,1,1,0,0,3),Qt.bind(void 0,1,1,0,1,0),Qt.bind(void 0,1,1,0,1,1),Qt.bind(void 0,1,1,0,1,2),Qt.bind(void 0,1,1,0,1,3),Qt.bind(void 0,1,1,1,0,0),Qt.bind(void 0,1,1,1,0,1),Qt.bind(void 0,1,1,1,0,2),Qt.bind(void 0,1,1,1,0,3),Qt.bind(void 0,1,1,1,1,0),Qt.bind(void 0,1,1,1,1,1),Qt.bind(void 0,1,1,1,1,2),Qt.bind(void 0,1,1,1,1,3)];var Ju=Array.from||function(S){return S.match(/[\uD800-\uDBFF][\uDC00-\uDFFF]?|[^\uD800-\uDFFF]|./g)||[]};function $(S){(S=S||{}).empty||(vi(S.familyName,"When creating a new Font object, familyName is required."),vi(S.styleName,"When creating a new Font object, styleName is required."),vi(S.unitsPerEm,"When creating a new Font object, unitsPerEm is required."),vi(S.ascender,"When creating a new Font object, ascender is required."),vi(S.descender,"When creating a new Font object, descender is required."),vi(S.descender<0,"Descender should be negative (e.g. -512)."),this.names={fontFamily:{en:S.familyName||" "},fontSubfamily:{en:S.styleName||" "},fullName:{en:S.fullName||S.familyName+" "+S.styleName},postScriptName:{en:S.postScriptName||(S.familyName+S.styleName).replace(/\s/g,"")},designer:{en:S.designer||" "},designerURL:{en:S.designerURL||" "},manufacturer:{en:S.manufacturer||" "},manufacturerURL:{en:S.manufacturerURL||" "},license:{en:S.license||" "},licenseURL:{en:S.licenseURL||" "},version:{en:S.version||"Version 0.1"},description:{en:S.description||" "},copyright:{en:S.copyright||" "},trademark:{en:S.trademark||" "}},this.unitsPerEm=S.unitsPerEm||1e3,this.ascender=S.ascender,this.descender=S.descender,this.createdTimestamp=S.createdTimestamp,this.tables={os2:{usWeightClass:S.weightClass||this.usWeightClasses.MEDIUM,usWidthClass:S.widthClass||this.usWidthClasses.MEDIUM,fsSelection:S.fsSelection||this.fsSelectionValues.REGULAR}}),this.supported=!0,this.glyphs=new gn.GlyphSet(this,S.glyphs||[]),this.encoding=new ot(this),this.position=new Zo(this),this.substitution=new fo(this),this.tables=this.tables||{},Object.defineProperty(this,"hinting",{get:function(){return this._hinting?this._hinting:this.outlinesFormat==="truetype"?this._hinting=new hh(this):void 0}})}function U(S,k){var E=JSON.stringify(S),A=256;for(var L in k){var V=parseInt(L);if(V&&!(V<256)){if(JSON.stringify(k[L])===E)return V;A<=V&&(A=V+1)}}return k[A]=S,A}function H(S,k,E,A){for(var L=[{name:"nameID_"+S,type:"USHORT",value:U(k.name,A)},{name:"flags_"+S,type:"USHORT",value:0}],V=0;V<E.length;++V){var q=E[V].tag;L.push({name:"axis_"+S+" "+q,type:"FIXED",value:k.coordinates[q]<<16})}return L}function oe(S,k,E,A){var L={},V=new Y.Parser(S,k);L.name=A[V.parseUShort()]||{},V.skip("uShort",1),L.coordinates={};for(var q=0;q<E.length;++q)L.coordinates[E[q].tag]=V.parseFixed();return L}$.prototype.hasChar=function(S){return this.encoding.charToGlyphIndex(S)!==null},$.prototype.charToGlyphIndex=function(S){return this.encoding.charToGlyphIndex(S)},$.prototype.charToGlyph=function(S){var k=this.charToGlyphIndex(S),E=this.glyphs.get(k);return E=E||this.glyphs.get(0)},$.prototype.stringToGlyphs=function(S,k){k=k||this.defaultRenderOptions;for(var E=Ju(S),A=[],L=0;L<E.length;L+=1){var V=E[L];A.push(this.charToGlyphIndex(V))}var q=A.length;if(k.features){var se=k.script||this.substitution.getDefaultScriptName(),ae=[];k.features.liga&&(ae=ae.concat(this.substitution.getFeature("liga",se,k.language))),k.features.rlig&&(ae=ae.concat(this.substitution.getFeature("rlig",se,k.language)));for(var _e=0;_e<q;_e+=1)for(var je=0;je<ae.length;je++){for(var qe=ae[je],ge=qe.sub,$t=ge.length,wt=0;wt<$t&&ge[wt]===A[_e+wt];)wt++;wt===$t&&(A.splice(_e,$t,qe.by),q=q-$t+1)}}for(var mt=new Array(q),st=this.glyphs.get(0),dt=0;dt<q;dt+=1)mt[dt]=this.glyphs.get(A[dt])||st;return mt},$.prototype.nameToGlyphIndex=function(S){return this.glyphNames.nameToGlyphIndex(S)},$.prototype.nameToGlyph=function(S){var k=this.nameToGlyphIndex(S),E=this.glyphs.get(k);return E=E||this.glyphs.get(0)},$.prototype.glyphIndexToName=function(S){return this.glyphNames.glyphIndexToName?this.glyphNames.glyphIndexToName(S):""},$.prototype.getKerningValue=function(S,k){S=S.index||S,k=k.index||k;var E=this.position.defaultKerningTables;return E?this.position.getKerningValue(E,S,k):this.kerningPairs[S+","+k]||0},$.prototype.defaultRenderOptions={kerning:!0,features:{liga:!0,rlig:!0}},$.prototype.forEachGlyph=function(S,k,E,A,L,V){k=k!==void 0?k:0,E=E!==void 0?E:0,A=A!==void 0?A:72,L=L||this.defaultRenderOptions;var q,se=1/this.unitsPerEm*A,ae=this.stringToGlyphs(S,L);if(L.kerning){var _e=L.script||this.position.getDefaultScriptName();q=this.position.getKerningTables(_e,L.language)}for(var je=0;je<ae.length;je+=1){var qe=ae[je];V.call(this,qe,k,E,A,L),qe.advanceWidth&&(k+=qe.advanceWidth*se),L.kerning&&je<ae.length-1&&(k+=(q?this.position.getKerningValue(q,qe.index,ae[je+1].index):this.getKerningValue(qe,ae[je+1]))*se),L.letterSpacing?k+=L.letterSpacing*A:L.tracking&&(k+=L.tracking/1e3*A)}return k},$.prototype.getPath=function(S,k,E,A,L){var V=new ce;return this.forEachGlyph(S,k,E,A,L,function(q,se,ae,_e){var je=q.getPath(se,ae,_e,L,this);V.extend(je)}),V},$.prototype.getPaths=function(S,k,E,A,L){var V=[];return this.forEachGlyph(S,k,E,A,L,function(q,se,ae,_e){var je=q.getPath(se,ae,_e,L,this);V.push(je)}),V},$.prototype.getAdvanceWidth=function(S,k,E){return this.forEachGlyph(S,0,0,k,E,function(){})},$.prototype.draw=function(S,k,E,A,L,V){this.getPath(k,E,A,L,V).draw(S)},$.prototype.drawPoints=function(S,k,E,A,L,V){this.forEachGlyph(k,E,A,L,V,function(q,se,ae,_e){q.drawPoints(S,se,ae,_e)})},$.prototype.drawMetrics=function(S,k,E,A,L,V){this.forEachGlyph(k,E,A,L,V,function(q,se,ae,_e){q.drawMetrics(S,se,ae,_e)})},$.prototype.getEnglishName=function(S){var k=this.names[S];if(k)return k.en},$.prototype.validate=function(){var S=this;function k(E){var A=S.getEnglishName(E);A&&A.trim().length}k("fontFamily"),k("weightName"),k("manufacturer"),k("copyright"),k("version"),this.unitsPerEm},$.prototype.toTables=function(){return Bl.fontToTable(this)},$.prototype.toBuffer=function(){return console.warn("Font.toBuffer is deprecated. Use Font.toArrayBuffer instead."),this.toArrayBuffer()},$.prototype.toArrayBuffer=function(){for(var S=this.toTables().encode(),k=new ArrayBuffer(S.length),E=new Uint8Array(k),A=0;A<S.length;A++)E[A]=S[A];return k},$.prototype.download=function(S){var k=this.getEnglishName("fontFamily"),E=this.getEnglishName("fontSubfamily");S=S||k.replace(/\s/g,"")+"-"+E+".otf";var A=this.toArrayBuffer();if(typeof window!="undefined")window.requestFileSystem=window.requestFileSystem||window.webkitRequestFileSystem,window.requestFileSystem(window.TEMPORARY,A.byteLength,function(q){q.root.getFile(S,{create:!0},function(se){se.createWriter(function(ae){var _e=new DataView(A),je=new Blob([_e],{type:"font/opentype"});ae.write(je),ae.addEventListener("writeend",function(){location.href=se.toURL()},!1)})})},function(q){throw new Error(q.name+": "+q.message)});else{var L=n("fs"),V=function(q){for(var se=new a(q.byteLength),ae=new Uint8Array(q),_e=0;_e<se.length;++_e)se[_e]=ae[_e];return se}(A);L.writeFileSync(S,V)}},$.prototype.fsSelectionValues={ITALIC:1,UNDERSCORE:2,NEGATIVE:4,OUTLINED:8,STRIKEOUT:16,BOLD:32,REGULAR:64,USER_TYPO_METRICS:128,WWS:256,OBLIQUE:512},$.prototype.usWidthClasses={ULTRA_CONDENSED:1,EXTRA_CONDENSED:2,CONDENSED:3,SEMI_CONDENSED:4,MEDIUM:5,SEMI_EXPANDED:6,EXPANDED:7,EXTRA_EXPANDED:8,ULTRA_EXPANDED:9},$.prototype.usWeightClasses={THIN:100,EXTRA_LIGHT:200,LIGHT:300,NORMAL:400,MEDIUM:500,SEMI_BOLD:600,BOLD:700,EXTRA_BOLD:800,BLACK:900};var Ie={make:function(S,k){var E,A,L,V,q=new St.Table("fvar",[{name:"version",type:"ULONG",value:65536},{name:"offsetToData",type:"USHORT",value:0},{name:"countSizePairs",type:"USHORT",value:2},{name:"axisCount",type:"USHORT",value:S.axes.length},{name:"axisSize",type:"USHORT",value:20},{name:"instanceCount",type:"USHORT",value:S.instances.length},{name:"instanceSize",type:"USHORT",value:4+4*S.axes.length}]);q.offsetToData=q.sizeOf();for(var se=0;se<S.axes.length;se++)q.fields=q.fields.concat((E=se,A=S.axes[se],L=k,V=U(A.name,L),[{name:"tag_"+E,type:"TAG",value:A.tag},{name:"minValue_"+E,type:"FIXED",value:A.minValue<<16},{name:"defaultValue_"+E,type:"FIXED",value:A.defaultValue<<16},{name:"maxValue_"+E,type:"FIXED",value:A.maxValue<<16},{name:"flags_"+E,type:"USHORT",value:0},{name:"nameID_"+E,type:"USHORT",value:V}]));for(var ae=0;ae<S.instances.length;ae++)q.fields=q.fields.concat(H(ae,S.instances[ae],S.axes,k));return q},parse:function(S,k,E){var A=new Y.Parser(S,k),L=A.parseULong();ye.argument(L===65536,"Unsupported fvar table version.");var V=A.parseOffset16();A.skip("uShort",1);for(var q,se,ae,_e,je,qe=A.parseUShort(),ge=A.parseUShort(),$t=A.parseUShort(),wt=A.parseUShort(),mt=[],st=0;st<qe;st++)mt.push((q=S,se=k+V+st*ge,ae=E,je=_e=void 0,_e={},je=new Y.Parser(q,se),_e.tag=je.parseTag(),_e.minValue=je.parseFixed(),_e.defaultValue=je.parseFixed(),_e.maxValue=je.parseFixed(),je.skip("uShort",1),_e.name=ae[je.parseUShort()]||{},_e));for(var dt=[],Zt=k+V+qe*ge,zt=0;zt<$t;zt++)dt.push(oe(S,Zt+zt*wt,mt,E));return{axes:mt,instances:dt}}},Ce=new Array(10);Ce[1]=function(){var S=this.offset+this.relativeOffset,k=this.parseUShort();return k===1?{posFormat:1,coverage:this.parsePointer(Be.coverage),value:this.parseValueRecord()}:k===2?{posFormat:2,coverage:this.parsePointer(Be.coverage),values:this.parseValueRecordList()}:void ye.assert(!1,"0x"+S.toString(16)+": GPOS lookup type 1 format must be 1 or 2.")},Ce[2]=function(){var S=this.offset+this.relativeOffset,k=this.parseUShort();ye.assert(k===1||k===2,"0x"+S.toString(16)+": GPOS lookup type 2 format must be 1 or 2.");var E=this.parsePointer(Be.coverage),A=this.parseUShort(),L=this.parseUShort();if(k===1)return{posFormat:k,coverage:E,valueFormat1:A,valueFormat2:L,pairSets:this.parseList(Be.pointer(Be.list(function(){return{secondGlyph:this.parseUShort(),value1:this.parseValueRecord(A),value2:this.parseValueRecord(L)}})))};if(k===2){var V=this.parsePointer(Be.classDef),q=this.parsePointer(Be.classDef),se=this.parseUShort(),ae=this.parseUShort();return{posFormat:k,coverage:E,valueFormat1:A,valueFormat2:L,classDef1:V,classDef2:q,class1Count:se,class2Count:ae,classRecords:this.parseList(se,Be.list(ae,function(){return{value1:this.parseValueRecord(A),value2:this.parseValueRecord(L)}}))}}},Ce[3]=function(){return{error:"GPOS Lookup 3 not supported"}},Ce[4]=function(){return{error:"GPOS Lookup 4 not supported"}},Ce[5]=function(){return{error:"GPOS Lookup 5 not supported"}},Ce[6]=function(){return{error:"GPOS Lookup 6 not supported"}},Ce[7]=function(){return{error:"GPOS Lookup 7 not supported"}},Ce[8]=function(){return{error:"GPOS Lookup 8 not supported"}},Ce[9]=function(){return{error:"GPOS Lookup 9 not supported"}};var $e=new Array(10),He={parse:function(S,k){var E=new Be(S,k=k||0),A=E.parseVersion(1);return ye.argument(A===1||A===1.1,"Unsupported GPOS table version "+A),A===1?{version:A,scripts:E.parseScriptList(),features:E.parseFeatureList(),lookups:E.parseLookupList(Ce)}:{version:A,scripts:E.parseScriptList(),features:E.parseFeatureList(),lookups:E.parseLookupList(Ce),variations:E.parseFeatureVariationsList()}},make:function(S){return new St.Table("GPOS",[{name:"version",type:"ULONG",value:65536},{name:"scripts",type:"TABLE",value:new St.ScriptList(S.scripts)},{name:"features",type:"TABLE",value:new St.FeatureList(S.features)},{name:"lookups",type:"TABLE",value:new St.LookupList(S.lookups,$e)}])}},lt={parse:function(S,k){var E=new Y.Parser(S,k),A=E.parseUShort();if(A===0)return function(L){var V={};L.skip("uShort");var q=L.parseUShort();ye.argument(q===0,"Unsupported kern sub-table version."),L.skip("uShort",2);var se=L.parseUShort();L.skip("uShort",3);for(var ae=0;ae<se;ae+=1){var _e=L.parseUShort(),je=L.parseUShort(),qe=L.parseShort();V[_e+","+je]=qe}return V}(E);if(A===1)return function(L){var V={};L.skip("uShort"),1<L.parseULong()&&console.warn("Only the first kern subtable is supported."),L.skip("uLong");var q=255&L.parseUShort();if(L.skip("uShort"),q==0){var se=L.parseUShort();L.skip("uShort",3);for(var ae=0;ae<se;ae+=1){var _e=L.parseUShort(),je=L.parseUShort(),qe=L.parseShort();V[_e+","+je]=qe}}return V}(E);throw new Error("Unsupported kern table version ("+A+").")}},Ct={parse:function(S,k,E,A){for(var L=new Y.Parser(S,k),V=A?L.parseUShort:L.parseULong,q=[],se=0;se<E+1;se+=1){var ae=V.call(L);A&&(ae*=2),q.push(ae)}return q}};function jt(S,k){n("fs").readFile(S,function(E,A){if(E)return k(E.message);k(null,lh(A))})}function wn(S,k){var E=new XMLHttpRequest;E.open("get",S,!0),E.responseType="arraybuffer",E.onload=function(){return E.response?k(null,E.response):k("Font could not be loaded: "+E.statusText)},E.onerror=function(){k("Font could not be loaded")},E.send()}function on(S,k){for(var E=[],A=12,L=0;L<k;L+=1){var V=Y.getTag(S,A),q=Y.getULong(S,A+4),se=Y.getULong(S,A+8),ae=Y.getULong(S,A+12);E.push({tag:V,checksum:q,offset:se,length:ae,compression:!1}),A+=16}return E}function It(S,k){if(k.compression!=="WOFF")return{data:S,offset:k.offset};var E=new Uint8Array(S.buffer,k.offset+2,k.compressedLength-2),A=new Uint8Array(k.length);if(K(E,A),A.byteLength!==k.length)throw new Error("Decompression error: "+k.tag+" decompressed length doesn't match recorded length");return{data:new DataView(A.buffer,0),offset:0}}function bn(S){var k,E,A,L,V,q,se,ae,_e,je,qe,ge,$t,wt,mt=new $({empty:!0}),st=new DataView(S,0),dt=[],Zt=Y.getTag(st,0);if(Zt===String.fromCharCode(0,1,0,0)||Zt==="true"||Zt==="typ1")mt.outlinesFormat="truetype",dt=on(st,A=Y.getUShort(st,4));else if(Zt==="OTTO")mt.outlinesFormat="cff",dt=on(st,A=Y.getUShort(st,4));else{if(Zt!=="wOFF")throw new Error("Unsupported OpenType signature "+Zt);var zt=Y.getTag(st,4);if(zt===String.fromCharCode(0,1,0,0))mt.outlinesFormat="truetype";else{if(zt!=="OTTO")throw new Error("Unsupported OpenType flavor "+Zt);mt.outlinesFormat="cff"}dt=function(Qn,Xr){for(var Vn=[],fr=44,Si=0;Si<Xr;Si+=1){var ri=Y.getTag(Qn,fr),_i=Y.getULong(Qn,fr+4),zs=Y.getULong(Qn,fr+8),Jn=Y.getULong(Qn,fr+12),Hl=void 0;Hl=zs<Jn&&"WOFF",Vn.push({tag:ri,offset:_i,compression:Hl,compressedLength:zs,length:Jn}),fr+=20}return Vn}(st,A=Y.getUShort(st,12))}for(var Bn=0;Bn<A;Bn+=1){var un=dt[Bn],yn=void 0;switch(un.tag){case"cmap":yn=It(st,un),mt.tables.cmap=le.parse(yn.data,yn.offset),mt.encoding=new vt(mt.tables.cmap);break;case"cvt ":yn=It(st,un),wt=new Y.Parser(yn.data,yn.offset),mt.tables.cvt=wt.parseShortList(un.length/2);break;case"fvar":V=un;break;case"fpgm":yn=It(st,un),wt=new Y.Parser(yn.data,yn.offset),mt.tables.fpgm=wt.parseByteList(un.length);break;case"head":yn=It(st,un),mt.tables.head=Xt.parse(yn.data,yn.offset),mt.unitsPerEm=mt.tables.head.unitsPerEm,k=mt.tables.head.indexToLocFormat;break;case"hhea":yn=It(st,un),mt.tables.hhea=yt.parse(yn.data,yn.offset),mt.ascender=mt.tables.hhea.ascender,mt.descender=mt.tables.hhea.descender,mt.numberOfHMetrics=mt.tables.hhea.numberOfHMetrics;break;case"hmtx":_e=un;break;case"ltag":yn=It(st,un),E=En.parse(yn.data,yn.offset);break;case"maxp":yn=It(st,un),mt.tables.maxp=Yn.parse(yn.data,yn.offset),mt.numGlyphs=mt.tables.maxp.numGlyphs;break;case"name":ge=un;break;case"OS/2":yn=It(st,un),mt.tables.os2=_a.parse(yn.data,yn.offset);break;case"post":yn=It(st,un),mt.tables.post=Bu.parse(yn.data,yn.offset),mt.glyphNames=new Mt(mt.tables.post);break;case"prep":yn=It(st,un),wt=new Y.Parser(yn.data,yn.offset),mt.tables.prep=wt.parseByteList(un.length);break;case"glyf":q=un;break;case"loca":qe=un;break;case"CFF ":L=un;break;case"kern":je=un;break;case"GPOS":se=un;break;case"GSUB":ae=un;break;case"meta":$t=un}}var Or=It(st,ge);if(mt.tables.name=ju.parse(Or.data,Or.offset,E),mt.names=mt.tables.name,q&&qe){var Zn=k===0,qn=It(st,qe),Fn=Ct.parse(qn.data,qn.offset,mt.numGlyphs,Zn),Ve=It(st,q);mt.glyphs=Ys.parse(Ve.data,Ve.offset,Fn,mt)}else{if(!L)throw new Error("Font doesn't contain TrueType or CFF outlines.");var it=It(st,L);kt.parse(it.data,it.offset,mt)}var nt=It(st,_e);if(_n.parse(nt.data,nt.offset,mt.numberOfHMetrics,mt.numGlyphs,mt.glyphs),function(Qn){for(var Xr,Vn=Qn.tables.cmap.glyphIndexMap,fr=Object.keys(Vn),Si=0;Si<fr.length;Si+=1){var ri=fr[Si],_i=Vn[ri];(Xr=Qn.glyphs.get(_i)).addUnicode(parseInt(ri))}for(var zs=0;zs<Qn.glyphs.length;zs+=1)Xr=Qn.glyphs.get(zs),Qn.cffEncoding?Qn.isCIDFont?Xr.name="gid"+zs:Xr.name=Qn.cffEncoding.charset[zs]:Qn.glyphNames.names&&(Xr.name=Qn.glyphNames.glyphIndexToName(zs))}(mt),je){var Ot=It(st,je);mt.kerningPairs=lt.parse(Ot.data,Ot.offset)}else mt.kerningPairs={};if(se){var Ht=It(st,se);mt.tables.gpos=He.parse(Ht.data,Ht.offset),mt.position.init()}if(ae){var vn=It(st,ae);mt.tables.gsub=Uu.parse(vn.data,vn.offset)}if(V){var $n=It(st,V);mt.tables.fvar=Ie.parse($n.data,$n.offset,mt.names)}if($t){var Tn=It(st,$t);mt.tables.meta=Pl.parse(Tn.data,Tn.offset),mt.metas=mt.tables.meta}return mt}u.Font=$,u.Glyph=dn,u.Path=ce,u.BoundingBox=re,u._parse=Y,u.parse=bn,u.load=function(S,k){(typeof window=="undefined"?jt:wn)(S,function(E,A){if(E)return k(E);var L;try{L=bn(A)}catch(V){return k(V,null)}return k(null,L)})},u.loadSync=function(S){return bn(lh(n("fs").readFileSync(S)))},Object.defineProperty(u,"__esModule",{value:!0})},l(typeof o=="object"&&s!==void 0?o:i.opentype={})}).call(this,n("buffer").Buffer)},{buffer:4,fs:2}],240:[function(n,s,o){(function(a){function i(h,d){for(var c=0,f=h.length-1;0<=f;f--){var p=h[f];p==="."?h.splice(f,1):p===".."?(h.splice(f,1),c++):c&&(h.splice(f,1),c--)}if(d)for(;c--;)h.unshift("..");return h}function l(h,d){if(h.filter)return h.filter(d);for(var c=[],f=0;f<h.length;f++)d(h[f],f,h)&&c.push(h[f]);return c}o.resolve=function(){for(var h="",d=!1,c=arguments.length-1;-1<=c&&!d;c--){var f=0<=c?arguments[c]:a.cwd();if(typeof f!="string")throw new TypeError("Arguments to path.resolve must be strings");f&&(h=f+"/"+h,d=f.charAt(0)==="/")}return(d?"/":"")+(h=i(l(h.split("/"),function(p){return!!p}),!d).join("/"))||"."},o.normalize=function(h){var d=o.isAbsolute(h),c=u(h,-1)==="/";return(h=i(l(h.split("/"),function(f){return!!f}),!d).join("/"))||d||(h="."),h&&c&&(h+="/"),(d?"/":"")+h},o.isAbsolute=function(h){return h.charAt(0)==="/"},o.join=function(){var h=Array.prototype.slice.call(arguments,0);return o.normalize(l(h,function(d,c){if(typeof d!="string")throw new TypeError("Arguments to path.join must be strings");return d}).join("/"))},o.relative=function(h,d){function c(b){for(var w=0;w<b.length&&b[w]==="";w++);for(var _=b.length-1;0<=_&&b[_]==="";_--);return _<w?[]:b.slice(w,_-w+1)}h=o.resolve(h).substr(1),d=o.resolve(d).substr(1);for(var f=c(h.split("/")),p=c(d.split("/")),m=Math.min(f.length,p.length),g=m,y=0;y<m;y++)if(f[y]!==p[y]){g=y;break}var v=[];for(y=g;y<f.length;y++)v.push("..");return(v=v.concat(p.slice(g))).join("/")},o.sep="/",o.delimiter=":",o.dirname=function(h){if(typeof h!="string"&&(h+=""),h.length===0)return".";for(var d=h.charCodeAt(0),c=d===47,f=-1,p=!0,m=h.length-1;1<=m;--m)if((d=h.charCodeAt(m))===47){if(!p){f=m;break}}else p=!1;return f===-1?c?"/":".":c&&f===1?"/":h.slice(0,f)},o.basename=function(h,d){var c=function(f){typeof f!="string"&&(f+="");var p,m=0,g=-1,y=!0;for(p=f.length-1;0<=p;--p)if(f.charCodeAt(p)===47){if(!y){m=p+1;break}}else g===-1&&(y=!1,g=p+1);return g===-1?"":f.slice(m,g)}(h);return d&&c.substr(-1*d.length)===d&&(c=c.substr(0,c.length-d.length)),c},o.extname=function(h){typeof h!="string"&&(h+="");for(var d=-1,c=0,f=-1,p=!0,m=0,g=h.length-1;0<=g;--g){var y=h.charCodeAt(g);if(y===47){if(p)continue;c=g+1;break}f===-1&&(p=!1,f=g+1),y===46?d===-1?d=g:m!==1&&(m=1):d!==-1&&(m=-1)}return d===-1||f===-1||m===0||m===1&&d===f-1&&d===c+1?"":h.slice(d,f)};var u="ab".substr(-1)==="b"?function(h,d,c){return h.substr(d,c)}:function(h,d,c){return d<0&&(d=h.length+d),h.substr(d,c)}}).call(this,n("_process"))},{_process:241}],241:[function(n,s,o){var a,i,l=s.exports={};function u(){throw new Error("setTimeout has not been defined")}function h(){throw new Error("clearTimeout has not been defined")}function d(w){if(a===setTimeout)return setTimeout(w,0);if((a===u||!a)&&setTimeout)return a=setTimeout,setTimeout(w,0);try{return a(w,0)}catch{try{return a.call(null,w,0)}catch{return a.call(this,w,0)}}}(function(){try{a=typeof setTimeout=="function"?setTimeout:u}catch{a=u}try{i=typeof clearTimeout=="function"?clearTimeout:h}catch{i=h}})();var c,f=[],p=!1,m=-1;function g(){p&&c&&(p=!1,c.length?f=c.concat(f):m=-1,f.length&&y())}function y(){if(!p){var w=d(g);p=!0;for(var _=f.length;_;){for(c=f,f=[];++m<_;)c&&c[m].run();m=-1,_=f.length}c=null,p=!1,function(I){if(i===clearTimeout)return clearTimeout(I);if((i===h||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(I);try{i(I)}catch{try{return i.call(null,I)}catch{return i.call(this,I)}}}(w)}}function v(w,_){this.fun=w,this.array=_}function b(){}l.nextTick=function(w){var _=new Array(arguments.length-1);if(1<arguments.length)for(var I=1;I<arguments.length;I++)_[I-1]=arguments[I];f.push(new v(w,_)),f.length!==1||p||d(y)},v.prototype.run=function(){this.fun.apply(null,this.array)},l.title="browser",l.browser=!0,l.env={},l.argv=[],l.version="",l.versions={},l.on=b,l.addListener=b,l.once=b,l.off=b,l.removeListener=b,l.removeAllListeners=b,l.emit=b,l.prependListener=b,l.prependOnceListener=b,l.listeners=function(w){return[]},l.binding=function(w){throw new Error("process.binding is not supported")},l.cwd=function(){return"/"},l.chdir=function(w){throw new Error("process.chdir is not supported")},l.umask=function(){return 0}},{}],242:[function(n,s,o){(function(a){if(!a.fetch){var i="URLSearchParams"in a,l="Symbol"in a&&"iterator"in Symbol,u="FileReader"in a&&"Blob"in a&&function(){try{return new Blob,!0}catch{return!1}}(),h="FormData"in a,d="ArrayBuffer"in a;if(d)var c=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],f=function(F){return F&&DataView.prototype.isPrototypeOf(F)},p=ArrayBuffer.isView||function(F){return F&&-1<c.indexOf(Object.prototype.toString.call(F))};w.prototype.append=function(F,B){F=y(F),B=v(B);var z=this.map[F];this.map[F]=z?z+","+B:B},w.prototype.delete=function(F){delete this.map[y(F)]},w.prototype.get=function(F){return F=y(F),this.has(F)?this.map[F]:null},w.prototype.has=function(F){return this.map.hasOwnProperty(y(F))},w.prototype.set=function(F,B){this.map[y(F)]=v(B)},w.prototype.forEach=function(F,B){for(var z in this.map)this.map.hasOwnProperty(z)&&F.call(B,this.map[z],z,this)},w.prototype.keys=function(){var F=[];return this.forEach(function(B,z){F.push(z)}),b(F)},w.prototype.values=function(){var F=[];return this.forEach(function(B){F.push(B)}),b(F)},w.prototype.entries=function(){var F=[];return this.forEach(function(B,z){F.push([z,B])}),b(F)},l&&(w.prototype[Symbol.iterator]=w.prototype.entries);var m=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];D.prototype.clone=function(){return new D(this,{body:this._bodyInit})},O.call(D.prototype),O.call(P.prototype),P.prototype.clone=function(){return new P(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new w(this.headers),url:this.url})},P.error=function(){var F=new P(null,{status:0,statusText:""});return F.type="error",F};var g=[301,302,303,307,308];P.redirect=function(F,B){if(g.indexOf(B)===-1)throw new RangeError("Invalid status code");return new P(null,{status:B,headers:{location:F}})},a.Headers=w,a.Request=D,a.Response=P,a.fetch=function(F,B){return new Promise(function(z,Z){var Q=new D(F,B),K=new XMLHttpRequest;K.onload=function(){var ne,re,ce={status:K.status,statusText:K.statusText,headers:(ne=K.getAllResponseHeaders()||"",re=new w,ne.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach(function(we){var ye=we.split(":"),Oe=ye.shift().trim();if(Oe){var Se=ye.join(":").trim();re.append(Oe,Se)}}),re)};ce.url="responseURL"in K?K.responseURL:ce.headers.get("X-Request-URL");var be="response"in K?K.response:K.responseText;z(new P(be,ce))},K.onerror=function(){Z(new TypeError("Network request failed"))},K.ontimeout=function(){Z(new TypeError("Network request failed"))},K.open(Q.method,Q.url,!0),Q.credentials==="include"?K.withCredentials=!0:Q.credentials==="omit"&&(K.withCredentials=!1),"responseType"in K&&u&&(K.responseType="blob"),Q.headers.forEach(function(ne,re){K.setRequestHeader(re,ne)}),K.send(Q._bodyInit===void 0?null:Q._bodyInit)})},a.fetch.polyfill=!0}function y(F){if(typeof F!="string"&&(F=String(F)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(F))throw new TypeError("Invalid character in header field name");return F.toLowerCase()}function v(F){return typeof F!="string"&&(F=String(F)),F}function b(F){var B={next:function(){var z=F.shift();return{done:z===void 0,value:z}}};return l&&(B[Symbol.iterator]=function(){return B}),B}function w(F){this.map={},F instanceof w?F.forEach(function(B,z){this.append(z,B)},this):Array.isArray(F)?F.forEach(function(B){this.append(B[0],B[1])},this):F&&Object.getOwnPropertyNames(F).forEach(function(B){this.append(B,F[B])},this)}function _(F){if(F.bodyUsed)return Promise.reject(new TypeError("Already read"));F.bodyUsed=!0}function I(F){return new Promise(function(B,z){F.onload=function(){B(F.result)},F.onerror=function(){z(F.error)}})}function C(F){var B=new FileReader,z=I(B);return B.readAsArrayBuffer(F),z}function N(F){if(F.slice)return F.slice(0);var B=new Uint8Array(F.byteLength);return B.set(new Uint8Array(F)),B.buffer}function O(){return this.bodyUsed=!1,this._initBody=function(F){if(this._bodyInit=F)if(typeof F=="string")this._bodyText=F;else if(u&&Blob.prototype.isPrototypeOf(F))this._bodyBlob=F;else if(h&&FormData.prototype.isPrototypeOf(F))this._bodyFormData=F;else if(i&&URLSearchParams.prototype.isPrototypeOf(F))this._bodyText=F.toString();else if(d&&u&&f(F))this._bodyArrayBuffer=N(F.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!d||!ArrayBuffer.prototype.isPrototypeOf(F)&&!p(F))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=N(F)}else this._bodyText="";this.headers.get("content-type")||(typeof F=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):i&&URLSearchParams.prototype.isPrototypeOf(F)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},u&&(this.blob=function(){var F=_(this);if(F)return F;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?_(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(C)}),this.text=function(){var F,B,z,Z=_(this);if(Z)return Z;if(this._bodyBlob)return F=this._bodyBlob,B=new FileReader,z=I(B),B.readAsText(F),z;if(this._bodyArrayBuffer)return Promise.resolve(function(Q){for(var K=new Uint8Array(Q),ne=new Array(K.length),re=0;re<K.length;re++)ne[re]=String.fromCharCode(K[re]);return ne.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},h&&(this.formData=function(){return this.text().then(M)}),this.json=function(){return this.text().then(JSON.parse)},this}function D(F,B){var z,Z,Q=(B=B||{}).body;if(F instanceof D){if(F.bodyUsed)throw new TypeError("Already read");this.url=F.url,this.credentials=F.credentials,B.headers||(this.headers=new w(F.headers)),this.method=F.method,this.mode=F.mode,Q||F._bodyInit==null||(Q=F._bodyInit,F.bodyUsed=!0)}else this.url=String(F);if(this.credentials=B.credentials||this.credentials||"omit",!B.headers&&this.headers||(this.headers=new w(B.headers)),this.method=(z=B.method||this.method||"GET",Z=z.toUpperCase(),-1<m.indexOf(Z)?Z:z),this.mode=B.mode||this.mode||null,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&Q)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(Q)}function M(F){var B=new FormData;return F.trim().split("&").forEach(function(z){if(z){var Z=z.split("="),Q=Z.shift().replace(/\+/g," "),K=Z.join("=").replace(/\+/g," ");B.append(decodeURIComponent(Q),decodeURIComponent(K))}}),B}function P(F,B){B=B||{},this.type="default",this.status=B.status===void 0?200:B.status,this.ok=200<=this.status&&this.status<300,this.statusText="statusText"in B?B.statusText:"OK",this.headers=new w(B.headers),this.url=B.url||"",this._initBody(F)}})(typeof self!="undefined"?self:this)},{}],243:[function(n,s,o){n("core-js/modules/es.function.name"),n("core-js/modules/es.object.to-string"),n("core-js/modules/es.regexp.exec"),n("core-js/modules/es.regexp.to-string"),n("core-js/modules/es.string.split"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var a,i=u(n("../core/main")),l=u(n("../color/color_conversion"));function u(f){return f&&f.__esModule?f:{default:f}}var h=[{h:0,s:0,b:.8275,name:"gray"},{h:0,s:0,b:.8627,name:"gray"},{h:0,s:0,b:.7529,name:"gray"},{h:.0167,s:.1176,b:1,name:"light pink"}],d=[{h:0,s:0,b:0,name:"black"},{h:0,s:0,b:.5,name:"gray"},{h:0,s:0,b:1,name:"white"},{h:0,s:.5,b:.5,name:"dark maroon"},{h:0,s:.5,b:1,name:"salmon pink"},{h:0,s:1,b:0,name:"black"},{h:0,s:1,b:.5,name:"dark red"},{h:0,s:1,b:1,name:"red"},{h:5,s:0,b:1,name:"very light peach"},{h:5,s:.5,b:.5,name:"brown"},{h:5,s:.5,b:1,name:"peach"},{h:5,s:1,b:.5,name:"brick red"},{h:5,s:1,b:1,name:"crimson"},{h:10,s:0,b:1,name:"light peach"},{h:10,s:.5,b:.5,name:"brown"},{h:10,s:.5,b:1,name:"light orange"},{h:10,s:1,b:.5,name:"brown"},{h:10,s:1,b:1,name:"orange"},{h:15,s:0,b:1,name:"very light yellow"},{h:15,s:.5,b:.5,name:"olive green"},{h:15,s:.5,b:1,name:"light yellow"},{h:15,s:1,b:0,name:"dark olive green"},{h:15,s:1,b:.5,name:"olive green"},{h:15,s:1,b:1,name:"yellow"},{h:20,s:0,b:1,name:"very light yellow"},{h:20,s:.5,b:.5,name:"olive green"},{h:20,s:.5,b:1,name:"light yellow green"},{h:20,s:1,b:0,name:"dark olive green"},{h:20,s:1,b:.5,name:"dark yellow green"},{h:20,s:1,b:1,name:"yellow green"},{h:25,s:.5,b:.5,name:"dark yellow green"},{h:25,s:.5,b:1,name:"light green"},{h:25,s:1,b:.5,name:"dark green"},{h:25,s:1,b:1,name:"green"},{h:30,s:.5,b:1,name:"light green"},{h:30,s:1,b:.5,name:"dark green"},{h:30,s:1,b:1,name:"green"},{h:35,s:0,b:.5,name:"light green"},{h:35,s:0,b:1,name:"very light green"},{h:35,s:.5,b:.5,name:"dark green"},{h:35,s:.5,b:1,name:"light green"},{h:35,s:1,b:0,name:"very dark green"},{h:35,s:1,b:.5,name:"dark green"},{h:35,s:1,b:1,name:"green"},{h:40,s:0,b:1,name:"very light green"},{h:40,s:.5,b:.5,name:"dark green"},{h:40,s:.5,b:1,name:"light green"},{h:40,s:1,b:.5,name:"dark green"},{h:40,s:1,b:1,name:"green"},{h:45,s:.5,b:1,name:"light turquoise"},{h:45,s:1,b:.5,name:"dark turquoise"},{h:45,s:1,b:1,name:"turquoise"},{h:50,s:0,b:1,name:"light sky blue"},{h:50,s:.5,b:.5,name:"dark cyan"},{h:50,s:.5,b:1,name:"light cyan"},{h:50,s:1,b:.5,name:"dark cyan"},{h:50,s:1,b:1,name:"cyan"},{h:55,s:0,b:1,name:"light sky blue"},{h:55,s:.5,b:1,name:"light sky blue"},{h:55,s:1,b:.5,name:"dark blue"},{h:55,s:1,b:1,name:"sky blue"},{h:60,s:0,b:.5,name:"gray"},{h:60,s:0,b:1,name:"very light blue"},{h:60,s:.5,b:.5,name:"blue"},{h:60,s:.5,b:1,name:"light blue"},{h:60,s:1,b:.5,name:"navy blue"},{h:60,s:1,b:1,name:"blue"},{h:65,s:0,b:1,name:"lavender"},{h:65,s:.5,b:.5,name:"navy blue"},{h:65,s:.5,b:1,name:"light purple"},{h:65,s:1,b:.5,name:"dark navy blue"},{h:65,s:1,b:1,name:"blue"},{h:70,s:0,b:1,name:"lavender"},{h:70,s:.5,b:.5,name:"navy blue"},{h:70,s:.5,b:1,name:"lavender blue"},{h:70,s:1,b:.5,name:"dark navy blue"},{h:70,s:1,b:1,name:"blue"},{h:75,s:.5,b:1,name:"lavender"},{h:75,s:1,b:.5,name:"dark purple"},{h:75,s:1,b:1,name:"purple"},{h:80,s:.5,b:1,name:"pinkish purple"},{h:80,s:1,b:.5,name:"dark purple"},{h:80,s:1,b:1,name:"purple"},{h:85,s:0,b:1,name:"light pink"},{h:85,s:.5,b:.5,name:"purple"},{h:85,s:.5,b:1,name:"light fuchsia"},{h:85,s:1,b:.5,name:"dark fuchsia"},{h:85,s:1,b:1,name:"fuchsia"},{h:90,s:.5,b:.5,name:"dark fuchsia"},{h:90,s:.5,b:1,name:"hot pink"},{h:90,s:1,b:.5,name:"dark fuchsia"},{h:90,s:1,b:1,name:"fuchsia"},{h:95,s:0,b:1,name:"pink"},{h:95,s:.5,b:1,name:"light pink"},{h:95,s:1,b:.5,name:"dark magenta"},{h:95,s:1,b:1,name:"magenta"}];i.default.prototype._rgbColorName=function(f){var p=l.default._rgbaToHSBA(f);return function(m){var g;if(m[0]!==0){m[0]=Math.round(100*m[0]);var y=m[0].toString().split(""),v=y.length-1;y[v]=parseInt(y[v]),y[v]<2.5?y[v]=0:2.5<=y[v]&&y[v]<7.5&&(y[v]=5),y.length===2?(y[0]=parseInt(y[0]),7.5<=y[v]&&(y[v]=0,y[0]=y[0]+1),m[0]=10*y[0]+y[1]):7.5<=y[v]?m[0]=10:m[0]=y[v]}m[2]=m[2]/255;for(var b=m.length-1;1<=b;b--)m[b]<=.25?m[b]=0:.25<m[b]&&m[b]<.75?m[b]=.5:m[b]=1;if(m[0]===0&&m[1]===0&&m[2]===1){for(var w=2;0<=w;w--)a[w]=Math.round(1e4*a[w])/1e4;for(var _=0;_<h.length;_++){if(h[_].h===a[0]&&h[_].s===a[1]&&h[_].b===a[2]){g=h[_].name;break}g="white"}}else for(var I=0;I<d.length;I++)if(d[I].h===m[0]&&d[I].s===m[1]&&d[I].b===m[2]){g=d[I].name;break}return g}([(a=p)[0],p[1],p[2]])};var c=i.default;o.default=c},{"../color/color_conversion":249,"../core/main":264,"core-js/modules/es.function.name":166,"core-js/modules/es.object.to-string":177,"core-js/modules/es.regexp.exec":181,"core-js/modules/es.regexp.to-string":182,"core-js/modules/es.string.split":191}],244:[function(n,s,o){n("core-js/modules/es.array.concat"),n("core-js/modules/es.regexp.exec"),n("core-js/modules/es.string.ends-with"),n("core-js/modules/es.string.replace"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var a,i=(a=n("../core/main"))&&a.__esModule?a:{default:a},l="_Description",u="_fallbackDesc",h="_fallbackTable",d="_Label",c="_labelDesc",f="_labelTable";function p(g){if(g==="label"||g==="fallback")throw new Error("description should not be LABEL or FALLBACK");return g.endsWith(".")||g.endsWith(";")||g.endsWith(",")||g.endsWith("?")||g.endsWith("!")||(g+="."),g}i.default.prototype.describe=function(g,y){if(i.default._validateParameters("describe",arguments),typeof g=="string"){var v=this.canvas.id;g=p(g),this.dummyDOM||(this.dummyDOM=document.getElementById(v).parentNode),this.descriptions||(this.descriptions={}),this.descriptions.fallback?this.descriptions.fallback.innerHTML!==g&&(this.descriptions.fallback.innerHTML=g):this._describeHTML("fallback",g),y===this.LABEL&&(this.descriptions.label?this.descriptions.label.innerHTML!==g&&(this.descriptions.label.innerHTML=g):this._describeHTML("label",g))}},i.default.prototype.describeElement=function(g,y,v){if(i.default._validateParameters("describeElement",arguments),typeof y=="string"&&typeof g=="string"){var b=this.canvas.id;y=p(y);var w=function(I){if(I==="label"||I==="fallback")throw new Error("element name should not be LABEL or FALLBACK");return I.endsWith(".")||I.endsWith(";")||I.endsWith(",")?I=I.replace(/.$/,":"):I.endsWith(":")||(I+=":"),I}(g);g=g.replace(/[^a-zA-Z0-9]/g,"");var _='<th scope="row">'.concat(w,"</th><td>").concat(y,"</td>");this.dummyDOM||(this.dummyDOM=document.getElementById(b).parentNode),this.descriptions?this.descriptions.fallbackElements||(this.descriptions.fallbackElements={}):this.descriptions={fallbackElements:{}},this.descriptions.fallbackElements[g]?this.descriptions.fallbackElements[g].innerHTML!==_&&(this.descriptions.fallbackElements[g].innerHTML=_):this._describeElementHTML("fallback",g,_),v===this.LABEL&&(this.descriptions.labelElements||(this.descriptions.labelElements={}),this.descriptions.labelElements[g]?this.descriptions.labelElements[g].innerHTML!==_&&(this.descriptions.labelElements[g].innerHTML=_):this._describeElementHTML("label",g,_))}},i.default.prototype._describeHTML=function(g,y){var v=this.canvas.id;if(g==="fallback"){if(this.dummyDOM.querySelector("#".concat(v+l)))this.dummyDOM.querySelector("#"+v+h).insertAdjacentHTML("beforebegin",'<p id="'.concat(v+u,'"></p>'));else{var b='<div id="'.concat(v).concat(l,'" role="region" aria-label="Canvas Description"><p id="').concat(v).concat(u,'"></p></div>');this.dummyDOM.querySelector("#".concat(v,"accessibleOutput"))?this.dummyDOM.querySelector("#".concat(v,"accessibleOutput")).insertAdjacentHTML("beforebegin",b):this.dummyDOM.querySelector("#".concat(v)).innerHTML=b}return this.descriptions.fallback=this.dummyDOM.querySelector("#".concat(v).concat(u)),void(this.descriptions.fallback.innerHTML=y)}if(g==="label"){if(this.dummyDOM.querySelector("#".concat(v+d)))this.dummyDOM.querySelector("#".concat(v+f))&&this.dummyDOM.querySelector("#".concat(v+f)).insertAdjacentHTML("beforebegin",'<p id="'.concat(v).concat(c,'"></p>'));else{var w='<div id="'.concat(v).concat(d,'" class="p5Label"><p id="').concat(v).concat(c,'"></p></div>');this.dummyDOM.querySelector("#".concat(v,"accessibleOutputLabel"))?this.dummyDOM.querySelector("#".concat(v,"accessibleOutputLabel")).insertAdjacentHTML("beforebegin",w):this.dummyDOM.querySelector("#"+v).insertAdjacentHTML("afterend",w)}return this.descriptions.label=this.dummyDOM.querySelector("#"+v+c),void(this.descriptions.label.innerHTML=y)}},i.default.prototype._describeElementHTML=function(g,y,v){var b=this.canvas.id;if(g==="fallback"){if(this.dummyDOM.querySelector("#".concat(b+l)))this.dummyDOM.querySelector("#"+b+h)||this.dummyDOM.querySelector("#"+b+u).insertAdjacentHTML("afterend",'<table id="'.concat(b).concat(h,'"><caption>Canvas elements and their descriptions</caption></table>'));else{var w='<div id="'.concat(b).concat(l,'" role="region" aria-label="Canvas Description"><table id="').concat(b).concat(h,'"><caption>Canvas elements and their descriptions</caption></table></div>');this.dummyDOM.querySelector("#".concat(b,"accessibleOutput"))?this.dummyDOM.querySelector("#".concat(b,"accessibleOutput")).insertAdjacentHTML("beforebegin",w):this.dummyDOM.querySelector("#"+b).innerHTML=w}var _=document.createElement("tr");return _.id=b+"_fte_"+y,this.dummyDOM.querySelector("#"+b+h).appendChild(_),this.descriptions.fallbackElements[y]=this.dummyDOM.querySelector("#".concat(b).concat("_fte_").concat(y)),void(this.descriptions.fallbackElements[y].innerHTML=v)}if(g==="label"){if(this.dummyDOM.querySelector("#".concat(b+d)))this.dummyDOM.querySelector("#".concat(b+f))||this.dummyDOM.querySelector("#"+b+c).insertAdjacentHTML("afterend",'<table id="'.concat(b+f,'"></table>'));else{var I='<div id="'.concat(b).concat(d,'" class="p5Label"><table id="').concat(b).concat(f,'"></table></div>');this.dummyDOM.querySelector("#".concat(b,"accessibleOutputLabel"))?this.dummyDOM.querySelector("#".concat(b,"accessibleOutputLabel")).insertAdjacentHTML("beforebegin",I):this.dummyDOM.querySelector("#"+b).insertAdjacentHTML("afterend",I)}var C=document.createElement("tr");C.id=b+"_lte_"+y,this.dummyDOM.querySelector("#"+b+f).appendChild(C),this.descriptions.labelElements[y]=this.dummyDOM.querySelector("#".concat(b).concat("_lte_").concat(y)),this.descriptions.labelElements[y].innerHTML=v}};var m=i.default;o.default=m},{"../core/main":264,"core-js/modules/es.array.concat":149,"core-js/modules/es.regexp.exec":181,"core-js/modules/es.string.ends-with":184,"core-js/modules/es.string.replace":189}],245:[function(n,s,o){n("core-js/modules/es.array.concat"),n("core-js/modules/es.array.map"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var a,i=(a=n("../core/main"))&&a.__esModule?a:{default:a};i.default.prototype._updateGridOutput=function(u){if(this.dummyDOM.querySelector("#".concat(u,"_summary"))){var h=this._accessibleOutputs[u],d=function(p,m){var g="",y="",v=0;for(var b in m){var w=0;for(var _ in m[b]){var I='<li id="'.concat(p,"shape").concat(v,'">').concat(m[b][_].color," ").concat(b,",");b==="line"?I+=" location = ".concat(m[b][_].pos,", length = ").concat(m[b][_].length," pixels"):(I+=" location = ".concat(m[b][_].pos),b!=="point"&&(I+=", area = ".concat(m[b][_].area," %")),I+="</li>"),g+=I,w++,v++}y=1<w?"".concat(y," ").concat(w," ").concat(b,"s"):"".concat(y," ").concat(w," ").concat(b)}return{numShapes:[v,y],details:g}}(u,this.ingredients.shapes),c=function(p,m,g,y){var v="".concat(m," canvas, ").concat(g," by ").concat(y," pixels, contains ").concat(p[0]);return v=p[0]===1?"".concat(v," shape: ").concat(p[1]):"".concat(v," shapes: ").concat(p[1]),v}(d.numShapes,this.ingredients.colors.background,this.width,this.height),f=function(p,m){var g=0,y="",v=Array.apply(null,Array(10)).map(function(){});for(var b in v)v[b]=Array.apply(null,Array(10)).map(function(){});for(var w in m)for(var _ in m[w]){var I=void 0;I=w!=="line"?'<a href="#'.concat(p,"shape").concat(g,'">').concat(m[w][_].color," ").concat(w,"</a>"):'<a href="#'.concat(p,"shape").concat(g,'">').concat(m[w][_].color," ").concat(w," midpoint</a>"),v[m[w][_].loc.locY][m[w][_].loc.locX]?v[m[w][_].loc.locY][m[w][_].loc.locX]=v[m[w][_].loc.locY][m[w][_].loc.locX]+"  "+I:v[m[w][_].loc.locY][m[w][_].loc.locX]=I,g++}for(var C in v){var N="<tr>";for(var O in v[C])N+="<td>",v[C][O]!==void 0&&(N+=v[C][O]),N+="</td>";y=y+N+"</tr>"}return y}(u,this.ingredients.shapes);c!==h.summary.innerHTML&&(h.summary.innerHTML=c),f!==h.map.innerHTML&&(h.map.innerHTML=f),d.details!==h.shapeDetails.innerHTML&&(h.shapeDetails.innerHTML=d.details),this._accessibleOutputs[u]=h}};var l=i.default;o.default=l},{"../core/main":264,"core-js/modules/es.array.concat":149,"core-js/modules/es.array.map":161}],246:[function(n,s,o){n("core-js/modules/es.array.concat"),n("core-js/modules/es.array.fill"),n("core-js/modules/es.array.map"),n("core-js/modules/es.number.to-fixed"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var a,i=(a=n("../core/main"))&&a.__esModule?a:{default:a};function l(d,c,f){return d[0]<.4*c?d[1]<.4*f?"top left":d[1]>.6*f?"bottom left":"mid left":d[0]>.6*c?d[1]<.4*f?"top right":d[1]>.6*f?"bottom right":"mid right":d[1]<.4*f?"top middle":d[1]>.6*f?"bottom middle":"middle"}function u(d,c,f){var p=Math.floor(d[0]/c*10),m=Math.floor(d[1]/f*10);return p===10&&--p,m===10&&--m,{locX:p,locY:m}}i.default.prototype.textOutput=function(d){i.default._validateParameters("textOutput",arguments),this._accessibleOutputs.text||(this._accessibleOutputs.text=!0,this._createOutput("textOutput","Fallback"),d===this.LABEL&&(this._accessibleOutputs.textLabel=!0,this._createOutput("textOutput","Label")))},i.default.prototype.gridOutput=function(d){i.default._validateParameters("gridOutput",arguments),this._accessibleOutputs.grid||(this._accessibleOutputs.grid=!0,this._createOutput("gridOutput","Fallback"),d===this.LABEL&&(this._accessibleOutputs.gridLabel=!0,this._createOutput("gridOutput","Label")))},i.default.prototype._addAccsOutput=function(){return this._accessibleOutputs||(this._accessibleOutputs={text:!1,grid:!1,textLabel:!1,gridLabel:!1}),this._accessibleOutputs.grid||this._accessibleOutputs.text},i.default.prototype._createOutput=function(d,c){var f,p,m,g=this.canvas.id;this.ingredients||(this.ingredients={shapes:{},colors:{background:"white",fill:"white",stroke:"black"},pShapes:""}),this.dummyDOM||(this.dummyDOM=document.getElementById(g).parentNode);var y="";c==="Fallback"?(f=g+d,p=g+"accessibleOutput",this.dummyDOM.querySelector("#".concat(p))||(this.dummyDOM.querySelector("#".concat(g,"_Description"))?this.dummyDOM.querySelector("#".concat(g,"_Description")).insertAdjacentHTML("afterend",'<div id="'.concat(p,'" role="region" aria-label="Canvas Outputs"></div>')):this.dummyDOM.querySelector("#".concat(g)).innerHTML='<div id="'.concat(p,'" role="region" aria-label="Canvas Outputs"></div>'))):c==="Label"&&(f=g+d+(y=c),p=g+"accessibleOutput"+c,this.dummyDOM.querySelector("#".concat(p))||(this.dummyDOM.querySelector("#".concat(g,"_Label"))?this.dummyDOM.querySelector("#".concat(g,"_Label")).insertAdjacentHTML("afterend",'<div id="'.concat(p,'"></div>')):this.dummyDOM.querySelector("#".concat(g)).insertAdjacentHTML("afterend",'<div id="'.concat(p,'"></div>')))),this._accessibleOutputs[f]={},d==="textOutput"?(y="#".concat(g,"gridOutput").concat(y),m='<div id="'.concat(f,'">Text Output<div id="').concat(f,'Summary" aria-label="text output summary"><p id="').concat(f,'_summary"></p><ul id="').concat(f,'_list"></ul></div><table id="').concat(f,'_shapeDetails" summary="text output shape details"></table></div>'),this.dummyDOM.querySelector(y)?this.dummyDOM.querySelector(y).insertAdjacentHTML("beforebegin",m):this.dummyDOM.querySelector("#".concat(p)).innerHTML=m,this._accessibleOutputs[f].list=this.dummyDOM.querySelector("#".concat(f,"_list"))):d==="gridOutput"&&(y="#".concat(g,"textOutput").concat(y),m='<div id="'.concat(f,'">Grid Output<p id="').concat(f,'_summary" aria-label="grid output summary"><table id="').concat(f,'_map" summary="grid output content"></table><ul id="').concat(f,'_shapeDetails" aria-label="grid output shape details"></ul></div>'),this.dummyDOM.querySelector(y)?this.dummyDOM.querySelector(y).insertAdjacentHTML("afterend",m):this.dummyDOM.querySelector("#".concat(p)).innerHTML=m,this._accessibleOutputs[f].map=this.dummyDOM.querySelector("#".concat(f,"_map"))),this._accessibleOutputs[f].shapeDetails=this.dummyDOM.querySelector("#".concat(f,"_shapeDetails")),this._accessibleOutputs[f].summary=this.dummyDOM.querySelector("#".concat(f,"_summary"))},i.default.prototype._updateAccsOutput=function(){var d=this.canvas.id;JSON.stringify(this.ingredients.shapes)!==this.ingredients.pShapes&&(this.ingredients.pShapes=JSON.stringify(this.ingredients.shapes),this._accessibleOutputs.text&&this._updateTextOutput(d+"textOutput"),this._accessibleOutputs.grid&&this._updateGridOutput(d+"gridOutput"),this._accessibleOutputs.textLabel&&this._updateTextOutput(d+"textOutputLabel"),this._accessibleOutputs.gridLabel&&this._updateGridOutput(d+"gridOutputLabel"))},i.default.prototype._accsBackground=function(d){this.ingredients.pShapes=JSON.stringify(this.ingredients.shapes),this.ingredients.shapes={},this.ingredients.colors.backgroundRGBA!==d&&(this.ingredients.colors.backgroundRGBA=d,this.ingredients.colors.background=this._rgbColorName(d))},i.default.prototype._accsCanvasColors=function(d,c){d==="fill"?this.ingredients.colors.fillRGBA!==c&&(this.ingredients.colors.fillRGBA=c,this.ingredients.colors.fill=this._rgbColorName(c)):d==="stroke"&&this.ingredients.colors.strokeRGBA!==c&&(this.ingredients.colors.strokeRGBA=c,this.ingredients.colors.stroke=this._rgbColorName(c))},i.default.prototype._accsOutput=function(d,c){d==="ellipse"&&c[2]===c[3]?d="circle":d==="rectangle"&&c[2]===c[3]&&(d="square");var f={},p=!0,m=function(b,w){var _,I;return I=b==="rectangle"||b==="ellipse"||b==="arc"||b==="circle"||b==="square"?(_=Math.round(w[0]+w[2]/2),Math.round(w[1]+w[3]/2)):b==="triangle"?(_=(w[0]+w[2]+w[4])/3,(w[1]+w[3]+w[5])/3):b==="quadrilateral"?(_=(w[0]+w[2]+w[4]+w[6])/4,(w[1]+w[3]+w[5]+w[7])/4):b==="line"?(_=(w[0]+w[2])/2,(w[1]+w[3])/2):(_=w[0],w[1]),[_,I]}(d,c);if(d==="line"){f.color=this.ingredients.colors.stroke,f.length=Math.round(this.dist(c[0],c[1],c[2],c[3]));var g=l([c[0],[1]],this.width,this.height),y=l([c[2],[3]],this.width,this.height);f.loc=u(m,this.width,this.height),f.pos=g===y?"at ".concat(g):"from ".concat(g," to ").concat(y)}else d==="point"?f.color=this.ingredients.colors.stroke:(f.color=this.ingredients.colors.fill,f.area=function(b,w,_,I){var C=0;if(b==="arc"){var N=((w[5]-w[4])%(2*Math.PI)+2*Math.PI)%(2*Math.PI);if(C=N*w[2]*w[3]/8,w[6]==="open"||w[6]==="chord"){var O=w[0],D=w[1],M=w[0]+w[2]/2*Math.cos(w[4]).toFixed(2),P=w[1]+w[3]/2*Math.sin(w[4]).toFixed(2),F=w[0]+w[2]/2*Math.cos(w[5]).toFixed(2),B=w[1]+w[3]/2*Math.sin(w[5]).toFixed(2),z=Math.abs(O*(P-B)+M*(B-D)+F*(D-P))/2;N>Math.PI?C+=z:C-=z}}else b==="ellipse"||b==="circle"?C=3.14*w[2]/2*w[3]/2:b==="line"||b==="point"?C=0:b==="quadrilateral"?C=Math.abs((w[6]+w[0])*(w[7]-w[1])+(w[0]+w[2])*(w[1]-w[3])+(w[2]+w[4])*(w[3]-w[5])+(w[4]+w[6])*(w[5]-w[7]))/2:b==="rectangle"||b==="square"?C=w[2]*w[3]:b==="triangle"&&(C=Math.abs(w[0]*(w[3]-w[5])+w[2]*(w[5]-w[1])+w[4]*(w[1]-w[3]))/2);return Math.round(100*C/(_*I))}(d,c,this.width,this.height)),f.pos=l(m,this.width,this.height),f.loc=u(m,this.width,this.height);if(this.ingredients.shapes[d]){if(this.ingredients.shapes[d]!==[f]){for(var v in this.ingredients.shapes[d])JSON.stringify(this.ingredients.shapes[d][v])===JSON.stringify(f)&&(p=!1);p===!0&&this.ingredients.shapes[d].push(f)}}else this.ingredients.shapes[d]=[f]};var h=i.default;o.default=h},{"../core/main":264,"core-js/modules/es.array.concat":149,"core-js/modules/es.array.fill":151,"core-js/modules/es.array.map":161,"core-js/modules/es.number.to-fixed":172}],247:[function(n,s,o){n("core-js/modules/es.array.concat"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var a,i=(a=n("../core/main"))&&a.__esModule?a:{default:a};i.default.prototype._updateTextOutput=function(u){if(this.dummyDOM.querySelector("#".concat(u,"_summary"))){var h=this._accessibleOutputs[u],d=function(p,m){var g="",y=0;for(var v in m)for(var b in m[v]){var w='<li><a href="#'.concat(p,"shape").concat(y,'">').concat(m[v][b].color," ").concat(v,"</a>");v==="line"?w+=", ".concat(m[v][b].pos,", ").concat(m[v][b].length," pixels long.</li>"):(w+=", at ".concat(m[v][b].pos),v!=="point"&&(w+=", covering ".concat(m[v][b].area,"% of the canvas")),w+=".</li>"),g+=w,y++}return{numShapes:y,listShapes:g}}(u,this.ingredients.shapes),c=function(p,m,g,y){var v="Your output is a, ".concat(g," by ").concat(y," pixels, ").concat(m," canvas containing the following");return v=p===1?"".concat(v," shape:"):"".concat(v," ").concat(p," shapes:"),v}(d.numShapes,this.ingredients.colors.background,this.width,this.height),f=function(p,m){var g="",y=0;for(var v in m)for(var b in m[v]){var w='<tr id="'.concat(p,"shape").concat(y,'"><th>').concat(m[v][b].color," ").concat(v,"</th>");v==="line"?w+="<td>location = ".concat(m[v][b].pos,"</td><td>length = ").concat(m[v][b].length," pixels</td></tr>"):(w+="<td>location = ".concat(m[v][b].pos,"</td>"),v!=="point"&&(w+="<td> area = ".concat(m[v][b].area,"%</td>")),w+="</tr>"),g+=w,y++}return g}(u,this.ingredients.shapes);c!==h.summary.innerHTML&&(h.summary.innerHTML=c),d.listShapes!==h.list.innerHTML&&(h.list.innerHTML=d.listShapes),f!==h.shapeDetails.innerHTML&&(h.shapeDetails.innerHTML=f),this._accessibleOutputs[u]=h}};var l=i.default;o.default=l},{"../core/main":264,"core-js/modules/es.array.concat":149}],248:[function(n,s,o){var a,i=(a=n("./core/main"))&&a.__esModule?a:{default:a};n("./core/constants"),n("./core/environment"),n("./core/friendly_errors/stacktrace"),n("./core/friendly_errors/validate_params"),n("./core/friendly_errors/file_errors"),n("./core/friendly_errors/fes_core"),n("./core/friendly_errors/sketch_reader"),n("./core/helpers"),n("./core/legacy"),n("./core/preload"),n("./core/p5.Element"),n("./core/p5.Graphics"),n("./core/p5.Renderer"),n("./core/p5.Renderer2D"),n("./core/rendering"),n("./core/shim"),n("./core/structure"),n("./core/transform"),n("./core/shape/2d_primitives"),n("./core/shape/attributes"),n("./core/shape/curves"),n("./core/shape/vertex"),n("./accessibility/outputs"),n("./accessibility/textOutput"),n("./accessibility/gridOutput"),n("./accessibility/color_namer"),n("./color/color_conversion"),n("./color/creating_reading"),n("./color/p5.Color"),n("./color/setting"),n("./data/p5.TypedDict"),n("./data/local_storage.js"),n("./dom/dom"),n("./accessibility/describe"),n("./events/acceleration"),n("./events/keyboard"),n("./events/mouse"),n("./events/touch"),n("./image/filters"),n("./image/image"),n("./image/loading_displaying"),n("./image/p5.Image"),n("./image/pixels"),n("./io/files"),n("./io/p5.Table"),n("./io/p5.TableRow"),n("./io/p5.XML"),n("./math/calculation"),n("./math/math"),n("./math/noise"),n("./math/p5.Vector"),n("./math/random"),n("./math/trigonometry"),n("./typography/attributes"),n("./typography/loading_displaying"),n("./typography/p5.Font"),n("./utilities/array_functions"),n("./utilities/conversion"),n("./utilities/string_functions"),n("./utilities/time_date"),n("./webgl/3d_primitives"),n("./webgl/interaction"),n("./webgl/light"),n("./webgl/loading"),n("./webgl/material"),n("./webgl/p5.Camera"),n("./webgl/p5.Geometry"),n("./webgl/p5.Matrix"),n("./webgl/p5.RendererGL.Immediate"),n("./webgl/p5.RendererGL"),n("./webgl/p5.RendererGL.Retained"),n("./webgl/p5.Shader"),n("./webgl/p5.RenderBuffer"),n("./webgl/p5.Texture"),n("./webgl/text"),n("./core/init"),s.exports=i.default},{"./accessibility/color_namer":243,"./accessibility/describe":244,"./accessibility/gridOutput":245,"./accessibility/outputs":246,"./accessibility/textOutput":247,"./color/color_conversion":249,"./color/creating_reading":250,"./color/p5.Color":251,"./color/setting":252,"./core/constants":253,"./core/environment":254,"./core/friendly_errors/fes_core":255,"./core/friendly_errors/file_errors":256,"./core/friendly_errors/sketch_reader":257,"./core/friendly_errors/stacktrace":258,"./core/friendly_errors/validate_params":259,"./core/helpers":260,"./core/init":261,"./core/legacy":263,"./core/main":264,"./core/p5.Element":265,"./core/p5.Graphics":266,"./core/p5.Renderer":267,"./core/p5.Renderer2D":268,"./core/preload":269,"./core/rendering":270,"./core/shape/2d_primitives":271,"./core/shape/attributes":272,"./core/shape/curves":273,"./core/shape/vertex":274,"./core/shim":275,"./core/structure":276,"./core/transform":277,"./data/local_storage.js":278,"./data/p5.TypedDict":279,"./dom/dom":280,"./events/acceleration":281,"./events/keyboard":282,"./events/mouse":283,"./events/touch":284,"./image/filters":285,"./image/image":286,"./image/loading_displaying":287,"./image/p5.Image":288,"./image/pixels":289,"./io/files":290,"./io/p5.Table":291,"./io/p5.TableRow":292,"./io/p5.XML":293,"./math/calculation":294,"./math/math":295,"./math/noise":296,"./math/p5.Vector":297,"./math/random":298,"./math/trigonometry":299,"./typography/attributes":300,"./typography/loading_displaying":301,"./typography/p5.Font":302,"./utilities/array_functions":303,"./utilities/conversion":304,"./utilities/string_functions":305,"./utilities/time_date":306,"./webgl/3d_primitives":307,"./webgl/interaction":308,"./webgl/light":309,"./webgl/loading":310,"./webgl/material":311,"./webgl/p5.Camera":312,"./webgl/p5.Geometry":313,"./webgl/p5.Matrix":314,"./webgl/p5.RenderBuffer":315,"./webgl/p5.RendererGL":318,"./webgl/p5.RendererGL.Immediate":316,"./webgl/p5.RendererGL.Retained":317,"./webgl/p5.Shader":319,"./webgl/p5.Texture":320,"./webgl/text":321}],249:[function(n,s,o){Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var a,i=(a=n("../core/main"))&&a.__esModule?a:{default:a};i.default.ColorConversion={},i.default.ColorConversion._hsbaToHSLA=function(u){var h=u[0],d=u[1],c=u[2],f=(2-d)*c/2;return f!=0&&(f==1?d=0:f<.5?d/=2-d:d=d*c/(2-2*f)),[h,d,f,u[3]]},i.default.ColorConversion._hsbaToRGBA=function(u){var h=6*u[0],d=u[1],c=u[2],f=[];if(d===0)f=[c,c,c,u[3]];else{var p,m,g,y=Math.floor(h),v=c*(1-d),b=c*(1-d*(h-y)),w=c*(1-d*(1+y-h));g=y===1?(p=b,m=c,v):y===2?(p=v,m=c,w):y===3?(p=v,m=b,c):y===4?(p=w,m=v,c):y===5?(p=c,m=v,b):(p=c,m=w,v),f=[p,m,g,u[3]]}return f},i.default.ColorConversion._hslaToHSBA=function(u){var h,d=u[0],c=u[1],f=u[2];return[d,c=2*((h=f<.5?(1+c)*f:f+c-f*c)-f)/h,h,u[3]]},i.default.ColorConversion._hslaToRGBA=function(u){var h=6*u[0],d=u[1],c=u[2],f=[];if(d===0)f=[c,c,c,u[3]];else{var p,m=2*c-(p=c<.5?(1+d)*c:c+d-c*d),g=function(y,v,b){return y<0?y+=6:6<=y&&(y-=6),y<1?v+(b-v)*y:y<3?b:y<4?v+(b-v)*(4-y):v};f=[g(2+h,m,p),g(h,m,p),g(h-2,m,p),u[3]]}return f},i.default.ColorConversion._rgbaToHSBA=function(u){var h,d,c=u[0],f=u[1],p=u[2],m=Math.max(c,f,p),g=m-Math.min(c,f,p);return g==0?d=h=0:(d=g/m,c===m?h=(f-p)/g:f===m?h=2+(p-c)/g:p===m&&(h=4+(c-f)/g),h<0?h+=6:6<=h&&(h-=6)),[h/6,d,m,u[3]]},i.default.ColorConversion._rgbaToHSLA=function(u){var h,d,c=u[0],f=u[1],p=u[2],m=Math.max(c,f,p),g=Math.min(c,f,p),y=m+g,v=m-g;return v==0?d=h=0:(d=y<1?v/y:v/(2-y),c===m?h=(f-p)/v:f===m?h=2+(p-c)/v:p===m&&(h=4+(c-f)/v),h<0?h+=6:6<=h&&(h-=6)),[h/6,d,y/2,u[3]]};var l=i.default.ColorConversion;o.default=l},{"../core/main":264}],250:[function(n,s,o){function a(c){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(f){return typeof f}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f})(c)}n("core-js/modules/es.array.map"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var i,l=(i=n("../core/main"))&&i.__esModule?i:{default:i},u=function(c){if(c&&c.__esModule)return c;if(c===null||a(c)!=="object"&&typeof c!="function")return{default:c};var f=h();if(f&&f.has(c))return f.get(c);var p={},m=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var g in c)if(Object.prototype.hasOwnProperty.call(c,g)){var y=m?Object.getOwnPropertyDescriptor(c,g):null;y&&(y.get||y.set)?Object.defineProperty(p,g,y):p[g]=c[g]}return p.default=c,f&&f.set(c,p),p}(n("../core/constants"));function h(){if(typeof WeakMap!="function")return null;var c=new WeakMap;return h=function(){return c},c}n("./p5.Color"),n("../core/friendly_errors/validate_params"),n("../core/friendly_errors/file_errors"),n("../core/friendly_errors/fes_core"),l.default.prototype.alpha=function(c){return l.default._validateParameters("alpha",arguments),this.color(c)._getAlpha()},l.default.prototype.blue=function(c){return l.default._validateParameters("blue",arguments),this.color(c)._getBlue()},l.default.prototype.brightness=function(c){return l.default._validateParameters("brightness",arguments),this.color(c)._getBrightness()},l.default.prototype.color=function(){if(l.default._validateParameters("color",arguments),arguments[0]instanceof l.default.Color)return arguments[0];var c=arguments[0]instanceof Array?arguments[0]:arguments;return new l.default.Color(this,c)},l.default.prototype.green=function(c){return l.default._validateParameters("green",arguments),this.color(c)._getGreen()},l.default.prototype.hue=function(c){return l.default._validateParameters("hue",arguments),this.color(c)._getHue()},l.default.prototype.lerpColor=function(c,f,p){l.default._validateParameters("lerpColor",arguments);var m,g,y,v,b,w,_=this._colorMode,I=this._colorMaxes;if(_===u.RGB)b=c.levels.map(function(C){return C/255}),w=f.levels.map(function(C){return C/255});else if(_===u.HSB)c._getBrightness(),f._getBrightness(),b=c.hsba,w=f.hsba;else{if(_!==u.HSL)throw new Error("".concat(_,"cannot be used for interpolation."));c._getLightness(),f._getLightness(),b=c.hsla,w=f.hsla}return p=Math.max(Math.min(p,1),0),this.lerp===void 0&&(this.lerp=function(C,N,O){return O*(N-C)+C}),m=this.lerp(b[0],w[0],p),g=this.lerp(b[1],w[1],p),y=this.lerp(b[2],w[2],p),v=this.lerp(b[3],w[3],p),m*=I[_][0],g*=I[_][1],y*=I[_][2],v*=I[_][3],this.color(m,g,y,v)},l.default.prototype.lightness=function(c){return l.default._validateParameters("lightness",arguments),this.color(c)._getLightness()},l.default.prototype.red=function(c){return l.default._validateParameters("red",arguments),this.color(c)._getRed()},l.default.prototype.saturation=function(c){return l.default._validateParameters("saturation",arguments),this.color(c)._getSaturation()};var d=l.default;o.default=d},{"../core/constants":253,"../core/friendly_errors/fes_core":255,"../core/friendly_errors/file_errors":256,"../core/friendly_errors/validate_params":259,"../core/main":264,"./p5.Color":251,"core-js/modules/es.array.map":161}],251:[function(n,s,o){function a(b){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(w){return typeof w}:function(w){return w&&typeof Symbol=="function"&&w.constructor===Symbol&&w!==Symbol.prototype?"symbol":typeof w})(b)}n("core-js/modules/es.array.join"),n("core-js/modules/es.array.map"),n("core-js/modules/es.array.slice"),n("core-js/modules/es.object.to-string"),n("core-js/modules/es.regexp.constructor"),n("core-js/modules/es.regexp.exec"),n("core-js/modules/es.regexp.to-string"),n("core-js/modules/es.string.trim"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var i=d(n("../core/main")),l=function(b){if(b&&b.__esModule)return b;if(b===null||a(b)!=="object"&&typeof b!="function")return{default:b};var w=h();if(w&&w.has(b))return w.get(b);var _={},I=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var C in b)if(Object.prototype.hasOwnProperty.call(b,C)){var N=I?Object.getOwnPropertyDescriptor(b,C):null;N&&(N.get||N.set)?Object.defineProperty(_,C,N):_[C]=b[C]}return _.default=b,w&&w.set(b,_),_}(n("../core/constants")),u=d(n("./color_conversion"));function h(){if(typeof WeakMap!="function")return null;var b=new WeakMap;return h=function(){return b},b}function d(b){return b&&b.__esModule?b:{default:b}}i.default.Color=function(b,w){if(this._storeModeAndMaxes(b._colorMode,b._colorMaxes),this.mode!==l.RGB&&this.mode!==l.HSL&&this.mode!==l.HSB)throw new Error("".concat(this.mode," is an invalid colorMode."));return this._array=i.default.Color._parseInputs.apply(this,w),this._calculateLevels(),this},i.default.Color.prototype.toString=function(b){var w=this.levels,_=this._array,I=_[3];switch(b){case"#rrggbb":return"#".concat(w[0]<16?"0".concat(w[0].toString(16)):w[0].toString(16),w[1]<16?"0".concat(w[1].toString(16)):w[1].toString(16),w[2]<16?"0".concat(w[2].toString(16)):w[2].toString(16));case"#rrggbbaa":return"#".concat(w[0]<16?"0".concat(w[0].toString(16)):w[0].toString(16),w[1]<16?"0".concat(w[1].toString(16)):w[1].toString(16),w[2]<16?"0".concat(w[2].toString(16)):w[2].toString(16),w[3]<16?"0".concat(w[3].toString(16)):w[3].toString(16));case"#rgb":return"#".concat(Math.round(15*_[0]).toString(16),Math.round(15*_[1]).toString(16),Math.round(15*_[2]).toString(16));case"#rgba":return"#".concat(Math.round(15*_[0]).toString(16),Math.round(15*_[1]).toString(16),Math.round(15*_[2]).toString(16),Math.round(15*_[3]).toString(16));case"rgb":return"rgb(".concat(w[0],", ",w[1],", ",w[2],")");case"rgb%":return"rgb(".concat((100*_[0]).toPrecision(3),"%, ",(100*_[1]).toPrecision(3),"%, ",(100*_[2]).toPrecision(3),"%)");case"rgba%":return"rgba(".concat((100*_[0]).toPrecision(3),"%, ",(100*_[1]).toPrecision(3),"%, ",(100*_[2]).toPrecision(3),"%, ",(100*_[3]).toPrecision(3),"%)");case"hsb":case"hsv":return this.hsba||(this.hsba=u.default._rgbaToHSBA(this._array)),"hsb(".concat(this.hsba[0]*this.maxes[l.HSB][0],", ",this.hsba[1]*this.maxes[l.HSB][1],", ",this.hsba[2]*this.maxes[l.HSB][2],")");case"hsb%":case"hsv%":return this.hsba||(this.hsba=u.default._rgbaToHSBA(this._array)),"hsb(".concat((100*this.hsba[0]).toPrecision(3),"%, ",(100*this.hsba[1]).toPrecision(3),"%, ",(100*this.hsba[2]).toPrecision(3),"%)");case"hsba":case"hsva":return this.hsba||(this.hsba=u.default._rgbaToHSBA(this._array)),"hsba(".concat(this.hsba[0]*this.maxes[l.HSB][0],", ",this.hsba[1]*this.maxes[l.HSB][1],", ",this.hsba[2]*this.maxes[l.HSB][2],", ",I,")");case"hsba%":case"hsva%":return this.hsba||(this.hsba=u.default._rgbaToHSBA(this._array)),"hsba(".concat((100*this.hsba[0]).toPrecision(3),"%, ",(100*this.hsba[1]).toPrecision(3),"%, ",(100*this.hsba[2]).toPrecision(3),"%, ",(100*I).toPrecision(3),"%)");case"hsl":return this.hsla||(this.hsla=u.default._rgbaToHSLA(this._array)),"hsl(".concat(this.hsla[0]*this.maxes[l.HSL][0],", ",this.hsla[1]*this.maxes[l.HSL][1],", ",this.hsla[2]*this.maxes[l.HSL][2],")");case"hsl%":return this.hsla||(this.hsla=u.default._rgbaToHSLA(this._array)),"hsl(".concat((100*this.hsla[0]).toPrecision(3),"%, ",(100*this.hsla[1]).toPrecision(3),"%, ",(100*this.hsla[2]).toPrecision(3),"%)");case"hsla":return this.hsla||(this.hsla=u.default._rgbaToHSLA(this._array)),"hsla(".concat(this.hsla[0]*this.maxes[l.HSL][0],", ",this.hsla[1]*this.maxes[l.HSL][1],", ",this.hsla[2]*this.maxes[l.HSL][2],", ",I,")");case"hsla%":return this.hsla||(this.hsla=u.default._rgbaToHSLA(this._array)),"hsl(".concat((100*this.hsla[0]).toPrecision(3),"%, ",(100*this.hsla[1]).toPrecision(3),"%, ",(100*this.hsla[2]).toPrecision(3),"%, ",(100*I).toPrecision(3),"%)");case"rgba":default:return"rgba(".concat(w[0],",",w[1],",",w[2],",",I,")")}},i.default.Color.prototype.setRed=function(b){this._array[0]=b/this.maxes[l.RGB][0],this._calculateLevels()},i.default.Color.prototype.setGreen=function(b){this._array[1]=b/this.maxes[l.RGB][1],this._calculateLevels()},i.default.Color.prototype.setBlue=function(b){this._array[2]=b/this.maxes[l.RGB][2],this._calculateLevels()},i.default.Color.prototype.setAlpha=function(b){this._array[3]=b/this.maxes[this.mode][3],this._calculateLevels()},i.default.Color.prototype._calculateLevels=function(){for(var b=this._array,w=this.levels=new Array(b.length),_=b.length-1;0<=_;--_)w[_]=Math.round(255*b[_])},i.default.Color.prototype._getAlpha=function(){return this._array[3]*this.maxes[this.mode][3]},i.default.Color.prototype._storeModeAndMaxes=function(b,w){this.mode=b,this.maxes=w},i.default.Color.prototype._getMode=function(){return this.mode},i.default.Color.prototype._getMaxes=function(){return this.maxes},i.default.Color.prototype._getBlue=function(){return this._array[2]*this.maxes[l.RGB][2]},i.default.Color.prototype._getBrightness=function(){return this.hsba||(this.hsba=u.default._rgbaToHSBA(this._array)),this.hsba[2]*this.maxes[l.HSB][2]},i.default.Color.prototype._getGreen=function(){return this._array[1]*this.maxes[l.RGB][1]},i.default.Color.prototype._getHue=function(){return this.mode===l.HSB?(this.hsba||(this.hsba=u.default._rgbaToHSBA(this._array)),this.hsba[0]*this.maxes[l.HSB][0]):(this.hsla||(this.hsla=u.default._rgbaToHSLA(this._array)),this.hsla[0]*this.maxes[l.HSL][0])},i.default.Color.prototype._getLightness=function(){return this.hsla||(this.hsla=u.default._rgbaToHSLA(this._array)),this.hsla[2]*this.maxes[l.HSL][2]},i.default.Color.prototype._getRed=function(){return this._array[0]*this.maxes[l.RGB][0]},i.default.Color.prototype._getSaturation=function(){return this.mode===l.HSB?(this.hsba||(this.hsba=u.default._rgbaToHSBA(this._array)),this.hsba[1]*this.maxes[l.HSB][1]):(this.hsla||(this.hsla=u.default._rgbaToHSLA(this._array)),this.hsla[1]*this.maxes[l.HSL][1])};var c={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},f=/\s*/,p=/(\d{1,3})/,m=/((?:\d+(?:\.\d+)?)|(?:\.\d+))/,g=new RegExp("".concat(m.source,"%")),y={HEX3:/^#([a-f0-9])([a-f0-9])([a-f0-9])$/i,HEX4:/^#([a-f0-9])([a-f0-9])([a-f0-9])([a-f0-9])$/i,HEX6:/^#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})$/i,HEX8:/^#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})$/i,RGB:new RegExp(["^rgb\\(",p.source,",",p.source,",",p.source,"\\)$"].join(f.source),"i"),RGB_PERCENT:new RegExp(["^rgb\\(",g.source,",",g.source,",",g.source,"\\)$"].join(f.source),"i"),RGBA:new RegExp(["^rgba\\(",p.source,",",p.source,",",p.source,",",m.source,"\\)$"].join(f.source),"i"),RGBA_PERCENT:new RegExp(["^rgba\\(",g.source,",",g.source,",",g.source,",",m.source,"\\)$"].join(f.source),"i"),HSL:new RegExp(["^hsl\\(",p.source,",",g.source,",",g.source,"\\)$"].join(f.source),"i"),HSLA:new RegExp(["^hsla\\(",p.source,",",g.source,",",g.source,",",m.source,"\\)$"].join(f.source),"i"),HSB:new RegExp(["^hsb\\(",p.source,",",g.source,",",g.source,"\\)$"].join(f.source),"i"),HSBA:new RegExp(["^hsba\\(",p.source,",",g.source,",",g.source,",",m.source,"\\)$"].join(f.source),"i")};i.default.Color._parseInputs=function(b,w,_,I){var C,N=arguments.length,O=this.mode,D=this.maxes[O],M=[];if(3<=N){for(M[0]=b/D[0],M[1]=w/D[1],M[2]=_/D[2],M[3]=typeof I=="number"?I/D[3]:1,C=M.length-1;0<=C;--C){var P=M[C];P<0?M[C]=0:1<P&&(M[C]=1)}return O===l.HSL?u.default._hslaToRGBA(M):O===l.HSB?u.default._hsbaToRGBA(M):M}if(N===1&&typeof b=="string"){var F=b.trim().toLowerCase();if(c[F])return i.default.Color._parseInputs.call(this,c[F]);if(y.HEX3.test(F))return(M=y.HEX3.exec(F).slice(1).map(function(B){return parseInt(B+B,16)/255}))[3]=1,M;if(y.HEX6.test(F))return(M=y.HEX6.exec(F).slice(1).map(function(B){return parseInt(B,16)/255}))[3]=1,M;if(y.HEX4.test(F))return M=y.HEX4.exec(F).slice(1).map(function(B){return parseInt(B+B,16)/255});if(y.HEX8.test(F))return M=y.HEX8.exec(F).slice(1).map(function(B){return parseInt(B,16)/255});if(y.RGB.test(F))return(M=y.RGB.exec(F).slice(1).map(function(B){return B/255}))[3]=1,M;if(y.RGB_PERCENT.test(F))return(M=y.RGB_PERCENT.exec(F).slice(1).map(function(B){return parseFloat(B)/100}))[3]=1,M;if(y.RGBA.test(F))return M=y.RGBA.exec(F).slice(1).map(function(B,z){return z===3?parseFloat(B):B/255});if(y.RGBA_PERCENT.test(F))return M=y.RGBA_PERCENT.exec(F).slice(1).map(function(B,z){return z===3?parseFloat(B):parseFloat(B)/100});if(y.HSL.test(F)?(M=y.HSL.exec(F).slice(1).map(function(B,z){return z===0?parseInt(B,10)/360:parseInt(B,10)/100}))[3]=1:y.HSLA.test(F)&&(M=y.HSLA.exec(F).slice(1).map(function(B,z){return z===0?parseInt(B,10)/360:z===3?parseFloat(B):parseInt(B,10)/100})),(M=M.map(function(B){return Math.max(Math.min(B,1),0)})).length)return u.default._hslaToRGBA(M);if(y.HSB.test(F)?(M=y.HSB.exec(F).slice(1).map(function(B,z){return z===0?parseInt(B,10)/360:parseInt(B,10)/100}))[3]=1:y.HSBA.test(F)&&(M=y.HSBA.exec(F).slice(1).map(function(B,z){return z===0?parseInt(B,10)/360:z===3?parseFloat(B):parseInt(B,10)/100})),M.length){for(C=M.length-1;0<=C;--C)M[C]=Math.max(Math.min(M[C],1),0);return u.default._hsbaToRGBA(M)}M=[1,1,1,1]}else{if(N!==1&&N!==2||typeof b!="number")throw new Error("".concat(arguments,"is not a valid color representation."));M[0]=b/D[2],M[1]=b/D[2],M[2]=b/D[2],M[3]=typeof w=="number"?w/D[3]:1,M=M.map(function(B){return Math.max(Math.min(B,1),0)})}return M};var v=i.default.Color;o.default=v},{"../core/constants":253,"../core/main":264,"./color_conversion":249,"core-js/modules/es.array.join":159,"core-js/modules/es.array.map":161,"core-js/modules/es.array.slice":162,"core-js/modules/es.object.to-string":177,"core-js/modules/es.regexp.constructor":180,"core-js/modules/es.regexp.exec":181,"core-js/modules/es.regexp.to-string":182,"core-js/modules/es.string.trim":193}],252:[function(n,s,o){function a(c){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(f){return typeof f}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f})(c)}n("core-js/modules/es.array.fill"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var i,l=(i=n("../core/main"))&&i.__esModule?i:{default:i},u=function(c){if(c&&c.__esModule)return c;if(c===null||a(c)!=="object"&&typeof c!="function")return{default:c};var f=h();if(f&&f.has(c))return f.get(c);var p={},m=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var g in c)if(Object.prototype.hasOwnProperty.call(c,g)){var y=m?Object.getOwnPropertyDescriptor(c,g):null;y&&(y.get||y.set)?Object.defineProperty(p,g,y):p[g]=c[g]}return p.default=c,f&&f.set(c,p),p}(n("../core/constants"));function h(){if(typeof WeakMap!="function")return null;var c=new WeakMap;return h=function(){return c},c}n("./p5.Color"),l.default.prototype.background=function(){var c;return(c=this._renderer).background.apply(c,arguments),this},l.default.prototype.clear=function(){var c=(arguments.length<=0?void 0:arguments[0])||0,f=(arguments.length<=1?void 0:arguments[1])||0,p=(arguments.length<=2?void 0:arguments[2])||0,m=(arguments.length<=3?void 0:arguments[3])||0;return this._renderer.clear(c,f,p,m),this},l.default.prototype.colorMode=function(c,f,p,m,g){if(l.default._validateParameters("colorMode",arguments),c===u.RGB||c===u.HSB||c===u.HSL){this._colorMode=c;var y=this._colorMaxes[c];arguments.length===2?(y[0]=f,y[1]=f,y[2]=f,y[3]=f):arguments.length===4?(y[0]=f,y[1]=p,y[2]=m):arguments.length===5&&(y[0]=f,y[1]=p,y[2]=m,y[3]=g)}return this},l.default.prototype.fill=function(){var c;return this._renderer._setProperty("_fillSet",!0),this._renderer._setProperty("_doFill",!0),(c=this._renderer).fill.apply(c,arguments),this},l.default.prototype.noFill=function(){return this._renderer._setProperty("_doFill",!1),this},l.default.prototype.noStroke=function(){return this._renderer._setProperty("_doStroke",!1),this},l.default.prototype.stroke=function(){var c;return this._renderer._setProperty("_strokeSet",!0),this._renderer._setProperty("_doStroke",!0),(c=this._renderer).stroke.apply(c,arguments),this},l.default.prototype.erase=function(){var c=0<arguments.length&&arguments[0]!==void 0?arguments[0]:255,f=1<arguments.length&&arguments[1]!==void 0?arguments[1]:255;return this._renderer.erase(c,f),this},l.default.prototype.noErase=function(){return this._renderer.noErase(),this};var d=l.default;o.default=d},{"../core/constants":253,"../core/main":264,"./p5.Color":251,"core-js/modules/es.array.fill":151}],253:[function(n,s,o){Object.defineProperty(o,"__esModule",{value:!0}),o.BEZIER=o.QUADRATIC=o.LINEAR=o._CTX_MIDDLE=o._DEFAULT_LEADMULT=o._DEFAULT_TEXT_FILL=o.WORD=o.CHAR=o.BOLDITALIC=o.BOLD=o.ITALIC=o.NORMAL=o.BLUR=o.ERODE=o.DILATE=o.POSTERIZE=o.INVERT=o.OPAQUE=o.GRAY=o.THRESHOLD=o.BURN=o.DODGE=o.SOFT_LIGHT=o.HARD_LIGHT=o.OVERLAY=o.REPLACE=o.SCREEN=o.MULTIPLY=o.EXCLUSION=o.SUBTRACT=o.DIFFERENCE=o.LIGHTEST=o.DARKEST=o.ADD=o.REMOVE=o.BLEND=o.UP_ARROW=o.TAB=o.SHIFT=o.RIGHT_ARROW=o.RETURN=o.OPTION=o.LEFT_ARROW=o.ESCAPE=o.ENTER=o.DOWN_ARROW=o.DELETE=o.CONTROL=o.BACKSPACE=o.ALT=o.AUTO=o.HSL=o.HSB=o.RGB=o.MITER=o.BEVEL=o.ROUND=o.SQUARE=o.PROJECT=o.PIE=o.CHORD=o.OPEN=o.CLOSE=o.TESS=o.QUAD_STRIP=o.QUADS=o.TRIANGLE_STRIP=o.TRIANGLE_FAN=o.TRIANGLES=o.LINE_LOOP=o.LINE_STRIP=o.LINES=o.POINTS=o.BASELINE=o.BOTTOM=o.TOP=o.CENTER=o.LEFT=o.RIGHT=o.RADIUS=o.CORNERS=o.CORNER=o.RAD_TO_DEG=o.DEG_TO_RAD=o.RADIANS=o.DEGREES=o.TWO_PI=o.TAU=o.QUARTER_PI=o.PI=o.HALF_PI=o.WAIT=o.TEXT=o.MOVE=o.HAND=o.CROSS=o.ARROW=o.WEBGL=o.P2D=o.VERSION=void 0,o.FALLBACK=o.LABEL=o.AXES=o.GRID=o._DEFAULT_FILL=o._DEFAULT_STROKE=o.PORTRAIT=o.LANDSCAPE=o.MIRROR=o.CLAMP=o.REPEAT=o.NEAREST=o.IMAGE=o.IMMEDIATE=o.TEXTURE=o.FILL=o.STROKE=o.CURVE=void 0;var a=Math.PI;o.VERSION="1.4.1",o.P2D="p2d",o.WEBGL="webgl",o.ARROW="default",o.CROSS="crosshair",o.HAND="pointer",o.MOVE="move",o.TEXT="text",o.WAIT="wait";var i=a/2;o.HALF_PI=i;var l=a;o.PI=l;var u=a/4;o.QUARTER_PI=u;var h=2*a;o.TAU=h;var d=2*a;o.TWO_PI=d,o.DEGREES="degrees",o.RADIANS="radians";var c=a/180;o.DEG_TO_RAD=c;var f=180/a;o.RAD_TO_DEG=f,o.CORNER="corner",o.CORNERS="corners",o.RADIUS="radius",o.RIGHT="right",o.LEFT="left",o.CENTER="center",o.TOP="top",o.BOTTOM="bottom",o.BASELINE="alphabetic",o.POINTS=0,o.LINES=1,o.LINE_STRIP=3,o.LINE_LOOP=2,o.TRIANGLES=4,o.TRIANGLE_FAN=6,o.TRIANGLE_STRIP=5,o.QUADS="quads",o.QUAD_STRIP="quad_strip",o.TESS="tess",o.CLOSE="close",o.OPEN="open",o.CHORD="chord",o.PIE="pie",o.PROJECT="square",o.SQUARE="butt",o.ROUND="round",o.BEVEL="bevel",o.MITER="miter",o.RGB="rgb",o.HSB="hsb",o.HSL="hsl",o.AUTO="auto",o.ALT=18,o.BACKSPACE=8,o.CONTROL=17,o.DELETE=46,o.DOWN_ARROW=40,o.ENTER=13,o.ESCAPE=27,o.LEFT_ARROW=37,o.OPTION=18,o.RETURN=13,o.RIGHT_ARROW=39,o.SHIFT=16,o.TAB=9,o.UP_ARROW=38,o.BLEND="source-over",o.REMOVE="destination-out",o.ADD="lighter",o.DARKEST="darken",o.LIGHTEST="lighten",o.DIFFERENCE="difference",o.SUBTRACT="subtract",o.EXCLUSION="exclusion",o.MULTIPLY="multiply",o.SCREEN="screen",o.REPLACE="copy",o.OVERLAY="overlay",o.HARD_LIGHT="hard-light",o.SOFT_LIGHT="soft-light",o.DODGE="color-dodge",o.BURN="color-burn",o.THRESHOLD="threshold",o.GRAY="gray",o.OPAQUE="opaque",o.INVERT="invert",o.POSTERIZE="posterize",o.DILATE="dilate",o.ERODE="erode",o.BLUR="blur",o.NORMAL="normal",o.ITALIC="italic",o.BOLD="bold",o.BOLDITALIC="bold italic",o.CHAR="CHAR",o.WORD="WORD",o._DEFAULT_TEXT_FILL="#000000",o._DEFAULT_LEADMULT=1.25,o._CTX_MIDDLE="middle",o.LINEAR="linear",o.QUADRATIC="quadratic",o.BEZIER="bezier",o.CURVE="curve",o.STROKE="stroke",o.FILL="fill",o.TEXTURE="texture",o.IMMEDIATE="immediate",o.IMAGE="image",o.NEAREST="nearest",o.REPEAT="repeat",o.CLAMP="clamp",o.MIRROR="mirror",o.LANDSCAPE="landscape",o.PORTRAIT="portrait",o._DEFAULT_STROKE="#000000",o._DEFAULT_FILL="#FFFFFF",o.GRID="grid",o.AXES="axes",o.LABEL="label",o.FALLBACK="fallback"},{}],254:[function(n,s,o){function a(g){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(y){return typeof y}:function(y){return y&&typeof Symbol=="function"&&y.constructor===Symbol&&y!==Symbol.prototype?"symbol":typeof y})(g)}n("core-js/modules/es.array.concat"),n("core-js/modules/es.array.filter"),n("core-js/modules/es.array.includes"),n("core-js/modules/es.regexp.exec"),n("core-js/modules/es.string.includes"),n("core-js/modules/es.string.search"),n("core-js/modules/es.string.split"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var i,l=(i=n("./main"))&&i.__esModule?i:{default:i},u=function(g){if(g&&g.__esModule)return g;if(g===null||a(g)!=="object"&&typeof g!="function")return{default:g};var y=h();if(y&&y.has(g))return y.get(g);var v={},b=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var w in g)if(Object.prototype.hasOwnProperty.call(g,w)){var _=b?Object.getOwnPropertyDescriptor(g,w):null;_&&(_.get||_.set)?Object.defineProperty(v,w,_):v[w]=g[w]}return v.default=g,y&&y.set(g,v),v}(n("./constants"));function h(){if(typeof WeakMap!="function")return null;var g=new WeakMap;return h=function(){return g},g}var d=[u.ARROW,u.CROSS,u.HAND,u.MOVE,u.TEXT,u.WAIT];l.default.prototype._frameRate=0,l.default.prototype._lastFrameTime=window.performance.now(),l.default.prototype._targetFrameRate=60;var c=window.print;function f(){return window.innerWidth||document.documentElement&&document.documentElement.clientWidth||document.body&&document.body.clientWidth||0}function p(){return window.innerHeight||document.documentElement&&document.documentElement.clientHeight||document.body&&document.body.clientHeight||0}l.default.prototype.print=function(){var g;arguments.length?(g=console).log.apply(g,arguments):c()},l.default.prototype.frameCount=0,l.default.prototype.deltaTime=0,l.default.prototype.focused=document.hasFocus(),l.default.prototype.cursor=function(g,y,v){var b="auto",w=this._curElement.elt;if(d.includes(g))b=g;else if(typeof g=="string"){var _="";y&&v&&typeof y=="number"&&typeof v=="number"&&(_="".concat(y," ").concat(v)),b=g.substring(0,7)==="http://"||g.substring(0,8)==="https://"||/\.(cur|jpg|jpeg|gif|png|CUR|JPG|JPEG|GIF|PNG)$/.test(g)?"url(".concat(g,") ").concat(_,", auto"):g}w.style.cursor=b},l.default.prototype.frameRate=function(g){return l.default._validateParameters("frameRate",arguments),typeof g!="number"||g<0?this._frameRate:(this._setProperty("_targetFrameRate",g),g===0&&this._setProperty("_frameRate",g),this)},l.default.prototype.getFrameRate=function(){return this.frameRate()},l.default.prototype.setFrameRate=function(g){return this.frameRate(g)},l.default.prototype.noCursor=function(){this._curElement.elt.style.cursor="none"},l.default.prototype.displayWidth=screen.width,l.default.prototype.displayHeight=screen.height,l.default.prototype.windowWidth=f(),l.default.prototype.windowHeight=p(),l.default.prototype._onresize=function(g){this._setProperty("windowWidth",f()),this._setProperty("windowHeight",p());var y,v=this._isGlobal?window:this;typeof v.windowResized=="function"&&((y=v.windowResized(g))===void 0||y||g.preventDefault())},l.default.prototype.width=0,l.default.prototype.height=0,l.default.prototype.fullscreen=function(g){if(l.default._validateParameters("fullscreen",arguments),g===void 0)return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement;g?function(y){if(!(document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled))throw new Error("Fullscreen not enabled in this browser.");y.requestFullscreen?y.requestFullscreen():y.mozRequestFullScreen?y.mozRequestFullScreen():y.webkitRequestFullscreen?y.webkitRequestFullscreen():y.msRequestFullscreen&&y.msRequestFullscreen()}(document.documentElement):document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()},l.default.prototype.pixelDensity=function(g){var y;return l.default._validateParameters("pixelDensity",arguments),typeof g=="number"?(g!==this._pixelDensity&&(this._pixelDensity=g),(y=this).resizeCanvas(this.width,this.height,!0)):y=this._pixelDensity,y},l.default.prototype.displayDensity=function(){return window.devicePixelRatio},l.default.prototype.getURL=function(){return location.href},l.default.prototype.getURLPath=function(){return location.pathname.split("/").filter(function(g){return g!==""})},l.default.prototype.getURLParams=function(){for(var g,y=/[?&]([^&=]+)(?:[&=])([^&=]+)/gim,v={};(g=y.exec(location.search))!=null;)g.index===y.lastIndex&&y.lastIndex++,v[g[1]]=g[2];return v};var m=l.default;o.default=m},{"./constants":253,"./main":264,"core-js/modules/es.array.concat":149,"core-js/modules/es.array.filter":152,"core-js/modules/es.array.includes":156,"core-js/modules/es.regexp.exec":181,"core-js/modules/es.string.includes":185,"core-js/modules/es.string.search":190,"core-js/modules/es.string.split":191}],255:[function(n,s,o){n("core-js/modules/es.symbol"),n("core-js/modules/es.symbol.description"),n("core-js/modules/es.symbol.iterator"),n("core-js/modules/es.array.concat"),n("core-js/modules/es.array.filter"),n("core-js/modules/es.array.for-each"),n("core-js/modules/es.array.includes"),n("core-js/modules/es.array.iterator"),n("core-js/modules/es.array.join"),n("core-js/modules/es.array.map"),n("core-js/modules/es.array.slice"),n("core-js/modules/es.array.some"),n("core-js/modules/es.function.name"),n("core-js/modules/es.object.assign"),n("core-js/modules/es.object.get-own-property-names"),n("core-js/modules/es.object.keys"),n("core-js/modules/es.object.to-string"),n("core-js/modules/es.regexp.constructor"),n("core-js/modules/es.regexp.exec"),n("core-js/modules/es.regexp.to-string"),n("core-js/modules/es.string.iterator"),n("core-js/modules/es.string.match"),n("core-js/modules/es.string.replace"),n("core-js/modules/es.string.search"),n("core-js/modules/es.string.split"),n("core-js/modules/web.dom-collections.for-each"),n("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var a,i=(a=n("../main"))&&a.__esModule?a:{default:a};n("../internationalization");var l=null,u=null;i.default._friendlyError=i.default._checkForUserDefinedFunctions=i.default._fesErrorMonitor=function(){},l=null;var h="https://github.com/processing/p5.js/wiki/p5.js-overview#why-cant-i-assign-variables-using-p5-functions-and-variables-before-setup";u=function(){function f(m){return Object.getOwnPropertyNames(m).filter(function(g){return g[0]!=="_"&&!(g in p)&&(p[g]=!0)}).map(function(g){var y;return y=typeof m[g]=="function"?"function":g===g.toUpperCase()?"constant":"variable",{name:g,type:y}})}var p={};(l=[].concat(f(i.default.prototype),f(n("../constants")))).sort(function(m,g){return g.name.length-m.name.length})};function d(f,p){p=p||console.log.bind(console),l||u(),l.some(function(m){if(f.message&&f.message.match("\\W?".concat(m.name,"\\W"))!==null){var g=m.type==="function"?"".concat(m.name,"()"):m.name;return p("Did you just try to use p5.js's ".concat(g," ").concat(m.type,`? If so, you may want to move it into your sketch's setup() function.

For more details, see: `).concat(h)),!0}})}i.default.prototype._helpForMisusedAtTopLevelCode=d,document.readyState!=="complete"&&(window.addEventListener("error",d,!1),window.addEventListener("load",function(){window.removeEventListener("error",d,!1)}));var c=i.default;o.default=c},{"../constants":253,"../internationalization":262,"../main":264,"./browser_errors":void 0,"core-js/modules/es.array.concat":149,"core-js/modules/es.array.filter":152,"core-js/modules/es.array.for-each":154,"core-js/modules/es.array.includes":156,"core-js/modules/es.array.iterator":158,"core-js/modules/es.array.join":159,"core-js/modules/es.array.map":161,"core-js/modules/es.array.slice":162,"core-js/modules/es.array.some":163,"core-js/modules/es.function.name":166,"core-js/modules/es.object.assign":173,"core-js/modules/es.object.get-own-property-names":174,"core-js/modules/es.object.keys":176,"core-js/modules/es.object.to-string":177,"core-js/modules/es.regexp.constructor":180,"core-js/modules/es.regexp.exec":181,"core-js/modules/es.regexp.to-string":182,"core-js/modules/es.string.iterator":186,"core-js/modules/es.string.match":187,"core-js/modules/es.string.replace":189,"core-js/modules/es.string.search":190,"core-js/modules/es.string.split":191,"core-js/modules/es.symbol":196,"core-js/modules/es.symbol.description":194,"core-js/modules/es.symbol.iterator":195,"core-js/modules/web.dom-collections.for-each":228,"core-js/modules/web.dom-collections.iterator":229}],256:[function(n,s,o){Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var a,i=(a=n("../main"))&&a.__esModule?a:{default:a};n("../internationalization"),i.default._friendlyFileLoadError=function(){};var l=i.default;o.default=l},{"../internationalization":262,"../main":264}],257:[function(n,s,o){function a(c){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(f){return typeof f}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f})(c)}n("core-js/modules/es.symbol"),n("core-js/modules/es.symbol.description"),n("core-js/modules/es.symbol.iterator"),n("core-js/modules/es.array.filter"),n("core-js/modules/es.array.flat-map"),n("core-js/modules/es.array.for-each"),n("core-js/modules/es.array.from"),n("core-js/modules/es.array.includes"),n("core-js/modules/es.array.index-of"),n("core-js/modules/es.array.iterator"),n("core-js/modules/es.array.map"),n("core-js/modules/es.array.unscopables.flat-map"),n("core-js/modules/es.object.keys"),n("core-js/modules/es.object.to-string"),n("core-js/modules/es.regexp.constructor"),n("core-js/modules/es.regexp.exec"),n("core-js/modules/es.regexp.to-string"),n("core-js/modules/es.string.includes"),n("core-js/modules/es.string.iterator"),n("core-js/modules/es.string.match"),n("core-js/modules/es.string.split"),n("core-js/modules/es.string.trim"),n("core-js/modules/web.dom-collections.for-each"),n("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var i=h(n("../main"));n("../internationalization"),u(n("../constants"));function l(){if(typeof WeakMap!="function")return null;var c=new WeakMap;return l=function(){return c},c}function u(c){if(c&&c.__esModule)return c;if(c===null||a(c)!=="object"&&typeof c!="function")return{default:c};var f=l();if(f&&f.has(c))return f.get(c);var p={},m=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var g in c)if(Object.prototype.hasOwnProperty.call(c,g)){var y=m?Object.getOwnPropertyDescriptor(c,g):null;y&&(y.get||y.set)?Object.defineProperty(p,g,y):p[g]=c[g]}return p.default=c,f&&f.set(c,p),p}function h(c){return c&&c.__esModule?c:{default:c}}i.default._fesCodeReader=function(){};var d=i.default;o.default=d},{"../constants":253,"../internationalization":262,"../main":264,"core-js/modules/es.array.filter":152,"core-js/modules/es.array.flat-map":153,"core-js/modules/es.array.for-each":154,"core-js/modules/es.array.from":155,"core-js/modules/es.array.includes":156,"core-js/modules/es.array.index-of":157,"core-js/modules/es.array.iterator":158,"core-js/modules/es.array.map":161,"core-js/modules/es.array.unscopables.flat-map":165,"core-js/modules/es.object.keys":176,"core-js/modules/es.object.to-string":177,"core-js/modules/es.regexp.constructor":180,"core-js/modules/es.regexp.exec":181,"core-js/modules/es.regexp.to-string":182,"core-js/modules/es.string.includes":185,"core-js/modules/es.string.iterator":186,"core-js/modules/es.string.match":187,"core-js/modules/es.string.split":191,"core-js/modules/es.string.trim":193,"core-js/modules/es.symbol":196,"core-js/modules/es.symbol.description":194,"core-js/modules/es.symbol.iterator":195,"core-js/modules/web.dom-collections.for-each":228,"core-js/modules/web.dom-collections.iterator":229}],258:[function(n,s,o){n("core-js/modules/es.array.filter"),n("core-js/modules/es.array.index-of"),n("core-js/modules/es.array.join"),n("core-js/modules/es.array.map"),n("core-js/modules/es.array.slice"),n("core-js/modules/es.regexp.exec"),n("core-js/modules/es.string.match"),n("core-js/modules/es.string.replace"),n("core-js/modules/es.string.split"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var a,i=(a=n("../main"))&&a.__esModule?a:{default:a};function l(){var h=/(^|@)\S+:\d+/,d=/^\s*at .*(\S+:\d+|\(native\))/m,c=/^(eval@)?(\[native code])?$/;return{parse:function(f){return f.stacktrace!==void 0||f["opera#sourceloc"]!==void 0?this.parseOpera(f):f.stack&&f.stack.match(d)?this.parseV8OrIE(f):f.stack?this.parseFFOrSafari(f):void 0},extractLocation:function(f){if(f.indexOf(":")===-1)return[f];var p=/(.+?)(?::(\d+))?(?::(\d+))?$/.exec(f.replace(/[()]/g,""));return[p[1],p[2]||void 0,p[3]||void 0]},parseV8OrIE:function(f){return f.stack.split(`
`).filter(function(p){return!!p.match(d)},this).map(function(p){-1<p.indexOf("(eval ")&&(p=p.replace(/eval code/g,"eval").replace(/(\(eval at [^()]*)|(\),.*$)/g,""));var m=p.replace(/^\s+/,"").replace(/\(eval code/g,"("),g=m.match(/ (\((.+):(\d+):(\d+)\)$)/),y=(m=g?m.replace(g[0],""):m).split(/\s+/).slice(1),v=this.extractLocation(g?g[1]:y.pop());return{functionName:y.join(" ")||void 0,fileName:-1<["eval","<anonymous>"].indexOf(v[0])?void 0:v[0],lineNumber:v[1],columnNumber:v[2],source:p}},this)},parseFFOrSafari:function(f){return f.stack.split(`
`).filter(function(p){return!p.match(c)},this).map(function(p){if(-1<p.indexOf(" > eval")&&(p=p.replace(/ line (\d+)(?: > eval line \d+)* > eval:\d+:\d+/g,":$1")),p.indexOf("@")===-1&&p.indexOf(":")===-1)return{functionName:p};var m=/((.*".+"[^@]*)?[^@]*)(?:@)/,g=p.match(m),y=g&&g[1]?g[1]:void 0,v=this.extractLocation(p.replace(m,""));return{functionName:y,fileName:v[0],lineNumber:v[1],columnNumber:v[2],source:p}},this)},parseOpera:function(f){return!f.stacktrace||-1<f.message.indexOf(`
`)&&f.message.split(`
`).length>f.stacktrace.split(`
`).length?this.parseOpera9(f):f.stack?this.parseOpera11(f):this.parseOpera10(f)},parseOpera9:function(f){for(var p=/Line (\d+).*script (?:in )?(\S+)/i,m=f.message.split(`
`),g=[],y=2,v=m.length;y<v;y+=2){var b=p.exec(m[y]);b&&g.push({fileName:b[2],lineNumber:b[1],source:m[y]})}return g},parseOpera10:function(f){for(var p=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,m=f.stacktrace.split(`
`),g=[],y=0,v=m.length;y<v;y+=2){var b=p.exec(m[y]);b&&g.push({functionName:b[3]||void 0,fileName:b[2],lineNumber:b[1],source:m[y]})}return g},parseOpera11:function(f){return f.stack.split(`
`).filter(function(p){return!!p.match(h)&&!p.match(/^Error created at/)},this).map(function(p){var m,g=p.split("@"),y=this.extractLocation(g.pop()),v=g.shift()||"",b=v.replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^)]*\)/g,"")||void 0;return v.match(/\(([^)]*)\)/)&&(m=v.replace(/^[^(]+\(([^)]*)\)$/,"$1")),{functionName:b,args:m===void 0||m==="[arguments not available]"?void 0:m.split(","),fileName:y[0],lineNumber:y[1],columnNumber:y[2],source:p}},this)}}}i.default._getErrorStackParser=function(){return new l};var u=i.default;o.default=u},{"../main":264,"core-js/modules/es.array.filter":152,"core-js/modules/es.array.index-of":157,"core-js/modules/es.array.join":159,"core-js/modules/es.array.map":161,"core-js/modules/es.array.slice":162,"core-js/modules/es.regexp.exec":181,"core-js/modules/es.string.match":187,"core-js/modules/es.string.replace":189,"core-js/modules/es.string.split":191}],259:[function(n,s,o){n("core-js/modules/es.symbol"),n("core-js/modules/es.symbol.description"),n("core-js/modules/es.symbol.iterator"),n("core-js/modules/es.array.concat"),n("core-js/modules/es.array.for-each"),n("core-js/modules/es.array.includes"),n("core-js/modules/es.array.index-of"),n("core-js/modules/es.array.iterator"),n("core-js/modules/es.array.join"),n("core-js/modules/es.array.last-index-of"),n("core-js/modules/es.array.map"),n("core-js/modules/es.array.slice"),n("core-js/modules/es.function.name"),n("core-js/modules/es.map"),n("core-js/modules/es.number.constructor"),n("core-js/modules/es.object.get-prototype-of"),n("core-js/modules/es.object.keys"),n("core-js/modules/es.object.to-string"),n("core-js/modules/es.reflect.construct"),n("core-js/modules/es.regexp.exec"),n("core-js/modules/es.regexp.to-string"),n("core-js/modules/es.set"),n("core-js/modules/es.string.includes"),n("core-js/modules/es.string.iterator"),n("core-js/modules/es.string.split"),n("core-js/modules/web.dom-collections.for-each"),n("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var a,i=(a=n("../main"))&&a.__esModule?a:{default:a};(function(d){if(!(d&&d.__esModule)&&!(d===null||u(d)!=="object"&&typeof d!="function")){var c=l();if(c&&c.has(d))return c.get(d);var f={},p=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var m in d)if(Object.prototype.hasOwnProperty.call(d,m)){var g=p?Object.getOwnPropertyDescriptor(d,m):null;g&&(g.get||g.set)?Object.defineProperty(f,m,g):f[m]=d[m]}f.default=d,c&&c.set(d,f)}})(n("../constants")),n("../internationalization");function l(){if(typeof WeakMap!="function")return null;var d=new WeakMap;return l=function(){return d},d}function u(d){return(u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(c){return typeof c}:function(c){return c&&typeof Symbol=="function"&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c})(d)}i.default._validateParameters=i.default._clearValidateParamsCache=function(){};var h=i.default;o.default=h},{"../../../docs/parameterData.json":void 0,"../constants":253,"../internationalization":262,"../main":264,"core-js/modules/es.array.concat":149,"core-js/modules/es.array.for-each":154,"core-js/modules/es.array.includes":156,"core-js/modules/es.array.index-of":157,"core-js/modules/es.array.iterator":158,"core-js/modules/es.array.join":159,"core-js/modules/es.array.last-index-of":160,"core-js/modules/es.array.map":161,"core-js/modules/es.array.slice":162,"core-js/modules/es.function.name":166,"core-js/modules/es.map":167,"core-js/modules/es.number.constructor":170,"core-js/modules/es.object.get-prototype-of":175,"core-js/modules/es.object.keys":176,"core-js/modules/es.object.to-string":177,"core-js/modules/es.reflect.construct":179,"core-js/modules/es.regexp.exec":181,"core-js/modules/es.regexp.to-string":182,"core-js/modules/es.set":183,"core-js/modules/es.string.includes":185,"core-js/modules/es.string.iterator":186,"core-js/modules/es.string.split":191,"core-js/modules/es.symbol":196,"core-js/modules/es.symbol.description":194,"core-js/modules/es.symbol.iterator":195,"core-js/modules/web.dom-collections.for-each":228,"core-js/modules/web.dom-collections.iterator":229}],260:[function(n,s,o){function a(h){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(d){return typeof d}:function(d){return d&&typeof Symbol=="function"&&d.constructor===Symbol&&d!==Symbol.prototype?"symbol":typeof d})(h)}Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var i=function(h){if(h&&h.__esModule)return h;if(h===null||a(h)!=="object"&&typeof h!="function")return{default:h};var d=l();if(d&&d.has(h))return d.get(h);var c={},f=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var p in h)if(Object.prototype.hasOwnProperty.call(h,p)){var m=f?Object.getOwnPropertyDescriptor(h,p):null;m&&(m.get||m.set)?Object.defineProperty(c,p,m):c[p]=h[p]}return c.default=h,d&&d.set(h,c),c}(n("./constants"));function l(){if(typeof WeakMap!="function")return null;var h=new WeakMap;return l=function(){return h},h}var u={modeAdjust:function(h,d,c,f,p){return p===i.CORNER?{x:h,y:d,w:c,h:f}:p===i.CORNERS?{x:h,y:d,w:c-h,h:f-d}:p===i.RADIUS?{x:h-c,y:d-f,w:2*c,h:2*f}:p===i.CENTER?{x:h-.5*c,y:d-.5*f,w:c,h:f}:void 0}};o.default=u},{"./constants":253}],261:[function(n,s,o){n("core-js/modules/es.array.iterator"),n("core-js/modules/es.object.to-string"),n("core-js/modules/es.promise"),n("core-js/modules/es.string.iterator"),n("core-js/modules/web.dom-collections.iterator");var a,i=(a=n("../core/main"))&&a.__esModule?a:{default:a};n("./internationalization");var l=Promise.resolve();Promise.all([new Promise(function(u,h){document.readyState==="complete"?u():window.addEventListener("load",u,!1)}),l]).then(function(){window._setupDone===void 0?window.mocha||(window.setup&&typeof window.setup=="function"||window.draw&&typeof window.draw=="function")&&!i.default.instance&&new i.default:console.warn("p5.js seems to have been imported multiple times. Please remove the duplicate import")})},{"../core/main":264,"./internationalization":262,"core-js/modules/es.array.iterator":158,"core-js/modules/es.object.to-string":177,"core-js/modules/es.promise":178,"core-js/modules/es.string.iterator":186,"core-js/modules/web.dom-collections.iterator":229}],262:[function(n,s,o){n("core-js/modules/es.array.includes"),n("core-js/modules/es.array.iterator"),n("core-js/modules/es.array.join"),n("core-js/modules/es.array.slice"),n("core-js/modules/es.object.keys"),n("core-js/modules/es.object.to-string"),n("core-js/modules/es.promise"),n("core-js/modules/es.regexp.exec"),n("core-js/modules/es.string.includes"),n("core-js/modules/es.string.iterator"),n("core-js/modules/es.string.split"),n("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(o,"__esModule",{value:!0}),o.setTranslatorLanguage=o.currentTranslatorLanguage=o.availableTranslatorLanguages=o.initialize=o.translator=void 0;var a,i,l=h(n("i18next")),u=h(n("i18next-browser-languagedetector"));function h(p){return p&&p.__esModule?p:{default:p}}function d(p,m){for(var g=0;g<m.length;g++){var y=m[g];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(p,y.key,y)}}var c=function(){function p(y,v){(function(b,w){if(!(b instanceof w))throw new TypeError("Cannot call a class as a function")})(this,p),this.init(y,v)}var m,g;return m=p,(g=[{key:"fetchWithTimeout",value:function(y,v,b){var w=2<arguments.length&&b!==void 0?b:2e3;return Promise.race([fetch(y,v),new Promise(function(_,I){return setTimeout(function(){return I(new Error("timeout"))},w)})])}},{key:"init",value:function(y,v){var b=1<arguments.length&&v!==void 0?v:{};this.services=y,this.options=b}},{key:"read",value:function(y,v,b){var w=this.options.loadPath;if(y===this.options.fallback)b(null,a[y][v]);else if(i.includes(y)){var _=this.services.interpolator.interpolate(w,{lng:y,ns:v});this.loadUrl(_,b)}else b("Not found",!1)}},{key:"loadUrl",value:function(y,v){this.fetchWithTimeout(y).then(function(b){if(!b.ok)throw new Error("failed loading ".concat(y));return b.json()},function(){throw new Error("failed loading ".concat(y))}).then(function(b){return v(null,b)}).catch(v)}}])&&d(m.prototype,g),p}();c.type="backend";var f=function(p,m){console.debug("p5.js translator called before translations were loaded"),l.default.t(p,m)};o.translator=f,o.initialize=function(){return l.default.use(u.default).use(c).init({fallbackLng:"en",nestingPrefix:"$tr(",nestingSuffix:")",defaultNS:"translation",returnEmptyString:!1,interpolation:{escapeValue:!1},detection:{checkWhitelist:!1,order:["querystring","navigator","htmlTag","path","subdomain"],caches:[]},backend:{fallback:"en",loadPath:"https://cdn.jsdelivr.net/npm/p5/translations/{{lng}}/{{ns}}.json"},partialBundledLanguages:!0,resources:a}).then(function(p){o.translator=f=p},function(p){return console.debug("Translations failed to load (".concat(p,")"))})},o.availableTranslatorLanguages=function(){return l.default.languages},o.currentTranslatorLanguage=function(){return l.default.language},o.setTranslatorLanguage=function(p){return l.default.changeLanguage(p||void 0,function(m){return console.debug("Translations failed to load (".concat(m,")"))})}},{"../../translations":void 0,"../../translations/dev":void 0,"core-js/modules/es.array.includes":156,"core-js/modules/es.array.iterator":158,"core-js/modules/es.array.join":159,"core-js/modules/es.array.slice":162,"core-js/modules/es.object.keys":176,"core-js/modules/es.object.to-string":177,"core-js/modules/es.promise":178,"core-js/modules/es.regexp.exec":181,"core-js/modules/es.string.includes":185,"core-js/modules/es.string.iterator":186,"core-js/modules/es.string.split":191,"core-js/modules/web.dom-collections.iterator":229,i18next:3,"i18next-browser-languagedetector":3}],263:[function(n,s,o){Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var a,i=(a=n("./main"))&&a.__esModule?a:{default:a};i.default.prototype.pushStyle=function(){throw new Error("pushStyle() not used, see push()")},i.default.prototype.popStyle=function(){throw new Error("popStyle() not used, see pop()")},i.default.prototype.popMatrix=function(){throw new Error("popMatrix() not used, see pop()")},i.default.prototype.pushMatrix=function(){throw new Error("pushMatrix() not used, see push()")};var l=i.default;o.default=l},{"./main":264}],264:[function(n,s,o){function a(f){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(p){return typeof p}:function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":typeof p})(f)}n("core-js/modules/es.symbol"),n("core-js/modules/es.symbol.description"),n("core-js/modules/es.symbol.iterator"),n("core-js/modules/es.array.for-each"),n("core-js/modules/es.array.iterator"),n("core-js/modules/es.array.slice"),n("core-js/modules/es.object.get-own-property-names"),n("core-js/modules/es.object.to-string"),n("core-js/modules/es.string.iterator"),n("core-js/modules/web.dom-collections.for-each"),n("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0,n("./shim");var i=function(f){if(f&&f.__esModule)return f;if(f===null||a(f)!=="object"&&typeof f!="function")return{default:f};var p=l();if(p&&p.has(f))return p.get(f);var m={},g=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var y in f)if(Object.prototype.hasOwnProperty.call(f,y)){var v=g?Object.getOwnPropertyDescriptor(f,y):null;v&&(v.get||v.set)?Object.defineProperty(m,y,v):m[y]=f[y]}return m.default=f,p&&p.set(f,m),m}(n("./constants"));function l(){if(typeof WeakMap!="function")return null;var f=new WeakMap;return l=function(){return f},f}function u(f,p){for(var m=0;m<p.length;m++){var g=p[m];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(f,g.key,g)}}var h=function(){function f(g,y,v){var b=this;(function(re,ce){if(!(re instanceof ce))throw new TypeError("Cannot call a class as a function")})(this,f),this._setupDone=!1,this._pixelDensity=Math.ceil(window.devicePixelRatio)||1,this._userNode=y,this._curElement=null,this._elements=[],this._glAttributes=null,this._requestAnimId=0,this._preloadCount=0,this._isGlobal=!1,this._loop=!0,this._initializeInstanceVariables(),this._defaultCanvasSize={width:100,height:100},this._events={mousemove:null,mousedown:null,mouseup:null,dragend:null,dragover:null,click:null,dblclick:null,mouseover:null,mouseout:null,keydown:null,keyup:null,keypress:null,touchstart:null,touchmove:null,touchend:null,resize:null,blur:null},this._millisStart=-1,this._lcg_random_state=null,this._gaussian_previous=!1,this._events.wheel=null,this._loadingScreenId="p5_loading",this._registeredMethods={};var w=Object.getOwnPropertyNames(f.prototype._registeredMethods),_=!0,I=!1,C=void 0;try{for(var N,O=w[Symbol.iterator]();!(_=(N=O.next()).done);_=!0){var D=N.value;this._registeredMethods[D]=f.prototype._registeredMethods[D].slice()}}catch(re){I=!0,C=re}finally{try{_||O.return==null||O.return()}finally{if(I)throw C}}window.DeviceOrientationEvent&&(this._events.deviceorientation=null),window.DeviceMotionEvent&&!window._isNodeWebkit&&(this._events.devicemotion=null),this._start=function(){b._userNode&&typeof b._userNode=="string"&&(b._userNode=document.getElementById(b._userNode));var re=b._isGlobal?window:b;if(re.preload){var ce=document.getElementById(b._loadingScreenId);ce||((ce=document.createElement("div")).innerHTML="Loading...",ce.style.position="absolute",ce.id=b._loadingScreenId,(b._userNode||document.body).appendChild(ce));var be=b._preloadMethods;for(var we in be){be[we]=be[we]||f;var ye=be[we];ye!==f.prototype&&ye!==f||(b._isGlobal&&(window[we]=b._wrapPreload(b,we)),ye=b),b._registeredPreloadMethods[we]=ye[we],ye[we]=b._wrapPreload(ye,we)}re.preload(),b._runIfPreloadsAreDone()}else b._setup(),b._draw()},this._runIfPreloadsAreDone=function(){var re=this._isGlobal?window:this;if(re._preloadCount===0){var ce=document.getElementById(re._loadingScreenId);ce&&ce.parentNode.removeChild(ce),this._setupDone||(this._lastFrameTime=window.performance.now(),re._setup(),re._draw())}},this._decrementPreload=function(){var re=this._isGlobal?window:this;typeof re.preload=="function"&&(re._setProperty("_preloadCount",re._preloadCount-1),re._runIfPreloadsAreDone())},this._wrapPreload=function(re,ce){var be=this;return function(){be._incrementPreload();for(var we=arguments.length,ye=new Array(we),Oe=0;Oe<we;Oe++)ye[Oe]=arguments[Oe];return be._registeredPreloadMethods[ce].apply(re,ye)}},this._incrementPreload=function(){var re=this._isGlobal?window:this;re._setProperty("_preloadCount",re._preloadCount+1)},this._setup=function(){b.createCanvas(b._defaultCanvasSize.width,b._defaultCanvasSize.height,"p2d");var re=b._isGlobal?window:b;if(typeof re.preload=="function")for(var ce in b._preloadMethods)re[ce]=b._preloadMethods[ce][ce],re[ce]&&b&&(re[ce]=re[ce].bind(b));b._millisStart=window.performance.now(),typeof re.setup=="function"&&re.setup();var be=document.getElementsByTagName("canvas"),we=!0,ye=!1,Oe=void 0;try{for(var Se,Ee=be[Symbol.iterator]();!(we=(Se=Ee.next()).done);we=!0){var j=Se.value;j.dataset.hidden==="true"&&(j.style.visibility="",delete j.dataset.hidden)}}catch(W){ye=!0,Oe=W}finally{try{we||Ee.return==null||Ee.return()}finally{if(ye)throw Oe}}b._lastFrameTime=window.performance.now(),b._setupDone=!0,(b._accessibleOutputs.grid||b._accessibleOutputs.text)&&b._updateAccsOutput()},this._draw=function(){var re=window.performance.now(),ce=re-b._lastFrameTime,be=1e3/b._targetFrameRate;(!b._loop||be-5<=ce)&&(b.redraw(),b._frameRate=1e3/(re-b._lastFrameTime),b.deltaTime=re-b._lastFrameTime,b._setProperty("deltaTime",b.deltaTime),b._lastFrameTime=re,b._updateMouseCoords!==void 0&&(b._updateMouseCoords(),b._setProperty("movedX",0),b._setProperty("movedY",0))),b._loop&&(b._requestAnimId=window.requestAnimationFrame(b._draw))},this._setProperty=function(re,ce){b[re]=ce,b._isGlobal&&(window[re]=ce)},this.remove=function(){var re=document.getElementById(b._loadingScreenId);if(re&&(re.parentNode.removeChild(re),b._incrementPreload()),b._curElement){for(var ce in b._loop=!1,b._requestAnimId&&window.cancelAnimationFrame(b._requestAnimId),b._events)window.removeEventListener(ce,b._events[ce]);var be=!0,we=!1,ye=void 0;try{for(var Oe,Se=b._elements[Symbol.iterator]();!(be=(Oe=Se.next()).done);be=!0){var Ee=Oe.value;for(var j in Ee.elt&&Ee.elt.parentNode&&Ee.elt.parentNode.removeChild(Ee.elt),Ee._events)Ee.elt.removeEventListener(j,Ee._events[j])}}catch(ve){we=!0,ye=ve}finally{try{be||Se.return==null||Se.return()}finally{if(we)throw ye}}var W=b;b._registeredMethods.remove.forEach(function(ve){ve!==void 0&&ve.call(W)})}if(b._isGlobal){for(var J in f.prototype)try{delete window[J]}catch{window[J]=void 0}for(var ie in b)if(b.hasOwnProperty(ie))try{delete window[ie]}catch{window[ie]=void 0}f.instance=null}},this._registeredMethods.init.forEach(function(re){re!==void 0&&re.call(this)},this),this._setupPromisePreloads();var M=this._createFriendlyGlobalFunctionBinder();if(g)g(this),f._checkForUserDefinedFunctions(this);else{for(var P in this._isGlobal=!0,f.instance=this,f.prototype)if(typeof f.prototype[P]=="function"){var F=P.substring(2);this._events.hasOwnProperty(F)||(Math.hasOwnProperty(P)&&Math[P]===f.prototype[P]?M(P,f.prototype[P]):M(P,f.prototype[P].bind(this)))}else M(P,f.prototype[P]);for(var B in this)this.hasOwnProperty(B)&&M(B,this[B])}for(var z in this._events){var Z=this["_on".concat(z)];if(Z){var Q=Z.bind(this);window.addEventListener(z,Q,{passive:!1}),this._events[z]=Q}}function K(){b._setProperty("focused",!0)}function ne(){b._setProperty("focused",!1)}window.addEventListener("focus",K),window.addEventListener("blur",ne),this.registerMethod("remove",function(){window.removeEventListener("focus",K),window.removeEventListener("blur",ne)}),document.readyState==="complete"?this._start():window.addEventListener("load",this._start.bind(this),!1)}var p,m;return p=f,(m=[{key:"_initializeInstanceVariables",value:function(){this._accessibleOutputs={text:!1,grid:!1,textLabel:!1,gridLabel:!1},this._styles=[],this._bezierDetail=20,this._curveDetail=20,this._colorMode=i.RGB,this._colorMaxes={rgb:[255,255,255,255],hsb:[360,100,100,1],hsl:[360,100,100,1]},this._downKeys={}}},{key:"registerPreloadMethod",value:function(g,y){f.prototype._preloadMethods.hasOwnProperty(g)||(f.prototype._preloadMethods[g]=y)}},{key:"registerMethod",value:function(g,y){var v=this||f.prototype;v._registeredMethods.hasOwnProperty(g)||(v._registeredMethods[g]=[]),v._registeredMethods[g].push(y)}},{key:"_createFriendlyGlobalFunctionBinder",value:function(g){var y=0<arguments.length&&g!==void 0?g:{},v=y.globalObject||window;return y.log||console.log.bind(console),function(b,w){v[b]=w}}}])&&u(p.prototype,m),f}();for(var d in h.instance=null,h.disableFriendlyErrors=!1,i)h.prototype[d]=i[d];h.VERSION=i.VERSION,h.prototype._preloadMethods={loadJSON:h.prototype,loadImage:h.prototype,loadStrings:h.prototype,loadXML:h.prototype,loadBytes:h.prototype,loadTable:h.prototype,loadFont:h.prototype,loadModel:h.prototype,loadShader:h.prototype},h.prototype._registeredMethods={init:[],pre:[],post:[],remove:[]},h.prototype._registeredPreloadMethods={};var c=h;o.default=c},{"./constants":253,"./shim":275,"core-js/modules/es.array.for-each":154,"core-js/modules/es.array.iterator":158,"core-js/modules/es.array.slice":162,"core-js/modules/es.object.get-own-property-names":174,"core-js/modules/es.object.to-string":177,"core-js/modules/es.string.iterator":186,"core-js/modules/es.symbol":196,"core-js/modules/es.symbol.description":194,"core-js/modules/es.symbol.iterator":195,"core-js/modules/web.dom-collections.for-each":228,"core-js/modules/web.dom-collections.iterator":229}],265:[function(n,s,o){Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var a,i=(a=n("./main"))&&a.__esModule?a:{default:a};i.default.Element=function(u,h){this.elt=u,this._pInst=this._pixelsState=h,this._events={},this.width=this.elt.offsetWidth,this.height=this.elt.offsetHeight},i.default.Element.prototype.parent=function(u){return u===void 0?this.elt.parentNode:(typeof u=="string"?(u[0]==="#"&&(u=u.substring(1)),u=document.getElementById(u)):u instanceof i.default.Element&&(u=u.elt),u.appendChild(this.elt),this)},i.default.Element.prototype.id=function(u){return u===void 0?this.elt.id:(this.elt.id=u,this.width=this.elt.offsetWidth,this.height=this.elt.offsetHeight,this)},i.default.Element.prototype.class=function(u){return u===void 0?this.elt.className:(this.elt.className=u,this)},i.default.Element.prototype.mousePressed=function(u){return i.default.Element._adjustListener("mousedown",function(h){return this._pInst._setProperty("mouseIsPressed",!0),this._pInst._setMouseButton(h),u.call(this)},this),this},i.default.Element.prototype.doubleClicked=function(u){return i.default.Element._adjustListener("dblclick",u,this),this},i.default.Element.prototype.mouseWheel=function(u){return i.default.Element._adjustListener("wheel",u,this),this},i.default.Element.prototype.mouseReleased=function(u){return i.default.Element._adjustListener("mouseup",u,this),this},i.default.Element.prototype.mouseClicked=function(u){return i.default.Element._adjustListener("click",u,this),this},i.default.Element.prototype.mouseMoved=function(u){return i.default.Element._adjustListener("mousemove",u,this),this},i.default.Element.prototype.mouseOver=function(u){return i.default.Element._adjustListener("mouseover",u,this),this},i.default.Element.prototype.mouseOut=function(u){return i.default.Element._adjustListener("mouseout",u,this),this},i.default.Element.prototype.touchStarted=function(u){return i.default.Element._adjustListener("touchstart",u,this),this},i.default.Element.prototype.touchMoved=function(u){return i.default.Element._adjustListener("touchmove",u,this),this},i.default.Element.prototype.touchEnded=function(u){return i.default.Element._adjustListener("touchend",u,this),this},i.default.Element.prototype.dragOver=function(u){return i.default.Element._adjustListener("dragover",u,this),this},i.default.Element.prototype.dragLeave=function(u){return i.default.Element._adjustListener("dragleave",u,this),this},i.default.Element._adjustListener=function(u,h,d){return h===!1?i.default.Element._detachListener(u,d):i.default.Element._attachListener(u,h,d),this},i.default.Element._attachListener=function(u,h,d){d._events[u]&&i.default.Element._detachListener(u,d);var c=h.bind(d);d.elt.addEventListener(u,c,!1),d._events[u]=c},i.default.Element._detachListener=function(u,h){var d=h._events[u];h.elt.removeEventListener(u,d,!1),h._events[u]=null},i.default.Element.prototype._setProperty=function(u,h){this[u]=h};var l=i.default.Element;o.default=l},{"./main":264}],266:[function(n,s,o){function a(c){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(f){return typeof f}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f})(c)}n("core-js/modules/es.array.index-of"),n("core-js/modules/es.array.splice"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var i,l=(i=n("./main"))&&i.__esModule?i:{default:i},u=function(c){if(c&&c.__esModule)return c;if(c===null||a(c)!=="object"&&typeof c!="function")return{default:c};var f=h();if(f&&f.has(c))return f.get(c);var p={},m=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var g in c)if(Object.prototype.hasOwnProperty.call(c,g)){var y=m?Object.getOwnPropertyDescriptor(c,g):null;y&&(y.get||y.set)?Object.defineProperty(p,g,y):p[g]=c[g]}return p.default=c,f&&f.set(c,p),p}(n("./constants"));function h(){if(typeof WeakMap!="function")return null;var c=new WeakMap;return h=function(){return c},c}l.default.Graphics=function(c,f,p,m){var g=p||u.P2D;this.canvas=document.createElement("canvas");var y=m._userNode||document.body;for(var v in y.appendChild(this.canvas),l.default.Element.call(this,this.canvas,m),l.default.prototype)this[v]||(typeof l.default.prototype[v]=="function"?this[v]=l.default.prototype[v].bind(this):this[v]=l.default.prototype[v]);return l.default.prototype._initializeInstanceVariables.apply(this),this.width=c,this.height=f,this._pixelDensity=m._pixelDensity,g===u.WEBGL?this._renderer=new l.default.RendererGL(this.canvas,this,!1):this._renderer=new l.default.Renderer2D(this.canvas,this,!1),m._elements.push(this),Object.defineProperty(this,"deltaTime",{get:function(){return this._pInst.deltaTime}}),this._renderer.resize(c,f),this._renderer._applyDefaults(),this},l.default.Graphics.prototype=Object.create(l.default.Element.prototype),l.default.Graphics.prototype.reset=function(){this._renderer.resetMatrix(),this._renderer.isP3D&&this._renderer._update()},l.default.Graphics.prototype.remove=function(){this.elt.parentNode&&this.elt.parentNode.removeChild(this.elt);var c=this._pInst._elements.indexOf(this);for(var f in c!==-1&&this._pInst._elements.splice(c,1),this._events)this.elt.removeEventListener(f,this._events[f])};var d=l.default.Graphics;o.default=d},{"./constants":253,"./main":264,"core-js/modules/es.array.index-of":157,"core-js/modules/es.array.splice":164}],267:[function(n,s,o){n("core-js/modules/es.symbol"),n("core-js/modules/es.symbol.description"),n("core-js/modules/es.symbol.iterator"),n("core-js/modules/es.array.iterator"),n("core-js/modules/es.number.constructor"),n("core-js/modules/es.object.assign"),n("core-js/modules/es.object.to-string"),n("core-js/modules/es.regexp.exec"),n("core-js/modules/es.regexp.to-string"),n("core-js/modules/es.string.iterator"),n("core-js/modules/es.string.replace"),n("core-js/modules/es.string.split"),n("core-js/modules/es.string.trim"),n("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var a,i=(a=n("./main"))&&a.__esModule?a:{default:a},l=function(f){if(f&&f.__esModule)return f;if(f===null||h(f)!=="object"&&typeof f!="function")return{default:f};var p=u();if(p&&p.has(f))return p.get(f);var m={},g=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var y in f)if(Object.prototype.hasOwnProperty.call(f,y)){var v=g?Object.getOwnPropertyDescriptor(f,y):null;v&&(v.get||v.set)?Object.defineProperty(m,y,v):m[y]=f[y]}return m.default=f,p&&p.set(f,m),m}(n("../core/constants"));function u(){if(typeof WeakMap!="function")return null;var f=new WeakMap;return u=function(){return f},f}function h(f){return(h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(p){return typeof p}:function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":typeof p})(f)}function d(f){var p=0,m=0;if(f.offsetParent)for(;p+=f.offsetLeft,m+=f.offsetTop,f=f.offsetParent;);else p+=f.offsetLeft,m+=f.offsetTop;return[p,m]}i.default.Renderer=function(f,p,m){i.default.Element.call(this,f,p),this.canvas=f,this._pixelsState=p,m?(this._isMainCanvas=!0,this._pInst._setProperty("_curElement",this),this._pInst._setProperty("canvas",this.canvas),this._pInst._setProperty("width",this.width),this._pInst._setProperty("height",this.height)):(this.canvas.style.display="none",this._styles=[]),this._textSize=12,this._textLeading=15,this._textFont="sans-serif",this._textStyle=l.NORMAL,this._textAscent=null,this._textDescent=null,this._textAlign=l.LEFT,this._textBaseline=l.BASELINE,this._textWrap=l.WORD,this._rectMode=l.CORNER,this._ellipseMode=l.CENTER,this._curveTightness=0,this._imageMode=l.CORNER,this._tint=null,this._doStroke=!0,this._doFill=!0,this._strokeSet=!1,this._fillSet=!1,this._leadingSet=!1},i.default.Renderer.prototype=Object.create(i.default.Element.prototype),i.default.Renderer.prototype.push=function(){return{properties:{_doStroke:this._doStroke,_strokeSet:this._strokeSet,_doFill:this._doFill,_fillSet:this._fillSet,_tint:this._tint,_imageMode:this._imageMode,_rectMode:this._rectMode,_ellipseMode:this._ellipseMode,_textFont:this._textFont,_textLeading:this._textLeading,_leadingSet:this._leadingSet,_textSize:this._textSize,_textAlign:this._textAlign,_textBaseline:this._textBaseline,_textStyle:this._textStyle,_textWrap:this._textWrap}}},i.default.Renderer.prototype.pop=function(f){f.properties&&Object.assign(this,f.properties)},i.default.Renderer.prototype.resize=function(f,p){this.width=f,this.height=p,this.elt.width=f*this._pInst._pixelDensity,this.elt.height=p*this._pInst._pixelDensity,this.elt.style.width="".concat(f,"px"),this.elt.style.height="".concat(p,"px"),this._isMainCanvas&&(this._pInst._setProperty("width",this.width),this._pInst._setProperty("height",this.height))},i.default.Renderer.prototype.get=function(f,p,m,g){var y=this._pixelsState,v=y._pixelDensity,b=this.canvas;if(f===void 0&&p===void 0)f=p=0,m=y.width,g=y.height;else if(f*=v,p*=v,m===void 0&&g===void 0)return f<0||p<0||f>=b.width||p>=b.height?[0,0,0,0]:this._getPixel(f,p);var w=new i.default.Image(m,g);return w.canvas.getContext("2d").drawImage(b,f,p,m*v,g*v,0,0,m,g),w},i.default.Renderer.prototype.textLeading=function(f){return typeof f=="number"?(this._setProperty("_leadingSet",!0),this._setProperty("_textLeading",f),this._pInst):this._textLeading},i.default.Renderer.prototype.textSize=function(f){return typeof f=="number"?(this._setProperty("_textSize",f),this._leadingSet||this._setProperty("_textLeading",f*l._DEFAULT_LEADMULT),this._applyTextProperties()):this._textSize},i.default.Renderer.prototype.textStyle=function(f){return f?(f!==l.NORMAL&&f!==l.ITALIC&&f!==l.BOLD&&f!==l.BOLDITALIC||this._setProperty("_textStyle",f),this._applyTextProperties()):this._textStyle},i.default.Renderer.prototype.textAscent=function(){return this._textAscent===null&&this._updateTextMetrics(),this._textAscent},i.default.Renderer.prototype.textDescent=function(){return this._textDescent===null&&this._updateTextMetrics(),this._textDescent},i.default.Renderer.prototype.textAlign=function(f,p){return f!==void 0?(this._setProperty("_textAlign",f),p!==void 0&&this._setProperty("_textBaseline",p),this._applyTextProperties()):{horizontal:this._textAlign,vertical:this._textBaseline}},i.default.Renderer.prototype.textWrap=function(f){return this._setProperty("_textWrap",f),this._textWrap},i.default.Renderer.prototype.text=function(f,p,m,g,y){var v,b,w,_,I,C,N,O=this._pInst,D=this._textWrap,M=Number.MAX_VALUE;if((this._doFill||this._doStroke)&&f!==void 0){if(typeof f!="string"&&(f=f.toString()),v=(f=f.replace(/(\t)/g,"  ")).split(`
`),g!==void 0){switch(this._rectMode===l.CENTER&&(p-=g/2),this._textAlign){case l.CENTER:p+=g/2;break;case l.RIGHT:p+=g}var P=!1;if(y!==void 0){switch(this._rectMode===l.CENTER&&(m-=y/2),this._textBaseline){case l.BOTTOM:N=m+y,m=Math.max(N,m);break;case l.CENTER:N=m+y/2,m=Math.max(N,m);break;case l.BASELINE:P=!0,this._textBaseline=l.TOP}M=m+y-O.textAscent()}if(D===l.WORD){for(var F=[],B=0;B<v.length;B++){b="",I=v[B].split(" ");for(var z=0;z<I.length;z++)w="".concat(b+I[z])+" ",b=g<(_=this.textWidth(w))&&0<b.length?(F.push(b),"".concat(I[z])+" "):w;F.push(b)}var Z=0,Q=O.textAlign().vertical;Q===l.CENTER?Z=(F.length-1)*O.textLeading()/2:Q===l.BOTTOM&&(Z=(F.length-1)*O.textLeading());for(var K=0;K<v.length;K++){b="",I=v[K].split(" ");for(var ne=0;ne<I.length;ne++)w="".concat(b+I[ne])+" ",g<(_=this.textWidth(w))&&0<b.length?(this._renderText(O,b.trim(),p,m-Z,M),b="".concat(I[ne])+" ",m+=O.textLeading()):b=w;this._renderText(O,b.trim(),p,m-Z,M),m+=O.textLeading(),P&&(this._textBaseline=l.BASELINE)}}else{for(var re=[],ce=0;ce<v.length;ce++){b="",C=v[ce].split("");for(var be=0;be<C.length;be++)w="".concat(b+C[be]),(_=this.textWidth(w))<=g?b+=C[be]:g<_&&0<b.length&&(re.push(b),b="".concat(C[be]))}re.push(b);var we=0,ye=O.textAlign().vertical;ye===l.CENTER?we=(re.length-1)*O.textLeading()/2:ye===l.BOTTOM&&(we=(re.length-1)*O.textLeading());for(var Oe=0;Oe<v.length;Oe++){b="",C=v[Oe].split("");for(var Se=0;Se<C.length;Se++)w="".concat(b+C[Se]),(_=this.textWidth(w))<=g?b+=C[Se]:g<_&&0<b.length&&(this._renderText(O,b.trim(),p,m-we,M),m+=O.textLeading(),b="".concat(C[Se]))}this._renderText(O,b.trim(),p,m-we,M),m+=O.textLeading(),P&&(this._textBaseline=l.BASELINE)}}else{var Ee=0,j=O.textAlign().vertical;j===l.CENTER?Ee=(v.length-1)*O.textLeading()/2:j===l.BOTTOM&&(Ee=(v.length-1)*O.textLeading());for(var W=0;W<v.length;W++)this._renderText(O,v[W],p,m-Ee,M),m+=O.textLeading()}return O}},i.default.Renderer.prototype._applyDefaults=function(){return this},i.default.Renderer.prototype._isOpenType=function(){var f=0<arguments.length&&arguments[0]!==void 0?arguments[0]:this._textFont;return h(f)==="object"&&f.font&&f.font.supported},i.default.Renderer.prototype._updateTextMetrics=function(){if(this._isOpenType())return this._setProperty("_textAscent",this._textFont._textAscent()),this._setProperty("_textDescent",this._textFont._textDescent()),this;var f=document.createElement("span");f.style.fontFamily=this._textFont,f.style.fontSize="".concat(this._textSize,"px"),f.innerHTML="ABCjgq|";var p=document.createElement("div");p.style.display="inline-block",p.style.width="1px",p.style.height="0px";var m=document.createElement("div");m.appendChild(f),m.appendChild(p),m.style.height="0px",m.style.overflow="hidden",document.body.appendChild(m),p.style.verticalAlign="baseline";var g=d(p),y=d(f),v=g[1]-y[1];p.style.verticalAlign="bottom",g=d(p),y=d(f);var b=g[1]-y[1]-v;return document.body.removeChild(m),this._setProperty("_textAscent",v),this._setProperty("_textDescent",b),this};var c=i.default.Renderer;o.default=c},{"../core/constants":253,"./main":264,"core-js/modules/es.array.iterator":158,"core-js/modules/es.number.constructor":170,"core-js/modules/es.object.assign":173,"core-js/modules/es.object.to-string":177,"core-js/modules/es.regexp.exec":181,"core-js/modules/es.regexp.to-string":182,"core-js/modules/es.string.iterator":186,"core-js/modules/es.string.replace":189,"core-js/modules/es.string.split":191,"core-js/modules/es.string.trim":193,"core-js/modules/es.symbol":196,"core-js/modules/es.symbol.description":194,"core-js/modules/es.symbol.iterator":195,"core-js/modules/web.dom-collections.iterator":229}],268:[function(n,s,o){function a(p){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(m){return typeof m}:function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m})(p)}n("core-js/modules/es.array.concat"),n("core-js/modules/es.array.fill"),n("core-js/modules/es.array.for-each"),n("core-js/modules/es.array.slice"),n("core-js/modules/es.function.name"),n("core-js/modules/es.number.to-fixed"),n("core-js/modules/es.object.to-string"),n("core-js/modules/es.regexp.to-string"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var i=d(n("./main")),l=function(p){if(p&&p.__esModule)return p;if(p===null||a(p)!=="object"&&typeof p!="function")return{default:p};var m=h();if(m&&m.has(p))return m.get(p);var g={},y=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var v in p)if(Object.prototype.hasOwnProperty.call(p,v)){var b=y?Object.getOwnPropertyDescriptor(p,v):null;b&&(b.get||b.set)?Object.defineProperty(g,v,b):g[v]=p[v]}return g.default=p,m&&m.set(p,g),g}(n("./constants")),u=d(n("../image/filters"));function h(){if(typeof WeakMap!="function")return null;var p=new WeakMap;return h=function(){return p},p}function d(p){return p&&p.__esModule?p:{default:p}}n("./p5.Renderer");var c="rgba(0,0,0,0)";i.default.Renderer2D=function(p,m,g){return i.default.Renderer.call(this,p,m,g),this.drawingContext=this.canvas.getContext("2d"),this._pInst._setProperty("drawingContext",this.drawingContext),this},i.default.Renderer2D.prototype=Object.create(i.default.Renderer.prototype),i.default.Renderer2D.prototype._applyDefaults=function(){this._cachedFillStyle=this._cachedStrokeStyle=void 0,this._cachedBlendMode=l.BLEND,this._setFill(l._DEFAULT_FILL),this._setStroke(l._DEFAULT_STROKE),this.drawingContext.lineCap=l.ROUND,this.drawingContext.font="normal 12px sans-serif"},i.default.Renderer2D.prototype.resize=function(p,m){i.default.Renderer.prototype.resize.call(this,p,m),this.drawingContext.scale(this._pInst._pixelDensity,this._pInst._pixelDensity)},i.default.Renderer2D.prototype.background=function(){if(this.drawingContext.save(),this.resetMatrix(),(arguments.length<=0?void 0:arguments[0])instanceof i.default.Image)this._pInst.image(arguments.length<=0?void 0:arguments[0],0,0,this.width,this.height);else{var p,m=this._getFill(),g=(p=this._pInst).color.apply(p,arguments);this._pInst._addAccsOutput()&&this._pInst._accsBackground(g.levels);var y=g.toString();this._setFill(y),this._isErasing&&this.blendMode(this._cachedBlendMode),this.drawingContext.fillRect(0,0,this.width,this.height),this._setFill(m),this._isErasing&&this._pInst.erase()}this.drawingContext.restore()},i.default.Renderer2D.prototype.clear=function(){this.drawingContext.save(),this.resetMatrix(),this.drawingContext.clearRect(0,0,this.width,this.height),this.drawingContext.restore()},i.default.Renderer2D.prototype.fill=function(){var p,m=(p=this._pInst).color.apply(p,arguments);this._setFill(m.toString()),this._pInst._addAccsOutput()&&this._pInst._accsCanvasColors("fill",m.levels)},i.default.Renderer2D.prototype.stroke=function(){var p,m=(p=this._pInst).color.apply(p,arguments);this._setStroke(m.toString()),this._pInst._addAccsOutput()&&this._pInst._accsCanvasColors("stroke",m.levels)},i.default.Renderer2D.prototype.erase=function(p,m){if(!this._isErasing){this._cachedFillStyle=this.drawingContext.fillStyle;var g=this._pInst.color(255,p).toString();this.drawingContext.fillStyle=g,this._cachedStrokeStyle=this.drawingContext.strokeStyle;var y=this._pInst.color(255,m).toString();this.drawingContext.strokeStyle=y;var v=this._cachedBlendMode;this.blendMode(l.REMOVE),this._cachedBlendMode=v,this._isErasing=!0}},i.default.Renderer2D.prototype.noErase=function(){this._isErasing&&(this.drawingContext.fillStyle=this._cachedFillStyle,this.drawingContext.strokeStyle=this._cachedStrokeStyle,this.blendMode(this._cachedBlendMode),this._isErasing=!1)},i.default.Renderer2D.prototype.image=function(p,m,g,y,v,b,w,_,I){var C;p.gifProperties&&p._animateGif(this._pInst);try{this._tint&&(i.default.MediaElement&&p instanceof i.default.MediaElement&&p.loadPixels(),p.canvas&&(C=this._getTintedImageCanvas(p))),C=C||p.canvas||p.elt;var N=1;p.width&&0<p.width&&(N=C.width/p.width),this._isErasing&&this.blendMode(this._cachedBlendMode),this.drawingContext.drawImage(C,N*m,N*g,N*y,N*v,b,w,_,I),this._isErasing&&this._pInst.erase()}catch(O){if(O.name!=="NS_ERROR_NOT_AVAILABLE")throw O}},i.default.Renderer2D.prototype._getTintedImageCanvas=function(p){if(!p.canvas)return p;var m=u.default._toPixels(p.canvas),g=document.createElement("canvas");g.width=p.canvas.width,g.height=p.canvas.height;for(var y=g.getContext("2d"),v=y.createImageData(p.canvas.width,p.canvas.height),b=v.data,w=0;w<m.length;w+=4){var _=m[w],I=m[w+1],C=m[w+2],N=m[w+3];b[w]=_*this._tint[0]/255,b[w+1]=I*this._tint[1]/255,b[w+2]=C*this._tint[2]/255,b[w+3]=N*this._tint[3]/255}return y.putImageData(v,0,0),g},i.default.Renderer2D.prototype.blendMode=function(p){if(p===l.SUBTRACT)console.warn("blendMode(SUBTRACT) only works in WEBGL mode.");else{if(p!==l.BLEND&&p!==l.REMOVE&&p!==l.DARKEST&&p!==l.LIGHTEST&&p!==l.DIFFERENCE&&p!==l.MULTIPLY&&p!==l.EXCLUSION&&p!==l.SCREEN&&p!==l.REPLACE&&p!==l.OVERLAY&&p!==l.HARD_LIGHT&&p!==l.SOFT_LIGHT&&p!==l.DODGE&&p!==l.BURN&&p!==l.ADD)throw new Error("Mode ".concat(p," not recognized."));this._cachedBlendMode=p,this.drawingContext.globalCompositeOperation=p}},i.default.Renderer2D.prototype.blend=function(){for(var p=this.drawingContext.globalCompositeOperation,m=arguments.length,g=new Array(m),y=0;y<m;y++)g[y]=arguments[y];var v=g[g.length-1],b=Array.prototype.slice.call(g,0,g.length-1);this.drawingContext.globalCompositeOperation=v,i.default.prototype.copy.apply(this,b),this.drawingContext.globalCompositeOperation=p},i.default.Renderer2D.prototype._getPixel=function(p,m){var g;return[(g=this.drawingContext.getImageData(p,m,1,1).data)[0],g[1],g[2],g[3]]},i.default.Renderer2D.prototype.loadPixels=function(){var p=this._pixelsState,m=p._pixelDensity,g=this.width*m,y=this.height*m,v=this.drawingContext.getImageData(0,0,g,y);p._setProperty("imageData",v),p._setProperty("pixels",v.data)},i.default.Renderer2D.prototype.set=function(p,m,g){p=Math.floor(p),m=Math.floor(m);var y=this._pixelsState;if(g instanceof i.default.Image)this.drawingContext.save(),this.drawingContext.setTransform(1,0,0,1,0,0),this.drawingContext.scale(y._pixelDensity,y._pixelDensity),this.drawingContext.clearRect(p,m,g.width,g.height),this.drawingContext.drawImage(g.canvas,p,m),this.drawingContext.restore();else{var v=0,b=0,w=0,_=0,I=4*(m*y._pixelDensity*(this.width*y._pixelDensity)+p*y._pixelDensity);if(y.imageData||y.loadPixels.call(y),typeof g=="number")I<y.pixels.length&&(w=b=v=g,_=255);else if(g instanceof Array){if(g.length<4)throw new Error("pixel array must be of the form [R, G, B, A]");I<y.pixels.length&&(v=g[0],b=g[1],w=g[2],_=g[3])}else g instanceof i.default.Color&&I<y.pixels.length&&(v=g.levels[0],b=g.levels[1],w=g.levels[2],_=g.levels[3]);for(var C=0;C<y._pixelDensity;C++)for(var N=0;N<y._pixelDensity;N++)I=4*((m*y._pixelDensity+N)*this.width*y._pixelDensity+(p*y._pixelDensity+C)),y.pixels[I]=v,y.pixels[I+1]=b,y.pixels[I+2]=w,y.pixels[I+3]=_}},i.default.Renderer2D.prototype.updatePixels=function(p,m,g,y){var v=this._pixelsState,b=v._pixelDensity;p===void 0&&m===void 0&&g===void 0&&y===void 0&&(m=p=0,g=this.width,y=this.height),p*=b,m*=b,g*=b,y*=b,this.gifProperties&&(this.gifProperties.frames[this.gifProperties.displayIndex].image=v.imageData),this.drawingContext.putImageData(v.imageData,p,m,0,0,g,y)},i.default.Renderer2D.prototype._acuteArcToBezier=function(p,m){var g=m/2,y=Math.cos(g),v=Math.sin(g),b=1/Math.tan(g),w=p+g,_=Math.cos(w),I=Math.sin(w),C=(4-y)/3,N=v+(y-C)*b;return{ax:Math.cos(p).toFixed(7),ay:Math.sin(p).toFixed(7),bx:(C*_+N*I).toFixed(7),by:(C*I-N*_).toFixed(7),cx:(C*_-N*I).toFixed(7),cy:(C*I+N*_).toFixed(7),dx:Math.cos(p+m).toFixed(7),dy:Math.sin(p+m).toFixed(7)}},i.default.Renderer2D.prototype.arc=function(p,m,g,y,v,b,w){var _=this.drawingContext,I=g/2,C=y/2,N=0,O=[];for(p+=I,m+=C;1e-5<=b-v;)N=Math.min(b-v,l.HALF_PI),O.push(this._acuteArcToBezier(v,N)),v+=N;return this._doFill&&(_.beginPath(),O.forEach(function(D,M){M===0&&_.moveTo(p+D.ax*I,m+D.ay*C),_.bezierCurveTo(p+D.bx*I,m+D.by*C,p+D.cx*I,m+D.cy*C,p+D.dx*I,m+D.dy*C)}),w!==l.PIE&&w!=null||_.lineTo(p,m),_.closePath(),_.fill()),this._doStroke&&(_.beginPath(),O.forEach(function(D,M){M===0&&_.moveTo(p+D.ax*I,m+D.ay*C),_.bezierCurveTo(p+D.bx*I,m+D.by*C,p+D.cx*I,m+D.cy*C,p+D.dx*I,m+D.dy*C)}),w===l.PIE?(_.lineTo(p,m),_.closePath()):w===l.CHORD&&_.closePath(),_.stroke()),this},i.default.Renderer2D.prototype.ellipse=function(p){var m=this.drawingContext,g=this._doFill,y=this._doStroke,v=parseFloat(p[0]),b=parseFloat(p[1]),w=parseFloat(p[2]),_=parseFloat(p[3]);if(g&&!y){if(this._getFill()===c)return this}else if(!g&&y&&this._getStroke()===c)return this;var I=w/2*.5522847498,C=_/2*.5522847498,N=v+w,O=b+_,D=v+w/2,M=b+_/2;m.beginPath(),m.moveTo(v,M),m.bezierCurveTo(v,M-C,D-I,b,D,b),m.bezierCurveTo(D+I,b,N,M-C,N,M),m.bezierCurveTo(N,M+C,D+I,O,D,O),m.bezierCurveTo(D-I,O,v,M+C,v,M),g&&m.fill(),y&&m.stroke()},i.default.Renderer2D.prototype.line=function(p,m,g,y){var v=this.drawingContext;return this._doStroke&&(this._getStroke()===c||(v.beginPath(),v.moveTo(p,m),v.lineTo(g,y),v.stroke())),this},i.default.Renderer2D.prototype.point=function(p,m){var g=this.drawingContext;if(!this._doStroke)return this;if(this._getStroke()===c)return this;var y=this._getStroke(),v=this._getFill();this._setFill(y),g.beginPath(),g.arc(p,m,g.lineWidth/2,0,l.TWO_PI,!1),g.fill(),this._setFill(v)},i.default.Renderer2D.prototype.quad=function(p,m,g,y,v,b,w,_){var I=this.drawingContext,C=this._doFill,N=this._doStroke;if(C&&!N){if(this._getFill()===c)return this}else if(!C&&N&&this._getStroke()===c)return this;return I.beginPath(),I.moveTo(p,m),I.lineTo(g,y),I.lineTo(v,b),I.lineTo(w,_),I.closePath(),C&&I.fill(),N&&I.stroke(),this},i.default.Renderer2D.prototype.rect=function(p){var m=p[0],g=p[1],y=p[2],v=p[3],b=p[4],w=p[5],_=p[6],I=p[7],C=this.drawingContext,N=this._doFill,O=this._doStroke;if(N&&!O){if(this._getFill()===c)return this}else if(!N&&O&&this._getStroke()===c)return this;if(C.beginPath(),b===void 0)C.rect(m,g,y,v);else{w===void 0&&(w=b),_===void 0&&(_=w),I===void 0&&(I=_);var D=Math.abs(y),M=Math.abs(v),P=D/2,F=M/2;D<2*b&&(b=P),M<2*b&&(b=F),D<2*w&&(w=P),M<2*w&&(w=F),D<2*_&&(_=P),M<2*_&&(_=F),D<2*I&&(I=P),M<2*I&&(I=F),C.beginPath(),C.moveTo(m+b,g),C.arcTo(m+y,g,m+y,g+v,w),C.arcTo(m+y,g+v,m,g+v,_),C.arcTo(m,g+v,m,g,I),C.arcTo(m,g,m+y,g,b),C.closePath()}return this._doFill&&C.fill(),this._doStroke&&C.stroke(),this},i.default.Renderer2D.prototype.triangle=function(p){var m=this.drawingContext,g=this._doFill,y=this._doStroke,v=p[0],b=p[1],w=p[2],_=p[3],I=p[4],C=p[5];if(g&&!y){if(this._getFill()===c)return this}else if(!g&&y&&this._getStroke()===c)return this;m.beginPath(),m.moveTo(v,b),m.lineTo(w,_),m.lineTo(I,C),m.closePath(),g&&m.fill(),y&&m.stroke()},i.default.Renderer2D.prototype.endShape=function(p,m,g,y,v,b,w){if(m.length===0)return this;if(!this._doStroke&&!this._doFill)return this;var _,I,C,N=p===l.CLOSE;N&&!b&&m.push(m[0]);var O=m.length;if(!g||w!==l.POLYGON&&w!==null)if(!y||w!==l.POLYGON&&w!==null)if(!v||w!==l.POLYGON&&w!==null)if(w===l.POINTS)for(I=0;I<O;I++)_=m[I],this._doStroke&&this._pInst.stroke(_[6]),this._pInst.point(_[0],_[1]);else if(w===l.LINES)for(I=0;I+1<O;I+=2)_=m[I],this._doStroke&&this._pInst.stroke(m[I+1][6]),this._pInst.line(_[0],_[1],m[I+1][0],m[I+1][1]);else if(w===l.TRIANGLES)for(I=0;I+2<O;I+=3)_=m[I],this.drawingContext.beginPath(),this.drawingContext.moveTo(_[0],_[1]),this.drawingContext.lineTo(m[I+1][0],m[I+1][1]),this.drawingContext.lineTo(m[I+2][0],m[I+2][1]),this.drawingContext.closePath(),this._doFill&&(this._pInst.fill(m[I+2][5]),this.drawingContext.fill()),this._doStroke&&(this._pInst.stroke(m[I+2][6]),this.drawingContext.stroke());else if(w===l.TRIANGLE_STRIP)for(I=0;I+1<O;I++)_=m[I],this.drawingContext.beginPath(),this.drawingContext.moveTo(m[I+1][0],m[I+1][1]),this.drawingContext.lineTo(_[0],_[1]),this._doStroke&&this._pInst.stroke(m[I+1][6]),this._doFill&&this._pInst.fill(m[I+1][5]),I+2<O&&(this.drawingContext.lineTo(m[I+2][0],m[I+2][1]),this._doStroke&&this._pInst.stroke(m[I+2][6]),this._doFill&&this._pInst.fill(m[I+2][5])),this._doFillStrokeClose(N);else if(w===l.TRIANGLE_FAN){if(2<O){for(this.drawingContext.beginPath(),I=2;I<O;I++)_=m[I],this.drawingContext.moveTo(m[0][0],m[0][1]),this.drawingContext.lineTo(m[I-1][0],m[I-1][1]),this.drawingContext.lineTo(_[0],_[1]),this.drawingContext.lineTo(m[0][0],m[0][1]),I<O-1&&(this._doFill&&_[5]!==m[I+1][5]||this._doStroke&&_[6]!==m[I+1][6])&&(this._doFill&&(this._pInst.fill(_[5]),this.drawingContext.fill(),this._pInst.fill(m[I+1][5])),this._doStroke&&(this._pInst.stroke(_[6]),this.drawingContext.stroke(),this._pInst.stroke(m[I+1][6])),this.drawingContext.closePath(),this.drawingContext.beginPath());this._doFillStrokeClose(N)}}else if(w===l.QUADS)for(I=0;I+3<O;I+=4){for(_=m[I],this.drawingContext.beginPath(),this.drawingContext.moveTo(_[0],_[1]),C=1;C<4;C++)this.drawingContext.lineTo(m[I+C][0],m[I+C][1]);this.drawingContext.lineTo(_[0],_[1]),this._doFill&&this._pInst.fill(m[I+3][5]),this._doStroke&&this._pInst.stroke(m[I+3][6]),this._doFillStrokeClose(N)}else if(w===l.QUAD_STRIP){if(3<O)for(I=0;I+1<O;I+=2)_=m[I],this.drawingContext.beginPath(),I+3<O?(this.drawingContext.moveTo(m[I+2][0],m[I+2][1]),this.drawingContext.lineTo(_[0],_[1]),this.drawingContext.lineTo(m[I+1][0],m[I+1][1]),this.drawingContext.lineTo(m[I+3][0],m[I+3][1]),this._doFill&&this._pInst.fill(m[I+3][5]),this._doStroke&&this._pInst.stroke(m[I+3][6])):(this.drawingContext.moveTo(_[0],_[1]),this.drawingContext.lineTo(m[I+1][0],m[I+1][1])),this._doFillStrokeClose(N)}else{for(this.drawingContext.beginPath(),this.drawingContext.moveTo(m[0][0],m[0][1]),I=1;I<O;I++)(_=m[I]).isVert&&(_.moveTo?this.drawingContext.moveTo(_[0],_[1]):this.drawingContext.lineTo(_[0],_[1]));this._doFillStrokeClose(N)}else{for(this.drawingContext.beginPath(),I=0;I<O;I++)m[I].isVert?m[I].moveTo?this.drawingContext.moveTo(m[I][0],m[I][1]):this.drawingContext.lineTo(m[I][0],m[I][1]):this.drawingContext.quadraticCurveTo(m[I][0],m[I][1],m[I][2],m[I][3]);this._doFillStrokeClose(N)}else{for(this.drawingContext.beginPath(),I=0;I<O;I++)m[I].isVert?m[I].moveTo?this.drawingContext.moveTo(m[I][0],m[I][1]):this.drawingContext.lineTo(m[I][0],m[I][1]):this.drawingContext.bezierCurveTo(m[I][0],m[I][1],m[I][2],m[I][3],m[I][4],m[I][5]);this._doFillStrokeClose(N)}else if(3<O){var D=[],M=1-this._curveTightness;for(this.drawingContext.beginPath(),this.drawingContext.moveTo(m[1][0],m[1][1]),I=1;I+2<O;I++)_=m[I],D[0]=[_[0],_[1]],D[1]=[_[0]+(M*m[I+1][0]-M*m[I-1][0])/6,_[1]+(M*m[I+1][1]-M*m[I-1][1])/6],D[2]=[m[I+1][0]+(M*m[I][0]-M*m[I+2][0])/6,m[I+1][1]+(M*m[I][1]-M*m[I+2][1])/6],D[3]=[m[I+1][0],m[I+1][1]],this.drawingContext.bezierCurveTo(D[1][0],D[1][1],D[2][0],D[2][1],D[3][0],D[3][1]);N&&this.drawingContext.lineTo(m[I+1][0],m[I+1][1]),this._doFillStrokeClose(N)}return b=v=y=g=!1,N&&m.pop(),this},i.default.Renderer2D.prototype.strokeCap=function(p){return p!==l.ROUND&&p!==l.SQUARE&&p!==l.PROJECT||(this.drawingContext.lineCap=p),this},i.default.Renderer2D.prototype.strokeJoin=function(p){return p!==l.ROUND&&p!==l.BEVEL&&p!==l.MITER||(this.drawingContext.lineJoin=p),this},i.default.Renderer2D.prototype.strokeWeight=function(p){return this.drawingContext.lineWidth=p===void 0||p===0?1e-4:p,this},i.default.Renderer2D.prototype._getFill=function(){return this._cachedFillStyle||(this._cachedFillStyle=this.drawingContext.fillStyle),this._cachedFillStyle},i.default.Renderer2D.prototype._setFill=function(p){p!==this._cachedFillStyle&&(this.drawingContext.fillStyle=p,this._cachedFillStyle=p)},i.default.Renderer2D.prototype._getStroke=function(){return this._cachedStrokeStyle||(this._cachedStrokeStyle=this.drawingContext.strokeStyle),this._cachedStrokeStyle},i.default.Renderer2D.prototype._setStroke=function(p){p!==this._cachedStrokeStyle&&(this.drawingContext.strokeStyle=p,this._cachedStrokeStyle=p)},i.default.Renderer2D.prototype.bezier=function(p,m,g,y,v,b,w,_){return this._pInst.beginShape(),this._pInst.vertex(p,m),this._pInst.bezierVertex(g,y,v,b,w,_),this._pInst.endShape(),this},i.default.Renderer2D.prototype.curve=function(p,m,g,y,v,b,w,_){return this._pInst.beginShape(),this._pInst.curveVertex(p,m),this._pInst.curveVertex(g,y),this._pInst.curveVertex(v,b),this._pInst.curveVertex(w,_),this._pInst.endShape(),this},i.default.Renderer2D.prototype._doFillStrokeClose=function(p){p&&this.drawingContext.closePath(),this._doFill&&this.drawingContext.fill(),this._doStroke&&this.drawingContext.stroke()},i.default.Renderer2D.prototype.applyMatrix=function(p,m,g,y,v,b){this.drawingContext.transform(p,m,g,y,v,b)},i.default.Renderer2D.prototype.resetMatrix=function(){return this.drawingContext.setTransform(1,0,0,1,0,0),this.drawingContext.scale(this._pInst._pixelDensity,this._pInst._pixelDensity),this},i.default.Renderer2D.prototype.rotate=function(p){this.drawingContext.rotate(p)},i.default.Renderer2D.prototype.scale=function(p,m){return this.drawingContext.scale(p,m),this},i.default.Renderer2D.prototype.translate=function(p,m){return p instanceof i.default.Vector&&(m=p.y,p=p.x),this.drawingContext.translate(p,m),this},i.default.Renderer2D.prototype.text=function(p,m,g,y,v){var b;y!==void 0&&this.drawingContext.textBaseline===l.BASELINE&&(b=!0,this.drawingContext.textBaseline=l.TOP);var w=i.default.Renderer.prototype.text.apply(this,arguments);return b&&(this.drawingContext.textBaseline=l.BASELINE),w},i.default.Renderer2D.prototype._renderText=function(p,m,g,y,v){if(!(v<=y))return p.push(),this._isOpenType()?this._textFont._renderPath(m,g,y,{renderer:this}):(this._doStroke&&this._strokeSet&&this.drawingContext.strokeText(m,g,y),this._doFill&&(this._fillSet||this._setFill(l._DEFAULT_TEXT_FILL),this.drawingContext.fillText(m,g,y))),p.pop(),p},i.default.Renderer2D.prototype.textWidth=function(p){return this._isOpenType()?this._textFont._textWidth(p,this._textSize):this.drawingContext.measureText(p).width},i.default.Renderer2D.prototype._applyTextProperties=function(){var p,m=this._pInst;return this._setProperty("_textAscent",null),this._setProperty("_textDescent",null),p=this._textFont,this._isOpenType()&&(p=this._textFont.font.familyName,this._setProperty("_textStyle",this._textFont.font.styleName)),this.drawingContext.font="".concat(this._textStyle||"normal"," ").concat(this._textSize||12,"px ").concat(p||"sans-serif"),this.drawingContext.textAlign=this._textAlign,this._textBaseline===l.CENTER?this.drawingContext.textBaseline=l._CTX_MIDDLE:this.drawingContext.textBaseline=this._textBaseline,m},i.default.Renderer2D.prototype.push=function(){return this.drawingContext.save(),i.default.Renderer.prototype.push.apply(this)},i.default.Renderer2D.prototype.pop=function(p){this.drawingContext.restore(),this._cachedFillStyle=this.drawingContext.fillStyle,this._cachedStrokeStyle=this.drawingContext.strokeStyle,i.default.Renderer.prototype.pop.call(this,p)};var f=i.default.Renderer2D;o.default=f},{"../image/filters":285,"./constants":253,"./main":264,"./p5.Renderer":267,"core-js/modules/es.array.concat":149,"core-js/modules/es.array.fill":151,"core-js/modules/es.array.for-each":154,"core-js/modules/es.array.slice":162,"core-js/modules/es.function.name":166,"core-js/modules/es.number.to-fixed":172,"core-js/modules/es.object.to-string":177,"core-js/modules/es.regexp.to-string":182}],269:[function(n,s,o){n("core-js/modules/es.symbol"),n("core-js/modules/es.symbol.description"),n("core-js/modules/es.symbol.iterator"),n("core-js/modules/es.array.iterator"),n("core-js/modules/es.object.assign"),n("core-js/modules/es.object.to-string"),n("core-js/modules/es.promise"),n("core-js/modules/es.string.iterator"),n("core-js/modules/web.dom-collections.iterator");var a,i=(a=n("./main"))&&a.__esModule?a:{default:a};i.default.prototype._promisePreloads=[];var l=!(i.default.prototype.registerPromisePreload=function(h){i.default.prototype._promisePreloads.push(h)});i.default.prototype._setupPromisePreloads=function(){var h=!0,d=!1,c=void 0;try{for(var f,p=this._promisePreloads[Symbol.iterator]();!(h=(f=p.next()).done);h=!0){var m=f.value,g=this,y=m.method,v=m.addCallbacks,b=m.legacyPreloadSetup,w=m.target||this,_=w[y].bind(w);if(w===i.default.prototype){if(l)continue;g=null,_=w[y]}w[y]=this._wrapPromisePreload(g,_,v),b&&(w[b.method]=this._legacyPreloadGenerator(g,b,w[y]))}}catch(I){d=!0,c=I}finally{try{h||p.return==null||p.return()}finally{if(d)throw c}}l=!0},i.default.prototype._wrapPromisePreload=function(h,d,c){var f=function(){var p=this;this._incrementPreload();for(var m=null,g=null,y=arguments.length,v=new Array(y),b=0;b<y;b++)v[b]=arguments[b];if(c)for(var w=v.length-1;0<=w&&!g&&typeof v[w]=="function";w--)g=m,m=v.pop();var _=Promise.resolve(d.apply(this,v));return m&&_.then(m),g&&_.catch(g),_.then(function(){return p._decrementPreload()}),_};return h&&(f=f.bind(h)),f};function u(){return{}}i.default.prototype._legacyPreloadGenerator=function(h,d,c){var f=d.createBaseObject||u,p=function(){var m=this;this._incrementPreload();var g=f.apply(this,arguments);return c.apply(this,arguments).then(function(y){Object.assign(g,y),m._decrementPreload()}),g};return h&&(p=p.bind(h)),p}},{"./main":264,"core-js/modules/es.array.iterator":158,"core-js/modules/es.object.assign":173,"core-js/modules/es.object.to-string":177,"core-js/modules/es.promise":178,"core-js/modules/es.string.iterator":186,"core-js/modules/es.symbol":196,"core-js/modules/es.symbol.description":194,"core-js/modules/es.symbol.iterator":195,"core-js/modules/web.dom-collections.iterator":229}],270:[function(n,s,o){n("core-js/modules/es.symbol"),n("core-js/modules/es.symbol.description"),n("core-js/modules/es.symbol.iterator"),n("core-js/modules/es.array.filter"),n("core-js/modules/es.array.iterator"),n("core-js/modules/es.object.to-string"),n("core-js/modules/es.string.iterator"),n("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var a,i=(a=n("./main"))&&a.__esModule?a:{default:a},l=function(f){if(f&&f.__esModule)return f;if(f===null||h(f)!=="object"&&typeof f!="function")return{default:f};var p=u();if(p&&p.has(f))return p.get(f);var m={},g=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var y in f)if(Object.prototype.hasOwnProperty.call(f,y)){var v=g?Object.getOwnPropertyDescriptor(f,y):null;v&&(v.get||v.set)?Object.defineProperty(m,y,v):m[y]=f[y]}return m.default=f,p&&p.set(f,m),m}(n("./constants"));function u(){if(typeof WeakMap!="function")return null;var f=new WeakMap;return u=function(){return f},f}function h(f){return(h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(p){return typeof p}:function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":typeof p})(f)}n("./p5.Graphics"),n("./p5.Renderer2D"),n("../webgl/p5.RendererGL");var d="defaultCanvas0";i.default.prototype.createCanvas=function(f,p,m){i.default._validateParameters("createCanvas",arguments);var g,y=m||l.P2D;if(y===l.WEBGL){if(g=document.getElementById(d)){g.parentNode.removeChild(g);var v=this._renderer;this._elements=this._elements.filter(function(_){return _!==v})}(g=document.createElement("canvas")).id=d,g.classList.add("p5Canvas")}else if(this._defaultGraphicsCreated)g=this.canvas;else{g=document.createElement("canvas");for(var b=0;document.getElementById("defaultCanvas".concat(b));)b++;d="defaultCanvas".concat(b),g.id=d,g.classList.add("p5Canvas")}if(this._setupDone||(g.dataset.hidden=!0,g.style.visibility="hidden"),this._userNode)this._userNode.appendChild(g);else{if(document.getElementsByTagName("main").length===0){var w=document.createElement("main");document.body.appendChild(w)}document.getElementsByTagName("main")[0].appendChild(g)}return y===l.WEBGL?(this._setProperty("_renderer",new i.default.RendererGL(g,this,!0)),this._elements.push(this._renderer)):this._defaultGraphicsCreated||(this._setProperty("_renderer",new i.default.Renderer2D(g,this,!0)),this._defaultGraphicsCreated=!0,this._elements.push(this._renderer)),this._renderer.resize(f,p),this._renderer._applyDefaults(),this._renderer},i.default.prototype.resizeCanvas=function(f,p,m){if(i.default._validateParameters("resizeCanvas",arguments),this._renderer){var g={};for(var y in this.drawingContext){var v=this.drawingContext[y];h(v)!=="object"&&typeof v!="function"&&(g[y]=v)}for(var b in this._renderer.resize(f,p),this.width=f,this.height=p,g)try{this.drawingContext[b]=g[b]}catch{}m||this.redraw()}this._addAccsOutput()&&this._updateAccsOutput()},i.default.prototype.noCanvas=function(){this.canvas&&this.canvas.parentNode.removeChild(this.canvas)},i.default.prototype.createGraphics=function(f,p,m){return i.default._validateParameters("createGraphics",arguments),new i.default.Graphics(f,p,m,this)},i.default.prototype.blendMode=function(f){i.default._validateParameters("blendMode",arguments),f===l.NORMAL&&(console.warn("NORMAL has been deprecated for use in blendMode. defaulting to BLEND instead."),f=l.BLEND),this._renderer.blendMode(f)};var c=i.default;o.default=c},{"../webgl/p5.RendererGL":318,"./constants":253,"./main":264,"./p5.Graphics":266,"./p5.Renderer2D":268,"core-js/modules/es.array.filter":152,"core-js/modules/es.array.iterator":158,"core-js/modules/es.object.to-string":177,"core-js/modules/es.string.iterator":186,"core-js/modules/es.symbol":196,"core-js/modules/es.symbol.description":194,"core-js/modules/es.symbol.iterator":195,"core-js/modules/web.dom-collections.iterator":229}],271:[function(n,s,o){function a(f){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(p){return typeof p}:function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":typeof p})(f)}n("core-js/modules/es.array.slice"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var i=d(n("../main")),l=function(f){if(f&&f.__esModule)return f;if(f===null||a(f)!=="object"&&typeof f!="function")return{default:f};var p=h();if(p&&p.has(f))return p.get(f);var m={},g=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var y in f)if(Object.prototype.hasOwnProperty.call(f,y)){var v=g?Object.getOwnPropertyDescriptor(f,y):null;v&&(v.get||v.set)?Object.defineProperty(m,y,v):m[y]=f[y]}return m.default=f,p&&p.set(f,m),m}(n("../constants")),u=d(n("../helpers"));function h(){if(typeof WeakMap!="function")return null;var f=new WeakMap;return h=function(){return f},f}function d(f){return f&&f.__esModule?f:{default:f}}n("../friendly_errors/fes_core"),n("../friendly_errors/file_errors"),n("../friendly_errors/validate_params"),i.default.prototype._normalizeArcAngles=function(f,p,m,g,y){var v;return f-=l.TWO_PI*Math.floor(f/l.TWO_PI),p-=l.TWO_PI*Math.floor(p/l.TWO_PI),v=Math.min(Math.abs(f-p),l.TWO_PI-Math.abs(f-p)),y&&(f=f<=l.HALF_PI?Math.atan(m/g*Math.tan(f)):f>l.HALF_PI&&f<=3*l.HALF_PI?Math.atan(m/g*Math.tan(f))+l.PI:Math.atan(m/g*Math.tan(f))+l.TWO_PI,p=p<=l.HALF_PI?Math.atan(m/g*Math.tan(p)):p>l.HALF_PI&&p<=3*l.HALF_PI?Math.atan(m/g*Math.tan(p))+l.PI:Math.atan(m/g*Math.tan(p))+l.TWO_PI),p<f&&(p+=l.TWO_PI),{start:f,stop:p,correspondToSamePoint:v<1e-5}},i.default.prototype.arc=function(f,p,m,g,y,v,b,w){if(i.default._validateParameters("arc",arguments),!this._renderer._doStroke&&!this._renderer._doFill)return this;if(y===v)return this;y=this._toRadians(y),v=this._toRadians(v),m=Math.abs(m),g=Math.abs(g);var _=u.default.modeAdjust(f,p,m,g,this._renderer._ellipseMode),I=this._normalizeArcAngles(y,v,_.w,_.h,!0);return I.correspondToSamePoint?this._renderer.ellipse([_.x,_.y,_.w,_.h,w]):(this._renderer.arc(_.x,_.y,_.w,_.h,I.start,I.stop,b,w),(this._accessibleOutputs.grid||this._accessibleOutputs.text)&&this._accsOutput("arc",[_.x,_.y,_.w,_.h,I.start,I.stop,b])),this},i.default.prototype.ellipse=function(f,p,m,g,y){return i.default._validateParameters("ellipse",arguments),this._renderEllipse.apply(this,arguments)},i.default.prototype.circle=function(){i.default._validateParameters("circle",arguments);var f=Array.prototype.slice.call(arguments,0,2);return f.push(arguments[2]),f.push(arguments[2]),this._renderEllipse.apply(this,f)},i.default.prototype._renderEllipse=function(f,p,m,g,y){if(!this._renderer._doStroke&&!this._renderer._doFill)return this;m<0&&(m=Math.abs(m)),g===void 0?g=m:g<0&&(g=Math.abs(g));var v=u.default.modeAdjust(f,p,m,g,this._renderer._ellipseMode);return this._renderer.ellipse([v.x,v.y,v.w,v.h,y]),(this._accessibleOutputs.grid||this._accessibleOutputs.text)&&this._accsOutput("ellipse",[v.x,v.y,v.w,v.h]),this},i.default.prototype.line=function(){for(var f=arguments.length,p=new Array(f),m=0;m<f;m++)p[m]=arguments[m];var g;return i.default._validateParameters("line",p),this._renderer._doStroke&&(g=this._renderer).line.apply(g,p),(this._accessibleOutputs.grid||this._accessibleOutputs.text)&&this._accsOutput("line",p),this},i.default.prototype.point=function(){for(var f=arguments.length,p=new Array(f),m=0;m<f;m++)p[m]=arguments[m];var g;return i.default._validateParameters("point",p),this._renderer._doStroke&&(p.length===1&&p[0]instanceof i.default.Vector?this._renderer.point.call(this._renderer,p[0].x,p[0].y,p[0].z):((g=this._renderer).point.apply(g,p),(this._accessibleOutputs.grid||this._accessibleOutputs.text)&&this._accsOutput("point",p))),this},i.default.prototype.quad=function(){for(var f=arguments.length,p=new Array(f),m=0;m<f;m++)p[m]=arguments[m];var g;return i.default._validateParameters("quad",p),(this._renderer._doStroke||this._renderer._doFill)&&(this._renderer.isP3D&&p.length<=12?this._renderer.quad.call(this._renderer,p[0],p[1],0,p[2],p[3],0,p[4],p[5],0,p[6],p[7],0,p[8],p[9]):((g=this._renderer).quad.apply(g,p),(this._accessibleOutputs.grid||this._accessibleOutputs.text)&&this._accsOutput("quadrilateral",p))),this},i.default.prototype.rect=function(){return i.default._validateParameters("rect",arguments),this._renderRect.apply(this,arguments)},i.default.prototype.square=function(f,p,m,g,y,v,b){return i.default._validateParameters("square",arguments),this._renderRect.call(this,f,p,m,m,g,y,v,b)},i.default.prototype._renderRect=function(){if(this._renderer._doStroke||this._renderer._doFill){arguments.length===3&&(arguments[3]=arguments[2]);for(var f=u.default.modeAdjust(arguments[0],arguments[1],arguments[2],arguments[3],this._renderer._rectMode),p=[f.x,f.y,f.w,f.h],m=4;m<arguments.length;m++)p[m]=arguments[m];this._renderer.rect(p),(this._accessibleOutputs.grid||this._accessibleOutputs.text)&&this._accsOutput("rectangle",[f.x,f.y,f.w,f.h])}return this},i.default.prototype.triangle=function(){for(var f=arguments.length,p=new Array(f),m=0;m<f;m++)p[m]=arguments[m];return i.default._validateParameters("triangle",p),(this._renderer._doStroke||this._renderer._doFill)&&this._renderer.triangle(p),(this._accessibleOutputs.grid||this._accessibleOutputs.text)&&this._accsOutput("triangle",p),this};var c=i.default;o.default=c},{"../constants":253,"../friendly_errors/fes_core":255,"../friendly_errors/file_errors":256,"../friendly_errors/validate_params":259,"../helpers":260,"../main":264,"core-js/modules/es.array.slice":162}],272:[function(n,s,o){function a(c){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(f){return typeof f}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f})(c)}Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var i,l=(i=n("../main"))&&i.__esModule?i:{default:i},u=function(c){if(c&&c.__esModule)return c;if(c===null||a(c)!=="object"&&typeof c!="function")return{default:c};var f=h();if(f&&f.has(c))return f.get(c);var p={},m=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var g in c)if(Object.prototype.hasOwnProperty.call(c,g)){var y=m?Object.getOwnPropertyDescriptor(c,g):null;y&&(y.get||y.set)?Object.defineProperty(p,g,y):p[g]=c[g]}return p.default=c,f&&f.set(c,p),p}(n("../constants"));function h(){if(typeof WeakMap!="function")return null;var c=new WeakMap;return h=function(){return c},c}l.default.prototype.ellipseMode=function(c){return l.default._validateParameters("ellipseMode",arguments),c!==u.CORNER&&c!==u.CORNERS&&c!==u.RADIUS&&c!==u.CENTER||(this._renderer._ellipseMode=c),this},l.default.prototype.noSmooth=function(){return this.setAttributes("antialias",!1),this._renderer.isP3D||"imageSmoothingEnabled"in this.drawingContext&&(this.drawingContext.imageSmoothingEnabled=!1),this},l.default.prototype.rectMode=function(c){return l.default._validateParameters("rectMode",arguments),c!==u.CORNER&&c!==u.CORNERS&&c!==u.RADIUS&&c!==u.CENTER||(this._renderer._rectMode=c),this},l.default.prototype.smooth=function(){return this.setAttributes("antialias",!0),this._renderer.isP3D||"imageSmoothingEnabled"in this.drawingContext&&(this.drawingContext.imageSmoothingEnabled=!0),this},l.default.prototype.strokeCap=function(c){return l.default._validateParameters("strokeCap",arguments),c!==u.ROUND&&c!==u.SQUARE&&c!==u.PROJECT||this._renderer.strokeCap(c),this},l.default.prototype.strokeJoin=function(c){return l.default._validateParameters("strokeJoin",arguments),c!==u.ROUND&&c!==u.BEVEL&&c!==u.MITER||this._renderer.strokeJoin(c),this},l.default.prototype.strokeWeight=function(c){return l.default._validateParameters("strokeWeight",arguments),this._renderer.strokeWeight(c),this};var d=l.default;o.default=d},{"../constants":253,"../main":264}],273:[function(n,s,o){Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var a,i=(a=n("../main"))&&a.__esModule?a:{default:a};n("../friendly_errors/fes_core"),n("../friendly_errors/file_errors"),n("../friendly_errors/validate_params"),i.default.prototype.bezier=function(){for(var u,h=arguments.length,d=new Array(h),c=0;c<h;c++)d[c]=arguments[c];return i.default._validateParameters("bezier",d),(this._renderer._doStroke||this._renderer._doFill)&&(u=this._renderer).bezier.apply(u,d),this},i.default.prototype.bezierDetail=function(u){return i.default._validateParameters("bezierDetail",arguments),this._bezierDetail=u,this},i.default.prototype.bezierPoint=function(u,h,d,c,f){i.default._validateParameters("bezierPoint",arguments);var p=1-f;return Math.pow(p,3)*u+3*Math.pow(p,2)*f*h+3*p*Math.pow(f,2)*d+Math.pow(f,3)*c},i.default.prototype.bezierTangent=function(u,h,d,c,f){i.default._validateParameters("bezierTangent",arguments);var p=1-f;return 3*c*Math.pow(f,2)-3*d*Math.pow(f,2)+6*d*p*f-6*h*p*f+3*h*Math.pow(p,2)-3*u*Math.pow(p,2)},i.default.prototype.curve=function(){for(var u=arguments.length,h=new Array(u),d=0;d<u;d++)h[d]=arguments[d];var c;return i.default._validateParameters("curve",h),this._renderer._doStroke&&(c=this._renderer).curve.apply(c,h),this},i.default.prototype.curveDetail=function(u){return i.default._validateParameters("curveDetail",arguments),this._curveDetail=u<3?3:u,this},i.default.prototype.curveTightness=function(u){return i.default._validateParameters("curveTightness",arguments),this._renderer._curveTightness=u,this},i.default.prototype.curvePoint=function(u,h,d,c,f){i.default._validateParameters("curvePoint",arguments);var p=f*f*f,m=f*f;return u*(-.5*p+m-.5*f)+h*(1.5*p-2.5*m+1)+d*(-1.5*p+2*m+.5*f)+c*(.5*p-.5*m)},i.default.prototype.curveTangent=function(u,h,d,c,f){i.default._validateParameters("curveTangent",arguments);var p=f*f;return u*(-3*p/2+2*f-.5)+h*(9*p/2-5*f)+d*(-9*p/2+4*f+.5)+c*(3*p/2-f)};var l=i.default;o.default=l},{"../friendly_errors/fes_core":255,"../friendly_errors/file_errors":256,"../friendly_errors/validate_params":259,"../main":264}],274:[function(n,s,o){function a(w){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(_){return typeof _}:function(_){return _&&typeof Symbol=="function"&&_.constructor===Symbol&&_!==Symbol.prototype?"symbol":typeof _})(w)}n("core-js/modules/es.array.slice"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var i,l=(i=n("../main"))&&i.__esModule?i:{default:i},u=function(w){if(w&&w.__esModule)return w;if(w===null||a(w)!=="object"&&typeof w!="function")return{default:w};var _=h();if(_&&_.has(w))return _.get(w);var I={},C=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var N in w)if(Object.prototype.hasOwnProperty.call(w,N)){var O=C?Object.getOwnPropertyDescriptor(w,N):null;O&&(O.get||O.set)?Object.defineProperty(I,N,O):I[N]=w[N]}return I.default=w,_&&_.set(w,I),I}(n("../constants"));function h(){if(typeof WeakMap!="function")return null;var w=new WeakMap;return h=function(){return w},w}var d=null,c=[],f=[],p=!1,m=!1,g=!1,y=!1,v=!0;l.default.prototype.beginContour=function(){return f=[],y=!0,this},l.default.prototype.beginShape=function(w){var _;return l.default._validateParameters("beginShape",arguments),this._renderer.isP3D?(_=this._renderer).beginShape.apply(_,arguments):(d=w===u.POINTS||w===u.LINES||w===u.TRIANGLES||w===u.TRIANGLE_FAN||w===u.TRIANGLE_STRIP||w===u.QUADS||w===u.QUAD_STRIP?w:null,c=[],f=[]),this},l.default.prototype.bezierVertex=function(){for(var w=arguments.length,_=new Array(w),I=0;I<w;I++)_[I]=arguments[I];var C;if(l.default._validateParameters("bezierVertex",_),this._renderer.isP3D)(C=this._renderer).bezierVertex.apply(C,_);else if(c.length===0)l.default._friendlyError("vertex() must be used once before calling bezierVertex()","bezierVertex");else{p=!0;for(var N=[],O=0;O<_.length;O++)N[O]=_[O];N.isVert=!1,y?f.push(N):c.push(N)}return this},l.default.prototype.curveVertex=function(){for(var w=arguments.length,_=new Array(w),I=0;I<w;I++)_[I]=arguments[I];var C;return l.default._validateParameters("curveVertex",_),this._renderer.isP3D?(C=this._renderer).curveVertex.apply(C,_):(m=!0,this.vertex(_[0],_[1])),this},l.default.prototype.endContour=function(){var w=f[0].slice();w.isVert=f[0].isVert,w.moveTo=!1,f.push(w),v&&(c.push(c[0]),v=!1);for(var _=0;_<f.length;_++)c.push(f[_]);return this},l.default.prototype.endShape=function(w){if(l.default._validateParameters("endShape",arguments),this._renderer.isP3D)this._renderer.endShape(w,m,p,g,y,d);else{if(c.length===0)return this;if(!this._renderer._doStroke&&!this._renderer._doFill)return this;var _=w===u.CLOSE;_&&!y&&c.push(c[0]),this._renderer.endShape(w,c,m,p,g,y,d),v=!(y=g=p=m=!1),_&&c.pop()}return this},l.default.prototype.quadraticVertex=function(){for(var w=arguments.length,_=new Array(w),I=0;I<w;I++)_[I]=arguments[I];if(l.default._validateParameters("quadraticVertex",_),this._renderer.isP3D){var C;(C=this._renderer).quadraticVertex.apply(C,_)}else{if(this._contourInited){var N={};return N.x=_[0],N.y=_[1],N.x3=_[2],N.y3=_[3],N.type=u.QUADRATIC,this._contourVertices.push(N),this}if(0<c.length){g=!0;for(var O=[],D=0;D<_.length;D++)O[D]=_[D];O.isVert=!1,y?f.push(O):c.push(O)}else l.default._friendlyError("vertex() must be used once before calling quadraticVertex()","quadraticVertex")}return this},l.default.prototype.vertex=function(w,_,I,C,N){if(this._renderer.isP3D){var O;(O=this._renderer).vertex.apply(O,arguments)}else{var D=[];D.isVert=!0,D[0]=w,D[1]=_,D[2]=0,D[3]=0,D[4]=0,D[5]=this._renderer._getFill(),D[6]=this._renderer._getStroke(),I&&(D.moveTo=I),y?(f.length===0&&(D.moveTo=!0),f.push(D)):c.push(D)}return this},l.default.prototype.normal=function(w,_,I){var C;return this._assert3d("normal"),l.default._validateParameters("normal",arguments),(C=this._renderer).normal.apply(C,arguments),this};var b=l.default;o.default=b},{"../constants":253,"../main":264,"core-js/modules/es.array.slice":162}],275:[function(n,s,o){function a(i){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(l){return typeof l}:function(l){return l&&typeof Symbol=="function"&&l.constructor===Symbol&&l!==Symbol.prototype?"symbol":typeof l})(i)}n("core-js/modules/es.symbol"),n("core-js/modules/es.symbol.description"),n("core-js/modules/es.symbol.iterator"),n("core-js/modules/es.array.filter"),n("core-js/modules/es.array.iterator"),n("core-js/modules/es.array.slice"),n("core-js/modules/es.object.assign"),n("core-js/modules/es.object.keys"),n("core-js/modules/es.object.to-string"),n("core-js/modules/es.string.iterator"),n("core-js/modules/es.typed-array.uint8-clamped-array"),n("core-js/modules/es.typed-array.copy-within"),n("core-js/modules/es.typed-array.every"),n("core-js/modules/es.typed-array.fill"),n("core-js/modules/es.typed-array.filter"),n("core-js/modules/es.typed-array.find"),n("core-js/modules/es.typed-array.find-index"),n("core-js/modules/es.typed-array.for-each"),n("core-js/modules/es.typed-array.includes"),n("core-js/modules/es.typed-array.index-of"),n("core-js/modules/es.typed-array.iterator"),n("core-js/modules/es.typed-array.join"),n("core-js/modules/es.typed-array.last-index-of"),n("core-js/modules/es.typed-array.map"),n("core-js/modules/es.typed-array.reduce"),n("core-js/modules/es.typed-array.reduce-right"),n("core-js/modules/es.typed-array.reverse"),n("core-js/modules/es.typed-array.set"),n("core-js/modules/es.typed-array.slice"),n("core-js/modules/es.typed-array.some"),n("core-js/modules/es.typed-array.sort"),n("core-js/modules/es.typed-array.subarray"),n("core-js/modules/es.typed-array.to-locale-string"),n("core-js/modules/es.typed-array.to-string"),n("core-js/modules/web.dom-collections.iterator"),window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(i,l){window.setTimeout(i,1e3/60)},typeof Uint8ClampedArray=="undefined"||Uint8ClampedArray.prototype.slice||Object.defineProperty(Uint8ClampedArray.prototype,"slice",{value:Array.prototype.slice,writable:!0,configurable:!0,enumerable:!1}),function(){if(!Object.assign){var i=Object.keys,l=Object.defineProperty,u=typeof Symbol=="function"&&a(Symbol())==="symbol",h=Object.prototype.propertyIsEnumerable,d=function(c){return function(f){return h.call(c,f)}};l(Object,"assign",{value:function(c,f){if(c==null)throw new TypeError("target must be an object");var p,m,g,y,v=Object(c);for(p=1;p<arguments.length;++p)for(m=Object(arguments[p]),y=i(m),u&&Object.getOwnPropertySymbols&&y.push.apply(y,Object.getOwnPropertySymbols(m).filter(d(m))),g=0;g<y.length;++g)v[y[g]]=m[y[g]];return v},configurable:!0,enumerable:!1,writable:!0})}}()},{"core-js/modules/es.array.filter":152,"core-js/modules/es.array.iterator":158,"core-js/modules/es.array.slice":162,"core-js/modules/es.object.assign":173,"core-js/modules/es.object.keys":176,"core-js/modules/es.object.to-string":177,"core-js/modules/es.string.iterator":186,"core-js/modules/es.symbol":196,"core-js/modules/es.symbol.description":194,"core-js/modules/es.symbol.iterator":195,"core-js/modules/es.typed-array.copy-within":197,"core-js/modules/es.typed-array.every":198,"core-js/modules/es.typed-array.fill":199,"core-js/modules/es.typed-array.filter":200,"core-js/modules/es.typed-array.find":202,"core-js/modules/es.typed-array.find-index":201,"core-js/modules/es.typed-array.for-each":205,"core-js/modules/es.typed-array.includes":206,"core-js/modules/es.typed-array.index-of":207,"core-js/modules/es.typed-array.iterator":210,"core-js/modules/es.typed-array.join":211,"core-js/modules/es.typed-array.last-index-of":212,"core-js/modules/es.typed-array.map":213,"core-js/modules/es.typed-array.reduce":215,"core-js/modules/es.typed-array.reduce-right":214,"core-js/modules/es.typed-array.reverse":216,"core-js/modules/es.typed-array.set":217,"core-js/modules/es.typed-array.slice":218,"core-js/modules/es.typed-array.some":219,"core-js/modules/es.typed-array.sort":220,"core-js/modules/es.typed-array.subarray":221,"core-js/modules/es.typed-array.to-locale-string":222,"core-js/modules/es.typed-array.to-string":223,"core-js/modules/es.typed-array.uint8-clamped-array":227,"core-js/modules/web.dom-collections.iterator":229}],276:[function(n,s,o){n("core-js/modules/es.array.for-each"),n("core-js/modules/es.object.assign"),n("core-js/modules/web.dom-collections.for-each"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var a,i=(a=n("./main"))&&a.__esModule?a:{default:a};i.default.prototype.noLoop=function(){this._loop=!1},i.default.prototype.loop=function(){this._loop||(this._loop=!0,this._setupDone&&this._draw())},i.default.prototype.isLooping=function(){return this._loop},i.default.prototype.push=function(){this._styles.push({props:{_colorMode:this._colorMode},renderer:this._renderer.push()})},i.default.prototype.pop=function(){var u=this._styles.pop();u?(this._renderer.pop(u.renderer),Object.assign(this,u.props)):console.warn("pop() was called without matching push()")},i.default.prototype.redraw=function(u){if(!this._inUserDraw&&this._setupDone){var h=parseInt(u);(isNaN(h)||h<1)&&(h=1);var d=this._isGlobal?window:this;if(typeof d.draw=="function"){d.setup===void 0&&d.scale(d._pixelDensity,d._pixelDensity);for(var c=function(p){p.call(d)},f=0;f<h;f++){d.resetMatrix(),(this._accessibleOutputs.grid||this._accessibleOutputs.text)&&this._updateAccsOutput(),d._renderer.isP3D&&d._renderer._update(),d._setProperty("frameCount",d.frameCount+1),d._registeredMethods.pre.forEach(c),this._inUserDraw=!0;try{d.draw()}finally{this._inUserDraw=!1}d._registeredMethods.post.forEach(c)}}}};var l=i.default;o.default=l},{"./main":264,"core-js/modules/es.array.for-each":154,"core-js/modules/es.object.assign":173,"core-js/modules/web.dom-collections.for-each":228}],277:[function(n,s,o){n("core-js/modules/es.symbol"),n("core-js/modules/es.symbol.description"),n("core-js/modules/es.symbol.iterator"),n("core-js/modules/es.array.from"),n("core-js/modules/es.array.iterator"),n("core-js/modules/es.object.get-prototype-of"),n("core-js/modules/es.object.to-string"),n("core-js/modules/es.regexp.to-string"),n("core-js/modules/es.string.iterator"),n("core-js/modules/es.typed-array.uint8-array"),n("core-js/modules/es.typed-array.copy-within"),n("core-js/modules/es.typed-array.every"),n("core-js/modules/es.typed-array.fill"),n("core-js/modules/es.typed-array.filter"),n("core-js/modules/es.typed-array.find"),n("core-js/modules/es.typed-array.find-index"),n("core-js/modules/es.typed-array.for-each"),n("core-js/modules/es.typed-array.includes"),n("core-js/modules/es.typed-array.index-of"),n("core-js/modules/es.typed-array.iterator"),n("core-js/modules/es.typed-array.join"),n("core-js/modules/es.typed-array.last-index-of"),n("core-js/modules/es.typed-array.map"),n("core-js/modules/es.typed-array.reduce"),n("core-js/modules/es.typed-array.reduce-right"),n("core-js/modules/es.typed-array.reverse"),n("core-js/modules/es.typed-array.set"),n("core-js/modules/es.typed-array.slice"),n("core-js/modules/es.typed-array.some"),n("core-js/modules/es.typed-array.sort"),n("core-js/modules/es.typed-array.subarray"),n("core-js/modules/es.typed-array.to-locale-string"),n("core-js/modules/es.typed-array.to-string"),n("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var a,i=(a=n("./main"))&&a.__esModule?a:{default:a};function l(h){return function(d){if(Array.isArray(d)){for(var c=0,f=new Array(d.length);c<d.length;c++)f[c]=d[c];return f}}(h)||function(d){if(Symbol.iterator in Object(d)||Object.prototype.toString.call(d)==="[object Arguments]")return Array.from(d)}(h)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}i.default.prototype.applyMatrix=function(){var h,d,c=arguments[0]instanceof Object.getPrototypeOf(Uint8Array);return Array.isArray(arguments[0])||c?(h=this._renderer).applyMatrix.apply(h,l(arguments[0])):(d=this._renderer).applyMatrix.apply(d,arguments),this},i.default.prototype.resetMatrix=function(){return this._renderer.resetMatrix(),this},i.default.prototype.rotate=function(h,d){return i.default._validateParameters("rotate",arguments),this._renderer.rotate(this._toRadians(h),d),this},i.default.prototype.rotateX=function(h){return this._assert3d("rotateX"),i.default._validateParameters("rotateX",arguments),this._renderer.rotateX(this._toRadians(h)),this},i.default.prototype.rotateY=function(h){return this._assert3d("rotateY"),i.default._validateParameters("rotateY",arguments),this._renderer.rotateY(this._toRadians(h)),this},i.default.prototype.rotateZ=function(h){return this._assert3d("rotateZ"),i.default._validateParameters("rotateZ",arguments),this._renderer.rotateZ(this._toRadians(h)),this},i.default.prototype.scale=function(h,d,c){if(i.default._validateParameters("scale",arguments),h instanceof i.default.Vector){var f=h;h=f.x,d=f.y,c=f.z}else if(h instanceof Array){var p=h;h=p[0],d=p[1],c=p[2]||1}return isNaN(d)?d=c=h:isNaN(c)&&(c=1),this._renderer.scale.call(this._renderer,h,d,c),this},i.default.prototype.shearX=function(h){i.default._validateParameters("shearX",arguments);var d=this._toRadians(h);return this._renderer.applyMatrix(1,0,Math.tan(d),1,0,0),this},i.default.prototype.shearY=function(h){i.default._validateParameters("shearY",arguments);var d=this._toRadians(h);return this._renderer.applyMatrix(1,Math.tan(d),0,1,0,0),this},i.default.prototype.translate=function(h,d,c){return i.default._validateParameters("translate",arguments),this._renderer.isP3D?this._renderer.translate(h,d,c):this._renderer.translate(h,d),this};var u=i.default;o.default=u},{"./main":264,"core-js/modules/es.array.from":155,"core-js/modules/es.array.iterator":158,"core-js/modules/es.object.get-prototype-of":175,"core-js/modules/es.object.to-string":177,"core-js/modules/es.regexp.to-string":182,"core-js/modules/es.string.iterator":186,"core-js/modules/es.symbol":196,"core-js/modules/es.symbol.description":194,"core-js/modules/es.symbol.iterator":195,"core-js/modules/es.typed-array.copy-within":197,"core-js/modules/es.typed-array.every":198,"core-js/modules/es.typed-array.fill":199,"core-js/modules/es.typed-array.filter":200,"core-js/modules/es.typed-array.find":202,"core-js/modules/es.typed-array.find-index":201,"core-js/modules/es.typed-array.for-each":205,"core-js/modules/es.typed-array.includes":206,"core-js/modules/es.typed-array.index-of":207,"core-js/modules/es.typed-array.iterator":210,"core-js/modules/es.typed-array.join":211,"core-js/modules/es.typed-array.last-index-of":212,"core-js/modules/es.typed-array.map":213,"core-js/modules/es.typed-array.reduce":215,"core-js/modules/es.typed-array.reduce-right":214,"core-js/modules/es.typed-array.reverse":216,"core-js/modules/es.typed-array.set":217,"core-js/modules/es.typed-array.slice":218,"core-js/modules/es.typed-array.some":219,"core-js/modules/es.typed-array.sort":220,"core-js/modules/es.typed-array.subarray":221,"core-js/modules/es.typed-array.to-locale-string":222,"core-js/modules/es.typed-array.to-string":223,"core-js/modules/es.typed-array.uint8-array":226,"core-js/modules/web.dom-collections.iterator":229}],278:[function(n,s,o){n("core-js/modules/es.symbol"),n("core-js/modules/es.symbol.description"),n("core-js/modules/es.symbol.iterator"),n("core-js/modules/es.array.from"),n("core-js/modules/es.array.iterator"),n("core-js/modules/es.object.to-string"),n("core-js/modules/es.regexp.to-string"),n("core-js/modules/es.string.ends-with"),n("core-js/modules/es.string.iterator"),n("core-js/modules/web.dom-collections.iterator");var a,i=(a=n("../core/main"))&&a.__esModule?a:{default:a};function l(h){return function(d){if(Array.isArray(d)){for(var c=0,f=new Array(d.length);c<d.length;c++)f[c]=d[c];return f}}(h)||function(d){if(Symbol.iterator in Object(d)||Object.prototype.toString.call(d)==="[object Arguments]")return Array.from(d)}(h)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function u(h){return(u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(d){return typeof d}:function(d){return d&&typeof Symbol=="function"&&d.constructor===Symbol&&d!==Symbol.prototype?"symbol":typeof d})(h)}i.default.prototype.storeItem=function(h,d){typeof h!="string"&&console.log("The argument that you passed to storeItem() - ".concat(h," is not a string.")),h.endsWith("p5TypeID")&&console.log("The argument that you passed to storeItem() - ".concat(h," must not end with 'p5TypeID'.")),d===void 0&&console.log("You cannot store undefined variables using storeItem().");var c=u(d);switch(c){case"number":case"boolean":d=d.toString();break;case"object":d instanceof i.default.Color?c="p5.Color":d instanceof i.default.Vector&&(c="p5.Vector",d=[d.x,d.y,d.z]),d=JSON.stringify(d)}localStorage.setItem(h,d);var f="".concat(h,"p5TypeID");localStorage.setItem(f,c)},i.default.prototype.getItem=function(h){var d=localStorage.getItem(h),c=localStorage.getItem("".concat(h,"p5TypeID"));if(c===void 0)console.log("Unable to determine type of item stored under ".concat(h,"in local storage. Did you save the item with something other than setItem()?"));else if(d!==null)switch(c){case"number":d=parseFloat(d);break;case"boolean":d=d==="true";break;case"object":d=JSON.parse(d);break;case"p5.Color":d=JSON.parse(d),d=this.color.apply(this,l(d.levels));break;case"p5.Vector":d=JSON.parse(d),d=this.createVector.apply(this,l(d))}return d},i.default.prototype.clearStorage=function(){localStorage.clear()},i.default.prototype.removeItem=function(h){typeof h!="string"&&console.log("The argument that you passed to removeItem() - ".concat(h," is not a string.")),localStorage.removeItem(h),localStorage.removeItem("".concat(h,"p5TypeID"))}},{"../core/main":264,"core-js/modules/es.array.from":155,"core-js/modules/es.array.iterator":158,"core-js/modules/es.object.to-string":177,"core-js/modules/es.regexp.to-string":182,"core-js/modules/es.string.ends-with":184,"core-js/modules/es.string.iterator":186,"core-js/modules/es.symbol":196,"core-js/modules/es.symbol.description":194,"core-js/modules/es.symbol.iterator":195,"core-js/modules/web.dom-collections.iterator":229}],279:[function(n,s,o){n("core-js/modules/es.array.concat"),n("core-js/modules/es.object.keys"),n("core-js/modules/es.string.sub"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var a,i=(a=n("../core/main"))&&a.__esModule?a:{default:a};i.default.prototype.createStringDict=function(u,h){return i.default._validateParameters("createStringDict",arguments),new i.default.StringDict(u,h)},i.default.prototype.createNumberDict=function(u,h){return i.default._validateParameters("createNumberDict",arguments),new i.default.NumberDict(u,h)},i.default.TypedDict=function(u,h){return u instanceof Object?this.data=u:(this.data={},this.data[u]=h),this},i.default.TypedDict.prototype.size=function(){return Object.keys(this.data).length},i.default.TypedDict.prototype.hasKey=function(u){return this.data.hasOwnProperty(u)},i.default.TypedDict.prototype.get=function(u){if(this.data.hasOwnProperty(u))return this.data[u];console.log("".concat(u," does not exist in this Dictionary"))},i.default.TypedDict.prototype.set=function(u,h){this._validate(h)?this.data[u]=h:console.log("Those values dont work for this dictionary type.")},i.default.TypedDict.prototype._addObj=function(u){for(var h in u)this.set(h,u[h])},i.default.TypedDict.prototype.create=function(u,h){u instanceof Object&&h===void 0?this._addObj(u):u!==void 0?this.set(u,h):console.log("In order to create a new Dictionary entry you must pass an object or a key, value pair")},i.default.TypedDict.prototype.clear=function(){this.data={}},i.default.TypedDict.prototype.remove=function(u){if(!this.data.hasOwnProperty(u))throw new Error("".concat(u," does not exist in this Dictionary"));delete this.data[u]},i.default.TypedDict.prototype.print=function(){for(var u in this.data)console.log("key:".concat(u," value:").concat(this.data[u]))},i.default.TypedDict.prototype.saveTable=function(u){var h="";for(var d in this.data)h+="".concat(d,",").concat(this.data[d],`
`);var c=new Blob([h],{type:"text/csv"});i.default.prototype.downloadFile(c,u||"mycsv","csv")},i.default.TypedDict.prototype.saveJSON=function(u,h){i.default.prototype.saveJSON(this.data,u,h)},i.default.TypedDict.prototype._validate=function(u){return!0},i.default.StringDict=function(){for(var u=arguments.length,h=new Array(u),d=0;d<u;d++)h[d]=arguments[d];i.default.TypedDict.apply(this,h)},i.default.StringDict.prototype=Object.create(i.default.TypedDict.prototype),i.default.StringDict.prototype._validate=function(u){return typeof u=="string"},i.default.NumberDict=function(){for(var u=arguments.length,h=new Array(u),d=0;d<u;d++)h[d]=arguments[d];i.default.TypedDict.apply(this,h)},i.default.NumberDict.prototype=Object.create(i.default.TypedDict.prototype),i.default.NumberDict.prototype._validate=function(u){return typeof u=="number"},i.default.NumberDict.prototype.add=function(u,h){this.data.hasOwnProperty(u)?this.data[u]+=h:console.log("The key - ".concat(u," does not exist in this dictionary."))},i.default.NumberDict.prototype.sub=function(u,h){this.add(u,-h)},i.default.NumberDict.prototype.mult=function(u,h){this.data.hasOwnProperty(u)?this.data[u]*=h:console.log("The key - ".concat(u," does not exist in this dictionary."))},i.default.NumberDict.prototype.div=function(u,h){this.data.hasOwnProperty(u)?this.data[u]/=h:console.log("The key - ".concat(u," does not exist in this dictionary."))},i.default.NumberDict.prototype._valueTest=function(u){if(Object.keys(this.data).length===0)throw new Error("Unable to search for a minimum or maximum value on an empty NumberDict");if(Object.keys(this.data).length===1)return this.data[Object.keys(this.data)[0]];var h=this.data[Object.keys(this.data)[0]];for(var d in this.data)this.data[d]*u<h*u&&(h=this.data[d]);return h},i.default.NumberDict.prototype.minValue=function(){return this._valueTest(1)},i.default.NumberDict.prototype.maxValue=function(){return this._valueTest(-1)},i.default.NumberDict.prototype._keyTest=function(u){if(Object.keys(this.data).length===0)throw new Error("Unable to use minValue on an empty NumberDict");if(Object.keys(this.data).length===1)return Object.keys(this.data)[0];for(var h=Object.keys(this.data)[0],d=1;d<Object.keys(this.data).length;d++)Object.keys(this.data)[d]*u<h*u&&(h=Object.keys(this.data)[d]);return h},i.default.NumberDict.prototype.minKey=function(){return this._keyTest(1)},i.default.NumberDict.prototype.maxKey=function(){return this._keyTest(-1)};var l=i.default.TypedDict;o.default=l},{"../core/main":264,"core-js/modules/es.array.concat":149,"core-js/modules/es.object.keys":176,"core-js/modules/es.string.sub":192}],280:[function(n,s,o){n("core-js/modules/es.symbol"),n("core-js/modules/es.symbol.description"),n("core-js/modules/es.symbol.iterator"),n("core-js/modules/es.array.every"),n("core-js/modules/es.array.filter"),n("core-js/modules/es.array.for-each"),n("core-js/modules/es.array.from"),n("core-js/modules/es.array.index-of"),n("core-js/modules/es.array.iterator"),n("core-js/modules/es.array.map"),n("core-js/modules/es.array.slice"),n("core-js/modules/es.array.splice"),n("core-js/modules/es.function.name"),n("core-js/modules/es.object.to-string"),n("core-js/modules/es.promise"),n("core-js/modules/es.regexp.exec"),n("core-js/modules/es.regexp.to-string"),n("core-js/modules/es.string.iterator"),n("core-js/modules/es.string.replace"),n("core-js/modules/es.string.split"),n("core-js/modules/es.string.trim"),n("core-js/modules/web.dom-collections.for-each"),n("core-js/modules/web.dom-collections.iterator"),n("core-js/modules/web.url"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var a,i=(a=n("../core/main"))&&a.__esModule?a:{default:a};function l(f){return(l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(p){return typeof p}:function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":typeof p})(f)}function u(f,p,m){(p._userNode?p._userNode:document.body).appendChild(f);var g=m?new i.default.MediaElement(f,p):new i.default.Element(f,p);return p._elements.push(g),g}function h(f,p,m,g){var y=document.createElement(p);typeof(m=m||"")=="string"&&(m=[m]);var v=!0,b=!1,w=void 0;try{for(var _,I=m[Symbol.iterator]();!(v=(_=I.next()).done);v=!0){var C=_.value,N=document.createElement("source");N.setAttribute("src",C),y.appendChild(N)}}catch(D){b=!0,w=D}finally{try{v||I.return==null||I.return()}finally{if(b)throw w}}typeof g=="function"&&y.addEventListener("canplaythrough",function D(){g(),y.removeEventListener("canplaythrough",D)});var O=u(y,f,!0);return O.loadedmetadata=!1,y.addEventListener("loadedmetadata",function(){O.width=y.videoWidth,O.height=y.videoHeight,O.elt.width===0&&(O.elt.width=y.videoWidth),O.elt.height===0&&(O.elt.height=y.videoHeight),O.presetPlaybackRate&&(O.elt.playbackRate=O.presetPlaybackRate,delete O.presetPlaybackRate),O.loadedmetadata=!0}),O}i.default.prototype.select=function(f,p){i.default._validateParameters("select",arguments);var m=this._getContainer(p).querySelector(f);return m?this._wrapElement(m):null},i.default.prototype.selectAll=function(f,p){i.default._validateParameters("selectAll",arguments);var m=[],g=this._getContainer(p).querySelectorAll(f);if(g)for(var y=0;y<g.length;y++){var v=this._wrapElement(g[y]);m.push(v)}return m},i.default.prototype._getContainer=function(f){var p=document;return typeof f=="string"?p=document.querySelector(f)||document:f instanceof i.default.Element?p=f.elt:f instanceof HTMLElement&&(p=f),p},i.default.prototype._wrapElement=function(f){var p=Array.prototype.slice.call(f.children);if(f.tagName!=="INPUT"||f.type!=="checkbox")return f.tagName==="VIDEO"||f.tagName==="AUDIO"?new i.default.MediaElement(f,this):f.tagName==="SELECT"?this.createSelect(new i.default.Element(f,this)):0<p.length&&p.every(function(g){return g.tagName==="INPUT"||g.tagName==="LABEL"})?this.createRadio(new i.default.Element(f,this)):new i.default.Element(f,this);var m=new i.default.Element(f,this);return m.checked=function(){return arguments.length===0?this.elt.checked:(this.elt.checked=!!arguments[0],this)},m},i.default.prototype.removeElements=function(f){i.default._validateParameters("removeElements",arguments),this._elements.filter(function(p){return!(p.elt instanceof HTMLCanvasElement)}).map(function(p){return p.remove()})},i.default.Element.prototype.changed=function(f){return i.default.Element._adjustListener("change",f,this),this},i.default.Element.prototype.input=function(f){return i.default.Element._adjustListener("input",f,this),this},i.default.prototype.createDiv=function(){var f=0<arguments.length&&arguments[0]!==void 0?arguments[0]:"",p=document.createElement("div");return p.innerHTML=f,u(p,this)},i.default.prototype.createP=function(){var f=0<arguments.length&&arguments[0]!==void 0?arguments[0]:"",p=document.createElement("p");return p.innerHTML=f,u(p,this)},i.default.prototype.createSpan=function(){var f=0<arguments.length&&arguments[0]!==void 0?arguments[0]:"",p=document.createElement("span");return p.innerHTML=f,u(p,this)},i.default.prototype.createImg=function(){i.default._validateParameters("createImg",arguments);var f,p=document.createElement("img"),m=arguments;return 1<m.length&&typeof m[1]=="string"&&(p.alt=m[1]),2<m.length&&typeof m[2]=="string"&&(p.crossOrigin=m[2]),p.src=m[0],f=u(p,this),p.addEventListener("load",function(){f.width=p.offsetWidth||p.width,f.height=p.offsetHeight||p.height;var g=m[m.length-1];typeof g=="function"&&g(f)}),f},i.default.prototype.createA=function(f,p,m){i.default._validateParameters("createA",arguments);var g=document.createElement("a");return g.href=f,g.innerHTML=p,m&&(g.target=m),u(g,this)},i.default.prototype.createSlider=function(f,p,m,g){i.default._validateParameters("createSlider",arguments);var y=document.createElement("input");return y.type="range",y.min=f,y.max=p,g===0?y.step=1e-18:g&&(y.step=g),typeof m=="number"&&(y.value=m),u(y,this)},i.default.prototype.createButton=function(f,p){i.default._validateParameters("createButton",arguments);var m=document.createElement("button");return m.innerHTML=f,p&&(m.value=p),u(m,this)},i.default.prototype.createCheckbox=function(){i.default._validateParameters("createCheckbox",arguments);var f=document.createElement("div"),p=document.createElement("input");p.type="checkbox";var m=document.createElement("label");m.appendChild(p),f.appendChild(m);var g=u(f,this);if(g.checked=function(){var v=g.elt.firstElementChild.getElementsByTagName("input")[0];if(v){if(arguments.length===0)return v.checked;v.checked=!!arguments[0]}return g},this.value=function(v){return g.value=v,this},arguments[0]){g.value(arguments[0]);var y=document.createElement("span");y.innerHTML=arguments[0],m.appendChild(y)}return arguments[1]&&(p.checked=!0),g},i.default.prototype.createSelect=function(){var f;i.default._validateParameters("createSelect",arguments);var p=arguments[0];if(p instanceof i.default.Element&&p.elt instanceof HTMLSelectElement)f=p,this.elt=p.elt;else if(p instanceof HTMLSelectElement)f=u(p,this),this.elt=p;else{var m=document.createElement("select");p&&typeof p=="boolean"&&m.setAttribute("multiple","true"),f=u(m,this),this.elt=m}return f.option=function(g,y){var v;if(g!==void 0){for(var b=0;b<this.elt.length;b+=1)if(this.elt[b].innerHTML===g){v=b;break}if(v!==void 0)y===!1?this.elt.remove(v):this.elt[v].value=y;else{var w=document.createElement("option");w.innerHTML=g,w.value=y===void 0?g:y,this.elt.appendChild(w),this._pInst._elements.push(w)}}},f.selected=function(g){if(g!==void 0){for(var y=0;y<this.elt.length;y+=1)this.elt[y].value.toString()===g.toString()&&(this.elt.selectedIndex=y);return this}if(this.elt.getAttribute("multiple")){var v=[],b=!0,w=!1,_=void 0;try{for(var I,C=this.elt.selectedOptions[Symbol.iterator]();!(b=(I=C.next()).done);b=!0){var N=I.value;v.push(N.value)}}catch(O){w=!0,_=O}finally{try{b||C.return==null||C.return()}finally{if(w)throw _}}return v}return this.elt.value},f.disable=function(g){if(typeof g=="string")for(var y=0;y<this.elt.length;y++)this.elt[y].value.toString()===g&&(this.elt[y].disabled=!0,this.elt[y].selected=!1);else this.elt.disabled=!0;return this},f},i.default.prototype.createRadio=function(){var f,p,m=arguments[0];m instanceof HTMLDivElement||m instanceof HTMLSpanElement?(f=m,typeof arguments[1]=="string"&&(p=arguments[1])):(typeof m=="string"&&(p=m),f=document.createElement("div"));var g=u(this.elt=f,this);g._name=p||"radioOption";function y(b){return b instanceof HTMLInputElement&&b.type==="radio"}function v(b){return b instanceof HTMLLabelElement}return g._getOptionsArray=function(){return Array.from(this.elt.children).filter(function(b){return y(b)||v(b)&&y(b.firstElementChild)}).map(function(b){return y(b)?b:b.firstElementChild})},g.option=function(b,w){var _,I,C,N=!0,O=!1,D=void 0;try{for(var M,P=g._getOptionsArray()[Symbol.iterator]();!(N=(M=P.next()).done);N=!0){var F=M.value;if(F.value===b){_=F;break}}}catch(B){O=!0,D=B}finally{try{N||P.return==null||P.return()}finally{if(O)throw D}}return _===void 0&&((_=document.createElement("input")).setAttribute("type","radio"),_.setAttribute("value",b)),_.setAttribute("name",g._name),v(_.parentElement)?I=_.parentElement:(I=document.createElement("label")).insertAdjacentElement("afterbegin",_),I.lastElementChild instanceof HTMLSpanElement?C=I.lastElementChild:(C=document.createElement("span"),_.insertAdjacentElement("afterend",C)),C.innerHTML=w===void 0?b:w,this.elt.appendChild(I),_},g.remove=function(b){var w=!0,_=!1,I=void 0;try{for(var C,N=g._getOptionsArray()[Symbol.iterator]();!(w=(C=N.next()).done);w=!0){var O=C.value;if(O.value===b)return void(v(O.parentElement)?O.parentElement.remove():O.remove())}}catch(D){_=!0,I=D}finally{try{w||N.return==null||N.return()}finally{if(_)throw I}}},g.value=function(){var b="",w=!0,_=!1,I=void 0;try{for(var C,N=g._getOptionsArray()[Symbol.iterator]();!(w=(C=N.next()).done);w=!0){var O=C.value;if(O.checked){b=O.value;break}}}catch(D){_=!0,I=D}finally{try{w||N.return==null||N.return()}finally{if(_)throw I}}return b},g.selected=function(b){var w=null;if(b===void 0){var _=!0,I=!1,C=void 0;try{for(var N,O=g._getOptionsArray()[Symbol.iterator]();!(_=(N=O.next()).done);_=!0){var D=N.value;if(D.checked){w=D;break}}}catch(Q){I=!0,C=Q}finally{try{_||O.return==null||O.return()}finally{if(I)throw C}}}else{var M=!0,P=!1,F=void 0;try{for(var B,z=g._getOptionsArray()[Symbol.iterator]();!(M=(B=z.next()).done);M=!0){var Z=B.value;Z.value===b&&(Z.setAttribute("checked",!0),w=Z)}}catch(Q){P=!0,F=Q}finally{try{M||z.return==null||z.return()}finally{if(P)throw F}}}return w},g.disable=function(){var b=!(0<arguments.length&&arguments[0]!==void 0)||arguments[0],w=!0,_=!1,I=void 0;try{for(var C,N=g._getOptionsArray()[Symbol.iterator]();!(w=(C=N.next()).done);w=!0)C.value.setAttribute("disabled",b)}catch(O){_=!0,I=O}finally{try{w||N.return==null||N.return()}finally{if(_)throw I}}},g},i.default.prototype.createColorPicker=function(f){i.default._validateParameters("createColorPicker",arguments);var p,m=document.createElement("input");return m.type="color",f?f instanceof i.default.Color?m.value=f.toString("#rrggbb"):(i.default.prototype._colorMode="rgb",i.default.prototype._colorMaxes={rgb:[255,255,255,255],hsb:[360,100,100,1],hsl:[360,100,100,1]},m.value=i.default.prototype.color(f).toString("#rrggbb")):m.value="#000000",(p=u(m,this)).color=function(){return f&&(f.mode&&(i.default.prototype._colorMode=f.mode),f.maxes&&(i.default.prototype._colorMaxes=f.maxes)),i.default.prototype.color(this.elt.value)},p},i.default.prototype.createInput=function(){var f=0<arguments.length&&arguments[0]!==void 0?arguments[0]:"",p=1<arguments.length&&arguments[1]!==void 0?arguments[1]:"text";i.default._validateParameters("createInput",arguments);var m=document.createElement("input");return m.setAttribute("value",f),m.setAttribute("type",p),u(m,this)},i.default.prototype.createFileInput=function(f){var p=1<arguments.length&&arguments[1]!==void 0&&arguments[1];if(i.default._validateParameters("createFileInput",arguments),window.File&&window.FileReader&&window.FileList&&window.Blob){var m=document.createElement("input");return m.setAttribute("type","file"),p&&m.setAttribute("multiple",!0),m.addEventListener("change",function(g){var y=!0,v=!1,b=void 0;try{for(var w,_=g.target.files[Symbol.iterator]();!(y=(w=_.next()).done);y=!0){var I=w.value;i.default.File._load(I,f)}}catch(C){v=!0,b=C}finally{try{y||_.return==null||_.return()}finally{if(v)throw b}}},!1),u(m,this)}console.log("The File APIs are not fully supported in this browser. Cannot create element.")},i.default.prototype.createVideo=function(f,p){return i.default._validateParameters("createVideo",arguments),h(this,"video",f,p)},i.default.prototype.createAudio=function(f,p){return i.default._validateParameters("createAudio",arguments),h(this,"audio",f,p)},i.default.prototype.VIDEO="video",i.default.prototype.AUDIO="audio",navigator.mediaDevices===void 0&&(navigator.mediaDevices={}),navigator.mediaDevices.getUserMedia===void 0&&(navigator.mediaDevices.getUserMedia=function(f){var p=navigator.webkitGetUserMedia||navigator.mozGetUserMedia;return p?new Promise(function(m,g){p.call(navigator,f,m,g)}):Promise.reject(new Error("getUserMedia is not implemented in this browser"))}),i.default.prototype.createCapture=function(){if(i.default._validateParameters("createCapture",arguments),!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new DOMException("getUserMedia not supported in this browser");var f,p,m=!0,g=!0,y=!0,v=!1,b=void 0;try{for(var w,_=arguments[Symbol.iterator]();!(y=(w=_.next()).done);y=!0){var I=w.value;I===i.default.prototype.VIDEO?g=!1:I===i.default.prototype.AUDIO?m=!1:l(I)==="object"?f=I:typeof I=="function"&&(p=I)}}catch(O){v=!0,b=O}finally{try{y||_.return==null||_.return()}finally{if(v)throw b}}f=f||{video:m,audio:g};var C=document.createElement("video");C.setAttribute("playsinline",""),navigator.mediaDevices.getUserMedia(f).then(function(O){try{"srcObject"in C?C.srcObject=O:C.src=window.URL.createObjectURL(O)}catch{C.src=O}},console.log);var N=u(C,this,!0);return N.loadedmetadata=!1,C.addEventListener("loadedmetadata",function(){C.play(),C.width?(N.width=C.width,N.height=C.height):(N.width=N.elt.width=C.videoWidth,N.height=N.elt.height=C.videoHeight),N.loadedmetadata=!0,p&&p(C.srcObject)}),N},i.default.prototype.createElement=function(f,p){i.default._validateParameters("createElement",arguments);var m=document.createElement(f);return p!==void 0&&(m.innerHTML=p),u(m,this)},i.default.Element.prototype.addClass=function(f){return this.elt.className?this.hasClass(f)||(this.elt.className=this.elt.className+" "+f):this.elt.className=f,this},i.default.Element.prototype.removeClass=function(f){return this.elt.classList.remove(f),this},i.default.Element.prototype.hasClass=function(f){return this.elt.classList.contains(f)},i.default.Element.prototype.toggleClass=function(f){return this.elt.classList.contains(f)?this.elt.classList.remove(f):this.elt.classList.add(f),this},i.default.Element.prototype.child=function(f){return f===void 0?this.elt.childNodes:(typeof f=="string"?(f[0]==="#"&&(f=f.substring(1)),f=document.getElementById(f)):f instanceof i.default.Element&&(f=f.elt),f instanceof HTMLElement&&this.elt.appendChild(f),this)},i.default.Element.prototype.center=function(f){var p=this.elt.style.display,m=this.elt.style.display==="none",g=this.parent().style.display==="none",y={x:this.elt.offsetLeft,y:this.elt.offsetTop};m&&this.show(),g&&this.parent().show(),this.elt.style.display="block",this.position(0,0);var v=Math.abs(this.parent().offsetWidth-this.elt.offsetWidth),b=Math.abs(this.parent().offsetHeight-this.elt.offsetHeight);return f==="both"||f===void 0?this.position(v/2+this.parent().offsetLeft,b/2+this.parent().offsetTop):f==="horizontal"?this.position(v/2+this.parent().offsetLeft,y.y):f==="vertical"&&this.position(y.x,b/2+this.parent().offsetTop),this.style("display",p),m&&this.hide(),g&&this.parent().hide(),this},i.default.Element.prototype.html=function(){return arguments.length===0?this.elt.innerHTML:(arguments[1]?this.elt.insertAdjacentHTML("beforeend",arguments[0]):this.elt.innerHTML=arguments[0],this)},i.default.Element.prototype.position=function(){if(arguments.length===0)return{x:this.elt.offsetLeft,y:this.elt.offsetTop};var f="absolute";return arguments[2]!=="static"&&arguments[2]!=="fixed"&&arguments[2]!=="relative"&&arguments[2]!=="sticky"&&arguments[2]!=="initial"&&arguments[2]!=="inherit"||(f=arguments[2]),this.elt.style.position=f,this.elt.style.left=arguments[0]+"px",this.elt.style.top=arguments[1]+"px",this.x=arguments[0],this.y=arguments[1],this},i.default.Element.prototype._translate=function(){this.elt.style.position="absolute";var f="";return this.elt.style.transform&&(f=(f=this.elt.style.transform.replace(/translate3d\(.*\)/g,"")).replace(/translate[X-Z]?\(.*\)/g,"")),arguments.length===2?this.elt.style.transform="translate("+arguments[0]+"px, "+arguments[1]+"px)":2<arguments.length&&(this.elt.style.transform="translate3d("+arguments[0]+"px,"+arguments[1]+"px,"+arguments[2]+"px)",this.elt.parentElement.style.perspective=arguments.length===3?"1000px":arguments[3]+"px"),this.elt.style.transform+=f,this},i.default.Element.prototype._rotate=function(){var f="";return this.elt.style.transform&&(f=(f=this.elt.style.transform.replace(/rotate3d\(.*\)/g,"")).replace(/rotate[X-Z]?\(.*\)/g,"")),arguments.length===1?this.elt.style.transform="rotate("+arguments[0]+"deg)":arguments.length===2?this.elt.style.transform="rotate("+arguments[0]+"deg, "+arguments[1]+"deg)":arguments.length===3&&(this.elt.style.transform="rotateX("+arguments[0]+"deg)",this.elt.style.transform+="rotateY("+arguments[1]+"deg)",this.elt.style.transform+="rotateZ("+arguments[2]+"deg)"),this.elt.style.transform+=f,this},i.default.Element.prototype.style=function(f,p){if(p instanceof i.default.Color&&(p="rgba("+p.levels[0]+","+p.levels[1]+","+p.levels[2]+","+p.levels[3]/255+")"),p===void 0){if(f.indexOf(":")===-1)return window.getComputedStyle(this.elt).getPropertyValue(f);for(var m=f.split(";"),g=0;g<m.length;g++){var y=m[g].split(":");y[0]&&y[1]&&(this.elt.style[y[0].trim()]=y[1].trim())}}else if(this.elt.style[f]=p,f==="width"||f==="height"||f==="left"||f==="top"){var v=window.getComputedStyle(this.elt).getPropertyValue(f).replace(/\D+/g,"");this[f]=parseInt(v,10)}return this},i.default.Element.prototype.attribute=function(f,p){if(this.elt.firstChild==null||this.elt.firstChild.type!=="checkbox"&&this.elt.firstChild.type!=="radio")return p===void 0?this.elt.getAttribute(f):(this.elt.setAttribute(f,p),this);if(p===void 0)return this.elt.firstChild.getAttribute(f);for(var m=0;m<this.elt.childNodes.length;m++)this.elt.childNodes[m].setAttribute(f,p)},i.default.Element.prototype.removeAttribute=function(f){if(this.elt.firstChild!=null&&(this.elt.firstChild.type==="checkbox"||this.elt.firstChild.type==="radio"))for(var p=0;p<this.elt.childNodes.length;p++)this.elt.childNodes[p].removeAttribute(f);return this.elt.removeAttribute(f),this},i.default.Element.prototype.value=function(){return 0<arguments.length?(this.elt.value=arguments[0],this):this.elt.type==="range"?parseFloat(this.elt.value):this.elt.value},i.default.Element.prototype.show=function(){return this.elt.style.display="block",this},i.default.Element.prototype.hide=function(){return this.elt.style.display="none",this},i.default.Element.prototype.size=function(f,p){if(arguments.length===0)return{width:this.elt.offsetWidth,height:this.elt.offsetHeight};var m=f,g=p,y=i.default.prototype.AUTO;if(m!==y||g!==y){if(m===y?m=p*this.width/this.height:g===y&&(g=f*this.height/this.width),this.elt instanceof HTMLCanvasElement){var v,b={},w=this.elt.getContext("2d");for(v in w)b[v]=w[v];for(v in this.elt.setAttribute("width",m*this._pInst._pixelDensity),this.elt.setAttribute("height",g*this._pInst._pixelDensity),this.elt.style.width=m+"px",this.elt.style.height=g+"px",this._pInst.scale(this._pInst._pixelDensity,this._pInst._pixelDensity),b)this.elt.getContext("2d")[v]=b[v]}else this.elt.style.width=m+"px",this.elt.style.height=g+"px",this.elt.width=m,this.elt.height=g;this.width=this.elt.offsetWidth,this.height=this.elt.offsetHeight,this._pInst&&this._pInst._curElement&&this._pInst._curElement.elt===this.elt&&(this._pInst._setProperty("width",this.elt.offsetWidth),this._pInst._setProperty("height",this.elt.offsetHeight))}return this},i.default.Element.prototype.remove=function(){if(this instanceof i.default.MediaElement){this.stop();var f=this.elt.srcObject;f!==null&&f.getTracks().forEach(function(g){g.stop()})}var p=this._pInst._elements.indexOf(this);for(var m in p!==-1&&this._pInst._elements.splice(p,1),this._events)this.elt.removeEventListener(m,this._events[m]);this.elt&&this.elt.parentNode&&this.elt.parentNode.removeChild(this.elt)},i.default.Element.prototype.drop=function(f,p){if(window.File&&window.FileReader&&window.FileList&&window.Blob){if(!this._dragDisabled){this._dragDisabled=!0;var m=function(g){g.preventDefault()};this.elt.addEventListener("dragover",m),this.elt.addEventListener("dragleave",m)}i.default.Element._attachListener("drop",function(g){g.preventDefault(),typeof p=="function"&&p.call(this,g);for(var y=g.dataTransfer.files,v=0;v<y.length;v++){var b=y[v];i.default.File._load(b,f)}},this)}else console.log("The File APIs are not fully supported in this browser.");return this},i.default.MediaElement=function(f,p){i.default.Element.call(this,f,p);var m=this;this.elt.crossOrigin="anonymous",this._prevTime=0,this._cueIDCounter=0,this._cues=[],(this._pixelsState=this)._pixelDensity=1,this._modified=!1,Object.defineProperty(m,"src",{get:function(){var g=m.elt.children[0].src,y=m.elt.src===window.location.href?"":m.elt.src;return g===window.location.href?y:g},set:function(g){for(var y=0;y<m.elt.children.length;y++)m.elt.removeChild(m.elt.children[y]);var v=document.createElement("source");v.src=g,f.appendChild(v),m.elt.src=g,m.modified=!0}}),m._onended=function(){},m.elt.onended=function(){m._onended(m)}},i.default.MediaElement.prototype=Object.create(i.default.Element.prototype),i.default.MediaElement.prototype.play=function(){var f,p=this;return this.elt.currentTime===this.elt.duration&&(this.elt.currentTime=0),(f=(1<this.elt.readyState||this.elt.load(),this.elt.play()))&&f.catch&&f.catch(function(m){m.name==="NotAllowedError"?i.default._friendlyAutoplayError(p.src):console.error("Media play method encountered an unexpected error",m)}),this},i.default.MediaElement.prototype.stop=function(){return this.elt.pause(),this.elt.currentTime=0,this},i.default.MediaElement.prototype.pause=function(){return this.elt.pause(),this},i.default.MediaElement.prototype.loop=function(){return this.elt.setAttribute("loop",!0),this.play(),this},i.default.MediaElement.prototype.noLoop=function(){return this.elt.removeAttribute("loop"),this},i.default.MediaElement.prototype._setupAutoplayFailDetection=function(){var f=this,p=setTimeout(function(){return i.default._friendlyAutoplayError(f.src)},500);this.elt.addEventListener("play",function(){return clearTimeout(p)},{passive:!0,once:!0})},i.default.MediaElement.prototype.autoplay=function(f){var p=this,m=this.elt.getAttribute("autoplay");if(this.elt.setAttribute("autoplay",f),f&&!m){var g=function(){return p._setupAutoplayFailDetection()};this.elt.readyState===4?g():this.elt.addEventListener("canplay",g,{passive:!0,once:!0})}return this},i.default.MediaElement.prototype.volume=function(f){if(f===void 0)return this.elt.volume;this.elt.volume=f},i.default.MediaElement.prototype.speed=function(f){if(f===void 0)return this.presetPlaybackRate||this.elt.playbackRate;this.loadedmetadata?this.elt.playbackRate=f:this.presetPlaybackRate=f},i.default.MediaElement.prototype.time=function(f){return f===void 0?this.elt.currentTime:(this.elt.currentTime=f,this)},i.default.MediaElement.prototype.duration=function(){return this.elt.duration},i.default.MediaElement.prototype.pixels=[],i.default.MediaElement.prototype._ensureCanvas=function(){this.canvas||(this.canvas=document.createElement("canvas"),this.drawingContext=this.canvas.getContext("2d"),this.setModified(!0)),this.loadedmetadata&&(this.canvas.width!==this.elt.width&&(this.canvas.width=this.elt.width,this.canvas.height=this.elt.height,this.width=this.canvas.width,this.height=this.canvas.height),this.drawingContext.drawImage(this.elt,0,0,this.canvas.width,this.canvas.height),this.setModified(!0))},i.default.MediaElement.prototype.loadPixels=function(){return this._ensureCanvas(),i.default.Renderer2D.prototype.loadPixels.apply(this,arguments)},i.default.MediaElement.prototype.updatePixels=function(f,p,m,g){return this.loadedmetadata&&(this._ensureCanvas(),i.default.Renderer2D.prototype.updatePixels.call(this,f,p,m,g)),this.setModified(!0),this},i.default.MediaElement.prototype.get=function(){return this._ensureCanvas(),i.default.Renderer2D.prototype.get.apply(this,arguments)},i.default.MediaElement.prototype._getPixel=function(){return this.loadPixels(),i.default.Renderer2D.prototype._getPixel.apply(this,arguments)},i.default.MediaElement.prototype.set=function(f,p,m){this.loadedmetadata&&(this._ensureCanvas(),i.default.Renderer2D.prototype.set.call(this,f,p,m),this.setModified(!0))},i.default.MediaElement.prototype.copy=function(){this._ensureCanvas(),i.default.prototype.copy.apply(this,arguments)},i.default.MediaElement.prototype.mask=function(){this.loadPixels(),this.setModified(!0),i.default.Image.prototype.mask.apply(this,arguments)},i.default.MediaElement.prototype.isModified=function(){return this._modified},i.default.MediaElement.prototype.setModified=function(f){this._modified=f},i.default.MediaElement.prototype.onended=function(f){return this._onended=f,this},i.default.MediaElement.prototype.connect=function(f){var p,m;if(typeof i.default.prototype.getAudioContext=="function")p=i.default.prototype.getAudioContext(),m=i.default.soundOut.input;else try{m=(p=f.context).destination}catch{throw"connect() is meant to be used with Web Audio API or p5.sound.js"}this.audioSourceNode||(this.audioSourceNode=p.createMediaElementSource(this.elt),this.audioSourceNode.connect(m)),f?f.input?this.audioSourceNode.connect(f.input):this.audioSourceNode.connect(f):this.audioSourceNode.connect(m)},i.default.MediaElement.prototype.disconnect=function(){if(!this.audioSourceNode)throw"nothing to disconnect";this.audioSourceNode.disconnect()},i.default.MediaElement.prototype.showControls=function(){this.elt.style["text-align"]="inherit",this.elt.controls=!0},i.default.MediaElement.prototype.hideControls=function(){this.elt.controls=!1};function d(f,p,m,g){this.callback=f,this.time=p,this.id=m,this.val=g}i.default.MediaElement.prototype.addCue=function(f,p,m){var g=this._cueIDCounter++,y=new d(p,f,g,m);return this._cues.push(y),this.elt.ontimeupdate||(this.elt.ontimeupdate=this._onTimeUpdate.bind(this)),g},i.default.MediaElement.prototype.removeCue=function(f){for(var p=0;p<this._cues.length;p++)this._cues[p].id===f&&(console.log(f),this._cues.splice(p,1));this._cues.length===0&&(this.elt.ontimeupdate=null)},i.default.MediaElement.prototype.clearCues=function(){this._cues=[],this.elt.ontimeupdate=null},i.default.MediaElement.prototype._onTimeUpdate=function(){for(var f=this.time(),p=0;p<this._cues.length;p++){var m=this._cues[p].time,g=this._cues[p].val;this._prevTime<m&&m<=f&&this._cues[p].callback(g)}this._prevTime=f},i.default.File=function(f,p){this.file=f,this._pInst=p;var m=f.type.split("/");this.type=m[0],this.subtype=m[1],this.name=f.name,this.size=f.size,this.data=void 0},i.default.File._createLoader=function(f,p){var m=new FileReader;return m.onload=function(g){var y=new i.default.File(f);if(y.file.type==="application/json")y.data=JSON.parse(g.target.result);else if(y.file.type==="text/xml"){var v=new DOMParser().parseFromString(g.target.result,"text/xml");y.data=new i.default.XML(v.documentElement)}else y.data=g.target.result;p(y)},m},i.default.File._load=function(f,p){if(/^text\//.test(f.type)||f.type==="application/json")i.default.File._createLoader(f,p).readAsText(f);else if(/^(video|audio)\//.test(f.type)){var m=new i.default.File(f);m.data=URL.createObjectURL(f),p(m)}else i.default.File._createLoader(f,p).readAsDataURL(f)};var c=i.default;o.default=c},{"../core/main":264,"core-js/modules/es.array.every":150,"core-js/modules/es.array.filter":152,"core-js/modules/es.array.for-each":154,"core-js/modules/es.array.from":155,"core-js/modules/es.array.index-of":157,"core-js/modules/es.array.iterator":158,"core-js/modules/es.array.map":161,"core-js/modules/es.array.slice":162,"core-js/modules/es.array.splice":164,"core-js/modules/es.function.name":166,"core-js/modules/es.object.to-string":177,"core-js/modules/es.promise":178,"core-js/modules/es.regexp.exec":181,"core-js/modules/es.regexp.to-string":182,"core-js/modules/es.string.iterator":186,"core-js/modules/es.string.replace":189,"core-js/modules/es.string.split":191,"core-js/modules/es.string.trim":193,"core-js/modules/es.symbol":196,"core-js/modules/es.symbol.description":194,"core-js/modules/es.symbol.iterator":195,"core-js/modules/web.dom-collections.for-each":228,"core-js/modules/web.dom-collections.iterator":229,"core-js/modules/web.url":231}],281:[function(n,s,o){function a(w){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(_){return typeof _}:function(_){return _&&typeof Symbol=="function"&&_.constructor===Symbol&&_!==Symbol.prototype?"symbol":typeof _})(w)}Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var i,l=(i=n("../core/main"))&&i.__esModule?i:{default:i},u=function(w){if(w&&w.__esModule)return w;if(w===null||a(w)!=="object"&&typeof w!="function")return{default:w};var _=h();if(_&&_.has(w))return _.get(w);var I={},C=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var N in w)if(Object.prototype.hasOwnProperty.call(w,N)){var O=C?Object.getOwnPropertyDescriptor(w,N):null;O&&(O.get||O.set)?Object.defineProperty(I,N,O):I[N]=w[N]}return I.default=w,_&&_.set(w,I),I}(n("../core/constants"));function h(){if(typeof WeakMap!="function")return null;var w=new WeakMap;return h=function(){return w},w}l.default.prototype.deviceOrientation=1<window.innerWidth/window.innerHeight?"landscape":"portrait",l.default.prototype.accelerationX=0,l.default.prototype.accelerationY=0,l.default.prototype.accelerationZ=0,l.default.prototype.pAccelerationX=0,l.default.prototype.pAccelerationY=0,l.default.prototype.pAccelerationZ=0,l.default.prototype._updatePAccelerations=function(){this._setProperty("pAccelerationX",this.accelerationX),this._setProperty("pAccelerationY",this.accelerationY),this._setProperty("pAccelerationZ",this.accelerationZ)},l.default.prototype.rotationX=0,l.default.prototype.rotationY=0,l.default.prototype.rotationZ=0,l.default.prototype.pRotationX=0,l.default.prototype.pRotationY=0;var d=l.default.prototype.pRotationZ=0,c=0,f=0,p="clockwise",m="clockwise",g="clockwise";l.default.prototype.pRotateDirectionX=void 0,l.default.prototype.pRotateDirectionY=void 0,l.default.prototype.pRotateDirectionZ=void 0,l.default.prototype._updatePRotations=function(){this._setProperty("pRotationX",this.rotationX),this._setProperty("pRotationY",this.rotationY),this._setProperty("pRotationZ",this.rotationZ)},l.default.prototype.turnAxis=void 0;var y=.5,v=30;l.default.prototype.setMoveThreshold=function(w){l.default._validateParameters("setMoveThreshold",arguments),y=w},l.default.prototype.setShakeThreshold=function(w){l.default._validateParameters("setShakeThreshold",arguments),v=w},l.default.prototype._ondeviceorientation=function(w){this._updatePRotations(),this._angleMode===u.radians&&(w.beta=w.beta*(_PI/180),w.gamma=w.gamma*(_PI/180),w.alpha=w.alpha*(_PI/180)),this._setProperty("rotationX",w.beta),this._setProperty("rotationY",w.gamma),this._setProperty("rotationZ",w.alpha),this._handleMotion()},l.default.prototype._ondevicemotion=function(w){this._updatePAccelerations(),this._setProperty("accelerationX",2*w.acceleration.x),this._setProperty("accelerationY",2*w.acceleration.y),this._setProperty("accelerationZ",2*w.acceleration.z),this._handleMotion()},l.default.prototype._handleMotion=function(){window.orientation===90||window.orientation===-90?this._setProperty("deviceOrientation","landscape"):window.orientation===0?this._setProperty("deviceOrientation","portrait"):window.orientation===void 0&&this._setProperty("deviceOrientation","undefined");var w,_,I=this._isGlobal?window:this;if(typeof I.deviceMoved=="function"&&(Math.abs(this.accelerationX-this.pAccelerationX)>y||Math.abs(this.accelerationY-this.pAccelerationY)>y||Math.abs(this.accelerationZ-this.pAccelerationZ)>y)&&I.deviceMoved(),typeof I.deviceTurned=="function"){var C=this.rotationX+180,N=this.pRotationX+180,O=d+180;0<C-N&&C-N<270||C-N<-270?p="clockwise":(C-N<0||270<C-N)&&(p="counter-clockwise"),p!==this.pRotateDirectionX&&(O=C),90<Math.abs(C-O)&&Math.abs(C-O)<270&&(O=C,this._setProperty("turnAxis","X"),I.deviceTurned()),this.pRotateDirectionX=p,d=O-180;var D=this.rotationY+180,M=this.pRotationY+180,P=c+180;0<D-M&&D-M<270||D-M<-270?m="clockwise":(D-M<0||270<D-this.pRotationY)&&(m="counter-clockwise"),m!==this.pRotateDirectionY&&(P=D),90<Math.abs(D-P)&&Math.abs(D-P)<270&&(P=D,this._setProperty("turnAxis","Y"),I.deviceTurned()),this.pRotateDirectionY=m,c=P-180,0<this.rotationZ-this.pRotationZ&&this.rotationZ-this.pRotationZ<270||this.rotationZ-this.pRotationZ<-270?g="clockwise":(this.rotationZ-this.pRotationZ<0||270<this.rotationZ-this.pRotationZ)&&(g="counter-clockwise"),g!==this.pRotateDirectionZ&&(f=this.rotationZ),90<Math.abs(this.rotationZ-f)&&Math.abs(this.rotationZ-f)<270&&(f=this.rotationZ,this._setProperty("turnAxis","Z"),I.deviceTurned()),this.pRotateDirectionZ=g,this._setProperty("turnAxis",void 0)}typeof I.deviceShaken=="function"&&(this.pAccelerationX!==null&&(w=Math.abs(this.accelerationX-this.pAccelerationX),_=Math.abs(this.accelerationY-this.pAccelerationY)),v<w+_&&I.deviceShaken())};var b=l.default;o.default=b},{"../core/constants":253,"../core/main":264}],282:[function(n,s,o){Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var a,i=(a=n("../core/main"))&&a.__esModule?a:{default:a};i.default.prototype.isKeyPressed=!1,i.default.prototype.keyIsPressed=!1,i.default.prototype.key="",i.default.prototype.keyCode=0,i.default.prototype._onkeydown=function(u){if(!this._downKeys[u.which]){this._setProperty("isKeyPressed",!0),this._setProperty("keyIsPressed",!0),this._setProperty("keyCode",u.which),this._downKeys[u.which]=!0,this._setProperty("key",u.key||String.fromCharCode(u.which)||u.which);var h=this._isGlobal?window:this;typeof h.keyPressed=="function"&&!u.charCode&&h.keyPressed(u)===!1&&u.preventDefault()}},i.default.prototype._onkeyup=function(u){this._downKeys[u.which]=!1,this._areDownKeys()||(this._setProperty("isKeyPressed",!1),this._setProperty("keyIsPressed",!1)),this._setProperty("_lastKeyCodeTyped",null),this._setProperty("key",u.key||String.fromCharCode(u.which)||u.which),this._setProperty("keyCode",u.which);var h=this._isGlobal?window:this;typeof h.keyReleased=="function"&&h.keyReleased(u)===!1&&u.preventDefault()},i.default.prototype._onkeypress=function(u){if(u.which!==this._lastKeyCodeTyped){this._setProperty("_lastKeyCodeTyped",u.which),this._setProperty("key",u.key||String.fromCharCode(u.which)||u.which);var h=this._isGlobal?window:this;typeof h.keyTyped=="function"&&h.keyTyped(u)===!1&&u.preventDefault()}},i.default.prototype._onblur=function(u){this._downKeys={}},i.default.prototype.keyIsDown=function(u){return i.default._validateParameters("keyIsDown",arguments),this._downKeys[u]||!1},i.default.prototype._areDownKeys=function(){for(var u in this._downKeys)if(this._downKeys.hasOwnProperty(u)&&this._downKeys[u]===!0)return!0;return!1};var l=i.default;o.default=l},{"../core/main":264}],283:[function(n,s,o){function a(c){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(f){return typeof f}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f})(c)}n("core-js/modules/es.array.includes"),n("core-js/modules/es.string.includes"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var i,l=(i=n("../core/main"))&&i.__esModule?i:{default:i},u=function(c){if(c&&c.__esModule)return c;if(c===null||a(c)!=="object"&&typeof c!="function")return{default:c};var f=h();if(f&&f.has(c))return f.get(c);var p={},m=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var g in c)if(Object.prototype.hasOwnProperty.call(c,g)){var y=m?Object.getOwnPropertyDescriptor(c,g):null;y&&(y.get||y.set)?Object.defineProperty(p,g,y):p[g]=c[g]}return p.default=c,f&&f.set(c,p),p}(n("../core/constants"));function h(){if(typeof WeakMap!="function")return null;var c=new WeakMap;return h=function(){return c},c}l.default.prototype.movedX=0,l.default.prototype.movedY=0,l.default.prototype._hasMouseInteracted=!1,l.default.prototype.mouseX=0,l.default.prototype.mouseY=0,l.default.prototype.pmouseX=0,l.default.prototype.pmouseY=0,l.default.prototype.winMouseX=0,l.default.prototype.winMouseY=0,l.default.prototype.pwinMouseX=0,l.default.prototype.pwinMouseY=0,l.default.prototype.mouseButton=0,l.default.prototype.mouseIsPressed=!1,l.default.prototype._updateNextMouseCoords=function(c){if(this._curElement!==null&&(!c.touches||0<c.touches.length)){var f=function(p,m,g,y){y&&!y.clientX&&(y.touches?y=y.touches[0]:y.changedTouches&&(y=y.changedTouches[0]));var v=p.getBoundingClientRect(),b=p.scrollWidth/m||1,w=p.scrollHeight/g||1;return{x:(y.clientX-v.left)/b,y:(y.clientY-v.top)/w,winX:y.clientX,winY:y.clientY,id:y.identifier}}(this._curElement.elt,this.width,this.height,c);this._setProperty("movedX",c.movementX),this._setProperty("movedY",c.movementY),this._setProperty("mouseX",f.x),this._setProperty("mouseY",f.y),this._setProperty("winMouseX",f.winX),this._setProperty("winMouseY",f.winY)}this._hasMouseInteracted||(this._updateMouseCoords(),this._setProperty("_hasMouseInteracted",!0))},l.default.prototype._updateMouseCoords=function(){this._setProperty("pmouseX",this.mouseX),this._setProperty("pmouseY",this.mouseY),this._setProperty("pwinMouseX",this.winMouseX),this._setProperty("pwinMouseY",this.winMouseY),this._setProperty("_pmouseWheelDeltaY",this._mouseWheelDeltaY)},l.default.prototype._setMouseButton=function(c){c.button===1?this._setProperty("mouseButton",u.CENTER):c.button===2?this._setProperty("mouseButton",u.RIGHT):this._setProperty("mouseButton",u.LEFT)},l.default.prototype._onmousemove=function(c){var f=this._isGlobal?window:this;this._updateNextMouseCoords(c),this.mouseIsPressed?typeof f.mouseDragged=="function"?f.mouseDragged(c)===!1&&c.preventDefault():typeof f.touchMoved=="function"&&f.touchMoved(c)===!1&&c.preventDefault():typeof f.mouseMoved=="function"&&f.mouseMoved(c)===!1&&c.preventDefault()},l.default.prototype._onmousedown=function(c){var f=this._isGlobal?window:this;this._setProperty("mouseIsPressed",!0),this._setMouseButton(c),this._updateNextMouseCoords(c),typeof f.mousePressed=="function"?f.mousePressed(c)===!1&&c.preventDefault():navigator.userAgent.toLowerCase().includes("safari")&&typeof f.touchStarted=="function"&&f.touchStarted(c)===!1&&c.preventDefault()},l.default.prototype._onmouseup=function(c){var f=this._isGlobal?window:this;this._setProperty("mouseIsPressed",!1),typeof f.mouseReleased=="function"?f.mouseReleased(c)===!1&&c.preventDefault():typeof f.touchEnded=="function"&&f.touchEnded(c)===!1&&c.preventDefault()},l.default.prototype._ondragend=l.default.prototype._onmouseup,l.default.prototype._ondragover=l.default.prototype._onmousemove,l.default.prototype._onclick=function(c){var f=this._isGlobal?window:this;typeof f.mouseClicked=="function"&&f.mouseClicked(c)===!1&&c.preventDefault()},l.default.prototype._ondblclick=function(c){var f=this._isGlobal?window:this;typeof f.doubleClicked=="function"&&f.doubleClicked(c)===!1&&c.preventDefault()},l.default.prototype._mouseWheelDeltaY=0,l.default.prototype._pmouseWheelDeltaY=0,l.default.prototype._onwheel=function(c){var f=this._isGlobal?window:this;this._setProperty("_mouseWheelDeltaY",c.deltaY),typeof f.mouseWheel=="function"&&(c.delta=c.deltaY,f.mouseWheel(c)===!1&&c.preventDefault())},l.default.prototype.requestPointerLock=function(){var c=this._curElement.elt;return c.requestPointerLock=c.requestPointerLock||c.mozRequestPointerLock,c.requestPointerLock?(c.requestPointerLock(),!0):(console.log("requestPointerLock is not implemented in this browser"),!1)},l.default.prototype.exitPointerLock=function(){document.exitPointerLock()};var d=l.default;o.default=d},{"../core/constants":253,"../core/main":264,"core-js/modules/es.array.includes":156,"core-js/modules/es.string.includes":185}],284:[function(n,s,o){n("core-js/modules/es.array.includes"),n("core-js/modules/es.string.includes"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var a,i=(a=n("../core/main"))&&a.__esModule?a:{default:a};function l(h,d,c,f,p){var m=4<arguments.length&&p!==void 0?p:0,g=h.getBoundingClientRect(),y=h.scrollWidth/d||1,v=h.scrollHeight/c||1,b=f.touches[m]||f.changedTouches[m];return{x:(b.clientX-g.left)/y,y:(b.clientY-g.top)/v,winX:b.clientX,winY:b.clientY,id:b.identifier}}i.default.prototype.touches=[],i.default.prototype._updateTouchCoords=function(h){if(this._curElement!==null){for(var d=[],c=0;c<h.touches.length;c++)d[c]=l(this._curElement.elt,this.width,this.height,h,c);this._setProperty("touches",d)}},i.default.prototype._ontouchstart=function(h){var d=this._isGlobal?window:this;this._setProperty("mouseIsPressed",!0),this._updateTouchCoords(h),this._updateNextMouseCoords(h),this._updateMouseCoords(),typeof d.touchStarted=="function"?d.touchStarted(h)===!1&&h.preventDefault():navigator.userAgent.toLowerCase().includes("safari")&&typeof d.mousePressed=="function"&&d.mousePressed(h)===!1&&h.preventDefault()},i.default.prototype._ontouchmove=function(h){var d=this._isGlobal?window:this;this._updateTouchCoords(h),this._updateNextMouseCoords(h),typeof d.touchMoved=="function"?d.touchMoved(h)===!1&&h.preventDefault():typeof d.mouseDragged=="function"&&d.mouseDragged(h)===!1&&h.preventDefault()},i.default.prototype._ontouchend=function(h){this._setProperty("mouseIsPressed",!1),this._updateTouchCoords(h),this._updateNextMouseCoords(h);var d=this._isGlobal?window:this;typeof d.touchEnded=="function"?d.touchEnded(h)===!1&&h.preventDefault():typeof d.mouseReleased=="function"&&d.mouseReleased(h)===!1&&h.preventDefault()};var u=i.default;o.default=u},{"../core/main":264,"core-js/modules/es.array.includes":156,"core-js/modules/es.string.includes":185}],285:[function(n,s,o){n("core-js/modules/es.array.iterator"),n("core-js/modules/es.object.to-string"),n("core-js/modules/es.typed-array.int32-array"),n("core-js/modules/es.typed-array.uint8-array"),n("core-js/modules/es.typed-array.copy-within"),n("core-js/modules/es.typed-array.every"),n("core-js/modules/es.typed-array.fill"),n("core-js/modules/es.typed-array.filter"),n("core-js/modules/es.typed-array.find"),n("core-js/modules/es.typed-array.find-index"),n("core-js/modules/es.typed-array.for-each"),n("core-js/modules/es.typed-array.includes"),n("core-js/modules/es.typed-array.index-of"),n("core-js/modules/es.typed-array.iterator"),n("core-js/modules/es.typed-array.join"),n("core-js/modules/es.typed-array.last-index-of"),n("core-js/modules/es.typed-array.map"),n("core-js/modules/es.typed-array.reduce"),n("core-js/modules/es.typed-array.reduce-right"),n("core-js/modules/es.typed-array.reverse"),n("core-js/modules/es.typed-array.set"),n("core-js/modules/es.typed-array.slice"),n("core-js/modules/es.typed-array.some"),n("core-js/modules/es.typed-array.sort"),n("core-js/modules/es.typed-array.subarray"),n("core-js/modules/es.typed-array.to-locale-string"),n("core-js/modules/es.typed-array.to-string"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var a,i,l,u,h={};function d(f,p){for(var m,g,y,v,b,w,_,I,C,N,O=h._toPixels(f),D=f.width,M=f.height,P=D*M,F=new Int32Array(P),B=0;B<P;B++)F[B]=h._getARGB(O,B);var z,Z,Q,K,ne=new Int32Array(P),re=new Int32Array(P),ce=new Int32Array(P),be=new Int32Array(P),we=0;for(function(Oe){var Se=3.5*Oe|0;if(a!==(Se=Se<1?1:Se<248?Se:248)){i=1+(a=Se)<<1,l=new Int32Array(i),u=new Array(i);for(var Ee=0;Ee<i;Ee++)u[Ee]=new Int32Array(256);for(var j,W,J,ie,ve=1,he=Se-1;ve<Se;ve++){l[Se+ve]=l[he]=W=he*he,J=u[Se+ve],ie=u[he--];for(var Fe=0;Fe<256;Fe++)J[Fe]=ie[Fe]=W*Fe}j=l[Se]=Se*Se,J=u[Se];for(var me=0;me<256;me++)J[me]=j*me}}(p),Z=0;Z<M;Z++){for(z=0;z<D;z++){if(v=y=g=b=m=0,(w=z-a)<0)N=-w,w=0;else{if(D<=w)break;N=0}for(Q=N;Q<i&&!(D<=w);Q++){var ye=F[w+we];b+=(K=u[Q])[(-16777216&ye)>>>24],g+=K[(16711680&ye)>>16],y+=K[(65280&ye)>>8],v+=K[255&ye],m+=l[Q],w++}ne[_=we+z]=b/m,re[_]=g/m,ce[_]=y/m,be[_]=v/m}we+=D}for(C=(I=-a)*D,Z=we=0;Z<M;Z++){for(z=0;z<D;z++){if(v=y=g=b=m=0,I<0)N=_=-I,w=z;else{if(M<=I)break;N=0,_=I,w=z+C}for(Q=N;Q<i&&!(M<=_);Q++)b+=(K=u[Q])[ne[w]],g+=K[re[w]],y+=K[ce[w]],v+=K[be[w]],m+=l[Q],_++,w+=D;F[z+we]=b/m<<24|g/m<<16|y/m<<8|v/m}we+=D,C+=D,I++}h._setPixels(O,F)}h._toPixels=function(f){if(f instanceof ImageData)return f.data;if(f.getContext("2d"))return f.getContext("2d").getImageData(0,0,f.width,f.height).data;if(f.getContext("webgl")){var p=f.getContext("webgl"),m=p.drawingBufferWidth*p.drawingBufferHeight*4,g=new Uint8Array(m);return p.readPixels(0,0,f.width,f.height,p.RGBA,p.UNSIGNED_BYTE,g),g}},h._getARGB=function(f,p){var m=4*p;return f[3+m]<<24&4278190080|f[m]<<16&16711680|f[1+m]<<8&65280|255&f[2+m]},h._setPixels=function(f,p){for(var m=0,g=0,y=f.length;g<y;g++)f[(m=4*g)+0]=(16711680&p[g])>>>16,f[m+1]=(65280&p[g])>>>8,f[m+2]=255&p[g],f[m+3]=(4278190080&p[g])>>>24},h._toImageData=function(f){return f instanceof ImageData?f:f.getContext("2d").getImageData(0,0,f.width,f.height)},h._createImageData=function(f,p){return h._tmpCanvas=document.createElement("canvas"),h._tmpCtx=h._tmpCanvas.getContext("2d"),this._tmpCtx.createImageData(f,p)},h.apply=function(f,p,m){var g=f.getContext("2d"),y=g.getImageData(0,0,f.width,f.height),v=p(y,m);v instanceof ImageData?g.putImageData(v,0,0,0,0,f.width,f.height):g.putImageData(y,0,0,0,0,f.width,f.height)},h.threshold=function(f,p){var m=h._toPixels(f);p===void 0&&(p=.5);for(var g=Math.floor(255*p),y=0;y<m.length;y+=4){var v=void 0;v=g<=.2126*m[y]+.7152*m[y+1]+.0722*m[y+2]?255:0,m[y]=m[y+1]=m[y+2]=v}},h.gray=function(f){for(var p=h._toPixels(f),m=0;m<p.length;m+=4){var g=.2126*p[m]+.7152*p[m+1]+.0722*p[m+2];p[m]=p[m+1]=p[m+2]=g}},h.opaque=function(f){for(var p=h._toPixels(f),m=0;m<p.length;m+=4)p[m+3]=255;return p},h.invert=function(f){for(var p=h._toPixels(f),m=0;m<p.length;m+=4)p[m]=255-p[m],p[m+1]=255-p[m+1],p[m+2]=255-p[m+2]},h.posterize=function(f,p){var m=h._toPixels(f);if(p<2||255<p)throw new Error("Level must be greater than 2 and less than 255 for posterize");for(var g=p-1,y=0;y<m.length;y+=4){var v=m[y],b=m[y+1],w=m[y+2];m[y]=255*(v*p>>8)/g,m[y+1]=255*(b*p>>8)/g,m[y+2]=255*(w*p>>8)/g}},h.dilate=function(f){for(var p,m,g,y,v,b,w,_,I,C,N,O,D,M,P,F,B,z=h._toPixels(f),Z=0,Q=z.length?z.length/4:0,K=new Int32Array(Q);Z<Q;)for(m=(p=Z)+f.width;Z<m;)g=y=h._getARGB(z,Z),(w=Z-1)<p&&(w=Z),m<=(b=Z+1)&&(b=Z),(_=Z-f.width)<0&&(_=0),Q<=(I=Z+f.width)&&(I=Z),O=h._getARGB(z,_),N=h._getARGB(z,w),D=h._getARGB(z,I),(v=77*(g>>16&255)+151*(g>>8&255)+28*(255&g))<(P=77*(N>>16&255)+151*(N>>8&255)+28*(255&N))&&(y=N,v=P),v<(M=77*((C=h._getARGB(z,b))>>16&255)+151*(C>>8&255)+28*(255&C))&&(y=C,v=M),v<(F=77*(O>>16&255)+151*(O>>8&255)+28*(255&O))&&(y=O,v=F),v<(B=77*(D>>16&255)+151*(D>>8&255)+28*(255&D))&&(y=D,v=B),K[Z++]=y;h._setPixels(z,K)},h.erode=function(f){for(var p,m,g,y,v,b,w,_,I,C,N,O,D,M,P,F,B,z=h._toPixels(f),Z=0,Q=z.length?z.length/4:0,K=new Int32Array(Q);Z<Q;)for(m=(p=Z)+f.width;Z<m;)g=y=h._getARGB(z,Z),(w=Z-1)<p&&(w=Z),m<=(b=Z+1)&&(b=Z),(_=Z-f.width)<0&&(_=0),Q<=(I=Z+f.width)&&(I=Z),O=h._getARGB(z,_),N=h._getARGB(z,w),D=h._getARGB(z,I),(P=77*(N>>16&255)+151*(N>>8&255)+28*(255&N))<(v=77*(g>>16&255)+151*(g>>8&255)+28*(255&g))&&(y=N,v=P),(M=77*((C=h._getARGB(z,b))>>16&255)+151*(C>>8&255)+28*(255&C))<v&&(y=C,v=M),(F=77*(O>>16&255)+151*(O>>8&255)+28*(255&O))<v&&(y=O,v=F),(B=77*(D>>16&255)+151*(D>>8&255)+28*(255&D))<v&&(y=D,v=B),K[Z++]=y;h._setPixels(z,K)},h.blur=function(f,p){d(f,p)};var c=h;o.default=c},{"core-js/modules/es.array.iterator":158,"core-js/modules/es.object.to-string":177,"core-js/modules/es.typed-array.copy-within":197,"core-js/modules/es.typed-array.every":198,"core-js/modules/es.typed-array.fill":199,"core-js/modules/es.typed-array.filter":200,"core-js/modules/es.typed-array.find":202,"core-js/modules/es.typed-array.find-index":201,"core-js/modules/es.typed-array.for-each":205,"core-js/modules/es.typed-array.includes":206,"core-js/modules/es.typed-array.index-of":207,"core-js/modules/es.typed-array.int32-array":209,"core-js/modules/es.typed-array.iterator":210,"core-js/modules/es.typed-array.join":211,"core-js/modules/es.typed-array.last-index-of":212,"core-js/modules/es.typed-array.map":213,"core-js/modules/es.typed-array.reduce":215,"core-js/modules/es.typed-array.reduce-right":214,"core-js/modules/es.typed-array.reverse":216,"core-js/modules/es.typed-array.set":217,"core-js/modules/es.typed-array.slice":218,"core-js/modules/es.typed-array.some":219,"core-js/modules/es.typed-array.sort":220,"core-js/modules/es.typed-array.subarray":221,"core-js/modules/es.typed-array.to-locale-string":222,"core-js/modules/es.typed-array.to-string":223,"core-js/modules/es.typed-array.uint8-array":226}],286:[function(n,s,o){n("core-js/modules/es.symbol"),n("core-js/modules/es.symbol.description"),n("core-js/modules/es.symbol.iterator"),n("core-js/modules/es.array.concat"),n("core-js/modules/es.array.filter"),n("core-js/modules/es.array.from"),n("core-js/modules/es.array.iterator"),n("core-js/modules/es.array.map"),n("core-js/modules/es.array.slice"),n("core-js/modules/es.object.keys"),n("core-js/modules/es.object.to-string"),n("core-js/modules/es.regexp.exec"),n("core-js/modules/es.regexp.to-string"),n("core-js/modules/es.set"),n("core-js/modules/es.string.iterator"),n("core-js/modules/es.string.replace"),n("core-js/modules/es.string.split"),n("core-js/modules/es.typed-array.uint8-array"),n("core-js/modules/es.typed-array.uint32-array"),n("core-js/modules/es.typed-array.copy-within"),n("core-js/modules/es.typed-array.every"),n("core-js/modules/es.typed-array.fill"),n("core-js/modules/es.typed-array.filter"),n("core-js/modules/es.typed-array.find"),n("core-js/modules/es.typed-array.find-index"),n("core-js/modules/es.typed-array.for-each"),n("core-js/modules/es.typed-array.includes"),n("core-js/modules/es.typed-array.index-of"),n("core-js/modules/es.typed-array.iterator"),n("core-js/modules/es.typed-array.join"),n("core-js/modules/es.typed-array.last-index-of"),n("core-js/modules/es.typed-array.map"),n("core-js/modules/es.typed-array.reduce"),n("core-js/modules/es.typed-array.reduce-right"),n("core-js/modules/es.typed-array.reverse"),n("core-js/modules/es.typed-array.set"),n("core-js/modules/es.typed-array.slice"),n("core-js/modules/es.typed-array.some"),n("core-js/modules/es.typed-array.sort"),n("core-js/modules/es.typed-array.subarray"),n("core-js/modules/es.typed-array.to-locale-string"),n("core-js/modules/es.typed-array.to-string"),n("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var a=l(n("../core/main")),i=l(n("omggif"));function l(d){return d&&d.__esModule?d:{default:d}}function u(d){return function(c){if(Array.isArray(c)){for(var f=0,p=new Array(c.length);f<c.length;f++)p[f]=c[f];return p}}(d)||function(c){if(Symbol.iterator in Object(c)||Object.prototype.toString.call(c)==="[object Arguments]")return Array.from(c)}(d)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}a.default.prototype.createImage=function(d,c){return a.default._validateParameters("createImage",arguments),new a.default.Image(d,c)},a.default.prototype.saveCanvas=function(){a.default._validateParameters("saveCanvas",arguments);var d,c,f,p,m=[].slice.call(arguments);switch(arguments[0]instanceof HTMLCanvasElement?(d=arguments[0],m.shift()):arguments[0]instanceof a.default.Element?(d=arguments[0].elt,m.shift()):d=this._curElement&&this._curElement.elt,1<=m.length&&(c=m[0]),2<=m.length&&(f=m[1]),f=f||a.default.prototype._checkFileExtension(c,f)[1]||"png"){default:p="image/png";break;case"jpeg":case"jpg":p="image/jpeg"}d.toBlob(function(g){a.default.prototype.downloadFile(g,c,f)},p)},a.default.prototype.saveGif=function(d,c){var f=d.gifProperties,p=f.loopLimit;p===1?p=null:p===null&&(p=0);for(var m=new Uint8Array(d.width*d.height*f.numFrames),g=[],y={},v=0;v<f.numFrames;v++){for(var b=new Set,w=f.frames[v].image.data,_=w.length,I=new Uint32Array(d.width*d.height),C=0,N=0;C<_;C+=4,N++){var O=w[C+0]<<16|w[C+1]<<8|w[C+2]<<0;b.add(O),I[N]=O}var D=u(b).sort().toString();y[D]===void 0?y[D]={freq:1,frames:[v]}:(y[D].freq+=1,y[D].frames.push(v)),g.push(I)}var M=[],P=Object.keys(y).sort(function(Ee,j){return y[j].freq-y[Ee].freq}),F=P[0].split(",").map(function(Ee){return parseInt(Ee)});M=M.concat(y[F].frames);for(var B=new Set(F),z=1;z<P.length;z++){var Z=P[z].split(",").map(function(Ee){return parseInt(Ee)}).filter(function(Ee){return!B.has(Ee)});if(F.length+Z.length<=256){for(var Q=0;Q<Z.length;Q++)F.push(Z[Q]),B.add(Z[Q]);M=M.concat(y[P[z]].frames)}}M=new Set(M);for(var K={},ne=0;ne<F.length;ne++)K[F[ne]]||(K[F[ne]]=ne);for(var re=1;re<F.length;)re<<=1;F.length=re;for(var ce={loop:p,palette:new Uint32Array(F)},be=new i.default.GifWriter(m,d.width,d.height,ce),we={},ye=function(Ee){for(var j=!M.has(Ee),W=j?[]:F,J=new Uint8Array(d.width*d.height),ie={},ve=new Set,he=0;he<g[Ee].length;he++){var Fe=g[Ee][he];j?(ie[Fe]===void 0&&(ie[Fe]=W.length,W.push(Fe)),J[he]=ie[Fe]):J[he]=K[Fe],0<Ee&&g[Ee-1][he]!==Fe&&ve.add(Fe)}var me={},Le=W.filter(function(Je){return!ve.has(Je)});if(0<Le.length){var De=Le[0],Ne=j?ie[De]:K[De];if(0<Ee){for(var rt=0;rt<g[Ee].length;rt++)g[Ee-1][rt]===g[Ee][rt]&&(J[rt]=Ne);me.transparent=Ne,we.frameOpts.disposal=1}}if(me.delay=f.frames[Ee].delay/10,j){for(var tt=1;tt<W.length;)tt<<=1;W.length=tt,me.palette=new Uint32Array(W)}0<Ee&&be.addFrame(0,0,d.width,d.height,we.pixelPaletteIndex,we.frameOpts),we={pixelPaletteIndex:J,frameOpts:me}},Oe=0;Oe<f.numFrames;Oe++)ye(Oe);we.frameOpts.disposal=1,be.addFrame(0,0,d.width,d.height,we.pixelPaletteIndex,we.frameOpts);var Se=new Blob([m.slice(0,be.end())],{type:"image/gif"});a.default.prototype.downloadFile(Se,c,"gif")},a.default.prototype.saveFrames=function(d,c,f,p,m){a.default._validateParameters("saveFrames",arguments);var g=f||3;g=a.default.prototype.constrain(g,0,15),g*=1e3;var y=p||15;y=a.default.prototype.constrain(y,0,22);var v=0,b=a.default.prototype._makeFrame,w=this._curElement.elt,_=[],I=setInterval(function(){_.push(b(d+v,c,w)),v++},1e3/y);setTimeout(function(){if(clearInterval(I),m)m(_);else{var C=!0,N=!1,O=void 0;try{for(var D,M=_[Symbol.iterator]();!(C=(D=M.next()).done);C=!0){var P=D.value;a.default.prototype.downloadFile(P.imageData,P.filename,P.ext)}}catch(F){N=!0,O=F}finally{try{C||M.return==null||M.return()}finally{if(N)throw O}}}_=[]},g+.01)},a.default.prototype._makeFrame=function(d,c,f){var p,m;if(p=this?this._curElement.elt:f,c)switch(c.toLowerCase()){case"png":m="image/png";break;case"jpeg":case"jpg":m="image/jpeg";break;default:m="image/png"}else c="png",m="image/png";var g=p.toDataURL(m);g=g.replace(m,"image/octet-stream");var y={};return y.imageData=g,y.filename=d,y.ext=c,y};var h=a.default;o.default=h},{"../core/main":264,"core-js/modules/es.array.concat":149,"core-js/modules/es.array.filter":152,"core-js/modules/es.array.from":155,"core-js/modules/es.array.iterator":158,"core-js/modules/es.array.map":161,"core-js/modules/es.array.slice":162,"core-js/modules/es.object.keys":176,"core-js/modules/es.object.to-string":177,"core-js/modules/es.regexp.exec":181,"core-js/modules/es.regexp.to-string":182,"core-js/modules/es.set":183,"core-js/modules/es.string.iterator":186,"core-js/modules/es.string.replace":189,"core-js/modules/es.string.split":191,"core-js/modules/es.symbol":196,"core-js/modules/es.symbol.description":194,"core-js/modules/es.symbol.iterator":195,"core-js/modules/es.typed-array.copy-within":197,"core-js/modules/es.typed-array.every":198,"core-js/modules/es.typed-array.fill":199,"core-js/modules/es.typed-array.filter":200,"core-js/modules/es.typed-array.find":202,"core-js/modules/es.typed-array.find-index":201,"core-js/modules/es.typed-array.for-each":205,"core-js/modules/es.typed-array.includes":206,"core-js/modules/es.typed-array.index-of":207,"core-js/modules/es.typed-array.iterator":210,"core-js/modules/es.typed-array.join":211,"core-js/modules/es.typed-array.last-index-of":212,"core-js/modules/es.typed-array.map":213,"core-js/modules/es.typed-array.reduce":215,"core-js/modules/es.typed-array.reduce-right":214,"core-js/modules/es.typed-array.reverse":216,"core-js/modules/es.typed-array.set":217,"core-js/modules/es.typed-array.slice":218,"core-js/modules/es.typed-array.some":219,"core-js/modules/es.typed-array.sort":220,"core-js/modules/es.typed-array.subarray":221,"core-js/modules/es.typed-array.to-locale-string":222,"core-js/modules/es.typed-array.to-string":223,"core-js/modules/es.typed-array.uint32-array":225,"core-js/modules/es.typed-array.uint8-array":226,"core-js/modules/web.dom-collections.iterator":229,omggif:238}],287:[function(n,s,o){function a(g){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(y){return typeof y}:function(y){return y&&typeof Symbol=="function"&&y.constructor===Symbol&&y!==Symbol.prototype?"symbol":typeof y})(g)}n("core-js/modules/es.array.includes"),n("core-js/modules/es.array.index-of"),n("core-js/modules/es.array.iterator"),n("core-js/modules/es.array.slice"),n("core-js/modules/es.object.to-string"),n("core-js/modules/es.promise"),n("core-js/modules/es.string.includes"),n("core-js/modules/es.typed-array.uint8-array"),n("core-js/modules/es.typed-array.uint8-clamped-array"),n("core-js/modules/es.typed-array.copy-within"),n("core-js/modules/es.typed-array.every"),n("core-js/modules/es.typed-array.fill"),n("core-js/modules/es.typed-array.filter"),n("core-js/modules/es.typed-array.find"),n("core-js/modules/es.typed-array.find-index"),n("core-js/modules/es.typed-array.for-each"),n("core-js/modules/es.typed-array.includes"),n("core-js/modules/es.typed-array.index-of"),n("core-js/modules/es.typed-array.iterator"),n("core-js/modules/es.typed-array.join"),n("core-js/modules/es.typed-array.last-index-of"),n("core-js/modules/es.typed-array.map"),n("core-js/modules/es.typed-array.reduce"),n("core-js/modules/es.typed-array.reduce-right"),n("core-js/modules/es.typed-array.reverse"),n("core-js/modules/es.typed-array.set"),n("core-js/modules/es.typed-array.slice"),n("core-js/modules/es.typed-array.some"),n("core-js/modules/es.typed-array.sort"),n("core-js/modules/es.typed-array.subarray"),n("core-js/modules/es.typed-array.to-locale-string"),n("core-js/modules/es.typed-array.to-string"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var i=f(n("../core/main")),l=f(n("./filters")),u=f(n("../core/helpers")),h=function(g){if(g&&g.__esModule)return g;if(g===null||a(g)!=="object"&&typeof g!="function")return{default:g};var y=c();if(y&&y.has(g))return y.get(g);var v={},b=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var w in g)if(Object.prototype.hasOwnProperty.call(g,w)){var _=b?Object.getOwnPropertyDescriptor(g,w):null;_&&(_.get||_.set)?Object.defineProperty(v,w,_):v[w]=g[w]}return v.default=g,y&&y.set(g,v),v}(n("../core/constants")),d=f(n("omggif"));function c(){if(typeof WeakMap!="function")return null;var g=new WeakMap;return c=function(){return g},g}function f(g){return g&&g.__esModule?g:{default:g}}function p(g,y){return 0<g&&g<y?g:y}n("../core/friendly_errors/validate_params"),n("../core/friendly_errors/file_errors"),n("../core/friendly_errors/fes_core"),i.default.prototype.loadImage=function(g,y,v){i.default._validateParameters("loadImage",arguments);var b=new i.default.Image(1,1,this),w=this,_=new Request(g,{method:"GET",mode:"cors"});return fetch(g,_).then(function(I){var C=I.headers.get("content-type");if(C===null&&console.warn("The image you loaded does not have a Content-Type header. If you are using the online editor consider reuploading the asset."),C&&C.includes("image/gif"))I.arrayBuffer().then(function(O){O&&function(D,M,P,F,B){var z=new d.default.GifReader(D);M.width=M.canvas.width=z.width,M.height=M.canvas.height=z.height;var Z=[],Q=z.numFrames(),K=new Uint8ClampedArray(M.width*M.height*4);if(1<Q){for(var ne=function(Se,Ee){try{Ee.decodeAndBlitFrameRGBA(Se,K)}catch(j){i.default._friendlyFileLoadError(8,M.src),typeof F=="function"?F(j):console.error(j)}},re=0;re<Q;re++){var ce=z.frameInfo(re),be=M.drawingContext.getImageData(0,0,M.width,M.height);K=be.data.slice(),ne(re,z);var we=new ImageData(K,M.width,M.height);M.drawingContext.putImageData(we,0,0);var ye=ce.delay;ye===0&&(ye=10),Z.push({image:M.drawingContext.getImageData(0,0,M.width,M.height),delay:10*ye}),ce.disposal===2?M.drawingContext.clearRect(ce.x,ce.y,ce.width,ce.height):ce.disposal===3&&M.drawingContext.putImageData(be,0,0,ce.x,ce.y,ce.width,ce.height)}var Oe=z.loopCount();Oe===null?Oe=1:Oe===0&&(Oe=null),M.drawingContext.putImageData(Z[0].image,0,0),M.gifProperties={displayIndex:0,loopLimit:Oe,loopCount:0,frames:Z,numFrames:Q,playing:!0,timeDisplayed:0,lastChangeTime:0}}typeof P=="function"&&P(M),B()}(new Uint8Array(O),b,y,v,function(D){w._decrementPreload()}.bind(w))},function(O){typeof v=="function"?v(O):console.error(O)});else{var N=new Image;N.onload=function(){b.width=b.canvas.width=N.width,b.height=b.canvas.height=N.height,b.drawingContext.drawImage(N,0,0),b.modified=!0,typeof y=="function"&&y(b),w._decrementPreload()},N.onerror=function(O){i.default._friendlyFileLoadError(0,N.src),typeof v=="function"?v(O):console.error(O)},g.indexOf("data:image/")!==0&&(N.crossOrigin="Anonymous"),N.src=g}b.modified=!0}).catch(function(I){i.default._friendlyFileLoadError(0,g),typeof v=="function"?v(I):console.error(I)}),b},i.default.prototype.image=function(g,y,v,b,w,_,I,C,N){i.default._validateParameters("image",arguments);var O=g.width,D=g.height;g.elt&&g.elt.videoWidth&&!g.canvas&&(O=g.elt.videoWidth,D=g.elt.videoHeight);var M=y,P=v,F=b||O,B=w||D,z=_||0,Z=I||0,Q=C||O,K=N||D;Q=p(Q,O),K=p(K,D);var ne=1;g.elt&&!g.canvas&&g.elt.style.width&&(ne=g.elt.videoWidth&&!b?g.elt.videoWidth:g.elt.width,ne/=parseInt(g.elt.style.width,10)),z*=ne,Z*=ne,K*=ne,Q*=ne;var re=u.default.modeAdjust(M,P,F,B,this._renderer._imageMode);this._renderer.image(g,z,Z,Q,K,re.x,re.y,re.w,re.h)},i.default.prototype.tint=function(){for(var g=arguments.length,y=new Array(g),v=0;v<g;v++)y[v]=arguments[v];i.default._validateParameters("tint",y);var b=this.color.apply(this,y);this._renderer._tint=b.levels},i.default.prototype.noTint=function(){this._renderer._tint=null},i.default.prototype._getTintedImageCanvas=function(g){if(!g.canvas)return g;var y=l.default._toPixels(g.canvas),v=document.createElement("canvas");v.width=g.canvas.width,v.height=g.canvas.height;for(var b=v.getContext("2d"),w=b.createImageData(g.canvas.width,g.canvas.height),_=w.data,I=0;I<y.length;I+=4){var C=y[I],N=y[I+1],O=y[I+2],D=y[I+3];_[I]=C*this._renderer._tint[0]/255,_[I+1]=N*this._renderer._tint[1]/255,_[I+2]=O*this._renderer._tint[2]/255,_[I+3]=D*this._renderer._tint[3]/255}return b.putImageData(w,0,0),v},i.default.prototype.imageMode=function(g){i.default._validateParameters("imageMode",arguments),g!==h.CORNER&&g!==h.CORNERS&&g!==h.CENTER||(this._renderer._imageMode=g)};var m=i.default;o.default=m},{"../core/constants":253,"../core/friendly_errors/fes_core":255,"../core/friendly_errors/file_errors":256,"../core/friendly_errors/validate_params":259,"../core/helpers":260,"../core/main":264,"./filters":285,"core-js/modules/es.array.includes":156,"core-js/modules/es.array.index-of":157,"core-js/modules/es.array.iterator":158,"core-js/modules/es.array.slice":162,"core-js/modules/es.object.to-string":177,"core-js/modules/es.promise":178,"core-js/modules/es.string.includes":185,"core-js/modules/es.typed-array.copy-within":197,"core-js/modules/es.typed-array.every":198,"core-js/modules/es.typed-array.fill":199,"core-js/modules/es.typed-array.filter":200,"core-js/modules/es.typed-array.find":202,"core-js/modules/es.typed-array.find-index":201,"core-js/modules/es.typed-array.for-each":205,"core-js/modules/es.typed-array.includes":206,"core-js/modules/es.typed-array.index-of":207,"core-js/modules/es.typed-array.iterator":210,"core-js/modules/es.typed-array.join":211,"core-js/modules/es.typed-array.last-index-of":212,"core-js/modules/es.typed-array.map":213,"core-js/modules/es.typed-array.reduce":215,"core-js/modules/es.typed-array.reduce-right":214,"core-js/modules/es.typed-array.reverse":216,"core-js/modules/es.typed-array.set":217,"core-js/modules/es.typed-array.slice":218,"core-js/modules/es.typed-array.some":219,"core-js/modules/es.typed-array.sort":220,"core-js/modules/es.typed-array.subarray":221,"core-js/modules/es.typed-array.to-locale-string":222,"core-js/modules/es.typed-array.to-string":223,"core-js/modules/es.typed-array.uint8-array":226,"core-js/modules/es.typed-array.uint8-clamped-array":227,omggif:238}],288:[function(n,s,o){n("core-js/modules/es.symbol"),n("core-js/modules/es.symbol.description"),n("core-js/modules/es.symbol.iterator"),n("core-js/modules/es.array.filter"),n("core-js/modules/es.array.iterator"),n("core-js/modules/es.object.to-string"),n("core-js/modules/es.string.iterator"),n("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var a=l(n("../core/main")),i=l(n("./filters"));function l(h){return h&&h.__esModule?h:{default:h}}a.default.Image=function(h,d){this.width=h,this.height=d,this.canvas=document.createElement("canvas"),this.canvas.width=this.width,this.canvas.height=this.height,this.drawingContext=this.canvas.getContext("2d"),(this._pixelsState=this)._pixelDensity=1,this.gifProperties=null,this._modified=!1,this.pixels=[]},a.default.Image.prototype._animateGif=function(h){var d=this.gifProperties,c=h._lastFrameTime;if(d.lastChangeTime===0&&(d.lastChangeTime=c),d.playing){d.timeDisplayed=c-d.lastChangeTime;var f=d.frames[d.displayIndex].delay;if(d.timeDisplayed>=f){var p=Math.floor(d.timeDisplayed/f);if(d.timeDisplayed=0,d.lastChangeTime=c,d.displayIndex+=p,d.loopCount=Math.floor(d.displayIndex/d.numFrames),d.loopLimit!==null&&d.loopCount>=d.loopLimit)d.playing=!1;else{var m=d.displayIndex%d.numFrames;this.drawingContext.putImageData(d.frames[m].image,0,0),d.displayIndex=m,this.setModified(!0)}}}},a.default.Image.prototype._setProperty=function(h,d){this[h]=d,this.setModified(!0)},a.default.Image.prototype.loadPixels=function(){a.default.Renderer2D.prototype.loadPixels.call(this),this.setModified(!0)},a.default.Image.prototype.updatePixels=function(h,d,c,f){a.default.Renderer2D.prototype.updatePixels.call(this,h,d,c,f),this.setModified(!0)},a.default.Image.prototype.get=function(h,d,c,f){return a.default._validateParameters("p5.Image.get",arguments),a.default.Renderer2D.prototype.get.apply(this,arguments)},a.default.Image.prototype._getPixel=a.default.Renderer2D.prototype._getPixel,a.default.Image.prototype.set=function(h,d,c){a.default.Renderer2D.prototype.set.call(this,h,d,c),this.setModified(!0)},a.default.Image.prototype.resize=function(h,d){h===0&&d===0?(h=this.canvas.width,d=this.canvas.height):h===0?h=this.canvas.width*d/this.canvas.height:d===0&&(d=this.canvas.height*h/this.canvas.width),h=Math.floor(h),d=Math.floor(d);var c=document.createElement("canvas");if(c.width=h,c.height=d,this.gifProperties)for(var f=this.gifProperties,p=function(y,v){for(var b=0,w=0;w<v.height;w++)for(var _=0;_<v.width;_++){var I=Math.floor(_*y.width/v.width),C=4*(Math.floor(w*y.height/v.height)*y.width+I);v.data[b++]=y.data[C++],v.data[b++]=y.data[C++],v.data[b++]=y.data[C++],v.data[b++]=y.data[C++]}},m=0;m<f.numFrames;m++){var g=this.drawingContext.createImageData(h,d);p(f.frames[m].image,g),f.frames[m].image=g}c.getContext("2d").drawImage(this.canvas,0,0,this.canvas.width,this.canvas.height,0,0,c.width,c.height),this.canvas.width=this.width=h,this.canvas.height=this.height=d,this.drawingContext.drawImage(c,0,0,h,d,0,0,h,d),0<this.pixels.length&&this.loadPixels(),this.setModified(!0)},a.default.Image.prototype.copy=function(){for(var h=arguments.length,d=new Array(h),c=0;c<h;c++)d[c]=arguments[c];a.default.prototype.copy.apply(this,d)},a.default.Image.prototype.mask=function(h){h===void 0&&(h=this);var d=this.drawingContext.globalCompositeOperation,c=1;h instanceof a.default.Renderer&&(c=h._pInst._pixelDensity);var f=[h,0,0,c*h.width,c*h.height,0,0,this.width,this.height];this.drawingContext.globalCompositeOperation="destination-in",a.default.Image.prototype.copy.apply(this,f),this.drawingContext.globalCompositeOperation=d,this.setModified(!0)},a.default.Image.prototype.filter=function(h,d){i.default.apply(this.canvas,i.default[h],d),this.setModified(!0)},a.default.Image.prototype.blend=function(){for(var h=arguments.length,d=new Array(h),c=0;c<h;c++)d[c]=arguments[c];a.default._validateParameters("p5.Image.blend",arguments),a.default.prototype.blend.apply(this,d),this.setModified(!0)},a.default.Image.prototype.setModified=function(h){this._modified=h},a.default.Image.prototype.isModified=function(){return this._modified},a.default.Image.prototype.save=function(h,d){this.gifProperties?a.default.prototype.saveGif(this,h):a.default.prototype.saveCanvas(this.canvas,h,d)},a.default.Image.prototype.reset=function(){if(this.gifProperties){var h=this.gifProperties;h.playing=!0,h.timeSinceStart=0,h.timeDisplayed=0,h.lastChangeTime=0,h.loopCount=0,h.displayIndex=0,this.drawingContext.putImageData(h.frames[0].image,0,0)}},a.default.Image.prototype.getCurrentFrame=function(){if(this.gifProperties){var h=this.gifProperties;return h.displayIndex%h.numFrames}},a.default.Image.prototype.setFrame=function(h){if(this.gifProperties){var d=this.gifProperties;h<d.numFrames&&0<=h?(d.timeDisplayed=0,d.lastChangeTime=0,d.displayIndex=h,this.drawingContext.putImageData(d.frames[h].image,0,0)):console.log("Cannot set GIF to a frame number that is higher than total number of frames or below zero.")}},a.default.Image.prototype.numFrames=function(){if(this.gifProperties)return this.gifProperties.numFrames},a.default.Image.prototype.play=function(){this.gifProperties&&(this.gifProperties.playing=!0)},a.default.Image.prototype.pause=function(){this.gifProperties&&(this.gifProperties.playing=!1)},a.default.Image.prototype.delay=function(h,d){if(this.gifProperties){var c=this.gifProperties;if(d<c.numFrames&&0<=d)c.frames[d].delay=h;else{var f=!0,p=!1,m=void 0;try{for(var g,y=c.frames[Symbol.iterator]();!(f=(g=y.next()).done);f=!0)g.value.delay=h}catch(v){p=!0,m=v}finally{try{f||y.return==null||y.return()}finally{if(p)throw m}}}}};var u=a.default.Image;o.default=u},{"../core/main":264,"./filters":285,"core-js/modules/es.array.filter":152,"core-js/modules/es.array.iterator":158,"core-js/modules/es.object.to-string":177,"core-js/modules/es.string.iterator":186,"core-js/modules/es.symbol":196,"core-js/modules/es.symbol.description":194,"core-js/modules/es.symbol.iterator":195,"core-js/modules/web.dom-collections.iterator":229}],289:[function(n,s,o){n("core-js/modules/es.array.filter"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var a=l(n("../core/main")),i=l(n("./filters"));function l(h){return h&&h.__esModule?h:{default:h}}n("../color/p5.Color"),a.default.prototype.pixels=[],a.default.prototype.blend=function(){for(var h=arguments.length,d=new Array(h),c=0;c<h;c++)d[c]=arguments[c];var f;a.default._validateParameters("blend",d),this._renderer?(f=this._renderer).blend.apply(f,d):a.default.Renderer2D.prototype.blend.apply(this,d)},a.default.prototype.copy=function(){for(var h=arguments.length,d=new Array(h),c=0;c<h;c++)d[c]=arguments[c];var f,p,m,g,y,v,b,w,_;if(a.default._validateParameters("copy",d),d.length===9)f=d[0],p=d[1],m=d[2],g=d[3],y=d[4],v=d[5],b=d[6],w=d[7],_=d[8];else{if(d.length!==8)throw new Error("Signature not supported");f=this,p=d[0],m=d[1],g=d[2],y=d[3],v=d[4],b=d[5],w=d[6],_=d[7]}a.default.prototype._copyHelper(this,f,p,m,g,y,v,b,w,_)},a.default.prototype._copyHelper=function(h,d,c,f,p,m,g,y,v,b){d.loadPixels();var w=d.canvas.width/d.width,_=0,I=0;d._renderer&&d._renderer.isP3D&&(_=d.width/2,I=d.height/2),h._renderer&&h._renderer.isP3D?a.default.RendererGL.prototype.image.call(h._renderer,d,c+_,f+I,p,m,g,y,v,b):h.drawingContext.drawImage(d.canvas,w*(c+_),w*(f+I),w*p,w*m,g,y,v,b)},a.default.prototype.filter=function(h,d){a.default._validateParameters("filter",arguments),this.canvas!==void 0?i.default.apply(this.canvas,i.default[h],d):i.default.apply(this.elt,i.default[h],d)},a.default.prototype.get=function(h,d,c,f){var p;return a.default._validateParameters("get",arguments),(p=this._renderer).get.apply(p,arguments)},a.default.prototype.loadPixels=function(){for(var h=arguments.length,d=new Array(h),c=0;c<h;c++)d[c]=arguments[c];a.default._validateParameters("loadPixels",d),this._renderer.loadPixels()},a.default.prototype.set=function(h,d,c){this._renderer.set(h,d,c)},a.default.prototype.updatePixels=function(h,d,c,f){a.default._validateParameters("updatePixels",arguments),this.pixels.length!==0&&this._renderer.updatePixels(h,d,c,f)};var u=a.default;o.default=u},{"../color/p5.Color":251,"../core/main":264,"./filters":285,"core-js/modules/es.array.filter":152}],290:[function(n,s,o){n("core-js/modules/es.symbol"),n("core-js/modules/es.symbol.description"),n("core-js/modules/es.symbol.iterator"),n("core-js/modules/es.array.concat"),n("core-js/modules/es.array.includes"),n("core-js/modules/es.array.index-of"),n("core-js/modules/es.array.iterator"),n("core-js/modules/es.array.last-index-of"),n("core-js/modules/es.array.slice"),n("core-js/modules/es.array.splice"),n("core-js/modules/es.function.name"),n("core-js/modules/es.object.to-string"),n("core-js/modules/es.promise"),n("core-js/modules/es.regexp.exec"),n("core-js/modules/es.regexp.to-string"),n("core-js/modules/es.string.includes"),n("core-js/modules/es.string.iterator"),n("core-js/modules/es.string.replace"),n("core-js/modules/es.string.split"),n("core-js/modules/es.typed-array.uint8-array"),n("core-js/modules/es.typed-array.copy-within"),n("core-js/modules/es.typed-array.every"),n("core-js/modules/es.typed-array.fill"),n("core-js/modules/es.typed-array.filter"),n("core-js/modules/es.typed-array.find"),n("core-js/modules/es.typed-array.find-index"),n("core-js/modules/es.typed-array.for-each"),n("core-js/modules/es.typed-array.includes"),n("core-js/modules/es.typed-array.index-of"),n("core-js/modules/es.typed-array.iterator"),n("core-js/modules/es.typed-array.join"),n("core-js/modules/es.typed-array.last-index-of"),n("core-js/modules/es.typed-array.map"),n("core-js/modules/es.typed-array.reduce"),n("core-js/modules/es.typed-array.reduce-right"),n("core-js/modules/es.typed-array.reverse"),n("core-js/modules/es.typed-array.set"),n("core-js/modules/es.typed-array.slice"),n("core-js/modules/es.typed-array.some"),n("core-js/modules/es.typed-array.sort"),n("core-js/modules/es.typed-array.subarray"),n("core-js/modules/es.typed-array.to-locale-string"),n("core-js/modules/es.typed-array.to-string"),n("core-js/modules/web.dom-collections.iterator"),n("core-js/modules/web.url"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var a=u(n("../core/main"));n("whatwg-fetch"),n("es6-promise/auto");var i=u(n("fetch-jsonp")),l=u(n("file-saver"));function u(m){return m&&m.__esModule?m:{default:m}}function h(m){return(h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(g){return typeof g}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g})(m)}function d(m,g){var y={};if((g=g||[])===void 0)for(var v=0;v<m.length;v++)g[v.toString()]=v;for(var b=0;b<g.length;b++){var w=g[b],_=m[b];y[w]=_}return y}function c(m){return m.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}function f(m,g){g&&g!==!0&&g!=="true"||(g="");var y="";return(m=m||"untitled")&&m.includes(".")&&(y=m.split(".").pop()),g&&y!==g&&(y=g,m="".concat(m,".").concat(y)),[m,y]}n("../core/friendly_errors/validate_params"),n("../core/friendly_errors/file_errors"),n("../core/friendly_errors/fes_core"),a.default.prototype.loadJSON=function(){for(var m=arguments.length,g=new Array(m),y=0;y<m;y++)g[y]=arguments[y];a.default._validateParameters("loadJSON",g);for(var v,b,w,_=g[0],I={},C="json",N=1;N<g.length;N++){var O=g[N];typeof O=="string"?O!=="jsonp"&&O!=="json"||(C=O):typeof O=="function"?v?b=O:v=O:h(O)==="object"&&(O.hasOwnProperty("jsonpCallback")||O.hasOwnProperty("jsonpCallbackFunction"))&&(C="jsonp",w=O)}var D=this;return this.httpDo(_,"GET",w,C,function(M){for(var P in M)I[P]=M[P];v!==void 0&&v(M),D._decrementPreload()},function(M){if(a.default._friendlyFileLoadError(5,_),!b)throw M;b(M)}),I},a.default.prototype.loadStrings=function(){for(var m=arguments.length,g=new Array(m),y=0;y<m;y++)g[y]=arguments[y];a.default._validateParameters("loadStrings",g);for(var v,b,w=[],_=1;_<g.length;_++){var I=g[_];typeof I=="function"&&(v===void 0?v=I:b===void 0&&(b=I))}var C=this;return a.default.prototype.httpDo.call(this,g[0],"GET","text",function(N){for(var O=N.replace(/\r\n/g,"\r").replace(/\n/g,"\r").split(/\r/),D=0,M=O.length;D<M;D+=32768)Array.prototype.push.apply(w,O.slice(D,Math.min(D+32768,M)));v!==void 0&&v(w),C._decrementPreload()},function(N){if(a.default._friendlyFileLoadError(3,N),!b)throw N;b(N)}),w},a.default.prototype.loadTable=function(m){var g,y,v,b=!1,w=m.substring(m.lastIndexOf(".")+1,m.length);w==="csv"?v=",":w==="ssv"?v=";":w==="tsv"&&(v="	");for(var _=1;_<arguments.length;_++)typeof arguments[_]=="function"?g===void 0?g=arguments[_]:y===void 0&&(y=arguments[_]):typeof arguments[_]=="string"&&(arguments[_]==="header"&&(b=!0),arguments[_]==="csv"?v=",":arguments[_]==="ssv"?v=";":arguments[_]==="tsv"&&(v="	"));var I=new a.default.Table,C=this;return this.httpDo(m,"GET","table",function(N){for(var O,D,M={},P=[],F=0,B=null,z=function(){M.currentState=0,M.token=""},Z=function(){B.push(M.token),z()},Q=function(){M.currentState=4,P.push(B),B=null};;){if((O=N[F++])==null){if(M.escaped)throw new Error("Unclosed quote in file.");if(B){Z(),Q();break}}if(B===null&&(M.escaped=!1,B=[],z()),M.currentState===0){if(O==='"'){M.escaped=!0,M.currentState=1;continue}M.currentState=1}if(M.currentState===1&&M.escaped)if(O==='"')N[F]==='"'?(M.token+='"',F++):(M.escaped=!1,M.currentState=2);else{if(O==="\r")continue;M.token+=O}else O==="\r"?(N[F]===`
`&&F++,Z(),Q()):O===`
`?(Z(),Q()):O===v?Z():M.currentState===1&&(M.token+=O)}if(b)I.columns=P.shift();else for(var K=0;K<P[0].length;K++)I.columns[K]="null";for(var ne=0;ne<P.length;ne++)(P[ne].length!==1||P[ne][0]!=="undefined"&&P[ne][0]!=="")&&((D=new a.default.TableRow).arr=P[ne],D.obj=d(P[ne],I.columns),I.addRow(D));typeof g=="function"&&g(I),C._decrementPreload()},function(N){a.default._friendlyFileLoadError(2,m),y?y(N):console.error(N)}),I},a.default.prototype.loadXML=function(){for(var m=arguments.length,g=new Array(m),y=0;y<m;y++)g[y]=arguments[y];for(var v,b,w=new a.default.XML,_=1;_<g.length;_++){var I=g[_];typeof I=="function"&&(v===void 0?v=I:b===void 0&&(b=I))}var C=this;return this.httpDo(g[0],"GET","xml",function(N){for(var O in N)w[O]=N[O];v!==void 0&&v(w),C._decrementPreload()},function(N){if(a.default._friendlyFileLoadError(1,N),!b)throw N;b(N)}),w},a.default.prototype.loadBytes=function(m,g,y){var v={},b=this;return this.httpDo(m,"GET","arrayBuffer",function(w){v.bytes=new Uint8Array(w),typeof g=="function"&&g(v),b._decrementPreload()},function(w){if(a.default._friendlyFileLoadError(6,m),!y)throw w;y(w)}),v},a.default.prototype.httpGet=function(){a.default._validateParameters("httpGet",arguments);var m=Array.prototype.slice.call(arguments);return m.splice(1,0,"GET"),a.default.prototype.httpDo.apply(this,m)},a.default.prototype.httpPost=function(){a.default._validateParameters("httpPost",arguments);var m=Array.prototype.slice.call(arguments);return m.splice(1,0,"POST"),a.default.prototype.httpDo.apply(this,m)},a.default.prototype.httpDo=function(){for(var m,g,y,v,b,w={},_=0,I="text/plain",C=arguments.length-1;0<C&&typeof(C<0||arguments.length<=C?void 0:arguments[C])=="function";C--)_++;var N=arguments.length<=0?void 0:arguments[0];if(arguments.length-_==2&&typeof N=="string"&&h(arguments.length<=1?void 0:arguments[1])==="object")v=new Request(N,arguments.length<=1?void 0:arguments[1]),g=arguments.length<=2?void 0:arguments[2],y=arguments.length<=3?void 0:arguments[3];else{for(var O,D="GET",M=1;M<arguments.length;M++){var P=M<0||arguments.length<=M?void 0:arguments[M];if(typeof P=="string")P==="GET"||P==="POST"||P==="PUT"||P==="DELETE"?D=P:P==="json"||P==="jsonp"||P==="binary"||P==="arrayBuffer"||P==="xml"||P==="text"||P==="table"?m=P:O=P;else if(typeof P=="number")O=P.toString();else if(h(P)==="object")if(P.hasOwnProperty("jsonpCallback")||P.hasOwnProperty("jsonpCallbackFunction"))for(var F in P)w[F]=P[F];else I=P instanceof a.default.XML?(O=P.serialize(),"application/xml"):(O=JSON.stringify(P),"application/json");else typeof P=="function"&&(g?y=P:g=P)}var B=D==="GET"?new Headers:new Headers({"Content-Type":I});v=new Request(N,{method:D,mode:"cors",body:O,headers:B})}return(b=(b=(m=m||(N.includes("json")?"json":N.includes("xml")?"xml":"text"))==="jsonp"?(0,i.default)(N,w):fetch(v)).then(function(z){if(!z.ok){var Z=new Error(z.body);throw Z.status=z.status,Z.ok=!1,Z}var Q=0;switch(m!=="jsonp"&&(Q=z.headers.get("content-length")),Q&&64e6<Q&&a.default._friendlyFileLoadError(7,N),m){case"json":case"jsonp":return z.json();case"binary":return z.blob();case"arrayBuffer":return z.arrayBuffer();case"xml":return z.text().then(function(K){var ne=new DOMParser().parseFromString(K,"text/xml");return new a.default.XML(ne.documentElement)});default:return z.text()}})).then(g||function(){}),b.catch(y||console.error),b},window.URL=window.URL||window.webkitURL,a.default.prototype._pWriters=[],a.default.prototype.createWriter=function(m,g){var y;for(var v in a.default.prototype._pWriters)if(a.default.prototype._pWriters[v].name===m)return y=new a.default.PrintWriter(m+this.millis(),g),a.default.prototype._pWriters.push(y),y;return y=new a.default.PrintWriter(m,g),a.default.prototype._pWriters.push(y),y},a.default.PrintWriter=function(m,g){var y=this;this.name=m,this.content="",this.write=function(v){this.content+=v},this.print=function(v){this.content+="".concat(v,`
`)},this.clear=function(){this.content=""},this.close=function(){var v=[];for(var b in v.push(this.content),a.default.prototype.writeFile(v,m,g),a.default.prototype._pWriters)a.default.prototype._pWriters[b].name===this.name&&a.default.prototype._pWriters.splice(b,1);y.clear(),y={}}},a.default.prototype.save=function(m,g,y){var v=arguments,b=this._curElement?this._curElement.elt:this.elt;if(v.length!==0)if(v[0]instanceof a.default.Renderer||v[0]instanceof a.default.Graphics)a.default.prototype.saveCanvas(v[0].elt,v[1],v[2]);else if(v.length===1&&typeof v[0]=="string")a.default.prototype.saveCanvas(b,v[0]);else switch(f(v[1],v[2])[1]){case"json":return void a.default.prototype.saveJSON(v[0],v[1],v[2]);case"txt":return void a.default.prototype.saveStrings(v[0],v[1],v[2]);default:v[0]instanceof Array?a.default.prototype.saveStrings(v[0],v[1],v[2]):v[0]instanceof a.default.Table?a.default.prototype.saveTable(v[0],v[1],v[2]):v[0]instanceof a.default.Image?a.default.prototype.saveCanvas(v[0].canvas,v[1]):v[0]instanceof a.default.SoundFile&&a.default.prototype.saveSound(v[0],v[1],v[2],v[3])}else a.default.prototype.saveCanvas(b)},a.default.prototype.saveJSON=function(m,g,y){var v;a.default._validateParameters("saveJSON",arguments),v=y?JSON.stringify(m):JSON.stringify(m,void 0,2),this.saveStrings(v.split(`
`),g,"json")},a.default.prototype.saveJSONObject=a.default.prototype.saveJSON,a.default.prototype.saveJSONArray=a.default.prototype.saveJSON,a.default.prototype.saveStrings=function(m,g,y,v){a.default._validateParameters("saveStrings",arguments);for(var b=y||"txt",w=this.createWriter(g,b),_=0;_<m.length;_++)v?w.write(m[_]+`\r
`):w.write(m[_]+`
`);w.close(),w.clear()},a.default.prototype.saveTable=function(m,g,y){var v;a.default._validateParameters("saveTable",arguments),v=y===void 0?g.substring(g.lastIndexOf(".")+1,g.length):y;var b=this.createWriter(g,v),w=m.columns,_=",";if(v==="tsv"&&(_="	"),v!=="html"){if(w[0]!=="0"){for(var I=0;I<w.length;I++)I<w.length-1?b.write(w[I]+_):b.write(w[I]);b.write(`
`)}for(var C=0;C<m.rows.length;C++){var N=void 0;for(N=0;N<m.rows[C].arr.length;N++)N<m.rows[C].arr.length-1?v==="csv"&&String(m.rows[C].arr[N]).includes(",")?b.write('"'+m.rows[C].arr[N]+'"'+_):b.write(m.rows[C].arr[N]+_):v==="csv"&&String(m.rows[C].arr[N]).includes(",")?b.write('"'+m.rows[C].arr[N]+'"'):b.write(m.rows[C].arr[N]);b.write(`
`)}}else{if(b.print("<html>"),b.print("<head>"),b.print('  <meta http-equiv="content-type" content="text/html;charset=utf-8" />'),b.print("</head>"),b.print("<body>"),b.print("  <table>"),w[0]!=="0"){b.print("    <tr>");for(var O=0;O<w.length;O++){var D=c(w[O]);b.print("      <td>".concat(D)),b.print("      </td>")}b.print("    </tr>")}for(var M=0;M<m.rows.length;M++){b.print("    <tr>");for(var P=0;P<m.columns.length;P++){var F=c(m.rows[M].getString(P));b.print("      <td>".concat(F)),b.print("      </td>")}b.print("    </tr>")}b.print("  </table>"),b.print("</body>"),b.print("</html>")}b.close(),b.clear()},a.default.prototype.writeFile=function(m,g,y){var v="application/octet-stream";a.default.prototype._isSafari()&&(v="text/plain");var b=new Blob(m,{type:v});a.default.prototype.downloadFile(b,g,y)},a.default.prototype.downloadFile=function(m,g,y){var v=f(g,y),b=v[0];if(m instanceof Blob)l.default.saveAs(m,b);else{var w=document.createElement("a");if(w.href=m,w.download=b,w.onclick=function(I){var C;C=I,document.body.removeChild(C.target),I.stopPropagation()},w.style.display="none",document.body.appendChild(w),a.default.prototype._isSafari()){var _=`Hello, Safari user! To download this file...
`;_+=`1. Go to File --> Save As.
`,_+=`2. Choose "Page Source" as the Format.
`,_+='3. Name it with this extension: ."'.concat(v[1],'"'),alert(_)}w.click()}},a.default.prototype._checkFileExtension=f,a.default.prototype._isSafari=function(){return 0<Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")};var p=a.default;o.default=p},{"../core/friendly_errors/fes_core":255,"../core/friendly_errors/file_errors":256,"../core/friendly_errors/validate_params":259,"../core/main":264,"core-js/modules/es.array.concat":149,"core-js/modules/es.array.includes":156,"core-js/modules/es.array.index-of":157,"core-js/modules/es.array.iterator":158,"core-js/modules/es.array.last-index-of":160,"core-js/modules/es.array.slice":162,"core-js/modules/es.array.splice":164,"core-js/modules/es.function.name":166,"core-js/modules/es.object.to-string":177,"core-js/modules/es.promise":178,"core-js/modules/es.regexp.exec":181,"core-js/modules/es.regexp.to-string":182,"core-js/modules/es.string.includes":185,"core-js/modules/es.string.iterator":186,"core-js/modules/es.string.replace":189,"core-js/modules/es.string.split":191,"core-js/modules/es.symbol":196,"core-js/modules/es.symbol.description":194,"core-js/modules/es.symbol.iterator":195,"core-js/modules/es.typed-array.copy-within":197,"core-js/modules/es.typed-array.every":198,"core-js/modules/es.typed-array.fill":199,"core-js/modules/es.typed-array.filter":200,"core-js/modules/es.typed-array.find":202,"core-js/modules/es.typed-array.find-index":201,"core-js/modules/es.typed-array.for-each":205,"core-js/modules/es.typed-array.includes":206,"core-js/modules/es.typed-array.index-of":207,"core-js/modules/es.typed-array.iterator":210,"core-js/modules/es.typed-array.join":211,"core-js/modules/es.typed-array.last-index-of":212,"core-js/modules/es.typed-array.map":213,"core-js/modules/es.typed-array.reduce":215,"core-js/modules/es.typed-array.reduce-right":214,"core-js/modules/es.typed-array.reverse":216,"core-js/modules/es.typed-array.set":217,"core-js/modules/es.typed-array.slice":218,"core-js/modules/es.typed-array.some":219,"core-js/modules/es.typed-array.sort":220,"core-js/modules/es.typed-array.subarray":221,"core-js/modules/es.typed-array.to-locale-string":222,"core-js/modules/es.typed-array.to-string":223,"core-js/modules/es.typed-array.uint8-array":226,"core-js/modules/web.dom-collections.iterator":229,"core-js/modules/web.url":231,"es6-promise/auto":232,"fetch-jsonp":234,"file-saver":235,"whatwg-fetch":242}],291:[function(n,s,o){n("core-js/modules/es.array.concat"),n("core-js/modules/es.array.index-of"),n("core-js/modules/es.array.join"),n("core-js/modules/es.array.splice"),n("core-js/modules/es.regexp.constructor"),n("core-js/modules/es.regexp.exec"),n("core-js/modules/es.regexp.to-string"),n("core-js/modules/es.string.match"),n("core-js/modules/es.string.replace"),n("core-js/modules/es.string.trim"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var a,i=(a=n("../core/main"))&&a.__esModule?a:{default:a};i.default.Table=function(u){this.columns=[],this.rows=[]},i.default.Table.prototype.addRow=function(u){var h=u||new i.default.TableRow;if(h.arr===void 0||h.obj===void 0)throw new Error("invalid TableRow: ".concat(h));return(h.table=this).rows.push(h),h},i.default.Table.prototype.removeRow=function(u){this.rows[u].table=null;var h=this.rows.splice(u+1,this.rows.length);this.rows.pop(),this.rows=this.rows.concat(h)},i.default.Table.prototype.getRow=function(u){return this.rows[u]},i.default.Table.prototype.getRows=function(){return this.rows},i.default.Table.prototype.findRow=function(u,h){if(typeof h=="string"){for(var d=0;d<this.rows.length;d++)if(this.rows[d].obj[h]===u)return this.rows[d]}else for(var c=0;c<this.rows.length;c++)if(this.rows[c].arr[h]===u)return this.rows[c];return null},i.default.Table.prototype.findRows=function(u,h){var d=[];if(typeof h=="string")for(var c=0;c<this.rows.length;c++)this.rows[c].obj[h]===u&&d.push(this.rows[c]);else for(var f=0;f<this.rows.length;f++)this.rows[f].arr[h]===u&&d.push(this.rows[f]);return d},i.default.Table.prototype.matchRow=function(u,h){if(typeof h=="number"){for(var d=0;d<this.rows.length;d++)if(this.rows[d].arr[h].match(u))return this.rows[d]}else for(var c=0;c<this.rows.length;c++)if(this.rows[c].obj[h].match(u))return this.rows[c];return null},i.default.Table.prototype.matchRows=function(u,h){var d=[];if(typeof h=="number")for(var c=0;c<this.rows.length;c++)this.rows[c].arr[h].match(u)&&d.push(this.rows[c]);else for(var f=0;f<this.rows.length;f++)this.rows[f].obj[h].match(u)&&d.push(this.rows[f]);return d},i.default.Table.prototype.getColumn=function(u){var h=[];if(typeof u=="string")for(var d=0;d<this.rows.length;d++)h.push(this.rows[d].obj[u]);else for(var c=0;c<this.rows.length;c++)h.push(this.rows[c].arr[u]);return h},i.default.Table.prototype.clearRows=function(){delete this.rows,this.rows=[]},i.default.Table.prototype.addColumn=function(u){var h=u||null;this.columns.push(h)},i.default.Table.prototype.getColumnCount=function(){return this.columns.length},i.default.Table.prototype.getRowCount=function(){return this.rows.length},i.default.Table.prototype.removeTokens=function(u,h){for(var d=[],c=0;c<u.length;c++)d.push(u.charAt(c).replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"));var f=new RegExp(d.join("|"),"g");if(h===void 0)for(var p=0;p<this.columns.length;p++)for(var m=0;m<this.rows.length;m++){var g=this.rows[m].arr[p];g=g.replace(f,""),this.rows[m].arr[p]=g,this.rows[m].obj[this.columns[p]]=g}else if(typeof h=="string")for(var y=0;y<this.rows.length;y++){var v=this.rows[y].obj[h];v=v.replace(f,""),this.rows[y].obj[h]=v;var b=this.columns.indexOf(h);this.rows[y].arr[b]=v}else for(var w=0;w<this.rows.length;w++){var _=this.rows[w].arr[h];_=_.replace(f,""),this.rows[w].arr[h]=_,this.rows[w].obj[this.columns[h]]=_}},i.default.Table.prototype.trim=function(u){var h=new RegExp(" ","g");if(u===void 0)for(var d=0;d<this.columns.length;d++)for(var c=0;c<this.rows.length;c++){var f=this.rows[c].arr[d];f=f.replace(h,""),this.rows[c].arr[d]=f,this.rows[c].obj[this.columns[d]]=f}else if(typeof u=="string")for(var p=0;p<this.rows.length;p++){var m=this.rows[p].obj[u];m=m.replace(h,""),this.rows[p].obj[u]=m;var g=this.columns.indexOf(u);this.rows[p].arr[g]=m}else for(var y=0;y<this.rows.length;y++){var v=this.rows[y].arr[u];v=v.replace(h,""),this.rows[y].arr[u]=v,this.rows[y].obj[this.columns[u]]=v}},i.default.Table.prototype.removeColumn=function(u){var h,d;typeof u=="string"?(h=u,d=this.columns.indexOf(u)):(d=u,h=this.columns[u]);var c=this.columns.splice(d+1,this.columns.length);this.columns.pop(),this.columns=this.columns.concat(c);for(var f=0;f<this.rows.length;f++){var p=this.rows[f].arr,m=p.splice(d+1,p.length);p.pop(),this.rows[f].arr=p.concat(m),delete this.rows[f].obj[h]}},i.default.Table.prototype.set=function(u,h,d){this.rows[u].set(h,d)},i.default.Table.prototype.setNum=function(u,h,d){this.rows[u].setNum(h,d)},i.default.Table.prototype.setString=function(u,h,d){this.rows[u].setString(h,d)},i.default.Table.prototype.get=function(u,h){return this.rows[u].get(h)},i.default.Table.prototype.getNum=function(u,h){return this.rows[u].getNum(h)},i.default.Table.prototype.getString=function(u,h){return this.rows[u].getString(h)},i.default.Table.prototype.getObject=function(u){for(var h,d={},c=0;c<this.rows.length;c++)if(h=this.rows[c].obj,typeof u=="string"){if(!(0<=this.columns.indexOf(u)))throw new Error('This table has no column named "'.concat(u,'"'));d[h[u]]=h}else d[c]=this.rows[c].obj;return d},i.default.Table.prototype.getArray=function(){for(var u=[],h=0;h<this.rows.length;h++)u.push(this.rows[h].arr);return u};var l=i.default;o.default=l},{"../core/main":264,"core-js/modules/es.array.concat":149,"core-js/modules/es.array.index-of":157,"core-js/modules/es.array.join":159,"core-js/modules/es.array.splice":164,"core-js/modules/es.regexp.constructor":180,"core-js/modules/es.regexp.exec":181,"core-js/modules/es.regexp.to-string":182,"core-js/modules/es.string.match":187,"core-js/modules/es.string.replace":189,"core-js/modules/es.string.trim":193}],292:[function(n,s,o){n("core-js/modules/es.array.index-of"),n("core-js/modules/es.object.to-string"),n("core-js/modules/es.regexp.exec"),n("core-js/modules/es.regexp.to-string"),n("core-js/modules/es.string.split"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var a,i=(a=n("../core/main"))&&a.__esModule?a:{default:a};i.default.TableRow=function(u,h){var d=[],c={};u&&(h=h||",",d=u.split(h));for(var f=0;f<d.length;f++){var p=f,m=d[f];c[p]=m}this.arr=d,this.obj=c,this.table=null},i.default.TableRow.prototype.set=function(u,h){if(typeof u=="string"){var d=this.table.columns.indexOf(u);if(!(0<=d))throw new Error('This table has no column named "'.concat(u,'"'));this.obj[u]=h,this.arr[d]=h}else{if(!(u<this.table.columns.length))throw new Error("Column #".concat(u," is out of the range of this table"));this.arr[u]=h;var c=this.table.columns[u];this.obj[c]=h}},i.default.TableRow.prototype.setNum=function(u,h){var d=parseFloat(h);this.set(u,d)},i.default.TableRow.prototype.setString=function(u,h){var d=h.toString();this.set(u,d)},i.default.TableRow.prototype.get=function(u){return typeof u=="string"?this.obj[u]:this.arr[u]},i.default.TableRow.prototype.getNum=function(u){var h;if((h=parseFloat(typeof u=="string"?this.obj[u]:this.arr[u])).toString()==="NaN")throw"Error: ".concat(this.obj[u]," is NaN (Not a Number)");return h},i.default.TableRow.prototype.getString=function(u){return typeof u=="string"?this.obj[u].toString():this.arr[u].toString()};var l=i.default;o.default=l},{"../core/main":264,"core-js/modules/es.array.index-of":157,"core-js/modules/es.object.to-string":177,"core-js/modules/es.regexp.exec":181,"core-js/modules/es.regexp.to-string":182,"core-js/modules/es.string.split":191}],293:[function(n,s,o){n("core-js/modules/es.symbol"),n("core-js/modules/es.symbol.description"),n("core-js/modules/es.symbol.iterator"),n("core-js/modules/es.array.iterator"),n("core-js/modules/es.number.constructor"),n("core-js/modules/es.object.to-string"),n("core-js/modules/es.regexp.exec"),n("core-js/modules/es.string.iterator"),n("core-js/modules/es.string.replace"),n("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var a,i=(a=n("../core/main"))&&a.__esModule?a:{default:a};function l(h){for(var d=[],c=0;c<h.length;c++)d.push(new i.default.XML(h[c]));return d}i.default.XML=function(h){if(h)this.DOM=h;else{var d=document.implementation.createDocument(null,"doc");this.DOM=d.createElement("root")}},i.default.XML.prototype.getParent=function(){return new i.default.XML(this.DOM.parentElement)},i.default.XML.prototype.getName=function(){return this.DOM.tagName},i.default.XML.prototype.setName=function(h){var d=this.DOM.innerHTML,c=this.DOM.attributes,f=document.implementation.createDocument(null,"default").createElement(h);f.innerHTML=d;for(var p=0;p<c.length;p++)f.setAttribute(c[p].nodeName,c.nodeValue);this.DOM=f},i.default.XML.prototype.hasChildren=function(){return 0<this.DOM.children.length},i.default.XML.prototype.listChildren=function(){for(var h=[],d=0;d<this.DOM.childNodes.length;d++)h.push(this.DOM.childNodes[d].nodeName);return h},i.default.XML.prototype.getChildren=function(h){return l(h?this.DOM.getElementsByTagName(h):this.DOM.children)},i.default.XML.prototype.getChild=function(h){if(typeof h!="string")return new i.default.XML(this.DOM.children[h]);var d=!0,c=!1,f=void 0;try{for(var p,m=this.DOM.children[Symbol.iterator]();!(d=(p=m.next()).done);d=!0){var g=p.value;if(g.tagName===h)return new i.default.XML(g)}}catch(y){c=!0,f=y}finally{try{d||m.return==null||m.return()}finally{if(c)throw f}}},i.default.XML.prototype.addChild=function(h){h instanceof i.default.XML&&this.DOM.appendChild(h.DOM)},i.default.XML.prototype.removeChild=function(h){var d=-1;if(typeof h=="string"){for(var c=0;c<this.DOM.children.length;c++)if(this.DOM.children[c].tagName===h){d=c;break}}else d=h;d!==-1&&this.DOM.removeChild(this.DOM.children[d])},i.default.XML.prototype.getAttributeCount=function(){return this.DOM.attributes.length},i.default.XML.prototype.listAttributes=function(){var h=[],d=!0,c=!1,f=void 0;try{for(var p,m=this.DOM.attributes[Symbol.iterator]();!(d=(p=m.next()).done);d=!0){var g=p.value;h.push(g.nodeName)}}catch(y){c=!0,f=y}finally{try{d||m.return==null||m.return()}finally{if(c)throw f}}return h},i.default.XML.prototype.hasAttribute=function(h){var d={},c=!0,f=!1,p=void 0;try{for(var m,g=this.DOM.attributes[Symbol.iterator]();!(c=(m=g.next()).done);c=!0){var y=m.value;d[y.nodeName]=y.nodeValue}}catch(v){f=!0,p=v}finally{try{c||g.return==null||g.return()}finally{if(f)throw p}}return!!d[h]},i.default.XML.prototype.getNum=function(h,d){var c={},f=!0,p=!1,m=void 0;try{for(var g,y=this.DOM.attributes[Symbol.iterator]();!(f=(g=y.next()).done);f=!0){var v=g.value;c[v.nodeName]=v.nodeValue}}catch(b){p=!0,m=b}finally{try{f||y.return==null||y.return()}finally{if(p)throw m}}return Number(c[h])||d||0},i.default.XML.prototype.getString=function(h,d){var c={},f=!0,p=!1,m=void 0;try{for(var g,y=this.DOM.attributes[Symbol.iterator]();!(f=(g=y.next()).done);f=!0){var v=g.value;c[v.nodeName]=v.nodeValue}}catch(b){p=!0,m=b}finally{try{f||y.return==null||y.return()}finally{if(p)throw m}}return c[h]?String(c[h]):d||null},i.default.XML.prototype.setAttribute=function(h,d){this.DOM.setAttribute(h,d)},i.default.XML.prototype.getContent=function(h){return this.DOM.textContent.replace(/\s\s+/g,",")||h||null},i.default.XML.prototype.setContent=function(h){this.DOM.children.length||(this.DOM.textContent=h)},i.default.XML.prototype.serialize=function(){return new XMLSerializer().serializeToString(this.DOM)};var u=i.default;o.default=u},{"../core/main":264,"core-js/modules/es.array.iterator":158,"core-js/modules/es.number.constructor":170,"core-js/modules/es.object.to-string":177,"core-js/modules/es.regexp.exec":181,"core-js/modules/es.string.iterator":186,"core-js/modules/es.string.replace":189,"core-js/modules/es.symbol":196,"core-js/modules/es.symbol.description":194,"core-js/modules/es.symbol.iterator":195,"core-js/modules/web.dom-collections.iterator":229}],294:[function(n,s,o){n("core-js/modules/es.array.includes"),n("core-js/modules/es.array.index-of"),n("core-js/modules/es.array.map"),n("core-js/modules/es.array.slice"),n("core-js/modules/es.math.hypot"),n("core-js/modules/es.number.constructor"),n("core-js/modules/es.string.includes"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var a,i=(a=n("../core/main"))&&a.__esModule?a:{default:a};function l(){if(typeof Math.hypot=="function")return Math.hypot.apply(null,arguments);for(var h=arguments.length,d=[],c=0,f=0;f<h;f++){var p=arguments[f];if((p=+p)===1/0||p===-1/0)return 1/0;c<(p=Math.abs(p))&&(c=p),d[f]=p}c===0&&(c=1);for(var m=0,g=0,y=0;y<h;y++){var v=d[y]/c,b=v*v-g,w=m+b;g=w-m-b,m=w}return Math.sqrt(m)*c}i.default.prototype.abs=Math.abs,i.default.prototype.ceil=Math.ceil,i.default.prototype.constrain=function(h,d,c){return i.default._validateParameters("constrain",arguments),Math.max(Math.min(h,c),d)},i.default.prototype.dist=function(){for(var h=arguments.length,d=new Array(h),c=0;c<h;c++)d[c]=arguments[c];return i.default._validateParameters("dist",d),d.length===4?l(d[2]-d[0],d[3]-d[1]):d.length===6?l(d[3]-d[0],d[4]-d[1],d[5]-d[2]):void 0},i.default.prototype.exp=Math.exp,i.default.prototype.floor=Math.floor,i.default.prototype.lerp=function(h,d,c){return i.default._validateParameters("lerp",arguments),c*(d-h)+h},i.default.prototype.log=Math.log,i.default.prototype.mag=function(h,d){return i.default._validateParameters("mag",arguments),l(h,d)},i.default.prototype.map=function(h,d,c,f,p,m){i.default._validateParameters("map",arguments);var g=(h-d)/(c-d)*(p-f)+f;return m?f<p?this.constrain(g,f,p):this.constrain(g,p,f):g},i.default.prototype.max=function(){for(var h=arguments.length,d=new Array(h),c=0;c<h;c++)d[c]=arguments[c];return d[0]instanceof Array?Math.max.apply(null,d[0]):Math.max.apply(null,d)},i.default.prototype.min=function(){for(var h=arguments.length,d=new Array(h),c=0;c<h;c++)d[c]=arguments[c];return d[0]instanceof Array?Math.min.apply(null,d[0]):Math.min.apply(null,d)},i.default.prototype.norm=function(h,d,c){return i.default._validateParameters("norm",arguments),this.map(h,d,c,0,1)},i.default.prototype.pow=Math.pow,i.default.prototype.round=function(h,d){if(!d)return Math.round(h);var c=Math.pow(10,d);return Math.round(h*c)/c},i.default.prototype.sq=function(h){return h*h},i.default.prototype.sqrt=Math.sqrt,i.default.prototype.fract=function(h){i.default._validateParameters("fract",arguments);var d=0,c=Number(h);if(isNaN(c)||Math.abs(c)===1/0)return c;if(c<0&&(c=-c,d=1),!String(c).includes(".")||String(c).includes("e"))return c<1?Math.abs(d-c):0;var f=String(c);return f=Number("0"+f.slice(f.indexOf("."))),Math.abs(d-f)};var u=i.default;o.default=u},{"../core/main":264,"core-js/modules/es.array.includes":156,"core-js/modules/es.array.index-of":157,"core-js/modules/es.array.map":161,"core-js/modules/es.array.slice":162,"core-js/modules/es.math.hypot":168,"core-js/modules/es.number.constructor":170,"core-js/modules/es.string.includes":185}],295:[function(n,s,o){n("core-js/modules/es.array.concat"),n("core-js/modules/es.array.slice"),n("core-js/modules/es.object.to-string"),n("core-js/modules/es.reflect.construct"),n("core-js/modules/es.regexp.to-string"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var a,i=(a=n("../core/main"))&&a.__esModule?a:{default:a};function l(d,c,f){return(l=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}()?Reflect.construct:function(p,m,g){var y=[null];y.push.apply(y,m);var v=new(Function.bind.apply(p,y));return g&&u(v,g.prototype),v}).apply(null,arguments)}function u(d,c){return(u=Object.setPrototypeOf||function(f,p){return f.__proto__=p,f})(d,c)}i.default.prototype.createVector=function(d,c,f){return this instanceof i.default?l(i.default.Vector,[this._fromRadians.bind(this),this._toRadians.bind(this)].concat(Array.prototype.slice.call(arguments))):new i.default.Vector(d,c,f)};var h=i.default;o.default=h},{"../core/main":264,"core-js/modules/es.array.concat":149,"core-js/modules/es.array.slice":162,"core-js/modules/es.object.to-string":177,"core-js/modules/es.reflect.construct":179,"core-js/modules/es.regexp.to-string":182}],296:[function(n,s,o){Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var a,i=(a=n("../core/main"))&&a.__esModule?a:{default:a};function l(p){return .5*(1-Math.cos(p*Math.PI))}var u,h=4095,d=4,c=.5;i.default.prototype.noise=function(p){var m=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0,g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:0;if(u==null){u=new Array(4096);for(var y=0;y<4096;y++)u[y]=Math.random()}p<0&&(p=-p),m<0&&(m=-m),g<0&&(g=-g);for(var v,b,w,_,I,C=Math.floor(p),N=Math.floor(m),O=Math.floor(g),D=p-C,M=m-N,P=g-O,F=0,B=.5,z=0;z<d;z++){var Z=C+(N<<4)+(O<<8);v=l(D),b=l(M),w=u[Z&h],w+=v*(u[Z+1&h]-w),_=u[Z+16&h],w+=b*((_+=v*(u[Z+16+1&h]-_))-w),_=u[(Z+=256)&h],_+=v*(u[Z+1&h]-_),I=u[Z+16&h],_+=b*((I+=v*(u[Z+16+1&h]-I))-_),F+=(w+=l(P)*(_-w))*B,B*=c,C<<=1,N<<=1,O<<=1,1<=(D*=2)&&(C++,D--),1<=(M*=2)&&(N++,M--),1<=(P*=2)&&(O++,P--)}return F},i.default.prototype.noiseDetail=function(p,m){0<p&&(d=p),0<m&&(c=m)},i.default.prototype.noiseSeed=function(p){var m,g,y,v=(y=4294967296,{setSeed:function(w){g=m=(w==null?Math.random()*y:w)>>>0},getSeed:function(){return m},rand:function(){return(g=(1664525*g+1013904223)%y)/y}});v.setSeed(p),u=new Array(4096);for(var b=0;b<4096;b++)u[b]=v.rand()};var f=i.default;o.default=f},{"../core/main":264}],297:[function(n,s,o){function a(p){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(m){return typeof m}:function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m})(p)}n("core-js/modules/es.array.concat"),n("core-js/modules/es.array.every"),n("core-js/modules/es.array.slice"),n("core-js/modules/es.array.some"),n("core-js/modules/es.math.sign"),n("core-js/modules/es.number.constructor"),n("core-js/modules/es.number.is-finite"),n("core-js/modules/es.object.to-string"),n("core-js/modules/es.regexp.to-string"),n("core-js/modules/es.string.sub"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var i,l=(i=n("../core/main"))&&i.__esModule?i:{default:i},u=function(p){if(p&&p.__esModule)return p;if(p===null||a(p)!=="object"&&typeof p!="function")return{default:p};var m=h();if(m&&m.has(p))return m.get(p);var g={},y=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var v in p)if(Object.prototype.hasOwnProperty.call(p,v)){var b=y?Object.getOwnPropertyDescriptor(p,v):null;b&&(b.get||b.set)?Object.defineProperty(g,v,b):g[v]=p[v]}return g.default=p,m&&m.set(p,g),g}(n("../core/constants"));function h(){if(typeof WeakMap!="function")return null;var p=new WeakMap;return h=function(){return p},p}l.default.Vector=function(p,m,g,y,v){var b,w,_;_={}.toString.call(p)==="[object Function]"?(this.isPInst=!0,this._fromRadians=p,this._toRadians=m,b=g||0,w=y||0,v||0):(b=p||0,w=m||0,g||0),this.x=b,this.y=w,this.z=_},l.default.Vector.prototype.toString=function(){return"p5.Vector Object : [".concat(this.x,", ").concat(this.y,", ").concat(this.z,"]")},l.default.Vector.prototype.set=function(p,m,g){return p instanceof l.default.Vector?(this.x=p.x||0,this.y=p.y||0,this.z=p.z||0):p instanceof Array?(this.x=p[0]||0,this.y=p[1]||0,this.z=p[2]||0):(this.x=p||0,this.y=m||0,this.z=g||0),this},l.default.Vector.prototype.copy=function(){return this.isPInst?new l.default.Vector(this._fromRadians,this._toRadians,this.x,this.y,this.z):new l.default.Vector(this.x,this.y,this.z)},l.default.Vector.prototype.add=function(p,m,g){return p instanceof l.default.Vector?(this.x+=p.x||0,this.y+=p.y||0,this.z+=p.z||0):p instanceof Array?(this.x+=p[0]||0,this.y+=p[1]||0,this.z+=p[2]||0):(this.x+=p||0,this.y+=m||0,this.z+=g||0),this};function d(p,m){return p!==0&&(this.x=this.x%p),m!==0&&(this.y=this.y%m),this}function c(p,m,g){return p!==0&&(this.x=this.x%p),m!==0&&(this.y=this.y%m),g!==0&&(this.z=this.z%g),this}l.default.Vector.prototype.rem=function(p,m,g){if(p instanceof l.default.Vector){if(Number.isFinite(p.x)&&Number.isFinite(p.y)&&Number.isFinite(p.z)){var y=parseFloat(p.x),v=parseFloat(p.y),b=parseFloat(p.z);return c.call(this,y,v,b)}}else if(p instanceof Array){if(p.every(function(I){return Number.isFinite(I)})){if(p.length===2)return d.call(this,p[0],p[1]);if(p.length===3)return c.call(this,p[0],p[1],p[2])}}else if(arguments.length===1){if(Number.isFinite(p)&&p!==0)return this.x=this.x%p,this.y=this.y%p,this.z=this.z%p,this}else if(arguments.length===2){var w=Array.prototype.slice.call(arguments);if(w.every(function(I){return Number.isFinite(I)})&&w.length===2)return d.call(this,w[0],w[1])}else if(arguments.length===3){var _=Array.prototype.slice.call(arguments);if(_.every(function(I){return Number.isFinite(I)})&&_.length===3)return c.call(this,_[0],_[1],_[2])}},l.default.Vector.prototype.sub=function(p,m,g){return p instanceof l.default.Vector?(this.x-=p.x||0,this.y-=p.y||0,this.z-=p.z||0):p instanceof Array?(this.x-=p[0]||0,this.y-=p[1]||0,this.z-=p[2]||0):(this.x-=p||0,this.y-=m||0,this.z-=g||0),this},l.default.Vector.prototype.mult=function(p,m,g){if(p instanceof l.default.Vector)return Number.isFinite(p.x)&&Number.isFinite(p.y)&&Number.isFinite(p.z)&&typeof p.x=="number"&&typeof p.y=="number"&&typeof p.z=="number"?(this.x*=p.x,this.y*=p.y,this.z*=p.z):console.warn("p5.Vector.prototype.mult:","x contains components that are either undefined or not finite numbers"),this;if(p instanceof Array)return p.every(function(v){return Number.isFinite(v)})&&p.every(function(v){return typeof v=="number"})?p.length===1?(this.x*=p[0],this.y*=p[0],this.z*=p[0]):p.length===2?(this.x*=p[0],this.y*=p[1]):p.length===3&&(this.x*=p[0],this.y*=p[1],this.z*=p[2]):console.warn("p5.Vector.prototype.mult:","x contains elements that are either undefined or not finite numbers"),this;var y=Array.prototype.slice.call(arguments);return y.every(function(v){return Number.isFinite(v)})&&y.every(function(v){return typeof v=="number"})?(arguments.length===1&&(this.x*=p,this.y*=p,this.z*=p),arguments.length===2&&(this.x*=p,this.y*=m),arguments.length===3&&(this.x*=p,this.y*=m,this.z*=g)):console.warn("p5.Vector.prototype.mult:","x, y, or z arguments are either undefined or not a finite number"),this},l.default.Vector.prototype.div=function(p,m,g){if(p instanceof l.default.Vector){if(Number.isFinite(p.x)&&Number.isFinite(p.y)&&Number.isFinite(p.z)&&typeof p.x=="number"&&typeof p.y=="number"&&typeof p.z=="number"){if(p.x===0||p.y===0||p.z===0)return console.warn("p5.Vector.prototype.div:","divide by 0"),this;this.x/=p.x,this.y/=p.y,this.z/=p.z}else console.warn("p5.Vector.prototype.div:","x contains components that are either undefined or not finite numbers");return this}if(p instanceof Array){if(p.every(function(v){return Number.isFinite(v)})&&p.every(function(v){return typeof v=="number"})){if(p.some(function(v){return v===0}))return console.warn("p5.Vector.prototype.div:","divide by 0"),this;p.length===1?(this.x/=p[0],this.y/=p[0],this.z/=p[0]):p.length===2?(this.x/=p[0],this.y/=p[1]):p.length===3&&(this.x/=p[0],this.y/=p[1],this.z/=p[2])}else console.warn("p5.Vector.prototype.div:","x contains components that are either undefined or not finite numbers");return this}var y=Array.prototype.slice.call(arguments);if(y.every(function(v){return Number.isFinite(v)})&&y.every(function(v){return typeof v=="number"})){if(y.some(function(v){return v===0}))return console.warn("p5.Vector.prototype.div:","divide by 0"),this;arguments.length===1&&(this.x/=p,this.y/=p,this.z/=p),arguments.length===2&&(this.x/=p,this.y/=m),arguments.length===3&&(this.x/=p,this.y/=m,this.z/=g)}else console.warn("p5.Vector.prototype.div:","x, y, or z arguments are either undefined or not a finite number");return this},l.default.Vector.prototype.mag=function(){return Math.sqrt(this.magSq())},l.default.Vector.prototype.magSq=function(){var p=this.x,m=this.y,g=this.z;return p*p+m*m+g*g},l.default.Vector.prototype.dot=function(p,m,g){return p instanceof l.default.Vector?this.dot(p.x,p.y,p.z):this.x*(p||0)+this.y*(m||0)+this.z*(g||0)},l.default.Vector.prototype.cross=function(p){var m=this.y*p.z-this.z*p.y,g=this.z*p.x-this.x*p.z,y=this.x*p.y-this.y*p.x;return this.isPInst?new l.default.Vector(this._fromRadians,this._toRadians,m,g,y):new l.default.Vector(m,g,y)},l.default.Vector.prototype.dist=function(p){return p.copy().sub(this).mag()},l.default.Vector.prototype.normalize=function(){var p=this.mag();return p!==0&&this.mult(1/p),this},l.default.Vector.prototype.limit=function(p){var m=this.magSq();return p*p<m&&this.div(Math.sqrt(m)).mult(p),this},l.default.Vector.prototype.setMag=function(p){return this.normalize().mult(p)},l.default.Vector.prototype.heading=function(){var p=Math.atan2(this.y,this.x);return this.isPInst?this._fromRadians(p):p},l.default.Vector.prototype.setHeading=function(p){var m=this.mag();return this.x=m*Math.cos(p),this.y=m*Math.sin(p),this},l.default.Vector.prototype.rotate=function(p){var m=this.heading()+p;this.isPInst&&(m=this._toRadians(m));var g=this.mag();return this.x=Math.cos(m)*g,this.y=Math.sin(m)*g,this},l.default.Vector.prototype.angleBetween=function(p){var m,g=this.dot(p)/(this.mag()*p.mag());return m=Math.acos(Math.min(1,Math.max(-1,g))),m*=Math.sign(this.cross(p).z||1),this.isPInst&&(m=this._fromRadians(m)),m},l.default.Vector.prototype.lerp=function(p,m,g,y){return p instanceof l.default.Vector?this.lerp(p.x,p.y,p.z,m):(this.x+=(p-this.x)*y||0,this.y+=(m-this.y)*y||0,this.z+=(g-this.z)*y||0,this)},l.default.Vector.prototype.reflect=function(p){return p.normalize(),this.sub(p.mult(2*this.dot(p)))},l.default.Vector.prototype.array=function(){return[this.x||0,this.y||0,this.z||0]},l.default.Vector.prototype.equals=function(p,m,g){var y,v,b;return b=p instanceof l.default.Vector?(y=p.x||0,v=p.y||0,p.z||0):p instanceof Array?(y=p[0]||0,v=p[1]||0,p[2]||0):(y=p||0,v=m||0,g||0),this.x===y&&this.y===v&&this.z===b},l.default.Vector.fromAngle=function(p,m){return m===void 0&&(m=1),new l.default.Vector(m*Math.cos(p),m*Math.sin(p),0)},l.default.Vector.fromAngles=function(p,m,g){g===void 0&&(g=1);var y=Math.cos(m),v=Math.sin(m),b=Math.cos(p),w=Math.sin(p);return new l.default.Vector(g*w*v,-g*b,g*w*y)},l.default.Vector.random2D=function(){return this.fromAngle(Math.random()*u.TWO_PI)},l.default.Vector.random3D=function(){var p=Math.random()*u.TWO_PI,m=2*Math.random()-1,g=Math.sqrt(1-m*m),y=g*Math.cos(p),v=g*Math.sin(p);return new l.default.Vector(y,v,m)},l.default.Vector.add=function(p,m,g){return g?g.set(p):(g=p.copy(),arguments.length===3&&l.default._friendlyError("The target parameter is undefined, it should be of type p5.Vector","p5.Vector.add")),g.add(m),g},l.default.Vector.rem=function(p,m){if(p instanceof l.default.Vector&&m instanceof l.default.Vector){var g=p.copy();return g.rem(m),g}},l.default.Vector.sub=function(p,m,g){return g?g.set(p):(g=p.copy(),arguments.length===3&&l.default._friendlyError("The target parameter is undefined, it should be of type p5.Vector","p5.Vector.sub")),g.sub(m),g},l.default.Vector.mult=function(p,m,g){return g?g.set(p):(g=p.copy(),arguments.length===3&&l.default._friendlyError("The target parameter is undefined, it should be of type p5.Vector","p5.Vector.mult")),g.mult(m),g},l.default.Vector.rotate=function(p,m,g){return arguments.length===2?g=p.copy():(g instanceof l.default.Vector||l.default._friendlyError("The target parameter should be of type p5.Vector","p5.Vector.rotate"),g.set(p)),g.rotate(m),g},l.default.Vector.div=function(p,m,g){return g?g.set(p):(g=p.copy(),arguments.length===3&&l.default._friendlyError("The target parameter is undefined, it should be of type p5.Vector","p5.Vector.div")),g.div(m),g},l.default.Vector.dot=function(p,m){return p.dot(m)},l.default.Vector.cross=function(p,m){return p.cross(m)},l.default.Vector.dist=function(p,m){return p.dist(m)},l.default.Vector.lerp=function(p,m,g,y){return y?y.set(p):(y=p.copy(),arguments.length===4&&l.default._friendlyError("The target parameter is undefined, it should be of type p5.Vector","p5.Vector.lerp")),y.lerp(m,g),y},l.default.Vector.mag=function(p){var m=p.x,g=p.y,y=p.z,v=m*m+g*g+y*y;return Math.sqrt(v)},l.default.Vector.normalize=function(p,m){return arguments.length<2?m=p.copy():(m instanceof l.default.Vector||l.default._friendlyError("The target parameter should be of type p5.Vector","p5.Vector.normalize"),m.set(p)),m.normalize()};var f=l.default.Vector;o.default=f},{"../core/constants":253,"../core/main":264,"core-js/modules/es.array.concat":149,"core-js/modules/es.array.every":150,"core-js/modules/es.array.slice":162,"core-js/modules/es.array.some":163,"core-js/modules/es.math.sign":169,"core-js/modules/es.number.constructor":170,"core-js/modules/es.number.is-finite":171,"core-js/modules/es.object.to-string":177,"core-js/modules/es.regexp.to-string":182,"core-js/modules/es.string.sub":192}],298:[function(n,s,o){Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var a,i=(a=n("../core/main"))&&a.__esModule?a:{default:a},l="_lcg_random_state",u=4294967296,h=0;i.default.prototype._lcg=function(c){return this[c]=(1664525*this[c]+1013904223)%u,this[c]/u},i.default.prototype._lcgSetSeed=function(c,f){this[c]=(f==null?Math.random()*u:f)>>>0},i.default.prototype.randomSeed=function(c){this._lcgSetSeed(l,c),this._gaussian_previous=!1},i.default.prototype.random=function(c,f){var p;if(i.default._validateParameters("random",arguments),p=this[l]!=null?this._lcg(l):Math.random(),c===void 0)return p;if(f===void 0)return c instanceof Array?c[Math.floor(p*c.length)]:p*c;if(f<c){var m=c;c=f,f=m}return p*(f-c)+c},i.default.prototype.randomGaussian=function(c){var f,p,m,g,y=1<arguments.length&&arguments[1]!==void 0?arguments[1]:1;if(this._gaussian_previous)f=h,this._gaussian_previous=!1;else{for(;1<=(g=(p=this.random(2)-1)*p+(m=this.random(2)-1)*m););f=p*(g=Math.sqrt(-2*Math.log(g)/g)),h=m*g,this._gaussian_previous=!0}return f*y+(c||0)};var d=i.default;o.default=d},{"../core/main":264}],299:[function(n,s,o){function a(c){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(f){return typeof f}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f})(c)}Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var i,l=(i=n("../core/main"))&&i.__esModule?i:{default:i},u=function(c){if(c&&c.__esModule)return c;if(c===null||a(c)!=="object"&&typeof c!="function")return{default:c};var f=h();if(f&&f.has(c))return f.get(c);var p={},m=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var g in c)if(Object.prototype.hasOwnProperty.call(c,g)){var y=m?Object.getOwnPropertyDescriptor(c,g):null;y&&(y.get||y.set)?Object.defineProperty(p,g,y):p[g]=c[g]}return p.default=c,f&&f.set(c,p),p}(n("../core/constants"));function h(){if(typeof WeakMap!="function")return null;var c=new WeakMap;return h=function(){return c},c}l.default.prototype._angleMode=u.RADIANS,l.default.prototype.acos=function(c){return this._fromRadians(Math.acos(c))},l.default.prototype.asin=function(c){return this._fromRadians(Math.asin(c))},l.default.prototype.atan=function(c){return this._fromRadians(Math.atan(c))},l.default.prototype.atan2=function(c,f){return this._fromRadians(Math.atan2(c,f))},l.default.prototype.cos=function(c){return Math.cos(this._toRadians(c))},l.default.prototype.sin=function(c){return Math.sin(this._toRadians(c))},l.default.prototype.tan=function(c){return Math.tan(this._toRadians(c))},l.default.prototype.degrees=function(c){return c*u.RAD_TO_DEG},l.default.prototype.radians=function(c){return c*u.DEG_TO_RAD},l.default.prototype.angleMode=function(c){c!==u.DEGREES&&c!==u.RADIANS||(this._angleMode=c)},l.default.prototype._toRadians=function(c){return this._angleMode===u.DEGREES?c*u.DEG_TO_RAD:c},l.default.prototype._toDegrees=function(c){return this._angleMode===u.RADIANS?c*u.RAD_TO_DEG:c},l.default.prototype._fromRadians=function(c){return this._angleMode===u.DEGREES?c*u.RAD_TO_DEG:c};var d=l.default;o.default=d},{"../core/constants":253,"../core/main":264}],300:[function(n,s,o){Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var a,i=(a=n("../core/main"))&&a.__esModule?a:{default:a};i.default.prototype.textAlign=function(u,h){var d;return i.default._validateParameters("textAlign",arguments),(d=this._renderer).textAlign.apply(d,arguments)},i.default.prototype.textLeading=function(u){var h;return i.default._validateParameters("textLeading",arguments),(h=this._renderer).textLeading.apply(h,arguments)},i.default.prototype.textSize=function(u){var h;return i.default._validateParameters("textSize",arguments),(h=this._renderer).textSize.apply(h,arguments)},i.default.prototype.textStyle=function(u){var h;return i.default._validateParameters("textStyle",arguments),(h=this._renderer).textStyle.apply(h,arguments)},i.default.prototype.textWidth=function(){for(var u,h=arguments.length,d=new Array(h),c=0;c<h;c++)d[c]=arguments[c];return d[0]+="",i.default._validateParameters("textWidth",d),d[0].length===0?0:(u=this._renderer).textWidth.apply(u,d)},i.default.prototype.textAscent=function(){for(var u=arguments.length,h=new Array(u),d=0;d<u;d++)h[d]=arguments[d];return i.default._validateParameters("textAscent",h),this._renderer.textAscent()},i.default.prototype.textDescent=function(){for(var u=arguments.length,h=new Array(u),d=0;d<u;d++)h[d]=arguments[d];return i.default._validateParameters("textDescent",h),this._renderer.textDescent()},i.default.prototype._updateTextMetrics=function(){return this._renderer._updateTextMetrics()},i.default.prototype.textWrap=function(u){if(u!=="WORD"&&u!=="CHAR")throw"Error: textWrap accepts only WORD or CHAR";return this._renderer.textWrap(u)};var l=i.default;o.default=l},{"../core/main":264}],301:[function(n,s,o){function a(p){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(m){return typeof m}:function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m})(p)}n("core-js/modules/es.array.concat"),n("core-js/modules/es.array.includes"),n("core-js/modules/es.array.last-index-of"),n("core-js/modules/es.regexp.exec"),n("core-js/modules/es.string.split"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var i,l=(i=n("../core/main"))&&i.__esModule?i:{default:i},u=c(n("../core/constants")),h=c(n("opentype.js"));function d(){if(typeof WeakMap!="function")return null;var p=new WeakMap;return d=function(){return p},p}function c(p){if(p&&p.__esModule)return p;if(p===null||a(p)!=="object"&&typeof p!="function")return{default:p};var m=d();if(m&&m.has(p))return m.get(p);var g={},y=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var v in p)if(Object.prototype.hasOwnProperty.call(p,v)){var b=y?Object.getOwnPropertyDescriptor(p,v):null;b&&(b.get||b.set)?Object.defineProperty(g,v,b):g[v]=p[v]}return g.default=p,m&&m.set(p,g),g}n("../core/friendly_errors/validate_params"),n("../core/friendly_errors/file_errors"),n("../core/friendly_errors/fes_core"),l.default.prototype.loadFont=function(p,m,g){l.default._validateParameters("loadFont",arguments);var y=new l.default.Font(this),v=this;return h.load(p,function(b,w){if(b)return l.default._friendlyFileLoadError(4,p),g!==void 0?g(b):void console.error(b,p);y.font=w,m!==void 0&&m(y),v._decrementPreload();var _,I,C=p.split("\\").pop().split("/").pop(),N=C.lastIndexOf("."),O=N<1?null:C.substr(N+1);["ttf","otf","woff","woff2"].includes(O)&&(_=C.substr(0,N),(I=document.createElement("style")).appendChild(document.createTextNode(`
@font-face {
font-family: `.concat(_,`;
src: url(`).concat(p,`);
}
`))),document.head.appendChild(I))}),y},l.default.prototype.text=function(p,m,g,y,v){var b;return l.default._validateParameters("text",arguments),this._renderer._doFill||this._renderer._doStroke?(b=this._renderer).text.apply(b,arguments):this},l.default.prototype.textFont=function(p,m){if(l.default._validateParameters("textFont",arguments),arguments.length){if(!p)throw new Error("null font passed to textFont");return this._renderer._setProperty("_textFont",p),m&&(this._renderer._setProperty("_textSize",m),this._renderer._leadingSet||this._renderer._setProperty("_textLeading",m*u._DEFAULT_LEADMULT)),this._renderer._applyTextProperties()}return this._renderer._textFont};var f=l.default;o.default=f},{"../core/constants":253,"../core/friendly_errors/fes_core":255,"../core/friendly_errors/file_errors":256,"../core/friendly_errors/validate_params":259,"../core/main":264,"core-js/modules/es.array.concat":149,"core-js/modules/es.array.includes":156,"core-js/modules/es.array.last-index-of":160,"core-js/modules/es.regexp.exec":181,"core-js/modules/es.string.split":191,"opentype.js":239}],302:[function(n,s,o){n("core-js/modules/es.symbol"),n("core-js/modules/es.symbol.description"),n("core-js/modules/es.symbol.iterator"),n("core-js/modules/es.array.concat"),n("core-js/modules/es.array.fill"),n("core-js/modules/es.array.iterator"),n("core-js/modules/es.array.join"),n("core-js/modules/es.array.slice"),n("core-js/modules/es.array.splice"),n("core-js/modules/es.function.name"),n("core-js/modules/es.number.to-fixed"),n("core-js/modules/es.object.to-string"),n("core-js/modules/es.regexp.exec"),n("core-js/modules/es.string.iterator"),n("core-js/modules/es.string.split"),n("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var a,i=(a=n("../core/main"))&&a.__esModule?a:{default:a},l=function(D){if(D&&D.__esModule)return D;if(D===null||h(D)!=="object"&&typeof D!="function")return{default:D};var M=u();if(M&&M.has(D))return M.get(D);var P={},F=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var B in D)if(Object.prototype.hasOwnProperty.call(D,B)){var z=F?Object.getOwnPropertyDescriptor(D,B):null;z&&(z.get||z.set)?Object.defineProperty(P,B,z):P[B]=D[B]}return P.default=D,M&&M.set(D,P),P}(n("../core/constants"));function u(){if(typeof WeakMap!="function")return null;var D=new WeakMap;return u=function(){return D},D}function h(D){return(h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(M){return typeof M}:function(M){return M&&typeof Symbol=="function"&&M.constructor===Symbol&&M!==Symbol.prototype?"symbol":typeof M})(D)}function d(D,M){for(var P=function(Q,K){if(h(Q)!=="object")Q=K;else for(var ne in K)Q[ne]===void 0&&(Q[ne]=K[ne]);return Q}(M,{sampleFactor:.1,simplifyThreshold:0}),F=v(D,0,1),B=F/(F*P.sampleFactor),z=[],Z=0;Z<F;Z+=B)z.push(v(D,Z));return P.simplifyThreshold&&function(Q){for(var K=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0,ne=0,re=Q.length-1;3<Q.length&&0<=re;--re)m(p(Q,re-1),p(Q,re),p(Q,re+1),K)&&(Q.splice(re%Q.length,1),ne++)}(z,P.simplifyThreshold),z}function c(D){for(var M,P=[],F=0;F<D.length;F++)D[F].type==="M"&&(M&&P.push(M),M=[]),M.push(f(D[F]));return P.push(M),P}function f(D){var M=[D.type];return D.type==="M"||D.type==="L"?M.push(D.x,D.y):D.type==="C"?M.push(D.x1,D.y1,D.x2,D.y2,D.x,D.y):D.type==="Q"&&M.push(D.x1,D.y1,D.x,D.y),M}function p(D,M){var P=D.length;return D[M<0?M%P+P:M%P]}function m(D,M,P,F){if(!F)return B=D,Z=P,((z=M)[0]-B[0])*(Z[1]-B[1])-(Z[0]-B[0])*(z[1]-B[1])==0;var B,z,Z;m.tmpPoint1===void 0&&(m.tmpPoint1=[],m.tmpPoint2=[]);var Q=m.tmpPoint1,K=m.tmpPoint2;Q.x=M.x-D.x,Q.y=M.y-D.y,K.x=P.x-M.x,K.y=P.y-M.y;var ne=Q.x*K.x+Q.y*K.y,re=Math.sqrt(Q.x*Q.x+Q.y*Q.y),ce=Math.sqrt(K.x*K.x+K.y*K.y);return Math.acos(ne/(re*ce))<F}function g(D,M,P,F,B,z,Z,Q,K){var ne=1-K,re=Math.pow(ne,3),ce=Math.pow(ne,2),be=K*K,we=be*K,ye=re*D+3*ce*K*P+3*ne*K*K*B+we*Z,Oe=re*M+3*ce*K*F+3*ne*K*K*z+we*Q,Se=D+2*K*(P-D)+be*(B-2*P+D),Ee=M+2*K*(F-M)+be*(z-2*F+M),j=P+2*K*(B-P)+be*(Z-2*B+P),W=F+2*K*(z-F)+be*(Q-2*z+F),J=ne*D+K*P,ie=ne*M+K*F,ve=ne*B+K*Z,he=ne*z+K*Q,Fe=90-180*Math.atan2(Se-j,Ee-W)/Math.PI;return(j<Se||Ee<W)&&(Fe+=180),{x:ye,y:Oe,m:{x:Se,y:Ee},n:{x:j,y:W},start:{x:J,y:ie},end:{x:ve,y:he},alpha:Fe}}function y(D,M,P,F,B,z,Z,Q,K){return K==null?C(D,M,P,F,B,z,Z,Q):g(D,M,P,F,B,z,Z,Q,function(ne,re,ce,be,we,ye,Oe,Se,Ee){if(!(Ee<0||C(ne,re,ce,be,we,ye,Oe,Se)<Ee)){var j,W=.5,J=1-W;for(j=C(ne,re,ce,be,we,ye,Oe,Se,J);.01<Math.abs(j-Ee);)j=C(ne,re,ce,be,we,ye,Oe,Se,J+=(j<Ee?1:-1)*(W/=2));return J}}(D,M,P,F,B,z,Z,Q,K))}function v(D,M,P){for(var F,B,z,Z,Q,K=0,ne=0,re=(D=function(ce,be){function we(tt,Je,xt){var Pt,Dt;if(!tt)return["C",Je.x,Je.y,Je.x,Je.y,Je.x,Je.y];switch(tt[0]in{T:1,Q:1}||(Je.qx=Je.qy=null),tt[0]){case"M":Je.X=tt[1],Je.Y=tt[2];break;case"A":tt=["C"].concat(function St(Jt,ht,ct,At,Ft,Be,qt,Y,le,ee){var ue=Math.PI,Ae=120*ue/180,Ke,ot,vt,Pe,Mt=ue/180*(+Ft||0),en=[],dn,mn=function(Yn,Cn,Bt){var mr=Yn*Math.cos(Bt)-Cn*Math.sin(Bt),an=Yn*Math.sin(Bt)+Cn*Math.cos(Bt);return{x:mr,y:an}};if(ee)Ke=ee[0],ot=ee[1],vt=ee[2],Pe=ee[3];else{dn=mn(Jt,ht,-Mt),Jt=dn.x,ht=dn.y,dn=mn(Y,le,-Mt),Y=dn.x,le=dn.y;var hn=(Jt-Y)/2,gn=(ht-le)/2,jn=hn*hn/(ct*ct)+gn*gn/(At*At);1<jn&&(jn=Math.sqrt(jn),ct*=jn,At*=jn);var Ps=ct*ct,ms=At*At,Es=(Be===qt?-1:1)*Math.sqrt(Math.abs((Ps*ms-Ps*gn*gn-ms*hn*hn)/(Ps*gn*gn+ms*hn*hn)));vt=Es*ct*gn/At+(Jt+Y)/2,Pe=Es*-At*hn/ct+(ht+le)/2,Ke=Math.asin(((ht-Pe)/At).toFixed(9)),ot=Math.asin(((le-Pe)/At).toFixed(9)),(Ke=Jt<vt?ue-Ke:Ke)<0&&(Ke=2*ue+Ke),(ot=Y<vt?ue-ot:ot)<0&&(ot=2*ue+ot),qt&&ot<Ke&&(Ke-=2*ue),!qt&&Ke<ot&&(ot-=2*ue)}var Ho=ot-Ke;if(Math.abs(Ho)>Ae){var zr=ot,js=Y,gi=le;ot=Ke+Ae*(qt&&Ke<ot?1:-1),Y=vt+ct*Math.cos(ot),le=Pe+At*Math.sin(ot),en=St(Y,le,ct,At,Ft,0,qt,js,gi,[ot,zr,vt,Pe])}Ho=ot-Ke;var cr=Math.cos(Ke),as=Math.sin(Ke),qo=Math.cos(ot),wa=Math.sin(ot),ho=Math.tan(Ho/4),ko=4/3*ct*ho,Re=4/3*At*ho,gt=[Jt,ht],Lt=[Jt+ko*as,ht-Re*cr],kt=[Y+ko*wa,le-Re*qo],Xt=[Y,le];Lt[0]=2*gt[0]-Lt[0],Lt[1]=2*gt[1]-Lt[1];{if(ee)return[Lt,kt,Xt].concat(en);en=[Lt,kt,Xt].concat(en).join().split(",");for(var yt=[],_n=0,En=en.length;_n<En;_n++)yt[_n]=_n%2?mn(en[_n-1],en[_n],Mt).y:mn(en[_n],en[_n+1],Mt).x;return yt}}.apply(0,[Je.x,Je.y].concat(tt.slice(1))));break;case"S":Dt=xt==="C"||xt==="S"?(Pt=2*Je.x-Je.bx,2*Je.y-Je.by):(Pt=Je.x,Je.y),tt=["C",Pt,Dt].concat(tt.slice(1));break;case"T":xt==="Q"||xt==="T"?(Je.qx=2*Je.x-Je.qx,Je.qy=2*Je.y-Je.qy):(Je.qx=Je.x,Je.qy=Je.y),tt=["C"].concat(I(Je.x,Je.y,Je.qx,Je.qy,tt[1],tt[2]));break;case"Q":Je.qx=tt[1],Je.qy=tt[2],tt=["C"].concat(I(Je.x,Je.y,tt[1],tt[2],tt[3],tt[4]));break;case"L":tt=["C"].concat(_(Je.x,Je.y,tt[1],tt[2]));break;case"H":tt=["C"].concat(_(Je.x,Je.y,tt[1],Je.y));break;case"V":tt=["C"].concat(_(Je.x,Je.y,Je.x,tt[1]));break;case"Z":tt=["C"].concat(_(Je.x,Je.y,Je.X,Je.Y))}return tt}function ye(tt,Je){if(7<tt[Je].length){tt[Je].shift();for(var xt=tt[Je];xt.length;)ie[Je]="A",j&&(ve[Je]="A"),tt.splice(Je++,0,["C"].concat(xt.splice(0,6)));tt.splice(Je,1),Se=Math.max(Ee.length,j&&j.length||0)}}function Oe(tt,Je,xt,Pt,Dt){tt&&Je&&tt[Dt][0]==="M"&&Je[Dt][0]!=="M"&&(Je.splice(Dt,0,["M",Pt.x,Pt.y]),xt.bx=0,xt.by=0,xt.x=tt[Dt][1],xt.y=tt[Dt][2],Se=Math.max(Ee.length,j&&j.length||0))}var Se,Ee=b(ce),j=be&&b(be),W={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},J={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},ie=[],ve=[],he="",Fe="";Se=Math.max(Ee.length,j&&j.length||0);for(var me=0;me<Se;me++){Ee[me]&&(he=Ee[me][0]),he!=="C"&&(ie[me]=he,me&&(Fe=ie[me-1])),Ee[me]=we(Ee[me],W,Fe),ie[me]!=="A"&&he==="C"&&(ie[me]="C"),ye(Ee,me),j&&(j[me]&&(he=j[me][0]),he!=="C"&&(ve[me]=he,me&&(Fe=ve[me-1])),j[me]=we(j[me],J,Fe),ve[me]!=="A"&&he==="C"&&(ve[me]="C"),ye(j,me)),Oe(Ee,j,W,J,me),Oe(j,Ee,J,W,me);var Le=Ee[me],De=j&&j[me],Ne=Le.length,rt=j&&De.length;W.x=Le[Ne-2],W.y=Le[Ne-1],W.bx=parseFloat(Le[Ne-4])||W.x,W.by=parseFloat(Le[Ne-3])||W.y,J.bx=j&&(parseFloat(De[rt-4])||J.x),J.by=j&&(parseFloat(De[rt-3])||J.y),J.x=j&&De[rt-2],J.y=j&&De[rt-1]}return j?[Ee,j]:Ee}(D)).length;ne<re;ne++){if((z=D[ne])[0]==="M")F=+z[1],B=+z[2];else{if(M<K+(Z=y(F,B,z[1],z[2],z[3],z[4],z[5],z[6]))&&!P)return{x:(Q=y(F,B,z[1],z[2],z[3],z[4],z[5],z[6],M-K)).x,y:Q.y,alpha:Q.alpha};K+=Z,F=+z[5],B=+z[6]}z.shift()+z}return(Q=P?K:g(F,B,z[0],z[1],z[2],z[3],z[4],z[5],1)).alpha&&(Q={x:Q.x,y:Q.y,alpha:Q.alpha}),Q}function b(D){var M,P=[],F=0,B=0,z=0,Z=0,Q=0;if(!D)return P;D[0][0]==="M"&&(z=F=+D[0][1],Z=B=+D[0][2],Q++,P[0]=["M",F,B]);for(var K,ne,re=D.length===3&&D[0][0]==="M"&&D[1][0].toUpperCase()==="R"&&D[2][0].toUpperCase()==="Z",ce=Q,be=D.length;ce<be;ce++){if(P.push(K=[]),(ne=D[ce])[0]!==String.prototype.toUpperCase.call(ne[0]))switch(K[0]=String.prototype.toUpperCase.call(ne[0]),K[0]){case"A":K[1]=ne[1],K[2]=ne[2],K[3]=ne[3],K[4]=ne[4],K[5]=ne[5],K[6]=+(ne[6]+F),K[7]=+(ne[7]+B);break;case"V":K[1]=+ne[1]+B;break;case"H":K[1]=+ne[1]+F;break;case"R":for(var we=2,ye=(M=[F,B].concat(ne.slice(1))).length;we<ye;we++)M[we]=+M[we]+F,M[++we]=+M[we]+B;P.pop(),P=P.concat(w(M,re));break;case"M":z=+ne[1]+F,Z=+ne[2]+B;break;default:for(var Oe=1,Se=ne.length;Oe<Se;Oe++)K[Oe]=+ne[Oe]+(Oe%2?F:B)}else if(ne[0]==="R")M=[F,B].concat(ne.slice(1)),P.pop(),P=P.concat(w(M,re)),K=["R"].concat(ne.slice(-2));else for(var Ee=0,j=ne.length;Ee<j;Ee++)K[Ee]=ne[Ee];switch(K[0]){case"Z":F=z,B=Z;break;case"H":F=K[1];break;case"V":B=K[1];break;case"M":z=K[K.length-2],Z=K[K.length-1];break;default:F=K[K.length-2],B=K[K.length-1]}}return P}function w(D,M){for(var P=[],F=0,B=D.length;F<B-2*!M;F+=2){var z=[{x:+D[F-2],y:+D[F-1]},{x:+D[F],y:+D[F+1]},{x:+D[F+2],y:+D[F+3]},{x:+D[F+4],y:+D[F+5]}];M?F?B-4===F?z[3]={x:+D[0],y:+D[1]}:B-2===F&&(z[2]={x:+D[0],y:+D[1]},z[3]={x:+D[2],y:+D[3]}):z[0]={x:+D[B-2],y:+D[B-1]}:B-4===F?z[3]=z[2]:F||(z[0]={x:+D[F],y:+D[F+1]}),P.push(["C",(-z[0].x+6*z[1].x+z[2].x)/6,(-z[0].y+6*z[1].y+z[2].y)/6,(z[1].x+6*z[2].x-z[3].x)/6,(z[1].y+6*z[2].y-z[3].y)/6,z[2].x,z[2].y])}return P}function _(D,M,P,F){return[D,M,P,F,P,F]}function I(D,M,P,F,B,z){return[1/3*D+2/3*P,1/3*M+2/3*F,1/3*B+2/3*P,1/3*z+2/3*F,B,z]}function C(D,M,P,F,B,z,Z,Q,K){K==null&&(K=1);for(var ne=(K=1<K?1:K<0?0:K)/2,re=[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816],ce=0,be=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],we=0;we<12;we++){var ye=ne*re[we]+ne,Oe=N(ye,D,P,B,Z),Se=N(ye,M,F,z,Q),Ee=Oe*Oe+Se*Se;ce+=be[we]*Math.sqrt(Ee)}return ne*ce}function N(D,M,P,F,B){return D*(D*(-3*M+9*P-9*F+3*B)+6*M-12*P+6*F)-3*M+3*P}i.default.Font=function(D){this.parent=D,this.cache={},this.font=void 0},i.default.Font.prototype.textBounds=function(D){var M,P=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0,F=2<arguments.length&&arguments[2]!==void 0?arguments[2]:0,B=3<arguments.length?arguments[3]:void 0,z=4<arguments.length?arguments[4]:void 0,Z=z&&z.renderer&&z.renderer._pInst||this.parent,Q=Z._renderer.drawingContext;if(Q.textAlign||l.LEFT,Q.textBaseline||l.BASELINE,B=B||Z._renderer._textSize,!M){var K,ne,re=[],ce=[],be=[];be[0]=[];var we=[],ye=this._scale(B),Oe=Z._renderer.textLeading(),Se=0;this.font.forEachGlyph(D,P,F,B,z,function(ie,ve,he,Fe){var me=ie.getMetrics();ie.index===0||ie.index===10?be[Se+=1]=[]:(be[Se].push(ve+me.xMin*ye),be[Se].push(ve+me.xMax*ye),we.push(he+Se*Oe+-me.yMin*ye),we.push(he+Se*Oe+-me.yMax*ye))}),0<be[Se].length&&(re[Se]=Math.min.apply(null,be[Se]),ce[Se]=Math.max.apply(null,be[Se]));for(var Ee=0,j=0;j<=Se;j++){re[j]=Math.min.apply(null,be[j]),ce[j]=Math.max.apply(null,be[j]);var W=ce[j]-re[j];Ee<W&&(Ee=W)}var J=Math.min.apply(null,re);M={x:J,y:K=Math.min.apply(null,we),h:Math.max.apply(null,we)-K,w:Ee,advance:J-P},ne=this._handleAlignment(Z._renderer,D,M.x,M.y,M.w+M.advance),M.x=ne.x,M.y=ne.y}return M},i.default.Font.prototype.textToPoints=function(D,M,P,F,B){var z,Z=0,Q=[],K=this._getGlyphs(D);F=F||this.parent._renderer._textSize;for(var ne=0;ne<K.length;ne++){if(!(K[z=ne].name&&K[z].name==="space"||D.length===K.length&&D[z]===" "))for(var re=c(K[ne].getPath(M,P,F).commands),ce=0;ce<re.length;ce++)for(var be=d(re[ce],B),we=0;we<be.length;we++)be[we].x+=Z,Q.push(be[we]);Z+=K[ne].advanceWidth*this._scale(F)}return Q},i.default.Font.prototype._getGlyphs=function(D){return this.font.stringToGlyphs(D)},i.default.Font.prototype._getPath=function(D,M,P,F){var B=(F&&F.renderer&&F.renderer._pInst||this.parent)._renderer,z=this._handleAlignment(B,D,M,P);return this.font.getPath(D,z.x,z.y,B._textSize,F)},i.default.Font.prototype._getPathData=function(D,M,P,F){var B=3;return typeof D=="string"&&2<arguments.length?D=this._getPath(D,M,P,F):h(M)==="object"&&(F=M),F&&typeof F.decimals=="number"&&(B=F.decimals),D.toPathData(B)},i.default.Font.prototype._getSVG=function(D,M,P,F){var B=3;return typeof D=="string"&&2<arguments.length?D=this._getPath(D,M,P,F):h(M)==="object"&&(F=M),F&&(typeof F.decimals=="number"&&(B=F.decimals),typeof F.strokeWidth=="number"&&(D.strokeWidth=F.strokeWidth),F.fill!==void 0&&(D.fill=F.fill),F.stroke!==void 0&&(D.stroke=F.stroke)),D.toSVG(B)},i.default.Font.prototype._renderPath=function(D,M,P,F){var B,z=F&&F.renderer||this.parent._renderer,Z=z.drawingContext;B=h(D)==="object"&&D.commands?D.commands:this._getPath(D,M,P,F).commands,Z.beginPath();var Q=!0,K=!1,ne=void 0;try{for(var re,ce=B[Symbol.iterator]();!(Q=(re=ce.next()).done);Q=!0){var be=re.value;be.type==="M"?Z.moveTo(be.x,be.y):be.type==="L"?Z.lineTo(be.x,be.y):be.type==="C"?Z.bezierCurveTo(be.x1,be.y1,be.x2,be.y2,be.x,be.y):be.type==="Q"?Z.quadraticCurveTo(be.x1,be.y1,be.x,be.y):be.type==="Z"&&Z.closePath()}}catch(we){K=!0,ne=we}finally{try{Q||ce.return==null||ce.return()}finally{if(K)throw ne}}return z._doStroke&&z._strokeSet&&Z.stroke(),z._doFill&&(z._fillSet||z._setFill(l._DEFAULT_TEXT_FILL),Z.fill()),this},i.default.Font.prototype._textWidth=function(D,M){return this.font.getAdvanceWidth(D,M)},i.default.Font.prototype._textAscent=function(D){return this.font.ascender*this._scale(D)},i.default.Font.prototype._textDescent=function(D){return-this.font.descender*this._scale(D)},i.default.Font.prototype._scale=function(D){return 1/this.font.unitsPerEm*(D||this.parent._renderer._textSize)},i.default.Font.prototype._handleAlignment=function(D,M,P,F,B){var z=D._textSize;switch(B===void 0&&(B=this._textWidth(M,z)),D._textAlign){case l.CENTER:P-=B/2;break;case l.RIGHT:P-=B}switch(D._textBaseline){case l.TOP:F+=this._textAscent(z);break;case l.CENTER:F+=this._textAscent(z)/2;break;case l.BOTTOM:F-=this._textDescent(z)}return{x:P,y:F}};var O=i.default;o.default=O},{"../core/constants":253,"../core/main":264,"core-js/modules/es.array.concat":149,"core-js/modules/es.array.fill":151,"core-js/modules/es.array.iterator":158,"core-js/modules/es.array.join":159,"core-js/modules/es.array.slice":162,"core-js/modules/es.array.splice":164,"core-js/modules/es.function.name":166,"core-js/modules/es.number.to-fixed":172,"core-js/modules/es.object.to-string":177,"core-js/modules/es.regexp.exec":181,"core-js/modules/es.string.iterator":186,"core-js/modules/es.string.split":191,"core-js/modules/es.symbol":196,"core-js/modules/es.symbol.description":194,"core-js/modules/es.symbol.iterator":195,"core-js/modules/web.dom-collections.iterator":229}],303:[function(n,s,o){n("core-js/modules/es.array.concat"),n("core-js/modules/es.array.slice"),n("core-js/modules/es.array.splice"),n("core-js/modules/es.array-buffer.constructor"),n("core-js/modules/es.object.to-string"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var a,i=(a=n("../core/main"))&&a.__esModule?a:{default:a};i.default.prototype.append=function(u,h){return u.push(h),u},i.default.prototype.arrayCopy=function(u,h,d,c,f){var p,m;u=f!==void 0?(m=Math.min(f,u.length),p=c,u.slice(h,m+h)):(m=d!==void 0?(m=d,Math.min(m,u.length)):u.length,p=0,d=h,u.slice(0,m)),Array.prototype.splice.apply(d,[p,m].concat(u))},i.default.prototype.concat=function(u,h){return u.concat(h)},i.default.prototype.reverse=function(u){return u.reverse()},i.default.prototype.shorten=function(u){return u.pop(),u},i.default.prototype.shuffle=function(u,h){for(var d,c,f=ArrayBuffer&&ArrayBuffer.isView&&ArrayBuffer.isView(u),p=(u=h||f?u:u.slice()).length;1<p;)d=this.random(0,1)*p|0,c=u[--p],u[p]=u[d],u[d]=c;return u},i.default.prototype.sort=function(u,h){var d=h?u.slice(0,Math.min(h,u.length)):u,c=h?u.slice(Math.min(h,u.length)):[];return(d=typeof d[0]=="string"?d.sort():d.sort(function(f,p){return f-p})).concat(c)},i.default.prototype.splice=function(u,h,d){return Array.prototype.splice.apply(u,[d,0].concat(h)),u},i.default.prototype.subset=function(u,h,d){return d!==void 0?u.slice(h,h+d):u.slice(h,u.length)};var l=i.default;o.default=l},{"../core/main":264,"core-js/modules/es.array-buffer.constructor":148,"core-js/modules/es.array.concat":149,"core-js/modules/es.array.slice":162,"core-js/modules/es.array.splice":164,"core-js/modules/es.object.to-string":177}],304:[function(n,s,o){n("core-js/modules/es.array.map"),n("core-js/modules/es.number.constructor"),n("core-js/modules/es.object.to-string"),n("core-js/modules/es.regexp.to-string"),n("core-js/modules/es.string.repeat"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var a,i=(a=n("../core/main"))&&a.__esModule?a:{default:a};i.default.prototype.float=function(u){return u instanceof Array?u.map(parseFloat):parseFloat(u)},i.default.prototype.int=function(u){var h=1<arguments.length&&arguments[1]!==void 0?arguments[1]:10;return u===1/0||u==="Infinity"?1/0:u===-1/0||u==="-Infinity"?-1/0:typeof u=="string"?parseInt(u,h):typeof u=="number"?0|u:typeof u=="boolean"?u?1:0:u instanceof Array?u.map(function(d){return i.default.prototype.int(d,h)}):void 0},i.default.prototype.str=function(u){return u instanceof Array?u.map(i.default.prototype.str):String(u)},i.default.prototype.boolean=function(u){return typeof u=="number"?u!==0:typeof u=="string"?u.toLowerCase()==="true":typeof u=="boolean"?u:u instanceof Array?u.map(i.default.prototype.boolean):void 0},i.default.prototype.byte=function(u){var h=i.default.prototype.int(u,10);return typeof h=="number"?(h+128)%256-128:h instanceof Array?h.map(i.default.prototype.byte):void 0},i.default.prototype.char=function(u){return typeof u!="number"||isNaN(u)?u instanceof Array?u.map(i.default.prototype.char):typeof u=="string"?i.default.prototype.char(parseInt(u,10)):void 0:String.fromCharCode(u)},i.default.prototype.unchar=function(u){return typeof u=="string"&&u.length===1?u.charCodeAt(0):u instanceof Array?u.map(i.default.prototype.unchar):void 0},i.default.prototype.hex=function(u,h){if(h=h==null?h=8:h,u instanceof Array)return u.map(function(c){return i.default.prototype.hex(c,h)});if(u===1/0||u===-1/0)return(u===1/0?"F":"0").repeat(h);if(typeof u=="number"){u<0&&(u=4294967295+u+1);for(var d=Number(u).toString(16).toUpperCase();d.length<h;)d="0".concat(d);return d.length>=h&&(d=d.substring(d.length-h,d.length)),d}},i.default.prototype.unhex=function(u){return u instanceof Array?u.map(i.default.prototype.unhex):parseInt("0x".concat(u),16)};var l=i.default;o.default=l},{"../core/main":264,"core-js/modules/es.array.map":161,"core-js/modules/es.number.constructor":170,"core-js/modules/es.object.to-string":177,"core-js/modules/es.regexp.to-string":182,"core-js/modules/es.string.repeat":188}],305:[function(n,s,o){n("core-js/modules/es.array.filter"),n("core-js/modules/es.array.index-of"),n("core-js/modules/es.array.join"),n("core-js/modules/es.array.map"),n("core-js/modules/es.array.slice"),n("core-js/modules/es.object.to-string"),n("core-js/modules/es.regexp.constructor"),n("core-js/modules/es.regexp.exec"),n("core-js/modules/es.regexp.to-string"),n("core-js/modules/es.string.match"),n("core-js/modules/es.string.replace"),n("core-js/modules/es.string.split"),n("core-js/modules/es.string.trim"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var a,i=(a=n("../core/main"))&&a.__esModule?a:{default:a};function l(f,p,m){var g=f<0,y=g?f.toString().substring(1):f.toString(),v=y.indexOf("."),b=v!==-1?y.substring(0,v):y,w=v!==-1?y.substring(v+1):"",_=g?"-":"";if(m!==void 0){var I="";(v!==-1||0<m-w.length)&&(I="."),w.length>m&&(w=w.substring(0,m));for(var C=0;C<p-b.length;C++)_+="0";_+=b,_+=I,_+=w;for(var N=0;N<m-w.length;N++)_+="0";return _}for(var O=0;O<Math.max(p-b.length,0);O++)_+="0";return _+=y}function u(f,p){var m=(f=f.toString()).indexOf("."),g=m!==-1?f.substring(m):"",y=m!==-1?f.substring(0,m):f;if(y=y.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),p===0)g="";else if(p!==void 0)if(p>g.length)for(var v=p-(g+=m===-1?".":"").length+1,b=0;b<v;b++)g+="0";else g=g.substring(0,p+1);return y+g}function h(f){return 0<parseFloat(f)?"+".concat(f.toString()):f.toString()}function d(f){return 0<=parseFloat(f)?" ".concat(f.toString()):f.toString()}n("../core/friendly_errors/validate_params"),n("../core/friendly_errors/file_errors"),n("../core/friendly_errors/fes_core"),i.default.prototype.join=function(f,p){return i.default._validateParameters("join",arguments),f.join(p)},i.default.prototype.match=function(f,p){return i.default._validateParameters("match",arguments),f.match(p)},i.default.prototype.matchAll=function(f,p){i.default._validateParameters("matchAll",arguments);for(var m=new RegExp(p,"g"),g=m.exec(f),y=[];g!==null;)y.push(g),g=m.exec(f);return y},i.default.prototype.nf=function(f,p,m){return i.default._validateParameters("nf",arguments),f instanceof Array?f.map(function(g){return l(g,p,m)}):Object.prototype.toString.call(f)==="[object Arguments]"?f.length===3?this.nf(f[0],f[1],f[2]):f.length===2?this.nf(f[0],f[1]):this.nf(f[0]):l(f,p,m)},i.default.prototype.nfc=function(f,p){return i.default._validateParameters("nfc",arguments),f instanceof Array?f.map(function(m){return u(m,p)}):u(f,p)},i.default.prototype.nfp=function(){for(var f=arguments.length,p=new Array(f),m=0;m<f;m++)p[m]=arguments[m];i.default._validateParameters("nfp",p);var g=i.default.prototype.nf.apply(this,p);return g instanceof Array?g.map(h):h(g)},i.default.prototype.nfs=function(){for(var f=arguments.length,p=new Array(f),m=0;m<f;m++)p[m]=arguments[m];i.default._validateParameters("nfs",p);var g=i.default.prototype.nf.apply(this,p);return g instanceof Array?g.map(d):d(g)},i.default.prototype.split=function(f,p){return i.default._validateParameters("split",arguments),f.split(p)},i.default.prototype.splitTokens=function(f,p){var m;if(i.default._validateParameters("splitTokens",arguments),p!==void 0){var g=p,y=/\]/g.exec(g),v=/\[/g.exec(g);m=v&&y?(g=g.slice(0,y.index)+g.slice(y.index+1),v=/\[/g.exec(g),g=g.slice(0,v.index)+g.slice(v.index+1),new RegExp("[\\[".concat(g,"\\]]"),"g")):y?(g=g.slice(0,y.index)+g.slice(y.index+1),new RegExp("[".concat(g,"\\]]"),"g")):v?(g=g.slice(0,v.index)+g.slice(v.index+1),new RegExp("[".concat(g,"\\[]"),"g")):new RegExp("[".concat(g,"]"),"g")}else m=/\s/g;return f.split(m).filter(function(b){return b})},i.default.prototype.trim=function(f){return i.default._validateParameters("trim",arguments),f instanceof Array?f.map(this.trim):f.trim()};var c=i.default;o.default=c},{"../core/friendly_errors/fes_core":255,"../core/friendly_errors/file_errors":256,"../core/friendly_errors/validate_params":259,"../core/main":264,"core-js/modules/es.array.filter":152,"core-js/modules/es.array.index-of":157,"core-js/modules/es.array.join":159,"core-js/modules/es.array.map":161,"core-js/modules/es.array.slice":162,"core-js/modules/es.object.to-string":177,"core-js/modules/es.regexp.constructor":180,"core-js/modules/es.regexp.exec":181,"core-js/modules/es.regexp.to-string":182,"core-js/modules/es.string.match":187,"core-js/modules/es.string.replace":189,"core-js/modules/es.string.split":191,"core-js/modules/es.string.trim":193}],306:[function(n,s,o){Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var a,i=(a=n("../core/main"))&&a.__esModule?a:{default:a};i.default.prototype.day=function(){return new Date().getDate()},i.default.prototype.hour=function(){return new Date().getHours()},i.default.prototype.minute=function(){return new Date().getMinutes()},i.default.prototype.millis=function(){return this._millisStart===-1?0:window.performance.now()-this._millisStart},i.default.prototype.month=function(){return new Date().getMonth()+1},i.default.prototype.second=function(){return new Date().getSeconds()},i.default.prototype.year=function(){return new Date().getFullYear()};var l=i.default;o.default=l},{"../core/main":264}],307:[function(n,s,o){function a(f){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(p){return typeof p}:function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":typeof p})(f)}n("core-js/modules/es.array.concat"),n("core-js/modules/es.number.to-fixed"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var i,l=(i=n("../core/main"))&&i.__esModule?i:{default:i};n("./p5.Geometry");var u=function(f){if(f&&f.__esModule)return f;if(f===null||a(f)!=="object"&&typeof f!="function")return{default:f};var p=h();if(p&&p.has(f))return p.get(f);var m={},g=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var y in f)if(Object.prototype.hasOwnProperty.call(f,y)){var v=g?Object.getOwnPropertyDescriptor(f,y):null;v&&(v.get||v.set)?Object.defineProperty(m,y,v):m[y]=f[y]}return m.default=f,p&&p.set(f,m),m}(n("../core/constants"));function h(){if(typeof WeakMap!="function")return null;var f=new WeakMap;return h=function(){return f},f}l.default.prototype.plane=function(f,p,m,g){this._assert3d("plane"),l.default._validateParameters("plane",arguments),f===void 0&&(f=50),p===void 0&&(p=f),m===void 0&&(m=1),g===void 0&&(g=1);var y="plane|".concat(m,"|").concat(g);if(!this._renderer.geometryInHash(y)){var v=new l.default.Geometry(m,g,function(){for(var b,w,_,I=0;I<=this.detailY;I++){w=I/this.detailY;for(var C=0;C<=this.detailX;C++)b=C/this.detailX,_=new l.default.Vector(b-.5,w-.5,0),this.vertices.push(_),this.uvs.push(b,w)}});v.computeFaces().computeNormals(),m<=1&&g<=1?v._makeTriangleEdges()._edgesToVertices():this._renderer._doStroke&&console.log("Cannot draw stroke on plane objects with more than 1 detailX or 1 detailY"),this._renderer.createBuffers(y,v)}return this._renderer.drawBuffersScaled(y,f,p,1),this},l.default.prototype.box=function(f,p,m,g,y){this._assert3d("box"),l.default._validateParameters("box",arguments),f===void 0&&(f=50),p===void 0&&(p=f),m===void 0&&(m=p);var v=this._renderer.attributes&&this._renderer.attributes.perPixelLighting;g===void 0&&(g=v?1:4),y===void 0&&(y=v?1:4);var b="box|".concat(g,"|").concat(y);if(!this._renderer.geometryInHash(b)){var w=new l.default.Geometry(g,y,function(){var _=[[0,4,2,6],[1,3,5,7],[0,1,4,5],[2,6,3,7],[0,2,1,3],[4,5,6,7]];this.strokeIndices=[[0,1],[1,3],[3,2],[6,7],[8,9],[9,11],[14,15],[16,17],[17,19],[18,19],[20,21],[22,23]];for(var I=0;I<_.length;I++){for(var C=_[I],N=4*I,O=0;O<4;O++){var D=C[O],M=new l.default.Vector((2*(1&D)-1)/2,((2&D)-1)/2,((4&D)/2-1)/2);this.vertices.push(M),this.uvs.push(1&O,(2&O)/2)}this.faces.push([N,1+N,2+N]),this.faces.push([2+N,1+N,3+N])}});w.computeNormals(),g<=4&&y<=4?w._makeTriangleEdges()._edgesToVertices():this._renderer._doStroke&&console.log("Cannot draw stroke on box objects with more than 4 detailX or 4 detailY"),this._renderer.createBuffers(b,w)}return this._renderer.drawBuffersScaled(b,f,p,m),this},l.default.prototype.sphere=function(f,p,m){return this._assert3d("sphere"),l.default._validateParameters("sphere",arguments),f===void 0&&(f=50),p===void 0&&(p=24),m===void 0&&(m=16),this.ellipsoid(f,f,f,p,m),this};function d(f,p,m,g,y,v,b){f=f<=0?1:f,p=p<0?0:p,m=m<=0?f:m,g=g<3?3:g;var w,_,I,C=(v=v===void 0||v)?-2:0,N=(y=y<1?1:y)+((b=b===void 0?p!==0:b)?2:0),O=Math.atan2(f-p,m),D=Math.sin(O),M=Math.cos(O);for(w=C;w<=N;++w){var P=w/y,F=m*P,B=void 0;for(B=w<0?(P=F=0,f):y<w?(F=m,P=1,p):f+(p-f)*P,w!==-2&&w!==y+2||(B=0),F-=m/2,_=0;_<g;++_){var z=_/(g-1),Z=2*Math.PI*z,Q=Math.sin(Z),K=Math.cos(Z);this.vertices.push(new l.default.Vector(Q*B,F,K*B));var ne=void 0;ne=w<0?new l.default.Vector(0,-1,0):y<w&&p?new l.default.Vector(0,1,0):new l.default.Vector(Q*M,D,K*M),this.vertexNormals.push(ne),this.uvs.push(z,P)}}var re=0;if(v){for(I=0;I<g;++I){var ce=(I+1)%g;this.faces.push([re+I,re+g+ce,re+g+I])}re+=2*g}for(w=0;w<y;++w){for(_=0;_<g;++_){var be=(_+1)%g;this.faces.push([re+_,re+be,re+g+be]),this.faces.push([re+_,re+g+be,re+g+_])}re+=g}if(b)for(re+=g,_=0;_<g;++_)this.faces.push([re+_,re+(_+1)%g,re+g])}l.default.prototype.cylinder=function(f,p,m,g,y,v){this._assert3d("cylinder"),l.default._validateParameters("cylinder",arguments),f===void 0&&(f=50),p===void 0&&(p=f),m===void 0&&(m=24),g===void 0&&(g=1),v===void 0&&(v=!0),y===void 0&&(y=!0);var b="cylinder|".concat(m,"|").concat(g,"|").concat(y,"|").concat(v);if(!this._renderer.geometryInHash(b)){var w=new l.default.Geometry(m,g);d.call(w,1,1,1,m,g,y,v),m<=24&&g<=16?w._makeTriangleEdges()._edgesToVertices():this._renderer._doStroke&&console.log("Cannot draw stroke on cylinder objects with more than 24 detailX or 16 detailY"),this._renderer.createBuffers(b,w)}return this._renderer.drawBuffersScaled(b,f,p,f),this},l.default.prototype.cone=function(f,p,m,g,y){this._assert3d("cone"),l.default._validateParameters("cone",arguments),f===void 0&&(f=50),p===void 0&&(p=f),m===void 0&&(m=24),g===void 0&&(g=1),y===void 0&&(y=!0);var v="cone|".concat(m,"|").concat(g,"|").concat(y);if(!this._renderer.geometryInHash(v)){var b=new l.default.Geometry(m,g);d.call(b,1,0,1,m,g,y,!1),m<=24&&g<=16?b._makeTriangleEdges()._edgesToVertices():this._renderer._doStroke&&console.log("Cannot draw stroke on cone objects with more than 24 detailX or 16 detailY"),this._renderer.createBuffers(v,b)}return this._renderer.drawBuffersScaled(v,f,p,f),this},l.default.prototype.ellipsoid=function(f,p,m,g,y){this._assert3d("ellipsoid"),l.default._validateParameters("ellipsoid",arguments),f===void 0&&(f=50),p===void 0&&(p=f),m===void 0&&(m=f),g===void 0&&(g=24),y===void 0&&(y=16);var v="ellipsoid|".concat(g,"|").concat(y);if(!this._renderer.geometryInHash(v)){var b=new l.default.Geometry(g,y,function(){for(var w=0;w<=this.detailY;w++)for(var _=w/this.detailY,I=Math.PI*_-Math.PI/2,C=Math.cos(I),N=Math.sin(I),O=0;O<=this.detailX;O++){var D=O/this.detailX,M=2*Math.PI*D,P=Math.cos(M),F=Math.sin(M),B=new l.default.Vector(C*F,N,C*P);this.vertices.push(B),this.vertexNormals.push(B),this.uvs.push(D,_)}});b.computeFaces(),g<=24&&y<=24?b._makeTriangleEdges()._edgesToVertices():this._renderer._doStroke&&console.log("Cannot draw stroke on ellipsoids with more than 24 detailX or 24 detailY"),this._renderer.createBuffers(v,b)}return this._renderer.drawBuffersScaled(v,f,p,m),this},l.default.prototype.torus=function(f,p,m,g){if(this._assert3d("torus"),l.default._validateParameters("torus",arguments),f===void 0)f=50;else if(!f)return;if(p===void 0)p=10;else if(!p)return;m===void 0&&(m=24),g===void 0&&(g=16);var y=(p/f).toPrecision(4),v="torus|".concat(y,"|").concat(m,"|").concat(g);if(!this._renderer.geometryInHash(v)){var b=new l.default.Geometry(m,g,function(){for(var w=0;w<=this.detailY;w++)for(var _=w/this.detailY,I=2*Math.PI*_,C=Math.cos(I),N=Math.sin(I),O=1+y*C,D=0;D<=this.detailX;D++){var M=D/this.detailX,P=2*Math.PI*M,F=Math.cos(P),B=Math.sin(P),z=new l.default.Vector(O*F,O*B,y*N),Z=new l.default.Vector(C*F,C*B,N);this.vertices.push(z),this.vertexNormals.push(Z),this.uvs.push(M,_)}});b.computeFaces(),m<=24&&g<=16?b._makeTriangleEdges()._edgesToVertices():this._renderer._doStroke&&console.log("Cannot draw strokes on torus object with more than 24 detailX or 16 detailY"),this._renderer.createBuffers(v,b)}return this._renderer.drawBuffersScaled(v,f,f,f),this},l.default.RendererGL.prototype.point=function(f,p,m){m===void 0&&(m=0);var g=[];return g.push(new l.default.Vector(f,p,m)),this._drawPoints(g,this.immediateMode.buffers.point),this},l.default.RendererGL.prototype.triangle=function(f){var p=f[0],m=f[1],g=f[2],y=f[3],v=f[4],b=f[5];if(!this.geometryInHash("tri")){var w=new l.default.Geometry(1,1,function(){var C=[];C.push(new l.default.Vector(0,0,0)),C.push(new l.default.Vector(0,1,0)),C.push(new l.default.Vector(1,0,0)),this.strokeIndices=[[0,1],[1,2],[2,0]],this.vertices=C,this.faces=[[0,1,2]],this.uvs=[0,0,0,1,1,1]});w._makeTriangleEdges()._edgesToVertices(),w.computeNormals(),this.createBuffers("tri",w)}var _=this.uMVMatrix.copy();try{var I=new l.default.Matrix([g-p,y-m,0,0,v-p,b-m,0,0,0,0,1,0,p,m,0,1]).mult(this.uMVMatrix);this.uMVMatrix=I,this.drawBuffers("tri")}finally{this.uMVMatrix=_}return this},l.default.RendererGL.prototype.ellipse=function(f){this.arc(f[0],f[1],f[2],f[3],0,u.TWO_PI,u.OPEN,f[4])},l.default.RendererGL.prototype.arc=function(f){var p,m,g=f,y=arguments[1],v=arguments[2],b=arguments[3],w=arguments[4],_=arguments[5],I=arguments[6],C=arguments[7]||25;if(m=Math.abs(_-w)>=u.TWO_PI?"".concat(p="ellipse","|").concat(C,"|"):"".concat(p="arc","|").concat(w,"|").concat(_,"|").concat(I,"|").concat(C,"|"),!this.geometryInHash(m)){var N=new l.default.Geometry(C,1,function(){if(this.strokeIndices=[],w.toFixed(10)!==_.toFixed(10)){I!==u.PIE&&I!==void 0||(this.vertices.push(new l.default.Vector(.5,.5,0)),this.uvs.push([.5,.5]));for(var D=0;D<=C;D++){var M=(_-w)*(D/C)+w,P=.5+Math.cos(M)/2,F=.5+Math.sin(M)/2;this.vertices.push(new l.default.Vector(P,F,0)),this.uvs.push([P,F]),D<C-1&&(this.faces.push([0,D+1,D+2]),this.strokeIndices.push([D+1,D+2]))}switch(I){case u.PIE:this.faces.push([0,this.vertices.length-2,this.vertices.length-1]),this.strokeIndices.push([0,1]),this.strokeIndices.push([this.vertices.length-2,this.vertices.length-1]),this.strokeIndices.push([0,this.vertices.length-1]);break;case u.CHORD:this.strokeIndices.push([0,1]),this.strokeIndices.push([0,this.vertices.length-1]);break;case u.OPEN:this.strokeIndices.push([0,1]);break;default:this.faces.push([0,this.vertices.length-2,this.vertices.length-1]),this.strokeIndices.push([this.vertices.length-2,this.vertices.length-1])}}});N.computeNormals(),C<=50?N._makeTriangleEdges()._edgesToVertices(N):this._doStroke&&console.log("Cannot apply a stroke to an ".concat(p," with more than 50 detail")),this.createBuffers(m,N)}var O=this.uMVMatrix.copy();try{this.uMVMatrix.translate([g,y,0]),this.uMVMatrix.scale(v,b,1),this.drawBuffers(m)}finally{this.uMVMatrix=O}return this},l.default.RendererGL.prototype.rect=function(f){var p=this._pInst._glAttributes.perPixelLighting,m=f[0],g=f[1],y=f[2],v=f[3],b=f[4]||(p?1:24),w=f[5]||(p?1:16),_="rect|".concat(b,"|").concat(w);if(!this.geometryInHash(_)){var I=new l.default.Geometry(b,w,function(){for(var N=0;N<=this.detailY;N++)for(var O=N/this.detailY,D=0;D<=this.detailX;D++){var M=D/this.detailX,P=new l.default.Vector(M,O,0);this.vertices.push(P),this.uvs.push(M,O)}0<b&&0<w&&(this.strokeIndices=[[0,b],[b,(b+1)*(w+1)-1],[(b+1)*(w+1)-1,(b+1)*w],[(b+1)*w,0]])});I.computeFaces().computeNormals()._makeTriangleEdges()._edgesToVertices(),this.createBuffers(_,I)}var C=this.uMVMatrix.copy();try{this.uMVMatrix.translate([m,g,0]),this.uMVMatrix.scale(y,v,1),this.drawBuffers(_)}finally{this.uMVMatrix=C}return this},l.default.RendererGL.prototype.quad=function(f,p,m,g,y,v,b,w,_,I,C,N,O,D){O===void 0&&(O=2),D===void 0&&(D=2);var M="quad|".concat(f,"|").concat(p,"|").concat(m,"|").concat(g,"|").concat(y,"|").concat(v,"|").concat(b,"|").concat(w,"|").concat(_,"|").concat(I,"|").concat(C,"|").concat(N,"|").concat(O,"|").concat(D);if(!this.geometryInHash(M)){var P=new l.default.Geometry(O,D,function(){for(var ne=1/(this.detailX-1),re=1/(this.detailY-1),ce=0;ce<this.detailY;ce++)for(var be=0;be<this.detailX;be++){var we=be*ne,ye=ce*re,Oe=(1-we)*((1-ye)*f+ye*I)+we*((1-ye)*g+ye*b),Se=(1-we)*((1-ye)*p+ye*C)+we*((1-ye)*y+ye*w),Ee=(1-we)*((1-ye)*m+ye*N)+we*((1-ye)*v+ye*_);this.vertices.push(new l.default.Vector(Oe,Se,Ee)),this.uvs.push([we,ye])}});P.faces=[];for(var F=0;F<D-1;F++)for(var B=0;B<O-1;B++){var z=B+F*O,Z=B+1+F*O,Q=B+1+(F+1)*O,K=B+(F+1)*O;P.faces.push([z,Z,Q]),P.faces.push([z,Q,K])}P.computeNormals()._makeTriangleEdges()._edgesToVertices(),this.createBuffers(M,P)}return this.drawBuffers(M),this},l.default.RendererGL.prototype.bezier=function(f,p,m,g,y,v,b,w,_,I,C,N){arguments.length===8&&(C=w,I=b,w=v,b=y,y=g,g=m,m=v=_=N=0);var O=this._pInst._bezierDetail||20;this.beginShape();for(var D=0;D<=O;D++){var M=Math.pow(1-D/O,3),P=D/O*3*Math.pow(1-D/O,2),F=3*Math.pow(D/O,2)*(1-D/O),B=Math.pow(D/O,3);this.vertex(f*M+g*P+b*F+I*B,p*M+y*P+w*F+C*B,m*M+v*P+_*F+N*B)}return this.endShape(),this},l.default.RendererGL.prototype.curve=function(f,p,m,g,y,v,b,w,_,I,C,N){arguments.length===8&&(I=b,C=w,b=y,w=g,y=g=m,m=v=_=N=0);var O=this._pInst._curveDetail;this.beginShape();for(var D=0;D<=O;D++){var M=.5*Math.pow(D/O,3),P=.5*Math.pow(D/O,2),F=D/O*.5,B=M*(3*g-f-3*b+I)+P*(2*f-5*g+4*b-I)+F*(-f+b)+2*g*.5,z=M*(3*y-p-3*w+C)+P*(2*p-5*y+4*w-C)+F*(-p+w)+2*y*.5,Z=M*(3*v-m-3*_+N)+P*(2*m-5*v+4*_-N)+F*(-m+_)+2*v*.5;this.vertex(B,z,Z)}return this.endShape(),this},l.default.RendererGL.prototype.line=function(){return arguments.length===6?(this.beginShape(u.LINES),this.vertex(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2]),this.vertex(arguments.length<=3?void 0:arguments[3],arguments.length<=4?void 0:arguments[4],arguments.length<=5?void 0:arguments[5]),this.endShape()):arguments.length===4&&(this.beginShape(u.LINES),this.vertex(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],0),this.vertex(arguments.length<=2?void 0:arguments[2],arguments.length<=3?void 0:arguments[3],0),this.endShape()),this},l.default.RendererGL.prototype.bezierVertex=function(){if(this.immediateMode._bezierVertex.length===0)throw Error("vertex() must be used once before calling bezierVertex()");var f,p,m,g,y,v=[],b=[],w=[],_=arguments.length;if((f=0)===this._lookUpTableBezier.length||this._lutBezierDetail!==this._pInst._curveDetail){this._lookUpTableBezier=[],this._lutBezierDetail=this._pInst._curveDetail;for(var I=1/this._lutBezierDetail,C=0,N=1,O=0;C<1;){if(f=parseFloat(C.toFixed(6)),this._lookUpTableBezier[O]=this._bezierCoefficients(f),N.toFixed(6)===I.toFixed(6)){f=parseFloat(N.toFixed(6))+parseFloat(C.toFixed(6)),++O,this._lookUpTableBezier[O]=this._bezierCoefficients(f);break}C+=I,N-=I,++O}}var D=this._lookUpTableBezier.length;if(_===6){for(this.isBezier=!0,v=[this.immediateMode._bezierVertex[0],arguments.length<=0?void 0:arguments[0],arguments.length<=2?void 0:arguments[2],arguments.length<=4?void 0:arguments[4]],b=[this.immediateMode._bezierVertex[1],arguments.length<=1?void 0:arguments[1],arguments.length<=3?void 0:arguments[3],arguments.length<=5?void 0:arguments[5]],y=0;y<D;y++)p=v[0]*this._lookUpTableBezier[y][0]+v[1]*this._lookUpTableBezier[y][1]+v[2]*this._lookUpTableBezier[y][2]+v[3]*this._lookUpTableBezier[y][3],m=b[0]*this._lookUpTableBezier[y][0]+b[1]*this._lookUpTableBezier[y][1]+b[2]*this._lookUpTableBezier[y][2]+b[3]*this._lookUpTableBezier[y][3],this.vertex(p,m);this.immediateMode._bezierVertex[0]=arguments.length<=4?void 0:arguments[4],this.immediateMode._bezierVertex[1]=arguments.length<=5?void 0:arguments[5]}else if(_===9){for(this.isBezier=!0,v=[this.immediateMode._bezierVertex[0],arguments.length<=0?void 0:arguments[0],arguments.length<=3?void 0:arguments[3],arguments.length<=6?void 0:arguments[6]],b=[this.immediateMode._bezierVertex[1],arguments.length<=1?void 0:arguments[1],arguments.length<=4?void 0:arguments[4],arguments.length<=7?void 0:arguments[7]],w=[this.immediateMode._bezierVertex[2],arguments.length<=2?void 0:arguments[2],arguments.length<=5?void 0:arguments[5],arguments.length<=8?void 0:arguments[8]],y=0;y<D;y++)p=v[0]*this._lookUpTableBezier[y][0]+v[1]*this._lookUpTableBezier[y][1]+v[2]*this._lookUpTableBezier[y][2]+v[3]*this._lookUpTableBezier[y][3],m=b[0]*this._lookUpTableBezier[y][0]+b[1]*this._lookUpTableBezier[y][1]+b[2]*this._lookUpTableBezier[y][2]+b[3]*this._lookUpTableBezier[y][3],g=w[0]*this._lookUpTableBezier[y][0]+w[1]*this._lookUpTableBezier[y][1]+w[2]*this._lookUpTableBezier[y][2]+w[3]*this._lookUpTableBezier[y][3],this.vertex(p,m,g);this.immediateMode._bezierVertex[0]=arguments.length<=6?void 0:arguments[6],this.immediateMode._bezierVertex[1]=arguments.length<=7?void 0:arguments[7],this.immediateMode._bezierVertex[2]=arguments.length<=8?void 0:arguments[8]}},l.default.RendererGL.prototype.quadraticVertex=function(){if(this.immediateMode._quadraticVertex.length===0)throw Error("vertex() must be used once before calling quadraticVertex()");var f,p,m,g,y,v=[],b=[],w=[],_=arguments.length;if((f=0)===this._lookUpTableQuadratic.length||this._lutQuadraticDetail!==this._pInst._curveDetail){this._lookUpTableQuadratic=[],this._lutQuadraticDetail=this._pInst._curveDetail;for(var I=1/this._lutQuadraticDetail,C=0,N=1,O=0;C<1;){if(f=parseFloat(C.toFixed(6)),this._lookUpTableQuadratic[O]=this._quadraticCoefficients(f),N.toFixed(6)===I.toFixed(6)){f=parseFloat(N.toFixed(6))+parseFloat(C.toFixed(6)),++O,this._lookUpTableQuadratic[O]=this._quadraticCoefficients(f);break}C+=I,N-=I,++O}}var D=this._lookUpTableQuadratic.length;if(_===4){for(this.isQuadratic=!0,v=[this.immediateMode._quadraticVertex[0],arguments.length<=0?void 0:arguments[0],arguments.length<=2?void 0:arguments[2]],b=[this.immediateMode._quadraticVertex[1],arguments.length<=1?void 0:arguments[1],arguments.length<=3?void 0:arguments[3]],y=0;y<D;y++)p=v[0]*this._lookUpTableQuadratic[y][0]+v[1]*this._lookUpTableQuadratic[y][1]+v[2]*this._lookUpTableQuadratic[y][2],m=b[0]*this._lookUpTableQuadratic[y][0]+b[1]*this._lookUpTableQuadratic[y][1]+b[2]*this._lookUpTableQuadratic[y][2],this.vertex(p,m);this.immediateMode._quadraticVertex[0]=arguments.length<=2?void 0:arguments[2],this.immediateMode._quadraticVertex[1]=arguments.length<=3?void 0:arguments[3]}else if(_===6){for(this.isQuadratic=!0,v=[this.immediateMode._quadraticVertex[0],arguments.length<=0?void 0:arguments[0],arguments.length<=3?void 0:arguments[3]],b=[this.immediateMode._quadraticVertex[1],arguments.length<=1?void 0:arguments[1],arguments.length<=4?void 0:arguments[4]],w=[this.immediateMode._quadraticVertex[2],arguments.length<=2?void 0:arguments[2],arguments.length<=5?void 0:arguments[5]],y=0;y<D;y++)p=v[0]*this._lookUpTableQuadratic[y][0]+v[1]*this._lookUpTableQuadratic[y][1]+v[2]*this._lookUpTableQuadratic[y][2],m=b[0]*this._lookUpTableQuadratic[y][0]+b[1]*this._lookUpTableQuadratic[y][1]+b[2]*this._lookUpTableQuadratic[y][2],g=w[0]*this._lookUpTableQuadratic[y][0]+w[1]*this._lookUpTableQuadratic[y][1]+w[2]*this._lookUpTableQuadratic[y][2],this.vertex(p,m,g);this.immediateMode._quadraticVertex[0]=arguments.length<=3?void 0:arguments[3],this.immediateMode._quadraticVertex[1]=arguments.length<=4?void 0:arguments[4],this.immediateMode._quadraticVertex[2]=arguments.length<=5?void 0:arguments[5]}},l.default.RendererGL.prototype.curveVertex=function(){var f,p,m,g,y,v=[],b=[],w=[],_=arguments.length;if((f=0)===this._lookUpTableBezier.length||this._lutBezierDetail!==this._pInst._curveDetail){this._lookUpTableBezier=[],this._lutBezierDetail=this._pInst._curveDetail;for(var I=1/this._lutBezierDetail,C=0,N=1,O=0;C<1;){if(f=parseFloat(C.toFixed(6)),this._lookUpTableBezier[O]=this._bezierCoefficients(f),N.toFixed(6)===I.toFixed(6)){f=parseFloat(N.toFixed(6))+parseFloat(C.toFixed(6)),++O,this._lookUpTableBezier[O]=this._bezierCoefficients(f);break}C+=I,N-=I,++O}}var D=this._lookUpTableBezier.length;if(_===2){if(this.immediateMode._curveVertex.push(arguments.length<=0?void 0:arguments[0]),this.immediateMode._curveVertex.push(arguments.length<=1?void 0:arguments[1]),this.immediateMode._curveVertex.length===8){for(this.isCurve=!0,v=this._bezierToCatmull([this.immediateMode._curveVertex[0],this.immediateMode._curveVertex[2],this.immediateMode._curveVertex[4],this.immediateMode._curveVertex[6]]),b=this._bezierToCatmull([this.immediateMode._curveVertex[1],this.immediateMode._curveVertex[3],this.immediateMode._curveVertex[5],this.immediateMode._curveVertex[7]]),y=0;y<D;y++)p=v[0]*this._lookUpTableBezier[y][0]+v[1]*this._lookUpTableBezier[y][1]+v[2]*this._lookUpTableBezier[y][2]+v[3]*this._lookUpTableBezier[y][3],m=b[0]*this._lookUpTableBezier[y][0]+b[1]*this._lookUpTableBezier[y][1]+b[2]*this._lookUpTableBezier[y][2]+b[3]*this._lookUpTableBezier[y][3],this.vertex(p,m);for(y=0;y<_;y++)this.immediateMode._curveVertex.shift()}}else if(_===3&&(this.immediateMode._curveVertex.push(arguments.length<=0?void 0:arguments[0]),this.immediateMode._curveVertex.push(arguments.length<=1?void 0:arguments[1]),this.immediateMode._curveVertex.push(arguments.length<=2?void 0:arguments[2]),this.immediateMode._curveVertex.length===12)){for(this.isCurve=!0,v=this._bezierToCatmull([this.immediateMode._curveVertex[0],this.immediateMode._curveVertex[3],this.immediateMode._curveVertex[6],this.immediateMode._curveVertex[9]]),b=this._bezierToCatmull([this.immediateMode._curveVertex[1],this.immediateMode._curveVertex[4],this.immediateMode._curveVertex[7],this.immediateMode._curveVertex[10]]),w=this._bezierToCatmull([this.immediateMode._curveVertex[2],this.immediateMode._curveVertex[5],this.immediateMode._curveVertex[8],this.immediateMode._curveVertex[11]]),y=0;y<D;y++)p=v[0]*this._lookUpTableBezier[y][0]+v[1]*this._lookUpTableBezier[y][1]+v[2]*this._lookUpTableBezier[y][2]+v[3]*this._lookUpTableBezier[y][3],m=b[0]*this._lookUpTableBezier[y][0]+b[1]*this._lookUpTableBezier[y][1]+b[2]*this._lookUpTableBezier[y][2]+b[3]*this._lookUpTableBezier[y][3],g=w[0]*this._lookUpTableBezier[y][0]+w[1]*this._lookUpTableBezier[y][1]+w[2]*this._lookUpTableBezier[y][2]+w[3]*this._lookUpTableBezier[y][3],this.vertex(p,m,g);for(y=0;y<_;y++)this.immediateMode._curveVertex.shift()}},l.default.RendererGL.prototype.image=function(f,p,m,g,y,v,b,w,_){this._isErasing&&this.blendMode(this._cachedBlendMode),this._pInst.push(),this._pInst.noLights(),this._pInst.texture(f),this._pInst.textureMode(u.NORMAL);var I=0;p<=f.width&&(I=p/f.width);var C=1;p+g<=f.width&&(C=(p+g)/f.width);var N=0;m<=f.height&&(N=m/f.height);var O=1;m+y<=f.height&&(O=(m+y)/f.height),this.beginShape(),this.vertex(v,b,0,I,N),this.vertex(v+w,b,0,C,N),this.vertex(v+w,b+_,0,C,O),this.vertex(v,b+_,0,I,O),this.endShape(u.CLOSE),this._pInst.pop(),this._isErasing&&this.blendMode(u.REMOVE)};var c=l.default;o.default=c},{"../core/constants":253,"../core/main":264,"./p5.Geometry":313,"core-js/modules/es.array.concat":149,"core-js/modules/es.number.to-fixed":172}],308:[function(n,s,o){function a(c){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(f){return typeof f}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f})(c)}n("core-js/modules/es.array.splice"),n("core-js/modules/es.object.to-string"),n("core-js/modules/es.regexp.to-string"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var i,l=(i=n("../core/main"))&&i.__esModule?i:{default:i},u=function(c){if(c&&c.__esModule)return c;if(c===null||a(c)!=="object"&&typeof c!="function")return{default:c};var f=h();if(f&&f.has(c))return f.get(c);var p={},m=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var g in c)if(Object.prototype.hasOwnProperty.call(c,g)){var y=m?Object.getOwnPropertyDescriptor(c,g):null;y&&(y.get||y.set)?Object.defineProperty(p,g,y):p[g]=c[g]}return p.default=c,f&&f.set(c,p),p}(n("../core/constants"));function h(){if(typeof WeakMap!="function")return null;var c=new WeakMap;return h=function(){return c},c}l.default.prototype.orbitControl=function(c,f,p){if(this._assert3d("orbitControl"),l.default._validateParameters("orbitControl",arguments),this.mouseX<this.width&&0<this.mouseX&&this.mouseY<this.height&&0<this.mouseY){var m=this._renderer._curCamera;c===void 0&&(c=1),f===void 0&&(f=c),p===void 0&&(p=.5),this.contextMenuDisabled!==!0&&(this.canvas.oncontextmenu=function(){return!1},this._setProperty("contextMenuDisabled",!0)),this.wheelDefaultDisabled!==!0&&(this.canvas.onwheel=function(){return!1},this._setProperty("wheelDefaultDisabled",!0));var g=this.height<this.width?this.height:this.width;if(this._mouseWheelDeltaY!==this._pmouseWheelDeltaY&&(0<this._mouseWheelDeltaY?this._renderer._curCamera._orbit(0,0,p*g):this._renderer._curCamera._orbit(0,0,-p*g)),this.mouseIsPressed){if(this.mouseButton===this.LEFT){var y=-c*(this.mouseX-this.pmouseX)/g,v=f*(this.mouseY-this.pmouseY)/g;this._renderer._curCamera._orbit(y,v,0)}else if(this.mouseButton===this.RIGHT){var b=m._getLocalAxes(),w=Math.sqrt(b.x[0]*b.x[0]+b.x[2]*b.x[2]);w!==0&&(b.x[0]/=w,b.x[2]/=w);var _=Math.sqrt(b.y[0]*b.y[0]+b.y[2]*b.y[2]);_!==0&&(b.y[0]/=_,b.y[2]/=_);var I=-1*c*(this.mouseX-this.pmouseX),C=-1*f*(this.mouseY-this.pmouseY);m.setPosition(m.eyeX+I*b.x[0]+C*b.z[0],m.eyeY,m.eyeZ+I*b.x[2]+C*b.z[2])}}return this}},l.default.prototype.debugMode=function(){this._assert3d("debugMode");for(var c=arguments.length,f=new Array(c),p=0;p<c;p++)f[p]=arguments[p];l.default._validateParameters("debugMode",f);for(var m=this._registeredMethods.post.length-1;0<=m;m--)this._registeredMethods.post[m].toString()!==this._grid().toString()&&this._registeredMethods.post[m].toString()!==this._axesIcon().toString()||this._registeredMethods.post.splice(m,1);f[0]===u.GRID?this.registerMethod("post",this._grid.call(this,f[1],f[2],f[3],f[4],f[5])):f[0]===u.AXES?this.registerMethod("post",this._axesIcon.call(this,f[1],f[2],f[3],f[4])):(this.registerMethod("post",this._grid.call(this,f[0],f[1],f[2],f[3],f[4])),this.registerMethod("post",this._axesIcon.call(this,f[5],f[6],f[7],f[8])))},l.default.prototype.noDebugMode=function(){this._assert3d("noDebugMode");for(var c=this._registeredMethods.post.length-1;0<=c;c--)this._registeredMethods.post[c].toString()!==this._grid().toString()&&this._registeredMethods.post[c].toString()!==this._axesIcon().toString()||this._registeredMethods.post.splice(c,1)},l.default.prototype._grid=function(c,f,p,m,g){c===void 0&&(c=this.width/2),f===void 0&&(f=Math.round(c/30)<4?4:Math.round(c/30)),p===void 0&&(p=0),m===void 0&&(m=0),g===void 0&&(g=0);var y=c/f,v=c/2;return function(){this.push(),this.stroke(255*this._renderer.curStrokeColor[0],255*this._renderer.curStrokeColor[1],255*this._renderer.curStrokeColor[2]),this._renderer.uMVMatrix.set(this._renderer._curCamera.cameraMatrix.mat4[0],this._renderer._curCamera.cameraMatrix.mat4[1],this._renderer._curCamera.cameraMatrix.mat4[2],this._renderer._curCamera.cameraMatrix.mat4[3],this._renderer._curCamera.cameraMatrix.mat4[4],this._renderer._curCamera.cameraMatrix.mat4[5],this._renderer._curCamera.cameraMatrix.mat4[6],this._renderer._curCamera.cameraMatrix.mat4[7],this._renderer._curCamera.cameraMatrix.mat4[8],this._renderer._curCamera.cameraMatrix.mat4[9],this._renderer._curCamera.cameraMatrix.mat4[10],this._renderer._curCamera.cameraMatrix.mat4[11],this._renderer._curCamera.cameraMatrix.mat4[12],this._renderer._curCamera.cameraMatrix.mat4[13],this._renderer._curCamera.cameraMatrix.mat4[14],this._renderer._curCamera.cameraMatrix.mat4[15]);for(var b=0;b<=f;b++)this.beginShape(this.LINES),this.vertex(-v+p,m,b*y-v+g),this.vertex(+v+p,m,b*y-v+g),this.endShape();for(var w=0;w<=f;w++)this.beginShape(this.LINES),this.vertex(w*y-v+p,m,-v+g),this.vertex(w*y-v+p,m,+v+g),this.endShape();this.pop()}},l.default.prototype._axesIcon=function(c,f,p,m){return c===void 0&&(c=40<this.width/20?this.width/20:40),f===void 0&&(f=-this.width/4),p===void 0&&(p=f),m===void 0&&(m=f),function(){this.push(),this._renderer.uMVMatrix.set(this._renderer._curCamera.cameraMatrix.mat4[0],this._renderer._curCamera.cameraMatrix.mat4[1],this._renderer._curCamera.cameraMatrix.mat4[2],this._renderer._curCamera.cameraMatrix.mat4[3],this._renderer._curCamera.cameraMatrix.mat4[4],this._renderer._curCamera.cameraMatrix.mat4[5],this._renderer._curCamera.cameraMatrix.mat4[6],this._renderer._curCamera.cameraMatrix.mat4[7],this._renderer._curCamera.cameraMatrix.mat4[8],this._renderer._curCamera.cameraMatrix.mat4[9],this._renderer._curCamera.cameraMatrix.mat4[10],this._renderer._curCamera.cameraMatrix.mat4[11],this._renderer._curCamera.cameraMatrix.mat4[12],this._renderer._curCamera.cameraMatrix.mat4[13],this._renderer._curCamera.cameraMatrix.mat4[14],this._renderer._curCamera.cameraMatrix.mat4[15]),this.strokeWeight(2),this.stroke(255,0,0),this.beginShape(this.LINES),this.vertex(f,p,m),this.vertex(f+c,p,m),this.endShape(),this.stroke(0,255,0),this.beginShape(this.LINES),this.vertex(f,p,m),this.vertex(f,p+c,m),this.endShape(),this.stroke(0,0,255),this.beginShape(this.LINES),this.vertex(f,p,m),this.vertex(f,p,m+c),this.endShape(),this.pop()}};var d=l.default;o.default=d},{"../core/constants":253,"../core/main":264,"core-js/modules/es.array.splice":164,"core-js/modules/es.object.to-string":177,"core-js/modules/es.regexp.to-string":182}],309:[function(n,s,o){function a(c){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(f){return typeof f}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f})(c)}Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var i,l=(i=n("../core/main"))&&i.__esModule?i:{default:i},u=function(c){if(c&&c.__esModule)return c;if(c===null||a(c)!=="object"&&typeof c!="function")return{default:c};var f=h();if(f&&f.has(c))return f.get(c);var p={},m=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var g in c)if(Object.prototype.hasOwnProperty.call(c,g)){var y=m?Object.getOwnPropertyDescriptor(c,g):null;y&&(y.get||y.set)?Object.defineProperty(p,g,y):p[g]=c[g]}return p.default=c,f&&f.set(c,p),p}(n("../core/constants"));function h(){if(typeof WeakMap!="function")return null;var c=new WeakMap;return h=function(){return c},c}l.default.prototype.ambientLight=function(c,f,p,m){this._assert3d("ambientLight"),l.default._validateParameters("ambientLight",arguments);var g=this.color.apply(this,arguments);return this._renderer.ambientLightColors.push(g._array[0],g._array[1],g._array[2]),this._renderer._enableLighting=!0,this},l.default.prototype.specularColor=function(c,f,p){this._assert3d("specularColor"),l.default._validateParameters("specularColor",arguments);var m=this.color.apply(this,arguments);return this._renderer.specularColors=[m._array[0],m._array[1],m._array[2]],this},l.default.prototype.directionalLight=function(c,f,p,m,g,y){var v,b,w,_;this._assert3d("directionalLight"),l.default._validateParameters("directionalLight",arguments),v=c instanceof l.default.Color?c:this.color(c,f,p);var I=arguments[arguments.length-1];_=typeof I=="number"?(b=arguments[arguments.length-3],w=arguments[arguments.length-2],arguments[arguments.length-1]):(b=I.x,w=I.y,I.z);var C=Math.sqrt(b*b+w*w+_*_);return this._renderer.directionalLightDirections.push(b/C,w/C,_/C),this._renderer.directionalLightDiffuseColors.push(v._array[0],v._array[1],v._array[2]),Array.prototype.push.apply(this._renderer.directionalLightSpecularColors,this._renderer.specularColors),this._renderer._enableLighting=!0,this},l.default.prototype.pointLight=function(c,f,p,m,g,y){var v,b,w,_;this._assert3d("pointLight"),l.default._validateParameters("pointLight",arguments),v=c instanceof l.default.Color?c:this.color(c,f,p);var I=arguments[arguments.length-1];return _=typeof I=="number"?(b=arguments[arguments.length-3],w=arguments[arguments.length-2],arguments[arguments.length-1]):(b=I.x,w=I.y,I.z),this._renderer.pointLightPositions.push(b,w,_),this._renderer.pointLightDiffuseColors.push(v._array[0],v._array[1],v._array[2]),Array.prototype.push.apply(this._renderer.pointLightSpecularColors,this._renderer.specularColors),this._renderer._enableLighting=!0,this},l.default.prototype.lights=function(){if(this._assert3d("lights"),this._colorMode===u.RGB)this.ambientLight(128,128,128),this.directionalLight(128,128,128,0,0,-1);else{var c=this._colorMaxes[this._colorMode][2];this.ambientLight(0,0,c),this.directionalLight(0,0,c,0,0,-1)}return this},l.default.prototype.lightFalloff=function(c,f,p){return this._assert3d("lightFalloff"),l.default._validateParameters("lightFalloff",arguments),c<0&&(c=0,console.warn("Value of constant argument in lightFalloff() should be never be negative. Set to 0.")),f<0&&(f=0,console.warn("Value of linear argument in lightFalloff() should be never be negative. Set to 0.")),p<0&&(p=0,console.warn("Value of quadratic argument in lightFalloff() should be never be negative. Set to 0.")),c===0&&f===0&&p===0&&(c=1,console.warn("Either one of the three arguments in lightFalloff() should be greater than zero. Set constant argument to 1.")),this._renderer.constantAttenuation=c,this._renderer.linearAttenuation=f,this._renderer.quadraticAttenuation=p,this},l.default.prototype.spotLight=function(c,f,p,m,g,y,v,b,w,_,I){var C,N,O;this._assert3d("spotLight"),l.default._validateParameters("spotLight",arguments);var D=arguments.length;switch(D){case 11:case 10:C=this.color(c,f,p),N=new l.default.Vector(m,g,y),O=new l.default.Vector(v,b,w);break;case 9:c instanceof l.default.Color?(C=c,N=new l.default.Vector(f,p,m),O=new l.default.Vector(g,y,v),_=b,I=w):m instanceof l.default.Vector?(C=this.color(c,f,p),N=m,O=new l.default.Vector(g,y,v),_=b,I=w):v instanceof l.default.Vector?(C=this.color(c,f,p),N=new l.default.Vector(m,g,y),O=v,_=b,I=w):(C=this.color(c,f,p),N=new l.default.Vector(m,g,y),O=new l.default.Vector(v,b,w));break;case 8:_=(O=c instanceof l.default.Color?(C=c,N=new l.default.Vector(f,p,m),new l.default.Vector(g,y,v)):m instanceof l.default.Vector?(C=this.color(c,f,p),N=m,new l.default.Vector(g,y,v)):(C=this.color(c,f,p),N=new l.default.Vector(m,g,y),v),b);break;case 7:c instanceof l.default.Color&&f instanceof l.default.Vector?(C=c,N=f,O=new l.default.Vector(p,m,g),_=y,I=v):c instanceof l.default.Color&&g instanceof l.default.Vector?(C=c,N=new l.default.Vector(f,p,m),O=g,_=y,I=v):m instanceof l.default.Vector&&g instanceof l.default.Vector?(C=this.color(c,f,p),N=m,O=g,_=y,I=v):O=c instanceof l.default.Color?(C=c,N=new l.default.Vector(f,p,m),new l.default.Vector(g,y,v)):m instanceof l.default.Vector?(C=this.color(c,f,p),N=m,new l.default.Vector(g,y,v)):(C=this.color(c,f,p),N=new l.default.Vector(m,g,y),v);break;case 6:m instanceof l.default.Vector&&g instanceof l.default.Vector?(C=this.color(c,f,p),N=m,O=g,_=y):c instanceof l.default.Color&&g instanceof l.default.Vector?(C=c,N=new l.default.Vector(f,p,m),O=g,_=y):c instanceof l.default.Color&&f instanceof l.default.Vector&&(C=c,N=f,O=new l.default.Vector(p,m,g),_=y);break;case 5:c instanceof l.default.Color&&f instanceof l.default.Vector&&p instanceof l.default.Vector?(C=c,N=f,O=p,_=m,I=g):m instanceof l.default.Vector&&g instanceof l.default.Vector?(C=this.color(c,f,p),N=m,O=g):c instanceof l.default.Color&&g instanceof l.default.Vector?(C=c,N=new l.default.Vector(f,p,m),O=g):c instanceof l.default.Color&&f instanceof l.default.Vector&&(C=c,N=f,O=new l.default.Vector(p,m,g));break;case 4:C=c,N=f,O=p,_=m;break;case 3:C=c,N=f,O=p;break;default:return console.warn("Sorry, input for spotlight() is not in prescribed format. Too ".concat(D<3?"few":"many"," arguments were provided")),this}return this._renderer.spotLightDiffuseColors.push(C._array[0],C._array[1],C._array[2]),Array.prototype.push.apply(this._renderer.spotLightSpecularColors,this._renderer.specularColors),this._renderer.spotLightPositions.push(N.x,N.y,N.z),O.normalize(),this._renderer.spotLightDirections.push(O.x,O.y,O.z),_===void 0&&(_=Math.PI/3),I!==void 0&&I<1?(I=1,console.warn("Value of concentration needs to be greater than 1. Setting it to 1")):I===void 0&&(I=100),_=this._renderer._pInst._toRadians(_),this._renderer.spotLightAngle.push(Math.cos(_)),this._renderer.spotLightConc.push(I),this._renderer._enableLighting=!0,this},l.default.prototype.noLights=function(){return this._assert3d("noLights"),l.default._validateParameters("noLights",arguments),this._renderer._enableLighting=!1,this._renderer.ambientLightColors.length=0,this._renderer.specularColors=[1,1,1],this._renderer.directionalLightDirections.length=0,this._renderer.directionalLightDiffuseColors.length=0,this._renderer.directionalLightSpecularColors.length=0,this._renderer.pointLightPositions.length=0,this._renderer.pointLightDiffuseColors.length=0,this._renderer.pointLightSpecularColors.length=0,this._renderer.spotLightPositions.length=0,this._renderer.spotLightDirections.length=0,this._renderer.spotLightDiffuseColors.length=0,this._renderer.spotLightSpecularColors.length=0,this._renderer.spotLightAngle.length=0,this._renderer.spotLightConc.length=0,this._renderer.constantAttenuation=1,this._renderer.linearAttenuation=0,this._renderer.quadraticAttenuation=0,this._renderer._useShininess=1,this};var d=l.default;o.default=d},{"../core/constants":253,"../core/main":264}],310:[function(n,s,o){n("core-js/modules/es.array.concat"),n("core-js/modules/es.array.index-of"),n("core-js/modules/es.array.slice"),n("core-js/modules/es.array.splice"),n("core-js/modules/es.object.to-string"),n("core-js/modules/es.regexp.exec"),n("core-js/modules/es.string.match"),n("core-js/modules/es.string.split"),n("core-js/modules/es.string.trim"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var a,i=(a=n("../core/main"))&&a.__esModule?a:{default:a};function l(h,d,c){for(var f=0,p=h.length;f<p;f++)if(h[f]!==d.getUint8(c+f,!1))return!1;return!0}n("./p5.Geometry"),i.default.prototype.loadModel=function(h){var d,c,f;i.default._validateParameters("loadModel",arguments);var p=h.slice(-4);typeof arguments[1]=="boolean"?(d=arguments[1],c=arguments[2],f=arguments[3],arguments[4]!==void 0&&(p=arguments[4])):(d=!1,c=arguments[1],f=arguments[2],arguments[3]!==void 0&&(p=arguments[3]));var m=new i.default.Geometry;m.gid="".concat(h,"|").concat(d);var g=this;return p.match(/\.stl$/i)?this.httpDo(h,"GET","arrayBuffer",function(y){(function(v,b){if(function(I){for(var C=new DataView(I),N=[115,111,108,105,100],O=0;O<5;O++)if(l(N,C,O))return!1;return!0}(b))(function(I,C){for(var N,O,D,M,P,F,B,z=new DataView(C),Z=z.getUint32(80,!0),Q=!1,K=0;K<70;K++)z.getUint32(K,!1)===1129270351&&z.getUint8(K+4)===82&&z.getUint8(K+5)===61&&(Q=!0,M=[],P=z.getUint8(K+6)/255,F=z.getUint8(K+7)/255,B=z.getUint8(K+8)/255);for(var ne=0;ne<Z;ne++){var re=84+50*ne,ce=z.getFloat32(re,!0),be=z.getFloat32(4+re,!0),we=z.getFloat32(8+re,!0);if(Q){var ye=z.getUint16(48+re,!0);D=(32768&ye)==0?(N=(31&ye)/31,O=(ye>>5&31)/31,(ye>>10&31)/31):(N=P,O=F,B)}for(var Oe=new i.default.Vector(ce,be,we),Se=1;Se<=3;Se++){var Ee=re+12*Se,j=new i.default.Vector(z.getFloat32(Ee,!0),z.getFloat32(4+Ee,!0),z.getFloat32(8+Ee,!0));I.vertices.push(j),I.vertexNormals.push(Oe),Q&&M.push(N,O,D)}I.faces.push([3*ne,3*ne+1,3*ne+2]),I.uvs.push([0,0],[0,0],[0,0])}})(v,b);else{var w=new DataView(b);if(!("TextDecoder"in window))return console.warn("Sorry, ASCII STL loading only works in browsers that support TextDecoder (https://caniuse.com/#feat=textencoder)");var _=new TextDecoder("utf-8").decode(w).split(`
`);(function(I,C){for(var N,O,D="",M=[],P=0;P<C.length;++P){for(var F=C[P].trim(),B=F.split(" "),z=0;z<B.length;++z)B[z]===""&&B.splice(z,1);if(B.length!==0)switch(D){case"":if(B[0]!=="solid")return console.error(F),console.error('Invalid state "'.concat(B[0],'", should be "solid"'));D="solid";break;case"solid":if(B[0]!=="facet"||B[1]!=="normal")return console.error(F),console.error('Invalid state "'.concat(B[0],'", should be "facet normal"'));N=new i.default.Vector(parseFloat(B[2]),parseFloat(B[3]),parseFloat(B[4])),I.vertexNormals.push(N,N,N),D="facet normal";break;case"facet normal":if(B[0]!=="outer"||B[1]!=="loop")return console.error(F),console.error('Invalid state "'.concat(B[0],'", should be "outer loop"'));D="vertex";break;case"vertex":if(B[0]==="vertex")O=new i.default.Vector(parseFloat(B[1]),parseFloat(B[2]),parseFloat(B[3])),I.vertices.push(O),I.uvs.push([0,0]),M.push(I.vertices.indexOf(O));else{if(B[0]!=="endloop")return console.error(F),console.error('Invalid state "'.concat(B[0],'", should be "vertex" or "endloop"'));I.faces.push(M),M=[],D="endloop"}break;case"endloop":if(B[0]!=="endfacet")return console.error(F),console.error('Invalid state "'.concat(B[0],'", should be "endfacet"'));D="endfacet";break;case"endfacet":if(B[0]!=="endsolid"){if(B[0]!=="facet"||B[1]!=="normal")return console.error(F),console.error('Invalid state "'.concat(B[0],'", should be "endsolid" or "facet normal"'));N=new i.default.Vector(parseFloat(B[2]),parseFloat(B[3]),parseFloat(B[4])),I.vertexNormals.push(N,N,N),D="facet normal"}break;default:console.error('Invalid state "'.concat(D,'"'))}}})(v,_)}})(m,y),d&&m.normalize(),g._decrementPreload(),typeof c=="function"&&c(m)},f):p.match(/\.obj$/i)?this.loadStrings(h,function(y){(function(v,b){for(var w={v:[],vt:[],vn:[]},_={},I=0;I<b.length;++I){var C=b[I].trim().split(/\b\s+/);if(0<C.length){if(C[0]==="v"||C[0]==="vn"){var N=new i.default.Vector(parseFloat(C[1]),parseFloat(C[2]),parseFloat(C[3]));w[C[0]].push(N)}else if(C[0]==="vt"){var O=[parseFloat(C[1]),1-parseFloat(C[2])];w[C[0]].push(O)}else if(C[0]==="f")for(var D=3;D<C.length;++D){for(var M=[],P=[1,D-1,D],F=0;F<P.length;++F){var B=C[P[F]],z=0;if(_[B]!==void 0)z=_[B];else{for(var Z=B.split("/"),Q=0;Q<Z.length;Q++)Z[Q]=parseInt(Z[Q])-1;z=_[B]=v.vertices.length,v.vertices.push(w.v[Z[0]].copy()),w.vt[Z[1]]?v.uvs.push(w.vt[Z[1]].slice()):v.uvs.push([0,0]),w.vn[Z[2]]&&v.vertexNormals.push(w.vn[Z[2]].copy())}M.push(z)}M[0]!==M[1]&&M[0]!==M[2]&&M[1]!==M[2]&&v.faces.push(M)}}}v.vertexNormals.length===0&&v.computeNormals()})(m,y),d&&m.normalize(),g._decrementPreload(),typeof c=="function"&&c(m)},f):(i.default._friendlyFileLoadError(3,h),f?f():console.error("Sorry, the file type is invalid. Only OBJ and STL files are supported.")),m},i.default.prototype.model=function(h){this._assert3d("model"),i.default._validateParameters("model",arguments),0<h.vertices.length&&(this._renderer.geometryInHash(h.gid)||(h._makeTriangleEdges()._edgesToVertices(),this._renderer.createBuffers(h.gid,h)),this._renderer.drawBuffers(h.gid))};var u=i.default;o.default=u},{"../core/main":264,"./p5.Geometry":313,"core-js/modules/es.array.concat":149,"core-js/modules/es.array.index-of":157,"core-js/modules/es.array.slice":162,"core-js/modules/es.array.splice":164,"core-js/modules/es.object.to-string":177,"core-js/modules/es.regexp.exec":181,"core-js/modules/es.string.match":187,"core-js/modules/es.string.split":191,"core-js/modules/es.string.trim":193}],311:[function(n,s,o){function a(c){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(f){return typeof f}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f})(c)}n("core-js/modules/es.array.join"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var i,l=(i=n("../core/main"))&&i.__esModule?i:{default:i},u=function(c){if(c&&c.__esModule)return c;if(c===null||a(c)!=="object"&&typeof c!="function")return{default:c};var f=h();if(f&&f.has(c))return f.get(c);var p={},m=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var g in c)if(Object.prototype.hasOwnProperty.call(c,g)){var y=m?Object.getOwnPropertyDescriptor(c,g):null;y&&(y.get||y.set)?Object.defineProperty(p,g,y):p[g]=c[g]}return p.default=c,f&&f.set(c,p),p}(n("../core/constants"));function h(){if(typeof WeakMap!="function")return null;var c=new WeakMap;return h=function(){return c},c}n("./p5.Texture"),l.default.prototype.loadShader=function(c,f,p,m){l.default._validateParameters("loadShader",arguments),m=m||console.error;function g(){v._decrementPreload(),p&&p(y)}var y=new l.default.Shader,v=this,b=!1,w=!1;return this.loadStrings(c,function(_){y._vertSrc=_.join(`
`),w=!0,b&&g()},m),this.loadStrings(f,function(_){y._fragSrc=_.join(`
`),b=!0,w&&g()},m),y},l.default.prototype.createShader=function(c,f){return this._assert3d("createShader"),l.default._validateParameters("createShader",arguments),new l.default.Shader(this._renderer,c,f)},l.default.prototype.shader=function(c){return this._assert3d("shader"),l.default._validateParameters("shader",arguments),c._renderer===void 0&&(c._renderer=this._renderer),c.init(),c.isStrokeShader()?this._renderer.userStrokeShader=c:(this._renderer.userFillShader=c,this._renderer._useNormalMaterial=!1),this},l.default.prototype.resetShader=function(){return this._renderer.userFillShader=this._renderer.userStrokeShader=null,this},l.default.prototype.texture=function(c){return this._assert3d("texture"),l.default._validateParameters("texture",arguments),c.gifProperties&&c._animateGif(this),this._renderer.drawMode=u.TEXTURE,this._renderer._useSpecularMaterial=!1,this._renderer._useEmissiveMaterial=!1,this._renderer._useNormalMaterial=!1,this._renderer._tex=c,this._renderer._setProperty("_doFill",!0),this},l.default.prototype.textureMode=function(c){c!==u.IMAGE&&c!==u.NORMAL?console.warn("You tried to set ".concat(c," textureMode only supports IMAGE & NORMAL ")):this._renderer.textureMode=c},l.default.prototype.textureWrap=function(c){var f=1<arguments.length&&arguments[1]!==void 0?arguments[1]:c;this._renderer.textureWrapX=c,this._renderer.textureWrapY=f;for(var p=this._renderer.textures,m=0;m<p.length;m++)p[m].setWrapMode(c,f)},l.default.prototype.normalMaterial=function(){this._assert3d("normalMaterial");for(var c=arguments.length,f=new Array(c),p=0;p<c;p++)f[p]=arguments[p];return l.default._validateParameters("normalMaterial",f),this._renderer.drawMode=u.FILL,this._renderer._useSpecularMaterial=!1,this._renderer._useEmissiveMaterial=!1,this._renderer._useNormalMaterial=!0,this._renderer.curFillColor=[1,1,1,1],this._renderer._setProperty("_doFill",!0),this.noStroke(),this},l.default.prototype.ambientMaterial=function(c,f,p){this._assert3d("ambientMaterial"),l.default._validateParameters("ambientMaterial",arguments);var m=l.default.prototype.color.apply(this,arguments);return this._renderer.curFillColor=m._array,this._renderer._useSpecularMaterial=!1,this._renderer._useEmissiveMaterial=!1,this._renderer._useNormalMaterial=!1,this._renderer._enableLighting=!0,this._renderer._tex=null,this._renderer._setProperty("_doFill",!0),this},l.default.prototype.emissiveMaterial=function(c,f,p,m){this._assert3d("emissiveMaterial"),l.default._validateParameters("emissiveMaterial",arguments);var g=l.default.prototype.color.apply(this,arguments);return this._renderer.curFillColor=g._array,this._renderer._useSpecularMaterial=!1,this._renderer._useEmissiveMaterial=!0,this._renderer._useNormalMaterial=!1,this._renderer._enableLighting=!0,this._renderer._tex=null,this},l.default.prototype.specularMaterial=function(c,f,p,m){this._assert3d("specularMaterial"),l.default._validateParameters("specularMaterial",arguments);var g=l.default.prototype.color.apply(this,arguments);return this._renderer.curFillColor=g._array,this._renderer._useSpecularMaterial=!0,this._renderer._useEmissiveMaterial=!1,this._renderer._useNormalMaterial=!1,this._renderer._enableLighting=!0,this._renderer._tex=null,this},l.default.prototype.shininess=function(c){return this._assert3d("shininess"),l.default._validateParameters("shininess",arguments),c<1&&(c=1),this._renderer._useShininess=c,this},l.default.RendererGL.prototype._applyColorBlend=function(c){var f=this.GL,p=this.drawMode===u.TEXTURE||c[c.length-1]<1||this._isErasing;return p!==this._isBlending&&(p||this.curBlendMode!==u.BLEND&&this.curBlendMode!==u.ADD?f.enable(f.BLEND):f.disable(f.BLEND),f.depthMask(!0),this._isBlending=p),this._applyBlendMode(),c},l.default.RendererGL.prototype._applyBlendMode=function(){if(this._cachedBlendMode!==this.curBlendMode){var c=this.GL;switch(this.curBlendMode){case u.BLEND:case u.ADD:c.blendEquation(c.FUNC_ADD),c.blendFunc(c.SRC_ALPHA,c.ONE_MINUS_SRC_ALPHA);break;case u.REMOVE:c.blendEquation(c.FUNC_REVERSE_SUBTRACT),c.blendFunc(c.SRC_ALPHA,c.DST_ALPHA);break;case u.MULTIPLY:c.blendEquationSeparate(c.FUNC_ADD,c.FUNC_ADD),c.blendFuncSeparate(c.ZERO,c.SRC_COLOR,c.ONE,c.ONE);break;case u.SCREEN:c.blendEquationSeparate(c.FUNC_ADD,c.FUNC_ADD),c.blendFuncSeparate(c.ONE_MINUS_DST_COLOR,c.ONE,c.ONE,c.ONE);break;case u.EXCLUSION:c.blendEquationSeparate(c.FUNC_ADD,c.FUNC_ADD),c.blendFuncSeparate(c.ONE_MINUS_DST_COLOR,c.ONE_MINUS_SRC_COLOR,c.ONE,c.ONE);break;case u.REPLACE:c.blendEquation(c.FUNC_ADD),c.blendFunc(c.ONE,c.ZERO);break;case u.SUBTRACT:c.blendEquationSeparate(c.FUNC_REVERSE_SUBTRACT,c.FUNC_ADD),c.blendFuncSeparate(c.SRC_ALPHA,c.ONE,c.ONE,c.ONE);break;case u.DARKEST:this.blendExt?(c.blendEquationSeparate(this.blendExt.MIN_EXT,c.FUNC_ADD),c.blendFuncSeparate(c.ONE,c.ONE,c.ONE,c.ONE)):console.warn("blendMode(DARKEST) does not work in your browser in WEBGL mode.");break;case u.LIGHTEST:this.blendExt?(c.blendEquationSeparate(this.blendExt.MAX_EXT,c.FUNC_ADD),c.blendFuncSeparate(c.ONE,c.ONE,c.ONE,c.ONE)):console.warn("blendMode(LIGHTEST) does not work in your browser in WEBGL mode.");break;default:console.error("Oops! Somehow RendererGL set curBlendMode to an unsupported mode.")}this._isErasing||(this._cachedBlendMode=this.curBlendMode)}};var d=l.default;o.default=d},{"../core/constants":253,"../core/main":264,"./p5.Texture":320,"core-js/modules/es.array.join":159}],312:[function(n,s,o){Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var a,i=(a=n("../core/main"))&&a.__esModule?a:{default:a};i.default.prototype.camera=function(){var u;this._assert3d("camera");for(var h=arguments.length,d=new Array(h),c=0;c<h;c++)d[c]=arguments[c];return i.default._validateParameters("camera",d),(u=this._renderer._curCamera).camera.apply(u,d),this},i.default.prototype.perspective=function(){var u;this._assert3d("perspective");for(var h=arguments.length,d=new Array(h),c=0;c<h;c++)d[c]=arguments[c];return i.default._validateParameters("perspective",d),(u=this._renderer._curCamera).perspective.apply(u,d),this},i.default.prototype.ortho=function(){var u;this._assert3d("ortho");for(var h=arguments.length,d=new Array(h),c=0;c<h;c++)d[c]=arguments[c];return i.default._validateParameters("ortho",d),(u=this._renderer._curCamera).ortho.apply(u,d),this},i.default.prototype.frustum=function(){var u;this._assert3d("frustum");for(var h=arguments.length,d=new Array(h),c=0;c<h;c++)d[c]=arguments[c];return i.default._validateParameters("frustum",d),(u=this._renderer._curCamera).frustum.apply(u,d),this},i.default.prototype.createCamera=function(){this._assert3d("createCamera");var u=new i.default.Camera(this._renderer);return u._computeCameraDefaultSettings(),u._setDefaultCamera(),this._renderer._curCamera=u},i.default.Camera=function(u){this._renderer=u,this.cameraType="default",this.cameraMatrix=new i.default.Matrix,this.projMatrix=new i.default.Matrix},i.default.Camera.prototype.perspective=function(u,h,d,c){this.cameraType=0<arguments.length?"custom":"default",u===void 0?(u=this.defaultCameraFOV,this.cameraFOV=u):this.cameraFOV=this._renderer._pInst._toRadians(u),h===void 0&&(h=this.defaultAspectRatio),d===void 0&&(d=this.defaultCameraNear),c===void 0&&(c=this.defaultCameraFar),d<=1e-4&&(d=.01,console.log("Avoid perspective near plane values close to or below 0. Setting value to 0.01.")),c<d&&console.log("Perspective far plane value is less than near plane value. Nothing will be shown."),this.aspectRatio=h,this.cameraNear=d,this.cameraFar=c,this.projMatrix=i.default.Matrix.identity();var f=1/Math.tan(this.cameraFOV/2),p=1/(this.cameraNear-this.cameraFar);this.projMatrix.set(f/h,0,0,0,0,-f,0,0,0,0,(c+d)*p,-1,0,0,2*c*d*p,0),this._isActive()&&this._renderer.uPMatrix.set(this.projMatrix.mat4[0],this.projMatrix.mat4[1],this.projMatrix.mat4[2],this.projMatrix.mat4[3],this.projMatrix.mat4[4],this.projMatrix.mat4[5],this.projMatrix.mat4[6],this.projMatrix.mat4[7],this.projMatrix.mat4[8],this.projMatrix.mat4[9],this.projMatrix.mat4[10],this.projMatrix.mat4[11],this.projMatrix.mat4[12],this.projMatrix.mat4[13],this.projMatrix.mat4[14],this.projMatrix.mat4[15])},i.default.Camera.prototype.ortho=function(u,h,d,c,f,p){u===void 0&&(u=-this._renderer.width/2),h===void 0&&(h=this._renderer.width/2),d===void 0&&(d=-this._renderer.height/2),c===void 0&&(c=this._renderer.height/2),f===void 0&&(f=0),p===void 0&&(p=Math.max(this._renderer.width,this._renderer.height));var m=h-u,g=c-d,y=p-f,v=2/m,b=2/g,w=-2/y,_=-(h+u)/m,I=-(c+d)/g,C=-(p+f)/y;this.projMatrix=i.default.Matrix.identity(),this.projMatrix.set(v,0,0,0,0,-b,0,0,0,0,w,0,_,I,C,1),this._isActive()&&this._renderer.uPMatrix.set(this.projMatrix.mat4[0],this.projMatrix.mat4[1],this.projMatrix.mat4[2],this.projMatrix.mat4[3],this.projMatrix.mat4[4],this.projMatrix.mat4[5],this.projMatrix.mat4[6],this.projMatrix.mat4[7],this.projMatrix.mat4[8],this.projMatrix.mat4[9],this.projMatrix.mat4[10],this.projMatrix.mat4[11],this.projMatrix.mat4[12],this.projMatrix.mat4[13],this.projMatrix.mat4[14],this.projMatrix.mat4[15]),this.cameraType="custom"},i.default.Camera.prototype.frustum=function(u,h,d,c,f,p){u===void 0&&(u=-this._renderer.width/2),h===void 0&&(h=this._renderer.width/2),d===void 0&&(d=-this._renderer.height/2),c===void 0&&(c=this._renderer.height/2),f===void 0&&(f=0),p===void 0&&(p=Math.max(this._renderer.width,this._renderer.height));var m=h-u,g=c-d,y=p-f,v=2*f/m,b=2*f/g,w=-2*p*f/y,_=(h+u)/m,I=(c+d)/g,C=-(p+f)/y;this.projMatrix=i.default.Matrix.identity(),this.projMatrix.set(v,0,0,0,0,b,0,0,_,I,C,-1,0,0,w,0),this._isActive()&&this._renderer.uPMatrix.set(this.projMatrix.mat4[0],this.projMatrix.mat4[1],this.projMatrix.mat4[2],this.projMatrix.mat4[3],this.projMatrix.mat4[4],this.projMatrix.mat4[5],this.projMatrix.mat4[6],this.projMatrix.mat4[7],this.projMatrix.mat4[8],this.projMatrix.mat4[9],this.projMatrix.mat4[10],this.projMatrix.mat4[11],this.projMatrix.mat4[12],this.projMatrix.mat4[13],this.projMatrix.mat4[14],this.projMatrix.mat4[15]),this.cameraType="custom"},i.default.Camera.prototype._rotateView=function(u,h,d,c){var f=this.centerX,p=this.centerY,m=this.centerZ;f-=this.eyeX,p-=this.eyeY,m-=this.eyeZ;var g=i.default.Matrix.identity(this._renderer._pInst);g.rotate(this._renderer._pInst._toRadians(u),h,d,c);var y=[f*g.mat4[0]+p*g.mat4[4]+m*g.mat4[8],f*g.mat4[1]+p*g.mat4[5]+m*g.mat4[9],f*g.mat4[2]+p*g.mat4[6]+m*g.mat4[10]];y[0]+=this.eyeX,y[1]+=this.eyeY,y[2]+=this.eyeZ,this.camera(this.eyeX,this.eyeY,this.eyeZ,y[0],y[1],y[2],this.upX,this.upY,this.upZ)},i.default.Camera.prototype.pan=function(u){var h=this._getLocalAxes();this._rotateView(u,h.y[0],h.y[1],h.y[2])},i.default.Camera.prototype.tilt=function(u){var h=this._getLocalAxes();this._rotateView(u,h.x[0],h.x[1],h.x[2])},i.default.Camera.prototype.lookAt=function(u,h,d){this.camera(this.eyeX,this.eyeY,this.eyeZ,u,h,d,this.upX,this.upY,this.upZ)},i.default.Camera.prototype.camera=function(u,h,d,c,f,p,m,g,y){u===void 0&&(u=this.defaultEyeX,h=this.defaultEyeY,d=this.defaultEyeZ,c=u,f=h,g=1,y=m=p=0),this.eyeX=u,this.eyeY=h,this.eyeZ=d,c!==void 0&&(this.centerX=c,this.centerY=f,this.centerZ=p),m!==void 0&&(this.upX=m,this.upY=g,this.upZ=y);var v=this._getLocalAxes();this.cameraMatrix.set(v.x[0],v.y[0],v.z[0],0,v.x[1],v.y[1],v.z[1],0,v.x[2],v.y[2],v.z[2],0,0,0,0,1);var b=-u,w=-h,_=-d;return this.cameraMatrix.translate([b,w,_]),this._isActive()&&this._renderer.uMVMatrix.set(this.cameraMatrix.mat4[0],this.cameraMatrix.mat4[1],this.cameraMatrix.mat4[2],this.cameraMatrix.mat4[3],this.cameraMatrix.mat4[4],this.cameraMatrix.mat4[5],this.cameraMatrix.mat4[6],this.cameraMatrix.mat4[7],this.cameraMatrix.mat4[8],this.cameraMatrix.mat4[9],this.cameraMatrix.mat4[10],this.cameraMatrix.mat4[11],this.cameraMatrix.mat4[12],this.cameraMatrix.mat4[13],this.cameraMatrix.mat4[14],this.cameraMatrix.mat4[15]),this},i.default.Camera.prototype.move=function(u,h,d){var c=this._getLocalAxes(),f=[c.x[0]*u,c.x[1]*u,c.x[2]*u],p=[c.y[0]*h,c.y[1]*h,c.y[2]*h],m=[c.z[0]*d,c.z[1]*d,c.z[2]*d];this.camera(this.eyeX+f[0]+p[0]+m[0],this.eyeY+f[1]+p[1]+m[1],this.eyeZ+f[2]+p[2]+m[2],this.centerX+f[0]+p[0]+m[0],this.centerY+f[1]+p[1]+m[1],this.centerZ+f[2]+p[2]+m[2],0,1,0)},i.default.Camera.prototype.setPosition=function(u,h,d){var c=u-this.eyeX,f=h-this.eyeY,p=d-this.eyeZ;this.camera(u,h,d,this.centerX+c,this.centerY+f,this.centerZ+p,0,1,0)},i.default.Camera.prototype._computeCameraDefaultSettings=function(){this.defaultCameraFOV=60/180*Math.PI,this.defaultAspectRatio=this._renderer.width/this._renderer.height,this.defaultEyeX=0,this.defaultEyeY=0,this.defaultEyeZ=this._renderer.height/2/Math.tan(this.defaultCameraFOV/2),this.defaultCenterX=0,this.defaultCenterY=0,this.defaultCenterZ=0,this.defaultCameraNear=.1*this.defaultEyeZ,this.defaultCameraFar=10*this.defaultEyeZ},i.default.Camera.prototype._setDefaultCamera=function(){this.cameraFOV=this.defaultCameraFOV,this.aspectRatio=this.defaultAspectRatio,this.eyeX=this.defaultEyeX,this.eyeY=this.defaultEyeY,this.eyeZ=this.defaultEyeZ,this.centerX=this.defaultCenterX,this.centerY=this.defaultCenterY,this.centerZ=this.defaultCenterZ,this.upX=0,this.upY=1,this.upZ=0,this.cameraNear=this.defaultCameraNear,this.cameraFar=this.defaultCameraFar,this.perspective(),this.camera(),this.cameraType="default"},i.default.Camera.prototype._resize=function(){this.cameraType==="default"?(this._computeCameraDefaultSettings(),this._setDefaultCamera()):this.perspective(this.cameraFOV,this._renderer.width/this._renderer.height)},i.default.Camera.prototype.copy=function(){var u=new i.default.Camera(this._renderer);return u.cameraFOV=this.cameraFOV,u.aspectRatio=this.aspectRatio,u.eyeX=this.eyeX,u.eyeY=this.eyeY,u.eyeZ=this.eyeZ,u.centerX=this.centerX,u.centerY=this.centerY,u.centerZ=this.centerZ,u.cameraNear=this.cameraNear,u.cameraFar=this.cameraFar,u.cameraType=this.cameraType,u.cameraMatrix=this.cameraMatrix.copy(),u.projMatrix=this.projMatrix.copy(),u},i.default.Camera.prototype._getLocalAxes=function(){var u=this.eyeX-this.centerX,h=this.eyeY-this.centerY,d=this.eyeZ-this.centerZ,c=Math.sqrt(u*u+h*h+d*d);c!==0&&(u/=c,h/=c,d/=c);var f=this.upX,p=this.upY,m=this.upZ,g=p*d-m*h,y=-f*d+m*u,v=f*h-p*u;f=h*v-d*y,p=-u*v+d*g,m=u*y-h*g;var b=Math.sqrt(g*g+y*y+v*v);b!==0&&(g/=b,y/=b,v/=b);var w=Math.sqrt(f*f+p*p+m*m);return w!==0&&(f/=w,p/=w,m/=w),{x:[g,y,v],y:[f,p,m],z:[u,h,d]}},i.default.Camera.prototype._orbit=function(u,h,d){var c=this.eyeX-this.centerX,f=this.eyeY-this.centerY,p=this.eyeZ-this.centerZ,m=Math.sqrt(c*c+f*f+p*p),g=Math.atan2(c,p),y=Math.acos(Math.max(-1,Math.min(1,f/m)));g+=u,(m+=d)<0&&(m=.1),(y+=h)>Math.PI?y=Math.PI:y<=0&&(y=.001);var v=Math.sin(y)*m*Math.sin(g),b=Math.cos(y)*m,w=Math.sin(y)*m*Math.cos(g);this.camera(v+this.centerX,b+this.centerY,w+this.centerZ,this.centerX,this.centerY,this.centerZ,0,1,0)},i.default.Camera.prototype._isActive=function(){return this===this._renderer._curCamera},i.default.prototype.setCamera=function(u){this._renderer._curCamera=u,this._renderer.uPMatrix.set(u.projMatrix.mat4[0],u.projMatrix.mat4[1],u.projMatrix.mat4[2],u.projMatrix.mat4[3],u.projMatrix.mat4[4],u.projMatrix.mat4[5],u.projMatrix.mat4[6],u.projMatrix.mat4[7],u.projMatrix.mat4[8],u.projMatrix.mat4[9],u.projMatrix.mat4[10],u.projMatrix.mat4[11],u.projMatrix.mat4[12],u.projMatrix.mat4[13],u.projMatrix.mat4[14],u.projMatrix.mat4[15])};var l=i.default.Camera;o.default=l},{"../core/main":264}],313:[function(n,s,o){n("core-js/modules/es.string.sub"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var a,i=(a=n("../core/main"))&&a.__esModule?a:{default:a};i.default.Geometry=function(u,h,d){return this.vertices=[],this.lineVertices=[],this.lineNormals=[],this.vertexNormals=[],this.faces=[],this.uvs=[],this.edges=[],this.vertexColors=[],this.detailX=u!==void 0?u:1,this.detailY=h!==void 0?h:1,this.dirtyFlags={},d instanceof Function&&d.call(this),this},i.default.Geometry.prototype.reset=function(){this.lineVertices.length=0,this.lineNormals.length=0,this.vertices.length=0,this.edges.length=0,this.vertexColors.length=0,this.vertexNormals.length=0,this.uvs.length=0,this.dirtyFlags={}},i.default.Geometry.prototype.computeFaces=function(){this.faces.length=0;for(var u,h,d,c,f=this.detailX+1,p=0;p<this.detailY;p++)for(var m=0;m<this.detailX;m++)h=(u=p*f+m)+1,d=(p+1)*f+m+1,c=(p+1)*f+m,this.faces.push([u,h,c]),this.faces.push([c,h,d]);return this},i.default.Geometry.prototype._getFaceNormal=function(u){var h=this.faces[u],d=this.vertices[h[0]],c=this.vertices[h[1]],f=this.vertices[h[2]],p=i.default.Vector.sub(c,d),m=i.default.Vector.sub(f,d),g=i.default.Vector.cross(p,m),y=i.default.Vector.mag(g),v=y/(i.default.Vector.mag(p)*i.default.Vector.mag(m));return v===0||isNaN(v)?(console.warn("p5.Geometry.prototype._getFaceNormal:","face has colinear sides or a repeated vertex"),g):(1<v&&(v=1),g.mult(Math.asin(v)/y))},i.default.Geometry.prototype.computeNormals=function(){var u,h=this.vertexNormals,d=this.vertices,c=this.faces;for(u=h.length=0;u<d.length;++u)h.push(new i.default.Vector);for(var f=0;f<c.length;++f)for(var p=c[f],m=this._getFaceNormal(f),g=0;g<3;++g)h[p[g]].add(m);for(u=0;u<d.length;++u)h[u].normalize();return this},i.default.Geometry.prototype.averageNormals=function(){for(var u=0;u<=this.detailY;u++){var h=this.detailX+1,d=i.default.Vector.add(this.vertexNormals[u*h],this.vertexNormals[u*h+this.detailX]);d=i.default.Vector.div(d,2),this.vertexNormals[u*h]=d,this.vertexNormals[u*h+this.detailX]=d}return this},i.default.Geometry.prototype.averagePoleNormals=function(){for(var u=new i.default.Vector(0,0,0),h=0;h<this.detailX;h++)u.add(this.vertexNormals[h]);u=i.default.Vector.div(u,this.detailX);for(var d=0;d<this.detailX;d++)this.vertexNormals[d]=u;u=new i.default.Vector(0,0,0);for(var c=this.vertices.length-1;c>this.vertices.length-1-this.detailX;c--)u.add(this.vertexNormals[c]);u=i.default.Vector.div(u,this.detailX);for(var f=this.vertices.length-1;f>this.vertices.length-1-this.detailX;f--)this.vertexNormals[f]=u;return this},i.default.Geometry.prototype._makeTriangleEdges=function(){if(this.edges.length=0,Array.isArray(this.strokeIndices))for(var u=0,h=this.strokeIndices.length;u<h;u++)this.edges.push(this.strokeIndices[u]);else for(var d=0;d<this.faces.length;d++)this.edges.push([this.faces[d][0],this.faces[d][1]]),this.edges.push([this.faces[d][1],this.faces[d][2]]),this.edges.push([this.faces[d][2],this.faces[d][0]]);return this},i.default.Geometry.prototype._edgesToVertices=function(){this.lineVertices.length=0;for(var u=this.lineNormals.length=0;u<this.edges.length;u++){var h=this.vertices[this.edges[u][0]],d=this.vertices[this.edges[u][1]],c=d.copy().sub(h).normalize(),f=h.array(),p=h.array(),m=d.array(),g=d.array(),y=c.array(),v=c.array();y.push(1),v.push(-1),this.lineNormals.push(y,v,y,y,v,v),this.lineVertices.push(f,p,m,m,p,g)}return this},i.default.Geometry.prototype.normalize=function(){if(0<this.vertices.length){for(var u=this.vertices[0].copy(),h=this.vertices[0].copy(),d=0;d<this.vertices.length;d++)u.x=Math.max(u.x,this.vertices[d].x),h.x=Math.min(h.x,this.vertices[d].x),u.y=Math.max(u.y,this.vertices[d].y),h.y=Math.min(h.y,this.vertices[d].y),u.z=Math.max(u.z,this.vertices[d].z),h.z=Math.min(h.z,this.vertices[d].z);for(var c=i.default.Vector.lerp(u,h,.5),f=i.default.Vector.sub(u,h),p=200/Math.max(Math.max(f.x,f.y),f.z),m=0;m<this.vertices.length;m++)this.vertices[m].sub(c),this.vertices[m].mult(p)}return this};var l=i.default.Geometry;o.default=l},{"../core/main":264,"core-js/modules/es.string.sub":192}],314:[function(n,s,o){n("core-js/modules/es.array.iterator"),n("core-js/modules/es.object.to-string"),n("core-js/modules/es.typed-array.float32-array"),n("core-js/modules/es.typed-array.copy-within"),n("core-js/modules/es.typed-array.every"),n("core-js/modules/es.typed-array.fill"),n("core-js/modules/es.typed-array.filter"),n("core-js/modules/es.typed-array.find"),n("core-js/modules/es.typed-array.find-index"),n("core-js/modules/es.typed-array.for-each"),n("core-js/modules/es.typed-array.includes"),n("core-js/modules/es.typed-array.index-of"),n("core-js/modules/es.typed-array.iterator"),n("core-js/modules/es.typed-array.join"),n("core-js/modules/es.typed-array.last-index-of"),n("core-js/modules/es.typed-array.map"),n("core-js/modules/es.typed-array.reduce"),n("core-js/modules/es.typed-array.reduce-right"),n("core-js/modules/es.typed-array.reverse"),n("core-js/modules/es.typed-array.set"),n("core-js/modules/es.typed-array.slice"),n("core-js/modules/es.typed-array.some"),n("core-js/modules/es.typed-array.sort"),n("core-js/modules/es.typed-array.subarray"),n("core-js/modules/es.typed-array.to-locale-string"),n("core-js/modules/es.typed-array.to-string"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var a,i=(a=n("../core/main"))&&a.__esModule?a:{default:a},l=Array,u=function(d){return d instanceof Array};typeof Float32Array!="undefined"&&(l=Float32Array,u=function(d){return d instanceof Array||d instanceof Float32Array}),i.default.Matrix=function(){for(var d=new Array(arguments.length),c=0;c<d.length;++c)d[c]=arguments[c];return d.length&&d[d.length-1]instanceof i.default&&(this.p5=d[d.length-1]),d[0]==="mat3"?this.mat3=Array.isArray(d[1])?d[1]:new l([1,0,0,0,1,0,0,0,1]):this.mat4=Array.isArray(d[0])?d[0]:new l([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),this},i.default.Matrix.prototype.set=function(d){return d instanceof i.default.Matrix?this.mat4=d.mat4:u(d)?this.mat4=d:arguments.length===16&&(this.mat4[0]=d,this.mat4[1]=arguments[1],this.mat4[2]=arguments[2],this.mat4[3]=arguments[3],this.mat4[4]=arguments[4],this.mat4[5]=arguments[5],this.mat4[6]=arguments[6],this.mat4[7]=arguments[7],this.mat4[8]=arguments[8],this.mat4[9]=arguments[9],this.mat4[10]=arguments[10],this.mat4[11]=arguments[11],this.mat4[12]=arguments[12],this.mat4[13]=arguments[13],this.mat4[14]=arguments[14],this.mat4[15]=arguments[15]),this},i.default.Matrix.prototype.get=function(){return new i.default.Matrix(this.mat4,this.p5)},i.default.Matrix.prototype.copy=function(){var d=new i.default.Matrix(this.p5);return d.mat4[0]=this.mat4[0],d.mat4[1]=this.mat4[1],d.mat4[2]=this.mat4[2],d.mat4[3]=this.mat4[3],d.mat4[4]=this.mat4[4],d.mat4[5]=this.mat4[5],d.mat4[6]=this.mat4[6],d.mat4[7]=this.mat4[7],d.mat4[8]=this.mat4[8],d.mat4[9]=this.mat4[9],d.mat4[10]=this.mat4[10],d.mat4[11]=this.mat4[11],d.mat4[12]=this.mat4[12],d.mat4[13]=this.mat4[13],d.mat4[14]=this.mat4[14],d.mat4[15]=this.mat4[15],d},i.default.Matrix.identity=function(d){return new i.default.Matrix(d)},i.default.Matrix.prototype.transpose=function(d){var c,f,p,m,g,y;return d instanceof i.default.Matrix?(c=d.mat4[1],f=d.mat4[2],p=d.mat4[3],m=d.mat4[6],g=d.mat4[7],y=d.mat4[11],this.mat4[0]=d.mat4[0],this.mat4[1]=d.mat4[4],this.mat4[2]=d.mat4[8],this.mat4[3]=d.mat4[12],this.mat4[4]=c,this.mat4[5]=d.mat4[5],this.mat4[6]=d.mat4[9],this.mat4[7]=d.mat4[13],this.mat4[8]=f,this.mat4[9]=m,this.mat4[10]=d.mat4[10],this.mat4[11]=d.mat4[14],this.mat4[12]=p,this.mat4[13]=g,this.mat4[14]=y,this.mat4[15]=d.mat4[15]):u(d)&&(c=d[1],f=d[2],p=d[3],m=d[6],g=d[7],y=d[11],this.mat4[0]=d[0],this.mat4[1]=d[4],this.mat4[2]=d[8],this.mat4[3]=d[12],this.mat4[4]=c,this.mat4[5]=d[5],this.mat4[6]=d[9],this.mat4[7]=d[13],this.mat4[8]=f,this.mat4[9]=m,this.mat4[10]=d[10],this.mat4[11]=d[14],this.mat4[12]=p,this.mat4[13]=g,this.mat4[14]=y,this.mat4[15]=d[15]),this},i.default.Matrix.prototype.invert=function(d){var c,f,p,m,g,y,v,b,w,_,I,C,N,O,D,M;d instanceof i.default.Matrix?(c=d.mat4[0],f=d.mat4[1],p=d.mat4[2],m=d.mat4[3],g=d.mat4[4],y=d.mat4[5],v=d.mat4[6],b=d.mat4[7],w=d.mat4[8],_=d.mat4[9],I=d.mat4[10],C=d.mat4[11],N=d.mat4[12],O=d.mat4[13],D=d.mat4[14],M=d.mat4[15]):u(d)&&(c=d[0],f=d[1],p=d[2],m=d[3],g=d[4],y=d[5],v=d[6],b=d[7],w=d[8],_=d[9],I=d[10],C=d[11],N=d[12],O=d[13],D=d[14],M=d[15]);var P=c*y-f*g,F=c*v-p*g,B=c*b-m*g,z=f*v-p*y,Z=f*b-m*y,Q=p*b-m*v,K=w*O-_*N,ne=w*D-I*N,re=w*M-C*N,ce=_*D-I*O,be=_*M-C*O,we=I*M-C*D,ye=P*we-F*be+B*ce+z*re-Z*ne+Q*K;return ye?(ye=1/ye,this.mat4[0]=(y*we-v*be+b*ce)*ye,this.mat4[1]=(p*be-f*we-m*ce)*ye,this.mat4[2]=(O*Q-D*Z+M*z)*ye,this.mat4[3]=(I*Z-_*Q-C*z)*ye,this.mat4[4]=(v*re-g*we-b*ne)*ye,this.mat4[5]=(c*we-p*re+m*ne)*ye,this.mat4[6]=(D*B-N*Q-M*F)*ye,this.mat4[7]=(w*Q-I*B+C*F)*ye,this.mat4[8]=(g*be-y*re+b*K)*ye,this.mat4[9]=(f*re-c*be-m*K)*ye,this.mat4[10]=(N*Z-O*B+M*P)*ye,this.mat4[11]=(_*B-w*Z-C*P)*ye,this.mat4[12]=(y*ne-g*ce-v*K)*ye,this.mat4[13]=(c*ce-f*ne+p*K)*ye,this.mat4[14]=(O*F-N*z-D*P)*ye,this.mat4[15]=(w*z-_*F+I*P)*ye,this):null},i.default.Matrix.prototype.invert3x3=function(){var d=this.mat3[0],c=this.mat3[1],f=this.mat3[2],p=this.mat3[3],m=this.mat3[4],g=this.mat3[5],y=this.mat3[6],v=this.mat3[7],b=this.mat3[8],w=b*m-g*v,_=-b*p+g*y,I=v*p-m*y,C=d*w+c*_+f*I;return C?(C=1/C,this.mat3[0]=w*C,this.mat3[1]=(-b*c+f*v)*C,this.mat3[2]=(g*c-f*m)*C,this.mat3[3]=_*C,this.mat3[4]=(b*d-f*y)*C,this.mat3[5]=(-g*d+f*p)*C,this.mat3[6]=I*C,this.mat3[7]=(-v*d+c*y)*C,this.mat3[8]=(m*d-c*p)*C,this):null},i.default.Matrix.prototype.transpose3x3=function(d){var c=d[1],f=d[2],p=d[5];return this.mat3[1]=d[3],this.mat3[2]=d[6],this.mat3[3]=c,this.mat3[5]=d[7],this.mat3[6]=f,this.mat3[7]=p,this},i.default.Matrix.prototype.inverseTranspose=function(d){this.mat3===void 0?console.error("sorry, this function only works with mat3"):(this.mat3[0]=d.mat4[0],this.mat3[1]=d.mat4[1],this.mat3[2]=d.mat4[2],this.mat3[3]=d.mat4[4],this.mat3[4]=d.mat4[5],this.mat3[5]=d.mat4[6],this.mat3[6]=d.mat4[8],this.mat3[7]=d.mat4[9],this.mat3[8]=d.mat4[10]);var c=this.invert3x3();if(c)c.transpose3x3(this.mat3);else for(var f=0;f<9;f++)this.mat3[f]=0;return this},i.default.Matrix.prototype.determinant=function(){var d=this.mat4[0]*this.mat4[5]-this.mat4[1]*this.mat4[4],c=this.mat4[0]*this.mat4[6]-this.mat4[2]*this.mat4[4],f=this.mat4[0]*this.mat4[7]-this.mat4[3]*this.mat4[4],p=this.mat4[1]*this.mat4[6]-this.mat4[2]*this.mat4[5],m=this.mat4[1]*this.mat4[7]-this.mat4[3]*this.mat4[5],g=this.mat4[2]*this.mat4[7]-this.mat4[3]*this.mat4[6],y=this.mat4[8]*this.mat4[13]-this.mat4[9]*this.mat4[12],v=this.mat4[8]*this.mat4[14]-this.mat4[10]*this.mat4[12],b=this.mat4[8]*this.mat4[15]-this.mat4[11]*this.mat4[12],w=this.mat4[9]*this.mat4[14]-this.mat4[10]*this.mat4[13],_=this.mat4[9]*this.mat4[15]-this.mat4[11]*this.mat4[13];return d*(this.mat4[10]*this.mat4[15]-this.mat4[11]*this.mat4[14])-c*_+f*w+p*b-m*v+g*y},i.default.Matrix.prototype.mult=function(d){var c;if(d===this||d===this.mat4)c=this.copy().mat4;else if(d instanceof i.default.Matrix)c=d.mat4;else if(u(d))c=d;else{if(arguments.length!==16)return;c=arguments}var f=this.mat4[0],p=this.mat4[1],m=this.mat4[2],g=this.mat4[3];return this.mat4[0]=f*c[0]+p*c[4]+m*c[8]+g*c[12],this.mat4[1]=f*c[1]+p*c[5]+m*c[9]+g*c[13],this.mat4[2]=f*c[2]+p*c[6]+m*c[10]+g*c[14],this.mat4[3]=f*c[3]+p*c[7]+m*c[11]+g*c[15],f=this.mat4[4],p=this.mat4[5],m=this.mat4[6],g=this.mat4[7],this.mat4[4]=f*c[0]+p*c[4]+m*c[8]+g*c[12],this.mat4[5]=f*c[1]+p*c[5]+m*c[9]+g*c[13],this.mat4[6]=f*c[2]+p*c[6]+m*c[10]+g*c[14],this.mat4[7]=f*c[3]+p*c[7]+m*c[11]+g*c[15],f=this.mat4[8],p=this.mat4[9],m=this.mat4[10],g=this.mat4[11],this.mat4[8]=f*c[0]+p*c[4]+m*c[8]+g*c[12],this.mat4[9]=f*c[1]+p*c[5]+m*c[9]+g*c[13],this.mat4[10]=f*c[2]+p*c[6]+m*c[10]+g*c[14],this.mat4[11]=f*c[3]+p*c[7]+m*c[11]+g*c[15],f=this.mat4[12],p=this.mat4[13],m=this.mat4[14],g=this.mat4[15],this.mat4[12]=f*c[0]+p*c[4]+m*c[8]+g*c[12],this.mat4[13]=f*c[1]+p*c[5]+m*c[9]+g*c[13],this.mat4[14]=f*c[2]+p*c[6]+m*c[10]+g*c[14],this.mat4[15]=f*c[3]+p*c[7]+m*c[11]+g*c[15],this},i.default.Matrix.prototype.apply=function(d){var c;if(d===this||d===this.mat4)c=this.copy().mat4;else if(d instanceof i.default.Matrix)c=d.mat4;else if(u(d))c=d;else{if(arguments.length!==16)return;c=arguments}var f=this.mat4,p=f[0],m=f[4],g=f[8],y=f[12];f[0]=c[0]*p+c[1]*m+c[2]*g+c[3]*y,f[4]=c[4]*p+c[5]*m+c[6]*g+c[7]*y,f[8]=c[8]*p+c[9]*m+c[10]*g+c[11]*y,f[12]=c[12]*p+c[13]*m+c[14]*g+c[15]*y;var v=f[1],b=f[5],w=f[9],_=f[13];f[1]=c[0]*v+c[1]*b+c[2]*w+c[3]*_,f[5]=c[4]*v+c[5]*b+c[6]*w+c[7]*_,f[9]=c[8]*v+c[9]*b+c[10]*w+c[11]*_,f[13]=c[12]*v+c[13]*b+c[14]*w+c[15]*_;var I=f[2],C=f[6],N=f[10],O=f[14];f[2]=c[0]*I+c[1]*C+c[2]*N+c[3]*O,f[6]=c[4]*I+c[5]*C+c[6]*N+c[7]*O,f[10]=c[8]*I+c[9]*C+c[10]*N+c[11]*O,f[14]=c[12]*I+c[13]*C+c[14]*N+c[15]*O;var D=f[3],M=f[7],P=f[11],F=f[15];return f[3]=c[0]*D+c[1]*M+c[2]*P+c[3]*F,f[7]=c[4]*D+c[5]*M+c[6]*P+c[7]*F,f[11]=c[8]*D+c[9]*M+c[10]*P+c[11]*F,f[15]=c[12]*D+c[13]*M+c[14]*P+c[15]*F,this},i.default.Matrix.prototype.scale=function(d,c,f){return d instanceof i.default.Vector?(c=d.y,f=d.z,d=d.x):d instanceof Array&&(c=d[1],f=d[2],d=d[0]),this.mat4[0]*=d,this.mat4[1]*=d,this.mat4[2]*=d,this.mat4[3]*=d,this.mat4[4]*=c,this.mat4[5]*=c,this.mat4[6]*=c,this.mat4[7]*=c,this.mat4[8]*=f,this.mat4[9]*=f,this.mat4[10]*=f,this.mat4[11]*=f,this},i.default.Matrix.prototype.rotate=function(d,c,f,p){c instanceof i.default.Vector?(f=c.y,p=c.z,c=c.x):c instanceof Array&&(f=c[1],p=c[2],c=c[0]);var m=Math.sqrt(c*c+f*f+p*p);c*=1/m,f*=1/m,p*=1/m;var g=this.mat4[0],y=this.mat4[1],v=this.mat4[2],b=this.mat4[3],w=this.mat4[4],_=this.mat4[5],I=this.mat4[6],C=this.mat4[7],N=this.mat4[8],O=this.mat4[9],D=this.mat4[10],M=this.mat4[11],P=Math.sin(d),F=Math.cos(d),B=1-F,z=c*c*B+F,Z=f*c*B+p*P,Q=p*c*B-f*P,K=c*f*B-p*P,ne=f*f*B+F,re=p*f*B+c*P,ce=c*p*B+f*P,be=f*p*B-c*P,we=p*p*B+F;return this.mat4[0]=g*z+w*Z+N*Q,this.mat4[1]=y*z+_*Z+O*Q,this.mat4[2]=v*z+I*Z+D*Q,this.mat4[3]=b*z+C*Z+M*Q,this.mat4[4]=g*K+w*ne+N*re,this.mat4[5]=y*K+_*ne+O*re,this.mat4[6]=v*K+I*ne+D*re,this.mat4[7]=b*K+C*ne+M*re,this.mat4[8]=g*ce+w*be+N*we,this.mat4[9]=y*ce+_*be+O*we,this.mat4[10]=v*ce+I*be+D*we,this.mat4[11]=b*ce+C*be+M*we,this},i.default.Matrix.prototype.translate=function(d){var c=d[0],f=d[1],p=d[2]||0;this.mat4[12]+=this.mat4[0]*c+this.mat4[4]*f+this.mat4[8]*p,this.mat4[13]+=this.mat4[1]*c+this.mat4[5]*f+this.mat4[9]*p,this.mat4[14]+=this.mat4[2]*c+this.mat4[6]*f+this.mat4[10]*p,this.mat4[15]+=this.mat4[3]*c+this.mat4[7]*f+this.mat4[11]*p},i.default.Matrix.prototype.rotateX=function(d){this.rotate(d,1,0,0)},i.default.Matrix.prototype.rotateY=function(d){this.rotate(d,0,1,0)},i.default.Matrix.prototype.rotateZ=function(d){this.rotate(d,0,0,1)},i.default.Matrix.prototype.perspective=function(d,c,f,p){var m=1/Math.tan(d/2),g=1/(f-p);return this.mat4[0]=m/c,this.mat4[1]=0,this.mat4[2]=0,this.mat4[3]=0,this.mat4[4]=0,this.mat4[5]=m,this.mat4[6]=0,this.mat4[7]=0,this.mat4[8]=0,this.mat4[9]=0,this.mat4[10]=(p+f)*g,this.mat4[11]=-1,this.mat4[12]=0,this.mat4[13]=0,this.mat4[14]=2*p*f*g,this.mat4[15]=0,this},i.default.Matrix.prototype.ortho=function(d,c,f,p,m,g){var y=1/(d-c),v=1/(f-p),b=1/(m-g);return this.mat4[0]=-2*y,this.mat4[1]=0,this.mat4[2]=0,this.mat4[3]=0,this.mat4[4]=0,this.mat4[5]=-2*v,this.mat4[6]=0,this.mat4[7]=0,this.mat4[8]=0,this.mat4[9]=0,this.mat4[10]=2*b,this.mat4[11]=0,this.mat4[12]=(d+c)*y,this.mat4[13]=(p+f)*v,this.mat4[14]=(g+m)*b,this.mat4[15]=1,this};var h=i.default.Matrix;o.default=h},{"../core/main":264,"core-js/modules/es.array.iterator":158,"core-js/modules/es.object.to-string":177,"core-js/modules/es.typed-array.copy-within":197,"core-js/modules/es.typed-array.every":198,"core-js/modules/es.typed-array.fill":199,"core-js/modules/es.typed-array.filter":200,"core-js/modules/es.typed-array.find":202,"core-js/modules/es.typed-array.find-index":201,"core-js/modules/es.typed-array.float32-array":203,"core-js/modules/es.typed-array.for-each":205,"core-js/modules/es.typed-array.includes":206,"core-js/modules/es.typed-array.index-of":207,"core-js/modules/es.typed-array.iterator":210,"core-js/modules/es.typed-array.join":211,"core-js/modules/es.typed-array.last-index-of":212,"core-js/modules/es.typed-array.map":213,"core-js/modules/es.typed-array.reduce":215,"core-js/modules/es.typed-array.reduce-right":214,"core-js/modules/es.typed-array.reverse":216,"core-js/modules/es.typed-array.set":217,"core-js/modules/es.typed-array.slice":218,"core-js/modules/es.typed-array.some":219,"core-js/modules/es.typed-array.sort":220,"core-js/modules/es.typed-array.subarray":221,"core-js/modules/es.typed-array.to-locale-string":222,"core-js/modules/es.typed-array.to-string":223}],315:[function(n,s,o){n("core-js/modules/es.array.map"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var a,i=(a=n("../core/main"))&&a.__esModule?a:{default:a};i.default.RenderBuffer=function(u,h,d,c,f,p){this.size=u,this.src=h,this.dst=d,this.attr=c,this._renderer=f,this.map=p},i.default.RenderBuffer.prototype._prepareBuffer=function(u,h){var d,c=h.attributes,f=this._renderer.GL;d=u.model?u.model:u;var p=c[this.attr];if(p){var m=u[this.dst],g=d[this.src];if(0<g.length){var y=!m;if(y&&(u[this.dst]=m=f.createBuffer()),f.bindBuffer(f.ARRAY_BUFFER,m),y||d.dirtyFlags[this.src]!==!1){var v=this.map,b=v?v(g):g;this._renderer._bindBuffer(m,f.ARRAY_BUFFER,b),d.dirtyFlags[this.src]=!1}h.enableAttrib(p,this.size)}}};var l=i.default.RenderBuffer;o.default=l},{"../core/main":264,"core-js/modules/es.array.map":161}],316:[function(n,s,o){function a(c){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(f){return typeof f}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f})(c)}n("core-js/modules/es.symbol"),n("core-js/modules/es.symbol.description"),n("core-js/modules/es.symbol.iterator"),n("core-js/modules/es.array.fill"),n("core-js/modules/es.array.iterator"),n("core-js/modules/es.object.to-string"),n("core-js/modules/es.string.iterator"),n("core-js/modules/es.typed-array.float32-array"),n("core-js/modules/es.typed-array.copy-within"),n("core-js/modules/es.typed-array.every"),n("core-js/modules/es.typed-array.fill"),n("core-js/modules/es.typed-array.filter"),n("core-js/modules/es.typed-array.find"),n("core-js/modules/es.typed-array.find-index"),n("core-js/modules/es.typed-array.for-each"),n("core-js/modules/es.typed-array.includes"),n("core-js/modules/es.typed-array.index-of"),n("core-js/modules/es.typed-array.iterator"),n("core-js/modules/es.typed-array.join"),n("core-js/modules/es.typed-array.last-index-of"),n("core-js/modules/es.typed-array.map"),n("core-js/modules/es.typed-array.reduce"),n("core-js/modules/es.typed-array.reduce-right"),n("core-js/modules/es.typed-array.reverse"),n("core-js/modules/es.typed-array.set"),n("core-js/modules/es.typed-array.slice"),n("core-js/modules/es.typed-array.some"),n("core-js/modules/es.typed-array.sort"),n("core-js/modules/es.typed-array.subarray"),n("core-js/modules/es.typed-array.to-locale-string"),n("core-js/modules/es.typed-array.to-string"),n("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var i,l=(i=n("../core/main"))&&i.__esModule?i:{default:i},u=function(c){if(c&&c.__esModule)return c;if(c===null||a(c)!=="object"&&typeof c!="function")return{default:c};var f=h();if(f&&f.has(c))return f.get(c);var p={},m=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var g in c)if(Object.prototype.hasOwnProperty.call(c,g)){var y=m?Object.getOwnPropertyDescriptor(c,g):null;y&&(y.get||y.set)?Object.defineProperty(p,g,y):p[g]=c[g]}return p.default=c,f&&f.set(c,p),p}(n("../core/constants"));function h(){if(typeof WeakMap!="function")return null;var c=new WeakMap;return h=function(){return c},c}n("./p5.RenderBuffer"),l.default.RendererGL.prototype.beginShape=function(c){return this.immediateMode.shapeMode=c!==void 0?c:u.TRIANGLE_FAN,this.immediateMode.geometry.reset(),this},l.default.RendererGL.prototype.vertex=function(c,f){var p,m,g;p=m=g=0,arguments.length===3?p=arguments[2]:arguments.length===4?(m=arguments[2],g=arguments[3]):arguments.length===5&&(p=arguments[2],m=arguments[3],g=arguments[4]);var y=new l.default.Vector(c,f,p);this.immediateMode.geometry.vertices.push(y),this.immediateMode.geometry.vertexNormals.push(this._currentNormal);var v=this.curFillColor||[.5,.5,.5,1];return this.immediateMode.geometry.vertexColors.push(v[0],v[1],v[2],v[3]),this.textureMode===u.IMAGE&&(this._tex!==null?0<this._tex.width&&0<this._tex.height&&(m/=this._tex.width,g/=this._tex.height):this._tex===null&&4<=arguments.length&&console.warn("You must first call texture() before using vertex() with image based u and v coordinates")),this.immediateMode.geometry.uvs.push(m,g),this.immediateMode._bezierVertex[0]=c,this.immediateMode._bezierVertex[1]=f,this.immediateMode._bezierVertex[2]=p,this.immediateMode._quadraticVertex[0]=c,this.immediateMode._quadraticVertex[1]=f,this.immediateMode._quadraticVertex[2]=p,this},l.default.RendererGL.prototype.normal=function(c,f,p){return c instanceof l.default.Vector?this._currentNormal=c:this._currentNormal=new l.default.Vector(c,f,p),this},l.default.RendererGL.prototype.endShape=function(c,f,p,m,g,y){return this.immediateMode.shapeMode===u.POINTS?this._drawPoints(this.immediateMode.geometry.vertices,this.immediateMode.buffers.point):(this._processVertices.apply(this,arguments),this._doFill&&1<this.immediateMode.geometry.vertices.length&&this._drawImmediateFill(),this._doStroke&&1<this.immediateMode.geometry.lineVertices.length&&this._drawImmediateStroke(),this.isBezier=!1,this.isQuadratic=!1,this.isCurve=!1,this.immediateMode._bezierVertex.length=0,this.immediateMode._quadraticVertex.length=0,this.immediateMode._curveVertex.length=0),this},l.default.RendererGL.prototype._processVertices=function(c){if(this.immediateMode.geometry.vertices.length!==0){var f=this._doStroke&&this.drawMode!==u.TEXTURE,p=c===u.CLOSE;f&&(this.immediateMode.geometry.edges=this._calculateEdges(this.immediateMode.shapeMode,this.immediateMode.geometry.vertices,p),this.immediateMode.geometry._edgesToVertices());var m=this.immediateMode.shapeMode===u.TESS;(this.isBezier||this.isQuadratic||this.isCurve||m)&&this.immediateMode.shapeMode!==u.LINES&&this._tesselateShape()}},l.default.RendererGL.prototype._calculateEdges=function(c,f,p){var m=[],g=0;switch(c){case u.TRIANGLE_STRIP:for(g=0;g<f.length-2;g++)m.push([g,g+1]),m.push([g,g+2]);m.push([g,g+1]);break;case u.TRIANGLES:for(g=0;g<f.length-2;g+=3)m.push([g,g+1]),m.push([g+1,g+2]),m.push([g+2,g]);break;case u.LINES:for(g=0;g<f.length-1;g+=2)m.push([g,g+1]);break;default:for(g=0;g<f.length-1;g++)m.push([g,g+1])}return p&&m.push([f.length-1,0]),m},l.default.RendererGL.prototype._tesselateShape=function(){this.immediateMode.shapeMode=u.TRIANGLES;var c=[new Float32Array(this._vToNArray(this.immediateMode.geometry.vertices))],f=this._triangulate(c);this.immediateMode.geometry.vertices=[];for(var p=0,m=f.length;p<m;p+=3)this.vertex(f[p],f[p+1],f[p+2])},l.default.RendererGL.prototype._drawImmediateFill=function(){var c=this.GL,f=this._getImmediateFillShader();this._setFillUniforms(f);var p=!0,m=!1,g=void 0;try{for(var y,v=this.immediateMode.buffers.fill[Symbol.iterator]();!(p=(y=v.next()).done);p=!0)y.value._prepareBuffer(this.immediateMode.geometry,f)}catch(b){m=!0,g=b}finally{try{p||v.return==null||v.return()}finally{if(m)throw g}}this.immediateMode.shapeMode!==u.LINE_STRIP&&this.immediateMode.shapeMode!==u.LINES||(this.immediateMode.shapeMode=u.TRIANGLE_FAN),this._applyColorBlend(this.curFillColor),c.drawArrays(this.immediateMode.shapeMode,0,this.immediateMode.geometry.vertices.length),f.unbindShader()},l.default.RendererGL.prototype._drawImmediateStroke=function(){var c=this.GL,f=this._getImmediateStrokeShader();this._setStrokeUniforms(f);var p=!0,m=!1,g=void 0;try{for(var y,v=this.immediateMode.buffers.stroke[Symbol.iterator]();!(p=(y=v.next()).done);p=!0)y.value._prepareBuffer(this.immediateMode.geometry,f)}catch(b){m=!0,g=b}finally{try{p||v.return==null||v.return()}finally{if(m)throw g}}this._applyColorBlend(this.curStrokeColor),c.drawArrays(c.TRIANGLES,0,this.immediateMode.geometry.lineVertices.length),f.unbindShader()};var d=l.default.RendererGL;o.default=d},{"../core/constants":253,"../core/main":264,"./p5.RenderBuffer":315,"core-js/modules/es.array.fill":151,"core-js/modules/es.array.iterator":158,"core-js/modules/es.object.to-string":177,"core-js/modules/es.string.iterator":186,"core-js/modules/es.symbol":196,"core-js/modules/es.symbol.description":194,"core-js/modules/es.symbol.iterator":195,"core-js/modules/es.typed-array.copy-within":197,"core-js/modules/es.typed-array.every":198,"core-js/modules/es.typed-array.fill":199,"core-js/modules/es.typed-array.filter":200,"core-js/modules/es.typed-array.find":202,"core-js/modules/es.typed-array.find-index":201,"core-js/modules/es.typed-array.float32-array":203,"core-js/modules/es.typed-array.for-each":205,"core-js/modules/es.typed-array.includes":206,"core-js/modules/es.typed-array.index-of":207,"core-js/modules/es.typed-array.iterator":210,"core-js/modules/es.typed-array.join":211,"core-js/modules/es.typed-array.last-index-of":212,"core-js/modules/es.typed-array.map":213,"core-js/modules/es.typed-array.reduce":215,"core-js/modules/es.typed-array.reduce-right":214,"core-js/modules/es.typed-array.reverse":216,"core-js/modules/es.typed-array.set":217,"core-js/modules/es.typed-array.slice":218,"core-js/modules/es.typed-array.some":219,"core-js/modules/es.typed-array.sort":220,"core-js/modules/es.typed-array.subarray":221,"core-js/modules/es.typed-array.to-locale-string":222,"core-js/modules/es.typed-array.to-string":223,"core-js/modules/web.dom-collections.iterator":229}],317:[function(n,s,o){n("core-js/modules/es.symbol"),n("core-js/modules/es.symbol.description"),n("core-js/modules/es.symbol.iterator"),n("core-js/modules/es.array.fill"),n("core-js/modules/es.array.iterator"),n("core-js/modules/es.array.some"),n("core-js/modules/es.object.keys"),n("core-js/modules/es.object.to-string"),n("core-js/modules/es.string.iterator"),n("core-js/modules/es.typed-array.float32-array"),n("core-js/modules/es.typed-array.uint16-array"),n("core-js/modules/es.typed-array.uint32-array"),n("core-js/modules/es.typed-array.copy-within"),n("core-js/modules/es.typed-array.every"),n("core-js/modules/es.typed-array.fill"),n("core-js/modules/es.typed-array.filter"),n("core-js/modules/es.typed-array.find"),n("core-js/modules/es.typed-array.find-index"),n("core-js/modules/es.typed-array.for-each"),n("core-js/modules/es.typed-array.includes"),n("core-js/modules/es.typed-array.index-of"),n("core-js/modules/es.typed-array.iterator"),n("core-js/modules/es.typed-array.join"),n("core-js/modules/es.typed-array.last-index-of"),n("core-js/modules/es.typed-array.map"),n("core-js/modules/es.typed-array.reduce"),n("core-js/modules/es.typed-array.reduce-right"),n("core-js/modules/es.typed-array.reverse"),n("core-js/modules/es.typed-array.set"),n("core-js/modules/es.typed-array.slice"),n("core-js/modules/es.typed-array.some"),n("core-js/modules/es.typed-array.sort"),n("core-js/modules/es.typed-array.subarray"),n("core-js/modules/es.typed-array.to-locale-string"),n("core-js/modules/es.typed-array.to-string"),n("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var a,i=(a=n("../core/main"))&&a.__esModule?a:{default:a};n("./p5.RendererGL"),n("./p5.RenderBuffer");var l=0;i.default.RendererGL.prototype._initBufferDefaults=function(h){if(this._freeBuffers(h),1e3<++l){var d=Object.keys(this.retainedMode.geometry)[0];delete this.retainedMode.geometry[d],l--}return this.retainedMode.geometry[h]={}},i.default.RendererGL.prototype._freeBuffers=function(h){var d=this.retainedMode.geometry[h];if(d){delete this.retainedMode.geometry[h],l--;var c=this.GL;d.indexBuffer&&c.deleteBuffer(d.indexBuffer),f(this.retainedMode.buffers.stroke),f(this.retainedMode.buffers.fill)}function f(p){var m=!0,g=!1,y=void 0;try{for(var v,b=p[Symbol.iterator]();!(m=(v=b.next()).done);m=!0){var w=v.value;d[w.dst]&&(c.deleteBuffer(d[w.dst]),d[w.dst]=null)}}catch(_){g=!0,y=_}finally{try{m||b.return==null||b.return()}finally{if(g)throw y}}}},i.default.RendererGL.prototype.createBuffers=function(h,d){var c=this.GL,f=this._initBufferDefaults(h);f.model=d;var p=f.indexBuffer;if(d.faces.length){p=p||(f.indexBuffer=c.createBuffer());var m=i.default.RendererGL.prototype._flatten(d.faces),g=m.some(function(v){return 65535<v}),y=g?Uint32Array:Uint16Array;this._bindBuffer(p,c.ELEMENT_ARRAY_BUFFER,m,y),f.indexBufferType=g?c.UNSIGNED_INT:c.UNSIGNED_SHORT,f.vertexCount=3*d.faces.length}else p&&(c.deleteBuffer(p),f.indexBuffer=null),f.vertexCount=d.vertices?d.vertices.length:0;return f.lineVertexCount=d.lineVertices?d.lineVertices.length:0,f},i.default.RendererGL.prototype.drawBuffers=function(h){var d=this.GL,c=this.retainedMode.geometry[h];if(this._doStroke&&0<c.lineVertexCount){var f=this._getRetainedStrokeShader();this._setStrokeUniforms(f);var p=!0,m=!1,g=void 0;try{for(var y,v=this.retainedMode.buffers.stroke[Symbol.iterator]();!(p=(y=v.next()).done);p=!0)y.value._prepareBuffer(c,f)}catch(O){m=!0,g=O}finally{try{p||v.return==null||v.return()}finally{if(m)throw g}}this._applyColorBlend(this.curStrokeColor),this._drawArrays(d.TRIANGLES,h),f.unbindShader()}if(this._doFill){var b=this._getRetainedFillShader();this._setFillUniforms(b);var w=!0,_=!1,I=void 0;try{for(var C,N=this.retainedMode.buffers.fill[Symbol.iterator]();!(w=(C=N.next()).done);w=!0)C.value._prepareBuffer(c,b)}catch(O){_=!0,I=O}finally{try{w||N.return==null||N.return()}finally{if(_)throw I}}c.indexBuffer&&this._bindBuffer(c.indexBuffer,d.ELEMENT_ARRAY_BUFFER),this._applyColorBlend(this.curFillColor),this._drawElements(d.TRIANGLES,h),b.unbindShader()}return this},i.default.RendererGL.prototype.drawBuffersScaled=function(h,d,c,f){var p=this.uMVMatrix.copy();try{this.uMVMatrix.scale(d,c,f),this.drawBuffers(h)}finally{this.uMVMatrix=p}},i.default.RendererGL.prototype._drawArrays=function(h,d){return this.GL.drawArrays(h,0,this.retainedMode.geometry[d].lineVertexCount),this},i.default.RendererGL.prototype._drawElements=function(h,d){var c=this.retainedMode.geometry[d],f=this.GL;if(c.indexBuffer){if(c.indexBufferType===f.UNSIGNED_INT&&!f.getExtension("OES_element_index_uint"))throw new Error("Unable to render a 3d model with > 65535 triangles. Your web browser does not support the WebGL Extension OES_element_index_uint.");f.drawElements(f.TRIANGLES,c.vertexCount,c.indexBufferType,0)}else f.drawArrays(h||f.TRIANGLES,0,c.vertexCount)},i.default.RendererGL.prototype._drawPoints=function(h,d){var c=this.GL,f=this._getImmediatePointShader();this._setPointUniforms(f),this._bindBuffer(d,c.ARRAY_BUFFER,this._vToNArray(h),Float32Array,c.STATIC_DRAW),f.enableAttrib(f.attributes.aPosition,3),c.drawArrays(c.Points,0,h.length),f.unbindShader()};var u=i.default.RendererGL;o.default=u},{"../core/main":264,"./p5.RenderBuffer":315,"./p5.RendererGL":318,"core-js/modules/es.array.fill":151,"core-js/modules/es.array.iterator":158,"core-js/modules/es.array.some":163,"core-js/modules/es.object.keys":176,"core-js/modules/es.object.to-string":177,"core-js/modules/es.string.iterator":186,"core-js/modules/es.symbol":196,"core-js/modules/es.symbol.description":194,"core-js/modules/es.symbol.iterator":195,"core-js/modules/es.typed-array.copy-within":197,"core-js/modules/es.typed-array.every":198,"core-js/modules/es.typed-array.fill":199,"core-js/modules/es.typed-array.filter":200,"core-js/modules/es.typed-array.find":202,"core-js/modules/es.typed-array.find-index":201,"core-js/modules/es.typed-array.float32-array":203,"core-js/modules/es.typed-array.for-each":205,"core-js/modules/es.typed-array.includes":206,"core-js/modules/es.typed-array.index-of":207,"core-js/modules/es.typed-array.iterator":210,"core-js/modules/es.typed-array.join":211,"core-js/modules/es.typed-array.last-index-of":212,"core-js/modules/es.typed-array.map":213,"core-js/modules/es.typed-array.reduce":215,"core-js/modules/es.typed-array.reduce-right":214,"core-js/modules/es.typed-array.reverse":216,"core-js/modules/es.typed-array.set":217,"core-js/modules/es.typed-array.slice":218,"core-js/modules/es.typed-array.some":219,"core-js/modules/es.typed-array.sort":220,"core-js/modules/es.typed-array.subarray":221,"core-js/modules/es.typed-array.to-locale-string":222,"core-js/modules/es.typed-array.to-string":223,"core-js/modules/es.typed-array.uint16-array":224,"core-js/modules/es.typed-array.uint32-array":225,"core-js/modules/web.dom-collections.iterator":229}],318:[function(n,s,o){function a(g){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(y){return typeof y}:function(y){return y&&typeof Symbol=="function"&&y.constructor===Symbol&&y!==Symbol.prototype?"symbol":typeof y})(g)}n("core-js/modules/es.symbol"),n("core-js/modules/es.symbol.description"),n("core-js/modules/es.symbol.iterator"),n("core-js/modules/es.array.concat"),n("core-js/modules/es.array.fill"),n("core-js/modules/es.array.filter"),n("core-js/modules/es.array.from"),n("core-js/modules/es.array.includes"),n("core-js/modules/es.array.iterator"),n("core-js/modules/es.array.slice"),n("core-js/modules/es.object.assign"),n("core-js/modules/es.object.to-string"),n("core-js/modules/es.regexp.to-string"),n("core-js/modules/es.string.includes"),n("core-js/modules/es.string.iterator"),n("core-js/modules/es.typed-array.float32-array"),n("core-js/modules/es.typed-array.float64-array"),n("core-js/modules/es.typed-array.int16-array"),n("core-js/modules/es.typed-array.uint8-array"),n("core-js/modules/es.typed-array.uint16-array"),n("core-js/modules/es.typed-array.uint32-array"),n("core-js/modules/es.typed-array.copy-within"),n("core-js/modules/es.typed-array.every"),n("core-js/modules/es.typed-array.fill"),n("core-js/modules/es.typed-array.filter"),n("core-js/modules/es.typed-array.find"),n("core-js/modules/es.typed-array.find-index"),n("core-js/modules/es.typed-array.for-each"),n("core-js/modules/es.typed-array.includes"),n("core-js/modules/es.typed-array.index-of"),n("core-js/modules/es.typed-array.iterator"),n("core-js/modules/es.typed-array.join"),n("core-js/modules/es.typed-array.last-index-of"),n("core-js/modules/es.typed-array.map"),n("core-js/modules/es.typed-array.reduce"),n("core-js/modules/es.typed-array.reduce-right"),n("core-js/modules/es.typed-array.reverse"),n("core-js/modules/es.typed-array.set"),n("core-js/modules/es.typed-array.slice"),n("core-js/modules/es.typed-array.some"),n("core-js/modules/es.typed-array.sort"),n("core-js/modules/es.typed-array.subarray"),n("core-js/modules/es.typed-array.to-locale-string"),n("core-js/modules/es.typed-array.to-string"),n("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var i=d(n("../core/main")),l=function(g){if(g&&g.__esModule)return g;if(g===null||a(g)!=="object"&&typeof g!="function")return{default:g};var y=h();if(y&&y.has(g))return y.get(g);var v={},b=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var w in g)if(Object.prototype.hasOwnProperty.call(g,w)){var _=b?Object.getOwnPropertyDescriptor(g,w):null;_&&(_.get||_.set)?Object.defineProperty(v,w,_):v[w]=g[w]}return v.default=g,y&&y.set(g,v),v}(n("../core/constants")),u=d(n("libtess"));n("./p5.Shader"),n("./p5.Camera"),n("../core/p5.Renderer"),n("./p5.Matrix"),n("path");function h(){if(typeof WeakMap!="function")return null;var g=new WeakMap;return h=function(){return g},g}function d(g){return g&&g.__esModule?g:{default:g}}function c(g){return function(y){if(Array.isArray(y)){for(var v=0,b=new Array(y.length);v<y.length;v++)b[v]=y[v];return b}}(g)||function(y){if(Symbol.iterator in Object(y)||Object.prototype.toString.call(y)==="[object Arguments]")return Array.from(y)}(g)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var f=`precision highp float;
precision highp int;

uniform mat4 uViewMatrix;

uniform bool uUseLighting;

uniform int uAmbientLightCount;
uniform vec3 uAmbientColor[5];

uniform int uDirectionalLightCount;
uniform vec3 uLightingDirection[5];
uniform vec3 uDirectionalDiffuseColors[5];
uniform vec3 uDirectionalSpecularColors[5];

uniform int uPointLightCount;
uniform vec3 uPointLightLocation[5];
uniform vec3 uPointLightDiffuseColors[5];	
uniform vec3 uPointLightSpecularColors[5];

uniform int uSpotLightCount;
uniform float uSpotLightAngle[5];
uniform float uSpotLightConc[5];
uniform vec3 uSpotLightDiffuseColors[5];
uniform vec3 uSpotLightSpecularColors[5];
uniform vec3 uSpotLightLocation[5];
uniform vec3 uSpotLightDirection[5];

uniform bool uSpecular;
uniform float uShininess;

uniform float uConstantAttenuation;
uniform float uLinearAttenuation;
uniform float uQuadraticAttenuation;

const float specularFactor = 2.0;
const float diffuseFactor = 0.73;

struct LightResult {
  float specular;
  float diffuse;
};

float _phongSpecular(
  vec3 lightDirection,
  vec3 viewDirection,
  vec3 surfaceNormal,
  float shininess) {

  vec3 R = reflect(lightDirection, surfaceNormal);
  return pow(max(0.0, dot(R, viewDirection)), shininess);
}

float _lambertDiffuse(vec3 lightDirection, vec3 surfaceNormal) {
  return max(0.0, dot(-lightDirection, surfaceNormal));
}

LightResult _light(vec3 viewDirection, vec3 normal, vec3 lightVector) {

  vec3 lightDir = normalize(lightVector);

  //compute our diffuse & specular terms
  LightResult lr;
  if (uSpecular)
    lr.specular = _phongSpecular(lightDir, viewDirection, normal, uShininess);
  lr.diffuse = _lambertDiffuse(lightDir, normal);
  return lr;
}

void totalLight(
  vec3 modelPosition,
  vec3 normal,
  out vec3 totalDiffuse,
  out vec3 totalSpecular
) {

  totalSpecular = vec3(0.0);

  if (!uUseLighting) {
    totalDiffuse = vec3(1.0);
    return;
  }

  totalDiffuse = vec3(0.0);

  vec3 viewDirection = normalize(-modelPosition);

  for (int j = 0; j < 5; j++) {
    if (j < uDirectionalLightCount) {
      vec3 lightVector = (uViewMatrix * vec4(uLightingDirection[j], 0.0)).xyz;
      vec3 lightColor = uDirectionalDiffuseColors[j];
      vec3 specularColor = uDirectionalSpecularColors[j];
      LightResult result = _light(viewDirection, normal, lightVector);
      totalDiffuse += result.diffuse * lightColor;
      totalSpecular += result.specular * lightColor * specularColor;
    }

    if (j < uPointLightCount) {
      vec3 lightPosition = (uViewMatrix * vec4(uPointLightLocation[j], 1.0)).xyz;
      vec3 lightVector = modelPosition - lightPosition;
    
      //calculate attenuation
      float lightDistance = length(lightVector);
      float lightFalloff = 1.0 / (uConstantAttenuation + lightDistance * uLinearAttenuation + (lightDistance * lightDistance) * uQuadraticAttenuation);
      vec3 lightColor = lightFalloff * uPointLightDiffuseColors[j];
      vec3 specularColor = lightFalloff * uPointLightSpecularColors[j];

      LightResult result = _light(viewDirection, normal, lightVector);
      totalDiffuse += result.diffuse * lightColor;
      totalSpecular += result.specular * lightColor * specularColor;
    }

    if(j < uSpotLightCount) {
      vec3 lightPosition = (uViewMatrix * vec4(uSpotLightLocation[j], 1.0)).xyz;
      vec3 lightVector = modelPosition - lightPosition;
    
      float lightDistance = length(lightVector);
      float lightFalloff = 1.0 / (uConstantAttenuation + lightDistance * uLinearAttenuation + (lightDistance * lightDistance) * uQuadraticAttenuation);

      vec3 lightDirection = (uViewMatrix * vec4(uSpotLightDirection[j], 0.0)).xyz;
      float spotDot = dot(normalize(lightVector), normalize(lightDirection));
      float spotFalloff;
      if(spotDot < uSpotLightAngle[j]) {
        spotFalloff = 0.0;
      }
      else {
        spotFalloff = pow(spotDot, uSpotLightConc[j]);
      }
      lightFalloff *= spotFalloff;

      vec3 lightColor = uSpotLightDiffuseColors[j];
      vec3 specularColor = uSpotLightSpecularColors[j];
     
      LightResult result = _light(viewDirection, normal, lightVector);
      
      totalDiffuse += result.diffuse * lightColor * lightFalloff;
      totalSpecular += result.specular * lightColor * specularColor * lightFalloff;
    }
  }

  totalDiffuse *= diffuseFactor;
  totalSpecular *= specularFactor;
}
`,p={immediateVert:`attribute vec3 aPosition;
attribute vec4 aVertexColor;

uniform mat4 uModelViewMatrix;
uniform mat4 uProjectionMatrix;
uniform float uResolution;
uniform float uPointSize;

varying vec4 vColor;
void main(void) {
  vec4 positionVec4 = vec4(aPosition, 1.0);
  gl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;
  vColor = aVertexColor;
  gl_PointSize = uPointSize;
}
`,vertexColorVert:`attribute vec3 aPosition;
attribute vec4 aVertexColor;

uniform mat4 uModelViewMatrix;
uniform mat4 uProjectionMatrix;

varying vec4 vColor;

void main(void) {
  vec4 positionVec4 = vec4(aPosition, 1.0);
  gl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;
  vColor = aVertexColor;
}
`,vertexColorFrag:`precision mediump float;
varying vec4 vColor;
void main(void) {
  gl_FragColor = vColor;
}`,normalVert:`attribute vec3 aPosition;
attribute vec3 aNormal;
attribute vec2 aTexCoord;

uniform mat4 uModelViewMatrix;
uniform mat4 uProjectionMatrix;
uniform mat3 uNormalMatrix;

varying vec3 vVertexNormal;
varying highp vec2 vVertTexCoord;

void main(void) {
  vec4 positionVec4 = vec4(aPosition, 1.0);
  gl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;
  vVertexNormal = normalize(vec3( uNormalMatrix * aNormal ));
  vVertTexCoord = aTexCoord;
}
`,normalFrag:`precision mediump float;
varying vec3 vVertexNormal;
void main(void) {
  gl_FragColor = vec4(vVertexNormal, 1.0);
}`,basicFrag:`precision mediump float;
uniform vec4 uMaterialColor;
void main(void) {
  gl_FragColor = uMaterialColor;
}`,lightVert:f+`// include lighting.glgl

attribute vec3 aPosition;
attribute vec3 aNormal;
attribute vec2 aTexCoord;

uniform mat4 uModelViewMatrix;
uniform mat4 uProjectionMatrix;
uniform mat3 uNormalMatrix;

varying highp vec2 vVertTexCoord;
varying vec3 vDiffuseColor;
varying vec3 vSpecularColor;

void main(void) {

  vec4 viewModelPosition = uModelViewMatrix * vec4(aPosition, 1.0);
  gl_Position = uProjectionMatrix * viewModelPosition;

  vec3 vertexNormal = normalize(uNormalMatrix * aNormal);
  vVertTexCoord = aTexCoord;

  totalLight(viewModelPosition.xyz, vertexNormal, vDiffuseColor, vSpecularColor);

  for (int i = 0; i < 8; i++) {
    if (i < uAmbientLightCount) {
      vDiffuseColor += uAmbientColor[i];
    }
  }
}
`,lightTextureFrag:`precision highp float;

uniform vec4 uMaterialColor;
uniform vec4 uTint;
uniform sampler2D uSampler;
uniform bool isTexture;
uniform bool uEmissive;

varying highp vec2 vVertTexCoord;
varying vec3 vDiffuseColor;
varying vec3 vSpecularColor;

void main(void) {
  if(uEmissive && !isTexture) {
    gl_FragColor = uMaterialColor;
  }
  else {
    gl_FragColor = isTexture ? texture2D(uSampler, vVertTexCoord) * (uTint / vec4(255, 255, 255, 255)) : uMaterialColor;
    gl_FragColor.rgb = gl_FragColor.rgb * vDiffuseColor + vSpecularColor;
  }
}`,phongVert:`precision highp float;
precision highp int;

attribute vec3 aPosition;
attribute vec3 aNormal;
attribute vec2 aTexCoord;

uniform vec3 uAmbientColor[5];

uniform mat4 uModelViewMatrix;
uniform mat4 uProjectionMatrix;
uniform mat3 uNormalMatrix;
uniform int uAmbientLightCount;

varying vec3 vNormal;
varying vec2 vTexCoord;
varying vec3 vViewPosition;
varying vec3 vAmbientColor;

void main(void) {

  vec4 viewModelPosition = uModelViewMatrix * vec4(aPosition, 1.0);

  // Pass varyings to fragment shader
  vViewPosition = viewModelPosition.xyz;
  gl_Position = uProjectionMatrix * viewModelPosition;  

  vNormal = uNormalMatrix * aNormal;
  vTexCoord = aTexCoord;

  // TODO: this should be a uniform
  vAmbientColor = vec3(0.0);
  for (int i = 0; i < 5; i++) {
    if (i < uAmbientLightCount) {
      vAmbientColor += uAmbientColor[i];
    }
  }
}
`,phongFrag:f+`// include lighting.glsl
precision highp float;
precision highp int;

uniform vec4 uMaterialColor;
uniform vec4 uTint;
uniform sampler2D uSampler;
uniform bool isTexture;
uniform bool uEmissive;

varying vec3 vNormal;
varying vec2 vTexCoord;
varying vec3 vViewPosition;
varying vec3 vAmbientColor;

void main(void) {

  vec3 diffuse;
  vec3 specular;
  totalLight(vViewPosition, normalize(vNormal), diffuse, specular);

  if(uEmissive && !isTexture) {
    gl_FragColor = uMaterialColor;
  }
  else {
    gl_FragColor = isTexture ? texture2D(uSampler, vTexCoord) * (uTint / vec4(255, 255, 255, 255)) : uMaterialColor;
    gl_FragColor.rgb = gl_FragColor.rgb * (diffuse + vAmbientColor) + specular;
  }
}`,fontVert:`precision mediump float;

attribute vec3 aPosition;
attribute vec2 aTexCoord;
uniform mat4 uModelViewMatrix;
uniform mat4 uProjectionMatrix;

uniform vec4 uGlyphRect;
uniform float uGlyphOffset;

varying vec2 vTexCoord;
varying float w;

void main() {
  vec4 positionVec4 = vec4(aPosition, 1.0);

  // scale by the size of the glyph's rectangle
  positionVec4.xy *= uGlyphRect.zw - uGlyphRect.xy;

  // move to the corner of the glyph
  positionVec4.xy += uGlyphRect.xy;

  // move to the letter's line offset
  positionVec4.x += uGlyphOffset;
  
  gl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;
  vTexCoord = aTexCoord;
  w = gl_Position.w;
}
`,fontFrag:`#extension GL_OES_standard_derivatives : enable
precision mediump float;

#if 0
  // simulate integer math using floats
	#define int float
	#define ivec2 vec2
	#define INT(x) float(x)

	int ifloor(float v) { return floor(v); }
	ivec2 ifloor(vec2 v) { return floor(v); }

#else
  // use native integer math
	precision highp int;
	#define INT(x) x

	int ifloor(float v) { return int(v); }
	int ifloor(int v) { return v; }
	ivec2 ifloor(vec2 v) { return ivec2(v); }

#endif

uniform sampler2D uSamplerStrokes;
uniform sampler2D uSamplerRowStrokes;
uniform sampler2D uSamplerRows;
uniform sampler2D uSamplerColStrokes;
uniform sampler2D uSamplerCols;

uniform ivec2 uStrokeImageSize;
uniform ivec2 uCellsImageSize;
uniform ivec2 uGridImageSize;

uniform ivec2 uGridOffset;
uniform ivec2 uGridSize;
uniform vec4 uMaterialColor;

varying vec2 vTexCoord;

// some helper functions
int round(float v) { return ifloor(v + 0.5); }
ivec2 round(vec2 v) { return ifloor(v + 0.5); }
float saturate(float v) { return clamp(v, 0.0, 1.0); }
vec2 saturate(vec2 v) { return clamp(v, 0.0, 1.0); }

int mul(float v1, int v2) {
  return ifloor(v1 * float(v2));
}

ivec2 mul(vec2 v1, ivec2 v2) {
  return ifloor(v1 * vec2(v2) + 0.5);
}

// unpack a 16-bit integer from a float vec2
int getInt16(vec2 v) {
  ivec2 iv = round(v * 255.0);
  return iv.x * INT(128) + iv.y;
}

vec2 pixelScale;
vec2 coverage = vec2(0.0);
vec2 weight = vec2(0.5);
const float minDistance = 1.0/8192.0;
const float hardness = 1.05; // amount of antialias

// the maximum number of curves in a glyph
const int N = INT(250);

// retrieves an indexed pixel from a sampler
vec4 getTexel(sampler2D sampler, int pos, ivec2 size) {
  int width = size.x;
  int y = ifloor(pos / width);
  int x = pos - y * width;  // pos % width

  return texture2D(sampler, (vec2(x, y) + 0.5) / vec2(size));
}

void calulateCrossings(vec2 p0, vec2 p1, vec2 p2, out vec2 C1, out vec2 C2) {

  // get the coefficients of the quadratic in t
  vec2 a = p0 - p1 * 2.0 + p2;
  vec2 b = p0 - p1;
  vec2 c = p0 - vTexCoord;

  // found out which values of 't' it crosses the axes
  vec2 surd = sqrt(max(vec2(0.0), b * b - a * c));
  vec2 t1 = ((b - surd) / a).yx;
  vec2 t2 = ((b + surd) / a).yx;

  // approximate straight lines to avoid rounding errors
  if (abs(a.y) < 0.001)
    t1.x = t2.x = c.y / (2.0 * b.y);

  if (abs(a.x) < 0.001)
    t1.y = t2.y = c.x / (2.0 * b.x);

  // plug into quadratic formula to find the corrdinates of the crossings
  C1 = ((a * t1 - b * 2.0) * t1 + c) * pixelScale;
  C2 = ((a * t2 - b * 2.0) * t2 + c) * pixelScale;
}

void coverageX(vec2 p0, vec2 p1, vec2 p2) {

  vec2 C1, C2;
  calulateCrossings(p0, p1, p2, C1, C2);

  // determine on which side of the x-axis the points lie
  bool y0 = p0.y > vTexCoord.y;
  bool y1 = p1.y > vTexCoord.y;
  bool y2 = p2.y > vTexCoord.y;

  // could web be under the curve (after t1)?
  if (y1 ? !y2 : y0) {
    // add the coverage for t1
    coverage.x += saturate(C1.x + 0.5);
    // calculate the anti-aliasing for t1
    weight.x = min(weight.x, abs(C1.x));
  }

  // are we outside the curve (after t2)?
  if (y1 ? !y0 : y2) {
    // subtract the coverage for t2
    coverage.x -= saturate(C2.x + 0.5);
    // calculate the anti-aliasing for t2
    weight.x = min(weight.x, abs(C2.x));
  }
}

// this is essentially the same as coverageX, but with the axes swapped
void coverageY(vec2 p0, vec2 p1, vec2 p2) {

  vec2 C1, C2;
  calulateCrossings(p0, p1, p2, C1, C2);

  bool x0 = p0.x > vTexCoord.x;
  bool x1 = p1.x > vTexCoord.x;
  bool x2 = p2.x > vTexCoord.x;

  if (x1 ? !x2 : x0) {
    coverage.y -= saturate(C1.y + 0.5);
    weight.y = min(weight.y, abs(C1.y));
  }

  if (x1 ? !x0 : x2) {
    coverage.y += saturate(C2.y + 0.5);
    weight.y = min(weight.y, abs(C2.y));
  }
}

void main() {

  // calculate the pixel scale based on screen-coordinates
  pixelScale = hardness / fwidth(vTexCoord);

  // which grid cell is this pixel in?
  ivec2 gridCoord = ifloor(vTexCoord * vec2(uGridSize));

  // intersect curves in this row
  {
    // the index into the row info bitmap
    int rowIndex = gridCoord.y + uGridOffset.y;
    // fetch the info texel
    vec4 rowInfo = getTexel(uSamplerRows, rowIndex, uGridImageSize);
    // unpack the rowInfo
    int rowStrokeIndex = getInt16(rowInfo.xy);
    int rowStrokeCount = getInt16(rowInfo.zw);

    for (int iRowStroke = INT(0); iRowStroke < N; iRowStroke++) {
      if (iRowStroke >= rowStrokeCount)
        break;

      // each stroke is made up of 3 points: the start and control point
      // and the start of the next curve.
      // fetch the indices of this pair of strokes:
      vec4 strokeIndices = getTexel(uSamplerRowStrokes, rowStrokeIndex++, uCellsImageSize);

      // unpack the stroke index
      int strokePos = getInt16(strokeIndices.xy);

      // fetch the two strokes
      vec4 stroke0 = getTexel(uSamplerStrokes, strokePos + INT(0), uStrokeImageSize);
      vec4 stroke1 = getTexel(uSamplerStrokes, strokePos + INT(1), uStrokeImageSize);

      // calculate the coverage
      coverageX(stroke0.xy, stroke0.zw, stroke1.xy);
    }
  }

  // intersect curves in this column
  {
    int colIndex = gridCoord.x + uGridOffset.x;
    vec4 colInfo = getTexel(uSamplerCols, colIndex, uGridImageSize);
    int colStrokeIndex = getInt16(colInfo.xy);
    int colStrokeCount = getInt16(colInfo.zw);
    
    for (int iColStroke = INT(0); iColStroke < N; iColStroke++) {
      if (iColStroke >= colStrokeCount)
        break;

      vec4 strokeIndices = getTexel(uSamplerColStrokes, colStrokeIndex++, uCellsImageSize);

      int strokePos = getInt16(strokeIndices.xy);
      vec4 stroke0 = getTexel(uSamplerStrokes, strokePos + INT(0), uStrokeImageSize);
      vec4 stroke1 = getTexel(uSamplerStrokes, strokePos + INT(1), uStrokeImageSize);
      coverageY(stroke0.xy, stroke0.zw, stroke1.xy);
    }
  }

  weight = saturate(1.0 - weight * 2.0);
  float distance = max(weight.x + weight.y, minDistance); // manhattan approx.
  float antialias = abs(dot(coverage, weight) / distance);
  float cover = min(abs(coverage.x), abs(coverage.y));
  gl_FragColor = uMaterialColor;
  gl_FragColor.a *= saturate(max(antialias, cover));
}`,lineVert:`/*
  Part of the Processing project - http://processing.org
  Copyright (c) 2012-15 The Processing Foundation
  Copyright (c) 2004-12 Ben Fry and Casey Reas
  Copyright (c) 2001-04 Massachusetts Institute of Technology
  This library is free software; you can redistribute it and/or
  modify it under the terms of the GNU Lesser General Public
  License as published by the Free Software Foundation, version 2.1.
  This library is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
  Lesser General Public License for more details.
  You should have received a copy of the GNU Lesser General
  Public License along with this library; if not, write to the
  Free Software Foundation, Inc., 59 Temple Place, Suite 330,
  Boston, MA  02111-1307  USA
*/

#define PROCESSING_LINE_SHADER

uniform mat4 uModelViewMatrix;
uniform mat4 uProjectionMatrix;
uniform float uStrokeWeight;

uniform vec4 uViewport;
uniform int uPerspective;

attribute vec4 aPosition;
attribute vec4 aDirection;
  
void main() {
  // using a scale <1 moves the lines towards the camera
  // in order to prevent popping effects due to half of
  // the line disappearing behind the geometry faces.
  vec3 scale = vec3(0.9995);

  vec4 posp = uModelViewMatrix * aPosition;
  vec4 posq = uModelViewMatrix * (aPosition + vec4(aDirection.xyz, 0));

  // Moving vertices slightly toward the camera
  // to avoid depth-fighting with the fill triangles.
  // Discussed here:
  // http://www.opengl.org/discussion_boards/ubbthreads.php?ubb=showflat&Number=252848  
  posp.xyz = posp.xyz * scale;
  posq.xyz = posq.xyz * scale;

  vec4 p = uProjectionMatrix * posp;
  vec4 q = uProjectionMatrix * posq;

  // formula to convert from clip space (range -1..1) to screen space (range 0..[width or height])
  // screen_p = (p.xy/p.w + <1,1>) * 0.5 * uViewport.zw

  // prevent division by W by transforming the tangent formula (div by 0 causes
  // the line to disappear, see https://github.com/processing/processing/issues/5183)
  // t = screen_q - screen_p
  //
  // tangent is normalized and we don't care which aDirection it points to (+-)
  // t = +- normalize( screen_q - screen_p )
  // t = +- normalize( (q.xy/q.w+<1,1>)*0.5*uViewport.zw - (p.xy/p.w+<1,1>)*0.5*uViewport.zw )
  //
  // extract common factor, <1,1> - <1,1> cancels out
  // t = +- normalize( (q.xy/q.w - p.xy/p.w) * 0.5 * uViewport.zw )
  //
  // convert to common divisor
  // t = +- normalize( ((q.xy*p.w - p.xy*q.w) / (p.w*q.w)) * 0.5 * uViewport.zw )
  //
  // remove the common scalar divisor/factor, not needed due to normalize and +-
  // (keep uViewport - can't remove because it has different components for x and y
  //  and corrects for aspect ratio, see https://github.com/processing/processing/issues/5181)
  // t = +- normalize( (q.xy*p.w - p.xy*q.w) * uViewport.zw )

  vec2 tangent = normalize((q.xy*p.w - p.xy*q.w) * uViewport.zw);

  // flip tangent to normal (it's already normalized)
  vec2 normal = vec2(-tangent.y, tangent.x);

  float thickness = aDirection.w * uStrokeWeight;
  vec2 offset = normal * thickness / 2.0;

  vec2 curPerspScale;

  if(uPerspective == 1) {
    // Perspective ---
    // convert from world to clip by multiplying with projection scaling factor
    // to get the right thickness (see https://github.com/processing/processing/issues/5182)
    // invert Y, projections in Processing invert Y
    curPerspScale = (uProjectionMatrix * vec4(1, -1, 0, 0)).xy;
  } else {
    // No Perspective ---
    // multiply by W (to cancel out division by W later in the pipeline) and
    // convert from screen to clip (derived from clip to screen above)
    curPerspScale = p.w / (0.5 * uViewport.zw);
  }

  gl_Position.xy = p.xy + offset.xy * curPerspScale;
  gl_Position.zw = p.zw;
}
`,lineFrag:`precision mediump float;
precision mediump int;

uniform vec4 uMaterialColor;

void main() {
  gl_FragColor = uMaterialColor;
}`,pointVert:`attribute vec3 aPosition;
uniform float uPointSize;
varying float vStrokeWeight;
uniform mat4 uModelViewMatrix;
uniform mat4 uProjectionMatrix;
void main() {
	vec4 positionVec4 =  vec4(aPosition, 1.0);
	gl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;
	gl_PointSize = uPointSize;
	vStrokeWeight = uPointSize;
}`,pointFrag:`precision mediump float;
precision mediump int;
uniform vec4 uMaterialColor;
varying float vStrokeWeight;

void main(){
	float mask = 0.0;

	// make a circular mask using the gl_PointCoord (goes from 0 - 1 on a point)
    // might be able to get a nicer edge on big strokeweights with smoothstep but slightly less performant

	mask = step(0.98, length(gl_PointCoord * 2.0 - 1.0));

	// if strokeWeight is 1 or less lets just draw a square
	// this prevents weird artifacting from carving circles when our points are really small
	// if strokeWeight is larger than 1, we just use it as is

	mask = mix(0.0, mask, clamp(floor(vStrokeWeight - 0.5),0.0,1.0));

	// throw away the borders of the mask
    // otherwise we get weird alpha blending issues

	if(mask > 0.98){
      discard;
  	}

  	gl_FragColor = vec4(uMaterialColor.rgb * (1.0 - mask), uMaterialColor.a) ;
}`};i.default.RendererGL=function(g,y,v,b){return i.default.Renderer.call(this,g,y,v),this._setAttributeDefaults(y),this._initContext(),this.isP3D=!0,this.GL=this.drawingContext,this._pInst._setProperty("drawingContext",this.drawingContext),this._isErasing=!1,this._enableLighting=!1,this.ambientLightColors=[],this.specularColors=[1,1,1],this.directionalLightDirections=[],this.directionalLightDiffuseColors=[],this.directionalLightSpecularColors=[],this.pointLightPositions=[],this.pointLightDiffuseColors=[],this.pointLightSpecularColors=[],this.spotLightPositions=[],this.spotLightDirections=[],this.spotLightDiffuseColors=[],this.spotLightSpecularColors=[],this.spotLightAngle=[],this.spotLightConc=[],this.drawMode=l.FILL,this.curFillColor=this._cachedFillStyle=[1,1,1,1],this.curStrokeColor=this._cachedStrokeStyle=[0,0,0,1],this.curBlendMode=l.BLEND,this._cachedBlendMode=void 0,this.blendExt=this.GL.getExtension("EXT_blend_minmax"),this._isBlending=!1,this._useSpecularMaterial=!1,this._useEmissiveMaterial=!1,this._useNormalMaterial=!1,this._useShininess=1,this._tint=[255,255,255,255],this.constantAttenuation=1,this.linearAttenuation=0,this.quadraticAttenuation=0,this.uMVMatrix=new i.default.Matrix,this.uPMatrix=new i.default.Matrix,this.uNMatrix=new i.default.Matrix("mat3"),this._currentNormal=new i.default.Vector(0,0,1),this._curCamera=new i.default.Camera(this),this._curCamera._computeCameraDefaultSettings(),this._curCamera._setDefaultCamera(),this._defaultLightShader=void 0,this._defaultImmediateModeShader=void 0,this._defaultNormalShader=void 0,this._defaultColorShader=void 0,this._defaultPointShader=void 0,this.userFillShader=void 0,this.userStrokeShader=void 0,this.userPointShader=void 0,this.retainedMode={geometry:{},buffers:{stroke:[new i.default.RenderBuffer(3,"lineVertices","lineVertexBuffer","aPosition",this,this._flatten),new i.default.RenderBuffer(4,"lineNormals","lineNormalBuffer","aDirection",this,this._flatten)],fill:[new i.default.RenderBuffer(3,"vertices","vertexBuffer","aPosition",this,this._vToNArray),new i.default.RenderBuffer(3,"vertexNormals","normalBuffer","aNormal",this,this._vToNArray),new i.default.RenderBuffer(4,"vertexColors","colorBuffer","aVertexColor",this),new i.default.RenderBuffer(3,"vertexAmbients","ambientBuffer","aAmbientColor",this),new i.default.RenderBuffer(2,"uvs","uvBuffer","aTexCoord",this,this._flatten)],text:[new i.default.RenderBuffer(3,"vertices","vertexBuffer","aPosition",this,this._vToNArray),new i.default.RenderBuffer(2,"uvs","uvBuffer","aTexCoord",this,this._flatten)]}},this.immediateMode={geometry:new i.default.Geometry,shapeMode:l.TRIANGLE_FAN,_bezierVertex:[],_quadraticVertex:[],_curveVertex:[],buffers:{fill:[new i.default.RenderBuffer(3,"vertices","vertexBuffer","aPosition",this,this._vToNArray),new i.default.RenderBuffer(3,"vertexNormals","normalBuffer","aNormal",this,this._vToNArray),new i.default.RenderBuffer(4,"vertexColors","colorBuffer","aVertexColor",this),new i.default.RenderBuffer(3,"vertexAmbients","ambientBuffer","aAmbientColor",this),new i.default.RenderBuffer(2,"uvs","uvBuffer","aTexCoord",this,this._flatten)],stroke:[new i.default.RenderBuffer(3,"lineVertices","lineVertexBuffer","aPosition",this,this._flatten),new i.default.RenderBuffer(4,"lineNormals","lineNormalBuffer","aDirection",this,this._flatten)],point:this.GL.createBuffer()}},this.pointSize=5,this.curStrokeWeight=1,this.textures=[],this.textureMode=l.IMAGE,this.textureWrapX=l.CLAMP,this.textureWrapY=l.CLAMP,this._tex=null,this._curveTightness=6,this._lookUpTableBezier=[],this._lookUpTableQuadratic=[],this._lutBezierDetail=0,this._lutQuadraticDetail=0,this._tessy=this._initTessy(),this.fontInfos={},this._curShader=void 0,this},i.default.RendererGL.prototype=Object.create(i.default.Renderer.prototype),i.default.RendererGL.prototype._setAttributeDefaults=function(g){var y={alpha:!1,depth:!0,stencil:!0,antialias:navigator.userAgent.toLowerCase().includes("safari"),premultipliedAlpha:!1,preserveDrawingBuffer:!0,perPixelLighting:!0};g._glAttributes===null?g._glAttributes=y:g._glAttributes=Object.assign(y,g._glAttributes)},i.default.RendererGL.prototype._initContext=function(){try{if(this.drawingContext=this.canvas.getContext("webgl",this._pInst._glAttributes)||this.canvas.getContext("experimental-webgl",this._pInst._glAttributes),this.drawingContext===null)throw new Error("Error creating webgl context");var g=this.drawingContext;g.enable(g.DEPTH_TEST),g.depthFunc(g.LEQUAL),g.viewport(0,0,g.drawingBufferWidth,g.drawingBufferHeight),this._viewport=this.drawingContext.getParameter(this.drawingContext.VIEWPORT)}catch(y){throw y}},i.default.RendererGL.prototype._resetContext=function(g,y){var v=this.width,b=this.height,w=this.canvas.id,_=this._pInst instanceof i.default.Graphics;if(_){var I=this._pInst;I.canvas.parentNode.removeChild(I.canvas),I.canvas=document.createElement("canvas"),(I._pInst._userNode||document.body).appendChild(I.canvas),i.default.Element.call(I,I.canvas,I._pInst),I.width=v,I.height=b}else{var C=this.canvas;C&&C.parentNode.removeChild(C),(C=document.createElement("canvas")).id=w,this._pInst._userNode?this._pInst._userNode.appendChild(C):document.body.appendChild(C),this._pInst.canvas=C}var N=new i.default.RendererGL(this._pInst.canvas,this._pInst,!_);this._pInst._setProperty("_renderer",N),N.resize(v,b),N._applyDefaults(),_||this._pInst._elements.push(N),typeof y=="function"&&setTimeout(function(){y.apply(window._renderer,g)},0)},i.default.prototype.setAttributes=function(g,y){if(this._glAttributes!==void 0){var v=!0;if(y!==void 0?(this._glAttributes===null&&(this._glAttributes={}),this._glAttributes[g]!==y&&(this._glAttributes[g]=y,v=!1)):g instanceof Object&&this._glAttributes!==g&&(this._glAttributes=g,v=!1),this._renderer.isP3D&&!v){if(!this._setupDone){for(var b in this._renderer.retainedMode.geometry)if(this._renderer.retainedMode.geometry.hasOwnProperty(b))return void console.error("Sorry, Could not set the attributes, you need to call setAttributes() before calling the other drawing methods in setup()")}this.push(),this._renderer._resetContext(),this.pop(),this._renderer._curCamera&&(this._renderer._curCamera._renderer=this._renderer)}}else console.log("You are trying to use setAttributes on a p5.Graphics object that does not use a WEBGL renderer.")},i.default.RendererGL.prototype._update=function(){this.uMVMatrix.set(this._curCamera.cameraMatrix.mat4[0],this._curCamera.cameraMatrix.mat4[1],this._curCamera.cameraMatrix.mat4[2],this._curCamera.cameraMatrix.mat4[3],this._curCamera.cameraMatrix.mat4[4],this._curCamera.cameraMatrix.mat4[5],this._curCamera.cameraMatrix.mat4[6],this._curCamera.cameraMatrix.mat4[7],this._curCamera.cameraMatrix.mat4[8],this._curCamera.cameraMatrix.mat4[9],this._curCamera.cameraMatrix.mat4[10],this._curCamera.cameraMatrix.mat4[11],this._curCamera.cameraMatrix.mat4[12],this._curCamera.cameraMatrix.mat4[13],this._curCamera.cameraMatrix.mat4[14],this._curCamera.cameraMatrix.mat4[15]),this.ambientLightColors.length=0,this.specularColors=[1,1,1],this.directionalLightDirections.length=0,this.directionalLightDiffuseColors.length=0,this.directionalLightSpecularColors.length=0,this.pointLightPositions.length=0,this.pointLightDiffuseColors.length=0,this.pointLightSpecularColors.length=0,this.spotLightPositions.length=0,this.spotLightDirections.length=0,this.spotLightDiffuseColors.length=0,this.spotLightSpecularColors.length=0,this.spotLightAngle.length=0,this.spotLightConc.length=0,this._enableLighting=!1,this._tint=[255,255,255,255],this.GL.clear(this.GL.DEPTH_BUFFER_BIT)},i.default.RendererGL.prototype.background=function(){var g,y=(g=this._pInst).color.apply(g,arguments),v=y.levels[0]/255,b=y.levels[1]/255,w=y.levels[2]/255,_=y.levels[3]/255;this.GL.clearColor(v,b,w,_),this.GL.clear(this.GL.COLOR_BUFFER_BIT)},i.default.RendererGL.prototype.fill=function(g,y,v,b){var w=i.default.prototype.color.apply(this._pInst,arguments);this.curFillColor=w._array,this.drawMode=l.FILL,this._useNormalMaterial=!1,this._tex=null},i.default.RendererGL.prototype.stroke=function(g,y,v,b){arguments[3]=255;var w=i.default.prototype.color.apply(this._pInst,arguments);this.curStrokeColor=w._array},i.default.RendererGL.prototype.strokeCap=function(g){console.error("Sorry, strokeCap() is not yet implemented in WEBGL mode")},i.default.RendererGL.prototype.strokeJoin=function(g){console.error("Sorry, strokeJoin() is not yet implemented in WEBGL mode")},i.default.RendererGL.prototype.filter=function(g){console.error("filter() does not work in WEBGL mode")},i.default.RendererGL.prototype.blendMode=function(g){g===l.DARKEST||g===l.LIGHTEST||g===l.ADD||g===l.BLEND||g===l.SUBTRACT||g===l.SCREEN||g===l.EXCLUSION||g===l.REPLACE||g===l.MULTIPLY||g===l.REMOVE?this.curBlendMode=g:g!==l.BURN&&g!==l.OVERLAY&&g!==l.HARD_LIGHT&&g!==l.SOFT_LIGHT&&g!==l.DODGE||console.warn("BURN, OVERLAY, HARD_LIGHT, SOFT_LIGHT, and DODGE only work for blendMode in 2D mode.")},i.default.RendererGL.prototype.erase=function(g,y){this._isErasing||(this._applyBlendMode(l.REMOVE),this._isErasing=!0,this._cachedFillStyle=this.curFillColor.slice(),this.curFillColor=[1,1,1,g/255],this._cachedStrokeStyle=this.curStrokeColor.slice(),this.curStrokeColor=[1,1,1,y/255])},i.default.RendererGL.prototype.noErase=function(){this._isErasing&&(this._isErasing=!1,this.curFillColor=this._cachedFillStyle.slice(),this.curStrokeColor=this._cachedStrokeStyle.slice(),this.blendMode(this._cachedBlendMode))},i.default.RendererGL.prototype.strokeWeight=function(g){this.curStrokeWeight!==g&&(this.pointSize=g,this.curStrokeWeight=g)},i.default.RendererGL.prototype._getPixel=function(g,y){var v;return v=new Uint8Array(4),this.drawingContext.readPixels(g,y,1,1,this.drawingContext.RGBA,this.drawingContext.UNSIGNED_BYTE,v),[v[0],v[1],v[2],v[3]]},i.default.RendererGL.prototype.loadPixels=function(){var g=this._pixelsState;if(this._pInst._glAttributes.preserveDrawingBuffer===!0){var y=g.pixels,v=this.GL.drawingBufferWidth*this.GL.drawingBufferHeight*4;y instanceof Uint8Array&&y.length===v||(y=new Uint8Array(v),this._pixelsState._setProperty("pixels",y));var b=this._pInst._pixelDensity;this.GL.readPixels(0,0,this.width*b,this.height*b,this.GL.RGBA,this.GL.UNSIGNED_BYTE,y)}else console.log("loadPixels only works in WebGL when preserveDrawingBuffer is true.")},i.default.RendererGL.prototype.geometryInHash=function(g){return this.retainedMode.geometry[g]!==void 0},i.default.RendererGL.prototype.resize=function(g,y){i.default.Renderer.prototype.resize.call(this,g,y),this.GL.viewport(0,0,this.GL.drawingBufferWidth,this.GL.drawingBufferHeight),this._viewport=this.GL.getParameter(this.GL.VIEWPORT),this._curCamera._resize();var v=this._pixelsState;v.pixels!==void 0&&v._setProperty("pixels",new Uint8Array(this.GL.drawingBufferWidth*this.GL.drawingBufferHeight*4))},i.default.RendererGL.prototype.clear=function(){var g=(arguments.length<=0?void 0:arguments[0])||0,y=(arguments.length<=1?void 0:arguments[1])||0,v=(arguments.length<=2?void 0:arguments[2])||0,b=(arguments.length<=3?void 0:arguments[3])||0;this.GL.clearColor(g,y,v,b),this.GL.clearDepth(1),this.GL.clear(this.GL.COLOR_BUFFER_BIT|this.GL.DEPTH_BUFFER_BIT)},i.default.RendererGL.prototype.applyMatrix=function(g,y,v,b,w,_){arguments.length===16?i.default.Matrix.prototype.apply.apply(this.uMVMatrix,arguments):this.uMVMatrix.apply([g,y,0,0,v,b,0,0,0,0,1,0,w,_,0,1])},i.default.RendererGL.prototype.translate=function(g,y,v){return g instanceof i.default.Vector&&(v=g.z,y=g.y,g=g.x),this.uMVMatrix.translate([g,y,v]),this},i.default.RendererGL.prototype.scale=function(g,y,v){return this.uMVMatrix.scale(g,y,v),this},i.default.RendererGL.prototype.rotate=function(g,y){return y===void 0?this.rotateZ(g):(i.default.Matrix.prototype.rotate.apply(this.uMVMatrix,arguments),this)},i.default.RendererGL.prototype.rotateX=function(g){return this.rotate(g,1,0,0),this},i.default.RendererGL.prototype.rotateY=function(g){return this.rotate(g,0,1,0),this},i.default.RendererGL.prototype.rotateZ=function(g){return this.rotate(g,0,0,1),this},i.default.RendererGL.prototype.push=function(){var g=i.default.Renderer.prototype.push.apply(this),y=g.properties;return y.uMVMatrix=this.uMVMatrix.copy(),y.uPMatrix=this.uPMatrix.copy(),y._curCamera=this._curCamera,this._curCamera=this._curCamera.copy(),y.ambientLightColors=this.ambientLightColors.slice(),y.specularColors=this.specularColors.slice(),y.directionalLightDirections=this.directionalLightDirections.slice(),y.directionalLightDiffuseColors=this.directionalLightDiffuseColors.slice(),y.directionalLightSpecularColors=this.directionalLightSpecularColors.slice(),y.pointLightPositions=this.pointLightPositions.slice(),y.pointLightDiffuseColors=this.pointLightDiffuseColors.slice(),y.pointLightSpecularColors=this.pointLightSpecularColors.slice(),y.spotLightPositions=this.spotLightPositions.slice(),y.spotLightDirections=this.spotLightDirections.slice(),y.spotLightDiffuseColors=this.spotLightDiffuseColors.slice(),y.spotLightSpecularColors=this.spotLightSpecularColors.slice(),y.spotLightAngle=this.spotLightAngle.slice(),y.spotLightConc=this.spotLightConc.slice(),y.userFillShader=this.userFillShader,y.userStrokeShader=this.userStrokeShader,y.userPointShader=this.userPointShader,y.pointSize=this.pointSize,y.curStrokeWeight=this.curStrokeWeight,y.curStrokeColor=this.curStrokeColor,y.curFillColor=this.curFillColor,y._useSpecularMaterial=this._useSpecularMaterial,y._useEmissiveMaterial=this._useEmissiveMaterial,y._useShininess=this._useShininess,y.constantAttenuation=this.constantAttenuation,y.linearAttenuation=this.linearAttenuation,y.quadraticAttenuation=this.quadraticAttenuation,y._enableLighting=this._enableLighting,y._useNormalMaterial=this._useNormalMaterial,y._tex=this._tex,y.drawMode=this.drawMode,y._currentNormal=this._currentNormal,g},i.default.RendererGL.prototype.resetMatrix=function(){return this.uMVMatrix=i.default.Matrix.identity(this._pInst),this},i.default.RendererGL.prototype._getImmediateStrokeShader=function(){var g=this.userStrokeShader;return g&&g.isStrokeShader()?g:this._getLineShader()},i.default.RendererGL.prototype._getRetainedStrokeShader=i.default.RendererGL.prototype._getImmediateStrokeShader,i.default.RendererGL.prototype._getImmediateFillShader=function(){var g=this.userFillShader;if(this._useNormalMaterial&&(!g||!g.isNormalShader()))return this._getNormalShader();if(this._enableLighting){if(!g||!g.isLightShader())return this._getLightShader()}else if(this._tex){if(!g||!g.isTextureShader())return this._getLightShader()}else if(!g)return this._getImmediateModeShader();return g},i.default.RendererGL.prototype._getRetainedFillShader=function(){if(this._useNormalMaterial)return this._getNormalShader();var g=this.userFillShader;if(this._enableLighting){if(!g||!g.isLightShader())return this._getLightShader()}else if(this._tex){if(!g||!g.isTextureShader())return this._getLightShader()}else if(!g)return this._getColorShader();return g},i.default.RendererGL.prototype._getImmediatePointShader=function(){var g=this.userPointShader;return g&&g.isPointShader()?g:this._getPointShader()},i.default.RendererGL.prototype._getRetainedLineShader=i.default.RendererGL.prototype._getImmediateLineShader,i.default.RendererGL.prototype._getLightShader=function(){return this._defaultLightShader||(this._pInst._glAttributes.perPixelLighting?this._defaultLightShader=new i.default.Shader(this,p.phongVert,p.phongFrag):this._defaultLightShader=new i.default.Shader(this,p.lightVert,p.lightTextureFrag)),this._defaultLightShader},i.default.RendererGL.prototype._getImmediateModeShader=function(){return this._defaultImmediateModeShader||(this._defaultImmediateModeShader=new i.default.Shader(this,p.immediateVert,p.vertexColorFrag)),this._defaultImmediateModeShader},i.default.RendererGL.prototype._getNormalShader=function(){return this._defaultNormalShader||(this._defaultNormalShader=new i.default.Shader(this,p.normalVert,p.normalFrag)),this._defaultNormalShader},i.default.RendererGL.prototype._getColorShader=function(){return this._defaultColorShader||(this._defaultColorShader=new i.default.Shader(this,p.normalVert,p.basicFrag)),this._defaultColorShader},i.default.RendererGL.prototype._getPointShader=function(){return this._defaultPointShader||(this._defaultPointShader=new i.default.Shader(this,p.pointVert,p.pointFrag)),this._defaultPointShader},i.default.RendererGL.prototype._getLineShader=function(){return this._defaultLineShader||(this._defaultLineShader=new i.default.Shader(this,p.lineVert,p.lineFrag)),this._defaultLineShader},i.default.RendererGL.prototype._getFontShader=function(){return this._defaultFontShader||(this.GL.getExtension("OES_standard_derivatives"),this._defaultFontShader=new i.default.Shader(this,p.fontVert,p.fontFrag)),this._defaultFontShader},i.default.RendererGL.prototype._getEmptyTexture=function(){if(!this._emptyTexture){var g=new i.default.Image(1,1);g.set(0,0,255),this._emptyTexture=new i.default.Texture(this,g)}return this._emptyTexture},i.default.RendererGL.prototype.getTexture=function(g){var y=this.textures,v=!0,b=!1,w=void 0;try{for(var _,I=y[Symbol.iterator]();!(v=(_=I.next()).done);v=!0){var C=_.value;if(C.src===g)return C}}catch(O){b=!0,w=O}finally{try{v||I.return==null||I.return()}finally{if(b)throw w}}var N=new i.default.Texture(this,g);return y.push(N),N},i.default.RendererGL.prototype._setStrokeUniforms=function(g){g.bindShader(),g.setUniform("uMaterialColor",this.curStrokeColor),g.setUniform("uStrokeWeight",this.curStrokeWeight)},i.default.RendererGL.prototype._setFillUniforms=function(g){g.bindShader(),g.setUniform("uMaterialColor",this.curFillColor),g.setUniform("isTexture",!!this._tex),this._tex&&g.setUniform("uSampler",this._tex),g.setUniform("uTint",this._tint),g.setUniform("uSpecular",this._useSpecularMaterial),g.setUniform("uEmissive",this._useEmissiveMaterial),g.setUniform("uShininess",this._useShininess),g.setUniform("uUseLighting",this._enableLighting);var y=this.pointLightDiffuseColors.length/3;g.setUniform("uPointLightCount",y),g.setUniform("uPointLightLocation",this.pointLightPositions),g.setUniform("uPointLightDiffuseColors",this.pointLightDiffuseColors),g.setUniform("uPointLightSpecularColors",this.pointLightSpecularColors);var v=this.directionalLightDiffuseColors.length/3;g.setUniform("uDirectionalLightCount",v),g.setUniform("uLightingDirection",this.directionalLightDirections),g.setUniform("uDirectionalDiffuseColors",this.directionalLightDiffuseColors),g.setUniform("uDirectionalSpecularColors",this.directionalLightSpecularColors);var b=this.ambientLightColors.length/3;g.setUniform("uAmbientLightCount",b),g.setUniform("uAmbientColor",this.ambientLightColors);var w=this.spotLightDiffuseColors.length/3;g.setUniform("uSpotLightCount",w),g.setUniform("uSpotLightAngle",this.spotLightAngle),g.setUniform("uSpotLightConc",this.spotLightConc),g.setUniform("uSpotLightDiffuseColors",this.spotLightDiffuseColors),g.setUniform("uSpotLightSpecularColors",this.spotLightSpecularColors),g.setUniform("uSpotLightLocation",this.spotLightPositions),g.setUniform("uSpotLightDirection",this.spotLightDirections),g.setUniform("uConstantAttenuation",this.constantAttenuation),g.setUniform("uLinearAttenuation",this.linearAttenuation),g.setUniform("uQuadraticAttenuation",this.quadraticAttenuation),g.bindTextures()},i.default.RendererGL.prototype._setPointUniforms=function(g){g.bindShader(),g.setUniform("uMaterialColor",this.curStrokeColor),g.setUniform("uPointSize",this.pointSize*this._pInst._pixelDensity)},i.default.RendererGL.prototype._bindBuffer=function(g,y,v,b,w){if(y=y||this.GL.ARRAY_BUFFER,this.GL.bindBuffer(y,g),v!==void 0){var _=new(b||Float32Array)(v);this.GL.bufferData(y,_,w||this.GL.STATIC_DRAW)}},i.default.RendererGL.prototype._arraysEqual=function(g,y){var v=g.length;if(v!==y.length)return!1;for(var b=0;b<v;b++)if(g[b]!==y[b])return!1;return!0},i.default.RendererGL.prototype._isTypedArray=function(g){return g instanceof Uint32Array},i.default.RendererGL.prototype._flatten=function(g){if(g.length===0)return[];if(2e4<g.length){var y,v=Object.prototype.toString,b=[],w=g.slice();for(y=w.pop();v.call(y)==="[object Array]"?w.push.apply(w,c(y)):b.push(y),w.length&&(y=w.pop())!==void 0;);return b.reverse(),b}var _;return(_=[]).concat.apply(_,c(g))},i.default.RendererGL.prototype._vToNArray=function(g){var y=[],v=!0,b=!1,w=void 0;try{for(var _,I=g[Symbol.iterator]();!(v=(_=I.next()).done);v=!0){var C=_.value;y.push(C.x,C.y,C.z)}}catch(N){b=!0,w=N}finally{try{v||I.return==null||I.return()}finally{if(b)throw w}}return y},i.default.prototype._assert3d=function(g){if(!this._renderer.isP3D)throw new Error("".concat(g,"() is only supported in WEBGL mode. If you'd like to use 3D graphics and WebGL, see  https://p5js.org/examples/form-3d-primitives.html for more information."))},i.default.RendererGL.prototype._initTessy=function(){var g=new u.default.GluTesselator;return g.gluTessCallback(u.default.gluEnum.GLU_TESS_VERTEX_DATA,function(y,v){v[v.length]=y[0],v[v.length]=y[1],v[v.length]=y[2]}),g.gluTessCallback(u.default.gluEnum.GLU_TESS_BEGIN,function(y){y!==u.default.primitiveType.GL_TRIANGLES&&console.log("expected TRIANGLES but got type: ".concat(y))}),g.gluTessCallback(u.default.gluEnum.GLU_TESS_ERROR,function(y){console.log("error callback"),console.log("error number: ".concat(y))}),g.gluTessCallback(u.default.gluEnum.GLU_TESS_COMBINE,function(y,v,b){return[y[0],y[1],y[2]]}),g.gluTessCallback(u.default.gluEnum.GLU_TESS_EDGE_FLAG,function(y){}),g},i.default.RendererGL.prototype._triangulate=function(g){this._tessy.gluTessNormal(0,0,1);var y=[];this._tessy.gluTessBeginPolygon(y);for(var v=0;v<g.length;v++){this._tessy.gluTessBeginContour();for(var b=g[v],w=0;w<b.length;w+=3){var _=[b[w],b[w+1],b[w+2]];this._tessy.gluTessVertex(_,_)}this._tessy.gluTessEndContour()}return this._tessy.gluTessEndPolygon(),y},i.default.RendererGL.prototype._bezierCoefficients=function(g){var y=g*g,v=1-g,b=v*v;return[b*v,3*b*g,3*v*y,y*g]},i.default.RendererGL.prototype._quadraticCoefficients=function(g){var y=1-g;return[y*y,2*y*g,g*g]},i.default.RendererGL.prototype._bezierToCatmull=function(g){return[g[1],g[1]+(g[2]-g[0])/this._curveTightness,g[2]-(g[3]-g[1])/this._curveTightness,g[2]]};var m=i.default.RendererGL;o.default=m},{"../core/constants":253,"../core/main":264,"../core/p5.Renderer":267,"./p5.Camera":312,"./p5.Matrix":314,"./p5.Shader":319,"core-js/modules/es.array.concat":149,"core-js/modules/es.array.fill":151,"core-js/modules/es.array.filter":152,"core-js/modules/es.array.from":155,"core-js/modules/es.array.includes":156,"core-js/modules/es.array.iterator":158,"core-js/modules/es.array.slice":162,"core-js/modules/es.object.assign":173,"core-js/modules/es.object.to-string":177,"core-js/modules/es.regexp.to-string":182,"core-js/modules/es.string.includes":185,"core-js/modules/es.string.iterator":186,"core-js/modules/es.symbol":196,"core-js/modules/es.symbol.description":194,"core-js/modules/es.symbol.iterator":195,"core-js/modules/es.typed-array.copy-within":197,"core-js/modules/es.typed-array.every":198,"core-js/modules/es.typed-array.fill":199,"core-js/modules/es.typed-array.filter":200,"core-js/modules/es.typed-array.find":202,"core-js/modules/es.typed-array.find-index":201,"core-js/modules/es.typed-array.float32-array":203,"core-js/modules/es.typed-array.float64-array":204,"core-js/modules/es.typed-array.for-each":205,"core-js/modules/es.typed-array.includes":206,"core-js/modules/es.typed-array.index-of":207,"core-js/modules/es.typed-array.int16-array":208,"core-js/modules/es.typed-array.iterator":210,"core-js/modules/es.typed-array.join":211,"core-js/modules/es.typed-array.last-index-of":212,"core-js/modules/es.typed-array.map":213,"core-js/modules/es.typed-array.reduce":215,"core-js/modules/es.typed-array.reduce-right":214,"core-js/modules/es.typed-array.reverse":216,"core-js/modules/es.typed-array.set":217,"core-js/modules/es.typed-array.slice":218,"core-js/modules/es.typed-array.some":219,"core-js/modules/es.typed-array.sort":220,"core-js/modules/es.typed-array.subarray":221,"core-js/modules/es.typed-array.to-locale-string":222,"core-js/modules/es.typed-array.to-string":223,"core-js/modules/es.typed-array.uint16-array":224,"core-js/modules/es.typed-array.uint32-array":225,"core-js/modules/es.typed-array.uint8-array":226,"core-js/modules/web.dom-collections.iterator":229,libtess:237,path:240}],319:[function(n,s,o){n("core-js/modules/es.symbol"),n("core-js/modules/es.symbol.description"),n("core-js/modules/es.symbol.iterator"),n("core-js/modules/es.array.index-of"),n("core-js/modules/es.array.iterator"),n("core-js/modules/es.array.slice"),n("core-js/modules/es.function.name"),n("core-js/modules/es.object.to-string"),n("core-js/modules/es.string.iterator"),n("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var a,i=(a=n("../core/main"))&&a.__esModule?a:{default:a};i.default.Shader=function(u,h,d){this._renderer=u,this._vertSrc=h,this._fragSrc=d,this._vertShader=-1,this._fragShader=-1,this._glProgram=0,this._loadedAttributes=!1,this.attributes={},this._loadedUniforms=!1,this.uniforms={},this._bound=!1,this.samplers=[]},i.default.Shader.prototype.init=function(){if(this._glProgram===0){var u=this._renderer.GL;if(this._vertShader=u.createShader(u.VERTEX_SHADER),u.shaderSource(this._vertShader,this._vertSrc),u.compileShader(this._vertShader),!u.getShaderParameter(this._vertShader,u.COMPILE_STATUS))return console.error("Yikes! An error occurred compiling the vertex shader:".concat(u.getShaderInfoLog(this._vertShader))),null;if(this._fragShader=u.createShader(u.FRAGMENT_SHADER),u.shaderSource(this._fragShader,this._fragSrc),u.compileShader(this._fragShader),!u.getShaderParameter(this._fragShader,u.COMPILE_STATUS))return console.error("Darn! An error occurred compiling the fragment shader:".concat(u.getShaderInfoLog(this._fragShader))),null;this._glProgram=u.createProgram(),u.attachShader(this._glProgram,this._vertShader),u.attachShader(this._glProgram,this._fragShader),u.linkProgram(this._glProgram),u.getProgramParameter(this._glProgram,u.LINK_STATUS)||console.error("Snap! Error linking shader program: ".concat(u.getProgramInfoLog(this._glProgram))),this._loadAttributes(),this._loadUniforms()}return this},i.default.Shader.prototype._loadAttributes=function(){if(!this._loadedAttributes){this.attributes={};for(var u=this._renderer.GL,h=u.getProgramParameter(this._glProgram,u.ACTIVE_ATTRIBUTES),d=0;d<h;++d){var c=u.getActiveAttrib(this._glProgram,d),f=c.name,p=u.getAttribLocation(this._glProgram,f),m={};m.name=f,m.location=p,m.index=d,m.type=c.type,m.size=c.size,this.attributes[f]=m}this._loadedAttributes=!0}},i.default.Shader.prototype._loadUniforms=function(){if(!this._loadedUniforms){for(var u=this._renderer.GL,h=u.getProgramParameter(this._glProgram,u.ACTIVE_UNIFORMS),d=0,c=0;c<h;++c){var f=u.getActiveUniform(this._glProgram,c),p={};p.location=u.getUniformLocation(this._glProgram,f.name),p.size=f.size;var m=f.name;1<f.size&&(m=m.substring(0,m.indexOf("[0]"))),p.name=m,p.type=f.type,p._cachedData=void 0,p.type===u.SAMPLER_2D&&(p.samplerIndex=d,d++,this.samplers.push(p)),p.isArray=1<f.size||p.type===u.FLOAT_MAT3||p.type===u.FLOAT_MAT4||p.type===u.FLOAT_VEC2||p.type===u.FLOAT_VEC3||p.type===u.FLOAT_VEC4||p.type===u.INT_VEC2||p.type===u.INT_VEC4||p.type===u.INT_VEC3,this.uniforms[m]=p}this._loadedUniforms=!0}},i.default.Shader.prototype.compile=function(){},i.default.Shader.prototype.bindShader=function(){this.init(),this._bound||(this.useProgram(),this._bound=!0,this._setMatrixUniforms(),this.setUniform("uViewport",this._renderer._viewport))},i.default.Shader.prototype.unbindShader=function(){return this._bound&&(this.unbindTextures(),this._bound=!1),this},i.default.Shader.prototype.bindTextures=function(){var u=this._renderer.GL,h=!0,d=!1,c=void 0;try{for(var f,p=this.samplers[Symbol.iterator]();!(h=(f=p.next()).done);h=!0){var m=f.value,g=m.texture;g===void 0&&(g=this._renderer._getEmptyTexture()),u.activeTexture(u.TEXTURE0+m.samplerIndex),g.bindTexture(),g.update(),u.uniform1i(m.location,m.samplerIndex)}}catch(y){d=!0,c=y}finally{try{h||p.return==null||p.return()}finally{if(d)throw c}}},i.default.Shader.prototype.updateTextures=function(){var u=!0,h=!1,d=void 0;try{for(var c,f=this.samplers[Symbol.iterator]();!(u=(c=f.next()).done);u=!0){var p=c.value.texture;p&&p.update()}}catch(m){h=!0,d=m}finally{try{u||f.return==null||f.return()}finally{if(h)throw d}}},i.default.Shader.prototype.unbindTextures=function(){},i.default.Shader.prototype._setMatrixUniforms=function(){var u=this._renderer._curCamera.cameraMatrix,h=this._renderer.uPMatrix,d=this._renderer.uMVMatrix,c=d.copy();c.mult(h),this.isStrokeShader()&&(this._renderer._curCamera.cameraType==="default"?this.setUniform("uPerspective",1):this.setUniform("uPerspective",0)),this.setUniform("uViewMatrix",u.mat4),this.setUniform("uProjectionMatrix",h.mat4),this.setUniform("uModelViewMatrix",d.mat4),this.setUniform("uModelViewProjectionMatrix",c.mat4),this.uniforms.uNormalMatrix&&(this._renderer.uNMatrix.inverseTranspose(this._renderer.uMVMatrix),this.setUniform("uNormalMatrix",this._renderer.uNMatrix.mat3))},i.default.Shader.prototype.useProgram=function(){var u=this._renderer.GL;return this._renderer._curShader!==this&&(u.useProgram(this._glProgram),this._renderer._curShader=this),this},i.default.Shader.prototype.setUniform=function(u,h){var d=this.uniforms[u];if(d){var c=this._renderer.GL;if(d.isArray){if(d._cachedData&&this._renderer._arraysEqual(d._cachedData,h))return;d._cachedData=h.slice(0)}else{if(d._cachedData&&d._cachedData===h)return;Array.isArray(h)?d._cachedData=h.slice(0):d._cachedData=h}var f=d.location;switch(this.useProgram(),d.type){case c.BOOL:h===!0?c.uniform1i(f,1):c.uniform1i(f,0);break;case c.INT:1<d.size?h.length&&c.uniform1iv(f,h):c.uniform1i(f,h);break;case c.FLOAT:1<d.size?h.length&&c.uniform1fv(f,h):c.uniform1f(f,h);break;case c.FLOAT_MAT3:c.uniformMatrix3fv(f,!1,h);break;case c.FLOAT_MAT4:c.uniformMatrix4fv(f,!1,h);break;case c.FLOAT_VEC2:1<d.size?h.length&&c.uniform2fv(f,h):c.uniform2f(f,h[0],h[1]);break;case c.FLOAT_VEC3:1<d.size?h.length&&c.uniform3fv(f,h):c.uniform3f(f,h[0],h[1],h[2]);break;case c.FLOAT_VEC4:1<d.size?h.length&&c.uniform4fv(f,h):c.uniform4f(f,h[0],h[1],h[2],h[3]);break;case c.INT_VEC2:1<d.size?h.length&&c.uniform2iv(f,h):c.uniform2i(f,h[0],h[1]);break;case c.INT_VEC3:1<d.size?h.length&&c.uniform3iv(f,h):c.uniform3i(f,h[0],h[1],h[2]);break;case c.INT_VEC4:1<d.size?h.length&&c.uniform4iv(f,h):c.uniform4i(f,h[0],h[1],h[2],h[3]);break;case c.SAMPLER_2D:c.activeTexture(c.TEXTURE0+d.samplerIndex),d.texture=h instanceof i.default.Texture?h:this._renderer.getTexture(h),c.uniform1i(f,d.samplerIndex)}return this}},i.default.Shader.prototype.isLightShader=function(){return this.attributes.aNormal!==void 0||this.uniforms.uUseLighting!==void 0||this.uniforms.uAmbientLightCount!==void 0||this.uniforms.uDirectionalLightCount!==void 0||this.uniforms.uPointLightCount!==void 0||this.uniforms.uAmbientColor!==void 0||this.uniforms.uDirectionalDiffuseColors!==void 0||this.uniforms.uDirectionalSpecularColors!==void 0||this.uniforms.uPointLightLocation!==void 0||this.uniforms.uPointLightDiffuseColors!==void 0||this.uniforms.uPointLightSpecularColors!==void 0||this.uniforms.uLightingDirection!==void 0||this.uniforms.uSpecular!==void 0},i.default.Shader.prototype.isNormalShader=function(){return this.attributes.aNormal!==void 0},i.default.Shader.prototype.isTextureShader=function(){return 0<this.samplers.length},i.default.Shader.prototype.isColorShader=function(){return this.attributes.aVertexColor!==void 0||this.uniforms.uMaterialColor!==void 0},i.default.Shader.prototype.isTexLightShader=function(){return this.isLightShader()&&this.isTextureShader()},i.default.Shader.prototype.isStrokeShader=function(){return this.uniforms.uStrokeWeight!==void 0},i.default.Shader.prototype.enableAttrib=function(u,h,d,c,f,p){if(u){var m=u.location;if(m!==-1){var g=this._renderer.GL;u.enabled||(g.enableVertexAttribArray(m),u.enabled=!0),this._renderer.GL.vertexAttribPointer(m,h,d||g.FLOAT,c||!1,f||0,p||0)}}return this};var l=i.default.Shader;o.default=l},{"../core/main":264,"core-js/modules/es.array.index-of":157,"core-js/modules/es.array.iterator":158,"core-js/modules/es.array.slice":162,"core-js/modules/es.function.name":166,"core-js/modules/es.object.to-string":177,"core-js/modules/es.string.iterator":186,"core-js/modules/es.symbol":196,"core-js/modules/es.symbol.description":194,"core-js/modules/es.symbol.iterator":195,"core-js/modules/web.dom-collections.iterator":229}],320:[function(n,s,o){function a(c){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(f){return typeof f}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f})(c)}n("core-js/modules/es.array.iterator"),n("core-js/modules/es.object.to-string"),n("core-js/modules/es.typed-array.uint8-array"),n("core-js/modules/es.typed-array.copy-within"),n("core-js/modules/es.typed-array.every"),n("core-js/modules/es.typed-array.fill"),n("core-js/modules/es.typed-array.filter"),n("core-js/modules/es.typed-array.find"),n("core-js/modules/es.typed-array.find-index"),n("core-js/modules/es.typed-array.for-each"),n("core-js/modules/es.typed-array.includes"),n("core-js/modules/es.typed-array.index-of"),n("core-js/modules/es.typed-array.iterator"),n("core-js/modules/es.typed-array.join"),n("core-js/modules/es.typed-array.last-index-of"),n("core-js/modules/es.typed-array.map"),n("core-js/modules/es.typed-array.reduce"),n("core-js/modules/es.typed-array.reduce-right"),n("core-js/modules/es.typed-array.reverse"),n("core-js/modules/es.typed-array.set"),n("core-js/modules/es.typed-array.slice"),n("core-js/modules/es.typed-array.some"),n("core-js/modules/es.typed-array.sort"),n("core-js/modules/es.typed-array.subarray"),n("core-js/modules/es.typed-array.to-locale-string"),n("core-js/modules/es.typed-array.to-string"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var i,l=(i=n("../core/main"))&&i.__esModule?i:{default:i},u=function(c){if(c&&c.__esModule)return c;if(c===null||a(c)!=="object"&&typeof c!="function")return{default:c};var f=h();if(f&&f.has(c))return f.get(c);var p={},m=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var g in c)if(Object.prototype.hasOwnProperty.call(c,g)){var y=m?Object.getOwnPropertyDescriptor(c,g):null;y&&(y.get||y.set)?Object.defineProperty(p,g,y):p[g]=c[g]}return p.default=c,f&&f.set(c,p),p}(n("../core/constants"));function h(){if(typeof WeakMap!="function")return null;var c=new WeakMap;return h=function(){return c},c}l.default.Texture=function(c,f,p){this._renderer=c;var m=this._renderer.GL;(p=p||{}).dataType===m.FLOAT&&(m.getExtension("OES_texture_float")||console.log("Oh no, your device doesn't support floating point textures!"),m.getExtension("OES_texture_float_linear")||console.log("Ack! Your device doesn't support linear filtering for floating point textures")),this.src=f,this.glTex=void 0,this.glTarget=m.TEXTURE_2D,this.glFormat=p.format||m.RGBA,this.mipmaps=!1,this.glMinFilter=p.minFilter||m.LINEAR,this.glMagFilter=p.magFilter||m.LINEAR,this.glWrapS=p.wrapS||m.CLAMP_TO_EDGE,this.glWrapT=p.wrapT||m.CLAMP_TO_EDGE,this.glDataType=p.dataType||m.UNSIGNED_BYTE,this.isSrcMediaElement=l.default.MediaElement!==void 0&&f instanceof l.default.MediaElement,this._videoPrevUpdateTime=0,this.isSrcHTMLElement=l.default.Element!==void 0&&f instanceof l.default.Element&&!(f instanceof l.default.Graphics),this.isSrcP5Image=f instanceof l.default.Image,this.isSrcP5Graphics=f instanceof l.default.Graphics,this.isImageData=typeof ImageData!="undefined"&&f instanceof ImageData;var g=this._getTextureDataFromSource();return this.width=g.width,this.height=g.height,this.init(g),this},l.default.Texture.prototype._getTextureDataFromSource=function(){var c;return this.isSrcP5Image?c=this.src.canvas:this.isSrcMediaElement||this.isSrcP5Graphics||this.isSrcHTMLElement?c=this.src.elt:this.isImageData&&(c=this.src),c},l.default.Texture.prototype.init=function(c){var f=this._renderer.GL;if(this.glTex=f.createTexture(),this.glWrapS=this._renderer.textureWrapX,this.glWrapT=this._renderer.textureWrapY,this.setWrapMode(this.glWrapS,this.glWrapT),this.bindTexture(),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,this.glMagFilter),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,this.glMinFilter),this.width===0||this.height===0||this.isSrcMediaElement&&!this.src.loadedmetadata){var p=new Uint8Array([1,1,1,1]);f.texImage2D(this.glTarget,0,f.RGBA,1,1,0,this.glFormat,this.glDataType,p)}else f.texImage2D(this.glTarget,0,this.glFormat,this.glFormat,this.glDataType,c)},l.default.Texture.prototype.update=function(){var c=this.src;if(c.width===0||c.height===0)return!1;var f=this._getTextureDataFromSource(),p=!1,m=this._renderer.GL;return f.width!==this.width||f.height!==this.height?(p=!0,this.width=f.width,this.height=f.height,this.isSrcP5Image?c.setModified(!1):(this.isSrcMediaElement||this.isSrcHTMLElement)&&c.setModified(!0)):this.isSrcP5Image?c.isModified()&&(p=!0,c.setModified(!1)):this.isSrcMediaElement?c.isModified()?(p=!0,c.setModified(!1)):c.loadedmetadata&&this._videoPrevUpdateTime!==c.time()&&(this._videoPrevUpdateTime=c.time(),p=!0):this.isImageData?c._dirty&&(p=!(c._dirty=!1)):p=!0,p&&(this.bindTexture(),m.texImage2D(this.glTarget,0,this.glFormat,this.glFormat,this.glDataType,f)),p},l.default.Texture.prototype.bindTexture=function(){return this._renderer.GL.bindTexture(this.glTarget,this.glTex),this},l.default.Texture.prototype.unbindTexture=function(){this._renderer.GL.bindTexture(this.glTarget,null)},l.default.Texture.prototype.setInterpolation=function(c,f){var p=this._renderer.GL;c===u.NEAREST?this.glMinFilter=p.NEAREST:this.glMinFilter=p.LINEAR,f===u.NEAREST?this.glMagFilter=p.NEAREST:this.glMagFilter=p.LINEAR,this.bindTexture(),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,this.glMinFilter),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,this.glMagFilter),this.unbindTexture()},l.default.Texture.prototype.setWrapMode=function(c,f){function p(v){return(v&v-1)==0}var m=this._renderer.GL,g=p(this.width),y=p(this.height);c===u.REPEAT?g&&y?this.glWrapS=m.REPEAT:(console.warn("You tried to set the wrap mode to REPEAT but the texture size is not a power of two. Setting to CLAMP instead"),this.glWrapS=m.CLAMP_TO_EDGE):c===u.MIRROR?g&&y?this.glWrapS=m.MIRRORED_REPEAT:(console.warn("You tried to set the wrap mode to MIRROR but the texture size is not a power of two. Setting to CLAMP instead"),this.glWrapS=m.CLAMP_TO_EDGE):this.glWrapS=m.CLAMP_TO_EDGE,f===u.REPEAT?g&&y?this.glWrapT=m.REPEAT:(console.warn("You tried to set the wrap mode to REPEAT but the texture size is not a power of two. Setting to CLAMP instead"),this.glWrapT=m.CLAMP_TO_EDGE):f===u.MIRROR?g&&y?this.glWrapT=m.MIRRORED_REPEAT:(console.warn("You tried to set the wrap mode to MIRROR but the texture size is not a power of two. Setting to CLAMP instead"),this.glWrapT=m.CLAMP_TO_EDGE):this.glWrapT=m.CLAMP_TO_EDGE,this.bindTexture(),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,this.glWrapS),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,this.glWrapT),this.unbindTexture()};var d=l.default.Texture;o.default=d},{"../core/constants":253,"../core/main":264,"core-js/modules/es.array.iterator":158,"core-js/modules/es.object.to-string":177,"core-js/modules/es.typed-array.copy-within":197,"core-js/modules/es.typed-array.every":198,"core-js/modules/es.typed-array.fill":199,"core-js/modules/es.typed-array.filter":200,"core-js/modules/es.typed-array.find":202,"core-js/modules/es.typed-array.find-index":201,"core-js/modules/es.typed-array.for-each":205,"core-js/modules/es.typed-array.includes":206,"core-js/modules/es.typed-array.index-of":207,"core-js/modules/es.typed-array.iterator":210,"core-js/modules/es.typed-array.join":211,"core-js/modules/es.typed-array.last-index-of":212,"core-js/modules/es.typed-array.map":213,"core-js/modules/es.typed-array.reduce":215,"core-js/modules/es.typed-array.reduce-right":214,"core-js/modules/es.typed-array.reverse":216,"core-js/modules/es.typed-array.set":217,"core-js/modules/es.typed-array.slice":218,"core-js/modules/es.typed-array.some":219,"core-js/modules/es.typed-array.sort":220,"core-js/modules/es.typed-array.subarray":221,"core-js/modules/es.typed-array.to-locale-string":222,"core-js/modules/es.typed-array.to-string":223,"core-js/modules/es.typed-array.uint8-array":226}],321:[function(n,s,o){function a(m){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(g){return typeof g}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g})(m)}n("core-js/modules/es.symbol"),n("core-js/modules/es.symbol.description"),n("core-js/modules/es.symbol.iterator"),n("core-js/modules/es.array.iterator"),n("core-js/modules/es.object.to-string"),n("core-js/modules/es.regexp.exec"),n("core-js/modules/es.string.iterator"),n("core-js/modules/es.string.split"),n("core-js/modules/es.string.sub"),n("core-js/modules/web.dom-collections.iterator");var i,l=(i=n("../core/main"))&&i.__esModule?i:{default:i},u=function(m){if(m&&m.__esModule)return m;if(m===null||a(m)!=="object"&&typeof m!="function")return{default:m};var g=h();if(g&&g.has(m))return g.get(m);var y={},v=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var b in m)if(Object.prototype.hasOwnProperty.call(m,b)){var w=v?Object.getOwnPropertyDescriptor(m,b):null;w&&(w.get||w.set)?Object.defineProperty(y,b,w):y[b]=m[b]}return y.default=m,g&&g.set(m,y),y}(n("../core/constants"));function h(){if(typeof WeakMap!="function")return null;var m=new WeakMap;return h=function(){return m},m}n("./p5.Shader"),n("./p5.RendererGL.Retained"),l.default.RendererGL.prototype._applyTextProperties=function(){},l.default.RendererGL.prototype.textWidth=function(m){return this._isOpenType()?this._textFont._textWidth(m,this._textSize):0};function d(m,g){this.width=m,this.height=g,this.infos=[],this.findImage=function(y){var v,b,w=this.width*this.height;if(w<y)throw new Error("font is too complex to render in 3D");for(var _=this.infos.length-1;0<=_;--_){var I=this.infos[_];if(I.index+y<w){b=(v=I).imageData;break}}if(!v){try{b=new ImageData(this.width,this.height)}catch{var C=document.getElementsByTagName("canvas")[0],N=!C;C||((C=document.createElement("canvas")).style.display="none",document.body.appendChild(C));var O=C.getContext("2d");O&&(b=O.createImageData(this.width,this.height)),N&&document.body.removeChild(C)}v={index:0,imageData:b},this.infos.push(v)}var D=v.index;return v.index+=y,b._dirty=!0,{imageData:b,index:D}}}function c(m,g,y,v,b){var w=m.imageData.data,_=4*m.index++;w[_++]=g,w[_++]=y,w[_++]=v,w[_++]=b}function f(m){this.font=m,this.strokeImageInfos=new d(64,64),this.colDimImageInfos=new d(64,64),this.rowDimImageInfos=new d(64,64),this.colCellImageInfos=new d(64,64),this.rowCellImageInfos=new d(64,64),this.glyphInfos={},this.getGlyphInfo=function(g){var y=this.glyphInfos[g.index];if(y)return y;var v,b=g.getBoundingBox(),w=b.x1,_=b.y1,I=b.x2-w,C=b.y2-_,N=g.path.commands;if(I==0||C==0||!N.length)return this.glyphInfos[g.index]={};var O,D,M,P,F=[],B=[],z=[];for(v=8;0<=v;--v)z.push([]);for(v=8;0<=v;--v)B.push([]);function Z(Je,xt,Pt){var Dt=F.length;function St(le,ee,ue){for(var Ae=le.length;0<Ae--;){var Ke=le[Ae];Ke<ee&&(ee=Ke),ue<Ke&&(ue=Ke)}return{min:ee,max:ue}}F.push(Pt);for(var Jt=St(Je,1,0),ht=Math.max(Math.floor(9*Jt.min),0),ct=Math.min(Math.ceil(9*Jt.max),9),At=ht;At<ct;++At)z[At].push(Dt);for(var Ft=St(xt,1,0),Be=Math.max(Math.floor(9*Ft.min),0),qt=Math.min(Math.ceil(9*Ft.max),9),Y=Be;Y<qt;++Y)B[Y].push(Dt)}function Q(Je){return(xt=(Dt=255)*Je)<(Pt=0)?Pt:Dt<xt?Dt:xt;var xt,Pt,Dt}function K(Je,xt,Pt,Dt){this.p0=Je,this.c0=xt,this.c1=Pt,this.p1=Dt,this.toQuadratic=function(){return{x:this.p0.x,y:this.p0.y,x1:this.p1.x,y1:this.p1.y,cx:(3*(this.c0.x+this.c1.x)-(this.p0.x+this.p1.x))/4,cy:(3*(this.c0.y+this.c1.y)-(this.p0.y+this.p1.y))/4}},this.quadError=function(){return l.default.Vector.sub(l.default.Vector.sub(this.p1,this.p0),l.default.Vector.mult(l.default.Vector.sub(this.c1,this.c0),3)).mag()/2},this.split=function(St){var Jt=l.default.Vector.lerp(this.p0,this.c0,St),ht=l.default.Vector.lerp(this.c0,this.c1,St),ct=l.default.Vector.lerp(Jt,ht,St);this.c1=l.default.Vector.lerp(this.c1,this.p1,St),this.c0=l.default.Vector.lerp(ht,this.c1,St);var At=l.default.Vector.lerp(ct,this.c0,St),Ft=new K(this.p0,Jt,ct,At);return this.p0=At,Ft},this.splitInflections=function(){var St=l.default.Vector.sub(this.c0,this.p0),Jt=l.default.Vector.sub(l.default.Vector.sub(this.c1,this.c0),St),ht=l.default.Vector.sub(l.default.Vector.sub(l.default.Vector.sub(this.p1,this.c1),St),l.default.Vector.mult(Jt,2)),ct=[],At=Jt.x*ht.y-Jt.y*ht.x;if(At!==0){var Ft=St.x*ht.y-St.y*ht.x,Be=St.x*Jt.y-St.y*Jt.x,qt=Ft*Ft-4*At*Be;if(0<=qt){At<0&&(At=-At,Ft=-Ft,Be=-Be);var Y=Math.sqrt(qt),le=(-Ft-Y)/(2*At),ee=(-Ft+Y)/(2*At);0<le&&le<1&&(ct.push(this.split(le)),ee=1-(1-ee)/(1-le)),0<ee&&ee<1&&ct.push(this.split(ee))}}return ct.push(this),ct}}function ne(Je,xt,Pt,Dt,St,Jt,ht,ct){var At=new K(new l.default.Vector(Je,xt),new l.default.Vector(Pt,Dt),new l.default.Vector(St,Jt),new l.default.Vector(ht,ct)).splitInflections(),Ft=[],Be=30/p,qt=!0,Y=!1,le=void 0;try{for(var ee,ue=At[Symbol.iterator]();!(qt=(ee=ue.next()).done);qt=!0){for(var Ae=ee.value,Ke=[],ot=void 0;!(.125<=(ot=Be/Ae.quadError()));){var vt=Math.pow(ot,.3333333333333333),Pe=Ae.split(vt),Mt=Ae.split(1-vt/(1-vt));Ft.push(Pe),Ke.push(Ae),Ae=Mt}ot<1&&Ft.push(Ae.split(.5)),Ft.push(Ae),Array.prototype.push.apply(Ft,Ke.reverse())}}catch(en){Y=!0,le=en}finally{try{qt||ue.return==null||ue.return()}finally{if(Y)throw le}}return Ft}function re(Je,xt,Pt,Dt){Z([Je,Pt],[xt,Dt],{x:Je,y:xt,cx:(Je+Pt)/2,cy:(xt+Dt)/2})}function ce(Je,xt,Pt,Dt){return Math.abs(Pt-Je)<1e-5&&Math.abs(Dt-xt)<1e-5}var be=!0,we=!1,ye=void 0;try{for(var Oe,Se=N[Symbol.iterator]();!(be=(Oe=Se.next()).done);be=!0){var Ee=Oe.value,j=(Ee.x-w)/I,W=(Ee.y-_)/C;if(!ce(O,D,j,W)){switch(Ee.type){case"M":M=j,P=W;break;case"L":re(O,D,j,W);break;case"Q":var J=(Ee.x1-w)/I,ie=(Ee.y1-_)/C;Z([O,j,J],[D,W,ie],{x:O,y:D,cx:J,cy:ie});break;case"Z":ce(O,D,M,P)?F.push({x:O,y:D}):(re(O,D,M,P),F.push({x:M,y:P}));break;case"C":for(var ve=ne(O,D,(Ee.x1-w)/I,(Ee.y1-_)/C,(Ee.x2-w)/I,(Ee.y2-_)/C,j,W),he=0;he<ve.length;he++){var Fe=ve[he].toQuadratic();Z([Fe.x,Fe.x1,Fe.cx],[Fe.y,Fe.y1,Fe.cy],Fe)}break;default:throw new Error("unknown command type: ".concat(Ee.type))}O=j,D=W}}}catch(Je){we=!0,ye=Je}finally{try{be||Se.return==null||Se.return()}finally{if(we)throw ye}}for(var me=F.length,Le=this.strokeImageInfos.findImage(me),De=Le.index,Ne=0;Ne<me;++Ne){var rt=F[Ne];c(Le,Q(rt.x),Q(rt.y),Q(rt.cx),Q(rt.cy))}function tt(Je,xt,Pt){for(var Dt=Je.length,St=xt.findImage(Dt),Jt=St.index,ht=0,ct=0;ct<Dt;++ct)ht+=Je[ct].length;for(var At=Pt.findImage(ht),Ft=0;Ft<Dt;++Ft){var Be=Je[Ft],qt=Be.length,Y=At.index;c(St,Y>>7,127&Y,qt>>7,127&qt);for(var le=0;le<qt;++le){var ee=Be[le]+De;c(At,ee>>7,127&ee,0,0)}}return{cellImageInfo:At,dimOffset:Jt,dimImageInfo:St}}return(y=this.glyphInfos[g.index]={glyph:g,uGlyphRect:[b.x1,-b.y1,b.x2,-b.y2],strokeImageInfo:Le,strokes:F,colInfo:tt(z,this.colDimImageInfos,this.colCellImageInfos),rowInfo:tt(B,this.rowDimImageInfos,this.rowCellImageInfos)}).uGridOffset=[y.colInfo.dimOffset,y.rowInfo.dimOffset],y}}var p=Math.sqrt(3);l.default.RendererGL.prototype._renderText=function(m,g,y,v,b){if(this._textFont&&typeof this._textFont!="string"){if(!(b<=v)&&this._doFill){if(!this._isOpenType())return console.log("WEBGL: only Opentype (.otf) and Truetype (.ttf) fonts are supported"),m;m.push();var w=this._doStroke,_=this.drawMode;this._doStroke=!1,this.drawMode=u.TEXTURE;var I=this._textFont.font,C=this._textFont._fontInfo;C=C||(this._textFont._fontInfo=new f(I));var N=this._textFont._handleAlignment(this,g,y,v),O=this._textSize/I.unitsPerEm;this.translate(N.x,N.y,0),this.scale(O,O,1);var D=this.GL,M=!this._defaultFontShader,P=this._getFontShader();P.init(),P.bindShader(),M&&(P.setUniform("uGridImageSize",[64,64]),P.setUniform("uCellsImageSize",[64,64]),P.setUniform("uStrokeImageSize",[64,64]),P.setUniform("uGridSize",[9,9])),this._applyColorBlend(this.curFillColor);var F=this.retainedMode.geometry.glyph;if(!F){var B=this._textGeom=new l.default.Geometry(1,1,function(){for(var ve=0;ve<=1;ve++)for(var he=0;he<=1;he++)this.vertices.push(new l.default.Vector(he,ve,0)),this.uvs.push(he,ve)});B.computeFaces().computeNormals(),F=this.createBuffers("glyph",B)}var z=!0,Z=!1,Q=void 0;try{for(var K,ne=this.retainedMode.buffers.text[Symbol.iterator]();!(z=(K=ne.next()).done);z=!0)K.value._prepareBuffer(F,P)}catch(ve){Z=!0,Q=ve}finally{try{z||ne.return==null||ne.return()}finally{if(Z)throw Q}}this._bindBuffer(F.indexBuffer,D.ELEMENT_ARRAY_BUFFER),P.setUniform("uMaterialColor",this.curFillColor);try{var re=0,ce=null,be=I.stringToGlyphs(g),we=!0,ye=!1,Oe=void 0;try{for(var Se,Ee=be[Symbol.iterator]();!(we=(Se=Ee.next()).done);we=!0){var j=Se.value;ce&&(re+=I.getKerningValue(ce,j));var W=C.getGlyphInfo(j);if(W.uGlyphRect){var J=W.rowInfo,ie=W.colInfo;P.setUniform("uSamplerStrokes",W.strokeImageInfo.imageData),P.setUniform("uSamplerRowStrokes",J.cellImageInfo.imageData),P.setUniform("uSamplerRows",J.dimImageInfo.imageData),P.setUniform("uSamplerColStrokes",ie.cellImageInfo.imageData),P.setUniform("uSamplerCols",ie.dimImageInfo.imageData),P.setUniform("uGridOffset",W.uGridOffset),P.setUniform("uGlyphRect",W.uGlyphRect),P.setUniform("uGlyphOffset",re),P.bindTextures(),D.drawElements(D.TRIANGLES,6,this.GL.UNSIGNED_SHORT,0)}re+=j.advanceWidth,ce=j}}catch(ve){ye=!0,Oe=ve}finally{try{we||Ee.return==null||Ee.return()}finally{if(ye)throw Oe}}}finally{P.unbindShader(),this._doStroke=w,this.drawMode=_,m.pop()}return m}}else console.log("WEBGL: you must load and set a font before drawing text. See `loadFont` and `textFont` for more details.")}},{"../core/constants":253,"../core/main":264,"./p5.RendererGL.Retained":317,"./p5.Shader":319,"core-js/modules/es.array.iterator":158,"core-js/modules/es.object.to-string":177,"core-js/modules/es.regexp.exec":181,"core-js/modules/es.string.iterator":186,"core-js/modules/es.string.split":191,"core-js/modules/es.string.sub":192,"core-js/modules/es.symbol":196,"core-js/modules/es.symbol.description":194,"core-js/modules/es.symbol.iterator":195,"core-js/modules/web.dom-collections.iterator":229}]},{},[248])(248)})})(fC);var O6=D6(fC.exports),wf={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */(function(r,e){(function(){var t,n="4.17.21",s=200,o="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",a="Expected a function",i="Invalid `variable` option passed into `_.template`",l="__lodash_hash_undefined__",u=500,h="__lodash_placeholder__",d=1,c=2,f=4,p=1,m=2,g=1,y=2,v=4,b=8,w=16,_=32,I=64,C=128,N=256,O=512,D=30,M="...",P=800,F=16,B=1,z=2,Z=3,Q=1/0,K=9007199254740991,ne=17976931348623157e292,re=0/0,ce=4294967295,be=ce-1,we=ce>>>1,ye=[["ary",C],["bind",g],["bindKey",y],["curry",b],["curryRight",w],["flip",O],["partial",_],["partialRight",I],["rearg",N]],Oe="[object Arguments]",Se="[object Array]",Ee="[object AsyncFunction]",j="[object Boolean]",W="[object Date]",J="[object DOMException]",ie="[object Error]",ve="[object Function]",he="[object GeneratorFunction]",Fe="[object Map]",me="[object Number]",Le="[object Null]",De="[object Object]",Ne="[object Promise]",rt="[object Proxy]",tt="[object RegExp]",Je="[object Set]",xt="[object String]",Pt="[object Symbol]",Dt="[object Undefined]",St="[object WeakMap]",Jt="[object WeakSet]",ht="[object ArrayBuffer]",ct="[object DataView]",At="[object Float32Array]",Ft="[object Float64Array]",Be="[object Int8Array]",qt="[object Int16Array]",Y="[object Int32Array]",le="[object Uint8Array]",ee="[object Uint8ClampedArray]",ue="[object Uint16Array]",Ae="[object Uint32Array]",Ke=/\b__p \+= '';/g,ot=/\b(__p \+=) '' \+/g,vt=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Pe=/&(?:amp|lt|gt|quot|#39);/g,Mt=/[&<>"']/g,en=RegExp(Pe.source),dn=RegExp(Mt.source),mn=/<%-([\s\S]+?)%>/g,hn=/<%([\s\S]+?)%>/g,gn=/<%=([\s\S]+?)%>/g,jn=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ps=/^\w*$/,ms=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Es=/[\\^$.*+?()[\]{}|]/g,Ho=RegExp(Es.source),zr=/^\s+/,js=/\s/,gi=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,cr=/\{\n\/\* \[wrapped with (.+)\] \*/,as=/,? & /,qo=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,wa=/[()=,{}\[\]\/\s]/,ho=/\\(\\)?/g,ko=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Re=/\w*$/,gt=/^[-+]0x[0-9a-f]+$/i,Lt=/^0b[01]+$/i,kt=/^\[object .+?Constructor\]$/,Xt=/^0o[0-7]+$/i,yt=/^(?:0|[1-9]\d*)$/,_n=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,En=/($^)/,Yn=/['\n\r\u2028\u2029\\]/g,Cn="\\ud800-\\udfff",Bt="\\u0300-\\u036f",mr="\\ufe20-\\ufe2f",an="\\u20d0-\\u20ff",gs=Bt+mr+an,Xo="\\u2700-\\u27bf",Ko="a-z\\xdf-\\xf6\\xf8-\\xff",Cs="\\xac\\xb1\\xd7\\xf7",yi="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Sa="\\u2000-\\u206f",Ji=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",ol="A-Z\\xc0-\\xd6\\xd8-\\xde",ju="\\ufe0e\\ufe0f",Ll=Cs+yi+Sa+Ji,_a="['\u2019]",Bu="["+Cn+"]",Bs="["+Ll+"]",Io="["+gs+"]",Yr="\\d+",Uu="["+Xo+"]",Pl="["+Ko+"]",Ta="[^"+Cn+Ll+Yr+Xo+Ko+ol+"]",ka="\\ud83c[\\udffb-\\udfff]",zu="(?:"+Io+"|"+ka+")",Vu="[^"+Cn+"]",jl="(?:\\ud83c[\\udde6-\\uddff]){2}",Bl="[\\ud800-\\udbff][\\udc00-\\udfff]",Yo="["+ol+"]",Ia="\\u200d",Ul="(?:"+Pl+"|"+Ta+")",il="(?:"+Yo+"|"+Ta+")",Zo="(?:"+_a+"(?:d|ll|m|re|s|t|ve))?",fo="(?:"+_a+"(?:D|LL|M|RE|S|T|VE))?",ah=zu+"?",Gu="["+ju+"]?",lh="(?:"+Ia+"(?:"+[Vu,jl,Bl].join("|")+")"+Gu+ah+")*",vi="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Ea="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",uh=Gu+ah+lh,Wu="(?:"+[Uu,jl,Bl].join("|")+")"+uh,ch="(?:"+[Vu+Io+"?",Io,jl,Bl,Bu].join("|")+")",Ld=RegExp(_a,"g"),zl=RegExp(Io,"g"),Eo=RegExp(ka+"(?="+ka+")|"+ch+uh,"g"),Hu=RegExp([Yo+"?"+Pl+"+"+Zo+"(?="+[Bs,Yo,"$"].join("|")+")",il+"+"+fo+"(?="+[Bs,Yo+Ul,"$"].join("|")+")",Yo+"?"+Ul+"+"+Zo,Yo+"+"+fo,Ea,vi,Yr,Wu].join("|"),"g"),ea=RegExp("["+Ia+Cn+gs+ju+"]"),Ys=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,hh=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Pd=-1,hr={};hr[At]=hr[Ft]=hr[Be]=hr[qt]=hr[Y]=hr[le]=hr[ee]=hr[ue]=hr[Ae]=!0,hr[Oe]=hr[Se]=hr[ht]=hr[j]=hr[ct]=hr[W]=hr[ie]=hr[ve]=hr[Fe]=hr[me]=hr[De]=hr[tt]=hr[Je]=hr[xt]=hr[St]=!1;var dr={};dr[Oe]=dr[Se]=dr[ht]=dr[ct]=dr[j]=dr[W]=dr[At]=dr[Ft]=dr[Be]=dr[qt]=dr[Y]=dr[Fe]=dr[me]=dr[De]=dr[tt]=dr[Je]=dr[xt]=dr[Pt]=dr[le]=dr[ee]=dr[ue]=dr[Ae]=!0,dr[ie]=dr[ve]=dr[St]=!1;var qu={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},Xu={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Ca={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Ku={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Zs=parseFloat,Qo=parseInt,$a=typeof Pr=="object"&&Pr&&Pr.Object===Object&&Pr,Jo=typeof self=="object"&&self&&self.Object===Object&&self,gr=$a||Jo||Function("return this")(),bi=e&&!e.nodeType&&e,ta=bi&&!0&&r&&!r.nodeType&&r,ei=ta&&ta.exports===bi,ti=ei&&$a.process,$s=function(){try{var Ve=ta&&ta.require&&ta.require("util").types;return Ve||ti&&ti.binding&&ti.binding("util")}catch{}}(),Yu=$s&&$s.isArrayBuffer,Vl=$s&&$s.isDate,Zu=$s&&$s.isMap,Qu=$s&&$s.isRegExp,al=$s&&$s.isSet,ll=$s&&$s.isTypedArray;function Ns(Ve,it,nt){switch(nt.length){case 0:return Ve.call(it);case 1:return Ve.call(it,nt[0]);case 2:return Ve.call(it,nt[0],nt[1]);case 3:return Ve.call(it,nt[0],nt[1],nt[2])}return Ve.apply(it,nt)}function dh(Ve,it,nt,Ot){for(var Ht=-1,vn=Ve==null?0:Ve.length;++Ht<vn;){var $n=Ve[Ht];it(Ot,$n,nt($n),Ve)}return Ot}function Us(Ve,it){for(var nt=-1,Ot=Ve==null?0:Ve.length;++nt<Ot&&it(Ve[nt],nt,Ve)!==!1;);return Ve}function fh(Ve,it){for(var nt=Ve==null?0:Ve.length;nt--&&it(Ve[nt],nt,Ve)!==!1;);return Ve}function Gl(Ve,it){for(var nt=-1,Ot=Ve==null?0:Ve.length;++nt<Ot;)if(!it(Ve[nt],nt,Ve))return!1;return!0}function ni(Ve,it){for(var nt=-1,Ot=Ve==null?0:Ve.length,Ht=0,vn=[];++nt<Ot;){var $n=Ve[nt];it($n,nt,Ve)&&(vn[Ht++]=$n)}return vn}function ul(Ve,it){var nt=Ve==null?0:Ve.length;return!!nt&&U(Ve,it,0)>-1}function Na(Ve,it,nt){for(var Ot=-1,Ht=Ve==null?0:Ve.length;++Ot<Ht;)if(nt(it,Ve[Ot]))return!0;return!1}function Sr(Ve,it){for(var nt=-1,Ot=Ve==null?0:Ve.length,Ht=Array(Ot);++nt<Ot;)Ht[nt]=it(Ve[nt],nt,Ve);return Ht}function Co(Ve,it){for(var nt=-1,Ot=it.length,Ht=Ve.length;++nt<Ot;)Ve[Ht+nt]=it[nt];return Ve}function Aa(Ve,it,nt,Ot){var Ht=-1,vn=Ve==null?0:Ve.length;for(Ot&&vn&&(nt=Ve[++Ht]);++Ht<vn;)nt=it(nt,Ve[Ht],Ht,Ve);return nt}function Ra(Ve,it,nt,Ot){var Ht=Ve==null?0:Ve.length;for(Ot&&Ht&&(nt=Ve[--Ht]);Ht--;)nt=it(nt,Ve[Ht],Ht,Ve);return nt}function Wl(Ve,it){for(var nt=-1,Ot=Ve==null?0:Ve.length;++nt<Ot;)if(it(Ve[nt],nt,Ve))return!0;return!1}var xi=Ce("length");function wi(Ve){return Ve.split("")}function Qt(Ve){return Ve.match(qo)||[]}function Ju(Ve,it,nt){var Ot;return nt(Ve,function(Ht,vn,$n){if(it(Ht,vn,$n))return Ot=vn,!1}),Ot}function $(Ve,it,nt,Ot){for(var Ht=Ve.length,vn=nt+(Ot?1:-1);Ot?vn--:++vn<Ht;)if(it(Ve[vn],vn,Ve))return vn;return-1}function U(Ve,it,nt){return it===it?st(Ve,it,nt):$(Ve,oe,nt)}function H(Ve,it,nt,Ot){for(var Ht=nt-1,vn=Ve.length;++Ht<vn;)if(Ot(Ve[Ht],it))return Ht;return-1}function oe(Ve){return Ve!==Ve}function Ie(Ve,it){var nt=Ve==null?0:Ve.length;return nt?Ct(Ve,it)/nt:re}function Ce(Ve){return function(it){return it==null?t:it[Ve]}}function $e(Ve){return function(it){return Ve==null?t:Ve[it]}}function He(Ve,it,nt,Ot,Ht){return Ht(Ve,function(vn,$n,Tn){nt=Ot?(Ot=!1,vn):it(nt,vn,$n,Tn)}),nt}function lt(Ve,it){var nt=Ve.length;for(Ve.sort(it);nt--;)Ve[nt]=Ve[nt].value;return Ve}function Ct(Ve,it){for(var nt,Ot=-1,Ht=Ve.length;++Ot<Ht;){var vn=it(Ve[Ot]);vn!==t&&(nt=nt===t?vn:nt+vn)}return nt}function jt(Ve,it){for(var nt=-1,Ot=Array(Ve);++nt<Ve;)Ot[nt]=it(nt);return Ot}function wn(Ve,it){return Sr(it,function(nt){return[nt,Ve[nt]]})}function on(Ve){return Ve&&Ve.slice(0,Bn(Ve)+1).replace(zr,"")}function It(Ve){return function(it){return Ve(it)}}function bn(Ve,it){return Sr(it,function(nt){return Ve[nt]})}function S(Ve,it){return Ve.has(it)}function k(Ve,it){for(var nt=-1,Ot=Ve.length;++nt<Ot&&U(it,Ve[nt],0)>-1;);return nt}function E(Ve,it){for(var nt=Ve.length;nt--&&U(it,Ve[nt],0)>-1;);return nt}function A(Ve,it){for(var nt=Ve.length,Ot=0;nt--;)Ve[nt]===it&&++Ot;return Ot}var L=$e(qu),V=$e(Xu);function q(Ve){return"\\"+Ku[Ve]}function se(Ve,it){return Ve==null?t:Ve[it]}function ae(Ve){return ea.test(Ve)}function _e(Ve){return Ys.test(Ve)}function je(Ve){for(var it,nt=[];!(it=Ve.next()).done;)nt.push(it.value);return nt}function qe(Ve){var it=-1,nt=Array(Ve.size);return Ve.forEach(function(Ot,Ht){nt[++it]=[Ht,Ot]}),nt}function ge(Ve,it){return function(nt){return Ve(it(nt))}}function $t(Ve,it){for(var nt=-1,Ot=Ve.length,Ht=0,vn=[];++nt<Ot;){var $n=Ve[nt];($n===it||$n===h)&&(Ve[nt]=h,vn[Ht++]=nt)}return vn}function wt(Ve){var it=-1,nt=Array(Ve.size);return Ve.forEach(function(Ot){nt[++it]=Ot}),nt}function mt(Ve){var it=-1,nt=Array(Ve.size);return Ve.forEach(function(Ot){nt[++it]=[Ot,Ot]}),nt}function st(Ve,it,nt){for(var Ot=nt-1,Ht=Ve.length;++Ot<Ht;)if(Ve[Ot]===it)return Ot;return-1}function dt(Ve,it,nt){for(var Ot=nt+1;Ot--;)if(Ve[Ot]===it)return Ot;return Ot}function Zt(Ve){return ae(Ve)?yn(Ve):xi(Ve)}function zt(Ve){return ae(Ve)?Or(Ve):wi(Ve)}function Bn(Ve){for(var it=Ve.length;it--&&js.test(Ve.charAt(it)););return it}var un=$e(Ca);function yn(Ve){for(var it=Eo.lastIndex=0;Eo.test(Ve);)++it;return it}function Or(Ve){return Ve.match(Eo)||[]}function Zn(Ve){return Ve.match(Hu)||[]}var qn=function Ve(it){it=it==null?gr:Fn.defaults(gr.Object(),it,Fn.pick(gr,hh));var nt=it.Array,Ot=it.Date,Ht=it.Error,vn=it.Function,$n=it.Math,Tn=it.Object,Qn=it.RegExp,Xr=it.String,Vn=it.TypeError,fr=nt.prototype,Si=vn.prototype,ri=Tn.prototype,_i=it["__core-js_shared__"],zs=Si.toString,Jn=ri.hasOwnProperty,Hl=0,jd=function(){var x=/[^.]+$/.exec(_i&&_i.keys&&_i.keys.IE_PROTO||"");return x?"Symbol(src)_1."+x:""}(),ql=ri.toString,k4=zs.call(Tn),I4=gr._,E4=Qn("^"+zs.call(Jn).replace(Es,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Am=ei?it.Buffer:t,Xl=it.Symbol,Rm=it.Uint8Array,B_=Am?Am.allocUnsafe:t,Dm=ge(Tn.getPrototypeOf,Tn),U_=Tn.create,z_=ri.propertyIsEnumerable,Om=fr.splice,V_=Xl?Xl.isConcatSpreadable:t,Bd=Xl?Xl.iterator:t,ec=Xl?Xl.toStringTag:t,Mm=function(){try{var x=oc(Tn,"defineProperty");return x({},"",{}),x}catch{}}(),C4=it.clearTimeout!==gr.clearTimeout&&it.clearTimeout,$4=Ot&&Ot.now!==gr.Date.now&&Ot.now,N4=it.setTimeout!==gr.setTimeout&&it.setTimeout,Fm=$n.ceil,Lm=$n.floor,G1=Tn.getOwnPropertySymbols,A4=Am?Am.isBuffer:t,G_=it.isFinite,R4=fr.join,D4=ge(Tn.keys,Tn),ys=$n.max,Qs=$n.min,O4=Ot.now,M4=it.parseInt,W_=$n.random,F4=fr.reverse,W1=oc(it,"DataView"),Ud=oc(it,"Map"),H1=oc(it,"Promise"),ph=oc(it,"Set"),zd=oc(it,"WeakMap"),Vd=oc(Tn,"create"),Pm=zd&&new zd,mh={},L4=ic(W1),P4=ic(Ud),j4=ic(H1),B4=ic(ph),U4=ic(zd),jm=Xl?Xl.prototype:t,Gd=jm?jm.valueOf:t,H_=jm?jm.toString:t;function de(x){if(Zr(x)&&!Ln(x)&&!(x instanceof tr)){if(x instanceof Ti)return x;if(Jn.call(x,"__wrapped__"))return qT(x)}return new Ti(x)}var gh=function(){function x(){}return function(T){if(!Kr(T))return{};if(U_)return U_(T);x.prototype=T;var R=new x;return x.prototype=t,R}}();function Bm(){}function Ti(x,T){this.__wrapped__=x,this.__actions__=[],this.__chain__=!!T,this.__index__=0,this.__values__=t}de.templateSettings={escape:mn,evaluate:hn,interpolate:gn,variable:"",imports:{_:de}},de.prototype=Bm.prototype,de.prototype.constructor=de,Ti.prototype=gh(Bm.prototype),Ti.prototype.constructor=Ti;function tr(x){this.__wrapped__=x,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=ce,this.__views__=[]}function z4(){var x=new tr(this.__wrapped__);return x.__actions__=$o(this.__actions__),x.__dir__=this.__dir__,x.__filtered__=this.__filtered__,x.__iteratees__=$o(this.__iteratees__),x.__takeCount__=this.__takeCount__,x.__views__=$o(this.__views__),x}function V4(){if(this.__filtered__){var x=new tr(this);x.__dir__=-1,x.__filtered__=!0}else x=this.clone(),x.__dir__*=-1;return x}function G4(){var x=this.__wrapped__.value(),T=this.__dir__,R=Ln(x),G=T<0,te=R?x.length:0,pe=nB(0,te,this.__views__),Me=pe.start,Ge=pe.end,et=Ge-Me,_t=G?Ge:Me-1,Tt=this.__iteratees__,Nt=Tt.length,Kt=0,cn=Qs(et,this.__takeCount__);if(!R||!G&&te==et&&cn==et)return gT(x,this.__actions__);var kn=[];e:for(;et--&&Kt<cn;){_t+=T;for(var Gn=-1,In=x[_t];++Gn<Nt;){var er=Tt[Gn],sr=er.iteratee,ii=er.type,go=sr(In);if(ii==z)In=go;else if(!go){if(ii==B)continue e;break e}}kn[Kt++]=In}return kn}tr.prototype=gh(Bm.prototype),tr.prototype.constructor=tr;function tc(x){var T=-1,R=x==null?0:x.length;for(this.clear();++T<R;){var G=x[T];this.set(G[0],G[1])}}function W4(){this.__data__=Vd?Vd(null):{},this.size=0}function H4(x){var T=this.has(x)&&delete this.__data__[x];return this.size-=T?1:0,T}function q4(x){var T=this.__data__;if(Vd){var R=T[x];return R===l?t:R}return Jn.call(T,x)?T[x]:t}function X4(x){var T=this.__data__;return Vd?T[x]!==t:Jn.call(T,x)}function K4(x,T){var R=this.__data__;return this.size+=this.has(x)?0:1,R[x]=Vd&&T===t?l:T,this}tc.prototype.clear=W4,tc.prototype.delete=H4,tc.prototype.get=q4,tc.prototype.has=X4,tc.prototype.set=K4;function cl(x){var T=-1,R=x==null?0:x.length;for(this.clear();++T<R;){var G=x[T];this.set(G[0],G[1])}}function Y4(){this.__data__=[],this.size=0}function Z4(x){var T=this.__data__,R=Um(T,x);if(R<0)return!1;var G=T.length-1;return R==G?T.pop():Om.call(T,R,1),--this.size,!0}function Q4(x){var T=this.__data__,R=Um(T,x);return R<0?t:T[R][1]}function J4(x){return Um(this.__data__,x)>-1}function ej(x,T){var R=this.__data__,G=Um(R,x);return G<0?(++this.size,R.push([x,T])):R[G][1]=T,this}cl.prototype.clear=Y4,cl.prototype.delete=Z4,cl.prototype.get=Q4,cl.prototype.has=J4,cl.prototype.set=ej;function hl(x){var T=-1,R=x==null?0:x.length;for(this.clear();++T<R;){var G=x[T];this.set(G[0],G[1])}}function tj(){this.size=0,this.__data__={hash:new tc,map:new(Ud||cl),string:new tc}}function nj(x){var T=Jm(this,x).delete(x);return this.size-=T?1:0,T}function rj(x){return Jm(this,x).get(x)}function sj(x){return Jm(this,x).has(x)}function oj(x,T){var R=Jm(this,x),G=R.size;return R.set(x,T),this.size+=R.size==G?0:1,this}hl.prototype.clear=tj,hl.prototype.delete=nj,hl.prototype.get=rj,hl.prototype.has=sj,hl.prototype.set=oj;function nc(x){var T=-1,R=x==null?0:x.length;for(this.__data__=new hl;++T<R;)this.add(x[T])}function ij(x){return this.__data__.set(x,l),this}function aj(x){return this.__data__.has(x)}nc.prototype.add=nc.prototype.push=ij,nc.prototype.has=aj;function na(x){var T=this.__data__=new cl(x);this.size=T.size}function lj(){this.__data__=new cl,this.size=0}function uj(x){var T=this.__data__,R=T.delete(x);return this.size=T.size,R}function cj(x){return this.__data__.get(x)}function hj(x){return this.__data__.has(x)}function dj(x,T){var R=this.__data__;if(R instanceof cl){var G=R.__data__;if(!Ud||G.length<s-1)return G.push([x,T]),this.size=++R.size,this;R=this.__data__=new hl(G)}return R.set(x,T),this.size=R.size,this}na.prototype.clear=lj,na.prototype.delete=uj,na.prototype.get=cj,na.prototype.has=hj,na.prototype.set=dj;function q_(x,T){var R=Ln(x),G=!R&&ac(x),te=!R&&!G&&Jl(x),pe=!R&&!G&&!te&&xh(x),Me=R||G||te||pe,Ge=Me?jt(x.length,Xr):[],et=Ge.length;for(var _t in x)(T||Jn.call(x,_t))&&!(Me&&(_t=="length"||te&&(_t=="offset"||_t=="parent")||pe&&(_t=="buffer"||_t=="byteLength"||_t=="byteOffset")||ml(_t,et)))&&Ge.push(_t);return Ge}function X_(x){var T=x.length;return T?x[rv(0,T-1)]:t}function fj(x,T){return eg($o(x),rc(T,0,x.length))}function pj(x){return eg($o(x))}function q1(x,T,R){(R!==t&&!ra(x[T],R)||R===t&&!(T in x))&&dl(x,T,R)}function Wd(x,T,R){var G=x[T];(!(Jn.call(x,T)&&ra(G,R))||R===t&&!(T in x))&&dl(x,T,R)}function Um(x,T){for(var R=x.length;R--;)if(ra(x[R][0],T))return R;return-1}function mj(x,T,R,G){return Kl(x,function(te,pe,Me){T(G,te,R(te),Me)}),G}function K_(x,T){return x&&Oa(T,As(T),x)}function gj(x,T){return x&&Oa(T,Ao(T),x)}function dl(x,T,R){T=="__proto__"&&Mm?Mm(x,T,{configurable:!0,enumerable:!0,value:R,writable:!0}):x[T]=R}function X1(x,T){for(var R=-1,G=T.length,te=nt(G),pe=x==null;++R<G;)te[R]=pe?t:Cv(x,T[R]);return te}function rc(x,T,R){return x===x&&(R!==t&&(x=x<=R?x:R),T!==t&&(x=x>=T?x:T)),x}function ki(x,T,R,G,te,pe){var Me,Ge=T&d,et=T&c,_t=T&f;if(R&&(Me=te?R(x,G,te,pe):R(x)),Me!==t)return Me;if(!Kr(x))return x;var Tt=Ln(x);if(Tt){if(Me=sB(x),!Ge)return $o(x,Me)}else{var Nt=Js(x),Kt=Nt==ve||Nt==he;if(Jl(x))return bT(x,Ge);if(Nt==De||Nt==Oe||Kt&&!te){if(Me=et||Kt?{}:PT(x),!Ge)return et?qj(x,gj(Me,x)):Hj(x,K_(Me,x))}else{if(!dr[Nt])return te?x:{};Me=oB(x,Nt,Ge)}}pe||(pe=new na);var cn=pe.get(x);if(cn)return cn;pe.set(x,Me),fk(x)?x.forEach(function(In){Me.add(ki(In,T,R,In,x,pe))}):hk(x)&&x.forEach(function(In,er){Me.set(er,ki(In,T,R,er,x,pe))});var kn=_t?et?pv:fv:et?Ao:As,Gn=Tt?t:kn(x);return Us(Gn||x,function(In,er){Gn&&(er=In,In=x[er]),Wd(Me,er,ki(In,T,R,er,x,pe))}),Me}function yj(x){var T=As(x);return function(R){return Y_(R,x,T)}}function Y_(x,T,R){var G=R.length;if(x==null)return!G;for(x=Tn(x);G--;){var te=R[G],pe=T[te],Me=x[te];if(Me===t&&!(te in x)||!pe(Me))return!1}return!0}function Z_(x,T,R){if(typeof x!="function")throw new Vn(a);return Qd(function(){x.apply(t,R)},T)}function Hd(x,T,R,G){var te=-1,pe=ul,Me=!0,Ge=x.length,et=[],_t=T.length;if(!Ge)return et;R&&(T=Sr(T,It(R))),G?(pe=Na,Me=!1):T.length>=s&&(pe=S,Me=!1,T=new nc(T));e:for(;++te<Ge;){var Tt=x[te],Nt=R==null?Tt:R(Tt);if(Tt=G||Tt!==0?Tt:0,Me&&Nt===Nt){for(var Kt=_t;Kt--;)if(T[Kt]===Nt)continue e;et.push(Tt)}else pe(T,Nt,G)||et.push(Tt)}return et}var Kl=TT(Da),Q_=TT(Y1,!0);function vj(x,T){var R=!0;return Kl(x,function(G,te,pe){return R=!!T(G,te,pe),R}),R}function zm(x,T,R){for(var G=-1,te=x.length;++G<te;){var pe=x[G],Me=T(pe);if(Me!=null&&(Ge===t?Me===Me&&!oi(Me):R(Me,Ge)))var Ge=Me,et=pe}return et}function bj(x,T,R,G){var te=x.length;for(R=Un(R),R<0&&(R=-R>te?0:te+R),G=G===t||G>te?te:Un(G),G<0&&(G+=te),G=R>G?0:mk(G);R<G;)x[R++]=T;return x}function J_(x,T){var R=[];return Kl(x,function(G,te,pe){T(G,te,pe)&&R.push(G)}),R}function Vs(x,T,R,G,te){var pe=-1,Me=x.length;for(R||(R=aB),te||(te=[]);++pe<Me;){var Ge=x[pe];T>0&&R(Ge)?T>1?Vs(Ge,T-1,R,G,te):Co(te,Ge):G||(te[te.length]=Ge)}return te}var K1=kT(),eT=kT(!0);function Da(x,T){return x&&K1(x,T,As)}function Y1(x,T){return x&&eT(x,T,As)}function Vm(x,T){return ni(T,function(R){return gl(x[R])})}function sc(x,T){T=Zl(T,x);for(var R=0,G=T.length;x!=null&&R<G;)x=x[Ma(T[R++])];return R&&R==G?x:t}function tT(x,T,R){var G=T(x);return Ln(x)?G:Co(G,R(x))}function po(x){return x==null?x===t?Dt:Le:ec&&ec in Tn(x)?tB(x):pB(x)}function Z1(x,T){return x>T}function xj(x,T){return x!=null&&Jn.call(x,T)}function wj(x,T){return x!=null&&T in Tn(x)}function Sj(x,T,R){return x>=Qs(T,R)&&x<ys(T,R)}function Q1(x,T,R){for(var G=R?Na:ul,te=x[0].length,pe=x.length,Me=pe,Ge=nt(pe),et=1/0,_t=[];Me--;){var Tt=x[Me];Me&&T&&(Tt=Sr(Tt,It(T))),et=Qs(Tt.length,et),Ge[Me]=!R&&(T||te>=120&&Tt.length>=120)?new nc(Me&&Tt):t}Tt=x[0];var Nt=-1,Kt=Ge[0];e:for(;++Nt<te&&_t.length<et;){var cn=Tt[Nt],kn=T?T(cn):cn;if(cn=R||cn!==0?cn:0,!(Kt?S(Kt,kn):G(_t,kn,R))){for(Me=pe;--Me;){var Gn=Ge[Me];if(!(Gn?S(Gn,kn):G(x[Me],kn,R)))continue e}Kt&&Kt.push(kn),_t.push(cn)}}return _t}function _j(x,T,R,G){return Da(x,function(te,pe,Me){T(G,R(te),pe,Me)}),G}function qd(x,T,R){T=Zl(T,x),x=zT(x,T);var G=x==null?x:x[Ma(Ei(T))];return G==null?t:Ns(G,x,R)}function nT(x){return Zr(x)&&po(x)==Oe}function Tj(x){return Zr(x)&&po(x)==ht}function kj(x){return Zr(x)&&po(x)==W}function Xd(x,T,R,G,te){return x===T?!0:x==null||T==null||!Zr(x)&&!Zr(T)?x!==x&&T!==T:Ij(x,T,R,G,Xd,te)}function Ij(x,T,R,G,te,pe){var Me=Ln(x),Ge=Ln(T),et=Me?Se:Js(x),_t=Ge?Se:Js(T);et=et==Oe?De:et,_t=_t==Oe?De:_t;var Tt=et==De,Nt=_t==De,Kt=et==_t;if(Kt&&Jl(x)){if(!Jl(T))return!1;Me=!0,Tt=!1}if(Kt&&!Tt)return pe||(pe=new na),Me||xh(x)?MT(x,T,R,G,te,pe):Jj(x,T,et,R,G,te,pe);if(!(R&p)){var cn=Tt&&Jn.call(x,"__wrapped__"),kn=Nt&&Jn.call(T,"__wrapped__");if(cn||kn){var Gn=cn?x.value():x,In=kn?T.value():T;return pe||(pe=new na),te(Gn,In,R,G,pe)}}return Kt?(pe||(pe=new na),eB(x,T,R,G,te,pe)):!1}function Ej(x){return Zr(x)&&Js(x)==Fe}function J1(x,T,R,G){var te=R.length,pe=te,Me=!G;if(x==null)return!pe;for(x=Tn(x);te--;){var Ge=R[te];if(Me&&Ge[2]?Ge[1]!==x[Ge[0]]:!(Ge[0]in x))return!1}for(;++te<pe;){Ge=R[te];var et=Ge[0],_t=x[et],Tt=Ge[1];if(Me&&Ge[2]){if(_t===t&&!(et in x))return!1}else{var Nt=new na;if(G)var Kt=G(_t,Tt,et,x,T,Nt);if(!(Kt===t?Xd(Tt,_t,p|m,G,Nt):Kt))return!1}}return!0}function rT(x){if(!Kr(x)||uB(x))return!1;var T=gl(x)?E4:kt;return T.test(ic(x))}function Cj(x){return Zr(x)&&po(x)==tt}function $j(x){return Zr(x)&&Js(x)==Je}function Nj(x){return Zr(x)&&ig(x.length)&&!!hr[po(x)]}function sT(x){return typeof x=="function"?x:x==null?Ro:typeof x=="object"?Ln(x)?aT(x[0],x[1]):iT(x):Ik(x)}function ev(x){if(!Zd(x))return D4(x);var T=[];for(var R in Tn(x))Jn.call(x,R)&&R!="constructor"&&T.push(R);return T}function Aj(x){if(!Kr(x))return fB(x);var T=Zd(x),R=[];for(var G in x)G=="constructor"&&(T||!Jn.call(x,G))||R.push(G);return R}function tv(x,T){return x<T}function oT(x,T){var R=-1,G=No(x)?nt(x.length):[];return Kl(x,function(te,pe,Me){G[++R]=T(te,pe,Me)}),G}function iT(x){var T=gv(x);return T.length==1&&T[0][2]?BT(T[0][0],T[0][1]):function(R){return R===x||J1(R,x,T)}}function aT(x,T){return vv(x)&&jT(T)?BT(Ma(x),T):function(R){var G=Cv(R,x);return G===t&&G===T?$v(R,x):Xd(T,G,p|m)}}function Gm(x,T,R,G,te){x!==T&&K1(T,function(pe,Me){if(te||(te=new na),Kr(pe))Rj(x,T,Me,R,Gm,G,te);else{var Ge=G?G(xv(x,Me),pe,Me+"",x,T,te):t;Ge===t&&(Ge=pe),q1(x,Me,Ge)}},Ao)}function Rj(x,T,R,G,te,pe,Me){var Ge=xv(x,R),et=xv(T,R),_t=Me.get(et);if(_t){q1(x,R,_t);return}var Tt=pe?pe(Ge,et,R+"",x,T,Me):t,Nt=Tt===t;if(Nt){var Kt=Ln(et),cn=!Kt&&Jl(et),kn=!Kt&&!cn&&xh(et);Tt=et,Kt||cn||kn?Ln(Ge)?Tt=Ge:rs(Ge)?Tt=$o(Ge):cn?(Nt=!1,Tt=bT(et,!0)):kn?(Nt=!1,Tt=xT(et,!0)):Tt=[]:Jd(et)||ac(et)?(Tt=Ge,ac(Ge)?Tt=gk(Ge):(!Kr(Ge)||gl(Ge))&&(Tt=PT(et))):Nt=!1}Nt&&(Me.set(et,Tt),te(Tt,et,G,pe,Me),Me.delete(et)),q1(x,R,Tt)}function lT(x,T){var R=x.length;if(!!R)return T+=T<0?R:0,ml(T,R)?x[T]:t}function uT(x,T,R){T.length?T=Sr(T,function(pe){return Ln(pe)?function(Me){return sc(Me,pe.length===1?pe[0]:pe)}:pe}):T=[Ro];var G=-1;T=Sr(T,It(Sn()));var te=oT(x,function(pe,Me,Ge){var et=Sr(T,function(_t){return _t(pe)});return{criteria:et,index:++G,value:pe}});return lt(te,function(pe,Me){return Wj(pe,Me,R)})}function Dj(x,T){return cT(x,T,function(R,G){return $v(x,G)})}function cT(x,T,R){for(var G=-1,te=T.length,pe={};++G<te;){var Me=T[G],Ge=sc(x,Me);R(Ge,Me)&&Kd(pe,Zl(Me,x),Ge)}return pe}function Oj(x){return function(T){return sc(T,x)}}function nv(x,T,R,G){var te=G?H:U,pe=-1,Me=T.length,Ge=x;for(x===T&&(T=$o(T)),R&&(Ge=Sr(x,It(R)));++pe<Me;)for(var et=0,_t=T[pe],Tt=R?R(_t):_t;(et=te(Ge,Tt,et,G))>-1;)Ge!==x&&Om.call(Ge,et,1),Om.call(x,et,1);return x}function hT(x,T){for(var R=x?T.length:0,G=R-1;R--;){var te=T[R];if(R==G||te!==pe){var pe=te;ml(te)?Om.call(x,te,1):iv(x,te)}}return x}function rv(x,T){return x+Lm(W_()*(T-x+1))}function Mj(x,T,R,G){for(var te=-1,pe=ys(Fm((T-x)/(R||1)),0),Me=nt(pe);pe--;)Me[G?pe:++te]=x,x+=R;return Me}function sv(x,T){var R="";if(!x||T<1||T>K)return R;do T%2&&(R+=x),T=Lm(T/2),T&&(x+=x);while(T);return R}function Xn(x,T){return wv(UT(x,T,Ro),x+"")}function Fj(x){return X_(wh(x))}function Lj(x,T){var R=wh(x);return eg(R,rc(T,0,R.length))}function Kd(x,T,R,G){if(!Kr(x))return x;T=Zl(T,x);for(var te=-1,pe=T.length,Me=pe-1,Ge=x;Ge!=null&&++te<pe;){var et=Ma(T[te]),_t=R;if(et==="__proto__"||et==="constructor"||et==="prototype")return x;if(te!=Me){var Tt=Ge[et];_t=G?G(Tt,et,Ge):t,_t===t&&(_t=Kr(Tt)?Tt:ml(T[te+1])?[]:{})}Wd(Ge,et,_t),Ge=Ge[et]}return x}var dT=Pm?function(x,T){return Pm.set(x,T),x}:Ro,Pj=Mm?function(x,T){return Mm(x,"toString",{configurable:!0,enumerable:!1,value:Av(T),writable:!0})}:Ro;function jj(x){return eg(wh(x))}function Ii(x,T,R){var G=-1,te=x.length;T<0&&(T=-T>te?0:te+T),R=R>te?te:R,R<0&&(R+=te),te=T>R?0:R-T>>>0,T>>>=0;for(var pe=nt(te);++G<te;)pe[G]=x[G+T];return pe}function Bj(x,T){var R;return Kl(x,function(G,te,pe){return R=T(G,te,pe),!R}),!!R}function Wm(x,T,R){var G=0,te=x==null?G:x.length;if(typeof T=="number"&&T===T&&te<=we){for(;G<te;){var pe=G+te>>>1,Me=x[pe];Me!==null&&!oi(Me)&&(R?Me<=T:Me<T)?G=pe+1:te=pe}return te}return ov(x,T,Ro,R)}function ov(x,T,R,G){var te=0,pe=x==null?0:x.length;if(pe===0)return 0;T=R(T);for(var Me=T!==T,Ge=T===null,et=oi(T),_t=T===t;te<pe;){var Tt=Lm((te+pe)/2),Nt=R(x[Tt]),Kt=Nt!==t,cn=Nt===null,kn=Nt===Nt,Gn=oi(Nt);if(Me)var In=G||kn;else _t?In=kn&&(G||Kt):Ge?In=kn&&Kt&&(G||!cn):et?In=kn&&Kt&&!cn&&(G||!Gn):cn||Gn?In=!1:In=G?Nt<=T:Nt<T;In?te=Tt+1:pe=Tt}return Qs(pe,be)}function fT(x,T){for(var R=-1,G=x.length,te=0,pe=[];++R<G;){var Me=x[R],Ge=T?T(Me):Me;if(!R||!ra(Ge,et)){var et=Ge;pe[te++]=Me===0?0:Me}}return pe}function pT(x){return typeof x=="number"?x:oi(x)?re:+x}function si(x){if(typeof x=="string")return x;if(Ln(x))return Sr(x,si)+"";if(oi(x))return H_?H_.call(x):"";var T=x+"";return T=="0"&&1/x==-Q?"-0":T}function Yl(x,T,R){var G=-1,te=ul,pe=x.length,Me=!0,Ge=[],et=Ge;if(R)Me=!1,te=Na;else if(pe>=s){var _t=T?null:Zj(x);if(_t)return wt(_t);Me=!1,te=S,et=new nc}else et=T?[]:Ge;e:for(;++G<pe;){var Tt=x[G],Nt=T?T(Tt):Tt;if(Tt=R||Tt!==0?Tt:0,Me&&Nt===Nt){for(var Kt=et.length;Kt--;)if(et[Kt]===Nt)continue e;T&&et.push(Nt),Ge.push(Tt)}else te(et,Nt,R)||(et!==Ge&&et.push(Nt),Ge.push(Tt))}return Ge}function iv(x,T){return T=Zl(T,x),x=zT(x,T),x==null||delete x[Ma(Ei(T))]}function mT(x,T,R,G){return Kd(x,T,R(sc(x,T)),G)}function Hm(x,T,R,G){for(var te=x.length,pe=G?te:-1;(G?pe--:++pe<te)&&T(x[pe],pe,x););return R?Ii(x,G?0:pe,G?pe+1:te):Ii(x,G?pe+1:0,G?te:pe)}function gT(x,T){var R=x;return R instanceof tr&&(R=R.value()),Aa(T,function(G,te){return te.func.apply(te.thisArg,Co([G],te.args))},R)}function av(x,T,R){var G=x.length;if(G<2)return G?Yl(x[0]):[];for(var te=-1,pe=nt(G);++te<G;)for(var Me=x[te],Ge=-1;++Ge<G;)Ge!=te&&(pe[te]=Hd(pe[te]||Me,x[Ge],T,R));return Yl(Vs(pe,1),T,R)}function yT(x,T,R){for(var G=-1,te=x.length,pe=T.length,Me={};++G<te;){var Ge=G<pe?T[G]:t;R(Me,x[G],Ge)}return Me}function lv(x){return rs(x)?x:[]}function uv(x){return typeof x=="function"?x:Ro}function Zl(x,T){return Ln(x)?x:vv(x,T)?[x]:HT(yr(x))}var Uj=Xn;function Ql(x,T,R){var G=x.length;return R=R===t?G:R,!T&&R>=G?x:Ii(x,T,R)}var vT=C4||function(x){return gr.clearTimeout(x)};function bT(x,T){if(T)return x.slice();var R=x.length,G=B_?B_(R):new x.constructor(R);return x.copy(G),G}function cv(x){var T=new x.constructor(x.byteLength);return new Rm(T).set(new Rm(x)),T}function zj(x,T){var R=T?cv(x.buffer):x.buffer;return new x.constructor(R,x.byteOffset,x.byteLength)}function Vj(x){var T=new x.constructor(x.source,Re.exec(x));return T.lastIndex=x.lastIndex,T}function Gj(x){return Gd?Tn(Gd.call(x)):{}}function xT(x,T){var R=T?cv(x.buffer):x.buffer;return new x.constructor(R,x.byteOffset,x.length)}function wT(x,T){if(x!==T){var R=x!==t,G=x===null,te=x===x,pe=oi(x),Me=T!==t,Ge=T===null,et=T===T,_t=oi(T);if(!Ge&&!_t&&!pe&&x>T||pe&&Me&&et&&!Ge&&!_t||G&&Me&&et||!R&&et||!te)return 1;if(!G&&!pe&&!_t&&x<T||_t&&R&&te&&!G&&!pe||Ge&&R&&te||!Me&&te||!et)return-1}return 0}function Wj(x,T,R){for(var G=-1,te=x.criteria,pe=T.criteria,Me=te.length,Ge=R.length;++G<Me;){var et=wT(te[G],pe[G]);if(et){if(G>=Ge)return et;var _t=R[G];return et*(_t=="desc"?-1:1)}}return x.index-T.index}function ST(x,T,R,G){for(var te=-1,pe=x.length,Me=R.length,Ge=-1,et=T.length,_t=ys(pe-Me,0),Tt=nt(et+_t),Nt=!G;++Ge<et;)Tt[Ge]=T[Ge];for(;++te<Me;)(Nt||te<pe)&&(Tt[R[te]]=x[te]);for(;_t--;)Tt[Ge++]=x[te++];return Tt}function _T(x,T,R,G){for(var te=-1,pe=x.length,Me=-1,Ge=R.length,et=-1,_t=T.length,Tt=ys(pe-Ge,0),Nt=nt(Tt+_t),Kt=!G;++te<Tt;)Nt[te]=x[te];for(var cn=te;++et<_t;)Nt[cn+et]=T[et];for(;++Me<Ge;)(Kt||te<pe)&&(Nt[cn+R[Me]]=x[te++]);return Nt}function $o(x,T){var R=-1,G=x.length;for(T||(T=nt(G));++R<G;)T[R]=x[R];return T}function Oa(x,T,R,G){var te=!R;R||(R={});for(var pe=-1,Me=T.length;++pe<Me;){var Ge=T[pe],et=G?G(R[Ge],x[Ge],Ge,R,x):t;et===t&&(et=x[Ge]),te?dl(R,Ge,et):Wd(R,Ge,et)}return R}function Hj(x,T){return Oa(x,yv(x),T)}function qj(x,T){return Oa(x,FT(x),T)}function qm(x,T){return function(R,G){var te=Ln(R)?dh:mj,pe=T?T():{};return te(R,x,Sn(G,2),pe)}}function yh(x){return Xn(function(T,R){var G=-1,te=R.length,pe=te>1?R[te-1]:t,Me=te>2?R[2]:t;for(pe=x.length>3&&typeof pe=="function"?(te--,pe):t,Me&&mo(R[0],R[1],Me)&&(pe=te<3?t:pe,te=1),T=Tn(T);++G<te;){var Ge=R[G];Ge&&x(T,Ge,G,pe)}return T})}function TT(x,T){return function(R,G){if(R==null)return R;if(!No(R))return x(R,G);for(var te=R.length,pe=T?te:-1,Me=Tn(R);(T?pe--:++pe<te)&&G(Me[pe],pe,Me)!==!1;);return R}}function kT(x){return function(T,R,G){for(var te=-1,pe=Tn(T),Me=G(T),Ge=Me.length;Ge--;){var et=Me[x?Ge:++te];if(R(pe[et],et,pe)===!1)break}return T}}function Xj(x,T,R){var G=T&g,te=Yd(x);function pe(){var Me=this&&this!==gr&&this instanceof pe?te:x;return Me.apply(G?R:this,arguments)}return pe}function IT(x){return function(T){T=yr(T);var R=ae(T)?zt(T):t,G=R?R[0]:T.charAt(0),te=R?Ql(R,1).join(""):T.slice(1);return G[x]()+te}}function vh(x){return function(T){return Aa(Tk(_k(T).replace(Ld,"")),x,"")}}function Yd(x){return function(){var T=arguments;switch(T.length){case 0:return new x;case 1:return new x(T[0]);case 2:return new x(T[0],T[1]);case 3:return new x(T[0],T[1],T[2]);case 4:return new x(T[0],T[1],T[2],T[3]);case 5:return new x(T[0],T[1],T[2],T[3],T[4]);case 6:return new x(T[0],T[1],T[2],T[3],T[4],T[5]);case 7:return new x(T[0],T[1],T[2],T[3],T[4],T[5],T[6])}var R=gh(x.prototype),G=x.apply(R,T);return Kr(G)?G:R}}function Kj(x,T,R){var G=Yd(x);function te(){for(var pe=arguments.length,Me=nt(pe),Ge=pe,et=bh(te);Ge--;)Me[Ge]=arguments[Ge];var _t=pe<3&&Me[0]!==et&&Me[pe-1]!==et?[]:$t(Me,et);if(pe-=_t.length,pe<R)return AT(x,T,Xm,te.placeholder,t,Me,_t,t,t,R-pe);var Tt=this&&this!==gr&&this instanceof te?G:x;return Ns(Tt,this,Me)}return te}function ET(x){return function(T,R,G){var te=Tn(T);if(!No(T)){var pe=Sn(R,3);T=As(T),R=function(Ge){return pe(te[Ge],Ge,te)}}var Me=x(T,R,G);return Me>-1?te[pe?T[Me]:Me]:t}}function CT(x){return pl(function(T){var R=T.length,G=R,te=Ti.prototype.thru;for(x&&T.reverse();G--;){var pe=T[G];if(typeof pe!="function")throw new Vn(a);if(te&&!Me&&Qm(pe)=="wrapper")var Me=new Ti([],!0)}for(G=Me?G:R;++G<R;){pe=T[G];var Ge=Qm(pe),et=Ge=="wrapper"?mv(pe):t;et&&bv(et[0])&&et[1]==(C|b|_|N)&&!et[4].length&&et[9]==1?Me=Me[Qm(et[0])].apply(Me,et[3]):Me=pe.length==1&&bv(pe)?Me[Ge]():Me.thru(pe)}return function(){var _t=arguments,Tt=_t[0];if(Me&&_t.length==1&&Ln(Tt))return Me.plant(Tt).value();for(var Nt=0,Kt=R?T[Nt].apply(this,_t):Tt;++Nt<R;)Kt=T[Nt].call(this,Kt);return Kt}})}function Xm(x,T,R,G,te,pe,Me,Ge,et,_t){var Tt=T&C,Nt=T&g,Kt=T&y,cn=T&(b|w),kn=T&O,Gn=Kt?t:Yd(x);function In(){for(var er=arguments.length,sr=nt(er),ii=er;ii--;)sr[ii]=arguments[ii];if(cn)var go=bh(In),ai=A(sr,go);if(G&&(sr=ST(sr,G,te,cn)),pe&&(sr=_T(sr,pe,Me,cn)),er-=ai,cn&&er<_t){var ss=$t(sr,go);return AT(x,T,Xm,In.placeholder,R,sr,ss,Ge,et,_t-er)}var sa=Nt?R:this,vl=Kt?sa[x]:x;return er=sr.length,Ge?sr=mB(sr,Ge):kn&&er>1&&sr.reverse(),Tt&&et<er&&(sr.length=et),this&&this!==gr&&this instanceof In&&(vl=Gn||Yd(vl)),vl.apply(sa,sr)}return In}function $T(x,T){return function(R,G){return _j(R,x,T(G),{})}}function Km(x,T){return function(R,G){var te;if(R===t&&G===t)return T;if(R!==t&&(te=R),G!==t){if(te===t)return G;typeof R=="string"||typeof G=="string"?(R=si(R),G=si(G)):(R=pT(R),G=pT(G)),te=x(R,G)}return te}}function hv(x){return pl(function(T){return T=Sr(T,It(Sn())),Xn(function(R){var G=this;return x(T,function(te){return Ns(te,G,R)})})})}function Ym(x,T){T=T===t?" ":si(T);var R=T.length;if(R<2)return R?sv(T,x):T;var G=sv(T,Fm(x/Zt(T)));return ae(T)?Ql(zt(G),0,x).join(""):G.slice(0,x)}function Yj(x,T,R,G){var te=T&g,pe=Yd(x);function Me(){for(var Ge=-1,et=arguments.length,_t=-1,Tt=G.length,Nt=nt(Tt+et),Kt=this&&this!==gr&&this instanceof Me?pe:x;++_t<Tt;)Nt[_t]=G[_t];for(;et--;)Nt[_t++]=arguments[++Ge];return Ns(Kt,te?R:this,Nt)}return Me}function NT(x){return function(T,R,G){return G&&typeof G!="number"&&mo(T,R,G)&&(R=G=t),T=yl(T),R===t?(R=T,T=0):R=yl(R),G=G===t?T<R?1:-1:yl(G),Mj(T,R,G,x)}}function Zm(x){return function(T,R){return typeof T=="string"&&typeof R=="string"||(T=Ci(T),R=Ci(R)),x(T,R)}}function AT(x,T,R,G,te,pe,Me,Ge,et,_t){var Tt=T&b,Nt=Tt?Me:t,Kt=Tt?t:Me,cn=Tt?pe:t,kn=Tt?t:pe;T|=Tt?_:I,T&=~(Tt?I:_),T&v||(T&=~(g|y));var Gn=[x,T,te,cn,Nt,kn,Kt,Ge,et,_t],In=R.apply(t,Gn);return bv(x)&&VT(In,Gn),In.placeholder=G,GT(In,x,T)}function dv(x){var T=$n[x];return function(R,G){if(R=Ci(R),G=G==null?0:Qs(Un(G),292),G&&G_(R)){var te=(yr(R)+"e").split("e"),pe=T(te[0]+"e"+(+te[1]+G));return te=(yr(pe)+"e").split("e"),+(te[0]+"e"+(+te[1]-G))}return T(R)}}var Zj=ph&&1/wt(new ph([,-0]))[1]==Q?function(x){return new ph(x)}:Ov;function RT(x){return function(T){var R=Js(T);return R==Fe?qe(T):R==Je?mt(T):wn(T,x(T))}}function fl(x,T,R,G,te,pe,Me,Ge){var et=T&y;if(!et&&typeof x!="function")throw new Vn(a);var _t=G?G.length:0;if(_t||(T&=~(_|I),G=te=t),Me=Me===t?Me:ys(Un(Me),0),Ge=Ge===t?Ge:Un(Ge),_t-=te?te.length:0,T&I){var Tt=G,Nt=te;G=te=t}var Kt=et?t:mv(x),cn=[x,T,R,G,te,Tt,Nt,pe,Me,Ge];if(Kt&&dB(cn,Kt),x=cn[0],T=cn[1],R=cn[2],G=cn[3],te=cn[4],Ge=cn[9]=cn[9]===t?et?0:x.length:ys(cn[9]-_t,0),!Ge&&T&(b|w)&&(T&=~(b|w)),!T||T==g)var kn=Xj(x,T,R);else T==b||T==w?kn=Kj(x,T,Ge):(T==_||T==(g|_))&&!te.length?kn=Yj(x,T,R,G):kn=Xm.apply(t,cn);var Gn=Kt?dT:VT;return GT(Gn(kn,cn),x,T)}function DT(x,T,R,G){return x===t||ra(x,ri[R])&&!Jn.call(G,R)?T:x}function OT(x,T,R,G,te,pe){return Kr(x)&&Kr(T)&&(pe.set(T,x),Gm(x,T,t,OT,pe),pe.delete(T)),x}function Qj(x){return Jd(x)?t:x}function MT(x,T,R,G,te,pe){var Me=R&p,Ge=x.length,et=T.length;if(Ge!=et&&!(Me&&et>Ge))return!1;var _t=pe.get(x),Tt=pe.get(T);if(_t&&Tt)return _t==T&&Tt==x;var Nt=-1,Kt=!0,cn=R&m?new nc:t;for(pe.set(x,T),pe.set(T,x);++Nt<Ge;){var kn=x[Nt],Gn=T[Nt];if(G)var In=Me?G(Gn,kn,Nt,T,x,pe):G(kn,Gn,Nt,x,T,pe);if(In!==t){if(In)continue;Kt=!1;break}if(cn){if(!Wl(T,function(er,sr){if(!S(cn,sr)&&(kn===er||te(kn,er,R,G,pe)))return cn.push(sr)})){Kt=!1;break}}else if(!(kn===Gn||te(kn,Gn,R,G,pe))){Kt=!1;break}}return pe.delete(x),pe.delete(T),Kt}function Jj(x,T,R,G,te,pe,Me){switch(R){case ct:if(x.byteLength!=T.byteLength||x.byteOffset!=T.byteOffset)return!1;x=x.buffer,T=T.buffer;case ht:return!(x.byteLength!=T.byteLength||!pe(new Rm(x),new Rm(T)));case j:case W:case me:return ra(+x,+T);case ie:return x.name==T.name&&x.message==T.message;case tt:case xt:return x==T+"";case Fe:var Ge=qe;case Je:var et=G&p;if(Ge||(Ge=wt),x.size!=T.size&&!et)return!1;var _t=Me.get(x);if(_t)return _t==T;G|=m,Me.set(x,T);var Tt=MT(Ge(x),Ge(T),G,te,pe,Me);return Me.delete(x),Tt;case Pt:if(Gd)return Gd.call(x)==Gd.call(T)}return!1}function eB(x,T,R,G,te,pe){var Me=R&p,Ge=fv(x),et=Ge.length,_t=fv(T),Tt=_t.length;if(et!=Tt&&!Me)return!1;for(var Nt=et;Nt--;){var Kt=Ge[Nt];if(!(Me?Kt in T:Jn.call(T,Kt)))return!1}var cn=pe.get(x),kn=pe.get(T);if(cn&&kn)return cn==T&&kn==x;var Gn=!0;pe.set(x,T),pe.set(T,x);for(var In=Me;++Nt<et;){Kt=Ge[Nt];var er=x[Kt],sr=T[Kt];if(G)var ii=Me?G(sr,er,Kt,T,x,pe):G(er,sr,Kt,x,T,pe);if(!(ii===t?er===sr||te(er,sr,R,G,pe):ii)){Gn=!1;break}In||(In=Kt=="constructor")}if(Gn&&!In){var go=x.constructor,ai=T.constructor;go!=ai&&"constructor"in x&&"constructor"in T&&!(typeof go=="function"&&go instanceof go&&typeof ai=="function"&&ai instanceof ai)&&(Gn=!1)}return pe.delete(x),pe.delete(T),Gn}function pl(x){return wv(UT(x,t,YT),x+"")}function fv(x){return tT(x,As,yv)}function pv(x){return tT(x,Ao,FT)}var mv=Pm?function(x){return Pm.get(x)}:Ov;function Qm(x){for(var T=x.name+"",R=mh[T],G=Jn.call(mh,T)?R.length:0;G--;){var te=R[G],pe=te.func;if(pe==null||pe==x)return te.name}return T}function bh(x){var T=Jn.call(de,"placeholder")?de:x;return T.placeholder}function Sn(){var x=de.iteratee||Rv;return x=x===Rv?sT:x,arguments.length?x(arguments[0],arguments[1]):x}function Jm(x,T){var R=x.__data__;return lB(T)?R[typeof T=="string"?"string":"hash"]:R.map}function gv(x){for(var T=As(x),R=T.length;R--;){var G=T[R],te=x[G];T[R]=[G,te,jT(te)]}return T}function oc(x,T){var R=se(x,T);return rT(R)?R:t}function tB(x){var T=Jn.call(x,ec),R=x[ec];try{x[ec]=t;var G=!0}catch{}var te=ql.call(x);return G&&(T?x[ec]=R:delete x[ec]),te}var yv=G1?function(x){return x==null?[]:(x=Tn(x),ni(G1(x),function(T){return z_.call(x,T)}))}:Mv,FT=G1?function(x){for(var T=[];x;)Co(T,yv(x)),x=Dm(x);return T}:Mv,Js=po;(W1&&Js(new W1(new ArrayBuffer(1)))!=ct||Ud&&Js(new Ud)!=Fe||H1&&Js(H1.resolve())!=Ne||ph&&Js(new ph)!=Je||zd&&Js(new zd)!=St)&&(Js=function(x){var T=po(x),R=T==De?x.constructor:t,G=R?ic(R):"";if(G)switch(G){case L4:return ct;case P4:return Fe;case j4:return Ne;case B4:return Je;case U4:return St}return T});function nB(x,T,R){for(var G=-1,te=R.length;++G<te;){var pe=R[G],Me=pe.size;switch(pe.type){case"drop":x+=Me;break;case"dropRight":T-=Me;break;case"take":T=Qs(T,x+Me);break;case"takeRight":x=ys(x,T-Me);break}}return{start:x,end:T}}function rB(x){var T=x.match(cr);return T?T[1].split(as):[]}function LT(x,T,R){T=Zl(T,x);for(var G=-1,te=T.length,pe=!1;++G<te;){var Me=Ma(T[G]);if(!(pe=x!=null&&R(x,Me)))break;x=x[Me]}return pe||++G!=te?pe:(te=x==null?0:x.length,!!te&&ig(te)&&ml(Me,te)&&(Ln(x)||ac(x)))}function sB(x){var T=x.length,R=new x.constructor(T);return T&&typeof x[0]=="string"&&Jn.call(x,"index")&&(R.index=x.index,R.input=x.input),R}function PT(x){return typeof x.constructor=="function"&&!Zd(x)?gh(Dm(x)):{}}function oB(x,T,R){var G=x.constructor;switch(T){case ht:return cv(x);case j:case W:return new G(+x);case ct:return zj(x,R);case At:case Ft:case Be:case qt:case Y:case le:case ee:case ue:case Ae:return xT(x,R);case Fe:return new G;case me:case xt:return new G(x);case tt:return Vj(x);case Je:return new G;case Pt:return Gj(x)}}function iB(x,T){var R=T.length;if(!R)return x;var G=R-1;return T[G]=(R>1?"& ":"")+T[G],T=T.join(R>2?", ":" "),x.replace(gi,`{
/* [wrapped with `+T+`] */
`)}function aB(x){return Ln(x)||ac(x)||!!(V_&&x&&x[V_])}function ml(x,T){var R=typeof x;return T=T==null?K:T,!!T&&(R=="number"||R!="symbol"&&yt.test(x))&&x>-1&&x%1==0&&x<T}function mo(x,T,R){if(!Kr(R))return!1;var G=typeof T;return(G=="number"?No(R)&&ml(T,R.length):G=="string"&&T in R)?ra(R[T],x):!1}function vv(x,T){if(Ln(x))return!1;var R=typeof x;return R=="number"||R=="symbol"||R=="boolean"||x==null||oi(x)?!0:Ps.test(x)||!jn.test(x)||T!=null&&x in Tn(T)}function lB(x){var T=typeof x;return T=="string"||T=="number"||T=="symbol"||T=="boolean"?x!=="__proto__":x===null}function bv(x){var T=Qm(x),R=de[T];if(typeof R!="function"||!(T in tr.prototype))return!1;if(x===R)return!0;var G=mv(R);return!!G&&x===G[0]}function uB(x){return!!jd&&jd in x}var cB=_i?gl:Fv;function Zd(x){var T=x&&x.constructor,R=typeof T=="function"&&T.prototype||ri;return x===R}function jT(x){return x===x&&!Kr(x)}function BT(x,T){return function(R){return R==null?!1:R[x]===T&&(T!==t||x in Tn(R))}}function hB(x){var T=sg(x,function(G){return R.size===u&&R.clear(),G}),R=T.cache;return T}function dB(x,T){var R=x[1],G=T[1],te=R|G,pe=te<(g|y|C),Me=G==C&&R==b||G==C&&R==N&&x[7].length<=T[8]||G==(C|N)&&T[7].length<=T[8]&&R==b;if(!(pe||Me))return x;G&g&&(x[2]=T[2],te|=R&g?0:v);var Ge=T[3];if(Ge){var et=x[3];x[3]=et?ST(et,Ge,T[4]):Ge,x[4]=et?$t(x[3],h):T[4]}return Ge=T[5],Ge&&(et=x[5],x[5]=et?_T(et,Ge,T[6]):Ge,x[6]=et?$t(x[5],h):T[6]),Ge=T[7],Ge&&(x[7]=Ge),G&C&&(x[8]=x[8]==null?T[8]:Qs(x[8],T[8])),x[9]==null&&(x[9]=T[9]),x[0]=T[0],x[1]=te,x}function fB(x){var T=[];if(x!=null)for(var R in Tn(x))T.push(R);return T}function pB(x){return ql.call(x)}function UT(x,T,R){return T=ys(T===t?x.length-1:T,0),function(){for(var G=arguments,te=-1,pe=ys(G.length-T,0),Me=nt(pe);++te<pe;)Me[te]=G[T+te];te=-1;for(var Ge=nt(T+1);++te<T;)Ge[te]=G[te];return Ge[T]=R(Me),Ns(x,this,Ge)}}function zT(x,T){return T.length<2?x:sc(x,Ii(T,0,-1))}function mB(x,T){for(var R=x.length,G=Qs(T.length,R),te=$o(x);G--;){var pe=T[G];x[G]=ml(pe,R)?te[pe]:t}return x}function xv(x,T){if(!(T==="constructor"&&typeof x[T]=="function")&&T!="__proto__")return x[T]}var VT=WT(dT),Qd=N4||function(x,T){return gr.setTimeout(x,T)},wv=WT(Pj);function GT(x,T,R){var G=T+"";return wv(x,iB(G,gB(rB(G),R)))}function WT(x){var T=0,R=0;return function(){var G=O4(),te=F-(G-R);if(R=G,te>0){if(++T>=P)return arguments[0]}else T=0;return x.apply(t,arguments)}}function eg(x,T){var R=-1,G=x.length,te=G-1;for(T=T===t?G:T;++R<T;){var pe=rv(R,te),Me=x[pe];x[pe]=x[R],x[R]=Me}return x.length=T,x}var HT=hB(function(x){var T=[];return x.charCodeAt(0)===46&&T.push(""),x.replace(ms,function(R,G,te,pe){T.push(te?pe.replace(ho,"$1"):G||R)}),T});function Ma(x){if(typeof x=="string"||oi(x))return x;var T=x+"";return T=="0"&&1/x==-Q?"-0":T}function ic(x){if(x!=null){try{return zs.call(x)}catch{}try{return x+""}catch{}}return""}function gB(x,T){return Us(ye,function(R){var G="_."+R[0];T&R[1]&&!ul(x,G)&&x.push(G)}),x.sort()}function qT(x){if(x instanceof tr)return x.clone();var T=new Ti(x.__wrapped__,x.__chain__);return T.__actions__=$o(x.__actions__),T.__index__=x.__index__,T.__values__=x.__values__,T}function yB(x,T,R){(R?mo(x,T,R):T===t)?T=1:T=ys(Un(T),0);var G=x==null?0:x.length;if(!G||T<1)return[];for(var te=0,pe=0,Me=nt(Fm(G/T));te<G;)Me[pe++]=Ii(x,te,te+=T);return Me}function vB(x){for(var T=-1,R=x==null?0:x.length,G=0,te=[];++T<R;){var pe=x[T];pe&&(te[G++]=pe)}return te}function bB(){var x=arguments.length;if(!x)return[];for(var T=nt(x-1),R=arguments[0],G=x;G--;)T[G-1]=arguments[G];return Co(Ln(R)?$o(R):[R],Vs(T,1))}var xB=Xn(function(x,T){return rs(x)?Hd(x,Vs(T,1,rs,!0)):[]}),wB=Xn(function(x,T){var R=Ei(T);return rs(R)&&(R=t),rs(x)?Hd(x,Vs(T,1,rs,!0),Sn(R,2)):[]}),SB=Xn(function(x,T){var R=Ei(T);return rs(R)&&(R=t),rs(x)?Hd(x,Vs(T,1,rs,!0),t,R):[]});function _B(x,T,R){var G=x==null?0:x.length;return G?(T=R||T===t?1:Un(T),Ii(x,T<0?0:T,G)):[]}function TB(x,T,R){var G=x==null?0:x.length;return G?(T=R||T===t?1:Un(T),T=G-T,Ii(x,0,T<0?0:T)):[]}function kB(x,T){return x&&x.length?Hm(x,Sn(T,3),!0,!0):[]}function IB(x,T){return x&&x.length?Hm(x,Sn(T,3),!0):[]}function EB(x,T,R,G){var te=x==null?0:x.length;return te?(R&&typeof R!="number"&&mo(x,T,R)&&(R=0,G=te),bj(x,T,R,G)):[]}function XT(x,T,R){var G=x==null?0:x.length;if(!G)return-1;var te=R==null?0:Un(R);return te<0&&(te=ys(G+te,0)),$(x,Sn(T,3),te)}function KT(x,T,R){var G=x==null?0:x.length;if(!G)return-1;var te=G-1;return R!==t&&(te=Un(R),te=R<0?ys(G+te,0):Qs(te,G-1)),$(x,Sn(T,3),te,!0)}function YT(x){var T=x==null?0:x.length;return T?Vs(x,1):[]}function CB(x){var T=x==null?0:x.length;return T?Vs(x,Q):[]}function $B(x,T){var R=x==null?0:x.length;return R?(T=T===t?1:Un(T),Vs(x,T)):[]}function NB(x){for(var T=-1,R=x==null?0:x.length,G={};++T<R;){var te=x[T];G[te[0]]=te[1]}return G}function ZT(x){return x&&x.length?x[0]:t}function AB(x,T,R){var G=x==null?0:x.length;if(!G)return-1;var te=R==null?0:Un(R);return te<0&&(te=ys(G+te,0)),U(x,T,te)}function RB(x){var T=x==null?0:x.length;return T?Ii(x,0,-1):[]}var DB=Xn(function(x){var T=Sr(x,lv);return T.length&&T[0]===x[0]?Q1(T):[]}),OB=Xn(function(x){var T=Ei(x),R=Sr(x,lv);return T===Ei(R)?T=t:R.pop(),R.length&&R[0]===x[0]?Q1(R,Sn(T,2)):[]}),MB=Xn(function(x){var T=Ei(x),R=Sr(x,lv);return T=typeof T=="function"?T:t,T&&R.pop(),R.length&&R[0]===x[0]?Q1(R,t,T):[]});function FB(x,T){return x==null?"":R4.call(x,T)}function Ei(x){var T=x==null?0:x.length;return T?x[T-1]:t}function LB(x,T,R){var G=x==null?0:x.length;if(!G)return-1;var te=G;return R!==t&&(te=Un(R),te=te<0?ys(G+te,0):Qs(te,G-1)),T===T?dt(x,T,te):$(x,oe,te,!0)}function PB(x,T){return x&&x.length?lT(x,Un(T)):t}var jB=Xn(QT);function QT(x,T){return x&&x.length&&T&&T.length?nv(x,T):x}function BB(x,T,R){return x&&x.length&&T&&T.length?nv(x,T,Sn(R,2)):x}function UB(x,T,R){return x&&x.length&&T&&T.length?nv(x,T,t,R):x}var zB=pl(function(x,T){var R=x==null?0:x.length,G=X1(x,T);return hT(x,Sr(T,function(te){return ml(te,R)?+te:te}).sort(wT)),G});function VB(x,T){var R=[];if(!(x&&x.length))return R;var G=-1,te=[],pe=x.length;for(T=Sn(T,3);++G<pe;){var Me=x[G];T(Me,G,x)&&(R.push(Me),te.push(G))}return hT(x,te),R}function Sv(x){return x==null?x:F4.call(x)}function GB(x,T,R){var G=x==null?0:x.length;return G?(R&&typeof R!="number"&&mo(x,T,R)?(T=0,R=G):(T=T==null?0:Un(T),R=R===t?G:Un(R)),Ii(x,T,R)):[]}function WB(x,T){return Wm(x,T)}function HB(x,T,R){return ov(x,T,Sn(R,2))}function qB(x,T){var R=x==null?0:x.length;if(R){var G=Wm(x,T);if(G<R&&ra(x[G],T))return G}return-1}function XB(x,T){return Wm(x,T,!0)}function KB(x,T,R){return ov(x,T,Sn(R,2),!0)}function YB(x,T){var R=x==null?0:x.length;if(R){var G=Wm(x,T,!0)-1;if(ra(x[G],T))return G}return-1}function ZB(x){return x&&x.length?fT(x):[]}function QB(x,T){return x&&x.length?fT(x,Sn(T,2)):[]}function JB(x){var T=x==null?0:x.length;return T?Ii(x,1,T):[]}function e5(x,T,R){return x&&x.length?(T=R||T===t?1:Un(T),Ii(x,0,T<0?0:T)):[]}function t5(x,T,R){var G=x==null?0:x.length;return G?(T=R||T===t?1:Un(T),T=G-T,Ii(x,T<0?0:T,G)):[]}function n5(x,T){return x&&x.length?Hm(x,Sn(T,3),!1,!0):[]}function r5(x,T){return x&&x.length?Hm(x,Sn(T,3)):[]}var s5=Xn(function(x){return Yl(Vs(x,1,rs,!0))}),o5=Xn(function(x){var T=Ei(x);return rs(T)&&(T=t),Yl(Vs(x,1,rs,!0),Sn(T,2))}),i5=Xn(function(x){var T=Ei(x);return T=typeof T=="function"?T:t,Yl(Vs(x,1,rs,!0),t,T)});function a5(x){return x&&x.length?Yl(x):[]}function l5(x,T){return x&&x.length?Yl(x,Sn(T,2)):[]}function u5(x,T){return T=typeof T=="function"?T:t,x&&x.length?Yl(x,t,T):[]}function _v(x){if(!(x&&x.length))return[];var T=0;return x=ni(x,function(R){if(rs(R))return T=ys(R.length,T),!0}),jt(T,function(R){return Sr(x,Ce(R))})}function JT(x,T){if(!(x&&x.length))return[];var R=_v(x);return T==null?R:Sr(R,function(G){return Ns(T,t,G)})}var c5=Xn(function(x,T){return rs(x)?Hd(x,T):[]}),h5=Xn(function(x){return av(ni(x,rs))}),d5=Xn(function(x){var T=Ei(x);return rs(T)&&(T=t),av(ni(x,rs),Sn(T,2))}),f5=Xn(function(x){var T=Ei(x);return T=typeof T=="function"?T:t,av(ni(x,rs),t,T)}),p5=Xn(_v);function m5(x,T){return yT(x||[],T||[],Wd)}function g5(x,T){return yT(x||[],T||[],Kd)}var y5=Xn(function(x){var T=x.length,R=T>1?x[T-1]:t;return R=typeof R=="function"?(x.pop(),R):t,JT(x,R)});function ek(x){var T=de(x);return T.__chain__=!0,T}function v5(x,T){return T(x),x}function tg(x,T){return T(x)}var b5=pl(function(x){var T=x.length,R=T?x[0]:0,G=this.__wrapped__,te=function(pe){return X1(pe,x)};return T>1||this.__actions__.length||!(G instanceof tr)||!ml(R)?this.thru(te):(G=G.slice(R,+R+(T?1:0)),G.__actions__.push({func:tg,args:[te],thisArg:t}),new Ti(G,this.__chain__).thru(function(pe){return T&&!pe.length&&pe.push(t),pe}))});function x5(){return ek(this)}function w5(){return new Ti(this.value(),this.__chain__)}function S5(){this.__values__===t&&(this.__values__=pk(this.value()));var x=this.__index__>=this.__values__.length,T=x?t:this.__values__[this.__index__++];return{done:x,value:T}}function _5(){return this}function T5(x){for(var T,R=this;R instanceof Bm;){var G=qT(R);G.__index__=0,G.__values__=t,T?te.__wrapped__=G:T=G;var te=G;R=R.__wrapped__}return te.__wrapped__=x,T}function k5(){var x=this.__wrapped__;if(x instanceof tr){var T=x;return this.__actions__.length&&(T=new tr(this)),T=T.reverse(),T.__actions__.push({func:tg,args:[Sv],thisArg:t}),new Ti(T,this.__chain__)}return this.thru(Sv)}function I5(){return gT(this.__wrapped__,this.__actions__)}var E5=qm(function(x,T,R){Jn.call(x,R)?++x[R]:dl(x,R,1)});function C5(x,T,R){var G=Ln(x)?Gl:vj;return R&&mo(x,T,R)&&(T=t),G(x,Sn(T,3))}function $5(x,T){var R=Ln(x)?ni:J_;return R(x,Sn(T,3))}var N5=ET(XT),A5=ET(KT);function R5(x,T){return Vs(ng(x,T),1)}function D5(x,T){return Vs(ng(x,T),Q)}function O5(x,T,R){return R=R===t?1:Un(R),Vs(ng(x,T),R)}function tk(x,T){var R=Ln(x)?Us:Kl;return R(x,Sn(T,3))}function nk(x,T){var R=Ln(x)?fh:Q_;return R(x,Sn(T,3))}var M5=qm(function(x,T,R){Jn.call(x,R)?x[R].push(T):dl(x,R,[T])});function F5(x,T,R,G){x=No(x)?x:wh(x),R=R&&!G?Un(R):0;var te=x.length;return R<0&&(R=ys(te+R,0)),ag(x)?R<=te&&x.indexOf(T,R)>-1:!!te&&U(x,T,R)>-1}var L5=Xn(function(x,T,R){var G=-1,te=typeof T=="function",pe=No(x)?nt(x.length):[];return Kl(x,function(Me){pe[++G]=te?Ns(T,Me,R):qd(Me,T,R)}),pe}),P5=qm(function(x,T,R){dl(x,R,T)});function ng(x,T){var R=Ln(x)?Sr:oT;return R(x,Sn(T,3))}function j5(x,T,R,G){return x==null?[]:(Ln(T)||(T=T==null?[]:[T]),R=G?t:R,Ln(R)||(R=R==null?[]:[R]),uT(x,T,R))}var B5=qm(function(x,T,R){x[R?0:1].push(T)},function(){return[[],[]]});function U5(x,T,R){var G=Ln(x)?Aa:He,te=arguments.length<3;return G(x,Sn(T,4),R,te,Kl)}function z5(x,T,R){var G=Ln(x)?Ra:He,te=arguments.length<3;return G(x,Sn(T,4),R,te,Q_)}function V5(x,T){var R=Ln(x)?ni:J_;return R(x,og(Sn(T,3)))}function G5(x){var T=Ln(x)?X_:Fj;return T(x)}function W5(x,T,R){(R?mo(x,T,R):T===t)?T=1:T=Un(T);var G=Ln(x)?fj:Lj;return G(x,T)}function H5(x){var T=Ln(x)?pj:jj;return T(x)}function q5(x){if(x==null)return 0;if(No(x))return ag(x)?Zt(x):x.length;var T=Js(x);return T==Fe||T==Je?x.size:ev(x).length}function X5(x,T,R){var G=Ln(x)?Wl:Bj;return R&&mo(x,T,R)&&(T=t),G(x,Sn(T,3))}var K5=Xn(function(x,T){if(x==null)return[];var R=T.length;return R>1&&mo(x,T[0],T[1])?T=[]:R>2&&mo(T[0],T[1],T[2])&&(T=[T[0]]),uT(x,Vs(T,1),[])}),rg=$4||function(){return gr.Date.now()};function Y5(x,T){if(typeof T!="function")throw new Vn(a);return x=Un(x),function(){if(--x<1)return T.apply(this,arguments)}}function rk(x,T,R){return T=R?t:T,T=x&&T==null?x.length:T,fl(x,C,t,t,t,t,T)}function sk(x,T){var R;if(typeof T!="function")throw new Vn(a);return x=Un(x),function(){return--x>0&&(R=T.apply(this,arguments)),x<=1&&(T=t),R}}var Tv=Xn(function(x,T,R){var G=g;if(R.length){var te=$t(R,bh(Tv));G|=_}return fl(x,G,T,R,te)}),ok=Xn(function(x,T,R){var G=g|y;if(R.length){var te=$t(R,bh(ok));G|=_}return fl(T,G,x,R,te)});function ik(x,T,R){T=R?t:T;var G=fl(x,b,t,t,t,t,t,T);return G.placeholder=ik.placeholder,G}function ak(x,T,R){T=R?t:T;var G=fl(x,w,t,t,t,t,t,T);return G.placeholder=ak.placeholder,G}function lk(x,T,R){var G,te,pe,Me,Ge,et,_t=0,Tt=!1,Nt=!1,Kt=!0;if(typeof x!="function")throw new Vn(a);T=Ci(T)||0,Kr(R)&&(Tt=!!R.leading,Nt="maxWait"in R,pe=Nt?ys(Ci(R.maxWait)||0,T):pe,Kt="trailing"in R?!!R.trailing:Kt);function cn(ss){var sa=G,vl=te;return G=te=t,_t=ss,Me=x.apply(vl,sa),Me}function kn(ss){return _t=ss,Ge=Qd(er,T),Tt?cn(ss):Me}function Gn(ss){var sa=ss-et,vl=ss-_t,Ek=T-sa;return Nt?Qs(Ek,pe-vl):Ek}function In(ss){var sa=ss-et,vl=ss-_t;return et===t||sa>=T||sa<0||Nt&&vl>=pe}function er(){var ss=rg();if(In(ss))return sr(ss);Ge=Qd(er,Gn(ss))}function sr(ss){return Ge=t,Kt&&G?cn(ss):(G=te=t,Me)}function ii(){Ge!==t&&vT(Ge),_t=0,G=et=te=Ge=t}function go(){return Ge===t?Me:sr(rg())}function ai(){var ss=rg(),sa=In(ss);if(G=arguments,te=this,et=ss,sa){if(Ge===t)return kn(et);if(Nt)return vT(Ge),Ge=Qd(er,T),cn(et)}return Ge===t&&(Ge=Qd(er,T)),Me}return ai.cancel=ii,ai.flush=go,ai}var Z5=Xn(function(x,T){return Z_(x,1,T)}),Q5=Xn(function(x,T,R){return Z_(x,Ci(T)||0,R)});function J5(x){return fl(x,O)}function sg(x,T){if(typeof x!="function"||T!=null&&typeof T!="function")throw new Vn(a);var R=function(){var G=arguments,te=T?T.apply(this,G):G[0],pe=R.cache;if(pe.has(te))return pe.get(te);var Me=x.apply(this,G);return R.cache=pe.set(te,Me)||pe,Me};return R.cache=new(sg.Cache||hl),R}sg.Cache=hl;function og(x){if(typeof x!="function")throw new Vn(a);return function(){var T=arguments;switch(T.length){case 0:return!x.call(this);case 1:return!x.call(this,T[0]);case 2:return!x.call(this,T[0],T[1]);case 3:return!x.call(this,T[0],T[1],T[2])}return!x.apply(this,T)}}function eU(x){return sk(2,x)}var tU=Uj(function(x,T){T=T.length==1&&Ln(T[0])?Sr(T[0],It(Sn())):Sr(Vs(T,1),It(Sn()));var R=T.length;return Xn(function(G){for(var te=-1,pe=Qs(G.length,R);++te<pe;)G[te]=T[te].call(this,G[te]);return Ns(x,this,G)})}),kv=Xn(function(x,T){var R=$t(T,bh(kv));return fl(x,_,t,T,R)}),uk=Xn(function(x,T){var R=$t(T,bh(uk));return fl(x,I,t,T,R)}),nU=pl(function(x,T){return fl(x,N,t,t,t,T)});function rU(x,T){if(typeof x!="function")throw new Vn(a);return T=T===t?T:Un(T),Xn(x,T)}function sU(x,T){if(typeof x!="function")throw new Vn(a);return T=T==null?0:ys(Un(T),0),Xn(function(R){var G=R[T],te=Ql(R,0,T);return G&&Co(te,G),Ns(x,this,te)})}function oU(x,T,R){var G=!0,te=!0;if(typeof x!="function")throw new Vn(a);return Kr(R)&&(G="leading"in R?!!R.leading:G,te="trailing"in R?!!R.trailing:te),lk(x,T,{leading:G,maxWait:T,trailing:te})}function iU(x){return rk(x,1)}function aU(x,T){return kv(uv(T),x)}function lU(){if(!arguments.length)return[];var x=arguments[0];return Ln(x)?x:[x]}function uU(x){return ki(x,f)}function cU(x,T){return T=typeof T=="function"?T:t,ki(x,f,T)}function hU(x){return ki(x,d|f)}function dU(x,T){return T=typeof T=="function"?T:t,ki(x,d|f,T)}function fU(x,T){return T==null||Y_(x,T,As(T))}function ra(x,T){return x===T||x!==x&&T!==T}var pU=Zm(Z1),mU=Zm(function(x,T){return x>=T}),ac=nT(function(){return arguments}())?nT:function(x){return Zr(x)&&Jn.call(x,"callee")&&!z_.call(x,"callee")},Ln=nt.isArray,gU=Yu?It(Yu):Tj;function No(x){return x!=null&&ig(x.length)&&!gl(x)}function rs(x){return Zr(x)&&No(x)}function yU(x){return x===!0||x===!1||Zr(x)&&po(x)==j}var Jl=A4||Fv,vU=Vl?It(Vl):kj;function bU(x){return Zr(x)&&x.nodeType===1&&!Jd(x)}function xU(x){if(x==null)return!0;if(No(x)&&(Ln(x)||typeof x=="string"||typeof x.splice=="function"||Jl(x)||xh(x)||ac(x)))return!x.length;var T=Js(x);if(T==Fe||T==Je)return!x.size;if(Zd(x))return!ev(x).length;for(var R in x)if(Jn.call(x,R))return!1;return!0}function wU(x,T){return Xd(x,T)}function SU(x,T,R){R=typeof R=="function"?R:t;var G=R?R(x,T):t;return G===t?Xd(x,T,t,R):!!G}function Iv(x){if(!Zr(x))return!1;var T=po(x);return T==ie||T==J||typeof x.message=="string"&&typeof x.name=="string"&&!Jd(x)}function _U(x){return typeof x=="number"&&G_(x)}function gl(x){if(!Kr(x))return!1;var T=po(x);return T==ve||T==he||T==Ee||T==rt}function ck(x){return typeof x=="number"&&x==Un(x)}function ig(x){return typeof x=="number"&&x>-1&&x%1==0&&x<=K}function Kr(x){var T=typeof x;return x!=null&&(T=="object"||T=="function")}function Zr(x){return x!=null&&typeof x=="object"}var hk=Zu?It(Zu):Ej;function TU(x,T){return x===T||J1(x,T,gv(T))}function kU(x,T,R){return R=typeof R=="function"?R:t,J1(x,T,gv(T),R)}function IU(x){return dk(x)&&x!=+x}function EU(x){if(cB(x))throw new Ht(o);return rT(x)}function CU(x){return x===null}function $U(x){return x==null}function dk(x){return typeof x=="number"||Zr(x)&&po(x)==me}function Jd(x){if(!Zr(x)||po(x)!=De)return!1;var T=Dm(x);if(T===null)return!0;var R=Jn.call(T,"constructor")&&T.constructor;return typeof R=="function"&&R instanceof R&&zs.call(R)==k4}var Ev=Qu?It(Qu):Cj;function NU(x){return ck(x)&&x>=-K&&x<=K}var fk=al?It(al):$j;function ag(x){return typeof x=="string"||!Ln(x)&&Zr(x)&&po(x)==xt}function oi(x){return typeof x=="symbol"||Zr(x)&&po(x)==Pt}var xh=ll?It(ll):Nj;function AU(x){return x===t}function RU(x){return Zr(x)&&Js(x)==St}function DU(x){return Zr(x)&&po(x)==Jt}var OU=Zm(tv),MU=Zm(function(x,T){return x<=T});function pk(x){if(!x)return[];if(No(x))return ag(x)?zt(x):$o(x);if(Bd&&x[Bd])return je(x[Bd]());var T=Js(x),R=T==Fe?qe:T==Je?wt:wh;return R(x)}function yl(x){if(!x)return x===0?x:0;if(x=Ci(x),x===Q||x===-Q){var T=x<0?-1:1;return T*ne}return x===x?x:0}function Un(x){var T=yl(x),R=T%1;return T===T?R?T-R:T:0}function mk(x){return x?rc(Un(x),0,ce):0}function Ci(x){if(typeof x=="number")return x;if(oi(x))return re;if(Kr(x)){var T=typeof x.valueOf=="function"?x.valueOf():x;x=Kr(T)?T+"":T}if(typeof x!="string")return x===0?x:+x;x=on(x);var R=Lt.test(x);return R||Xt.test(x)?Qo(x.slice(2),R?2:8):gt.test(x)?re:+x}function gk(x){return Oa(x,Ao(x))}function FU(x){return x?rc(Un(x),-K,K):x===0?x:0}function yr(x){return x==null?"":si(x)}var LU=yh(function(x,T){if(Zd(T)||No(T)){Oa(T,As(T),x);return}for(var R in T)Jn.call(T,R)&&Wd(x,R,T[R])}),yk=yh(function(x,T){Oa(T,Ao(T),x)}),lg=yh(function(x,T,R,G){Oa(T,Ao(T),x,G)}),PU=yh(function(x,T,R,G){Oa(T,As(T),x,G)}),jU=pl(X1);function BU(x,T){var R=gh(x);return T==null?R:K_(R,T)}var UU=Xn(function(x,T){x=Tn(x);var R=-1,G=T.length,te=G>2?T[2]:t;for(te&&mo(T[0],T[1],te)&&(G=1);++R<G;)for(var pe=T[R],Me=Ao(pe),Ge=-1,et=Me.length;++Ge<et;){var _t=Me[Ge],Tt=x[_t];(Tt===t||ra(Tt,ri[_t])&&!Jn.call(x,_t))&&(x[_t]=pe[_t])}return x}),zU=Xn(function(x){return x.push(t,OT),Ns(vk,t,x)});function VU(x,T){return Ju(x,Sn(T,3),Da)}function GU(x,T){return Ju(x,Sn(T,3),Y1)}function WU(x,T){return x==null?x:K1(x,Sn(T,3),Ao)}function HU(x,T){return x==null?x:eT(x,Sn(T,3),Ao)}function qU(x,T){return x&&Da(x,Sn(T,3))}function XU(x,T){return x&&Y1(x,Sn(T,3))}function KU(x){return x==null?[]:Vm(x,As(x))}function YU(x){return x==null?[]:Vm(x,Ao(x))}function Cv(x,T,R){var G=x==null?t:sc(x,T);return G===t?R:G}function ZU(x,T){return x!=null&&LT(x,T,xj)}function $v(x,T){return x!=null&&LT(x,T,wj)}var QU=$T(function(x,T,R){T!=null&&typeof T.toString!="function"&&(T=ql.call(T)),x[T]=R},Av(Ro)),JU=$T(function(x,T,R){T!=null&&typeof T.toString!="function"&&(T=ql.call(T)),Jn.call(x,T)?x[T].push(R):x[T]=[R]},Sn),ez=Xn(qd);function As(x){return No(x)?q_(x):ev(x)}function Ao(x){return No(x)?q_(x,!0):Aj(x)}function tz(x,T){var R={};return T=Sn(T,3),Da(x,function(G,te,pe){dl(R,T(G,te,pe),G)}),R}function nz(x,T){var R={};return T=Sn(T,3),Da(x,function(G,te,pe){dl(R,te,T(G,te,pe))}),R}var rz=yh(function(x,T,R){Gm(x,T,R)}),vk=yh(function(x,T,R,G){Gm(x,T,R,G)}),sz=pl(function(x,T){var R={};if(x==null)return R;var G=!1;T=Sr(T,function(pe){return pe=Zl(pe,x),G||(G=pe.length>1),pe}),Oa(x,pv(x),R),G&&(R=ki(R,d|c|f,Qj));for(var te=T.length;te--;)iv(R,T[te]);return R});function oz(x,T){return bk(x,og(Sn(T)))}var iz=pl(function(x,T){return x==null?{}:Dj(x,T)});function bk(x,T){if(x==null)return{};var R=Sr(pv(x),function(G){return[G]});return T=Sn(T),cT(x,R,function(G,te){return T(G,te[0])})}function az(x,T,R){T=Zl(T,x);var G=-1,te=T.length;for(te||(te=1,x=t);++G<te;){var pe=x==null?t:x[Ma(T[G])];pe===t&&(G=te,pe=R),x=gl(pe)?pe.call(x):pe}return x}function lz(x,T,R){return x==null?x:Kd(x,T,R)}function uz(x,T,R,G){return G=typeof G=="function"?G:t,x==null?x:Kd(x,T,R,G)}var xk=RT(As),wk=RT(Ao);function cz(x,T,R){var G=Ln(x),te=G||Jl(x)||xh(x);if(T=Sn(T,4),R==null){var pe=x&&x.constructor;te?R=G?new pe:[]:Kr(x)?R=gl(pe)?gh(Dm(x)):{}:R={}}return(te?Us:Da)(x,function(Me,Ge,et){return T(R,Me,Ge,et)}),R}function hz(x,T){return x==null?!0:iv(x,T)}function dz(x,T,R){return x==null?x:mT(x,T,uv(R))}function fz(x,T,R,G){return G=typeof G=="function"?G:t,x==null?x:mT(x,T,uv(R),G)}function wh(x){return x==null?[]:bn(x,As(x))}function pz(x){return x==null?[]:bn(x,Ao(x))}function mz(x,T,R){return R===t&&(R=T,T=t),R!==t&&(R=Ci(R),R=R===R?R:0),T!==t&&(T=Ci(T),T=T===T?T:0),rc(Ci(x),T,R)}function gz(x,T,R){return T=yl(T),R===t?(R=T,T=0):R=yl(R),x=Ci(x),Sj(x,T,R)}function yz(x,T,R){if(R&&typeof R!="boolean"&&mo(x,T,R)&&(T=R=t),R===t&&(typeof T=="boolean"?(R=T,T=t):typeof x=="boolean"&&(R=x,x=t)),x===t&&T===t?(x=0,T=1):(x=yl(x),T===t?(T=x,x=0):T=yl(T)),x>T){var G=x;x=T,T=G}if(R||x%1||T%1){var te=W_();return Qs(x+te*(T-x+Zs("1e-"+((te+"").length-1))),T)}return rv(x,T)}var vz=vh(function(x,T,R){return T=T.toLowerCase(),x+(R?Sk(T):T)});function Sk(x){return Nv(yr(x).toLowerCase())}function _k(x){return x=yr(x),x&&x.replace(_n,L).replace(zl,"")}function bz(x,T,R){x=yr(x),T=si(T);var G=x.length;R=R===t?G:rc(Un(R),0,G);var te=R;return R-=T.length,R>=0&&x.slice(R,te)==T}function xz(x){return x=yr(x),x&&dn.test(x)?x.replace(Mt,V):x}function wz(x){return x=yr(x),x&&Ho.test(x)?x.replace(Es,"\\$&"):x}var Sz=vh(function(x,T,R){return x+(R?"-":"")+T.toLowerCase()}),_z=vh(function(x,T,R){return x+(R?" ":"")+T.toLowerCase()}),Tz=IT("toLowerCase");function kz(x,T,R){x=yr(x),T=Un(T);var G=T?Zt(x):0;if(!T||G>=T)return x;var te=(T-G)/2;return Ym(Lm(te),R)+x+Ym(Fm(te),R)}function Iz(x,T,R){x=yr(x),T=Un(T);var G=T?Zt(x):0;return T&&G<T?x+Ym(T-G,R):x}function Ez(x,T,R){x=yr(x),T=Un(T);var G=T?Zt(x):0;return T&&G<T?Ym(T-G,R)+x:x}function Cz(x,T,R){return R||T==null?T=0:T&&(T=+T),M4(yr(x).replace(zr,""),T||0)}function $z(x,T,R){return(R?mo(x,T,R):T===t)?T=1:T=Un(T),sv(yr(x),T)}function Nz(){var x=arguments,T=yr(x[0]);return x.length<3?T:T.replace(x[1],x[2])}var Az=vh(function(x,T,R){return x+(R?"_":"")+T.toLowerCase()});function Rz(x,T,R){return R&&typeof R!="number"&&mo(x,T,R)&&(T=R=t),R=R===t?ce:R>>>0,R?(x=yr(x),x&&(typeof T=="string"||T!=null&&!Ev(T))&&(T=si(T),!T&&ae(x))?Ql(zt(x),0,R):x.split(T,R)):[]}var Dz=vh(function(x,T,R){return x+(R?" ":"")+Nv(T)});function Oz(x,T,R){return x=yr(x),R=R==null?0:rc(Un(R),0,x.length),T=si(T),x.slice(R,R+T.length)==T}function Mz(x,T,R){var G=de.templateSettings;R&&mo(x,T,R)&&(T=t),x=yr(x),T=lg({},T,G,DT);var te=lg({},T.imports,G.imports,DT),pe=As(te),Me=bn(te,pe),Ge,et,_t=0,Tt=T.interpolate||En,Nt="__p += '",Kt=Qn((T.escape||En).source+"|"+Tt.source+"|"+(Tt===gn?ko:En).source+"|"+(T.evaluate||En).source+"|$","g"),cn="//# sourceURL="+(Jn.call(T,"sourceURL")?(T.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Pd+"]")+`
`;x.replace(Kt,function(In,er,sr,ii,go,ai){return sr||(sr=ii),Nt+=x.slice(_t,ai).replace(Yn,q),er&&(Ge=!0,Nt+=`' +
__e(`+er+`) +
'`),go&&(et=!0,Nt+=`';
`+go+`;
__p += '`),sr&&(Nt+=`' +
((__t = (`+sr+`)) == null ? '' : __t) +
'`),_t=ai+In.length,In}),Nt+=`';
`;var kn=Jn.call(T,"variable")&&T.variable;if(!kn)Nt=`with (obj) {
`+Nt+`
}
`;else if(wa.test(kn))throw new Ht(i);Nt=(et?Nt.replace(Ke,""):Nt).replace(ot,"$1").replace(vt,"$1;"),Nt="function("+(kn||"obj")+`) {
`+(kn?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(Ge?", __e = _.escape":"")+(et?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+Nt+`return __p
}`;var Gn=kk(function(){return vn(pe,cn+"return "+Nt).apply(t,Me)});if(Gn.source=Nt,Iv(Gn))throw Gn;return Gn}function Fz(x){return yr(x).toLowerCase()}function Lz(x){return yr(x).toUpperCase()}function Pz(x,T,R){if(x=yr(x),x&&(R||T===t))return on(x);if(!x||!(T=si(T)))return x;var G=zt(x),te=zt(T),pe=k(G,te),Me=E(G,te)+1;return Ql(G,pe,Me).join("")}function jz(x,T,R){if(x=yr(x),x&&(R||T===t))return x.slice(0,Bn(x)+1);if(!x||!(T=si(T)))return x;var G=zt(x),te=E(G,zt(T))+1;return Ql(G,0,te).join("")}function Bz(x,T,R){if(x=yr(x),x&&(R||T===t))return x.replace(zr,"");if(!x||!(T=si(T)))return x;var G=zt(x),te=k(G,zt(T));return Ql(G,te).join("")}function Uz(x,T){var R=D,G=M;if(Kr(T)){var te="separator"in T?T.separator:te;R="length"in T?Un(T.length):R,G="omission"in T?si(T.omission):G}x=yr(x);var pe=x.length;if(ae(x)){var Me=zt(x);pe=Me.length}if(R>=pe)return x;var Ge=R-Zt(G);if(Ge<1)return G;var et=Me?Ql(Me,0,Ge).join(""):x.slice(0,Ge);if(te===t)return et+G;if(Me&&(Ge+=et.length-Ge),Ev(te)){if(x.slice(Ge).search(te)){var _t,Tt=et;for(te.global||(te=Qn(te.source,yr(Re.exec(te))+"g")),te.lastIndex=0;_t=te.exec(Tt);)var Nt=_t.index;et=et.slice(0,Nt===t?Ge:Nt)}}else if(x.indexOf(si(te),Ge)!=Ge){var Kt=et.lastIndexOf(te);Kt>-1&&(et=et.slice(0,Kt))}return et+G}function zz(x){return x=yr(x),x&&en.test(x)?x.replace(Pe,un):x}var Vz=vh(function(x,T,R){return x+(R?" ":"")+T.toUpperCase()}),Nv=IT("toUpperCase");function Tk(x,T,R){return x=yr(x),T=R?t:T,T===t?_e(x)?Zn(x):Qt(x):x.match(T)||[]}var kk=Xn(function(x,T){try{return Ns(x,t,T)}catch(R){return Iv(R)?R:new Ht(R)}}),Gz=pl(function(x,T){return Us(T,function(R){R=Ma(R),dl(x,R,Tv(x[R],x))}),x});function Wz(x){var T=x==null?0:x.length,R=Sn();return x=T?Sr(x,function(G){if(typeof G[1]!="function")throw new Vn(a);return[R(G[0]),G[1]]}):[],Xn(function(G){for(var te=-1;++te<T;){var pe=x[te];if(Ns(pe[0],this,G))return Ns(pe[1],this,G)}})}function Hz(x){return yj(ki(x,d))}function Av(x){return function(){return x}}function qz(x,T){return x==null||x!==x?T:x}var Xz=CT(),Kz=CT(!0);function Ro(x){return x}function Rv(x){return sT(typeof x=="function"?x:ki(x,d))}function Yz(x){return iT(ki(x,d))}function Zz(x,T){return aT(x,ki(T,d))}var Qz=Xn(function(x,T){return function(R){return qd(R,x,T)}}),Jz=Xn(function(x,T){return function(R){return qd(x,R,T)}});function Dv(x,T,R){var G=As(T),te=Vm(T,G);R==null&&!(Kr(T)&&(te.length||!G.length))&&(R=T,T=x,x=this,te=Vm(T,As(T)));var pe=!(Kr(R)&&"chain"in R)||!!R.chain,Me=gl(x);return Us(te,function(Ge){var et=T[Ge];x[Ge]=et,Me&&(x.prototype[Ge]=function(){var _t=this.__chain__;if(pe||_t){var Tt=x(this.__wrapped__),Nt=Tt.__actions__=$o(this.__actions__);return Nt.push({func:et,args:arguments,thisArg:x}),Tt.__chain__=_t,Tt}return et.apply(x,Co([this.value()],arguments))})}),x}function e6(){return gr._===this&&(gr._=I4),this}function Ov(){}function t6(x){return x=Un(x),Xn(function(T){return lT(T,x)})}var n6=hv(Sr),r6=hv(Gl),s6=hv(Wl);function Ik(x){return vv(x)?Ce(Ma(x)):Oj(x)}function o6(x){return function(T){return x==null?t:sc(x,T)}}var i6=NT(),a6=NT(!0);function Mv(){return[]}function Fv(){return!1}function l6(){return{}}function u6(){return""}function c6(){return!0}function h6(x,T){if(x=Un(x),x<1||x>K)return[];var R=ce,G=Qs(x,ce);T=Sn(T),x-=ce;for(var te=jt(G,T);++R<x;)T(R);return te}function d6(x){return Ln(x)?Sr(x,Ma):oi(x)?[x]:$o(HT(yr(x)))}function f6(x){var T=++Hl;return yr(x)+T}var p6=Km(function(x,T){return x+T},0),m6=dv("ceil"),g6=Km(function(x,T){return x/T},1),y6=dv("floor");function v6(x){return x&&x.length?zm(x,Ro,Z1):t}function b6(x,T){return x&&x.length?zm(x,Sn(T,2),Z1):t}function x6(x){return Ie(x,Ro)}function w6(x,T){return Ie(x,Sn(T,2))}function S6(x){return x&&x.length?zm(x,Ro,tv):t}function _6(x,T){return x&&x.length?zm(x,Sn(T,2),tv):t}var T6=Km(function(x,T){return x*T},1),k6=dv("round"),I6=Km(function(x,T){return x-T},0);function E6(x){return x&&x.length?Ct(x,Ro):0}function C6(x,T){return x&&x.length?Ct(x,Sn(T,2)):0}return de.after=Y5,de.ary=rk,de.assign=LU,de.assignIn=yk,de.assignInWith=lg,de.assignWith=PU,de.at=jU,de.before=sk,de.bind=Tv,de.bindAll=Gz,de.bindKey=ok,de.castArray=lU,de.chain=ek,de.chunk=yB,de.compact=vB,de.concat=bB,de.cond=Wz,de.conforms=Hz,de.constant=Av,de.countBy=E5,de.create=BU,de.curry=ik,de.curryRight=ak,de.debounce=lk,de.defaults=UU,de.defaultsDeep=zU,de.defer=Z5,de.delay=Q5,de.difference=xB,de.differenceBy=wB,de.differenceWith=SB,de.drop=_B,de.dropRight=TB,de.dropRightWhile=kB,de.dropWhile=IB,de.fill=EB,de.filter=$5,de.flatMap=R5,de.flatMapDeep=D5,de.flatMapDepth=O5,de.flatten=YT,de.flattenDeep=CB,de.flattenDepth=$B,de.flip=J5,de.flow=Xz,de.flowRight=Kz,de.fromPairs=NB,de.functions=KU,de.functionsIn=YU,de.groupBy=M5,de.initial=RB,de.intersection=DB,de.intersectionBy=OB,de.intersectionWith=MB,de.invert=QU,de.invertBy=JU,de.invokeMap=L5,de.iteratee=Rv,de.keyBy=P5,de.keys=As,de.keysIn=Ao,de.map=ng,de.mapKeys=tz,de.mapValues=nz,de.matches=Yz,de.matchesProperty=Zz,de.memoize=sg,de.merge=rz,de.mergeWith=vk,de.method=Qz,de.methodOf=Jz,de.mixin=Dv,de.negate=og,de.nthArg=t6,de.omit=sz,de.omitBy=oz,de.once=eU,de.orderBy=j5,de.over=n6,de.overArgs=tU,de.overEvery=r6,de.overSome=s6,de.partial=kv,de.partialRight=uk,de.partition=B5,de.pick=iz,de.pickBy=bk,de.property=Ik,de.propertyOf=o6,de.pull=jB,de.pullAll=QT,de.pullAllBy=BB,de.pullAllWith=UB,de.pullAt=zB,de.range=i6,de.rangeRight=a6,de.rearg=nU,de.reject=V5,de.remove=VB,de.rest=rU,de.reverse=Sv,de.sampleSize=W5,de.set=lz,de.setWith=uz,de.shuffle=H5,de.slice=GB,de.sortBy=K5,de.sortedUniq=ZB,de.sortedUniqBy=QB,de.split=Rz,de.spread=sU,de.tail=JB,de.take=e5,de.takeRight=t5,de.takeRightWhile=n5,de.takeWhile=r5,de.tap=v5,de.throttle=oU,de.thru=tg,de.toArray=pk,de.toPairs=xk,de.toPairsIn=wk,de.toPath=d6,de.toPlainObject=gk,de.transform=cz,de.unary=iU,de.union=s5,de.unionBy=o5,de.unionWith=i5,de.uniq=a5,de.uniqBy=l5,de.uniqWith=u5,de.unset=hz,de.unzip=_v,de.unzipWith=JT,de.update=dz,de.updateWith=fz,de.values=wh,de.valuesIn=pz,de.without=c5,de.words=Tk,de.wrap=aU,de.xor=h5,de.xorBy=d5,de.xorWith=f5,de.zip=p5,de.zipObject=m5,de.zipObjectDeep=g5,de.zipWith=y5,de.entries=xk,de.entriesIn=wk,de.extend=yk,de.extendWith=lg,Dv(de,de),de.add=p6,de.attempt=kk,de.camelCase=vz,de.capitalize=Sk,de.ceil=m6,de.clamp=mz,de.clone=uU,de.cloneDeep=hU,de.cloneDeepWith=dU,de.cloneWith=cU,de.conformsTo=fU,de.deburr=_k,de.defaultTo=qz,de.divide=g6,de.endsWith=bz,de.eq=ra,de.escape=xz,de.escapeRegExp=wz,de.every=C5,de.find=N5,de.findIndex=XT,de.findKey=VU,de.findLast=A5,de.findLastIndex=KT,de.findLastKey=GU,de.floor=y6,de.forEach=tk,de.forEachRight=nk,de.forIn=WU,de.forInRight=HU,de.forOwn=qU,de.forOwnRight=XU,de.get=Cv,de.gt=pU,de.gte=mU,de.has=ZU,de.hasIn=$v,de.head=ZT,de.identity=Ro,de.includes=F5,de.indexOf=AB,de.inRange=gz,de.invoke=ez,de.isArguments=ac,de.isArray=Ln,de.isArrayBuffer=gU,de.isArrayLike=No,de.isArrayLikeObject=rs,de.isBoolean=yU,de.isBuffer=Jl,de.isDate=vU,de.isElement=bU,de.isEmpty=xU,de.isEqual=wU,de.isEqualWith=SU,de.isError=Iv,de.isFinite=_U,de.isFunction=gl,de.isInteger=ck,de.isLength=ig,de.isMap=hk,de.isMatch=TU,de.isMatchWith=kU,de.isNaN=IU,de.isNative=EU,de.isNil=$U,de.isNull=CU,de.isNumber=dk,de.isObject=Kr,de.isObjectLike=Zr,de.isPlainObject=Jd,de.isRegExp=Ev,de.isSafeInteger=NU,de.isSet=fk,de.isString=ag,de.isSymbol=oi,de.isTypedArray=xh,de.isUndefined=AU,de.isWeakMap=RU,de.isWeakSet=DU,de.join=FB,de.kebabCase=Sz,de.last=Ei,de.lastIndexOf=LB,de.lowerCase=_z,de.lowerFirst=Tz,de.lt=OU,de.lte=MU,de.max=v6,de.maxBy=b6,de.mean=x6,de.meanBy=w6,de.min=S6,de.minBy=_6,de.stubArray=Mv,de.stubFalse=Fv,de.stubObject=l6,de.stubString=u6,de.stubTrue=c6,de.multiply=T6,de.nth=PB,de.noConflict=e6,de.noop=Ov,de.now=rg,de.pad=kz,de.padEnd=Iz,de.padStart=Ez,de.parseInt=Cz,de.random=yz,de.reduce=U5,de.reduceRight=z5,de.repeat=$z,de.replace=Nz,de.result=az,de.round=k6,de.runInContext=Ve,de.sample=G5,de.size=q5,de.snakeCase=Az,de.some=X5,de.sortedIndex=WB,de.sortedIndexBy=HB,de.sortedIndexOf=qB,de.sortedLastIndex=XB,de.sortedLastIndexBy=KB,de.sortedLastIndexOf=YB,de.startCase=Dz,de.startsWith=Oz,de.subtract=I6,de.sum=E6,de.sumBy=C6,de.template=Mz,de.times=h6,de.toFinite=yl,de.toInteger=Un,de.toLength=mk,de.toLower=Fz,de.toNumber=Ci,de.toSafeInteger=FU,de.toString=yr,de.toUpper=Lz,de.trim=Pz,de.trimEnd=jz,de.trimStart=Bz,de.truncate=Uz,de.unescape=zz,de.uniqueId=f6,de.upperCase=Vz,de.upperFirst=Nv,de.each=tk,de.eachRight=nk,de.first=ZT,Dv(de,function(){var x={};return Da(de,function(T,R){Jn.call(de.prototype,R)||(x[R]=T)}),x}(),{chain:!1}),de.VERSION=n,Us(["bind","bindKey","curry","curryRight","partial","partialRight"],function(x){de[x].placeholder=de}),Us(["drop","take"],function(x,T){tr.prototype[x]=function(R){R=R===t?1:ys(Un(R),0);var G=this.__filtered__&&!T?new tr(this):this.clone();return G.__filtered__?G.__takeCount__=Qs(R,G.__takeCount__):G.__views__.push({size:Qs(R,ce),type:x+(G.__dir__<0?"Right":"")}),G},tr.prototype[x+"Right"]=function(R){return this.reverse()[x](R).reverse()}}),Us(["filter","map","takeWhile"],function(x,T){var R=T+1,G=R==B||R==Z;tr.prototype[x]=function(te){var pe=this.clone();return pe.__iteratees__.push({iteratee:Sn(te,3),type:R}),pe.__filtered__=pe.__filtered__||G,pe}}),Us(["head","last"],function(x,T){var R="take"+(T?"Right":"");tr.prototype[x]=function(){return this[R](1).value()[0]}}),Us(["initial","tail"],function(x,T){var R="drop"+(T?"":"Right");tr.prototype[x]=function(){return this.__filtered__?new tr(this):this[R](1)}}),tr.prototype.compact=function(){return this.filter(Ro)},tr.prototype.find=function(x){return this.filter(x).head()},tr.prototype.findLast=function(x){return this.reverse().find(x)},tr.prototype.invokeMap=Xn(function(x,T){return typeof x=="function"?new tr(this):this.map(function(R){return qd(R,x,T)})}),tr.prototype.reject=function(x){return this.filter(og(Sn(x)))},tr.prototype.slice=function(x,T){x=Un(x);var R=this;return R.__filtered__&&(x>0||T<0)?new tr(R):(x<0?R=R.takeRight(-x):x&&(R=R.drop(x)),T!==t&&(T=Un(T),R=T<0?R.dropRight(-T):R.take(T-x)),R)},tr.prototype.takeRightWhile=function(x){return this.reverse().takeWhile(x).reverse()},tr.prototype.toArray=function(){return this.take(ce)},Da(tr.prototype,function(x,T){var R=/^(?:filter|find|map|reject)|While$/.test(T),G=/^(?:head|last)$/.test(T),te=de[G?"take"+(T=="last"?"Right":""):T],pe=G||/^find/.test(T);!te||(de.prototype[T]=function(){var Me=this.__wrapped__,Ge=G?[1]:arguments,et=Me instanceof tr,_t=Ge[0],Tt=et||Ln(Me),Nt=function(er){var sr=te.apply(de,Co([er],Ge));return G&&Kt?sr[0]:sr};Tt&&R&&typeof _t=="function"&&_t.length!=1&&(et=Tt=!1);var Kt=this.__chain__,cn=!!this.__actions__.length,kn=pe&&!Kt,Gn=et&&!cn;if(!pe&&Tt){Me=Gn?Me:new tr(this);var In=x.apply(Me,Ge);return In.__actions__.push({func:tg,args:[Nt],thisArg:t}),new Ti(In,Kt)}return kn&&Gn?x.apply(this,Ge):(In=this.thru(Nt),kn?G?In.value()[0]:In.value():In)})}),Us(["pop","push","shift","sort","splice","unshift"],function(x){var T=fr[x],R=/^(?:push|sort|unshift)$/.test(x)?"tap":"thru",G=/^(?:pop|shift)$/.test(x);de.prototype[x]=function(){var te=arguments;if(G&&!this.__chain__){var pe=this.value();return T.apply(Ln(pe)?pe:[],te)}return this[R](function(Me){return T.apply(Ln(Me)?Me:[],te)})}}),Da(tr.prototype,function(x,T){var R=de[T];if(R){var G=R.name+"";Jn.call(mh,G)||(mh[G]=[]),mh[G].push({name:T,func:R})}}),mh[Xm(t,y).name]=[{name:"wrapper",func:t}],tr.prototype.clone=z4,tr.prototype.reverse=V4,tr.prototype.value=G4,de.prototype.at=b5,de.prototype.chain=x5,de.prototype.commit=w5,de.prototype.next=S5,de.prototype.plant=T5,de.prototype.reverse=k5,de.prototype.toJSON=de.prototype.valueOf=de.prototype.value=I5,de.prototype.first=de.prototype.head,Bd&&(de.prototype[Bd]=_5),de},Fn=qn();ta?((ta.exports=Fn)._=Fn,bi._=Fn):gr._=Fn}).call(Pr)})(wf,wf.exports);function M6(r,e,t,n){return Math.max(t/r,n/e)}function F6(r,e,t,n){return Math.min(t/r,n/e)}function Ck(r){let e=r.getContext("2d").getImageData(0,0,r.width,r.height),t=wf.exports.chunk(wf.exports.chunk(e.data,4),e.width);return wf.exports.unzip(t)}function L6(r){return r.getContext("2d").getImageData(0,0,r.width,r.height)}const Xf=r=>[r.width||r.offsetWidth,r.height||r.offsetHeight];function P6(r){let e=document.createElement("canvas");return e.width=r.width,e.height=r.height,e.getContext("2d").putImageData(r,0,0),e}function j6(r,e){let[t,n]=Xf(r),s=document.createElement("canvas"),[o,a]=[t*e,n*e];return s.width=o,s.height=a,s.getContext("2d").drawImage(r,0,0,o,a),s}function B6(r,e,t){let[n,s]=Xf(r),o=document.createElement("canvas"),a=F6(n,s,e,t),[i,l]=[n*a,s*a];return o.width=i,o.height=l,o.getContext("2d").drawImage(r,0,0,i,l),o}function U6(r,e,t){let[n,s]=Xf(r),o=document.createElement("canvas"),a=M6(n,s,e,t),[i,l]=[n*a,s*a];return o.width=i,o.height=l,o.getContext("2d").drawImage(r,0,0,i,l),o}function z6(r,e,t){let[n,s]=Xf(r),o=document.createElement("canvas");o.width=e,o.height=t;let[a,i]=[(n-e)/2,(s-t)/2];return o.getContext("2d").drawImage(r,a,i,e,t,0,0,e,t),o}function $k(r){let[e,t]=Xf(r),n=document.createElement("canvas");n.width=e,n.height=t;let s=n.getContext("2d");return s.translate(e,0),s.scale(-1,1),s.drawImage(r,0,0),n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const V6=1e-7,G6=1e-4;class pC{constructor(e,t){this.backend=e,this.dataMover=t,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,t){this.dataIdsCount++,this.data.set(e,t)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}}class Px{refCount(e){return li("refCount")}incRef(e){return li("incRef")}timerAvailable(){return!0}time(e){return li("time")}read(e){return li("read")}readSync(e){return li("readSync")}readToGPU(e,t){return li("readToGPU")}numDataIds(){return li("numDataIds")}disposeData(e,t){return li("disposeData")}write(e,t,n){return li("write")}move(e,t,n,s,o){return li("move")}memory(){return li("memory")}floatPrecision(){return li("floatPrecision")}epsilon(){return this.floatPrecision()===32?V6:G6}dispose(){return li("dispose")}}function li(r){throw new Error(`'${r}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W6(r){let e=r.length,t=0;for(;e>0;)t=Math.random()*e|0,e--,Ah(r,e,t)}function $c(r,e,t){return Math.max(r,Math.min(e,t))}function jx(r){return r%2===0?r:r+1}function Ah(r,e,t){const n=r[e];r[e]=r[t],r[t]=n}function H6(r){let e=0;for(let t=0;t<r.length;t++)e+=r[t];return e}function xe(r,e){if(!r)throw new Error(typeof e=="string"?e:e())}function qi(r,e,t=""){xe(ur(r,e),()=>t+` Shapes ${r} and ${e} must match`)}function mC(r){xe(r!=null,()=>"The input to the tensor constructor must be a non-null value.")}function Xh(r,e=[],t=!1){if(e==null&&(e=[]),Array.isArray(r)||Ka(r)&&!t)for(let n=0;n<r.length;++n)Xh(r[n],e,t);else e.push(r);return e}function pt(r){if(r.length===0)return 1;let e=r[0];for(let t=1;t<r.length;t++)e*=r[t];return e}function ur(r,e){if(r===e)return!0;if(r==null||e==null||r.length!==e.length)return!1;for(let t=0;t<r.length;t++)if(r[t]!==e[t])return!1;return!0}function Kh(r){return r%1===0}function pb(r){const e=Math.ceil(Math.sqrt(r));return[e,Math.ceil(r/e)]}function jh(r,e){return e<=r.length?r:r+" ".repeat(e-r.length)}function Nk(r,e=s=>0,t,n=setTimeout){return new Promise((s,o)=>{let a=0;const i=()=>{if(r()){s();return}a++;const l=e(a);if(t!=null&&a>=t){o();return}n(i,l)};i()})}function gC(r,e){let t=1,n=-1;for(let o=0;o<r.length;++o)if(r[o]>=0)t*=r[o];else if(r[o]===-1){if(n!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${n} and dim ${o}`);n=o}else if(r[o]<0)throw Error(`Shapes can not be < 0. Found ${r[o]} at dim ${o}`);if(n===-1){if(e>0&&e!==t)throw Error(`Size(${e}) must match the product of shape ${r}`);return r}if(t===0)throw Error(`Cannot infer the missing size in [${r}] when there are 0 elements`);if(e%t!==0)throw Error(`The implicit shape can't be a fractional number. Got ${e} / ${t}`);const s=r.slice();return s[n]=e/t,s}function Hn(r,e){const t=e.length;return r=r==null?e.map((n,s)=>s):[].concat(r),xe(r.every(n=>n>=-t&&n<t),()=>`All values in axis param must be in range [-${t}, ${t}) but got axis ${r}`),xe(r.every(n=>Kh(n)),()=>`All values in axis param must be integers but got axis ${r}`),r.map(n=>n<0?t+n:n)}function Tu(r,e){const t=[],n=[],s=e!=null&&Array.isArray(e)&&e.length===0,o=e==null||s?null:Hn(e,r).sort();let a=0;for(let i=0;i<r.length;++i){if(o!=null){if(o[a]===i&&r[i]!==1)throw new Error(`Can't squeeze axis ${i} since its dim '${r[i]}' is not 1`);(o[a]==null||o[a]>i)&&r[i]===1&&(t.push(r[i]),n.push(i)),o[a]<=i&&a++}r[i]!==1&&(t.push(r[i]),n.push(i))}return{newShape:t,keptDims:n}}function Os(r,e){let t=null;if(r==null||r==="float32")t=new Float32Array(e);else if(r==="int32")t=new Int32Array(e);else if(r==="bool")t=new Uint8Array(e);else throw new Error(`Unknown data type ${r}`);return t}function _s(r,e){let t=null;if(r==null||r==="float32")t=new Float32Array(e);else if(r==="int32")t=new Int32Array(e);else if(r==="bool")t=new Uint8Array(e);else if(r==="string")t=new Array(e);else throw new Error(`Unknown data type ${r}`);return t}function q6(r,e){for(let t=0;t<r.length;t++){const n=r[t];if(isNaN(n)||!isFinite(n))throw Error(`A tensor of type ${e} being uploaded contains ${n}.`)}}function X6(r){return r==="bool"||r==="complex64"||r==="float32"||r==="int32"||r==="string"}function yC(r,e){return!(e==="complex64"||e==="float32"&&r!=="complex64"||e==="int32"&&r!=="float32"&&r!=="complex64"||e==="bool"&&r==="bool")}function Ka(r){return r instanceof Float32Array||r instanceof Int32Array||r instanceof Uint8Array||r instanceof Uint8ClampedArray}function mb(r){if(r==="float32"||r==="int32")return 4;if(r==="complex64")return 8;if(r==="bool")return 1;throw new Error(`Unknown dtype ${r}`)}function K6(r){if(r==null)return 0;let e=0;return r.forEach(t=>e+=t.length),e}function Kf(r){return typeof r=="string"||r instanceof String}function Y6(r){return typeof r=="boolean"}function gb(r){return typeof r=="number"}function Yf(r){return Array.isArray(r)?Yf(r[0]):r instanceof Float32Array?"float32":r instanceof Int32Array||r instanceof Uint8Array||r instanceof Uint8ClampedArray?"int32":gb(r)?"float32":Kf(r)?"string":Y6(r)?"bool":"float32"}function yb(r){return!!(r&&r.constructor&&r.call&&r.apply)}function vb(r,e){for(let t=e;t<r;++t)if(r%t===0)return t;return r}function pn(r){const e=r.length;if(e<2)return[];const t=new Array(e-1);t[e-2]=r[e-1];for(let n=e-3;n>=0;--n)t[n]=t[n+1]*r[n+1];return t}function vC(r,e,t,n=!1){const s=new Array;if(e.length===1){const o=e[0]*(n?2:1);for(let a=0;a<o;a++)s[a]=t[r+a]}else{const o=e[0],a=e.slice(1),i=a.reduce((l,u)=>l*u)*(n?2:1);for(let l=0;l<o;l++)s[l]=vC(r+l*i,a,t,n)}return s}function fa(r,e,t=!1){if(r.length===0)return e[0];const n=r.reduce((s,o)=>s*o)*(t?2:1);if(n===0)return[];if(n!==e.length)throw new Error(`[${r}] does not match the input size ${e.length}${t?" for a complex tensor":""}.`);return vC(0,r,e,t)}function Bx(r,e){const t=Xs(r,e);for(let n=0;n<t.length;n++)t[n]=1;return t}function Xs(r,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(r);if(e==="int32")return new Int32Array(r);if(e==="bool")return new Uint8Array(r);throw new Error(`Unknown data type ${e}`)}function bC(r,e){const t=r.reduce((n,s)=>n*s,1);if(e==null||e==="float32")return fa(r,new Float32Array(t));if(e==="int32")return fa(r,new Int32Array(t));if(e==="bool")return fa(r,new Uint8Array(t));throw new Error(`Unknown data type ${e}`)}function xC(r){r.forEach(e=>{xe(Number.isInteger(e)&&e>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${r}].`)})}function Wa(r,e,t){if(e===0)return 0;if(e===1)return r[0];let n=r[r.length-1];for(let s=0;s<r.length-1;++s)n+=t[s]*r[s];return n}function vd(r,e,t){if(e===0)return[];if(e===1)return[r];const n=new Array(e);for(let s=0;s<n.length-1;++s)n[s]=Math.floor(r/t[s]),r-=n[s]*t[s];return n[n.length-1]=r,n}function wC(r){return r&&r.then&&typeof r.then=="function"}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ak="tfjsflags";class Z6{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=Q6,this.populateURLFlags()}setPlatform(e,t){this.platform!=null&&(ut().getBool("IS_TEST")||ut().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`)),this.platformName=e,this.platform=t}registerFlag(e,t,n){if(this.flagRegistry[e]={evaluationFn:t,setHook:n},this.urlFlags[e]!=null){const s=this.urlFlags[e];ut().getBool("IS_TEST")||ut().getBool("PROD")||console.warn(`Setting feature override from URL ${e}: ${s}.`),this.set(e,s)}}async getAsync(e){return e in this.flags?this.flags[e]:(this.flags[e]=await this.evaluateFlag(e),this.flags[e])}get(e){if(e in this.flags)return this.flags[e];const t=this.evaluateFlag(e);if(wC(t))throw new Error(`Flag ${e} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[e]=t,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,t){if(this.flagRegistry[e]==null)throw new Error(`Cannot set flag ${e} as it has not been registered.`);this.flags[e]=t,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(t)}evaluateFlag(e){if(this.flagRegistry[e]==null)throw new Error(`Cannot evaluate flag '${e}': no evaluation function found.`);return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global=="undefined"||typeof this.global.location=="undefined"||typeof this.global.location.search=="undefined")return;const e=this.getQueryParams(this.global.location.search);Ak in e&&e[Ak].split(",").forEach(n=>{const[s,o]=n.split(":");this.urlFlags[s]=eV(s,o)})}}function Q6(r){const e={};return r.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(t,...n)=>(J6(e,n[0],n[1]),n.join("="))),e}function J6(r,e,t){r[decodeURIComponent(e)]=decodeURIComponent(t||"")}function eV(r,e){if(e=e.toLowerCase(),e==="true"||e==="false")return e==="true";if(`${+e}`===e)return+e;throw new Error(`Could not parse value flag value ${e} for flag ${r}.`)}function ut(){return SC}let SC=null;function tV(r){SC=r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Lv;function _C(){if(Lv==null){let r;if(typeof window!="undefined")r=window;else if(typeof global!="undefined")r=global;else if(typeof process!="undefined")r=process;else if(typeof self!="undefined")r=self;else throw new Error("Could not find a global object");Lv=r}return Lv}function nV(){const r=_C();return r._tfGlobals==null&&(r._tfGlobals=new Map),r._tfGlobals}function Ux(r,e){const t=nV();if(t.has(r))return t.get(r);{const n=e();return t.set(r,n),t.get(r)}}const By="Abs",Zf="Acos",Qf="Acosh",bd="Add",zx="AddN",Vx="All",Gx="Any",Uy="ArgMax",zy="ArgMin",Jf="Asin",ep="Asinh",tp="Atan",np="Atanh",rp="Atan2",Vy="AvgPool",Wx="AvgPoolGrad",Gy="AvgPool3D",Hx="AvgPool3DGrad",Wy="BatchMatMul",Hy="BatchToSpaceND",qx="Bincount",rV="BroadcastTo",TC="BroadcastArgs",sp="Cast",op="Ceil",ip="ClipByValue",Xx="Complex",qy="ComplexAbs",Xy="Concat",Ky="Conv2D",Kx="Conv2DBackpropFilter",Yy="Conv2DBackpropInput",Zy="Conv3D",Yx="Conv3DBackpropFilterV2",Zx="Conv3DBackpropInputV2",ap="Cos",lp="Cosh",Qx="Cumprod",Qy="Cumsum",Jx="CropAndResize",kC="DenseBincount",ew="DepthToSpace",Jy="DepthwiseConv2dNative",tw="DepthwiseConv2dNativeBackpropFilter",nw="DepthwiseConv2dNativeBackpropInput",IC="Diag",e0="Dilation2D",bb="Dilation2DBackpropInput",xb="Dilation2DBackpropFilter",up="RealDiv",EC="Einsum",cp="Elu",rw="EluGrad",hp="Erf",t0="Equal",dp="Exp",n0="ExpandDims",fp="Expm1",sw="FFT",ow="Fill",iw="FlipLeftRight",pp="Floor",mp="FloorDiv",r0="FusedBatchNorm",s0="GatherV2",CC="GatherNd",o0="Greater",gp="GreaterEqual",yp="Identity",aw="IFFT",lw="Imag",vp="IsFinite",bp="IsInf",xp="IsNan",i0="LeakyRelu",a0="Less",l0="LessEqual",$C="LinSpace",wp="Log",Sp="Log1p",u0="LogicalAnd",c0="LogicalNot",h0="LogicalOr",sV="LogSoftmax",d0="LRN",uw="LRNGrad",f0="Max",_p="Maximum",p0="MaxPool",cw="MaxPoolGrad",m0="MaxPool3D",hw="MaxPool3DGrad",NC="MaxPoolWithArgmax",g0="Mean",y0="Min",Tp="Minimum",v0="MirrorPad",kp="Mod",AC="Multinomial",Ip="Multiply",b0="Neg",x0="NotEqual",dw="NonMaxSuppressionV3",fw="NonMaxSuppressionV4",pw="NonMaxSuppressionV5",w0="OnesLike",S0="OneHot",_0="Pack",T0="PadV2",Ep="Pow",k0="Prelu",I0="Prod",RC="RaggedGather",DC="RaggedTensorToTensor",mw="Range",gw="Real",Cp="Reciprocal",$p="Relu",E0="Reshape",C0="ResizeNearestNeighbor",yw="ResizeNearestNeighborGrad",$0="ResizeBilinear",vw="ResizeBilinearGrad",Np="Relu6",N0="Reverse",Ap="Round",Rp="Rsqrt",OC="ScatterNd",MC="SearchSorted",A0="Select",Dp="Selu",R0="Slice",Op="Sin",Mp="Sinh",Fp="Sign",Lp="Sigmoid",Pp="Softplus",jp="Sqrt",D0="Sum",O0="SpaceToBatchND",M0="SplitV",F0="Softmax",bw="SparseFillEmptyRows",xw="SparseReshape",ww="SparseSegmentMean",Sw="SparseSegmentSum",FC="SparseToDense",Bp="SquaredDifference",_w="Square",Tw="StridedSlice",kw="StringNGrams",Iw="StringSplit",Ew="StringToHashBucketFast",Up="Sub",zp="Tan",Vp="Tanh",Gp="Tile",Cw="TopK",$w="Transform",Bh="Transpose",Nw="Unique",L0="Unpack",P0="UnsortedSegmentSum",j0="ZerosLike",Wp="Step",oV="FromPixels",Aw="RotateWithOffset",Yg="_FusedMatMul",Zg="FusedConv2D",LC="FusedDepthwiseConv2D";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ci(...r){ut().getBool("IS_TEST")||ut().getBool("PROD")||console.warn(...r)}function iV(...r){ut().getBool("IS_TEST")||ut().getBool("PROD")||console.log(...r)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qg=Ux("kernelRegistry",()=>new Map),wb=Ux("gradRegistry",()=>new Map);function Rk(r,e){const t=jC(r,e);return Qg.get(t)}function Dk(r){return wb.get(r)}function Ok(r){const e=Qg.entries(),t=[];for(;;){const{done:n,value:s}=e.next();if(n)break;const[o,a]=s,[i]=o.split("_");i===r&&t.push(a)}return t}function PC(r){const{kernelName:e,backendName:t}=r,n=jC(e,t);Qg.has(n)&&ci(`The kernel '${e}' for backend '${t}' is already registered`),Qg.set(n,r)}function aV(r){const{kernelName:e}=r;wb.has(e)&&ut().getBool("DEBUG")&&ci(`Overriding the gradient for '${e}'`),wb.set(e,r)}function jC(r,e){return`${e}_${r}`}var Jg=Fr,Fi=null;try{Fi=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function Fr(r,e,t){this.low=r|0,this.high=e|0,this.unsigned=!!t}Fr.prototype.__isLong__;Object.defineProperty(Fr.prototype,"__isLong__",{value:!0});function Wo(r){return(r&&r.__isLong__)===!0}Fr.isLong=Wo;var Mk={},Fk={};function Xc(r,e){var t,n,s;return e?(r>>>=0,(s=0<=r&&r<256)&&(n=Fk[r],n)?n:(t=Lr(r,(r|0)<0?-1:0,!0),s&&(Fk[r]=t),t)):(r|=0,(s=-128<=r&&r<128)&&(n=Mk[r],n)?n:(t=Lr(r,r<0?-1:0,!1),s&&(Mk[r]=t),t))}Fr.fromInt=Xc;function Li(r,e){if(isNaN(r))return e?vc:Pi;if(e){if(r<0)return vc;if(r>=BC)return VC}else{if(r<=-Pk)return Lo;if(r+1>=Pk)return zC}return r<0?Li(-r,e).neg():Lr(r%Yh|0,r/Yh|0,e)}Fr.fromNumber=Li;function Lr(r,e,t){return new Fr(r,e,t)}Fr.fromBits=Lr;var ey=Math.pow;function Rw(r,e,t){if(r.length===0)throw Error("empty string");if(r==="NaN"||r==="Infinity"||r==="+Infinity"||r==="-Infinity")return Pi;if(typeof e=="number"?(t=e,e=!1):e=!!e,t=t||10,t<2||36<t)throw RangeError("radix");var n;if((n=r.indexOf("-"))>0)throw Error("interior hyphen");if(n===0)return Rw(r.substring(1),e,t).neg();for(var s=Li(ey(t,8)),o=Pi,a=0;a<r.length;a+=8){var i=Math.min(8,r.length-a),l=parseInt(r.substring(a,a+i),t);if(i<8){var u=Li(ey(t,i));o=o.mul(u).add(Li(l))}else o=o.mul(s),o=o.add(Li(l))}return o.unsigned=e,o}Fr.fromString=Rw;function ba(r,e){return typeof r=="number"?Li(r,e):typeof r=="string"?Rw(r,e):Lr(r.low,r.high,typeof e=="boolean"?e:r.unsigned)}Fr.fromValue=ba;var Lk=1<<16,lV=1<<24,Yh=Lk*Lk,BC=Yh*Yh,Pk=BC/2,jk=Xc(lV),Pi=Xc(0);Fr.ZERO=Pi;var vc=Xc(0,!0);Fr.UZERO=vc;var Fh=Xc(1);Fr.ONE=Fh;var UC=Xc(1,!0);Fr.UONE=UC;var Sb=Xc(-1);Fr.NEG_ONE=Sb;var zC=Lr(-1,2147483647,!1);Fr.MAX_VALUE=zC;var VC=Lr(-1,-1,!0);Fr.MAX_UNSIGNED_VALUE=VC;var Lo=Lr(0,-2147483648,!1);Fr.MIN_VALUE=Lo;var Gt=Fr.prototype;Gt.toInt=function(){return this.unsigned?this.low>>>0:this.low};Gt.toNumber=function(){return this.unsigned?(this.high>>>0)*Yh+(this.low>>>0):this.high*Yh+(this.low>>>0)};Gt.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(Lo)){var t=Li(e),n=this.div(t),s=n.mul(t).sub(this);return n.toString(e)+s.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var o=Li(ey(e,6),this.unsigned),a=this,i="";;){var l=a.div(o),u=a.sub(l.mul(o)).toInt()>>>0,h=u.toString(e);if(a=l,a.isZero())return h+i;for(;h.length<6;)h="0"+h;i=""+h+i}};Gt.getHighBits=function(){return this.high};Gt.getHighBitsUnsigned=function(){return this.high>>>0};Gt.getLowBits=function(){return this.low};Gt.getLowBitsUnsigned=function(){return this.low>>>0};Gt.getNumBitsAbs=function(){if(this.isNegative())return this.eq(Lo)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,t=31;t>0&&(e&1<<t)==0;t--);return this.high!=0?t+33:t+1};Gt.isZero=function(){return this.high===0&&this.low===0};Gt.eqz=Gt.isZero;Gt.isNegative=function(){return!this.unsigned&&this.high<0};Gt.isPositive=function(){return this.unsigned||this.high>=0};Gt.isOdd=function(){return(this.low&1)===1};Gt.isEven=function(){return(this.low&1)===0};Gt.equals=function(e){return Wo(e)||(e=ba(e)),this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low};Gt.eq=Gt.equals;Gt.notEquals=function(e){return!this.eq(e)};Gt.neq=Gt.notEquals;Gt.ne=Gt.notEquals;Gt.lessThan=function(e){return this.comp(e)<0};Gt.lt=Gt.lessThan;Gt.lessThanOrEqual=function(e){return this.comp(e)<=0};Gt.lte=Gt.lessThanOrEqual;Gt.le=Gt.lessThanOrEqual;Gt.greaterThan=function(e){return this.comp(e)>0};Gt.gt=Gt.greaterThan;Gt.greaterThanOrEqual=function(e){return this.comp(e)>=0};Gt.gte=Gt.greaterThanOrEqual;Gt.ge=Gt.greaterThanOrEqual;Gt.compare=function(e){if(Wo(e)||(e=ba(e)),this.eq(e))return 0;var t=this.isNegative(),n=e.isNegative();return t&&!n?-1:!t&&n?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1};Gt.comp=Gt.compare;Gt.negate=function(){return!this.unsigned&&this.eq(Lo)?Lo:this.not().add(Fh)};Gt.neg=Gt.negate;Gt.add=function(e){Wo(e)||(e=ba(e));var t=this.high>>>16,n=this.high&65535,s=this.low>>>16,o=this.low&65535,a=e.high>>>16,i=e.high&65535,l=e.low>>>16,u=e.low&65535,h=0,d=0,c=0,f=0;return f+=o+u,c+=f>>>16,f&=65535,c+=s+l,d+=c>>>16,c&=65535,d+=n+i,h+=d>>>16,d&=65535,h+=t+a,h&=65535,Lr(c<<16|f,h<<16|d,this.unsigned)};Gt.subtract=function(e){return Wo(e)||(e=ba(e)),this.add(e.neg())};Gt.sub=Gt.subtract;Gt.multiply=function(e){if(this.isZero())return Pi;if(Wo(e)||(e=ba(e)),Fi){var t=Fi.mul(this.low,this.high,e.low,e.high);return Lr(t,Fi.get_high(),this.unsigned)}if(e.isZero())return Pi;if(this.eq(Lo))return e.isOdd()?Lo:Pi;if(e.eq(Lo))return this.isOdd()?Lo:Pi;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(jk)&&e.lt(jk))return Li(this.toNumber()*e.toNumber(),this.unsigned);var n=this.high>>>16,s=this.high&65535,o=this.low>>>16,a=this.low&65535,i=e.high>>>16,l=e.high&65535,u=e.low>>>16,h=e.low&65535,d=0,c=0,f=0,p=0;return p+=a*h,f+=p>>>16,p&=65535,f+=o*h,c+=f>>>16,f&=65535,f+=a*u,c+=f>>>16,f&=65535,c+=s*h,d+=c>>>16,c&=65535,c+=o*u,d+=c>>>16,c&=65535,c+=a*l,d+=c>>>16,c&=65535,d+=n*h+s*u+o*l+a*i,d&=65535,Lr(f<<16|p,d<<16|c,this.unsigned)};Gt.mul=Gt.multiply;Gt.divide=function(e){if(Wo(e)||(e=ba(e)),e.isZero())throw Error("division by zero");if(Fi){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var t=(this.unsigned?Fi.div_u:Fi.div_s)(this.low,this.high,e.low,e.high);return Lr(t,Fi.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?vc:Pi;var n,s,o;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return vc;if(e.gt(this.shru(1)))return UC;o=vc}else{if(this.eq(Lo)){if(e.eq(Fh)||e.eq(Sb))return Lo;if(e.eq(Lo))return Fh;var a=this.shr(1);return n=a.div(e).shl(1),n.eq(Pi)?e.isNegative()?Fh:Sb:(s=this.sub(e.mul(n)),o=n.add(s.div(e)),o)}else if(e.eq(Lo))return this.unsigned?vc:Pi;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();o=Pi}for(s=this;s.gte(e);){n=Math.max(1,Math.floor(s.toNumber()/e.toNumber()));for(var i=Math.ceil(Math.log(n)/Math.LN2),l=i<=48?1:ey(2,i-48),u=Li(n),h=u.mul(e);h.isNegative()||h.gt(s);)n-=l,u=Li(n,this.unsigned),h=u.mul(e);u.isZero()&&(u=Fh),o=o.add(u),s=s.sub(h)}return o};Gt.div=Gt.divide;Gt.modulo=function(e){if(Wo(e)||(e=ba(e)),Fi){var t=(this.unsigned?Fi.rem_u:Fi.rem_s)(this.low,this.high,e.low,e.high);return Lr(t,Fi.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))};Gt.mod=Gt.modulo;Gt.rem=Gt.modulo;Gt.not=function(){return Lr(~this.low,~this.high,this.unsigned)};Gt.and=function(e){return Wo(e)||(e=ba(e)),Lr(this.low&e.low,this.high&e.high,this.unsigned)};Gt.or=function(e){return Wo(e)||(e=ba(e)),Lr(this.low|e.low,this.high|e.high,this.unsigned)};Gt.xor=function(e){return Wo(e)||(e=ba(e)),Lr(this.low^e.low,this.high^e.high,this.unsigned)};Gt.shiftLeft=function(e){return Wo(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?Lr(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):Lr(0,this.low<<e-32,this.unsigned)};Gt.shl=Gt.shiftLeft;Gt.shiftRight=function(e){return Wo(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?Lr(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):Lr(this.high>>e-32,this.high>=0?0:-1,this.unsigned)};Gt.shr=Gt.shiftRight;Gt.shiftRightUnsigned=function(e){if(Wo(e)&&(e=e.toInt()),e&=63,e===0)return this;var t=this.high;if(e<32){var n=this.low;return Lr(n>>>e|t<<32-e,t>>>e,this.unsigned)}else return e===32?Lr(t,0,this.unsigned):Lr(t>>>e-32,0,this.unsigned)};Gt.shru=Gt.shiftRightUnsigned;Gt.shr_u=Gt.shiftRightUnsigned;Gt.toSigned=function(){return this.unsigned?Lr(this.low,this.high,!1):this};Gt.toUnsigned=function(){return this.unsigned?this:Lr(this.low,this.high,!0)};Gt.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()};Gt.toBytesLE=function(){var e=this.high,t=this.low;return[t&255,t>>>8&255,t>>>16&255,t>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]};Gt.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,t>>>24,t>>>16&255,t>>>8&255,t&255]};Fr.fromBytes=function(e,t,n){return n?Fr.fromBytesLE(e,t):Fr.fromBytesBE(e,t)};Fr.fromBytesLE=function(e,t){return new Fr(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)};Fr.fromBytesBE=function(e,t){return new Fr(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)};var GC=Object.freeze(A6({__proto__:null,[Symbol.toStringTag]:"Module",default:Jg},[Jg]));/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pc=Jg||GC;function B0(r){return pc.fromString(r,!0,16)}const WC=B0("c3a5c85c97cb3127"),dc=B0("b492b66fbe98f273"),to=B0("9ae16a3b2f90404f");function _b(r){return r.xor(r.shru(47))}function HC(r,e,t){const n=r.slice(e,e+t);return pc.fromBytes(Array.from(n),!0,!0)}function Cr(r,e){return HC(r,e,8)}function Bk(r,e){return HC(r,e,4)}function xs(r,e){return e===0?r:r.shru(e).or(r.shl(64-e))}function uu(r,e,t=B0("9ddfea08eb382d69")){let n=r.xor(e).mul(t);n=n.xor(n.shru(47));let s=e.xor(n).mul(t);return s=s.xor(s.shru(47)),s=s.mul(t),s}function uV(r,e,t,n,s,o){s=s.add(r),o=xs(o.add(s).add(n),21);const a=s;return s=s.add(e),s=s.add(t),o=o.add(xs(s,44)),[s.add(n),o.add(a)]}function cg(r,e,t,n){return uV(Cr(r,e),Cr(r,e+8),Cr(r,e+16),Cr(r,e+24),t,n)}function cV(r,e=r.length){if(e>=8){const t=to.add(e*2),n=Cr(r,0).add(to),s=Cr(r,e-8),o=xs(s,37).mul(t).add(n),a=xs(n,25).add(s).mul(t);return uu(o,a,t)}if(e>=4){const t=to.add(e*2),n=Bk(r,0);return uu(n.shl(3).add(e),Bk(r,e-4),t)}if(e>0){const t=r[0],n=r[e>>1],s=r[e-1],o=t+(n<<8),a=e+(s<<2);return _b(to.mul(o).xor(WC.mul(a))).mul(to)}return to}function hV(r,e=r.length){const t=to.add(e*2),n=Cr(r,0).mul(dc),s=Cr(r,8),o=Cr(r,e-8).mul(t),a=Cr(r,e-16).mul(to);return uu(xs(n.add(s),43).add(xs(o,30)).add(a),n.add(xs(s.add(to),18)).add(o),t)}function dV(r,e=r.length){const t=to.add(e*2),n=Cr(r,0).mul(to),s=Cr(r,8),o=Cr(r,e-8).mul(t),a=Cr(r,e-16).mul(to),i=xs(n.add(s),43).add(xs(o,30)).add(a),l=uu(i,n.add(xs(s.add(to),18)).add(o),t),u=Cr(r,16).mul(t),h=Cr(r,24),d=i.add(Cr(r,e-32)).mul(t),c=l.add(Cr(r,e-24)).mul(t);return uu(xs(u.add(h),43).add(xs(d,30)).add(c),u.add(xs(h.add(n),18)).add(d),t)}function fV(r,e=r.length){const t=pc.fromNumber(81,!0);if(e<=32)return e<=16?cV(r,e):hV(r,e);if(e<=64)return dV(r,e);let n=t,s=t.mul(dc).add(113),o=_b(s.mul(to).add(113)).mul(to),a=[pc.UZERO,pc.UZERO],i=[pc.UZERO,pc.UZERO];n=n.mul(to).add(Cr(r,0));let l=0;const u=(e-1>>6)*64,h=u+(e-1&63)-63;do n=xs(n.add(s).add(a[0]).add(Cr(r,l+8)),37).mul(dc),s=xs(s.add(a[1]).add(Cr(r,l+48)),42).mul(dc),n=n.xor(i[1]),s=s.add(a[0]).add(Cr(r,l+40)),o=xs(o.add(i[0]),33).mul(dc),a=cg(r,l,a[1].mul(dc),n.add(i[0])),i=cg(r,l+32,o.add(i[1]),s.add(Cr(r,l+16))),[o,n]=[n,o],l+=64;while(l!==u);const d=dc.add(o.and(255).shl(1));return l=h,i[0]=i[0].add(e-1&63),a[0]=a[0].add(i[0]),i[0]=i[0].add(a[0]),n=xs(n.add(s).add(a[0]).add(Cr(r,l+8)),37).mul(d),s=xs(s.add(a[1]).add(Cr(r,l+48)),42).mul(d),n=n.xor(i[1].mul(9)),s=s.add(a[0].mul(9).add(Cr(r,l+40))),o=xs(o.add(i[0]),33).mul(d),a=cg(r,l,a[1].mul(d),n.add(i[0])),i=cg(r,l+32,o.add(i[1]),s.add(Cr(r,l+16))),[o,n]=[n,o],uu(uu(a[0],i[0],d).add(_b(s).mul(WC)).add(o),uu(a[1],i[1],d).add(n),d)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ku(r,e){return e==="string"?cu(r):Kc([r],e)}function pV(r,e){return r instanceof Float32Array&&e==="float32"||r instanceof Int32Array&&e==="int32"||r instanceof Uint8Array&&e==="bool"}function Kc(r,e){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(r)&&(r=Xh(r)),ut().getBool("DEBUG")&&q6(r,e),pV(r,e))return r;if(e==null||e==="float32"||e==="complex64")return new Float32Array(r);if(e==="int32")return new Int32Array(r);if(e==="bool"){const t=new Uint8Array(r.length);for(let n=0;n<t.length;++n)Math.round(r[n])!==0&&(t[n]=1);return t}else throw new Error(`Unknown data type ${e}`)}function yo(){return ut().platform.now()}function cu(r,e="utf-8"){return e=e||"utf-8",ut().platform.encode(r,e)}function mu(r,e="utf-8"){return e=e||"utf-8",ut().platform.decode(r,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mV{constructor(e,t){this.backendTimer=e,this.logger=t,t==null&&(this.logger=new yV)}profileKernel(e,t,n){let s;const o=()=>{s=n()};let a;const i=yo();if(this.backendTimer.timerAvailable())a=this.backendTimer.time(o);else{o();for(const u of s)u.dataSync();a=Promise.resolve({kernelMs:yo()-i})}if(ut().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let u=0;u<s.length;u++){const h=s[u];h.data().then(d=>{gV(d,h.dtype,e)})}return{kernelName:e,outputs:s,inputs:t,timeMs:a.then(u=>u.kernelMs),extraInfo:a.then(u=>u.getExtraProfileInfo!=null?u.getExtraProfileInfo():"")}}logKernelProfile(e){const{kernelName:t,outputs:n,timeMs:s,inputs:o,extraInfo:a}=e;n.forEach(i=>{Promise.all([i.data(),s,a]).then(l=>{this.logger.logKernelProfile(t,i,l[0],l[1],o,l[2])})})}}function gV(r,e,t){if(e!=="float32")return!1;for(let n=0;n<r.length;n++){const s=r[n];if(isNaN(s)||!isFinite(s))return console.warn(`Found ${s} in the result of '${t}'`),!0}return!1}class yV{logKernelProfile(e,t,n,s,o,a){const i=typeof s=="number"?jh(`${s}ms`,9):s.error,l=jh(e,25),u=t.rank,h=t.size,d=jh(t.shape.toString(),14);let c="";for(const f in o){const p=o[f];if(p!=null){const m=p.shape||t.shape,g=m.length;c+=`${f}: ${g}D ${g>0?m:""} `}}console.log(`%c${l}	%c${i}	%c${u}D ${d}	%c${h}	%c${c}	%c${a}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vV(r,e,t){const n={},s={};for(let l=0;l<e.length;l++)n[e[l].id]=!0;for(let l=0;l<r.length;l++){const u=r[l],h=u.inputs;for(const d in h){const c=h[d];let f=!1;for(let p=0;p<e.length;p++)if(n[c.id]){u.outputs.forEach(m=>n[m.id]=!0),f=!0,s[u.id]=!0;break}if(f)break}}const o={};o[t.id]=!0;const a={};for(let l=r.length-1;l>=0;l--){const u=r[l],h=u.inputs;for(let d=0;d<u.outputs.length;d++)if(o[u.outputs[d].id]){for(const c in h)o[h[c].id]=!0,a[u.id]=!0;break}}const i=[];for(let l=0;l<r.length;l++){const u=r[l];if(s[u.id]&&a[u.id]){const h={};for(const c in u.inputs){const f=u.inputs[c];n[f.id]&&(h[c]=f)}const d=Object.assign({},u);d.inputs=h,d.outputs=u.outputs,i.push(d)}}return i}function bV(r,e,t,n){for(let s=e.length-1;s>=0;s--){const o=e[s],a=[];if(o.outputs.forEach(l=>{const u=r[l.id];u!=null?a.push(u):a.push(null)}),o.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${o.kernelName}.`);const i=o.gradient(a);for(const l in o.inputs){if(!(l in i))throw new Error(`Cannot backprop through input ${l}. Available gradients found: ${Object.keys(i)}.`);const u=t(()=>i[l]());if(u.dtype!=="float32")throw new Error(`Error in gradient for op ${o.kernelName}. The gradient of input ${l} must have 'float32' dtype, but has '${u.dtype}'`);const h=o.inputs[l];if(!ur(u.shape,h.shape))throw new Error(`Error in gradient for op ${o.kernelName}. The gradient of input '${l}' has shape '${u.shape}', which does not match the shape of the input '${h.shape}'`);if(r[h.id]==null)r[h.id]=u;else{const d=r[h.id];r[h.id]=n(d,u),d.dispose()}}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uk=20,ef=3,Pv=7;function xV(r,e,t,n){const s=pn(e),o=wV(r,e,t,s),a=e.length,i=Vg(r,e,t,s,o),l=["Tensor"];return n&&(l.push(`  dtype: ${t}`),l.push(`  rank: ${a}`),l.push(`  shape: [${e}]`),l.push("  values:")),l.push(i.map(u=>"    "+u).join(`
`)),l.join(`
`)}function wV(r,e,t,n){const s=pt(e),o=n[n.length-1],a=new Array(o).fill(0),i=e.length,l=t==="complex64"?lf(r):r;if(i>1)for(let u=0;u<s/o;u++){const h=u*o;for(let d=0;d<o;d++)a[d]=Math.max(a[d],af(l[h+d],0,t).length)}return a}function af(r,e,t){let n;return Array.isArray(r)?n=`${parseFloat(r[0].toFixed(Pv))} + ${parseFloat(r[1].toFixed(Pv))}j`:Kf(r)?n=`'${r}'`:t==="bool"?n=qC(r):n=parseFloat(r.toFixed(Pv)).toString(),jh(n,e)}function qC(r){return r===0?"false":"true"}function Vg(r,e,t,n,s,o=!0){const a=t==="complex64"?2:1,i=e[0],l=e.length;if(l===0){if(t==="complex64"){const m=lf(r);return[af(m[0],0,t)]}return t==="bool"?[qC(r[0])]:[r[0].toString()]}if(l===1){if(i>Uk){const g=ef*a;let y=Array.from(r.slice(0,g)),v=Array.from(r.slice((i-ef)*a,i*a));return t==="complex64"&&(y=lf(y),v=lf(v)),["["+y.map((b,w)=>af(b,s[w],t)).join(", ")+", ..., "+v.map((b,w)=>af(b,s[i-ef+w],t)).join(", ")+"]"]}const m=t==="complex64"?lf(r):Array.from(r);return["["+m.map((g,y)=>af(g,s[y],t)).join(", ")+"]"]}const u=e.slice(1),h=n.slice(1),d=n[0]*a,c=[];if(i>Uk){for(let m=0;m<ef;m++){const g=m*d,y=g+d;c.push(...Vg(r.slice(g,y),u,t,h,s,!1))}c.push("...");for(let m=i-ef;m<i;m++){const g=m*d,y=g+d;c.push(...Vg(r.slice(g,y),u,t,h,s,m===i-1))}}else for(let m=0;m<i;m++){const g=m*d,y=g+d;c.push(...Vg(r.slice(g,y),u,t,h,s,m===i-1))}const f=l===2?",":"";c[0]="["+c[0]+f;for(let m=1;m<c.length-1;m++)c[m]=" "+c[m]+f;let p=`,
`;for(let m=2;m<l;m++)p+=`
`;return c[c.length-1]=" "+c[c.length-1]+"]"+(o?"":p),c}function lf(r){const e=[];for(let t=0;t<r.length;t+=2)e.push([r[t],r[t+1]]);return e}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ws{constructor(e,t,n){if(this.dtype=t,this.shape=e.slice(),this.size=pt(e),n!=null){const s=n.length;xe(s===this.size,()=>`Length of values '${s}' does not match the size inferred by the shape '${this.size}'.`)}if(t==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||_s(t,this.size),this.strides=pn(e)}set(e,...t){t.length===0&&(t=[0]),xe(t.length===this.rank,()=>`The number of provided coordinates (${t.length}) must match the rank (${this.rank})`);const n=this.locToIndex(t);this.values[n]=e}get(...e){e.length===0&&(e=[0]);let t=0;for(const s of e){if(s<0||s>=this.shape[t]){const o=`Requested out of range element at ${e}.   Buffer shape=${this.shape}`;throw new Error(o)}t++}let n=e[e.length-1];for(let s=0;s<e.length-1;++s)n+=this.strides[s]*e[s];return this.values[n]}locToIndex(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];let t=e[e.length-1];for(let n=0;n<e.length-1;++n)t+=this.strides[n]*e[n];return t}indexToLoc(e){if(this.rank===0)return[];if(this.rank===1)return[e];const t=new Array(this.shape.length);for(let n=0;n<t.length-1;++n)t[n]=Math.floor(e/this.strides[n]),e-=t[n]*this.strides[n];return t[t.length-1]=e,t}get rank(){return this.shape.length}toTensor(){return ia().makeTensor(this.values,this.shape,this.dtype)}}let ia=null,Rh=null;function SV(r){ia=r}function _V(r){Rh=r}class os{constructor(e,t,n,s){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=t||"float32",this.size=pt(e),this.strides=pn(e),this.dataId=n,this.id=s,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const e=await this.data();return Rh.buffer(this.shape,this.dtype,e)}bufferSync(){return Rh.buffer(this.shape,this.dtype,this.dataSync())}async array(){const e=await this.data();return fa(this.shape,e,this.dtype==="complex64")}arraySync(){return fa(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const e=ia().read(this.dataId);if(this.dtype==="string"){const t=await e;try{return t.map(n=>mu(n))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),ia().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();const e=ia().readSync(this.dataId);if(this.dtype==="string")try{return e.map(t=>mu(t))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();const e=await ia().read(this.dataId);return this.dtype==="string"?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(ia().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(e=!1){return Rh.print(this,e)}clone(){return this.throwIfDisposed(),Rh.clone(this)}toString(e=!1){const t=this.dataSync();return xV(t,this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),Rh.cast(this,e)}variable(e=!0,t,n){return this.throwIfDisposed(),ia().makeVariable(this,e,t,n)}}Object.defineProperty(os,Symbol.hasInstance,{value:r=>!!r&&r.data!=null&&r.dataSync!=null&&r.throwIfDisposed!=null});function ft(){return Ux("Tensor",()=>os)}ft();class ty extends os{constructor(e,t,n,s){super(e.shape,e.dtype,e.dataId,s),this.trainable=t,this.name=n}assign(e){if(e.dtype!==this.dtype)throw new Error(`dtype of the new value (${e.dtype}) and previous value (${this.dtype}) must match`);if(!ur(e.shape,this.shape))throw new Error(`shape of the new value (${e.shape}) and previous value (${this.shape}) must match`);ia().disposeTensor(this),this.dataId=e.dataId,ia().incRef(this,null)}dispose(){ia().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(ty,Symbol.hasInstance,{value:r=>r instanceof os&&r.assign!=null&&r.assign instanceof Function});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var zk;(function(r){r.R0="R0",r.R1="R1",r.R2="R2",r.R3="R3",r.R4="R4",r.R5="R5",r.R6="R6"})(zk||(zk={}));var Tb;(function(r){r.float32="float32",r.int32="int32",r.bool="int32",r.complex64="complex64"})(Tb||(Tb={}));var kb;(function(r){r.float32="float32",r.int32="int32",r.bool="bool",r.complex64="complex64"})(kb||(kb={}));var Ib;(function(r){r.float32="float32",r.int32="float32",r.bool="float32",r.complex64="complex64"})(Ib||(Ib={}));var Eb;(function(r){r.float32="complex64",r.int32="complex64",r.bool="complex64",r.complex64="complex64"})(Eb||(Eb={}));const TV={float32:Ib,int32:Tb,bool:kb,complex64:Eb};function Bo(r,e){if(r==="string"||e==="string"){if(r==="string"&&e==="string")return"string";throw new Error(`Can not upcast ${r} with ${e}`)}return TV[r][e]}function Dw(r){return Bo(r,"int32")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jr(r,e){if(r.dtype===e.dtype)return[r,e];const t=Bo(r.dtype,e.dtype);return[r.cast(t),e.cast(t)]}function XC(r){const e=[];return KC(r,e,new Set),e}function KC(r,e,t){if(r==null)return;if(r instanceof os){e.push(r);return}if(!kV(r))return;const n=r;for(const s in n){const o=n[s];t.has(o)||(t.add(o),KC(o,e,t))}}function kV(r){return Array.isArray(r)||typeof r=="object"}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jv(r){return r.kernelName!=null}class Vk{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(const e in this.registeredVariables)this.registeredVariables[e].dispose()}}class Zh{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new Vk}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const e=this.getSortedBackends();for(let t=0;t<e.length;t++){const n=e[t];if(await this.initializeBackend(n).success){await this.setBackend(n);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:e,asyncInit:t}=this.initializeBackendsAndReturnBest();if(t)throw new Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry))if(e in this.registryFactory){const{asyncInit:t}=this.initializeBackend(e);if(t)return null}else return null;return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,t,n=1){return e in this.registryFactory?(ci(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:t,priority:n},!0)}async setBackend(e){if(this.registryFactory[e]==null)throw new Error(`Backend name '${e}' not found in registry`);if(this.backendName=e,this.registry[e]==null){this.backendInstance=null;const{success:t,asyncInit:n}=this.initializeBackend(e);if(!(n?await t:t))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new mV(this.backendInstance),!0}setupRegisteredKernels(){Ok(this.backendName).forEach(t=>{t.setupFunc!=null&&t.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){Ok(e).forEach(n=>{n.disposeFunc!=null&&n.disposeFunc(this.registry[e])})}initializeBackend(e){const t=this.registryFactory[e];if(t==null)throw new Error(`Cannot initialize backend ${e}, no registration found.`);try{const n=t.factory();if(n&&!(n instanceof Px)&&typeof n.then=="function"){const s=++this.pendingBackendInitId,o=n.then(a=>s<this.pendingBackendInitId?!1:(this.registry[e]=a,this.pendingBackendInit=null,!0)).catch(a=>(s<this.pendingBackendInitId||(this.pendingBackendInit=null,ci(`Initialization of backend ${e} failed`),ci(a.stack||a.message)),!1));return this.pendingBackendInit=o,{success:o,asyncInit:!0}}else return this.registry[e]=n,{success:!0,asyncInit:!1}}catch(n){return ci(`Initialization of backend ${e} failed`),ci(n.stack||n.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error(`${e} backend not found in registry`);this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,t)=>this.registryFactory[t].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let t=0;t<e.length;t++){const n=e[t],{success:s,asyncInit:o}=this.initializeBackend(n);if(o||s)return{name:n,asyncInit:o}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,t){const n=this.state.tensorInfo.get(t),s=n.backend,o=this.readSync(t),a=s.refCount(t);s.disposeData(t,!0),n.backend=e,e.move(t,o,n.shape,n.dtype,a),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,t){let n=null;if(t==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");t=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof t!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");n=e}let s;return this.scopedRun(()=>this.startScope(n),()=>this.endScope(s),()=>(s=t(),s instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),s))}scopedRun(e,t,n){e();try{const s=n();return t(),s}catch(s){throw t(),s}}nextTensorId(){return Zh.nextTensorId++}nextVariableId(){return Zh.nextVariableId++}clone(e){const t=Xe.runKernel(yp,{x:e}),n={x:e},s=a=>({x:()=>{const i="float32",l={x:a},u={dtype:i};return Xe.runKernel(sp,l,u)}}),o=[];return this.addTapeNode(this.state.activeScope.name,n,[t],s,o,{}),t}runKernel(e,t,n){if(this.backendName==null&&this.backend,!(Rk(e,this.backendName)!=null))throw new Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:t,attrs:n})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,t,n){const s=this.backend.numDataIds();let o=0;n.forEach(l=>{o+=l.dtype==="complex64"?3:1});const a=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],i=s-t-o-a;if(i>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${i} data ids) after running '${e}'`)}runKernelFunc(e){let t,n=[];const s=this.isTapeOn(),o=this.state.numBytes,a=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let i;this.backendName==null&&this.backend;let l;const u=jv(e)?e.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(jv(e)){const{kernelName:p,inputs:m,attrs:g}=e;this.backendName==null&&this.backend;const y=Rk(p,this.backendName);xe(y!=null,()=>`Cannot find registered kernel '${p}' for backend '${this.backendName}'`),i=()=>{const v=this.backend.numDataIds();l=y.kernelFunc({inputs:m,attrs:g,backend:this.backend});const b=Array.isArray(l)?l:[l];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(p,v,b);const w=b.map(_=>_.rank!=null?_:this.makeTensorFromTensorInfo(_));if(s){const _=this.getTensorsForGradient(p,m,w);n=this.saveTensorsForBackwardMode(_)}return w}}else{const{forwardFunc:p}=e,m=g=>{!s||(n=g.map(y=>this.keep(this.clone(y))))};i=()=>{const g=this.backend.numDataIds();l=this.tidy(()=>p(this.backend,m));const y=Array.isArray(l)?l:[l];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(u,g,y),y}}const{inputs:h,attrs:d}=e,c=jv(e)?null:e.backwardsFunc;let f;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?t=i():(f=this.profiler.profileKernel(u,h,()=>i()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(f),t=f.outputs)}),s&&this.addTapeNode(u,h,t,c,n,d),this.state.profiling&&this.state.activeProfile.kernels.push({name:u,bytesAdded:this.state.numBytes-o,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-a,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(h).map(p=>h[p]!=null?h[p].shape:null),outputShapes:t.map(p=>p.shape),kernelTimeMs:f.timeMs,extraInfo:f.extraInfo}),Array.isArray(l)?t:t[0]}saveTensorsForBackwardMode(e){return e.map(n=>this.keep(this.clone(n)))}getTensorsForGradient(e,t,n){const s=Dk(e);if(s!=null){const o=s.inputsToSave||[],a=s.outputsToSave||[];let i;s.saveAllInputs?(xe(Array.isArray(t),()=>"saveAllInputs is true, expected inputs to be an array."),i=Object.keys(t).map(u=>t[u])):i=o.map(u=>t[u]);const l=n.filter((u,h)=>a[h]);return i.concat(l)}return[]}makeTensor(e,t,n,s){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",s=s||this.backend;let o=e;n==="string"&&Kf(e[0])&&(o=e.map(l=>cu(l)));const a=s.write(o,t,n),i=new os(t,n,a,this.nextTensorId());if(this.trackTensor(i,s),n==="string"){const l=this.state.tensorInfo.get(a),u=K6(o);this.state.numBytes+=u-l.bytes,l.bytes=u}return i}makeTensorFromDataId(e,t,n,s){n=n||"float32";const o={dataId:e,shape:t,dtype:n};return this.makeTensorFromTensorInfo(o,s)}makeTensorFromTensorInfo(e,t){const{dataId:n,shape:s,dtype:o}=e,a=new os(s,o,n,this.nextTensorId());return this.trackTensor(a,t),a}makeVariable(e,t=!0,n,s){n=n||this.nextVariableId().toString(),s!=null&&s!==e.dtype&&(e=e.cast(s));const o=new ty(e,t,n,this.nextTensorId());if(this.state.registeredVariables[o.name]!=null)throw new Error(`Variable with name ${o.name} was already registered`);return this.state.registeredVariables[o.name]=o,this.incRef(o,this.backend),o}trackTensor(e,t){this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++;let n=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(n=e.size*mb(e.dtype)),this.state.numBytes+=n,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:n})),e instanceof ty||this.track(e)}incRef(e,t){this.trackTensor(e,t),this.backend.incRef(e.dataId)}removeDataId(e,t){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===t&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const t=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,e.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=t.bytes),e.dtype!=="complex64"&&e.dtype!=="string"){const n=e.size*mb(e.dtype);this.state.numBytes-=n}t.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,t.backend)}disposeVariables(){for(const e in this.state.registeredVariables){const t=this.state.registeredVariables[e];this.disposeVariable(t)}}disposeVariable(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;const t=this.state.numBytes,n=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(s=>s.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-t,this.state.activeProfile.newTensors=this.state.numTensors-n;for(const s of this.state.activeProfile.kernels)s.kernelTimeMs=await s.kernelTimeMs,s.extraInfo=await s.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(e,t,n,s,o,a){const i={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:n,saved:o},l=Dk(e);l!=null&&(s=l.gradFunc),s!=null&&(i.gradient=u=>(u=u.map((h,d)=>{if(h==null){const c=n[d],f=Xs(c.size,c.dtype);return this.makeTensor(f,c.shape,c.dtype)}return h}),s(u.length>1?u:u[0],o,a))),this.state.activeTape.push(i)}keep(e){return e.kept=!0,e}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t}endScope(e){const t=XC(e),n=new Set(t.map(o=>o.id));for(let o=0;o<this.state.activeScope.track.length;o++){const a=this.state.activeScope.track[o];!a.kept&&!n.has(a.id)&&a.dispose()}const s=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],t.forEach(o=>{!o.kept&&o.scopeId===s.id&&this.track(o)})}gradients(e,t,n,s=!1){if(xe(t.length>0,()=>"gradients() received an empty list of xs."),n!=null&&n.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${n.dtype}'`);const o=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));xe(o instanceof os,()=>"The result y returned by f() must be a tensor.");const a=vV(this.state.activeTape,t,o);if(!s&&a.length===0&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const i={};i[o.id]=n==null?IV(o.shape):n,bV(i,a,u=>this.tidy(u),EV);const l=t.map(u=>i[u.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(u=>{for(const h of u.saved)h.dispose()}),this.state.activeTape=null),{value:o,grads:l}})}customGrad(e){return xe(yb(e),()=>"The f passed in customGrad(f) must be a function."),(...t)=>{xe(t.every(i=>i instanceof os),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let n;const s={};t.forEach((i,l)=>{s[l]=i});const o=(i,l)=>(n=e(...t,l),xe(n.value instanceof os,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),xe(yb(n.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),n.value),a=(i,l)=>{const u=n.gradFunc(i,l),h=Array.isArray(u)?u:[u];xe(h.length===t.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),xe(h.every(c=>c instanceof os),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const d={};return h.forEach((c,f)=>{d[f]=()=>c}),d};return this.runKernelFunc({forwardFunc:o,backwardsFunc:a,inputs:s})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,t){return this.state.tensorInfo.get(e).backend.readToGPU(e,t)}async time(e){const t=yo(),n=await this.backend.time(e);return n.wallMs=yo()-t,n}track(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new Vk;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}Zh.nextTensorId=0;Zh.nextVariableId=0;function IV(r){const e=Bx(pt(r),"float32");return Xe.makeTensor(e,r,"float32")}function YC(){const r=_C();if(r._tfengine==null){const e=new Z6(r);r._tfengine=new Zh(e)}return tV(r._tfengine.ENV),SV(()=>r._tfengine),r._tfengine}const Xe=YC();function EV(r,e){const t={a:r,b:e};return Xe.runKernel(bd,t)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CV(){return typeof navigator!="undefined"&&navigator!=null}function ZC(r){if(r||CV()){if(r||(r=navigator),r.product==="ReactNative")return!0;const e=r.userAgent||r.vendor||(typeof window!="undefined"?window.opera:"");if(!e){const t=r;return t.userAgentData&&t.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function QC(){return typeof window!="undefined"&&window.document!=null||typeof WorkerGlobalScope!="undefined"}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uo=ut();Uo.registerFlag("DEBUG",()=>!1,r=>{r&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});Uo.registerFlag("IS_BROWSER",()=>QC());Uo.registerFlag("IS_NODE",()=>typeof process!="undefined"&&typeof process.versions!="undefined"&&typeof process.versions.node!="undefined");Uo.registerFlag("IS_CHROME",()=>typeof navigator!="undefined"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));Uo.registerFlag("PROD",()=>!1);Uo.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>Uo.getBool("DEBUG"));Uo.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);Uo.registerFlag("IS_TEST",()=>!1);Uo.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>!0);Uo.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);Uo.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);Uo.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);Uo.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U0(r,e){let t=r;if(Ka(r))return e==="string"?[]:[r.length];if(!Array.isArray(r))return[];const n=[];for(;Array.isArray(t)||Ka(t)&&e!=="string";)n.push(t.length),t=t[0];return Array.isArray(r)&&ut().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&JC(r,n,[]),n}function JC(r,e,t){if(t=t||[],!Array.isArray(r)&&!Ka(r)){xe(e.length===0,()=>`Element arr[${t.join("][")}] is a primitive, but should be an array/TypedArray of ${e[0]} elements`);return}xe(e.length>0,()=>`Element arr[${t.join("][")}] should be a primitive, but is an array of ${r.length} elements`),xe(r.length===e[0],()=>`Element arr[${t.join("][")}] should have ${e[0]} elements, but has ${r.length} elements`);const n=e.slice(1);for(let s=0;s<r.length;++s)JC(r[s],n,t.concat(s))}function Gk(r,e,t,n){if(r!=="string_or_numeric"){if(r==null)throw new Error("Expected dtype cannot be null.");if(r!=="numeric"&&r!==e||r==="numeric"&&e==="string")throw new Error(`Argument '${t}' passed to '${n}' must be ${r} tensor, but got ${e} tensor`)}}function ke(r,e,t,n="numeric"){if(r instanceof os)return Gk(n,r.dtype,e,t),r;let s=Yf(r);if(s!=="string"&&["bool","int32","float32"].indexOf(n)>=0&&(s=n),Gk(n,s,e,t),r==null||!Ka(r)&&!Array.isArray(r)&&typeof r!="number"&&typeof r!="boolean"&&typeof r!="string"){const l=r==null?"null":r.constructor.name;throw new Error(`Argument '${e}' passed to '${t}' must be a Tensor or TensorLike, but got '${l}'`)}const o=U0(r,s);!Ka(r)&&!Array.isArray(r)&&(r=[r]);const i=s!=="string"?Kc(r,s):Xh(r,[],!0);return Xe.makeTensor(i,o,s)}function e$(r,e,t,n="numeric"){if(!Array.isArray(r))throw new Error(`Argument ${e} passed to ${t} must be a \`Tensor[]\` or \`TensorLike[]\``);return r.map((o,a)=>ke(o,`${e}[${a}]`,t,n))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $V="__op";function Ze(r){const e=Object.keys(r);if(e.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${e.length} keys.`);let t=e[0];const n=r[t];t.endsWith("_")&&(t=t.substring(0,t.length-1)),t=t+$V;const s=(...o)=>{Xe.startScope(t);try{const a=n(...o);return wC(a)&&console.error("Cannot return a Promise inside of tidy."),Xe.endScope(a),a}catch(a){throw Xe.endScope(null),a}};return Object.defineProperty(s,"name",{value:t,configurable:!0}),s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NV(r,e){const t=ke(r,"real","complex"),n=ke(e,"imag","complex");qi(t.shape,n.shape,`real and imag shapes, ${t.shape} and ${n.shape}, must match in call to tf.complex().`);const s={real:t,imag:n};return Xe.runKernel(Xx,s)}const Qh=Ze({complex_:NV});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z0(r,e,t,n){if(n==null&&(n=Yf(r)),n==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!Ka(r)&&!Array.isArray(r)&&typeof r!="number"&&typeof r!="boolean"&&typeof r!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){xC(e);const s=pt(e),o=pt(t);xe(s===o,()=>`Based on the provided shape, [${e}], the tensor should have ${s} values but has ${o}`);for(let a=0;a<t.length;++a){const i=t[a],l=a===t.length-1?i!==pt(e.slice(a)):!0;xe(t[a]===e[a]||!l,()=>`Error creating a new Tensor. Inferred shape (${t}) does not match the provided shape (${e}). `)}}return!Ka(r)&&!Array.isArray(r)&&(r=[r]),e=e||t,r=n!=="string"?Kc(r,n):Xh(r,[],!0),Xe.makeTensor(r,e,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AV(r,e,t){const n=U0(r,t);return z0(r,e,n,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wk=4;async function Hk(r,e){const t=[],n=[],s=Array.isArray(r)?r.map(a=>a.name):Object.keys(r);for(let a=0;a<s.length;++a){const i=s[a],l=Array.isArray(r)?r[a].tensor:r[i];if(l.dtype!=="float32"&&l.dtype!=="int32"&&l.dtype!=="bool"&&l.dtype!=="string"&&l.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${i}': ${l.dtype}`);const u={name:i,shape:l.shape,dtype:l.dtype};if(l.dtype==="string"){const h=new Promise(async d=>{const c=await l.bytes(),f=c.reduce((g,y)=>g+y.length,0)+Wk*c.length,p=new Uint8Array(f);let m=0;for(let g=0;g<c.length;g++){const y=c[g],v=new Uint8Array(new Uint32Array([y.length]).buffer);p.set(v,m),m+=Wk,p.set(y,m),m+=y.length}d(p)});n.push(h)}else n.push(l.data());e!=null&&(u.group=e),t.push(u)}const o=await Promise.all(n);return{data:RV(o),specs:t}}function RV(r){if(r===null)throw new Error(`Invalid input value: ${JSON.stringify(r)}`);let e=0;const t=[];r.forEach(o=>{if(e+=o.byteLength,t.push(o.byteLength===o.buffer.byteLength?o:new o.constructor(o)),!(o instanceof Float32Array||o instanceof Int32Array||o instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${o.constructor.name}`)});const n=new Uint8Array(e);let s=0;return t.forEach(o=>{n.set(new Uint8Array(o.buffer),s),s+=o.byteLength}),n.buffer}const Ow=typeof Buffer!="undefined"&&(typeof Blob=="undefined"||typeof atob=="undefined"||typeof btoa=="undefined");function qk(r){return Ow?Buffer.byteLength(r):new Blob([r]).size}function DV(r){if(Ow)return Buffer.from(r).toString("base64");const e=new Uint8Array(r);let t="";for(let n=0,s=e.length;n<s;n++)t+=String.fromCharCode(e[n]);return btoa(t)}function OV(r){if(Ow){const n=Buffer.from(r,"base64");return n.buffer.slice(n.byteOffset,n.byteOffset+n.byteLength)}const e=atob(r),t=new Uint8Array(e.length);for(let n=0;n<e.length;++n)t.set([e.charCodeAt(n)],n);return t.buffer}function t$(r){if(r.length===1)return r[0];let e=0;r.forEach(s=>{e+=s.byteLength});const t=new Uint8Array(e);let n=0;return r.forEach(s=>{t.set(new Uint8Array(s),n),n+=s.byteLength}),t.buffer}function n$(r,e){const t={modelTopology:r.modelTopology,format:r.format,generatedBy:r.generatedBy,convertedBy:r.convertedBy,weightsManifest:e};return r.signature!=null&&(t.signature=r.signature),r.userDefinedMetadata!=null&&(t.userDefinedMetadata=r.userDefinedMetadata),r.modelInitializer!=null&&(t.modelInitializer=r.modelInitializer),r.trainingConfig!=null&&(t.trainingConfig=r.trainingConfig),t}function MV(r,e,t){const n={modelTopology:r.modelTopology,format:r.format,generatedBy:r.generatedBy,convertedBy:r.convertedBy};if(r.trainingConfig!=null&&(n.trainingConfig=r.trainingConfig),r.weightsManifest!=null){if(!e)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!t)throw new Error("modelJSON has weightsManifest but weightData is null");n.weightSpecs=e,n.weightData=t}return r.signature!=null&&(n.signature=r.signature),r.userDefinedMetadata!=null&&(n.userDefinedMetadata=r.userDefinedMetadata),r.modelInitializer!=null&&(n.modelInitializer=r.modelInitializer),n}async function FV(r,e){let t,n;return r.weightsManifest!=null&&([t,n]=await e(r.weightsManifest)),MV(r,t,n)}function V0(r){if(r.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:r.modelTopology==null?0:qk(JSON.stringify(r.modelTopology)),weightSpecsBytes:r.weightSpecs==null?0:qk(JSON.stringify(r.weightSpecs)),weightDataBytes:r.weightData==null?0:r.weightData.byteLength}}function LV(r){const e=[];for(const t of r)e.push(...t.weights);return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vs{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return vs.instance==null&&(vs.instance=new vs),vs.instance}static registerSaveRouter(e){vs.getInstance().saveRouters.push(e)}static registerLoadRouter(e){vs.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return vs.getHandlers(e,"save")}static getLoadHandlers(e,t){return vs.getHandlers(e,"load",t)}static getHandlers(e,t,n){const s=[];return(t==="load"?vs.getInstance().loadRouters:vs.getInstance().saveRouters).forEach(a=>{const i=a(e,n);i!==null&&s.push(i)}),s}}const PV=r=>vs.getSaveHandlers(r);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cb="tensorflowjs",$b=1,bc="models_store",su="model_info_store";function r$(){if(!ut().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const r=typeof window=="undefined"?self:window,e=r.indexedDB||r.mozIndexedDB||r.webkitIndexedDB||r.msIndexedDB||r.shimIndexedDB;if(e==null)throw new Error("The current browser does not appear to support IndexedDB.");return e}function Nb(r){const e=r.result;e.createObjectStore(bc,{keyPath:"modelPath"}),e.createObjectStore(su,{keyPath:"modelPath"})}class Nc{constructor(e){if(this.indexedDB=r$(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,t){return new Promise((n,s)=>{const o=this.indexedDB.open(Cb,$b);o.onupgradeneeded=()=>Nb(o),o.onsuccess=()=>{const a=o.result;if(t==null){const i=a.transaction(bc,"readonly"),u=i.objectStore(bc).get(this.modelPath);u.onsuccess=()=>{if(u.result==null)return a.close(),s(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));n(u.result.modelArtifacts)},u.onerror=h=>(a.close(),s(u.error)),i.oncomplete=()=>a.close()}else{const i=V0(t),l=a.transaction(su,"readwrite");let u=l.objectStore(su);const h=u.put({modelPath:this.modelPath,modelArtifactsInfo:i});let d;h.onsuccess=()=>{d=a.transaction(bc,"readwrite");const f=d.objectStore(bc).put({modelPath:this.modelPath,modelArtifacts:t,modelArtifactsInfo:i});f.onsuccess=()=>n({modelArtifactsInfo:i}),f.onerror=p=>{u=l.objectStore(su);const m=u.delete(this.modelPath);m.onsuccess=()=>(a.close(),s(f.error)),m.onerror=g=>(a.close(),s(f.error))}},h.onerror=c=>(a.close(),s(h.error)),l.oncomplete=()=>{d==null?a.close():d.oncomplete=()=>a.close()}}},o.onerror=a=>s(o.error)})}}Nc.URL_SCHEME="indexeddb://";const s$=r=>ut().getBool("IS_BROWSER")&&!Array.isArray(r)&&r.startsWith(Nc.URL_SCHEME)?jV(r.slice(Nc.URL_SCHEME.length)):null;vs.registerSaveRouter(s$);vs.registerLoadRouter(s$);function jV(r){return new Nc(r)}function BV(r){return r.startsWith(Nc.URL_SCHEME)?r.slice(Nc.URL_SCHEME.length):r}class UV{constructor(){this.indexedDB=r$()}async listModels(){return new Promise((e,t)=>{const n=this.indexedDB.open(Cb,$b);n.onupgradeneeded=()=>Nb(n),n.onsuccess=()=>{const s=n.result,o=s.transaction(su,"readonly"),i=o.objectStore(su).getAll();i.onsuccess=()=>{const l={};for(const u of i.result)l[u.modelPath]=u.modelArtifactsInfo;e(l)},i.onerror=l=>(s.close(),t(i.error)),o.oncomplete=()=>s.close()},n.onerror=s=>t(n.error)})}async removeModel(e){return e=BV(e),new Promise((t,n)=>{const s=this.indexedDB.open(Cb,$b);s.onupgradeneeded=()=>Nb(s),s.onsuccess=()=>{const o=s.result,a=o.transaction(su,"readwrite"),i=a.objectStore(su),l=i.get(e);let u;l.onsuccess=()=>{if(l.result==null)return o.close(),n(new Error(`Cannot find model with path '${e}' in IndexedDB.`));{const h=i.delete(e),d=()=>{u=o.transaction(bc,"readwrite");const f=u.objectStore(bc).delete(e);f.onsuccess=()=>t(l.result.modelArtifactsInfo),f.onerror=p=>n(l.error)};h.onsuccess=d,h.onerror=c=>(d(),o.close(),n(l.error))}},l.onerror=h=>(o.close(),n(l.error)),a.oncomplete=()=>{u==null?o.close():u.oncomplete=()=>o.close()}},s.onerror=o=>n(s.error)})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sl="/",Dh="tensorflowjs_models",o$="info",zV="model_topology",VV="weight_specs",GV="weight_data",WV="model_metadata";function i$(r){return{info:[Dh,r,o$].join(Sl),topology:[Dh,r,zV].join(Sl),weightSpecs:[Dh,r,VV].join(Sl),weightData:[Dh,r,GV].join(Sl),modelMetadata:[Dh,r,WV].join(Sl)}}function a$(r){for(const e of Object.values(r))window.localStorage.removeItem(e)}function HV(r){const e=r.split(Sl);if(e.length<3)throw new Error(`Invalid key format: ${r}`);return e.slice(1,e.length-1).join(Sl)}function qV(r){return r.startsWith(Ac.URL_SCHEME)?r.slice(Ac.URL_SCHEME.length):r}class Ac{constructor(e){if(!ut().getBool("IS_BROWSER")||typeof window=="undefined"||typeof window.localStorage=="undefined")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=i$(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const t=JSON.stringify(e.modelTopology),n=JSON.stringify(e.weightSpecs),s=V0(e);try{this.LS.setItem(this.keys.info,JSON.stringify(s)),this.LS.setItem(this.keys.topology,t),this.LS.setItem(this.keys.weightSpecs,n),this.LS.setItem(this.keys.weightData,DV(e.weightData));const o={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:e.signature!=null?e.signature:void 0,userDefinedMetadata:e.userDefinedMetadata!=null?e.userDefinedMetadata:void 0,modelInitializer:e.modelInitializer!=null?e.modelInitializer:void 0,trainingConfig:e.trainingConfig!=null?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(o)),{modelArtifactsInfo:s}}catch{throw a$(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${s.modelTopologyBytes}, weightSpecsBytes=${s.weightSpecsBytes}, weightDataBytes=${s.weightDataBytes}.`)}}}async load(){const e=JSON.parse(this.LS.getItem(this.keys.info));if(e==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const t={},n=JSON.parse(this.LS.getItem(this.keys.topology));if(n==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);t.modelTopology=n;const s=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(s==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);t.weightSpecs=s;const o=this.LS.getItem(this.keys.modelMetadata);if(o!=null){const i=JSON.parse(o);t.format=i.format,t.generatedBy=i.generatedBy,t.convertedBy=i.convertedBy,i.signature!=null&&(t.signature=i.signature),i.userDefinedMetadata!=null&&(t.userDefinedMetadata=i.userDefinedMetadata),i.modelInitializer!=null&&(t.modelInitializer=i.modelInitializer),i.trainingConfig!=null&&(t.trainingConfig=i.trainingConfig)}const a=this.LS.getItem(this.keys.weightData);if(a==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return t.weightData=OV(a),t}}Ac.URL_SCHEME="localstorage://";const l$=r=>ut().getBool("IS_BROWSER")&&!Array.isArray(r)&&r.startsWith(Ac.URL_SCHEME)?XV(r.slice(Ac.URL_SCHEME.length)):null;vs.registerSaveRouter(l$);vs.registerLoadRouter(l$);function XV(r){return new Ac(r)}class KV{constructor(){xe(ut().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),xe(typeof window=="undefined"||typeof window.localStorage!="undefined",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const e={},t=Dh+Sl,n=Sl+o$;for(let s=0;s<this.LS.length;++s){const o=this.LS.key(s);if(o.startsWith(t)&&o.endsWith(n)){const a=HV(o);e[a]=JSON.parse(this.LS.getItem(o))}}return e}async removeModel(e){e=qV(e);const t=i$(e);if(this.LS.getItem(t.info)==null)throw new Error(`Cannot find model at path '${e}'`);const n=JSON.parse(this.LS.getItem(t.info));return a$(t),n}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xk="://";class Fa{constructor(){this.managers={}}static getInstance(){return Fa.instance==null&&(Fa.instance=new Fa),Fa.instance}static registerManager(e,t){xe(e!=null,()=>"scheme must not be undefined or null."),e.endsWith(Xk)&&(e=e.slice(0,e.indexOf(Xk))),xe(e.length>0,()=>"scheme must not be an empty string.");const n=Fa.getInstance();xe(n.managers[e]==null,()=>`A model store manager is already registered for scheme '${e}'.`),n.managers[e]=t}static getManager(e){const t=Fa.getInstance().managers[e];if(t==null)throw new Error(`Cannot find model manager for scheme '${e}'`);return t}static getSchemes(){return Object.keys(Fa.getInstance().managers)}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class YV{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,t){return fetch(e,t)}now(){return performance.now()}encode(e,t){if(t!=="utf-8"&&t!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${t}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,t){return new TextDecoder(t).decode(e)}setTimeoutCustom(e,t){if(!window||!ut().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(e,t);return}this.functionRefs.push(e),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},t),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",n=>{if(n.source===window&&n.data.name===this.messageName){n.stopPropagation();const s=this.functionRefs[n.data.index];s(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}}if(ut().get("IS_BROWSER")){ut().setPlatform("browser",new YV);try{Fa.registerManager(Ac.URL_SCHEME,new KV)}catch{}try{Fa.registerManager(Nc.URL_SCHEME,new UV)}catch{}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZV={importFetch:()=>require("node-fetch")};let Bv;class QV{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(e,t){return ut().global.fetch!=null?ut().global.fetch(e,t):(Bv==null&&(Bv=ZV.importFetch()),Bv(e,t))}now(){const e=process.hrtime();return e[0]*1e3+e[1]/1e6}encode(e,t){if(t!=="utf-8"&&t!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${t}`);return this.textEncoder.encode(e)}decode(e,t){return e.length===0?"":new this.util.TextDecoder(t).decode(e)}}ut().get("IS_NODE")&&!ut().get("IS_BROWSER")&&ut().setPlatform("node",new QV);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wn(r,e="float32",t){return e=e||"float32",xC(r),new Ws(r,e,t)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JV(r,e){const t=ke(r,"x","cast");if(!X6(e))throw new Error(`Failed to cast to unknown dtype ${e}`);if(e==="string"&&t.dtype!=="string"||e!=="string"&&t.dtype==="string")throw new Error("Only strings can be casted to strings");const n={x:t},s={dtype:e};return Xe.runKernel(sp,n,s)}const Yt=Ze({cast_:JV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eG(r){const t={x:ke(r,"x","clone","string_or_numeric")};return Xe.runKernel(yp,t)}const Sc=Ze({clone_:eG});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tG(r,e=!1){console.log(r.toString(e))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */YC();const nG={buffer:Wn,cast:Yt,clone:Sc,print:tG};_V(nG);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rG="model",sG=".json",oG=".weights.bin";function Kk(r){return new Promise(e=>setTimeout(e)).then(r)}class Rc{constructor(e){if(!ut().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(Rc.URL_SCHEME)&&(e=e.slice(Rc.URL_SCHEME.length)),(e==null||e.length===0)&&(e=rG),this.modelJsonFileName=e+sG,this.weightDataFileName=e+oG}async save(e){if(typeof document=="undefined")throw new Error("Browser downloads are not supported in this environment since `document` is not present");const t=window.URL.createObjectURL(new Blob([e.weightData],{type:"application/octet-stream"}));if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const n=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],s=n$(e,n),o=window.URL.createObjectURL(new Blob([JSON.stringify(s)],{type:"application/json"})),a=this.modelJsonAnchor==null?document.createElement("a"):this.modelJsonAnchor;if(a.download=this.modelJsonFileName,a.href=o,await Kk(()=>a.dispatchEvent(new MouseEvent("click"))),e.weightData!=null){const i=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor;i.download=this.weightDataFileName,i.href=t,await Kk(()=>i.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:V0(e)}}}}Rc.URL_SCHEME="downloads://";const iG=r=>ut().getBool("IS_BROWSER")&&!Array.isArray(r)&&r.startsWith(Rc.URL_SCHEME)?aG(r.slice(Rc.URL_SCHEME.length)):null;vs.registerSaveRouter(iG);function aG(r="model"){return new Rc(r)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yk(r,e,t,n){a(r),t=t==null?0:t,n=n==null?1:n,i(t,n);let s=0;const o=l=>(l.then(u=>{const h=t+ ++s/r.length*(n-t);return e(h),u}),l);function a(l){xe(l!=null&&Array.isArray(l)&&l.length>0,()=>"promises must be a none empty array")}function i(l,u){xe(l>=0&&l<=1,()=>`Progress fraction must be in range [0, 1], but got startFraction ${l}`),xe(u>=0&&u<=1,()=>`Progress fraction must be in range [0, 1], but got endFraction ${u}`),xe(u>=l,()=>`startFraction must be no more than endFraction, but got startFraction ${l} and endFraction ${u}`)}return Promise.all(r.map(o))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function lG(r,e){e==null&&(e={});const t=e.fetchFunc==null?ut().platform.fetch:e.fetchFunc,n=r.map(d=>t(d,e.requestInit,{isBinary:!0})),s=0,o=.5,i=(e.onProgress==null?await Promise.all(n):await Yk(n,e.onProgress,s,o)).map(d=>d.arrayBuffer()),l=.5,u=1;return e.onProgress==null?await Promise.all(i):await Yk(i,e.onProgress,l,u)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uG="application/octet-stream",cG="application/json";class Mw{constructor(e,t){if(this.DEFAULT_METHOD="POST",t==null&&(t={}),this.weightPathPrefix=t.weightPathPrefix,this.onProgress=t.onProgress,this.weightUrlConverter=t.weightUrlConverter,t.fetchFunc!=null?(xe(typeof t.fetchFunc=="function",()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=t.fetchFunc):this.fetch=ut().platform.fetch,xe(e!=null&&e.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(e)&&xe(e.length===2,()=>`URL paths for http must have a length of 2, (actual length is ${e.length}).`),this.path=e,t.requestInit!=null&&t.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=t.requestInit||{}}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const t=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);t.body=new FormData;const n=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],s=n$(e,n);t.body.append("model.json",new Blob([JSON.stringify(s)],{type:cG}),"model.json"),e.weightData!=null&&t.body.append("model.weights.bin",new Blob([e.weightData],{type:uG}),"model.weights.bin");const o=await this.fetch(this.path,t);if(o.ok)return{modelArtifactsInfo:V0(e),responses:[o]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${o.status}.`)}async load(){const e=await this.fetch(this.path,this.requestInit);if(!e.ok)throw new Error(`Request to ${this.path} failed with status code ${e.status}. Please verify this URL points to the model JSON of the model to load.`);let t;try{t=await e.json()}catch{let a=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?a+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":a+=" Please make sure the server is serving valid JSON for this request.",new Error(a)}const n=t.modelTopology,s=t.weightsManifest;if(n==null&&s==null)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return FV(t,o=>this.loadWeights(o))}async loadWeights(e){const t=Array.isArray(this.path)?this.path[1]:this.path,[n,s]=hG(t),o=this.weightPathPrefix||n,a=LV(e),i=[],l=[];for(const h of e)for(const d of h.paths)this.weightUrlConverter!=null?l.push(this.weightUrlConverter(d)):i.push(o+d+s);this.weightUrlConverter&&i.push(...await Promise.all(l));const u=await lG(i,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress});return[a,t$(u)]}}Mw.URL_SCHEME_REGEX=/^https?:\/\//;function hG(r){const e=r.lastIndexOf("/"),t=r.lastIndexOf("?"),n=r.substring(0,e),s=t>e?r.substring(t):"";return[n+"/",s]}function Zk(r){return r.match(Mw.URL_SCHEME_REGEX)!=null}const u$=(r,e)=>{if(typeof fetch=="undefined"&&(e==null||e.fetchFunc==null))return null;{let t=!0;if(Array.isArray(r)?t=r.every(n=>Zk(n)):t=Zk(r),t)return dG(r,e)}return null};vs.registerSaveRouter(u$);vs.registerLoadRouter(u$);function dG(r,e){return new Mw(r,e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fG(r,e,t=!1,n=!1){let s=ke(r,"a","matMul"),o=ke(e,"b","matMul");[s,o]=Jr(s,o);const a={a:s,b:o},i={transposeA:t,transposeB:n};return Xe.runKernel(Wy,a,i)}const lr=Ze({matMul_:fG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pG(r,e,t=1,n=0,s="int32"){if(e<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${e}`);const a={indices:ke(r,"indices","oneHot","int32")},i={dtype:s,depth:e,onValue:t,offValue:n};return Xe.runKernel(S0,a,i)}const c$=Ze({oneHot_:pG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tu(){return Xe}function Ab(){return Xe.memory()}function at(r,e){return Xe.tidy(r,e)}function Kn(r){XC(r).forEach(t=>t.dispose())}function Ya(r){return Xe.keep(r)}function mG(r){return Xe.setBackend(r)}function h$(r,e,t=1){return Xe.registerBackend(r,e,t)}function gG(){return Xe.backend}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yG(r){const t={input:ke(r,"input","imag")};return Xe.runKernel(lw,t)}const Fw=Ze({imag_:yG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vG(r){const t={x:ke(r,"x","neg")};return Xe.runKernel(b0,t)}const Wr=Ze({neg_:vG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bG(r){const t={input:ke(r,"input","real")};return Xe.runKernel(gw,t)}const ny=Ze({real_:bG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xG(r,e,t){const n=ke(r,"x","transpose");if(e==null&&(e=n.shape.map((a,i)=>i).reverse()),xe(n.rank===e.length,()=>`Error in transpose: rank of input ${n.rank} must match length of perm ${e}.`),e.forEach(a=>{xe(a>=0&&a<n.rank,()=>`All entries in 'perm' must be between 0 and ${n.rank-1} but got ${e}`)}),n.rank<=1)return n.clone();const s={x:n},o={perm:e};return n.dtype==="complex64"?at(()=>{let a=ny(n),i=Fw(n);return a=Xe.runKernel(Bh,{x:a},o),i=Xe.runKernel(Bh,{x:i},o),t&&(i=Wr(i)),Qh(a,i)}):Xe.runKernel(Bh,s,o)}const nr=Ze({transpose_:xG});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jh(r,e){const t=r.length,n=[];for(let s=0;s<t;s++){const o=t-1-s,a=r[o]||1;(e[e.length-1-s]||1)>1&&a===1&&n.unshift(o)}return n}function fs(r,e){const t=[];for(let n=0;n<e.length;n++){const s=r[r.length-n-1],o=e.length-n-1,a=e[o];(s==null||s===1&&a>1)&&t.unshift(o)}return t}function Dn(r,e){const t=[],n=Math.max(r.length,e.length);for(let s=0;s<n;s++){let o=r[r.length-s-1];o==null&&(o=1);let a=e[e.length-s-1];if(a==null&&(a=1),o===1)t.unshift(a);else if(a===1)t.unshift(o);else if(o!==a){const i=`Operands could not be broadcast together with shapes ${r} and ${e}.`;throw Error(i)}else t.unshift(o)}return t}function Lw(r,e){const t=r.shape.length,n=e.shape.length;if(t<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${t}.`);if(n<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${n}.`);if(e.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.shape[n-1]>t)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${e.shape[n-1]} vs. ${t}`);if(pt(r.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${r.shape}.`);const s=e.shape,o=s[s.length-1];let a=1;for(let d=0;d<s.length-1;++d)a*=s[d];const i=r.shape,l=s.slice();l.pop();let u=1;for(let d=o;d<t;++d)u*=i[d],l.push(i[d]);const h=[...pn(r.shape).map(d=>d/u),1].slice(0,o);return[l,a,u,h]}function d$(r,e,t){const n=e.rank>1?e.shape[e.rank-1]:1,s=e.rank>1?e.rank-1:1,o=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${t.shape}, indices.shape: ${e.shape}, shape: ${r}, sliceDim: ${n}, and batchDim: ${s}.`;if(t.rank<s)throw new Error(o+` update.rank < ${s}. `);if(r.length<n+(t.rank-s))throw new Error(o+` Output shape length < ${n+(t.rank-s)}`);if(t.rank!==s+r.length-n)throw new Error(o+` update.rank != ${s+r.length-n}`);for(let a=0;a<s;++a)if(t.shape[a]!==e.shape[a])throw new Error(o+` updates.shape[${a}] (${t.shape[a]}) != indices.shape[${a}] (${e.shape[a]}).`);for(let a=0;a<t.rank-s;++a)if(t.shape[a+s]!==r[a+n])throw new Error(o+` updates.shape[${a+s}] (${t.shape[a+s]}) != shape[${a+s}] (${r[a+s]})`)}function wG(r,e,t){if(e.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${e.rank}.`);if(r.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${r.rank}.`);if(e.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${e.dtype}`);if(t.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${t}`);if(t.length===0){if(e.size===0)throw new Error(`Indices specified for empty output. indices shape: ${e.shape}`);if(r.size===0)throw new Error(`Updates specified for empty output. updates shape: ${r.shape}`)}d$(t,e,r)}function Hp(r,e,t){const n=e.shape.length,s=n>1?e.shape[n-1]:1,o=t.length;let a=1;for(let d=s;d<o;++d)a*=t[d];const i=s<1?1:s,l=pt(e.shape)/i,u=[...pn(t.slice(0,s)),1],h=pt(t);return{sliceRank:s,numUpdates:l,sliceSize:a,strides:u,outputSize:h}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rb=-2,SG=-1;function Pw(r,e,t){const n=r.shape.length;xe(n===e.length,()=>`Error in slice${n}D: Length of begin ${e} must match the rank of the array (${n}).`),xe(n===t.length,()=>`Error in slice${n}D: Length of size ${t} must match the rank of the array (${n}).`);for(let s=0;s<n;++s)xe(e[s]+t[s]<=r.shape[s],()=>`Error in slice${n}D: begin[${s}] + size[${s}] (${e[s]+t[s]}) would overflow input.shape[${s}] (${r.shape[s]})`)}function _G(r){const e=[];let t=0;for(;r>0;)r&1&&e.push(t),r/=2,t++;return e}function jw(r,e,t){const n=[];for(let s=0;s<r.length;s++)n[s]=Math.ceil((e[s]-r[s])/t[s]);return n}function f$(r,e,t,n){const s=[...r];for(let o=s.length;o<n.length;o++)s.push(1);for(let o=0;o<t;o++)o===0?s[e]=1:(s.splice(e,0,1),s.pop());return s}function p$(r,e,t){return t<=r?t:t-(e-1)}function m$(r,e){const t=[];for(let n=0;n<r;n++)t.push(e+n);return t}function TG(r,e,t,n,s,o,a,i,l){const u=r.length;let h=new Array(u),d=new Array(u),c=new Array(u);if(e.length&&t>0){const f=e[0],p=t+1;h=g$(a,f,p,n,r),d=y$(i,f,p,s,r),c=f$(o,f,p,r)}else for(let f=0;f<u;f++)h[f]=b$(a,n,o,r,f,l),d[f]=x$(i,s,o,r,f,l),c[f]=v$(o,f,l);return{begin:h,end:d,strides:c}}function g$(r,e,t,n,s){const o=[...s],a=m$(t,e);for(let i=0;i<o.length;i++)if(a.indexOf(i)>-1)o[i]=0;else{const l=p$(e,t,i);let u=n[l];r&1<<l&&(u=0),o[i]=u}return o}function y$(r,e,t,n,s){const o=[...s],a=m$(t,e);for(let i=0;i<o.length;i++)if(a.indexOf(i)>-1)o[i]=Number.MAX_SAFE_INTEGER;else{const l=p$(e,t,i);let u=n[l];r&1<<l&&(u=Number.MAX_SAFE_INTEGER),o[i]=u}for(let i=0;i<o.length;i++){const l=s[i];o[i]<0&&(o[i]+=l),o[i]=$c(0,o[i],s[i])}return o}function v$(r,e,t){let n=r[e];return(t&1<<e||n==null)&&(n=1),n}function b$(r,e,t,n,s,o){let a=e[s];const i=t[s]||1;(r&1<<s||o&1<<s||a==null)&&(i>0?a=Number.MIN_SAFE_INTEGER:a=Number.MAX_SAFE_INTEGER);const l=n[s];return a<0&&(a+=l),a=$c(0,a,l-1),a}function x$(r,e,t,n,s,o){let a=e[s];const i=t[s]||1;(r&1<<s||o&1<<s||a==null)&&(i>0?a=Number.MAX_SAFE_INTEGER:a=Number.MIN_SAFE_INTEGER);const l=n[s];return a<0&&(a+=l),i>0?a=$c(0,a,l):a=$c(-1,a,l-1),a}function Bw(r,e,t){let n=t.length;for(let s=0;s<t.length;s++)if(t[s]>1){n=s;break}for(let s=n+1;s<t.length;s++)if(e[s]>0||t[s]!==r[s])return!1;return!0}function Uw(r,e){let t=r.length>0?r[r.length-1]:1;for(let n=0;n<r.length-1;n++)t+=r[n]*e[n];return t}function G0(r,e,t){let n;const s=r.shape.length;typeof e=="number"?n=[e,...new Array(s-1).fill(0)]:e.length<s?n=e.concat(new Array(s-e.length).fill(0)):n=e.slice(),n.forEach(a=>{xe(a!==-1,()=>"slice() does not support negative begin indexing.")});let o;return t==null?o=new Array(s).fill(-1):typeof t=="number"?o=[t,...new Array(s-1).fill(-1)]:t.length<s?o=t.concat(new Array(s-t.length).fill(-1)):o=t,o=o.map((a,i)=>a>=0?a:(xe(a===-1,()=>`Negative size values should be exactly -1 but got ${a} for the slice() size at index ${i}.`),r.shape[i]-n[i])),[n,o]}function zw(r,e,t,n,s,o,a,i,l){let u;if(n==null?(u=new Array(e.length),u.fill(1)):u=n,a!=null&&(a&a-1)!==0)throw new Error("Multiple ellipses in slice is not allowed.");let h=!1;const d={dims:u.length,numAddAxisAfterEllipsis:0,begin:e.slice(),end:t.slice(),strides:u.slice(),beginMask:s,endMask:o,ellipsisMask:a,newAxisMask:i,shrinkAxisMask:l};for(let b=0;b<d.dims;b++)h&&(1<<b&i)!==0&&d.numAddAxisAfterEllipsis++,1<<b&a&&(h=!0);h||(d.ellipsisMask|=1<<d.dims,d.dims++);const c={dims:r.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};kG(d,c);let f=!0,p=!0,m=!0;const g=[],y=[];for(let b=0;b<r.length;++b){if(c.strides[b]===0)throw Error(`strides[${b}] must be non-zero`);const w=!!(c.shrinkAxisMask&1<<b),_=r[b];if(_===-1){g.push(w?1:-1);continue}const I=[c.beginMask&1<<b,c.endMask&1<<b],C=[c.strides[b]>0?0:-1,c.strides[b]>0?_:_-1];if(w&&c.strides[b]<=0)throw Error("only stride 1 allowed on non-range indexing.");m=m&&c.strides[b]===1;const N=!!(c.beginMask&1<<b&&c.endMask&1<<b);if(c.beginValid&&c.endValid){if(w){const P=c.begin[b]<0?_+c.begin[b]:c.begin[b];if(c.begin[b]=P,c.end[b]=c.begin[b]+1,P<0||P>=_)throw Error(`slice index ${c.begin[b]} of dimension ${b} out of bounds.`)}else c.begin[b]=Qk(c.begin[b],0,c.strides[b],_,I,C),c.end[b]=Qk(c.end[b],1,c.strides[b],_,I,C);const M=c.strides[b]===1&&c.begin[b]===0&&c.end[b]===_;f=f&&M,p=p&&(b===0&&c.strides[b]===1||M)}else f=f&&c.strides[b]===1&&N,p=p&&(b===0&&c.strides[b]===1||N);let O,D=!1;if(c.beginValid&&c.endValid?(O=c.end[b]-c.begin[b],D=!0):w?(O=1,D=!0):N&&_>=0&&(c.strides[b]<0?O=-_:O=_,D=!0),D){let M;O===0||O<0!=c.strides[b]<0?M=0:M=Math.trunc(O/c.strides[b])+(O%c.strides[b]!==0?1:0),g.push(M)}else g.push(-1)}for(let b=0;b<c.finalShapeGatherIndices.length;++b){const w=c.finalShapeGatherIndices[b];w>=0?y.push(g[w]):w===Rb&&y.push(1)}return{finalShapeSparse:y.filter((b,w)=>c.finalShapeGatherIndices[w]!==Rb),finalShape:y,isIdentity:f,sliceDim0:p,isSimpleSlice:m,begin:c.begin,end:c.end,strides:c.strides}}function kG(r,e){e.beginMask=0,e.endMask=0,e.shrinkAxisMask=0;let t=0;e.beginValid=r.begin!=null,e.endValid=r.end!=null,e.begin=new Array(e.dims),e.end=new Array(e.dims),e.strides=new Array(e.dims),e.finalShapeGatherIndices=[],e.finalShapeGatherIndicesSparse=[],e.inputShapeGatherIndicesSparse=new Array(e.dims);for(let n=0;n<r.dims;n++)if(1<<n&r.ellipsisMask){const s=Math.min(e.dims-(r.dims-n)+1+r.numAddAxisAfterEllipsis,e.dims);for(;t<s;t++)e.begin[t]=0,e.end[t]=0,e.strides[t]=1,e.beginMask|=1<<t,e.endMask|=1<<t,e.finalShapeGatherIndices.push(t),e.finalShapeGatherIndicesSparse.push(-1),e.inputShapeGatherIndicesSparse[t]=n}else if(1<<n&r.newAxisMask)e.finalShapeGatherIndices.push(Rb),e.finalShapeGatherIndicesSparse.push(-1);else{if(t===e.begin.length)throw Error(`Index out of range using input dim ${t}; input has only ${e.dims} dims, ${e.begin.length}.`);r.begin!=null&&(e.begin[t]=r.begin[n]),r.end!=null&&(e.end[t]=r.end[n]),e.strides[t]=r.strides[n],r.beginMask&1<<n&&(e.beginMask|=1<<t),r.endMask&1<<n&&(e.endMask|=1<<t),r.shrinkAxisMask&1<<n?(e.finalShapeGatherIndices.push(SG),e.finalShapeGatherIndicesSparse.push(-1),e.shrinkAxisMask|=1<<t):(e.finalShapeGatherIndices.push(t),e.finalShapeGatherIndicesSparse.push(n)),e.inputShapeGatherIndicesSparse[t]=n,t++}}function Qk(r,e,t,n,s,o){if(s[e])return t>0?o[e]:o[e+1&1];{const a=r<0?n+r:r;return a<o[0]?o[0]:a>o[1]?o[1]:a}}var IG=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",assertParamsValid:Pw,maskToAxes:_G,computeOutShape:jw,stridesWithElidedDims:f$,getNormalizedAxes:TG,startIndicesWithElidedDims:g$,stopIndicesWithElidedDims:y$,stridesForAxis:v$,startForAxis:b$,stopForAxis:x$,isSliceContinous:Bw,computeFlatOffset:Uw,parseSliceParams:G0,sliceInfo:zw});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xd{getClassName(){return this.constructor.className}static fromConfig(e,t){return new e(t)}}class Mi{constructor(){this.classNameMap={}}static getMap(){return Mi.instance==null&&(Mi.instance=new Mi),Mi.instance}static register(e){Mi.getMap().classNameMap[e.className]=[e,e.fromConfig]}}function Et(r){xe(r.className!=null,()=>"Class being registered does not have the static className property defined."),xe(typeof r.className=="string",()=>"className is required to be a string, but got type "+typeof r.className),xe(r.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),Mi.register(r)}/** @license See the LICENSE file. *//**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EG(r,e){let t=ke(r,"a","add"),n=ke(e,"b","add");[t,n]=Jr(t,n);const s={a:t,b:n};return Xe.runKernel(bd,s)}const Rt=Ze({add_:EG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CG(r,e){let t=ke(r,"a","floorDiv"),n=ke(e,"b","floorDiv");[t,n]=Jr(t,n);const s={a:t,b:n};return Xe.runKernel(mp,s)}const w$=Ze({floorDiv_:CG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $G(r,e){let t=ke(r,"a","div"),n=ke(e,"b","div");if([t,n]=Jr(t,n),t.dtype==="int32"&&n.dtype==="int32")return w$(t,n);const s={a:t,b:n},o={};return Xe.runKernel(up,s,o)}const fn=Ze({div_:$G});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NG(r,e){let t=ke(r,"a","mul"),n=ke(e,"b","mul");[t,n]=Jr(t,n);const s={a:t,b:n};return Xe.runKernel(Ip,s)}const We=Ze({mul_:NG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AG(r){const e=ke(r,"x","abs");if(e.dtype==="complex64"){const t={x:e};return Xe.runKernel(qy,t)}else{const t={x:e};return Xe.runKernel(By,t)}}const bs=Ze({abs_:AG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RG(r){const t={x:ke(r,"x","acos")};return Xe.runKernel(Zf,t)}const DG=Ze({acos_:RG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OG(r){const t={x:ke(r,"x","acosh")};return Xe.runKernel(Qf,t)}const MG=Ze({acosh_:OG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FG(r,e=null,t=!1){const s={x:ke(r,"x","all","bool")},o={axis:e,keepDims:t};return Xe.runKernel(Vx,s,o)}const S$=Ze({all_:FG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LG(r,e=null,t=!1){const s={x:ke(r,"x","any","bool")},o={axis:e,keepDims:t};return Xe.runKernel(Gx,s,o)}const Db=Ze({any_:LG});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PG(r,e=0){const n={x:ke(r,"x","argMax")},s={axis:e};return Xe.runKernel(Uy,n,s)}const If=Ze({argMax_:PG});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jG(r,e=0){const n={x:ke(r,"x","argMin")},s={axis:e};return Xe.runKernel(zy,n,s)}const BG=Ze({argMin_:jG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UG(r){const t={x:ke(r,"x","asin")};return Xe.runKernel(Jf,t)}const zG=Ze({asin_:UG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VG(r){const t={x:ke(r,"x","asinh")};return Xe.runKernel(ep,t)}const GG=Ze({asinh_:VG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WG(r){const t={x:ke(r,"x","atan")};return Xe.runKernel(tp,t)}const HG=Ze({atan_:WG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qG(r,e){let t=ke(r,"a","atan2"),n=ke(e,"b","atan2");[t,n]=Jr(t,n);const s={a:t,b:n};return Xe.runKernel(rp,s)}const XG=Ze({atan2_:qG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KG(r){const t={x:ke(r,"x","atanh")};return Xe.runKernel(np,t)}const YG=Ze({atanh_:KG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qp(r,e,t,n,s="NHWC",o){const a=r[3],i=[...e,a],l=Rl(s);return Ms(r,i,t,o,n,null,null,l)}function Xi(r,e,t,n,s,o,a="channelsLast"){const[i,l]=ry(e);let u;if(a==="channelsLast")u=[i,l,r[3],r[3]];else if(a==="channelsFirst")u=[i,l,r[1],r[1]];else throw new Error(`Unknown dataFormat ${a}`);return Ms(r,u,t,n,s,o,!1,a)}function Al(r,e,t,n,s,o,a="NDHWC"){const[i,l,u]=Ob(e);let h,d;if(a==="NDHWC")d="channelsLast",h=[i,l,u,r[4],r[4]];else if(a==="NCDHW")d="channelsFirst",h=[i,l,u,r[1],r[1]];else throw new Error(`Unknown dataFormat ${a}`);return Iu(r,h,t,n,s,!1,d,o)}function Ms(r,e,t,n,s,o,a=!1,i="channelsLast"){let[l,u,h,d]=[-1,-1,-1,-1];if(i==="channelsLast")[l,u,h,d]=r;else if(i==="channelsFirst")[l,d,u,h]=r;else throw new Error(`Unknown dataFormat ${i}`);const[c,f,,p]=e,[m,g]=ry(t),[y,v]=ry(n),b=Uh(c,y),w=Uh(f,v),{padInfo:_,outHeight:I,outWidth:C}=JG(s,u,h,m,g,b,w,o,i),N=a?p*d:p;let O;return i==="channelsFirst"?O=[l,N,I,C]:i==="channelsLast"&&(O=[l,I,C,N]),{batchSize:l,dataFormat:i,inHeight:u,inWidth:h,inChannels:d,outHeight:I,outWidth:C,outChannels:N,padInfo:_,strideHeight:m,strideWidth:g,filterHeight:c,filterWidth:f,effectiveFilterHeight:b,effectiveFilterWidth:w,dilationHeight:y,dilationWidth:v,inShape:r,outShape:O,filterShape:e}}function Iu(r,e,t,n,s,o=!1,a="channelsLast",i){let[l,u,h,d,c]=[-1,-1,-1,-1,-1];if(a==="channelsLast")[l,u,h,d,c]=r;else if(a==="channelsFirst")[l,c,u,h,d]=r;else throw new Error(`Unknown dataFormat ${a}`);const[f,p,m,,g]=e,[y,v,b]=Ob(t),[w,_,I]=Ob(n),C=Uh(f,w),N=Uh(p,_),O=Uh(m,I),{padInfo:D,outDepth:M,outHeight:P,outWidth:F}=eW(s,u,h,d,y,v,b,C,N,O,i),B=o?g*c:g;let z;return a==="channelsFirst"?z=[l,B,M,P,F]:a==="channelsLast"&&(z=[l,M,P,F,B]),{batchSize:l,dataFormat:a,inDepth:u,inHeight:h,inWidth:d,inChannels:c,outDepth:M,outHeight:P,outWidth:F,outChannels:B,padInfo:D,strideDepth:y,strideHeight:v,strideWidth:b,filterDepth:f,filterHeight:p,filterWidth:m,effectiveFilterDepth:C,effectiveFilterHeight:N,effectiveFilterWidth:O,dilationDepth:w,dilationHeight:_,dilationWidth:I,inShape:r,outShape:z,filterShape:e}}function ZG(r,e,t,n,s){n==null&&(n=Vw(r,e,t));const o=r[0],a=r[1],i=_c((o-e+2*n)/t+1,s),l=_c((a-e+2*n)/t+1,s);return[i,l]}function QG(r,e,t,n,s,o){s==null&&(s=Vw(r,e,n));const a=r[0],i=r[1],l=r[2],u=_c((a-e+2*s)/n+1,o),h=_c((i-e+2*s)/n+1,o),d=_c((l-e+2*s)/n+1,o);return[u,h,d,t]}function Vw(r,e,t,n=1){const s=Uh(e,n);return Math.floor((r[0]*(t-1)-t+s)/2)}function ry(r){return typeof r=="number"?[r,r,r]:r.length===2?[r[0],r[1],1]:r}function Ob(r){return typeof r=="number"?[r,r,r]:r}function Uh(r,e){return e<=1?r:r+(r-1)*(e-1)}function JG(r,e,t,n,s,o,a,i,l){let u,h,d;if(typeof r=="number"){u={top:r,bottom:r,left:r,right:r,type:r===0?"VALID":"NUMBER"};const f=ZG([e,t],o,n,r,i);h=f[0],d=f[1]}else if(r==="same"){h=Math.ceil(e/n),d=Math.ceil(t/s);const c=Math.max(0,(h-1)*n+o-e),f=Math.max(0,(d-1)*s+a-t),p=Math.floor(c/2),m=c-p,g=Math.floor(f/2),y=f-g;u={top:p,bottom:m,left:g,right:y,type:"SAME"}}else if(r==="valid")u={top:0,bottom:0,left:0,right:0,type:"VALID"},h=Math.ceil((e-o+1)/n),d=Math.ceil((t-a+1)/s);else if(typeof r=="object"){const c=l==="channelsLast"?r[1][0]:r[2][0],f=l==="channelsLast"?r[1][1]:r[2][1],p=l==="channelsLast"?r[2][0]:r[3][0],m=l==="channelsLast"?r[2][1]:r[3][1];u={top:c,bottom:f,left:p,right:m,type:c===0&&f===0&&p===0&&m===0?"VALID":"EXPLICIT"},h=_c((e-o+c+f)/n+1,i),d=_c((t-a+p+m)/s+1,i)}else throw Error(`Unknown padding parameter: ${r}`);return{padInfo:u,outHeight:h,outWidth:d}}function eW(r,e,t,n,s,o,a,i,l,u,h){let d,c,f,p;if(typeof r=="number"){d={top:r,bottom:r,left:r,right:r,front:r,back:r,type:r===0?"VALID":"NUMBER"};const g=QG([e,t,n,1],i,1,s,r,h);c=g[0],f=g[1],p=g[2]}else if(r==="same"){c=Math.ceil(e/s),f=Math.ceil(t/o),p=Math.ceil(n/a);const m=(c-1)*s+i-e,g=(f-1)*o+l-t,y=(p-1)*a+u-n,v=Math.floor(m/2),b=m-v,w=Math.floor(g/2),_=g-w,I=Math.floor(y/2),C=y-I;d={top:w,bottom:_,left:I,right:C,front:v,back:b,type:"SAME"}}else if(r==="valid")d={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},c=Math.ceil((e-i+1)/s),f=Math.ceil((t-l+1)/o),p=Math.ceil((n-u+1)/a);else throw Error(`Unknown padding parameter: ${r}`);return{padInfo:d,outDepth:c,outHeight:f,outWidth:p}}function _c(r,e){if(!e)return Math.trunc(r);switch(e){case"round":return Math.round(r);case"ceil":return Math.ceil(r);case"floor":return Math.floor(r);default:throw new Error(`Unknown roundingMode ${e}`)}}function Dc(r){const[e,t,n]=ry(r);return e===1&&t===1&&n===1}function Ks(r,e){return Dc(r)||Dc(e)}function Rl(r){if(r==="NHWC")return"channelsLast";if(r==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${r}`)}function _o(r,e,t){if(t!=null){if(typeof e=="string")throw Error(`Error in ${r}: pad must be an integer when using dimRoundingMode ${t} but got pad ${e}.`);if(typeof e=="number")xe(Kh(e),()=>`Error in ${r}: pad must be an integer when using dimRoundingMode ${t} but got pad ${e}.`);else if(typeof e=="object")e.forEach(n=>{n.forEach(s=>{xe(Kh(s),()=>`Error in ${r}: pad must be an integer when using dimRoundingMode ${t} but got pad ${s}.`)})});else throw Error(`Error in ${r}: Unknown padding parameter: ${e}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tW(r,e){const n={x:ke(r,"x","reshape","string_or_numeric")},s={shape:e};return Xe.runKernel(E0,n,s)}const Qe=Ze({reshape_:tW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nW(r,e,t,n,s){const o=ke(r,"x","avgPool","float32"),a=1;xe(Ks(t,a),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${t} and dilations '${a}'`);let i=o,l=!1;o.rank===3&&(l=!0,i=Qe(o,[1,o.shape[0],o.shape[1],o.shape[2]])),xe(i.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${i.rank}.`),_o("avgPool",n,s);const u={x:i},h={filterSize:e,strides:t,pad:n,dimRoundingMode:s};let d=Xe.runKernel(Vy,u,h);return d=Yt(d,o.dtype),l?Qe(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const Gw=Ze({avgPool_:nW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rW(r,e,t,n,s,o="NDHWC"){const a=ke(r,"x","avgPool3d","float32");let i=a,l=!1;a.rank===4&&(l=!0,i=Qe(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),xe(i.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${i.rank}.`),xe(o==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${o}`),_o("avgPool3d",n,s);const u={x:i},h={filterSize:e,strides:t,pad:n,dimRoundingMode:s,dataFormat:o};let d=Xe.runKernel(Gy,u,h);return d=Yt(d,i.dtype),l?Qe(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const sW=Ze({avgPool3d_:rW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oW(r,e=0){xe(r.length>=1,()=>"Pass at least one tensor to concat");const t=e$(r,"tensors","concat","string_or_numeric");if(t[0].dtype==="complex64"&&t.forEach(o=>{if(o.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${o.dtype}. `)}),t.length===1)return Sc(t[0]);const n=t,s={axis:e};return Xe.runKernel(Xy,n,s)}const Hs=Ze({concat_:oW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iW(r){const t={x:ke(r,"x","sigmoid","float32")};return Xe.runKernel(Lp,t)}const wd=Ze({sigmoid_:iW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aW(r,e,t){const n=ke(r,"x","slice","string_or_numeric");if(n.rank===0)throw new Error("Slicing scalar is not possible");const s={x:n},o={begin:e,size:t};return Xe.runKernel(R0,s,o)}const _r=Ze({slice_:aW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lW(r){const t={x:ke(r,"x","tanh","float32")};return Xe.runKernel(Vp,t)}const Ww=Ze({tanh_:lW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uW(r,e,t){const n=ke(r,"x","batchToSpaceND"),s=e.reduce((i,l)=>i*l);xe(n.rank>=1+e.length,()=>`input rank is ${n.rank} but should be > than blockShape.length ${e.length}`),xe(t.length===e.length,()=>`crops.length is ${t.length} but should be equal to blockShape.length  ${e.length}`),xe(n.shape[0]%s===0,()=>`input tensor batch is ${n.shape[0]} but is not divisible by the product of the elements of blockShape ${e.join(" * ")} === ${s}`);const o={x:n},a={blockShape:e,crops:t};return Xe.runKernel(Hy,o,a)}const Hw=Ze({batchToSpaceND_:uW});function cW(r){let e;return r.rank===0||r.rank===1?e=Qe(r,[1,1,1,r.size]):r.rank===2?e=Qe(r,[1,1,r.shape[0],r.shape[1]]):r.rank===3?e=Qe(r,[1,r.shape[0],r.shape[1],r.shape[2]]):e=r,e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hW(r,e,t,n,s,o){o==null&&(o=.001);const a=ke(r,"x","batchNorm"),i=ke(e,"mean","batchNorm"),l=ke(t,"variance","batchNorm");let u;s!=null&&(u=ke(s,"scale","batchNorm"));let h;n!=null&&(h=ke(n,"offset","batchNorm")),xe(i.rank===l.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),xe(h==null||i.rank===h.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),xe(u==null||i.rank===u.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const c={x:cW(a),scale:u,offset:h,mean:i,variance:l},f={varianceEpsilon:o},p=Xe.runKernel(r0,c,f);return Qe(p,a.shape)}const W0=Ze({batchNorm_:hW});function dW(r,e,t,n,s,o){const a=ke(r,"x","batchNorm"),i=ke(e,"mean","batchNorm"),l=ke(t,"variance","batchNorm");let u;s!=null&&(u=ke(s,"scale","batchNorm"));let h;return n!=null&&(h=ke(n,"offset","batchNorm")),xe(a.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${a.rank}.`),xe(i.rank===2||i.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${i.rank}.`),xe(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${l.rank}.`),u!=null&&xe(u.rank===2||u.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${u.rank}.`),h!=null&&xe(h.rank===2||h.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${h.rank}.`),W0(a,i,l,h,u,o)}const fW=Ze({batchNorm2d_:dW});function pW(r,e,t,n,s,o){const a=ke(r,"x","batchNorm"),i=ke(e,"mean","batchNorm"),l=ke(t,"variance","batchNorm");let u;s!=null&&(u=ke(s,"scale","batchNorm"));let h;return n!=null&&(h=ke(n,"offset","batchNorm")),xe(a.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${a.rank}.`),xe(i.rank===3||i.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${i.rank}.`),xe(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${l.rank}.`),u!=null&&xe(u.rank===3||u.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${u.rank}.`),h!=null&&xe(h.rank===3||h.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${h.rank}.`),W0(a,i,l,h,u,o)}const mW=Ze({batchNorm3d_:pW});function gW(r,e,t,n,s,o){const a=ke(r,"x","batchNorm"),i=ke(e,"mean","batchNorm"),l=ke(t,"variance","batchNorm");let u;s!=null&&(u=ke(s,"scale","batchNorm"));let h;return n!=null&&(h=ke(n,"offset","batchNorm")),xe(a.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${a.rank}.`),xe(i.rank===4||i.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${i.rank}.`),xe(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${l.rank}.`),u!=null&&xe(u.rank===4||u.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${u.rank}.`),h!=null&&xe(h.rank===4||h.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${h.rank}.`),W0(a,i,l,h,u,o)}const yW=Ze({batchNorm4d_:gW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vW(r,e,t){const n=ke(r,"x","bincount"),s=ke(e,"weights","bincount");xe(n.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${n.dtype}`),xe(t>=0,()=>`size must be non-negative, but got ${t}.`),xe(s.size===n.size||s.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${n.shape}, weights shape: ${s.shape}.`);const o={x:n,weights:s},a={size:t};return Xe.runKernel(qx,o,a)}const bW=Ze({bincount_:vW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xW(r,e){let t=ke(r,"broadcastTo","x");const n=t.shape;if(e.some(u=>!(u>0)||u%1!==0))throw new Error(`broadcastTo(): Invalid broadcast shape [${e}].`);if(e.length<t.rank)throw new Error(`broadcastTo(): shape.length=${e.length} < input.rank=${t.rank}.`);if(e.length>t.rank){const u=t.shape.slice();for(;u.length<e.length;)u.unshift(1);t=Qe(t,u)}const s=t.shape,o=Array.from(e);for(let u=e.length-1;u>=0;u--)if(s[u]===e[u])o[u]=1;else if(t.shape[u]!==1)throw new Error(`broadcastTo(): [${n}] cannot be broadcast to [${e}].`);if(o.map((u,h)=>u>1?h:-1).filter(u=>u>=0).length===0)return Sc(t);const i={x:t},l={reps:o};return Xe.runKernel(Gp,i,l)}const Sf=Ze({broadcastTo_:xW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wW(r){const t={x:ke(r,"x","ceil","float32")};return Xe.runKernel(op,t)}const SW=Ze({ceil_:wW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xp(r,e,t){const n={shape:r,value:e,dtype:t};return Xe.runKernel(ow,{},n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _W(r,e,t){const n=ke(r,"x","clipByValue");if(xe(e<=t,()=>`Error in clip: min (${e}) must be less than or equal to max (${t}).`),e===t)return Xp(n.shape,e,n.dtype);const s={x:n},o={clipValueMin:e,clipValueMax:t};return Xe.runKernel(ip,s,o)}const pi=Ze({clipByValue_:_W});function TW(r){return Hs(r,0)}const kW=Ze({concat1d_:TW});function IW(r,e){return Hs(r,e)}const EW=Ze({concat2d_:IW});function CW(r,e){return Hs(r,e)}const $W=Ze({concat3d_:CW});function NW(r,e){return Hs(r,e)}const AW=Ze({concat4d_:NW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RW(r,e,t,n,s="NHWC",o=[1,1],a){const i=ke(r,"x","conv2d","float32"),l=ke(e,"filter","conv2d","float32");let u=i,h=!1;i.rank===3&&(h=!0,u=Qe(i,[1,i.shape[0],i.shape[1],i.shape[2]])),xe(u.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${u.rank}.`),xe(l.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${l.rank}.`),_o("conv2d",n,a);const d=s==="NHWC"?u.shape[3]:u.shape[1];xe(d===l.shape[2],()=>`Error in conv2d: depth of input (${d}) must match input depth for filter ${l.shape[2]}.`),xe(Ks(t,o),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${t} and dilations '${o}'`);const c={x:u,filter:l},f={strides:t,pad:n,dataFormat:s,dilations:o,dimRoundingMode:a},p=Xe.runKernel(Ky,c,f);return h?Qe(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const Oc=Ze({conv2d_:RW});function DW(r,e,t,n,s="NWC",o=1,a){const i=ke(r,"x","conv1d"),l=ke(e,"filter","conv1d");let u=i,h=!1;i.rank===2&&(h=!0,u=Qe(i,[1,i.shape[0],i.shape[1]])),xe(u.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${u.rank}.`),xe(l.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${l.rank}.`),_o("conv1d",n,a),xe(u.shape[2]===l.shape[1],()=>`Error in conv1d: depth of input (${u.shape[2]}) must match input depth for filter ${l.shape[1]}.`),xe(Ks(t,o),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${t} and dilation '${o}'`),xe(s==="NWC",()=>`Error in conv1d: got dataFormat of ${s} but only NWC is currently supported.`);const d=Qe(l,[1,l.shape[0],l.shape[1],l.shape[2]]),c=Qe(u,[u.shape[0],1,u.shape[1],u.shape[2]]),g=Oc(c,d,[1,t],n,"NHWC",[1,o],a);return h?Qe(g,[g.shape[2],g.shape[3]]):Qe(g,[g.shape[0],g.shape[2],g.shape[3]])}const _$=Ze({conv1d_:DW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OW(r,e,t,n,s,o="NHWC",a){xe(r.length===e.rank,()=>`Length of inShape (${r.length}) and rank of dy (${e.rank}) must match`);let i=r,l=e,u=!1;e.rank===3&&(u=!0,l=Qe(e,[1,e.shape[0],e.shape[1],e.shape[2]]),i=[1,r[0],r[1],r[2]]),xe(i.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${i.length}.`),xe(l.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${l.rank}`),xe(t.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${t.rank}`);const h=o==="NHWC"?i[3]:i[1],d=o==="NHWC"?l.shape[3]:l.shape[1];xe(h===t.shape[2],()=>`Error in conv2dDerInput: depth of input (${h}) must match input depth for filter ${t.shape[2]}.`),xe(d===t.shape[3],()=>`Error in conv2dDerInput: depth of output (${d}) must match output depth for filter ${t.shape[3]}.`),_o("conv2dDerInput",s,a);const c={dy:l,filter:t},f={strides:n,pad:s,dataFormat:o,dimRoundingMode:a,inputShape:i},p=Xe.runKernel(Yy,c,f);return u?Qe(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const qw=Ze({conv2DBackpropInput_:OW});function MW(r,e,t,n,s,o){const a=ke(r,"x","conv2dTranspose"),i=ke(e,"filter","conv2dTranspose");return qw(t,a,i,n,s,"NHWC",o)}const T$=Ze({conv2dTranspose_:MW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FW(r,e,t,n,s="NDHWC",o=[1,1,1]){const a=ke(r,"x","conv3d"),i=ke(e,"filter","conv3d");let l=a,u=!1;a.rank===4&&(u=!0,l=Qe(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),xe(l.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${l.rank}.`),xe(i.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${i.rank}.`),xe(l.shape[4]===i.shape[3],()=>`Error in conv3d: depth of input (${l.shape[4]}) must match input depth for filter ${i.shape[3]}.`),xe(Ks(t,o),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${t} and dilations '${o}'`),xe(s==="NDHWC",()=>`Error in conv3d: got dataFormat of ${s} but only NDHWC is currently supported.`);const h={x:l,filter:i},d={strides:t,pad:n,dataFormat:s,dilations:o},c=Xe.runKernel(Zy,h,d);return u?Qe(c,[c.shape[1],c.shape[2],c.shape[3],c.shape[4]]):c}const LW=Ze({conv3d_:FW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PW(r,e,t,n,s){xe(r.length===e.rank,()=>`Length of inShape (${r.length}) and rank of dy (${e.rank}) must match`);let o=r,a=e,i=!1;e.rank===4&&(i=!0,a=Qe(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),o=[1,r[0],r[1],r[2],r[3]]);const l=o[4],u=a.shape[4];xe(o.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${o.length}.`),xe(a.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${a.rank}`),xe(t.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${t.rank}`),xe(l===t.shape[3],()=>`Error in conv3dDerInput: depth of input (${l}) must match input depth for filter ${t.shape[3]}.`),xe(u===t.shape[4],()=>`Error in conv3dDerInput: depth of output (${u}) must match output depth for filter ${t.shape[4]}.`);const h={dy:a,filter:t},d={pad:s,strides:n,inputShape:o},c=Xe.runKernel(Zx,h,d);return i?Qe(c,[c.shape[1],c.shape[2],c.shape[3],c.shape[4]]):c}const k$=Ze({conv3DBackpropInput_:PW});function jW(r,e,t,n,s){const o=ke(r,"x","conv3dTranspose"),a=ke(e,"filter","conv3dTranspose");return k$(t,o,a,n,s)}const BW=Ze({conv3dTranspose_:jW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UW(r){const t={x:ke(r,"x","cos","float32")};return Xe.runKernel(ap,t)}const Xw=Ze({cos_:UW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zW(r){const t={x:ke(r,"x","cosh","float32")};return Xe.runKernel(lp,t)}const I$=Ze({cosh_:zW});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VW(r,e=0,t=!1,n=!1){const o={x:ke(r,"x","cumprod")},a={axis:e,exclusive:t,reverse:n};return Xe.runKernel(Qx,o,a)}const Mb=Ze({cumprod_:VW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GW(r,e=0,t=!1,n=!1){const o={x:ke(r,"x","cumsum")},a={axis:e,exclusive:t,reverse:n};return Xe.runKernel(Qy,o,a)}const E$=Ze({cumsum_:GW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WW(r,e,t="NHWC"){const n=ke(r,"x","depthToSpace","float32"),s=t==="NHWC"?n.shape[1]:n.shape[2],o=t==="NHWC"?n.shape[2]:n.shape[3],a=t==="NHWC"?n.shape[3]:n.shape[1];xe(e>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${e}`),xe(s*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${s} and ${e}  for depthToSpace with input shape
    ${n.shape}`),xe(o*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${o} and ${e} for depthToSpace with input shape
        ${n.shape}`),xe(a%(e*e)===0,()=>`Dimension size must be evenly divisible by ${e*e} but is ${a} for depthToSpace with input shape ${n.shape}`);const i={x:n},l={blockSize:e,dataFormat:t};return Xe.runKernel(ew,i,l)}const HW=Ze({depthToSpace_:WW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qW(r,e,t,n,s="NHWC",o=[1,1],a){const i=ke(r,"x","depthwiseConv2d","float32"),l=ke(e,"filter","depthwiseConv2d","float32");let u=i,h=!1;i.rank===3&&(h=!0,u=Qe(i,[1,i.shape[0],i.shape[1],i.shape[2]])),xe(u.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${u.rank}.`),xe(l.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${l.rank}.`);const d=s==="NHWC"?u.shape[3]:u.shape[1];xe(d===l.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${d}) must match the inChannels dimension in filter ${l.shape[2]}.`),_o("depthwiseConv2d",n,a);const c={x:u,filter:l},f={strides:t,pad:n,dataFormat:s,dilations:o,dimRoundingMode:a},p=Xe.runKernel(Jy,c,f);return h?Qe(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const Kw=Ze({depthwiseConv2d_:qW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XW(r,e,t,n,s=[1,1],o="NHWC"){const a=ke(r,"x","dilation2d"),i=ke(e,"filter","dilation2d");xe(a.rank===3||a.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${a.rank}.`),xe(i.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${i.rank}.`),xe(o==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${o}`);let l=a,u=!1;a.rank===3&&(l=Qe(a,[1,a.shape[0],a.shape[1],a.shape[2]]),u=!0);const h={x:l,filter:i},d={strides:t,pad:n,dilations:s},c=Xe.runKernel(e0,h,d);return u?Qe(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const KW=Ze({dilation2d_:XW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YW(r,e){let t=ke(r,"a","equal","string_or_numeric"),n=ke(e,"b","equal","string_or_numeric");[t,n]=Jr(t,n),Dn(t.shape,n.shape);const s={a:t,b:n};return Xe.runKernel(t0,s)}const Za=Ze({equal_:YW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZW(r,e,t){const n=ke(e,"a","where"),s=ke(t,"b","where"),o=ke(r,"condition","where","bool"),a=Dn(Dn(o.shape,n.shape),s.shape),i=Sf(o,a),l=Sf(n,a),u=Sf(s,a),h={condition:i,t:l,e:u};return Xe.runKernel(A0,h)}const zo=Ze({where_:ZW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QW(r){const t={x:ke(r,"x","zerosLike")};return Xe.runKernel(j0,t)}const ir=Ze({zerosLike_:QW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JW(r,e){let t=ke(r,"a","div"),n=ke(e,"b","div");[t,n]=Jr(t,n);const s=fn(t,n),o=ir(s),a=Za(n,o);return zo(a,o,s)}const e8=Ze({divNoNan_:JW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t8(r,e){const t=ke(r,"t1","dot"),n=ke(e,"t2","dot");xe((t.rank===1||t.rank===2)&&(n.rank===1||n.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${t.rank} and ${n.rank}.`);const s=t.rank===1?t.size:t.shape[1],o=n.rank===1?n.size:n.shape[0];if(xe(s===o,()=>`Error in dot: inner dimensions of inputs must match, but got ${s} and ${o}.`),t.rank===1&&n.rank===1){const a=Qe(t,[1,-1]),i=Qe(n,[-1,1]),l=lr(a,i);return Qe(l,[])}else if(t.rank===1&&n.rank===2){const a=Qe(t,[1,-1]),i=Qe(n,[n.shape[0],n.shape[1]]),l=lr(a,i);return Qe(l,[l.size])}else if(t.rank===2&&n.rank===1){const a=Qe(n,[-1,1]),i=lr(t,a);return Qe(i,[i.size])}else{const a=Qe(n,[n.shape[0],n.shape[1]]);return lr(t,a)}}const n8=Ze({dot_:t8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r8(r){const t={x:ke(r,"x","elu","float32")};return Xe.runKernel(cp,t)}const H0=Ze({elu_:r8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s8(r){let e=ke(r,"x","erf");xe(e.dtype==="int32"||e.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),e.dtype==="int32"&&(e=Yt(e,"float32"));const t={x:e};return Xe.runKernel(hp,t)}const o8=Ze({erf_:s8});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yw(r,e){for(let t=0;t<r.length;++t)if(r[r.length-t-1]!==e-1-t)return!1;return!0}function C$(r,e,t){const n=r.length+e.length,s=[];let o=0,a=0;for(let i=0;i<n;i++)t.indexOf(i)===-1?s.push(r[o++]):s.push(e[a++]);return s}function ks(r,e){const t=[],n=r.length;for(let o=0;o<n;o++)e.indexOf(o)===-1&&t.push(r[o]);const s=e.map(o=>r[o]);return[t,s]}function es(r,e){const t=e.map(n=>1);return C$(r,t,e)}function Fs(r,e,t){xe(Yw(e,t),()=>`${r} supports only inner-most axes for now. Got axes ${e} and rank-${t} input.`)}function qr(r,e){if(Yw(r,e))return null;const t=[];for(let n=0;n<e;++n)r.indexOf(n)===-1&&t.push(n);return r.forEach(n=>t.push(n)),t}function Eu(r){return r.map((e,t)=>[t,e]).sort((e,t)=>e[1]-t[1]).map(e=>e[0])}function ts(r,e){const t=[];for(let n=e-r;n<e;++n)t.push(n);return t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i8(r,e=null,t=!1){const s={x:ke(r,"x","max")},o={reductionIndices:e,keepDims:t};return Xe.runKernel(f0,s,o)}const Ha=Ze({max_:i8});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a8(r,e=null,t=!1){const s={x:ke(r,"x","min")},o={axis:e,keepDims:t};return Xe.runKernel(y0,s,o)}const Fb=Ze({min_:a8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l8(r,e){let t=ke(r,"base","pow"),n=ke(e,"exp","pow");[t,n]=Jr(t,n);const s={a:t,b:n};return Xe.runKernel(Ep,s)}const ed=Ze({pow_:l8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function An(r,e){if((Ka(r)&&e!=="string"||Array.isArray(r))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&Ka(r)&&!(r instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return z0(r,[],[],e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u8(r){const t={x:ke(r,"x","sqrt","float32")};return Xe.runKernel(jp,t)}const io=Ze({sqrt_:u8});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c8(r){const e=ke(r,"x","square"),t={};return Xe.runKernel("Square",{x:e},t)}const Ar=Ze({square_:c8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h8(r,e=null,t=!1){let n=ke(r,"x","sum");n.dtype==="bool"&&(n=Yt(n,"int32"));const s={x:n},o={axis:e,keepDims:t};return Xe.runKernel(D0,s,o)}const rn=Ze({sum_:h8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d8(r,e="euclidean",t=null,n=!1){r=ke(r,"x","norm");const s=$$(r,e,t);let o=s.shape;if(n){const a=Hn(t,r.shape);o=es(s.shape,a)}return Qe(s,o)}function $$(r,e,t=null){if(r.rank===0)return bs(r);if(r.rank!==1&&t===null)return $$(Qe(r,[-1]),e,t);if(r.rank===1||typeof t=="number"||Array.isArray(t)&&t.length===1){if(e===1)return rn(bs(r),t);if(e===1/0)return Ha(bs(r),t);if(e===-1/0)return Fb(bs(r),t);if(e==="euclidean"||e===2)return io(rn(ed(bs(r),An(2,"int32")),t));throw new Error(`Error in norm: invalid ord value: ${e}`)}if(Array.isArray(t)&&t.length===2){if(e===1)return Ha(rn(bs(r),t[0]),t[1]-1);if(e===1/0)return Ha(rn(bs(r),t[1]),t[0]);if(e===-1/0)return Fb(rn(bs(r),t[1]),t[0]);if(e==="fro"||e==="euclidean")return io(rn(Ar(r),t));throw new Error(`Error in norm: invalid ord value: ${e}`)}throw new Error(`Error in norm: invalid axis: ${t}`)}const q0=Ze({norm_:d8});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f8(r,e=null,t=!1){return q0(r,"euclidean",e,t)}const p8=Ze({euclideanNorm_:f8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m8(r){const t={x:ke(r,"x","exp")};return Xe.runKernel(dp,t)}const Gi=Ze({exp_:m8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g8(r,e=0){const t=ke(r,"x","expandDims","string_or_numeric");xe(e<=t.rank,()=>"Axis must be <= rank of the tensor");const n={input:t},s={dim:e};return Xe.runKernel(n0,n,s)}const Oi=Ze({expandDims_:g8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y8(r){const t={x:ke(r,"x","expm1")};return Xe.runKernel(fp,t)}const v8=Ze({expm1_:y8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b8(r,e){const t=ke(r,"x","tile","string_or_numeric");xe(t.rank===e.length,()=>`Error in transpose: rank of input ${t.rank} must match length of reps ${e}.`);const n={x:t},s={reps:e};return Xe.runKernel(Gp,n,s)}const da=Ze({tile_:b8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x8(r,e,t,n="float32"){e==null&&(e=r);const s=Wn([r,e],n),o=r<=e?r:e;for(let i=0;i<o;++i)s.set(1,i,i);const a=Qe(s.toTensor(),[r,e]);if(t==null)return a;if(t.length===1)return da(Oi(a,0),[t[0],1,1]);if(t.length===2)return da(Oi(Oi(a,0),0),[t[0],t[1],1,1]);if(t.length===3)return da(Oi(Oi(Oi(a,0),0),0),[t[0],t[1],t[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${t.length}D.`)}const N$=Ze({eye_:x8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w8(r){const t={x:ke(r,"x","floor","float32")};return Xe.runKernel(pp,t)}const X0=Ze({floor_:w8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S8(r,e,t=0,n=0){const s=ke(r,"x","gather"),o=ke(e,"indices","gather","int32"),a={x:s,indices:o},i={axis:t,batchDims:n};return Xe.runKernel(s0,a,i)}const Zw=Ze({gather_:S8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _8(r,e){let t=ke(r,"a","greater","string_or_numeric"),n=ke(e,"b","greater","string_or_numeric");[t,n]=Jr(t,n),Dn(t.shape,n.shape);const s={a:t,b:n};return Xe.runKernel(o0,s)}const Ki=Ze({greater_:_8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T8(r,e){let t=ke(r,"a","greaterEqual","string_or_numeric"),n=ke(e,"b","greaterEqual","string_or_numeric");[t,n]=Jr(t,n),Dn(t.shape,n.shape);const s={a:t,b:n};return Xe.runKernel(gp,s)}const Sd=Ze({greaterEqual_:T8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k8(r){const t={x:ke(r,"x","isFinite")};return Xe.runKernel(vp,t)}const I8=Ze({isFinite_:k8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E8(r){const t={x:ke(r,"x","isInf")};return Xe.runKernel(bp,t)}const C8=Ze({isInf_:E8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $8(r){const t={x:ke(r,"x","isNaN")};return Xe.runKernel(xp,t)}const N8=Ze({isNaN_:$8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A8(r,e=.2){const n={x:ke(r,"x","leakyRelu")},s={alpha:e};return Xe.runKernel(i0,n,s)}const Qw=Ze({leakyRelu_:A8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R8(r,e){let t=ke(r,"a","less","string_or_numeric"),n=ke(e,"b","less","string_or_numeric");[t,n]=Jr(t,n),Dn(t.shape,n.shape);const s={a:t,b:n};return Xe.runKernel(a0,s)}const A$=Ze({less_:R8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D8(r,e){let t=ke(r,"a","lessEqual","string_or_numeric"),n=ke(e,"b","lessEqual","string_or_numeric");[t,n]=Jr(t,n),Dn(t.shape,n.shape);const s={a:t,b:n};return Xe.runKernel(l0,s)}const _d=Ze({lessEqual_:D8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O8(r,e=5,t=1,n=1,s=.5){const o=ke(r,"x","localResponseNormalization");xe(o.rank===4||o.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${o.rank}.`),xe(Kh(e),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${e}.`);let a=o,i=!1;o.rank===3&&(i=!0,a=Qe(o,[1,o.shape[0],o.shape[1],o.shape[2]]));const l={x:a},u={depthRadius:e,bias:t,alpha:n,beta:s},h=Xe.runKernel(d0,l,u);return i?Qe(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const M8=Ze({localResponseNormalization_:O8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F8(r){const t={x:ke(r,"x","log","float32")};return Xe.runKernel(wp,t)}const Wi=Ze({log_:F8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L8(r){const t={x:ke(r,"x","log1p")};return Xe.runKernel(Sp,t)}const Jw=Ze({log1p_:L8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P8(r,e){xe(yb(r),()=>"The f passed in variableGrads(f) must be a function"),xe(e==null||Array.isArray(e)&&e.every(u=>u instanceof ty),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const t=e!=null;if(!t){e=[];for(const u in Xe.registeredVariables)e.push(Xe.registeredVariables[u])}const n=t?e.filter(u=>!u.trainable):null,s=e.length;e=e.filter(u=>u.trainable),xe(e.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${s} variables is trainable.`);const o=!0,{value:a,grads:i}=Xe.gradients(r,e,null,o);xe(i.some(u=>u!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),xe(a.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${a.rank} tensor`);const l={};return e.forEach((u,h)=>{i[h]!=null&&(l[u.name]=i[h])}),n!=null&&n.forEach(u=>l[u.name]=null),{value:a,grads:l}}function Mc(r){return Xe.customGrad(r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j8(r){const t={x:ke(r,"x","softplus")};return Xe.runKernel(Pp,t)}const Kp=Ze({softplus_:j8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B8(r){const e=ke(r,"x","logSigmoid");return Mc(n=>({value:Wr(Kp(Wr(n))),gradFunc:a=>We(a,wd(Wr(n)))}))(e)}const U8=Ze({logSigmoid_:B8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z8(r,e){let t=ke(r,"a","sub"),n=ke(e,"b","sub");[t,n]=Jr(t,n);const s={a:t,b:n};return Xe.runKernel(Up,s)}const sn=Ze({sub_:z8});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V8(r,e=-1){const t=ke(r,"logits","logSoftmax");if(e===-1&&(e=t.rank-1),e!==t.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${t.rank} and axis was ${e}`);return Mc((s,o)=>{const i=Ha(s,e,!0),l=sn(s,i),u=sn(Yt(l,"float32"),Wi(rn(Gi(l),e,!0)));return o([u]),{value:u,gradFunc:(d,c)=>{const[f]=c,p=!0,m=Gi(f);return sn(d,We(rn(d,e,p),m))}}})(t)}const R$=Ze({logSoftmax_:V8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G8(r,e=null,t=!1){const n=ke(r,"x","logSumExp"),s=Hn(e,n.shape),o=Ha(n,s,!0),a=sn(n,o),i=Gi(a),l=rn(i,s),u=Wi(l),h=Rt(Qe(o,u.shape),u);if(t){const d=es(h.shape,s);return Qe(h,d)}return h}const D$=Ze({logSumExp_:G8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W8(r,e){const t=ke(r,"a","logicalAnd","bool"),n=ke(e,"b","logicalAnd","bool");Dn(t.shape,n.shape);const s={a:t,b:n};return Xe.runKernel(u0,s)}const El=Ze({logicalAnd_:W8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H8(r){const t={x:ke(r,"x","logicalNot","bool")};return Xe.runKernel(c0,t)}const e2=Ze({logicalNot_:H8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q8(r,e){const t=ke(r,"a","logicalOr","bool"),n=ke(e,"b","logicalOr","bool");Dn(t.shape,n.shape);const s={a:t,b:n};return Xe.runKernel(h0,s)}const O$=Ze({logicalOr_:q8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X8(r,e){const t=ke(r,"a","logicalXor","bool"),n=ke(e,"b","logicalXor","bool");return Dn(t.shape,n.shape),El(O$(r,e),e2(El(r,e)))}const K8=Ze({logicalXor_:X8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y8(r,e,t,n,s){const o=ke(r,"x","maxPool"),a=1;let i=o,l=!1;o.rank===3&&(l=!0,i=Qe(o,[1,o.shape[0],o.shape[1],o.shape[2]])),xe(i.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${i.rank}.`),xe(Ks(t,a),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${t} and dilations '${a}'`),_o("maxPool",n,s);const u={x:i},h={filterSize:e,strides:t,pad:n,dimRoundingMode:s},d=Xe.runKernel(p0,u,h);return l?Qe(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const t2=Ze({maxPool_:Y8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z8(r,e=[1,1,1],t,n,s,o="NDHWC"){const a=ke(r,"x","maxPool3d");let i=a,l=!1;a.rank===4&&(l=!0,i=Qe(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),xe(i.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${i.rank}.`),xe(o==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${o}`),_o("maxPool3d",n,s);const u={x:i},h={filterSize:e,strides:t,pad:n,dimRoundingMode:s,dataFormat:o},d=Xe.runKernel(m0,u,h);return l?Qe(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const Q8=Ze({maxPool3d_:Z8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J8(r,e){let t=ke(r,"a","maximum"),n=ke(e,"b","maximum");[t,n]=Jr(t,n),t.dtype==="bool"&&(t=Yt(t,"int32"),n=Yt(n,"int32")),Dn(t.shape,n.shape);const s={a:t,b:n};return Xe.runKernel(_p,s)}const Cu=Ze({maximum_:J8});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eH(r,e=null,t=!1){const s={x:ke(r,"x","mean")},o={axis:e,keepDims:t};return Xe.runKernel(g0,s,o)}const Qr=Ze({mean_:eH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ss(r,e="float32"){if(e==="complex64"){const n=Ss(r,"float32"),s=Ss(r,"float32");return Qh(n,s)}const t=Xs(pt(r),e);return Xe.makeTensor(t,r,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $u(r,e="float32"){if(e==="complex64"){const n=$u(r,"float32"),s=Ss(r,"float32");return Qh(n,s)}const t=Bx(pt(r),e);return Xe.makeTensor(t,r,e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tH(r,e){let t=ke(r,"a","minimum"),n=ke(e,"b","minimum");[t,n]=Jr(t,n),t.dtype==="bool"&&(t=Yt(t,"int32"),n=Yt(n,"int32")),Dn(t.shape,n.shape);const s={a:t,b:n};return Xe.runKernel(Tp,s)}const K0=Ze({minimum_:tH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nH(r,e,t){xe(t==="reflect"||t==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${t}.`);const n=ke(r,"x","mirrorPad");if(n.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");xe(e.length===n.rank,()=>`Padding doesn't match input. Must be ${n.rank}. Got ${e.length}.`);const s=t==="reflect"?1:0;for(let i=0;i<n.rank;i++)xe(e[i].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),xe(e[i][0]>=0&&e[i][0]<=n.shape[i]-s&&e[i][1]>=0&&e[i][1]<=n.shape[i]-s,()=>`Padding in dimension ${i} cannot be greater than or equal to ${n.shape[i]-s} or less than 0 for input of shape ${n.shape}`);const o={paddings:e,mode:t},a={x:n};return Xe.runKernel(v0,a,o)}const rH=Ze({mirrorPad_:nH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sH(r,e){let t=ke(r,"a","mod"),n=ke(e,"b","mod");[t,n]=Jr(t,n);const s={a:t,b:n};return Xe.runKernel(kp,s)}const oH=Ze({mod_:sH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iH(r,e=null,t=!1){r=ke(r,"x","moments");const n=Hn(e,r.shape),s=Qr(r,n,t);let o=s.shape;t||(o=es(s.shape,n));const a=Ar(sn(Yt(r,"float32"),Qe(s,o))),i=Qr(a,n,t);return{mean:s,variance:i}}const n2=Ze({moments_:iH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aH(r,e){let t=ke(r,"a","notEqual","string_or_numeric"),n=ke(e,"b","notEqual","string_or_numeric");[t,n]=Jr(t,n),Dn(t.shape,n.shape);const s={a:t,b:n};return Xe.runKernel(x0,s)}const Ef=Ze({notEqual_:aH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lH(r){const t={x:ke(r,"x","onesLike")};return Xe.runKernel(w0,t)}const Hi=Ze({onesLike_:lH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uH(r,e,t=0){const n=ke(r,"x","pad");if(n.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const s={paddings:e,constantValue:t},o={x:n};return Xe.runKernel(T0,o,s)}const r2=Ze({pad_:uH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cH(r,e,t){const n=ke(r,"x","spaceToBatchND");xe(n.rank>=1+e.length,()=>`input rank ${n.rank} should be > than [blockShape] ${e.length}`),xe(t.length===e.length,()=>`paddings.shape[0] ${t.length} must be equal to [blockShape] ${e.length}`),xe(n.shape.reduce((a,i,l)=>l>0&&l<=e.length?a&&(i+t[l-1][0]+t[l-1][1])%e[l-1]===0:a,!0),()=>`input spatial dimensions ${n.shape.slice(1)} with paddings ${t.toString()} must be divisible by blockShapes ${e.toString()}`);const s={x:n},o={blockShape:e,paddings:t};return Xe.runKernel(O0,s,o)}const s2=Ze({spaceToBatchND_:cH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hH(r,e,t,n,s,o,a){s==null&&(s=[1,1]),o==null&&(o=1),n===0&&(n="valid");const i=ke(r,"x","maxPool");let l=i,u=!1;i.rank===3&&(u=!0,l=Qe(i,[1,i.shape[0],i.shape[1],i.shape[2]])),xe(Ks(o,s),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${o} and dilations '${s}'`);const h=Xi(l.shape,e,o,s,n),d=[h.dilationHeight,h.dilationWidth];let c;n==="same"?c=fH([h.filterHeight,h.filterWidth],d):c=[[0,0],[0,0]];const f=d[0]===1&&d[1]===1,[p,m]=dH([h.inHeight,h.inWidth],d,c),g=f?n:"valid",y=f?l:s2(l,d,p),b=(t==="avg"?()=>Gw(y,e,o,g,a):()=>t2(y,e,o,g,a))(),w=f?b:Hw(b,d,m);return u?Qe(w,[w.shape[1],w.shape[2],w.shape[3]]):w}function dH(r,e,t){const n=t.map(h=>h[0]),s=t.map(h=>h[1]),o=r.concat(n,s),a=e.map((h,d)=>(h-o[d]%h)%h),i=s.map((h,d)=>h+a[d]),l=e.map((h,d)=>[n[d],i[d]]),u=e.map((h,d)=>[0,a[d]]);return[l,u]}function fH(r,e){const n=r.map((a,i)=>a+(a-1)*(e[i]-1)).map(a=>a-1),s=n.map(a=>Math.floor(a/2)),o=n.map((a,i)=>a-s[i]);return n.map((a,i)=>[s[i],o[i]])}const pH=Ze({pool_:hH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mH(r,e){const t=ke(r,"x","prelu"),n=ke(e,"alpha","prelu"),s={x:t,alpha:n};return Xe.runKernel(k0,s)}const o2=Ze({prelu_:mH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gH(r,e=null,t=!1){let n=ke(r,"x","prod");n.dtype==="bool"&&(n=Yt(n,"int32"));const s={x:n},o={axis:e,keepDims:t};return Xe.runKernel(I0,s,o)}const yH=Ze({prod_:gH});var M$={exports:{}};(function(r){(function(e,t,n){function s(l){var u=this,h=i();u.next=function(){var d=2091639*u.s0+u.c*23283064365386963e-26;return u.s0=u.s1,u.s1=u.s2,u.s2=d-(u.c=d|0)},u.c=1,u.s0=h(" "),u.s1=h(" "),u.s2=h(" "),u.s0-=h(l),u.s0<0&&(u.s0+=1),u.s1-=h(l),u.s1<0&&(u.s1+=1),u.s2-=h(l),u.s2<0&&(u.s2+=1),h=null}function o(l,u){return u.c=l.c,u.s0=l.s0,u.s1=l.s1,u.s2=l.s2,u}function a(l,u){var h=new s(l),d=u&&u.state,c=h.next;return c.int32=function(){return h.next()*4294967296|0},c.double=function(){return c()+(c()*2097152|0)*11102230246251565e-32},c.quick=c,d&&(typeof d=="object"&&o(d,h),c.state=function(){return o(h,{})}),c}function i(){var l=4022871197,u=function(h){h=String(h);for(var d=0;d<h.length;d++){l+=h.charCodeAt(d);var c=.02519603282416938*l;l=c>>>0,c-=l,c*=l,l=c>>>0,c-=l,l+=c*4294967296}return(l>>>0)*23283064365386963e-26};return u}t&&t.exports?t.exports=a:n&&n.amd?n(function(){return a}):this.alea=a})(Pr,r,!1)})(M$);var F$={exports:{}};(function(r){(function(e,t,n){function s(i){var l=this,u="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var d=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^d^d>>>8},i===(i|0)?l.x=i:u+=i;for(var h=0;h<u.length+64;h++)l.x^=u.charCodeAt(h)|0,l.next()}function o(i,l){return l.x=i.x,l.y=i.y,l.z=i.z,l.w=i.w,l}function a(i,l){var u=new s(i),h=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var c=u.next()>>>11,f=(u.next()>>>0)/4294967296,p=(c+f)/(1<<21);while(p===0);return p},d.int32=u.next,d.quick=d,h&&(typeof h=="object"&&o(h,u),d.state=function(){return o(u,{})}),d}t&&t.exports?t.exports=a:n&&n.amd?n(function(){return a}):this.xor128=a})(Pr,r,!1)})(F$);var L$={exports:{}};(function(r){(function(e,t,n){function s(i){var l=this,u="";l.next=function(){var d=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^(d^d<<1))|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,i===(i|0)?l.x=i:u+=i;for(var h=0;h<u.length+64;h++)l.x^=u.charCodeAt(h)|0,h==u.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function o(i,l){return l.x=i.x,l.y=i.y,l.z=i.z,l.w=i.w,l.v=i.v,l.d=i.d,l}function a(i,l){var u=new s(i),h=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var c=u.next()>>>11,f=(u.next()>>>0)/4294967296,p=(c+f)/(1<<21);while(p===0);return p},d.int32=u.next,d.quick=d,h&&(typeof h=="object"&&o(h,u),d.state=function(){return o(u,{})}),d}t&&t.exports?t.exports=a:n&&n.amd?n(function(){return a}):this.xorwow=a})(Pr,r,!1)})(L$);var P$={exports:{}};(function(r){(function(e,t,n){function s(i){var l=this;l.next=function(){var h=l.x,d=l.i,c,f;return c=h[d],c^=c>>>7,f=c^c<<24,c=h[d+1&7],f^=c^c>>>10,c=h[d+3&7],f^=c^c>>>3,c=h[d+4&7],f^=c^c<<7,c=h[d+7&7],c=c^c<<13,f^=c^c<<9,h[d]=f,l.i=d+1&7,f};function u(h,d){var c,f=[];if(d===(d|0))f[0]=d;else for(d=""+d,c=0;c<d.length;++c)f[c&7]=f[c&7]<<15^d.charCodeAt(c)+f[c+1&7]<<13;for(;f.length<8;)f.push(0);for(c=0;c<8&&f[c]===0;++c);for(c==8&&(f[7]=-1),h.x=f,h.i=0,c=256;c>0;--c)h.next()}u(l,i)}function o(i,l){return l.x=i.x.slice(),l.i=i.i,l}function a(i,l){i==null&&(i=+new Date);var u=new s(i),h=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var c=u.next()>>>11,f=(u.next()>>>0)/4294967296,p=(c+f)/(1<<21);while(p===0);return p},d.int32=u.next,d.quick=d,h&&(h.x&&o(h,u),d.state=function(){return o(u,{})}),d}t&&t.exports?t.exports=a:n&&n.amd?n(function(){return a}):this.xorshift7=a})(Pr,r,!1)})(P$);var j$={exports:{}};(function(r){(function(e,t,n){function s(i){var l=this;l.next=function(){var h=l.w,d=l.X,c=l.i,f,p;return l.w=h=h+1640531527|0,p=d[c+34&127],f=d[c=c+1&127],p^=p<<13,f^=f<<17,p^=p>>>15,f^=f>>>12,p=d[c]=p^f,l.i=c,p+(h^h>>>16)|0};function u(h,d){var c,f,p,m,g,y=[],v=128;for(d===(d|0)?(f=d,d=null):(d=d+"\0",f=0,v=Math.max(v,d.length)),p=0,m=-32;m<v;++m)d&&(f^=d.charCodeAt((m+32)%d.length)),m===0&&(g=f),f^=f<<10,f^=f>>>15,f^=f<<4,f^=f>>>13,m>=0&&(g=g+1640531527|0,c=y[m&127]^=f+g,p=c==0?p+1:0);for(p>=128&&(y[(d&&d.length||0)&127]=-1),p=127,m=4*128;m>0;--m)f=y[p+34&127],c=y[p=p+1&127],f^=f<<13,c^=c<<17,f^=f>>>15,c^=c>>>12,y[p]=f^c;h.w=g,h.X=y,h.i=p}u(l,i)}function o(i,l){return l.i=i.i,l.w=i.w,l.X=i.X.slice(),l}function a(i,l){i==null&&(i=+new Date);var u=new s(i),h=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var c=u.next()>>>11,f=(u.next()>>>0)/4294967296,p=(c+f)/(1<<21);while(p===0);return p},d.int32=u.next,d.quick=d,h&&(h.X&&o(h,u),d.state=function(){return o(u,{})}),d}t&&t.exports?t.exports=a:n&&n.amd?n(function(){return a}):this.xor4096=a})(Pr,r,!1)})(j$);var B$={exports:{}};(function(r){(function(e,t,n){function s(i){var l=this,u="";l.next=function(){var d=l.b,c=l.c,f=l.d,p=l.a;return d=d<<25^d>>>7^c,c=c-f|0,f=f<<24^f>>>8^p,p=p-d|0,l.b=d=d<<20^d>>>12^c,l.c=c=c-f|0,l.d=f<<16^c>>>16^p,l.a=p-d|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,i===Math.floor(i)?(l.a=i/4294967296|0,l.b=i|0):u+=i;for(var h=0;h<u.length+20;h++)l.b^=u.charCodeAt(h)|0,l.next()}function o(i,l){return l.a=i.a,l.b=i.b,l.c=i.c,l.d=i.d,l}function a(i,l){var u=new s(i),h=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var c=u.next()>>>11,f=(u.next()>>>0)/4294967296,p=(c+f)/(1<<21);while(p===0);return p},d.int32=u.next,d.quick=d,h&&(typeof h=="object"&&o(h,u),d.state=function(){return o(u,{})}),d}t&&t.exports?t.exports=a:n&&n.amd?n(function(){return a}):this.tychei=a})(Pr,r,!1)})(B$);var U$={exports:{}};(function(r){(function(e,t,n){var s=256,o=6,a=52,i="random",l=n.pow(s,o),u=n.pow(2,a),h=u*2,d=s-1,c;function f(w,_,I){var C=[];_=_==!0?{entropy:!0}:_||{};var N=y(g(_.entropy?[w,b(t)]:w==null?v():w,3),C),O=new p(C),D=function(){for(var M=O.g(o),P=l,F=0;M<u;)M=(M+F)*s,P*=s,F=O.g(1);for(;M>=h;)M/=2,P/=2,F>>>=1;return(M+F)/P};return D.int32=function(){return O.g(4)|0},D.quick=function(){return O.g(4)/4294967296},D.double=D,y(b(O.S),t),(_.pass||I||function(M,P,F,B){return B&&(B.S&&m(B,O),M.state=function(){return m(O,{})}),F?(n[i]=M,P):M})(D,N,"global"in _?_.global:this==n,_.state)}function p(w){var _,I=w.length,C=this,N=0,O=C.i=C.j=0,D=C.S=[];for(I||(w=[I++]);N<s;)D[N]=N++;for(N=0;N<s;N++)D[N]=D[O=d&O+w[N%I]+(_=D[N])],D[O]=_;(C.g=function(M){for(var P,F=0,B=C.i,z=C.j,Z=C.S;M--;)P=Z[B=d&B+1],F=F*s+Z[d&(Z[B]=Z[z=d&z+P])+(Z[z]=P)];return C.i=B,C.j=z,F})(s)}function m(w,_){return _.i=w.i,_.j=w.j,_.S=w.S.slice(),_}function g(w,_){var I=[],C=typeof w,N;if(_&&C=="object")for(N in w)try{I.push(g(w[N],_-1))}catch{}return I.length?I:C=="string"?w:w+"\0"}function y(w,_){for(var I=w+"",C,N=0;N<I.length;)_[d&N]=d&(C^=_[d&N]*19)+I.charCodeAt(N++);return b(_)}function v(){try{var w;return c&&(w=c.randomBytes)?w=w(s):(w=new Uint8Array(s),(e.crypto||e.msCrypto).getRandomValues(w)),b(w)}catch{var _=e.navigator,I=_&&_.plugins;return[+new Date,e,I,e.screen,b(t)]}}function b(w){return String.fromCharCode.apply(0,w)}if(y(n.random(),t),r.exports){r.exports=f;try{c=require("crypto")}catch{}}else n["seed"+i]=f})(typeof self!="undefined"?self:Pr,[],Math)})(U$);var vH=M$.exports,bH=F$.exports,xH=L$.exports,wH=P$.exports,SH=j$.exports,_H=B$.exports,Yc=U$.exports;Yc.alea=vH;Yc.xor128=bH;Yc.xorwow=xH;Yc.xorshift7=wH;Yc.xor4096=SH;Yc.tychei=_H;var i2=Yc;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class z${constructor(e,t,n,s,o){this.mean=e,this.stdDev=t,this.dtype=n,this.nextVal=NaN,this.truncated=s,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const a=o||Math.random();this.random=i2.alea(a.toString())}nextValue(){if(!isNaN(this.nextVal)){const s=this.nextVal;return this.nextVal=NaN,s}let e,t,n=!1;for(;!n;){let s,o,a;do s=2*this.random()-1,o=2*this.random()-1,a=s*s+o*o;while(a>=1||a===0);const i=Math.sqrt(-2*Math.log(a)/a);e=this.mean+this.stdDev*s*i,t=this.mean+this.stdDev*o*i,(!this.truncated||this.isValidTruncated(e))&&(n=!0)}return(!this.truncated||this.isValidTruncated(t))&&(this.nextVal=this.convertValue(t)),this.convertValue(e)}convertValue(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}}class TH{constructor(e=0,t=1,n,s){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=e,this.range=t-e,this.dtype=n,s==null&&(s=Math.random()),typeof s=="number"&&(s=s.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${e} - ${t} <= 1 and dtype is not float`);this.random=i2.alea(s)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kH(r,e=0,t=1,n,s){if(n!=null&&n==="bool")throw new Error(`Unsupported data type ${n}`);const o=new z$(e,t,n,!1,s),a=Wn(r,n);for(let i=0;i<a.values.length;i++)a.values[i]=o.nextValue();return a.toTensor()}const IH=Ze({randomNormal_:kH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EH(r,e=0,t=1,n="float32",s){const o=Wn(r,n),a=new TH(e,t,null,s);for(let i=0;i<o.values.length;i++)o.values[i]=a.nextValue();return o.toTensor()}const Y0=Ze({randomUniform_:EH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sy(r,e,t=1,n="float32"){if(t===0)throw new Error("Cannot have a step of zero");const s={start:r,stop:e,step:t,dtype:n};return Xe.runKernel(mw,{},s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CH(r){const t={x:ke(r,"x","reciprocal")};return Xe.runKernel(Cp,t)}const $H=Ze({reciprocal_:CH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NH(r){const t={x:ke(r,"x","relu")};return Xe.runKernel($p,t)}const Dl=Ze({relu_:NH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AH(r){const t={x:ke(r,"x","relu6")};return Xe.runKernel(Np,t)}const V$=Ze({relu6_:AH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RH(r,e){const n={x:ke(r,"x","reverse")},s={dims:e};return Xe.runKernel(N0,n,s)}const Fc=Ze({reverse_:RH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DH(r){const t={x:ke(r,"x","round")};return Xe.runKernel(Ap,t)}const G$=Ze({round_:DH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OH(r){const t={x:ke(r,"x","rsqrt","float32")};return Xe.runKernel(Rp,t)}const W$=Ze({rsqrt_:OH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MH(r){const t={x:ke(r,"x","selu")};return Xe.runKernel(Dp,t)}const H$=Ze({selu_:MH});function FH(r,e,t,n,s,o=[1,1],a="NHWC"){const i=ke(r,"x","separableConv2d"),l=ke(e,"depthwiseFilter","separableConv2d"),u=ke(t,"pointwiseFilter","separableConv2d");let h=i,d=!1;if(i.rank===3&&(d=!0,h=Qe(i,[1,i.shape[0],i.shape[1],i.shape[2]])),a==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");xe(h.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${h.rank}.`),xe(l.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${l.rank}.`),xe(u.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${l.rank}.`),xe(u.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${u.shape[0]}.`),xe(u.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${u.shape[1]}.`);const c=l.shape[2],f=l.shape[3];xe(u.shape[2]===c*f,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${c*f}, but got ${u.shape[2]}.`);const p=Kw(h,l,n,s,a,o),g=Oc(p,u,1,"valid",a);return d?Qe(g,[g.shape[1],g.shape[2],g.shape[3]]):g}const q$=Ze({separableConv2d_:FH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LH(r){const t={x:ke(r,"x","sign")};return Xe.runKernel(Fp,t)}const PH=Ze({sign_:LH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jH(r){const t={x:ke(r,"x","sin","float32")};return Xe.runKernel(Op,t)}const X$=Ze({sin_:jH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BH(r){const t={x:ke(r,"x","sinh")};return Xe.runKernel(Mp,t)}const K$=Ze({sinh_:BH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UH(r,e,t){const n=ke(r,"x","slice1d");return xe(n.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${n.rank} tensor`),_r(n,[e],[t])}const a2=Ze({slice1d_:UH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zH(r,e,t){const n=ke(r,"x","slice2d");return xe(n.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${n.rank} tensor`),_r(n,e,t)}const Y$=Ze({slice2d_:zH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VH(r,e,t){const n=ke(r,"x","slice3d");return xe(n.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${n.rank} tensor`),_r(n,e,t)}const l2=Ze({slice3d_:VH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GH(r,e,t){const n=ke(r,"x","slice4d");return xe(n.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${n.rank} tensor`),_r(n,e,t)}const oy=Ze({slice4d_:GH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WH(r,e=-1){const t=ke(r,"logits","softmax","float32");if(e===-1&&(e=t.rank-1),e!==t.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${t.rank} and dim was ${e}`);const n={logits:t},s={dim:e};return Xe.runKernel(F0,n,s)}const u2=Ze({softmax_:WH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HH(r){xe(r.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${r.dtype}.`);const e={input:r};return Xe.runKernel(sw,e)}const Z$=Ze({fft_:HH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qH(r){xe(r.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${r.dtype}.`);const e={input:r};return Xe.runKernel(aw,e)}const Lb=Ze({ifft_:qH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XH(r){const e=r.shape[r.shape.length-1],t=r.size/e;let n;if(e<=2){const s=Qe(r,[t,e]);n=Lb(s)}else{const s=[t,2*(e-1)],o=Qe(ny(r),[t,e]),a=Qe(Fw(r),[t,e]),i=Fc(_r(o,[0,1],[t,e-2]),1),l=We(Fc(_r(a,[0,1],[t,e-2]),1),An(-1)),u=Hs([o,i],1),h=Hs([a,l],1),d=Qe(Qh(u,h),[s[0],s[1]]);n=Lb(d)}if(n=ny(n),r.rank===3&&r.shape[0]!==0){const s=n,o=r.shape[0];n=Qe(n,[o,n.shape[0]/o,n.shape[1]]),s.dispose()}return n}const KH=Ze({irfft_:XH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YH(r,e,t=0){const s={x:ke(r,"x","split")},o={numOrSizeSplits:e,axis:t};return Xe.runKernel(M0,s,o)}const fi=Ze({split_:YH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZH(r,e){xe(r.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${r.dtype}`);let t=r.shape[r.shape.length-1];const n=r.size/t;let s;if(e!=null&&e<t){const p=r.shape.map(g=>0),m=r.shape.map(g=>g);m[r.shape.length-1]=e,s=_r(r,p,m),t=e}else if(e!=null&&e>t){const p=r.shape.map(m=>m);p[r.shape.length-1]=e-t,s=Hs([r,Ss(p)],r.shape.length-1),t=e}else s=r;const o=ir(s),a=Qe(Qh(s,o),[n,t]),i=Z$(a),l=Math.floor(t/2)+1,u=ny(i),h=Fw(i),d=fi(u,[l,t-l],u.shape.length-1),c=fi(h,[l,t-l],h.shape.length-1),f=s.shape.slice();return f[s.shape.length-1]=l,Qe(Qh(d[0],c[0]),f)}const Q$=Ze({rfft_:ZH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QH(r,e){let t=ke(r,"a","squaredDifference"),n=ke(e,"b","squaredDifference");[t,n]=Jr(t,n),Dn(t.shape,n.shape);const s={a:t,b:n},o={};return Xe.runKernel(Bp,s,o)}const J$=Ze({squaredDifference_:QH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JH(r,e){const t=ke(r,"x","squeeze","string_or_numeric");return Qe(t,Tu(t.shape,e).newShape)}const Yp=Ze({squeeze_:JH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e7(r,e=0){const t=e$(r,"tensors","stack","string_or_numeric");xe(t.length>=1,()=>"Pass at least one tensor to tf.stack"),t.length>0&&xe(e<=t[0].rank,()=>"Axis must be <= rank of the tensor");const n=t,s={axis:e};return Xe.runKernel(_0,n,s)}const Lc=Ze({stack_:e7});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t7(r,e=0){const n={x:ke(r,"x","step")},s={alpha:e};return Xe.runKernel(Wp,n,s)}const Zp=Ze({step_:t7});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n7(r,e,t,n,s=0,o=0,a=0,i=0,l=0){const h={x:ke(r,"x","stridedSlice","string_or_numeric")},d={begin:e,end:t,strides:n,beginMask:s,endMask:o,ellipsisMask:a,newAxisMask:i,shrinkAxisMask:l};return Xe.runKernel(Tw,h,d)}const r7=Ze({stridedSlice_:n7});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s7(r){const t={x:ke(r,"x","tan","float32")};return Xe.runKernel(zp,t)}const o7=Ze({tan_:s7});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Po(r,e){mC(r);const t=U0(r,e);if(t.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return z0(r,null,t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gg(r,e,t){if(mC(r),e!=null&&e.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const n=U0(r,t);if(n.length!==2&&n.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(n.length===1&&e==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return z0(r,e,n,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i7(r,e=1,t=!0){const n=ke(r,"x","topk");if(n.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const s=n.shape[n.shape.length-1];if(e<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${e}`);if(e>s)throw new Error(`'k' passed to topk() must be <= the last dimension (${s}) but got ${e}`);const o={x:n},a={k:e,sorted:t},[i,l]=Xe.runKernel(Cw,o,a);return{values:i,indices:l}}const a7=Ze({topk_:i7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l7(r,e=0,t=1,n,s){if(n!=null&&n==="bool")throw new Error("Unsupported data type $ { dtype }");const o=new z$(e,t,n,!0,s),a=Wn(r,n);for(let i=0;i<a.values.length;i++)a.values[i]=o.nextValue();return a.toTensor()}const eN=Ze({truncatedNormal_:l7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u7(r,e=0){const t=ke(r,"x","unique","string_or_numeric");xe(t.rank>0,()=>"The input tensor must be at least 1D");const n={x:t},s={axis:e},[o,a]=Xe.runKernel(Nw,n,s);return{values:o,indices:a}}const c7=Ze({unique_:u7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h7(r,e,t){const n=ke(r,"x","unsortedSegmentSum"),s=ke(e,"segmentIds","unsortedSegmentSum","int32");xe(Kh(t),()=>"numSegments must be of dtype int");const o={x:n,segmentIds:s},a={numSegments:t};return Xe.runKernel(P0,o,a)}const tN=Ze({unsortedSegmentSum_:h7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d7(r,e=0){const t=ke(r,"x","unstack","string_or_numeric");xe(e>=-t.shape.length&&e<t.shape.length,()=>`Axis = ${e} is not in [-${t.shape.length}, ${t.shape.length})`);const n={value:t},s={axis:e};return Xe.runKernel(L0,n,s)}const td=Ze({unstack_:d7});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f7(r,e=!0,t,n){return Xe.makeVariable(r,e,t,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nN(r,e){const t=[];for(let o=0;o<e.length;o++)e[o]&&t.push(o);const n=Wn(r,"int32"),s=Wn([t.length,r.length],"int32");for(let o=0;o<t.length;o++){const a=n.indexToLoc(t[o]),i=o*r.length;s.values.set(a,i)}return s.toTensor()}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p7(r,e){if(e==null)return r.shape.slice();if(ur(r.shape,e))return e;if(r.shape.length===e.length){const t=[];for(let n=0;n<r.shape.length;n++)e[n]==null&&r.shape[n]!=null?t.push(r.shape[n]):t.push(e[n]);return t}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m7(r,e,t,n){const s=ke(r,"x","dropout");if(xe(s.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${s.dtype} tensor instead.`),xe(e>=0&&e<1,()=>`rate must be a float in the range [0, 1), but got ${e}.`),e===0)return r instanceof os?s.clone():s;const o=p7(s,t),a=1-e,i=fn(X0(Rt(Y0(o,0,1,"float32",n),a)),a);return We(s,i)}const g7=Ze({dropout_:m7});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y7(r){return Math.floor(Math.pow(2,Math.ceil(Math.log(r)/Math.log(2))))}function rN(r,e,t){const n=1-r%2,s=new Float32Array(r);for(let o=0;o<r;++o){const a=2*Math.PI*o/(r+n-1);s[o]=e-t*Math.cos(a)}return Po(s,"float32")}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v7(r,e,t,n,s,o="NHWC",a){let i=r;r.rank===3&&(i=Qe(r,[1,r.shape[0],r.shape[1],r.shape[2]]));let l=e;l.rank===3&&(l=Qe(e,[1,e.shape[0],e.shape[1],e.shape[2]])),xe(i.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${i.shape}.`),xe(l.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${l.shape}.`),xe(t.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${t}.`);const u=o==="NHWC"?i.shape[3]:i.shape[1],h=o==="NHWC"?l.shape[3]:l.shape[1];xe(u===t[2],()=>`Error in conv2dDerFilter: depth of input ${u}) must match input depth in filter (${t[2]}.`),xe(h===t[3],()=>`Error in conv2dDerFilter: depth of dy (${h}) must match output depth for filter (${t[3]}).`),_o("conv2dDerFilter",s,a);const d={x:i,dy:l},c={strides:n,pad:s,dataFormat:o,dimRoundingMode:a,filterShape:t};return Xe.runKernel(Kx,d,c)}const c2=Ze({conv2DBackpropFilter_:v7});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h2(r,e,t){if(t==null||t==="linear")return r;if(t==="relu")return We(r,Zp(e));throw new Error(`Cannot compute gradient for fused activation ${t}.`)}function d2(r,e){let t=e;const n=fs(r.shape,e.shape);return n.length>0&&(t=rn(t,n)),Qe(t,r.shape)}function f2(r,e,t,n){if(e==="linear")return r;if(e==="relu")return Dl(r);if(e==="elu")return H0(r);if(e==="relu6")return V$(r);if(e==="prelu")return o2(r,t);if(e==="leakyrelu")return Qw(r,n);if(e==="sigmoid")return wd(r);throw new Error(`Unknown fused activation ${e}.`)}const p2=(r,e)=>!(r>0)||e==="linear";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b7({x:r,filter:e,strides:t,pad:n,dataFormat:s="NHWC",dilations:o=[1,1],dimRoundingMode:a,bias:i,activation:l="linear",preluActivationWeights:u,leakyreluAlpha:h}){if(l=l||"linear",p2(Xe.state.gradientDepth,l)===!1){xe(s==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${s} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let I=Oc(r,e,t,n,s,o,a);return i!=null&&(I=Rt(I,i)),f2(I,l,u,h)}const d=ke(r,"x","conv2d","float32"),c=ke(e,"filter","conv2d","float32");let f=d,p=!1;d.rank===3&&(p=!0,f=Qe(d,[1,d.shape[0],d.shape[1],d.shape[2]])),xe(f.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${f.rank}.`),xe(c.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${c.rank}.`),_o("fused conv2d",n,a);const m=s==="NHWC"?f.shape[3]:f.shape[1];xe(c.shape[2]===m,()=>`Error in conv2d: depth of input (${m}) must match input depth for filter ${c.shape[2]}.`),xe(Ks(t,o),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${t} and dilations '${o}'`);const g=Ms(f.shape,c.shape,t,o,n,a);let y;i!=null&&(y=ke(i,"bias","fused conv2d"),[y]=Jr(y,d),s==="NHWC"?Dn(g.outShape,y.shape):(xe(y.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${y.shape.length}.`),xe(y.shape.length===0||y.shape[0]===g.outChannels||y.shape[0]===1,()=>`Error in fused conv2d: bias shape (${y.shape}) is not compatible with the number of output channels (${g.outChannels})`)));let v;if(u!=null){const I=u.shape;if(xe(I.length<=1||I.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${I.length}.`),I.length===1)xe(I[0]===1||I[0]===g.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${I}) is not compatible with the number of output channels (${g.outChannels}).`);else if(I.length===3)try{Dn(I,g.outShape)}catch{const N=`Error in fused conv2d: PReLU activation weights (${I}) is not compatible with the output shape of the conv2d (${g.outShape}).`;throw Error(N)}v=ke(u,"prelu weights","fused conv2d")}const b=(I,C)=>{xe(s==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${s} but only NHWC is currently supported.`);const[N,O,D,M]=C,P=h2(I,D,l);xe(Dc(o),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${o}'`);const F=qw(O.shape,P,N,t,n),B=c2(O,P,N.shape,t,n),z=[F,B];if(M!=null){const Z=d2(M,P);z.push(Z)}return z},w={x:f,filter:c,bias:y,preluActivationWeights:v},_={strides:t,pad:n,dataFormat:s,dilations:o,dimRoundingMode:a,activation:l,leakyreluAlpha:h};return i==null?Mc((C,N,O)=>{let D=Xe.runKernel(Zg,w,_);return O([N,C,D]),p&&(D=Qe(D,[D.shape[1],D.shape[2],D.shape[3]])),{value:D,gradFunc:b}})(f,c):Mc((C,N,O,D)=>{let M=Xe.runKernel(Zg,w,_);return D([N,C,M,O]),p&&(M=Qe(M,[M.shape[1],M.shape[2],M.shape[3]])),{value:M,gradFunc:b}})(f,c,y)}const x7=Ze({fusedConv2d_:b7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w7(r,e,t,n,s,o=[1,1],a){let i=r;r.rank===3&&(i=Qe(r,[1,r.shape[0],r.shape[1],r.shape[2]]));let l=e;l.rank===3&&(l=Qe(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const u={x:i,dy:l},h={strides:n,pad:s,dimRoundingMode:a,dilations:o,filterShape:t};return Xe.runKernel(tw,u,h)}const S7=Ze({depthwiseConv2dNativeBackpropFilter_:w7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _7(r,e,t,n,s,o=[1,1],a){let i=e,l=!1;e.rank===3&&(l=!0,i=Qe(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const u={dy:i,filter:t},h={strides:n,pad:s,dimRoundingMode:a,dilations:o,inputShape:r},d=Xe.runKernel(nw,u,h);return l?Qe(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const T7=Ze({depthwiseConv2dNativeBackpropInput_:_7});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k7({a:r,b:e,transposeA:t=!1,transposeB:n=!1,bias:s,activation:o="linear",preluActivationWeights:a,leakyreluAlpha:i=.2}){if(p2(Xe.state.gradientDepth,o)===!1){let M=lr(r,e,t,n);return s!=null&&(M=Rt(M,s)),f2(M,o,a,i)}let l=ke(r,"a","fused matMul"),u=ke(e,"b","fused matMul");[l,u]=Jr(l,u);const h=t?l.shape[l.rank-2]:l.shape[l.rank-1],d=n?u.shape[u.rank-1]:u.shape[u.rank-2],c=t?l.shape[l.rank-1]:l.shape[l.rank-2],f=n?u.shape[u.rank-2]:u.shape[u.rank-1],p=l.shape.slice(0,-2),m=u.shape.slice(0,-2),g=pt(p),y=pt(m);xe(h===d,()=>`Error in fused matMul: inner shapes (${h}) and (${d}) of Tensors with shapes ${l.shape} and ${u.shape} and transposeA=${t} and transposeB=${n} must match.`);const b=Dn(l.shape.slice(0,-2),u.shape.slice(0,-2)).concat([c,f]),w=t?Qe(l,[g,h,c]):Qe(l,[g,c,h]),_=n?Qe(u,[y,f,d]):Qe(u,[y,d,f]);let I;s!=null&&(I=ke(s,"bias","fused matMul"),[I]=Jr(I,l),Dn(b,I.shape));let C;a!=null&&(C=ke(a,"prelu weights","fused matMul"));const N=(M,P)=>{const[F,B,z,Z]=P,Q=h2(Qe(M,z.shape),z,o);let K,ne;if(!t&&!n?(K=lr(Q,B,!1,!0),ne=lr(F,Q,!0,!1)):!t&&n?(K=lr(Q,B,!1,!1),ne=lr(Q,F,!0,!1)):t&&!n?(K=lr(B,Q,!1,!0),ne=lr(F,Q,!1,!1)):(K=lr(B,Q,!0,!0),ne=lr(Q,F,!0,!0)),s!=null){const re=d2(Z,Q);return[K,ne,re]}else return[K,ne]},O={a:w,b:_,bias:I,preluActivationWeights:C},D={transposeA:t,transposeB:n,activation:o,leakyreluAlpha:i};return s==null?Mc((P,F,B)=>{const z=Xe.runKernel(Yg,O,D);return B([P,F,z]),{value:Qe(z,b),gradFunc:N}})(w,_):Mc((P,F,B,z)=>{const Z=Xe.runKernel(Yg,O,D);return z([P,F,Z,B]),{value:Qe(Z,b),gradFunc:N}})(w,_,I)}const Jk=Ze({fusedMatMul_:k7});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I7(r){return rN(r,.54,.46)}const ake=Ze({hammingWindow_:I7});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E7(r){return rN(r,.5,.5)}const C7=Ze({hannWindow_:E7});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $7(r,e,t,n=!1,s=0){let o=0;const a=[];for(;o+e<=r.size;)a.push(_r(r,o,e)),o+=t;if(n)for(;o<r.size;){const i=o+e-r.size,l=Hs([_r(r,o,e-i),Xp([i],s)]);a.push(l),o+=t}return a.length===0?Gg([],[0,e]):Qe(Hs(a),[a.length,e])}const N7=Ze({frame_:$7});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A7(r,e,t,n,s=C7){n==null&&(n=y7(e));const o=N7(r,e,t),a=We(o,s(e));return Q$(a,n)}const lke=Ze({stft_:A7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R7(r,e,t,n,s="bilinear",o=0){const a=ke(r,"image","cropAndResize"),i=ke(e,"boxes","cropAndResize","float32"),l=ke(t,"boxInd","cropAndResize","int32"),u=i.shape[0];xe(a.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${a.rank}.`),xe(i.rank===2&&i.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${u},4] but had shape ${i.shape}.`),xe(l.rank===1&&l.shape[0]===u,()=>`Error in cropAndResize: boxInd must be have size [${u}] but had shape ${i.shape}.`),xe(n.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${n.length}.`),xe(n[0]>=1&&n[1]>=1,()=>`cropSize must be atleast [1,1], but was ${n}`),xe(s==="bilinear"||s==="nearest",()=>`method must be bilinear or nearest, but was ${s}`);const h={image:a,boxes:i,boxInd:l},d={method:s,extrapolationValue:o,cropSize:n};return Xe.runKernel(Jx,h,d)}const D7=Ze({cropAndResize_:R7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O7(r){const e=ke(r,"image","flipLeftRight","float32");xe(e.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${e.rank}.`);const t={image:e};return Xe.runKernel(iw,t,{})}const M7=Ze({flipLeftRight_:O7});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F7(r){const e=ke(r,"image","grayscaleToRGB"),t=e.rank-1,n=e.shape[t];xe(e.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${e.rank}.`),xe(n===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${n}.`);const s=new Array(e.rank);return s.fill(1,0,t),s[t]=3,da(e,s)}const L7=Ze({grayscaleToRGB_:F7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P7(r,e,t=0,n=.5){const s=ke(r,"image","rotateWithOffset","float32");xe(s.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${s.rank}.`);const o={image:s},a={radians:e,fillValue:t,center:n};return Xe.runKernel(Aw,o,a)}const j7=Ze({rotateWithOffset_:P7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Td(r,e,t,n,s,o){n==null&&(n=.5),s==null&&(s=Number.NEGATIVE_INFINITY),o==null&&(o=0);const a=r.shape[0];return t=Math.min(t,a),xe(0<=n&&n<=1,()=>`iouThreshold must be in [0, 1], but was '${n}'`),xe(r.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${r.rank}'`),xe(r.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${r.shape[1]}`),xe(e.rank===1,()=>"scores must be a 1D tensor"),xe(e.shape[0]===a,()=>`scores has incompatible shape with boxes. Expected ${a}, but was ${e.shape[0]}`),xe(0<=o&&o<=1,()=>`softNmsSigma must be in [0, 1], but was '${o}'`),{maxOutputSize:t,iouThreshold:n,scoreThreshold:s,softNmsSigma:o}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B7(r,e,t,n=.5,s=Number.NEGATIVE_INFINITY){const o=ke(r,"boxes","nonMaxSuppression","float32"),a=ke(e,"scores","nonMaxSuppression","float32"),i=Td(o,a,t,n,s);t=i.maxOutputSize,n=i.iouThreshold,s=i.scoreThreshold;const l={maxOutputSize:t,iouThreshold:n,scoreThreshold:s};return Xe.runKernel(dw,{boxes:o,scores:a},l)}const U7=Ze({nonMaxSuppression_:B7});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z7(r,e,t){const n=V7(r,e,t),s=n<0?-(n+1):n;r.splice(s,0,e)}function V7(r,e,t){return W7(r,e,t||G7)}function G7(r,e){return r>e?1:r<e?-1:0}function W7(r,e,t){let n=0,s=r.length,o=0,a=!1;for(;n<s;){o=n+(s-n>>>1);const i=t(e,r[o]);i>0?n=o+1:(s=o,a=!i)}return a?n:-n-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m2(r,e,t,n,s){return v2(r,e,t,n,s,0)}function g2(r,e,t,n,s,o){return v2(r,e,t,n,s,0,!1,o,!0)}function y2(r,e,t,n,s,o){return v2(r,e,t,n,s,o,!0)}function v2(r,e,t,n,s,o,a=!1,i=!1,l=!1){const u=[];for(let g=0;g<e.length;g++)e[g]>s&&u.push({score:e[g],boxIndex:g,suppressBeginIndex:0});u.sort(eI);const h=o>0?-.5/o:0,d=[],c=[];for(;d.length<t&&u.length>0;){const g=u.pop(),{score:y,boxIndex:v,suppressBeginIndex:b}=g;if(y<s)break;let w=!1;for(let _=d.length-1;_>=b;--_){const I=H7(r,v,d[_]);if(I>=n){w=!0;break}if(g.score=g.score*q7(n,h,I),g.score<=s)break}g.suppressBeginIndex=d.length,w||(g.score===y?(d.push(v),c.push(g.score)):g.score>s&&z7(u,g,eI))}const f=d.length,p=t-f;i&&p>0&&(d.push(...new Array(p).fill(0)),c.push(...new Array(p).fill(0)));const m={selectedIndices:d};return a&&(m.selectedScores=c),l&&(m.validOutputs=f),m}function H7(r,e,t){const n=r.subarray(e*4,e*4+4),s=r.subarray(t*4,t*4+4),o=Math.min(n[0],n[2]),a=Math.min(n[1],n[3]),i=Math.max(n[0],n[2]),l=Math.max(n[1],n[3]),u=Math.min(s[0],s[2]),h=Math.min(s[1],s[3]),d=Math.max(s[0],s[2]),c=Math.max(s[1],s[3]),f=(i-o)*(l-a),p=(d-u)*(c-h);if(f<=0||p<=0)return 0;const m=Math.max(o,u),g=Math.max(a,h),y=Math.min(i,d),v=Math.min(l,c),b=Math.max(y-m,0)*Math.max(v-g,0);return b/(f+p-b)}function q7(r,e,t){const n=Math.exp(e*t*t);return t<=r?n:0}function eI(r,e){return r.score-e.score||r.score===e.score&&e.boxIndex-r.boxIndex}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function X7(r,e,t,n=.5,s=Number.NEGATIVE_INFINITY){const o=ke(r,"boxes","nonMaxSuppressionAsync"),a=ke(e,"scores","nonMaxSuppressionAsync"),i=Td(o,a,t,n,s);t=i.maxOutputSize,n=i.iouThreshold,s=i.scoreThreshold;const l=await Promise.all([o.data(),a.data()]),u=l[0],h=l[1],{selectedIndices:d}=m2(u,h,t,n,s);return o!==r&&o.dispose(),a!==e&&a.dispose(),Po(d,"int32")}const K7=X7;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y7(r,e,t,n=.5,s=Number.NEGATIVE_INFINITY,o=0){const a=ke(r,"boxes","nonMaxSuppression"),i=ke(e,"scores","nonMaxSuppression"),l=Td(a,i,t,n,s,o);t=l.maxOutputSize,n=l.iouThreshold,s=l.scoreThreshold,o=l.softNmsSigma;const u={boxes:a,scores:i},h={maxOutputSize:t,iouThreshold:n,scoreThreshold:s,softNmsSigma:o},d=Xe.runKernel(pw,u,h);return{selectedIndices:d[0],selectedScores:d[1]}}const Z7=Ze({nonMaxSuppressionWithScore_:Y7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Q7(r,e,t,n=.5,s=Number.NEGATIVE_INFINITY,o=0){const a=ke(r,"boxes","nonMaxSuppressionAsync"),i=ke(e,"scores","nonMaxSuppressionAsync"),l=Td(a,i,t,n,s,o);t=l.maxOutputSize,n=l.iouThreshold,s=l.scoreThreshold,o=l.softNmsSigma;const u=await Promise.all([a.data(),i.data()]),h=u[0],d=u[1],{selectedIndices:c,selectedScores:f}=y2(h,d,t,n,s,o);return a!==r&&a.dispose(),i!==e&&i.dispose(),{selectedIndices:Po(c,"int32"),selectedScores:Po(f)}}const J7=Q7;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e9(r,e,t,n=.5,s=Number.NEGATIVE_INFINITY,o=!1){const a=ke(r,"boxes","nonMaxSuppression"),i=ke(e,"scores","nonMaxSuppression"),l=Td(a,i,t,n,s,null),u=l.maxOutputSize,h=l.iouThreshold,d=l.scoreThreshold,c={boxes:a,scores:i},f={maxOutputSize:u,iouThreshold:h,scoreThreshold:d,padToMaxOutputSize:o},p=Xe.runKernel(fw,c,f);return{selectedIndices:p[0],validOutputs:p[1]}}const t9=Ze({nonMaxSuppressionPadded_:e9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function n9(r,e,t,n=.5,s=Number.NEGATIVE_INFINITY,o=!1){const a=ke(r,"boxes","nonMaxSuppressionAsync"),i=ke(e,"scores","nonMaxSuppressionAsync"),l=Td(a,i,t,n,s,null),u=l.maxOutputSize,h=l.iouThreshold,d=l.scoreThreshold,[c,f]=await Promise.all([a.data(),i.data()]),{selectedIndices:p,validOutputs:m}=g2(c,f,u,h,d,o);return a!==r&&a.dispose(),i!==e&&i.dispose(),{selectedIndices:Po(p,"int32"),validOutputs:An(m,"int32")}}const r9=n9;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s9(r,e,t=!1,n=!1){const s=ke(r,"images","resizeBilinear");xe(s.rank===3||s.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${s.rank}.`),xe(e.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${e}.`),xe(n===!1||t===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let o=s,a=!1;s.rank===3&&(a=!0,o=Qe(s,[1,s.shape[0],s.shape[1],s.shape[2]]));const i={images:o},l={alignCorners:t,halfPixelCenters:n,size:e},u=Xe.runKernel($0,i,l);return a?Qe(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const sN=Ze({resizeBilinear_:s9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o9(r,e,t=!1,n=!1){const s=ke(r,"images","resizeNearestNeighbor");xe(s.rank===3||s.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${s.rank}.`),xe(e.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${e}.`),xe(s.dtype==="float32"||s.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),xe(n===!1||t===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let o=s,a=!1;s.rank===3&&(a=!0,o=Qe(s,[1,s.shape[0],s.shape[1],s.shape[2]]));const i={images:o},l={alignCorners:t,halfPixelCenters:n,size:e},u=Xe.runKernel(C0,i,l);return a?Qe(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const oN=Ze({resizeNearestNeighbor_:o9});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i9(r,e="binary",t=!1,n=.5){const s=ke(r,"image","threshold"),o=.2989,a=.587,i=.114,l=s.shape[0]*s.shape[1];let u=We(Po([n]),255),h,d,c,f;if(xe(s.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${s.rank}.`),xe(s.shape[2]===3||s.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${s.shape[2]}.`),xe(s.dtype==="int32"||s.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${s.dtype}.`),xe(e==="otsu"||e==="binary",()=>`Method must be binary or otsu, but was ${e}`),s.shape[2]===3){[h,d,c]=fi(s,[1,1,1],-1);const g=We(h,o),y=We(d,a),v=We(c,i);f=Rt(Rt(g,y),v)}else f=r;if(e==="otsu"){const g=bW(Yt(G$(f),"int32"),AV([]),256);u=a9(g,l)}const p=t?_d(f,u):Ki(f,u);return Yt(We(p,255),"int32")}function a9(r,e){let t=Po([-1]),n=Po([0]),s=Po([0]),o,a,i,l,u,h;for(let d=0;d<r.size-1;d++){o=_r(r,0,d+1),a=_r(r,d+1),u=fn(rn(o),e),h=fn(rn(a),e);const c=rn(We(o,sy(0,o.size)));i=fn(c,rn(o));const f=Xp(a.shape,o.size),p=Rt(sy(0,a.size),f),m=We(a,p);l=fn(rn(m),rn(a));const g=sn(i,l),y=sn(i,l),v=We(u,h);s=We(We(v,g),y);const b=Ki(s,n);n=zo(b,s,n),t=zo(b,Po([d]),t)}return t}const l9=Ze({threshold_:i9});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u9(r,e,t="nearest",n="constant",s=0,o){const a=ke(r,"image","transform","float32"),i=ke(e,"transforms","transform","float32");xe(a.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${a.rank}.`),xe(i.rank===2&&(i.shape[0]===a.shape[0]||i.shape[0]===1)&&i.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),xe(o==null||o.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${o}.`);const l={image:a,transforms:i},u={interpolation:t,fillMode:n,fillValue:s,outputShape:o};return Xe.runKernel($w,l,u)}const c9=Ze({transform_:u9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h9(r,e,t){xe(e%1===0,()=>`bandPart(): numLower must be an integer, got ${e}.`),xe(t%1===0,()=>`bandPart(): numUpper must be an integer, got ${t}.`);const n=ke(r,"a","bandPart");xe(n.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${n.rank}.`);const s=n.shape,[o,a]=n.shape.slice(-2);if(!(e<=o))throw new Error(`bandPart(): numLower (${e}) must not be greater than the number of rows (${o}).`);if(!(t<=a))throw new Error(`bandPart(): numUpper (${t}) must not be greater than the number of columns (${a}).`);e<0&&(e=o),t<0&&(t=a);const i=Qe(sy(0,o,1,"int32"),[-1,1]),l=sy(0,a,1,"int32"),u=sn(i,l),h=El(_d(u,An(+e,"int32")),Sd(u,An(-t,"int32"))),d=Ss([o,a],n.dtype);return Qe(Lc(td(Qe(n,[-1,o,a])).map(c=>zo(h,c,d))),s)}const d9=Ze({bandPart_:h9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f9(r){let e;if(Array.isArray(r)){e=!1,xe(r!=null&&r.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const s=r[0].shape[0];for(let o=1;o<r.length;++o)xe(r[o].shape[0]===s,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${r[o].shape[0]} vs. ${s})`)}else e=!0,r=fi(r,r.shape[0],0).map(s=>Yp(s,[0]));xe(r.length<=r[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${r.length}) exceeds number of dimensions (${r[0].shape[0]}).`);const t=[],n=r;for(let s=0;s<r.length;++s)t.push(Xe.tidy(()=>{let o=n[s];if(s>0)for(let a=0;a<s;++a){const i=We(rn(We(t[a],o)),t[a]);o=sn(o,i)}return fn(o,q0(o,"euclidean"))}));return e?Lc(t,0):t}const p9=Ze({gramSchmidt_:f9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m9(r,e=!1){if(xe(r.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${r.rank}`),r.rank===2)return tI(r,e);{const t=r.shape.slice(0,r.shape.length-2).reduce((l,u)=>l*u),n=td(Qe(r,[t,r.shape[r.shape.length-2],r.shape[r.shape.length-1]]),0),s=[],o=[];n.forEach(l=>{const[u,h]=tI(l,e);s.push(u),o.push(h)});const a=Qe(Lc(s,0),r.shape),i=Qe(Lc(o,0),r.shape);return[a,i]}}function tI(r,e=!1){return Xe.tidy(()=>{xe(r.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${r.shape.length}D Tensor.`);const t=r.shape[0],n=r.shape[1];let s=N$(t),o=Sc(r);const a=Gg([[1]],[1,1]);let i=Sc(a);const l=t>=n?n:t;for(let u=0;u<l;++u){const h=o,d=i,c=s;[i,o,s]=Xe.tidy(()=>{const f=_r(o,[u,u],[t-u,1]),p=q0(f),m=_r(o,[u,u],[1,1]),g=zo(Ki(m,0),Gg([[-1]]),Gg([[1]])),y=sn(m,We(g,p)),v=fn(f,y);v.shape[0]===1?i=Sc(a):i=Hs([a,_r(v,[1,0],[v.shape[0]-1,v.shape[1]])],0);const b=Wr(fn(lr(g,y),p)),w=_r(o,[u,0],[t-u,n]),_=We(b,i),I=nr(i);if(u===0)o=sn(w,lr(_,lr(I,w)));else{const O=sn(w,lr(_,lr(I,w)));o=Hs([_r(o,[0,0],[u,n]),O],0)}const C=nr(_),N=_r(s,[0,u],[t,s.shape[1]-u]);if(u===0)s=sn(N,lr(lr(N,i),C));else{const O=sn(N,lr(lr(N,i),C));s=Hs([_r(s,[0,0],[t,u]),O],1)}return[i,o,s]}),Kn([h,d,c])}return!e&&t>n&&(s=_r(s,[0,0],[t,n]),o=_r(o,[0,0],[n,n])),[s,o]})}const g9=Ze({qr_:m9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var bo;(function(r){r[r.NONE=0]="NONE",r[r.MEAN=1]="MEAN",r[r.SUM=2]="SUM",r[r.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(bo||(bo={}));function y9(r,e,t=bo.SUM_BY_NONZERO_WEIGHTS){const n=ke(r,"losses","computeWeightedLoss");let s=null;e!=null&&(s=ke(e,"weights","computeWeightedLoss"));const o=s==null?n:We(n,s);if(t===bo.NONE)return o;if(t===bo.SUM)return rn(o);if(t===bo.MEAN){if(s==null)return Qr(o);{const a=n.size/s.size,i=fn(rn(o),rn(s));return a>1?fn(i,An(a)):i}}if(t===bo.SUM_BY_NONZERO_WEIGHTS){if(s==null)return fn(rn(o),An(n.size));{const a=We(s,$u(n.shape)),i=Yt(rn(Ef(a,An(0))),"float32");return fn(rn(o),i)}}throw Error(`Unknown reduction: ${t}`)}const Nu=Ze({computeWeightedLoss_:y9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v9(r,e,t,n=bo.SUM_BY_NONZERO_WEIGHTS){const s=ke(r,"labels","absoluteDifference"),o=ke(e,"predictions","absoluteDifference");let a=null;t!=null&&(a=ke(t,"weights","absoluteDifference")),qi(s.shape,o.shape,"Error in absoluteDifference: ");const i=bs(sn(s,o));return Nu(i,a,n)}const uke=Ze({absoluteDifference_:v9});function b9(r,e,t,n,s=bo.SUM_BY_NONZERO_WEIGHTS){const o=ke(r,"labels","cosineDistance"),a=ke(e,"predictions","cosineDistance");let i=null;n!=null&&(i=ke(n,"weights","cosineDistance")),qi(o.shape,a.shape,"Error in cosineDistance: ");const l=An(1),u=sn(l,rn(We(o,a),t,!0));return Nu(u,i,s)}const cke=Ze({cosineDistance_:b9});function x9(r,e,t,n=bo.SUM_BY_NONZERO_WEIGHTS){let s=ke(r,"labels","hingeLoss");const o=ke(e,"predictions","hingeLoss");let a=null;t!=null&&(a=ke(t,"weights","hingeLoss")),qi(s.shape,o.shape,"Error in hingeLoss: ");const i=An(1);s=sn(We(An(2),s),i);const l=Dl(sn(i,We(s,o)));return Nu(l,a,n)}const hke=Ze({hingeLoss_:x9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w9(r,e,t,n=1,s=bo.SUM_BY_NONZERO_WEIGHTS){const o=ke(r,"labels","huberLoss"),a=ke(e,"predictions","huberLoss");let i=null;t!=null&&(i=ke(t,"weights","huberLoss")),qi(o.shape,a.shape,"Error in huberLoss: ");const l=An(n),u=bs(sn(a,o)),h=K0(u,l),d=sn(u,h),c=Rt(We(An(.5),Ar(h)),We(l,d));return Nu(c,i,s)}const dke=Ze({huberLoss_:w9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S9(r,e,t,n=1e-7,s=bo.SUM_BY_NONZERO_WEIGHTS){const o=ke(r,"labels","logLoss"),a=ke(e,"predictions","logLoss");let i=null;t!=null&&(i=ke(t,"weights","logLoss")),qi(o.shape,a.shape,"Error in logLoss: ");const l=An(1),u=An(n),h=Wr(We(o,Wi(Rt(a,u)))),d=We(sn(l,o),Wi(Rt(sn(l,a),u))),c=sn(h,d);return Nu(c,i,s)}const fke=Ze({logLoss_:S9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _9(r,e,t,n=bo.SUM_BY_NONZERO_WEIGHTS){const s=ke(r,"labels","meanSquaredError"),o=ke(e,"predictions","meanSquaredError");let a=null;t!=null&&(a=ke(t,"weights","meanSquaredError")),qi(s.shape,o.shape,"Error in meanSquaredError: ");const i=J$(s,o);return Nu(i,a,n)}const pke=Ze({meanSquaredError_:_9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T9(r,e){const t=ke(r,"labels","sigmoidCrossEntropyWithLogits"),n=ke(e,"logits","sigmoidCrossEntropyWithLogits");qi(t.shape,n.shape,"Error in sigmoidCrossEntropyWithLogits: ");const s=Dl(n),o=We(n,t),a=Jw(Gi(Wr(bs(n))));return Rt(sn(s,o),a)}function k9(r,e,t,n=0,s=bo.SUM_BY_NONZERO_WEIGHTS){let o=ke(r,"multiClassLabels","sigmoidCrossEntropy");const a=ke(e,"logits","sigmoidCrossEntropy");let i=null;if(t!=null&&(i=ke(t,"weights","sigmoidCrossEntropy")),qi(o.shape,a.shape,"Error in sigmoidCrossEntropy: "),n>0){const u=An(n),h=An(1),d=An(.5);o=Rt(We(o,sn(h,u)),We(d,u))}const l=T9(o,a);return Nu(l,i,s)}const mke=Ze({sigmoidCrossEntropy_:k9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I9(r,e,t=-1){if(t===-1&&(t=e.rank-1),t!==e.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${e.rank} and dim was ${t}`);return Mc((s,o,a)=>{const l=D$(o,[t],!0),u=sn(Yt(o,"float32"),l);a([s,u]);const h=Wr(We(u,s));return{value:rn(h,[t]),gradFunc:(f,p)=>{const[m,g]=p,y=es(f.shape,[t]);return[We(Qe(f,y),sn(Yt(m,"float32"),Gi(g))),We(Qe(f,y),sn(Gi(g),Yt(m,"float32")))]}}})(r,e)}function E9(r,e,t,n=0,s=bo.SUM_BY_NONZERO_WEIGHTS){let o=ke(r,"onehotLabels","softmaxCrossEntropy");const a=ke(e,"logits","softmaxCrossEntropy");let i=null;if(t!=null&&(i=ke(t,"weights","softmaxCrossEntropy")),qi(o.shape,a.shape,"Error in softmaxCrossEntropy: "),n>0){const u=An(n),h=An(1),d=An(o.shape[1]);o=Rt(We(o,sn(h,u)),fn(u,d))}const l=I9(o,a);return Nu(l,i,s)}const gke=Ze({softmaxCrossEntropy_:E9});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C9(r,e,t,n){const s=ke(r,"indices","sparseFillEmptyRows","int32"),o=ke(e,"values","sparseFillEmptyRows"),a=ke(t,"denseShape","sparseFillEmptyRows","int32"),i=ke(n,"defaultValue","sparseFillEmptyRows",o.dtype);if(s.rank!==2)throw new Error(`Indices should be Tensor2D but received shape
        ${s.shape}`);if(o.rank!==1)throw new Error(`Values should be Tensor1D but received shape ${o.shape}`);if(a.rank!==1)throw new Error(`Dense shape should be Tensor1D but received shape ${a.shape}`);if(i.rank!==0)throw new Error(`Default value should be a scalar but received shape ${i.shape}`);const l={indices:s,values:o,denseShape:a,defaultValue:i},u=Xe.runKernel(bw,l);return{outputIndices:u[0],outputValues:u[1],emptyRowIndicator:u[2],reverseIndexMap:u[3]}}const yke=Ze({sparseFillEmptyRows_:C9});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $9(r,e,t){const n=ke(r,"inputIndices","sparseReshape","int32"),s=ke(e,"inputShape","sparseReshape","int32"),o=ke(t,"newShape","sparseReshape","int32");if(n.rank!==2)throw new Error(`Input indices should be Tensor2D but received shape
        ${n.shape}`);if(s.rank!==1)throw new Error(`Input shape should be Tensor1D but received shape ${s.shape}`);if(o.rank!==1)throw new Error(`New shape should be Tensor1D but received shape ${o.shape}`);const a={inputIndices:n,inputShape:s,newShape:o},i=Xe.runKernel(xw,a);return{outputIndices:i[0],outputShape:i[1]}}const vke=Ze({sparseReshape_:$9});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N9(r,e,t){const n=ke(r,"data","sparseSegmentMean"),s=ke(e,"indices","sparseSegmentMean","int32"),o=ke(t,"segmentIds","sparseSegmentMean","int32");if(n.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
          ${s.shape}`);if(o.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
          ${o.shape}`);const a={data:n,indices:s,segmentIds:o};return Xe.runKernel(ww,a)}const bke=Ze({sparseSegmentMean_:N9});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A9(r,e,t){const n=ke(r,"data","sparseSegmentSum"),s=ke(e,"indices","sparseSegmentSum","int32"),o=ke(t,"segmentIds","sparseSegmentSum","int32");if(n.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
         ${s.shape}`);if(o.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
         ${o.shape}`);const a={data:n,indices:s,segmentIds:o};return Xe.runKernel(Sw,a)}const xke=Ze({sparseSegmentSum_:A9});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R9(r,e,t,n,s,o,a,i){const l=ke(r,"data","stringNGrams","string");if(l.dtype!=="string")throw new Error("Data must be of datatype string");if(l.shape.length!==1)throw new Error(`Data must be a vector, saw: ${l.shape}`);const u=ke(e,"dataSplits","stringNGrams");if(u.dtype!=="int32")throw new Error("Data splits must be of datatype int32");const h={separator:t,nGramWidths:n,leftPad:s,rightPad:o,padWidth:a,preserveShortSequences:i},d={data:l,dataSplits:u},c=Xe.runKernel(kw,d,h);return{nGrams:c[0],nGramsSplits:c[1]}}const wke=Ze({stringNGrams_:R9});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D9(r,e,t=!0){const n=ke(r,"input","stringSplit","string"),s=ke(e,"delimiter","stringSplit","string");if(n.rank!==1)throw new Error(`Input should be Tensor1D but received shape ${n.shape}`);if(s.rank!==0)throw new Error(`Delimiter should be a scalar but received shape ${s.shape}`);const o={skipEmpty:t},a={input:n,delimiter:s},i=Xe.runKernel(Iw,a,o);return{indices:i[0],values:i[1],shape:i[2]}}const Ske=Ze({stringSplit_:D9});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O9(r,e){const t=ke(r,"input","stringToHashBucketFast","string"),n={numBuckets:e};if(e<=0)throw new Error("Number of buckets must be at least 1");const s={input:t};return Xe.runKernel(Ew,s,n)}const _ke=Ze({stringToHashBucketFast_:O9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hg={flipLeftRight:M7,grayscaleToRGB:L7,resizeNearestNeighbor:oN,resizeBilinear:sN,rotateWithOffset:j7,cropAndResize:D7,nonMaxSuppression:U7,nonMaxSuppressionAsync:K7,nonMaxSuppressionWithScore:Z7,nonMaxSuppressionWithScoreAsync:J7,nonMaxSuppressionPadded:t9,nonMaxSuppressionPaddedAsync:r9,threshold:l9,transform:c9},M9={bandPart:d9,gramSchmidt:p9,qr:g9};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Au extends xd{minimize(e,t=!1,n){const{value:s,grads:o}=this.computeGradients(e,n);if(n!=null){const a=n.map(i=>({name:i.name,tensor:o[i.name]}));this.applyGradients(a)}else this.applyGradients(o);return Kn(o),t?s:(s.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,t){return P8(e,t)}dispose(){this.iterations_!=null&&Kn(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:An(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}}Object.defineProperty(Au,Symbol.hasInstance,{value:r=>r.minimize!=null&&r.computeGradients!=null&&r.applyGradients!=null});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class b2 extends Au{constructor(e,t,n=null){super(),this.learningRate=e,this.rho=t,this.epsilon=n,this.accumulatedGrads=[],this.accumulatedUpdates=[],n==null&&(this.epsilon=Xe.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map(n=>n.name):Object.keys(e)).forEach((n,s)=>{const o=Xe.registeredVariables[n],a=!1;this.accumulatedGrads[s]==null&&(this.accumulatedGrads[s]={originalName:`${n}/accum_grad`,variable:at(()=>ir(o).variable(a))}),this.accumulatedUpdates[s]==null&&(this.accumulatedUpdates[s]={originalName:`${n}/accum_var`,variable:at(()=>ir(o).variable(a))});const i=Array.isArray(e)?e[s].tensor:e[n];if(i==null)return;const l=this.accumulatedGrads[s].variable,u=this.accumulatedUpdates[s].variable;at(()=>{const h=Rt(We(l,this.rho),We(Ar(i),1-this.rho)),d=We(fn(io(Rt(u,this.epsilon)),io(Rt(l,this.epsilon))),i),c=Rt(We(u,this.rho),We(Ar(d),1-this.rho));l.assign(h),u.assign(c);const f=Rt(We(d,-this.learningRate),o);o.assign(f)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(Kn(this.accumulatedGrads.map(e=>e.variable)),Kn(this.accumulatedUpdates.map(e=>e.variable)))}async getWeights(){const e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=e.length/2,n=!1;this.accumulatedGrads=e.slice(0,t).map(s=>({originalName:s.name,variable:s.tensor.variable(n)})),this.accumulatedUpdates=e.slice(t,t*2).map(s=>({originalName:s.name,variable:s.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.rho,t.epsilon)}}b2.className="Adadelta";Et(b2);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class x2 extends Au{constructor(e,t=.1){super(),this.learningRate=e,this.initialAccumulatorValue=t,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map(n=>n.name):Object.keys(e)).forEach((n,s)=>{const o=Xe.registeredVariables[n];this.accumulatedGrads[s]==null&&(this.accumulatedGrads[s]={originalName:`${n}/accumulator`,variable:at(()=>Xp(o.shape,this.initialAccumulatorValue).variable(!1))});const a=Array.isArray(e)?e[s].tensor:e[n];if(a==null)return;const i=this.accumulatedGrads[s].variable;at(()=>{const l=Rt(i,Ar(a));i.assign(l);const u=Rt(We(fn(a,io(Rt(l,Xe.backend.epsilon()))),-this.learningRate),o);o.assign(u)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&Kn(this.accumulatedGrads.map(e=>e.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=!1;this.accumulatedGrads=e.map(n=>({originalName:n.name,variable:n.tensor.variable(t)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,t){return new e(t.learningRate,t.initialAccumulatorValue)}}x2.className="Adagrad";Et(x2);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class w2 extends Au{constructor(e,t,n,s=null){super(),this.learningRate=e,this.beta1=t,this.beta2=n,this.epsilon=s,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],at(()=>{this.accBeta1=An(t).variable(),this.accBeta2=An(n).variable()}),s==null&&(this.epsilon=Xe.backend.epsilon())}applyGradients(e){const t=Array.isArray(e)?e.map(n=>n.name):Object.keys(e);at(()=>{const n=sn(1,this.accBeta1),s=sn(1,this.accBeta2);t.forEach((o,a)=>{const i=Xe.registeredVariables[o],l=!1;this.accumulatedFirstMoment[a]==null&&(this.accumulatedFirstMoment[a]={originalName:`${o}/m`,variable:at(()=>ir(i).variable(l))}),this.accumulatedSecondMoment[a]==null&&(this.accumulatedSecondMoment[a]={originalName:`${o}/v`,variable:at(()=>ir(i).variable(l))});const u=Array.isArray(e)?e[a].tensor:e[o];if(u==null)return;const h=this.accumulatedFirstMoment[a].variable,d=this.accumulatedSecondMoment[a].variable,c=Rt(We(h,this.beta1),We(u,1-this.beta1)),f=Rt(We(d,this.beta2),We(Ar(u),1-this.beta2)),p=fn(c,n),m=fn(f,s);h.assign(c),d.assign(f);const g=Rt(We(fn(p,Rt(io(m),this.epsilon)),-this.learningRate),i);i.assign(g)}),this.accBeta1.assign(We(this.accBeta1,this.beta1)),this.accBeta2.assign(We(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&Kn(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedSecondMoment!=null&&Kn(this.accumulatedSecondMoment.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e),at(()=>{this.accBeta1.assign(ed(this.beta1,this.iterations_+1)),this.accBeta2.assign(ed(this.beta2,this.iterations_+1))});const t=e.length/2,n=!1;this.accumulatedFirstMoment=e.slice(0,t).map(s=>({originalName:s.name,variable:s.tensor.variable(n)})),this.accumulatedSecondMoment=e.slice(t,t*2).map(s=>({originalName:s.name,variable:s.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon)}}w2.className="Adam";Et(w2);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class S2 extends Au{constructor(e,t,n,s=null,o=0){super(),this.learningRate=e,this.beta1=t,this.beta2=n,this.epsilon=s,this.decay=o,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],at(()=>{this.iteration=An(0).variable(),this.accBeta1=An(t).variable()}),s==null&&(this.epsilon=Xe.backend.epsilon())}applyGradients(e){const t=Array.isArray(e)?e.map(n=>n.name):Object.keys(e);at(()=>{const n=sn(1,this.accBeta1),s=fn(-this.learningRate,Rt(We(this.iteration,this.decay),1));t.forEach((o,a)=>{const i=Xe.registeredVariables[o],l=!1;this.accumulatedFirstMoment[a]==null&&(this.accumulatedFirstMoment[a]={originalName:`${o}/m`,variable:ir(i).variable(l)}),this.accumulatedWeightedInfNorm[a]==null&&(this.accumulatedWeightedInfNorm[a]={originalName:`${o}/v`,variable:ir(i).variable(l)});const u=Array.isArray(e)?e[a].tensor:e[o];if(u==null)return;const h=this.accumulatedFirstMoment[a].variable,d=this.accumulatedWeightedInfNorm[a].variable,c=Rt(We(h,this.beta1),We(u,1-this.beta1)),f=We(d,this.beta2),p=bs(u),m=Cu(f,p);h.assign(c),d.assign(m);const g=Rt(We(fn(s,n),fn(c,Rt(m,this.epsilon))),i);i.assign(g)}),this.iteration.assign(Rt(this.iteration,1)),this.accBeta1.assign(We(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&Kn(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedWeightedInfNorm!=null&&Kn(this.accumulatedWeightedInfNorm.map(e=>e.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon,t.decay)}}S2.className="Adamax";Et(S2);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Z0 extends Au{constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map(n=>n.name):Object.keys(e)).forEach((n,s)=>{const o=Array.isArray(e)?e[s].tensor:e[n];if(o==null)return;const a=Xe.registeredVariables[n];at(()=>{const i=Rt(We(this.c,o),a);a.assign(i)})}),this.incrementIterations()}setLearningRate(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=Ya(An(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(e=await this.extractIterations(e),e.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,t){return new e(t.learningRate)}}Z0.className="SGD";Et(Z0);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _2 extends Z0{constructor(e,t,n=!1){super(e),this.learningRate=e,this.momentum=t,this.useNesterov=n,this.accumulations=[],this.m=An(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map(n=>n.name):Object.keys(e)).forEach((n,s)=>{const o=Xe.registeredVariables[n];this.accumulations[s]==null&&(this.accumulations[s]={originalName:`${n}/momentum`,variable:at(()=>ir(o).variable(!1))});const a=this.accumulations[s].variable,i=Array.isArray(e)?e[s].tensor:e[n];i!=null&&at(()=>{let l;const u=Rt(We(this.m,a),i);this.useNesterov?l=Rt(We(this.c,Rt(i,We(u,this.m))),o):l=Rt(We(this.c,u),o),a.assign(u),o.assign(l)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&Kn(this.accumulations.map(e=>e.variable))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=!1;this.accumulations=e.map(n=>({originalName:n.name,variable:n.tensor.variable(t)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,t){return new e(t.learningRate,t.momentum,t.useNesterov)}}_2.className="Momentum";Et(_2);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class T2 extends Au{constructor(e,t=.9,n=0,s=null,o=!1){if(super(),this.learningRate=e,this.decay=t,this.momentum=n,this.epsilon=s,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=o,s==null&&(this.epsilon=Xe.backend.epsilon()),e==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map(n=>n.name):Object.keys(e)).forEach((n,s)=>{const o=Xe.registeredVariables[n],a=!1;this.accumulatedMeanSquares[s]==null&&(this.accumulatedMeanSquares[s]={originalName:`${n}/rms`,variable:at(()=>ir(o).variable(a))}),this.accumulatedMoments[s]==null&&(this.accumulatedMoments[s]={originalName:`${n}/momentum`,variable:at(()=>ir(o).variable(a))}),this.accumulatedMeanGrads[s]==null&&this.centered&&(this.accumulatedMeanGrads[s]={originalName:`${n}/mg`,variable:at(()=>ir(o).variable(a))});const i=Array.isArray(e)?e[s].tensor:e[n];if(i==null)return;const l=this.accumulatedMeanSquares[s].variable,u=this.accumulatedMoments[s].variable;at(()=>{const h=Rt(We(l,this.decay),We(Ar(i),1-this.decay));if(this.centered){const d=this.accumulatedMeanGrads[s].variable,c=Rt(We(d,this.decay),We(i,1-this.decay)),f=fn(We(i,this.learningRate),io(sn(h,Rt(Ar(c),this.epsilon)))),p=Rt(We(u,this.momentum),f);l.assign(h),d.assign(c),u.assign(p);const m=sn(o,p);o.assign(m)}else{const d=Rt(We(l,this.decay),We(Ar(i),1-this.decay)),c=Rt(We(u,this.momentum),fn(We(i,this.learningRate),io(Rt(d,this.epsilon))));l.assign(d),u.assign(c);const f=sn(o,c);o.assign(f)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&Kn(this.accumulatedMeanSquares.map(e=>e.variable)),this.accumulatedMeanGrads!=null&&this.centered&&Kn(this.accumulatedMeanGrads.map(e=>e.variable)),this.accumulatedMoments!=null&&Kn(this.accumulatedMoments.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=this.centered?e.length/3:e.length/2,n=!1;this.accumulatedMeanSquares=e.slice(0,t).map(s=>({originalName:s.name,variable:s.tensor.variable(n)})),this.accumulatedMoments=e.slice(t,t*2).map(s=>({originalName:s.name,variable:s.tensor.variable(n)})),this.centered&&(this.accumulatedMeanGrads=e.slice(t*2,t*3).map(s=>({originalName:s.name,variable:s.tensor.variable(n)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,t){return new e(t.learningRate,t.decay,t.momentum,t.epsilon,t.centered)}}T2.className="RMSProp";Et(T2);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lc{static sgd(e){return new Z0(e)}static momentum(e,t,n=!1){return new _2(e,t,n)}static rmsprop(e,t=.9,n=0,s=null,o=!1){return new T2(e,t,n,s,o)}static adam(e=.001,t=.9,n=.999,s=null){return new w2(e,t,n,s)}static adadelta(e=.001,t=.95,n=null){return new b2(e,t,n)}static adamax(e=.002,t=.9,n=.999,s=null,o=0){return new S2(e,t,n,s,o)}static adagrad(e,t=.1){return new x2(e,t)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sh={sgd:lc.sgd,momentum:lc.momentum,adadelta:lc.adadelta,adagrad:lc.adagrad,rmsprop:lc.rmsprop,adamax:lc.adamax,adam:lc.adam};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const F9=(()=>typeof requestAnimationFrame!="undefined"?requestAnimationFrame:typeof setImmediate!="undefined"?setImmediate:r=>r())();function iN(){return new Promise(r=>F9(()=>r()))}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k2(r,e){const t=r[0].length;r.forEach((s,o)=>{xe(s.length===t,()=>`Error in concat${t}D: rank of tensors[${o}] must be the same as the rank of the rest (${t})`)}),xe(e>=0&&e<t,()=>`Error in concat${t}D: axis must be between 0 and ${t-1}.`);const n=r[0];r.forEach((s,o)=>{for(let a=0;a<t;a++)xe(a===e||s[a]===n[a],()=>`Error in concat${t}D: Shape of tensors[${o}] (${s}) does not match the shape of the rest (${n}) along the non-concatenated axis ${o}.`)})}function qa(r,e){const t=r[0].slice();for(let n=1;n<r.length;n++)t[e]+=r[n][e];return t}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var aa;(function(r){r[r.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",r[r.VALUE_ROWIDS=1]="VALUE_ROWIDS",r[r.ROW_LENGTHS=2]="ROW_LENGTHS",r[r.ROW_SPLITS=3]="ROW_SPLITS",r[r.ROW_LIMITS=4]="ROW_LIMITS",r[r.ROW_STARTS=5]="ROW_STARTS"})(aa||(aa={}));function aN(r,e,t){let n=new Array;if(t==null&&e==null)return n;if(e==null)for(;n.length<r+t.length;)n.push(-1);else n=e.slice();if(t==null)return n;if(r+t.length!==n.length)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.rank = ${r+t.length}, but shape.rank = ${n.length}`);for(let s=1;s<t.length;++s){const o=t[s],a=n[n.length-t.length+s],i=n[a];if(o>=0)if(i>=0){if(i!==o)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.shape[${s+r}] = ${o} but shape[${s+r}] = ${i}`)}else n[a]=o}return n}function lN(r){const e={FIRST_DIM_SIZE:aa.FIRST_DIM_SIZE,VALUE_ROWIDS:aa.VALUE_ROWIDS,ROW_LENGTHS:aa.ROW_LENGTHS,ROW_SPLITS:aa.ROW_SPLITS,ROW_LIMITS:aa.ROW_LIMITS,ROW_STARTS:aa.ROW_STARTS},t=[];for(const n of r)if(n in e)t.push(e[n]);else break;return t}function uN(r){return r.length===0?0:r[0]===aa.FIRST_DIM_SIZE?r.length-1:r.length}function cN(r,e){if(r==null||e==null)return;const t=r.length,n=e.length;if(t>=n)throw new Error(`defaultValue.shape=${r} and ragged tensor flatValues.shape=${e}, are incompatible: defaultValue.rank = ${t} must be less than ragged tensor input flatValues.rank = ${n})`);for(let s=0;s<Math.min(t,n-1);++s){const o=r[s],a=e[s+1];if(o>=0&&a>=0&&o!==1&&o!==a)throw new Error(`defaultValue.shape=${r}, and ragged tensor input flatValues.shape=${e} are incompatible: defaultValue.shape[${s-r.length}] = ${o} but ragged tensor input.flatValues.shape[${s-r.length}] = ${a}`)}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const I2=30;function Q0(r){return r<=I2?r:vb(r,Math.floor(Math.sqrt(r)))}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E2(r,e,t){const n=t*(typeof r=="number"?r:r[0]),s=e*(typeof r=="number"?r:r[1]);return[n,s]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qp(r,e,t,n=!0){let s=[];if(n)s=s.concat(e.slice(0)),s.push(r[0]/t),s=s.concat(r.slice(1));else{s=s.concat(r[0]);const o=e.length;for(let a=0;a<o;++a)s=s.concat([r[a+1]/e[a],e[a]]);s=s.concat(r.slice(o+1))}return s}function Jp(r,e,t=!0){const n=[];if(t){n.push(e);for(let s=e+1;s<r;++s)s<=2*e?(n.push(s),n.push(s-(e+1))):n.push(s)}else{const s=[],o=[];for(let a=1;a<r;++a)a>=e*2+1||a%2===1?o.push(a):s.push(a);n.push(...s),n.push(0),n.push(...o)}return n}function em(r,e,t,n=!0){const s=[];n?s.push(r[0]/t):s.push(r[0]*t);for(let o=1;o<r.length;++o)o<=e.length?n?s.push(e[o-1]*r[o]):s.push(r[o]/e[o-1]):s.push(r[o]);return s}function C2(r,e){const t=[0];for(let n=0;n<e;++n)t.push(r[n][0]);return t}function $2(r,e,t){const n=r.slice(0,1);for(let s=0;s<t;++s)n.push(r[s+1]-e[s][0]-e[s][1]);return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const J0=1.7580993408473768,e1=1.0507009873554805;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const N2=.3275911,A2=.254829592,R2=-.284496736,D2=1.421413741,O2=-1.453152027,M2=1.061405429;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cl(r,e){if(r.length!==e.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${r.length}, imag: ${e.length}.`);const t=new Float32Array(r.length*2);for(let n=0;n<t.length;n+=2)t[n]=r[n/2],t[n+1]=e[n/2];return t}function hN(r){const e=new Float32Array(r.length/2),t=new Float32Array(r.length/2);for(let n=0;n<r.length;n+=2)e[n/2]=r[n],t[n/2]=r[n+1];return{real:e,imag:t}}function dN(r){const e=Math.ceil(r.length/4),t=new Float32Array(e),n=new Float32Array(e);for(let s=0;s<r.length;s+=4)t[Math.floor(s/4)]=r[s],n[Math.floor(s/4)]=r[s+1];return{real:t,imag:n}}function fN(r){const e=Math.floor(r.length/4),t=new Float32Array(e),n=new Float32Array(e);for(let s=2;s<r.length;s+=4)t[Math.floor(s/4)]=r[s],n[Math.floor(s/4)]=r[s+1];return{real:t,imag:n}}function F2(r,e){const t=r[e*2],n=r[e*2+1];return{real:t,imag:n}}function pN(r,e,t,n){r[n*2]=e,r[n*2+1]=t}function mN(r,e){const t=new Float32Array(r/2),n=new Float32Array(r/2);for(let s=0;s<Math.ceil(r/2);s++){const o=(e?2:-2)*Math.PI*(s/r);t[s]=Math.cos(o),n[s]=Math.sin(o)}return{real:t,imag:n}}function gN(r,e,t){const n=(t?2:-2)*Math.PI*(r/e),s=Math.cos(n),o=Math.sin(n);return{real:s,imag:o}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uv="->",L9=/->/g,nI=",",rI="...";function L2(r,e){r=r.replace(/\s/g,"");const t=(r.length-r.replace(L9,"").length)/Uv.length;if(t<1)throw new Error("Equations without an arrow are not supported.");if(t>1)throw new Error(`Equation must contain exactly one arrow ("${Uv}").`);const[n,s]=r.split(Uv);xe(n.indexOf(rI)===-1,()=>`The ellipsis notation ("${rI}") is not supported yet.`);const o=n.split(nI),a=o.length;if(e!==a)throw new Error(`Expected ${a} input tensors, received ${e}`);if(a>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const i=[];for(let c=0;c<s.length;++c){const f=s[c];if(!o.some(p=>p.indexOf(f)!==-1))throw new Error(`Output subscripts contain the label ${f} not present in the input subscripts.`);i.indexOf(f)===-1&&i.push(f)}for(let c=0;c<n.length;++c){const f=n[c];i.indexOf(f)===-1&&f!==nI&&i.push(f)}const l=new Array(o.length);for(let c=0;c<a;++c){if(new Set(o[c].split("")).size!==o[c].length)throw new Error(`Found duplicate axes in input component ${o[c]}. Support for duplicate axes in input is not implemented yet.`);l[c]=[];for(let f=0;f<o[c].length;++f)l[c].push(i.indexOf(o[c][f]))}const u=i.length,h=s.length,d=[];for(let c=h;c<u;++c)d.push(c);return{allDims:i,summedDims:d,idDims:l}}function P2(r,e){let t=new Array(r);t.fill(-1);for(let s=0;s<e.length;++s)t[e[s]]=s;const n=[];for(let s=0;s<r;++s)t[s]===-1&&n.push(s);return t=t.filter(s=>s!==-1),{permutationIndices:t,expandDims:n}}function j2(r,e,t){const n=new Array(r);for(let s=0;s<t.length;++s){const o=t[s].shape;for(let a=0;a<e[s].length;++a)n[e[s][a]]===void 0?n[e[s][a]]=o[a]:xe(n[e[s][a]]===o[a],()=>`Expected dimension ${n[e[s][a]]} at axis ${a} of input shaped ${JSON.stringify(o)}, but got dimension ${o[a]}`)}}function B2(r,e){const t=r,n=[];let s=0;r.length===0&&t.push(-1),s=r.length+1;for(let a=0;a<s;++a)n.push([]);const o=[];for(let a=0;a<t.length;++a){const i=t[a],l=P9(e,i);for(const u of l)o.indexOf(u)===-1&&(n[a].push(u),o.push(u))}return{path:t,steps:n}}function U2(r){return r.every((e,t)=>e===t)}function P9(r,e){const t=[];for(let n=0;n<r.length;++n)(r[n].length===0||r[n].indexOf(e)!==-1||e===-1)&&t.push(n);return t}function z2(r,e,t=0){let n=[];if(typeof e=="number")xe(r.shape[t]%e===0,()=>"Number of splits must evenly divide the axis."),n=new Array(e).fill(r.shape[t]/e);else{const s=e.reduce((a,i)=>(i===-1&&(a+=1),a),0);xe(s<=1,()=>"There should be only one negative value in split array.");const o=e.indexOf(-1);if(o!==-1){const a=e.reduce((i,l)=>l>0?i+l:i);e[o]=r.shape[t]-a}xe(r.shape[t]===e.reduce((a,i)=>a+i),()=>"The sum of sizes must match the size of the axis dimension."),n=e}return n}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yN(r){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${r}`}function vN(r,e){return`indices(${r}, 0) is invalid: ${e} < 0`}function bN(r,e,t){return`indices(${r}, 0) is invalid: ${e} >= ${t}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xN(r,e){return`only one output dimension may be -1, not both ${r} and ${e}`}function wN(r,e){return`size ${r} must be non-negative, not ${e}`}function SN(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function _N(r,e){const t=pt(r),n=pt(e);return`Input to reshape is a SparseTensor with ${t}
  dense values, but the requested shape requires a multiple of ${n}. inputShape=${r} outputShape= ${e}`}function TN(r,e){const t=pt(r),n=pt(e);return`Input to reshape is a tensor with ${t} dense values, but the requested shape has ${n}. inputShape=${r} outputShape=${e}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pb(){return"segment ids must be >= 0"}function kN(){return"segment ids are not increasing"}function IN(r,e){return`Segment id ${r} out of range [0, ${e}), possibly because segmentIds input is not sorted.`}function EN(r,e,t){return`Bad: indices[${r}] == ${e} out of range [0, ${t})`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CN(r,e){let t=!1,n;for(r<=I2?(n=r,t=!0):n=vb(r,Math.floor(Math.sqrt(r)));!t;)n>e||n===r?t=!0:n=vb(r,n+1);return n}function $N(r,e,t){const n=[],s=r.length;for(let o=0;o<s;o++)o!==e?n.push(r[o]):n.push(t);return n}function V2(r,e,t,n){const s=e.shape.length,o=r.shape.length;if(n!==0&&(n<-s||n>s))throw new Error(`Expect batchDims in the range of [-${s}, ${s}], but got ${n}`);if(n<0&&(n+=s),n>o)throw new Error(`batchDims (${n}) must be less than rank(x) (
    ${o}).`);if(t<n)throw new Error(`batchDims (${n}) must be less than or equal to axis (${t}).`);for(let d=0;d<n;++d)if(r.shape[d]!==e.shape[d])throw new Error(`x.shape[${d}]: ${r.shape[d]} should be equal to indices.shape[${d}]: ${e.shape[d]}.`);const a=r.shape[t],i=[];let l=1,u=1,h=1;for(let d=0;d<n;++d)i.push(r.shape[d]),l*=r.shape[d];for(let d=n;d<t;d++)i.push(r.shape[d]),u*=r.shape[d];for(let d=n;d<s;d++)i.push(e.shape[d]);for(let d=t+1;d<o;d++)i.push(r.shape[d]),h*=r.shape[d];return{batchSize:l,sliceSize:h,outerSize:u,dimSize:a,outputShape:i}}var j9=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",segOpComputeOptimalWindowSize:CN,computeOutShape:$N,collectGatherOpShapeInfo:V2});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pc(r){try{return r.map(e=>mu(e))}catch(e){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${e}`)}}function NN(r){return r.map(e=>cu(e))}var B9=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",slice_util:IG,segment_util:j9,fromUint8ToStringArray:Pc,fromStringArrayToUint8:NN,upcastType:Bo,axesAreInnerMostDims:Yw,combineLocations:C$,computeOutAndReduceShapes:ks,expandShapeToKeepDim:es,assertAxesAreInnerMostDims:Fs,getAxesPermutation:qr,getUndoAxesPermutation:Eu,getInnerMostAxes:ts,getBroadcastDims:Jh,getReductionAxes:fs,assertAndGetBroadcastShape:Dn,assertParamsConsistent:k2,computeOutShape:qa,computeDilation2DInfo:qp,computePool2DInfo:Xi,computePool3DInfo:Al,computeConv2DInfo:Ms,computeConv3DInfo:Iu,computeDefaultPad:Vw,tupleValuesAreOne:Dc,eitherStridesOrDilationsAreOne:Ks,convertConv2DDataFormat:Rl,checkPadOnDimRoundingMode:_o,getFusedDyActivation:h2,getFusedBiasGradient:d2,applyActivation:f2,shouldFuse:p2,get RowPartitionType(){return aa},combineRaggedTensorToTensorShapes:aN,getRowPartitionTypesHelper:lN,getRaggedRank:uN,validateDefaultValueShape:cN,PARALLELIZE_THRESHOLD:I2,computeOptimalWindowSize:Q0,getImageCenter:E2,getReshaped:Qp,getPermuted:Jp,getReshapedPermuted:em,getSliceBeginCoords:C2,getSliceSize:$2,prepareAndValidate:Lw,validateUpdateShape:d$,validateInput:wG,calculateShapes:Hp,SELU_SCALEALPHA:J0,SELU_SCALE:e1,ERF_P:N2,ERF_A1:A2,ERF_A2:R2,ERF_A3:D2,ERF_A4:O2,ERF_A5:M2,warn:ci,log:iV,mergeRealAndImagArrays:Cl,splitRealAndImagArrays:hN,complexWithEvenIndex:dN,complexWithOddIndex:fN,getComplexWithIndex:F2,assignToTypedArray:pN,exponents:mN,exponent:gN,decodeEinsumEquation:L2,getEinsumPermutation:P2,checkEinsumDimSizes:j2,getEinsumComputePath:B2,isIdentityPermutation:U2,prepareSplitSize:z2,getSparseFillEmptyRowsIndicesDenseShapeMismatch:yN,getSparseFillEmptyRowsNegativeIndexErrorMessage:vN,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:bN,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:xN,getSparseReshapeNegativeOutputDimErrorMessage:wN,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:SN,getSparseReshapeInputOutputMultipleErrorMessage:_N,getSparseReshapeInputOutputMismatchErrorMessage:TN,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:Pb,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:kN,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:IN,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:EN});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AN={kernelName:By,inputsToSave:["x"],gradFunc:(r,e)=>{const[t]=e;return{x:()=>We(r,Zp(Yt(t,"float32"),-1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const U9={kernelName:Zf,inputsToSave:["x"],gradFunc:(r,e)=>{const[t]=e;return{x:()=>{const n=Ar(Yt(t,"float32")),s=io(sn(An(1),n));return Wr(fn(r,s))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const z9={kernelName:Qf,inputsToSave:["x"],gradFunc:(r,e)=>{const[t]=e;return{x:()=>{const n=io(sn(Ar(Yt(t,"float32")),1));return fn(r,n)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const V9={kernelName:bd,inputsToSave:["a","b"],gradFunc:(r,e)=>{const[t,n]=e,s=Dn(t.shape,n.shape);return{a:()=>{let i=r;const l=fs(t.shape,s);return l.length>0&&(i=rn(i,l)),Qe(i,t.shape)},b:()=>{let i=r;const l=fs(n.shape,s);return l.length>0&&(i=rn(i,l)),Qe(i,n.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G9={kernelName:zx,saveAllInputs:!0,gradFunc:(r,e)=>{const t={};return e.forEach((n,s)=>{t[s]=()=>r.clone()}),t}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const W9={kernelName:Uy,inputsToSave:["x"],gradFunc:(r,e)=>{const[t]=e;return{x:()=>ir(t)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const H9={kernelName:zy,inputsToSave:["x"],gradFunc:(r,e)=>{const[t]=e;return{x:()=>ir(t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const q9={kernelName:Jf,inputsToSave:["x"],gradFunc:(r,e)=>{const[t]=e;return{x:()=>fn(r,io(sn(An(1),Ar(Yt(t,"float32")))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const X9={kernelName:ep,inputsToSave:["x"],gradFunc:(r,e)=>{const[t]=e;return{x:()=>{const n=io(Rt(An(1),Ar(Yt(t,"float32"))));return fn(r,n)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const K9={kernelName:rp,inputsToSave:["a","b"],gradFunc:(r,e)=>{const[t,n]=e,s=Dn(t.shape,n.shape);return{a:()=>{const i=Rt(Ar(t),Ar(n));let l=We(r,fn(n,i));const u=fs(t.shape,s);return u.length>0&&(l=rn(l,u)),Qe(l,t.shape)},b:()=>{const i=Rt(Ar(t),Ar(n));let l=Wr(We(r,fn(t,i)));const u=fs(n.shape,s);return u.length>0&&(l=rn(l,u)),Qe(l,n.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Y9={kernelName:tp,inputsToSave:["x"],gradFunc:(r,e)=>{const[t]=e;return{x:()=>fn(r,Rt(Ar(Yt(t,"float32")),1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Z9={kernelName:np,inputsToSave:["x"],gradFunc:(r,e)=>{const[t]=e;return{x:()=>fn(r,sn(An(1),Ar(Yt(t,"float32"))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q9(r,e,t,n,s,o){const a=ke(r,"dy","avgPool3dGrad"),i=ke(e,"input","avgPool3dGrad");let l=a,u=i,h=!1;i.rank===4&&(h=!0,l=Qe(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]]),u=Qe(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),xe(l.rank===5,()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${l.rank}.`),xe(u.rank===5,()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${u.rank}.`),_o("avgPool3dGrad",s,o);const d={dy:l,input:u},c={filterSize:t,strides:n,pad:s,dimRoundingMode:o},f=Xe.runKernel(Hx,d,c);return h?Qe(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const J9=Ze({avgPool3dGrad_:Q9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eq={kernelName:Gy,inputsToSave:["x"],gradFunc:(r,e,t)=>{const[n]=e,{filterSize:s,strides:o,pad:a,dimRoundingMode:i}=t;return{x:()=>J9(r,n,s,o,a,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tq(r,e,t,n,s){const o=ke(r,"dy","avgPoolGrad"),a=ke(e,"input","avgPoolGrad");xe(a.rank===o.rank,()=>`Rank of input (${a.rank}) does not match rank of dy (${o.rank})`);let i=a,l=o,u=!1;a.rank===3&&(u=!0,i=Qe(a,[1,a.shape[0],a.shape[1],a.shape[2]]),l=Qe(o,[1,o.shape[0],o.shape[1],o.shape[2]])),xe(l.rank===4,()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${l.rank}.`),xe(i.rank===4,()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${i.rank}.`);const h={dy:l,input:i},d={filterSize:t,strides:n,pad:s},c=Xe.runKernel(Wx,h,d);return u?Qe(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const nq=Ze({avgPoolGrad_:tq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rq={kernelName:Vy,inputsToSave:["x"],gradFunc:(r,e,t)=>{const[n]=e,{filterSize:s,strides:o,pad:a}=t;return{x:()=>nq(r,n,s,o,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sq={kernelName:Wy,inputsToSave:["a","b"],gradFunc:(r,e,t)=>{const[n,s]=e,{transposeA:o,transposeB:a}=t;return!o&&!a?{a:()=>lr(r,s,!1,!0),b:()=>lr(n,r,!0,!1)}:!o&&a?{a:()=>lr(r,s,!1,!1),b:()=>lr(r,n,!0,!1)}:o&&!a?{a:()=>lr(s,r,!1,!0),b:()=>lr(n,r,!1,!1)}:{a:()=>lr(s,r,!0,!0),b:()=>lr(r,n,!0,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oq={kernelName:Hy,gradFunc:(r,e,t)=>{const{blockShape:n,crops:s}=t;return{x:()=>s2(r,n,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iq={kernelName:rV,gradFunc:(r,e,t)=>{const n=t,s=n.inputShape,o=n.shape,a=Array.from(o);for(let l=s.length-1;l>=0;l--)if(s[l]===o[l])a[l]=1;else if(s[l]!==1)throw new Error(`broadcastTo(): [${s}] cannot be broadcast to [${o}].`);const i=[];for(let l=0;l<a.length;l++)a[l]>1&&i.push(l);return{x:()=>rn(r,i,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aq={kernelName:sp,gradFunc:r=>({x:()=>r.clone()})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lq={kernelName:op,gradFunc:r=>({x:()=>ir(r)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uq={kernelName:ip,inputsToSave:["x"],gradFunc:(r,e,t)=>{const[n]=e,{clipValueMin:s,clipValueMax:o}=t;return{x:()=>zo(El(Sd(n,s),_d(n,o)),r,ir(r))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cq={kernelName:qy,inputsToSave:["x"],gradFunc:AN.gradFunc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hq={kernelName:Xy,saveAllInputs:!0,gradFunc:(r,e,t)=>{const n=e.map(l=>l.shape),{axis:s}=t,o=Hn(s,e[0].shape)[0],a=n.map(l=>l[o]);return fi(r,a,o).map(l=>()=>l)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dq={kernelName:Ky,inputsToSave:["x","filter"],gradFunc:(r,e,t)=>{const[n,s]=e,{dilations:o,strides:a,pad:i,dataFormat:l}=t;return xe(Dc(o),()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${o}'`),{x:()=>qw(n.shape,r,s,a,i,l),filter:()=>c2(n,r,s.shape,a,i,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fq={kernelName:Yy,inputsToSave:["dy","filter"],gradFunc:(r,e,t)=>{const[n,s]=e,{strides:o,pad:a,dataFormat:i,dimRoundingMode:l}=t;return{dy:()=>Oc(r,s,o,a,i,1,l),filter:()=>c2(r,n,s.shape,o,a,i,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pq(r,e,t,n,s){let o=r;r.rank===4&&(o=Qe(r,[1,r.shape[0],r.shape[1],r.shape[2],r.shape[3]]));let a=e;a.rank===4&&(a=Qe(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]])),xe(o.rank===5,()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${o.shape}.`),xe(a.rank===5,()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${a.shape}.`),xe(t.length===5,()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${t}.`),xe(o.shape[4]===t[3],()=>`Error in conv3dDerFilter: depth of input ${o.shape[4]}) must match input depth in filter (${t[3]}.`),xe(a.shape[4]===t[4],()=>`Error in conv3dDerFilter: depth of dy (${a.shape[4]}) must match output depth for filter (${t[4]}).`);const i={x:o,dy:a},l={strides:n,pad:s,filterShape:t};return Xe.runKernel(Yx,i,l)}const mq=Ze({conv3DBackpropFilter_:pq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gq={kernelName:Zy,inputsToSave:["x","filter"],gradFunc:(r,e,t)=>{const{dilations:n,strides:s,pad:o}=t;xe(Dc(n),()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${n}'`);const[a,i]=e;return{x:()=>k$(a.shape,r,i,s,o),filter:()=>mq(a,r,i.shape,s,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yq={kernelName:ap,inputsToSave:["x"],gradFunc:(r,e)=>{const[t]=e;return{x:()=>We(Wr(X$(Yt(t,"float32"))),r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vq={kernelName:lp,inputsToSave:["x"],gradFunc:(r,e)=>{const[t]=e;return{x:()=>We(K$(Yt(t,"float32")),r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bq={kernelName:Qy,inputsToSave:["x"],gradFunc:(r,e,t)=>{const[n]=e,{axis:s,exclusive:o,reverse:a}=t;return{x:()=>{const i=qr([s],n.rank);let l=E$(r,s,o,!a);return i!=null&&(l=nr(l,i)),l}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xq={kernelName:Jy,inputsToSave:["x","filter"],gradFunc:(r,e,t)=>{const{dilations:n,strides:s,pad:o,dimRoundingMode:a}=t,i=n==null?[1,1]:n;xe(Dc(i),()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${i}'`);const[l,u]=e;return xe(l.rank===4,()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${l.rank}.`),xe(u.rank===4,()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${u.rank}.`),xe(l.shape[3]===u.shape[2],()=>`Error in gradient of depthwiseConv2d: number of input channels (${l.shape[3]}) must match the inChannels dimension in filter ${u.shape[2]}.`),xe(Ks(s,i),()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${s} and dilations '${i}'.`),_o("depthwiseConv2d",o,a),{x:()=>T7(l.shape,r,u,s,o,i,a),filter:()=>S7(l,r,u.shape,s,o,i,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wq={kernelName:e0,inputsToSave:["x","filter"],gradFunc:(r,e,t)=>{const[n,s]=e,o={x:n,filter:s,dy:r},a={x:n,filter:s,dy:r};return{x:()=>Xe.runKernel(bb,o,t),filter:()=>Xe.runKernel(xb,a,t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sq={kernelName:cp,outputsToSave:[!0],gradFunc:(r,e)=>{const[t]=e,n={dy:r,y:t};return{x:()=>Xe.runKernel(rw,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _q={kernelName:hp,inputsToSave:["x"],gradFunc:(r,e)=>{const[t]=e,n=We(Gi(Wr(Ar(t))),2/Math.sqrt(Math.PI));return{x:()=>We(r,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tq={kernelName:dp,outputsToSave:[!0],gradFunc:(r,e)=>{const[t]=e;return{x:()=>We(r,t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kq={kernelName:n0,inputsToSave:["input"],gradFunc:(r,e)=>{const[t]=e;return{input:()=>Qe(r,t.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Iq={kernelName:fp,inputsToSave:["x"],gradFunc:(r,e)=>{const[t]=e;return{x:()=>We(r,Gi(t))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Eq={kernelName:pp,gradFunc:r=>({x:()=>ir(r)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cq={kernelName:mp,inputsToSave:["a","b"],gradFunc:(r,e)=>{const[t,n]=e,s=Dn(t.shape,n.shape);return{a:()=>{const i=fn(r,Yt(n,"float32")),l=fs(t.shape,s);return l.length>0?Qe(rn(i,l),t.shape):i},b:()=>{let i=We(r,Yt(t,"float32"));const l=fs(n.shape,s);l.length>0&&(i=Qe(rn(i,l),n.shape));const u=Ar(n);return Wr(fn(i,Yt(u,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $q={kernelName:r0,inputsToSave:["x","mean","variance","scale"],gradFunc:(r,e,t)=>{const{varianceEpsilon:n}=t,[s,o,a,i]=e,l=i==null?An(1):i,u=fs(o.shape,s.shape),h=[];if(o.rank===1){for(let w=0;w<s.shape.length-1;++w)h.push(s.shape[w]);h.push(1)}const d=sn(s,o),c=We(r,l),f=W$(Rt(a,An(n))),p=We(We(We(f,f),f),An(-.5));return{x:()=>o.rank===1?Qe(We(We(r,da(Qe(f,[1,1,1,o.shape[0]]),h)),l),s.shape):Qe(We(We(r,f),l),s.shape),mean:()=>{let w=We(We(f,An(-1)),c);return o.rank===1&&(w=rn(w,u)),Qe(w,o.shape)},variance:()=>{let w=We(We(p,d),c);return o.rank===1&&(w=rn(w,u)),Qe(w,o.shape)},scale:()=>{const w=We(d,f);let _=We(r,w);return o.rank===1&&(_=rn(_,u)),Qe(_,o.shape)},offset:()=>{let w=r;return o.rank===1&&(w=rn(w,u)),Qe(w,o.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nq={kernelName:s0,inputsToSave:["x","indices"],gradFunc:(r,e,t)=>{const[n,s]=e,{axis:o}=t,a=Hn(o,n.shape)[0];return{x:()=>{const l=n.shape,u=s.size,h=l.slice(0,a),d=h.length,c=l.slice(o,l.length).slice(1),f=c.length,p=sI(0,d),m=sI(d+1,d+1+f),g=oI([h,[u],c]),y=Qe(r,g),v=Qe(s,[u]),b=oI([[d],p,m]),w=nr(y,b);let _=tN(w,v,n.shape[a]);const I=Eu(b);return _=nr(_,I),_},indices:()=>s}}};function sI(r,e){const t=[];for(let n=r;n<e;++n)t.push(n);return t}function oI(r){const e=[];for(let t=0;t<r.length;++t)for(let n=0;n<r[t].length;++n)e.push(r[t][n]);return e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Aq={kernelName:gp,inputsToSave:["a","b"],gradFunc:(r,e)=>{const[t,n]=e;return{a:()=>ir(t),b:()=>ir(n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rq={kernelName:yp,gradFunc:r=>({x:()=>Yt(r,"float32")})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dq={kernelName:vp,gradFunc:r=>({x:()=>ir(r)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oq={kernelName:bp,gradFunc:r=>({x:()=>ir(r)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mq={kernelName:xp,gradFunc:r=>({x:()=>ir(r)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fq={kernelName:i0,inputsToSave:["x"],gradFunc:(r,e,t)=>{const[n]=e,{alpha:s}=t,o=Ki(n,0);return{x:()=>zo(o,r,We(r,s))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lq={kernelName:Sp,inputsToSave:["x"],gradFunc:(r,e)=>{const[t]=e;return{x:()=>fn(r,Rt(t,1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pq={kernelName:wp,inputsToSave:["x"],gradFunc:(r,e)=>{const[t]=e;return{x:()=>fn(r,Yt(t,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jq={kernelName:sV,inputsToSave:[],outputsToSave:[!0],gradFunc:(r,e,t)=>{const[n]=e,{axis:s}=t;return{logits:()=>{const a=Gi(n);return sn(r,We(rn(r,s,!0),a))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bq(r,e,t,n=5,s=1,o=1,a=.5){const i={x:r,y:e,dy:t},l={depthRadius:n,bias:s,alpha:o,beta:a};return Xe.runKernel(uw,i,l)}const Uq=Ze({localResponseNormalizationBackprop_:Bq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zq={kernelName:d0,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(r,e,t)=>{const[n,s]=e,{depthRadius:o,bias:a,alpha:i,beta:l}=t;return{x:()=>Uq(n,s,r,o,a,i,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RN(r,e,t,n){return e.rank<t.rank&&(e=Qe(e,es(e.shape,n))),r.rank<t.rank&&(r=Qe(r,es(r.shape,n))),{x:()=>We(r,Yt(Za(t,e),r.dtype))}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iI={kernelName:f0,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(r,e,t)=>{const n=t,{reductionIndices:s}=n,o=e[0],a=e[1],i=Hn(s,o.shape),l=RN(r,a,o,i);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vq={kernelName:_p,inputsToSave:["a","b"],gradFunc:(r,e)=>{const[t,n]=e;return{a:()=>We(r,Yt(Sd(t,n),"float32")),b:()=>We(r,Yt(A$(t,n),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gq(r,e,t,n,s,o,a){const i=ke(r,"dy","maxPool3dGrad"),l=ke(e,"input","maxPool3dGrad"),u=ke(t,"output","maxPool3dGrad");let h=i,d=l,c=u,f=!1;l.rank===4&&(f=!0,h=Qe(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]]),d=Qe(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]]),c=Qe(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]])),xe(h.rank===5,()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${h.rank}.`),xe(d.rank===5,()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${d.rank}.`),xe(c.rank===5,()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${c.rank}.`),_o("maxPool3dGrad",o,a);const p={dy:h,input:d,output:c},m={filterSize:n,strides:s,pad:o,dimRoundingMode:a},g=Xe.runKernel(hw,p,m);return f?Qe(g,[g.shape[1],g.shape[2],g.shape[3],g.shape[4]]):g}const Wq=Ze({maxPool3dGrad_:Gq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hq={kernelName:m0,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(r,e,t)=>{const[n,s]=e,{filterSize:o,strides:a,pad:i,dimRoundingMode:l}=t;return{x:()=>Wq(r,n,s,o,a,i,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qq(r,e,t,n,s,o,a){const i=ke(r,"dy","maxPoolGrad"),l=ke(e,"input","maxPoolGrad"),u=ke(t,"output","maxPoolGrad");xe(l.rank===i.rank,()=>`Rank of input (${l.rank}) does not match rank of dy (${i.rank})`),xe(i.rank===4,()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${i.rank}.`),xe(l.rank===4,()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${l.rank}.`),_o("maxPoolGrad",o,a);const h={dy:i,input:l,output:u},d={filterSize:n,strides:s,pad:o,dimRoundingMode:a};return Xe.runKernel(cw,h,d)}const Xq=Ze({maxPoolGrad_:qq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kq={kernelName:p0,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(r,e,t)=>{const[n,s]=e,{filterSize:o,strides:a,pad:i}=t;return{x:()=>Xq(r,n,s,o,a,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yq={kernelName:g0,inputsToSave:["x"],gradFunc:(r,e,t)=>{const[n]=e,{axis:s}=t,o=Hn(s,n.shape),i=ks(n.shape,o)[1],l=pt(i);return{x:()=>{const h=n.shape.slice();o.forEach(f=>{h[f]=1});const d=Qe(r,h);return fn(We(d,$u(n.shape,"float32")),l)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zq={kernelName:y0,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(r,e,t)=>{const n=t,{axis:s}=n,[o,a]=e,i=Hn(s,o.shape),l=RN(r,a,o,i);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qq={kernelName:Tp,inputsToSave:["a","b"],gradFunc:(r,e)=>{const[t,n]=e;return{a:()=>We(r,Yt(_d(t,n),"float32")),b:()=>We(r,Yt(Ki(t,n),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jq={kernelName:v0,inputsToSave:["x"],gradFunc:(r,e,t)=>{const n=e[0],{paddings:s}=t,o=s.map(a=>a[0]);return{x:()=>_r(r,o,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eX={kernelName:kp,inputsToSave:["a","b"],gradFunc:(r,e)=>{const[t,n]=e,s=Dn(t.shape,n.shape);return{a:()=>{const i=fs(t.shape,s);return i.length>0?Qe(rn(r,i),t.shape):r},b:()=>{const i=We(r,Wr(X0(fn(t,n)))),l=fs(n.shape,s);return l.length>0?Qe(rn(i,l),n.shape):i}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tX={kernelName:Ip,inputsToSave:["a","b"],gradFunc:(r,e)=>{const[t,n]=e,s=Dn(t.shape,n.shape);return{a:()=>{const i=We(r,Yt(n,"float32")),l=fs(t.shape,s);return l.length>0?Qe(rn(i,l),t.shape):i},b:()=>{const i=We(r,Yt(t,"float32")),l=fs(n.shape,s);return l.length>0?Qe(rn(i,l),n.shape):i}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nX={kernelName:b0,gradFunc:r=>({x:()=>Wr(r)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rX={kernelName:S0,inputsToSave:["indices"],gradFunc:(r,e)=>{const t=e[0];return{indices:()=>Ss(t.shape,"float32")}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sX={kernelName:w0,gradFunc:r=>({x:()=>ir(r)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oX={kernelName:_0,saveAllInputs:!0,gradFunc:(r,e,t)=>{const{axis:n}=t;return td(r,n).map(o=>()=>o)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aI={kernelName:T0,inputsToSave:["x"],gradFunc:(r,e,t)=>{const n=e[0],{paddings:s}=t,o=s.map(a=>a[0]);return{x:()=>_r(r,o,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iX={kernelName:Ep,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(r,e)=>{const[t,n,s]=e,o=t,a=n,i=Dn(o.shape,a.shape);return{a:()=>{const h=Yt(a,"float32");let d=We(r,We(h,ed(o,sn(h,An(1)))));const c=fs(o.shape,i);return c.length>0&&(d=rn(d,c)),Qe(d,o.shape)},b:()=>{const h=Ki(o,0),d=zo(h,Wi(o),ir(o));let c=We(r,We(s,d));const f=fs(a.shape,i);return f.length>0&&(c=rn(c,f)),Qe(c,a.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aX={kernelName:k0,inputsToSave:["x","alpha"],gradFunc:(r,e)=>{const[t,n]=e,s=Ki(t,0);return{x:()=>zo(s,r,We(r,n)),alpha:()=>{let o=zo(s,ir(r),We(r,t));const a=fs(n.shape,r.shape);return a.length>0&&(o=rn(o,a)),Qe(o,n.shape)}}}};/**
 * @license
 * Copyright 2022 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lX(r,e,t){const n=r.shape.slice();n[t]=1;const s=Qe(e,n),o=Mb(r,t,!0,!1),a=Mb(r,t,!0,!0),i=We(o,a);return We(s,i)}function uX(r,e,t){const n=r.shape.length,s=n-t.length,o=qr(t,n);let a=r;o!=null&&(a=nr(r,o));const i=a.shape.slice(),u=i.splice(n-t.length,t.length).reduce((c,f)=>c*f,1);i.push(u);const h=a.reshape(i);let d=lX(h,e,s);if(d=d.reshape(a.shape),o!=null){const c=Eu(o);d=nr(d,c)}return d}const cX={kernelName:I0,inputsToSave:["x"],gradFunc:(r,e,t)=>{const[n]=e,{axis:s}=t;let o=[];return s==null?o=n.shape.map((a,i)=>i):typeof s=="number"?o=[s]:o=s,{x:()=>uX(n,r,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hX={kernelName:up,inputsToSave:["a","b"],gradFunc:(r,e)=>{const[t,n]=e,s=Dn(t.shape,n.shape);return{a:()=>{const i=fn(r,Yt(n,"float32")),l=fs(t.shape,s);return l.length>0?Qe(rn(i,l),t.shape):i},b:()=>{let i=We(r,Yt(t,"float32"));const l=fs(n.shape,s);l.length>0&&(i=Qe(rn(i,l),n.shape));const u=Ar(n);return Wr(fn(i,Yt(u,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dX={kernelName:Cp,inputsToSave:["x"],gradFunc:(r,e)=>{const[t]=e;return{x:()=>fn(r,Wr(Ar(t)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fX={kernelName:Np,inputsToSave:["x"],gradFunc:(r,e)=>{const[t]=e,n=We(_d(t,6),Zp(t));return{x:()=>We(r,Yt(n,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pX={kernelName:$p,inputsToSave:["x"],gradFunc:(r,e)=>{const[t]=e;return{x:()=>We(r,Yt(Zp(t),"float32"))}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mX={kernelName:E0,inputsToSave:["x"],gradFunc:(r,e)=>{const[t]=e;return{x:()=>Qe(r,t.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gX={kernelName:$0,inputsToSave:["images"],gradFunc:(r,e,t)=>{const[n]=e,s={dy:r,images:n};return{images:()=>Xe.runKernel(vw,s,t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yX={kernelName:C0,inputsToSave:["images"],gradFunc:(r,e,t)=>{const[n]=e,s={dy:r,images:n};return{images:()=>Xe.runKernel(yw,s,t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vX={kernelName:N0,gradFunc:(r,e,t)=>{const{dims:n}=t,s=Hn(n,r.shape);return{x:()=>Fc(r,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bX={kernelName:Ap,gradFunc:r=>({x:()=>ir(r)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xX={kernelName:Rp,inputsToSave:["x"],gradFunc:(r,e)=>{const[t]=e;return{x:()=>Wr(fn(r,We(ed(t,1.5),2)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wX={kernelName:A0,inputsToSave:["condition"],gradFunc:(r,e)=>{const[t]=e;return{condition:()=>Yt(ir(t),"float32"),t:()=>We(r,Yt(t,r.dtype)),e:()=>We(r,Yt(e2(t),r.dtype))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SX={kernelName:Dp,inputsToSave:["x"],gradFunc:(r,e)=>{const[t]=e;return{x:()=>{const n=Ki(t,An(0)),s=An(J0),o=An(e1),a=We(r,o),i=We(We(r,s),Gi(Yt(t,"float32")));return zo(n,a,i)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _X={kernelName:Lp,outputsToSave:[!0],gradFunc:(r,e)=>{const[t]=e;return{x:()=>We(r,We(t,sn(An(1),t)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TX={kernelName:Fp,gradFunc:r=>({x:()=>ir(r)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kX={kernelName:Op,inputsToSave:["x"],gradFunc:(r,e)=>{const[t]=e;return{x:()=>We(Xw(Yt(t,"float32")),r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IX={kernelName:Mp,inputsToSave:["x"],gradFunc:(r,e)=>{const[t]=e;return{x:()=>We(I$(Yt(t,"float32")),r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EX={kernelName:R0,inputsToSave:["x"],gradFunc:(r,e,t)=>{const[n]=e,{begin:s,size:o}=t,a=n.shape,[i,l]=G0(n,s,o),u=[];for(let h=0;h<r.rank;h++)u.push([i[h],a[h]-i[h]-l[h]]);return{x:()=>r2(r,u)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CX={kernelName:F0,outputsToSave:[!0],gradFunc:(r,e,t)=>{const[n]=e,{dim:s}=t,o=!0,a=We(r,n);return{logits:()=>sn(a,We(rn(a,[s],o),n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $X={kernelName:Pp,inputsToSave:["x"],gradFunc:(r,e)=>{const[t]=e;return{x:()=>We(r,wd(t))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lI={kernelName:O0,gradFunc:(r,e,t)=>{const{blockShape:n,paddings:s}=t;return{x:()=>Hw(r,n,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uI={kernelName:M0,gradFunc:(r,e,t)=>{const{axis:n}=t;return{x:()=>Hs(r,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NX={kernelName:jp,inputsToSave:["x"],gradFunc:(r,e)=>{const[t]=e;return{x:()=>fn(r,We(io(Yt(t,"float32")),2))}}};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AX={kernelName:_w,inputsToSave:["x"],gradFunc:(r,e)=>{const[t]=e;return{x:()=>We(r,We(Yt(t,"float32"),2))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RX={kernelName:Bp,inputsToSave:["a","b"],gradFunc:(r,e)=>{const[t,n]=e,s=An(2);return{a:()=>We(r,We(s,sn(t,n))),b:()=>We(r,We(s,sn(n,t)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DX={kernelName:Wp,gradFunc:r=>({x:()=>ir(r)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OX={kernelName:Up,inputsToSave:["a","b"],gradFunc:(r,e)=>{const[t,n]=e,s=Dn(t.shape,n.shape);return{a:()=>{let i=r;const l=fs(t.shape,s);return l.length>0&&(i=rn(i,l)),Qe(i,t.shape)},b:()=>{let i=r;const l=fs(n.shape,s);return l.length>0&&(i=rn(i,l)),Qe(Wr(i),n.shape)}}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MX={kernelName:D0,inputsToSave:["x"],gradFunc:(r,e,t)=>{const[n]=e,s=n.shape.slice(),{axis:o}=t;Hn(o,n.shape).forEach(u=>{s[u]=1});const i=Qe(r,s),l=We(i,$u(n.shape,"float32"));return{x:()=>l}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FX={kernelName:zp,inputsToSave:["x"],gradFunc:(r,e)=>{const[t]=e;return{x:()=>fn(r,Ar(Xw(t)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LX={kernelName:Vp,outputsToSave:[!0],gradFunc:(r,e)=>{const[t]=e;return{x:()=>We(sn(An(1),Ar(t)),r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PX={kernelName:Gp,inputsToSave:["x"],gradFunc:(r,e,t)=>{const[n]=e,{reps:s}=t;return{x:()=>{let a=ir(n);if(n.rank===1)for(let i=0;i<s[0];++i)a=Rt(a,_r(r,[i*n.shape[0]],[n.shape[0]]));else if(n.rank===2)for(let i=0;i<s[0];++i)for(let l=0;l<s[1];++l)a=Rt(a,_r(r,[i*n.shape[0],l*n.shape[1]],[n.shape[0],n.shape[1]]));else if(n.rank===3)for(let i=0;i<s[0];++i)for(let l=0;l<s[1];++l)for(let u=0;u<s[2];++u)a=Rt(a,_r(r,[i*n.shape[0],l*n.shape[1],u*n.shape[2]],[n.shape[0],n.shape[1],n.shape[2]]));else if(n.rank===4)for(let i=0;i<s[0];++i)for(let l=0;l<s[1];++l)for(let u=0;u<s[2];++u)for(let h=0;h<s[3];++h)a=Rt(a,_r(r,[i*n.shape[0],l*n.shape[1],u*n.shape[2],h*n.shape[3]],[n.shape[0],n.shape[1],n.shape[2],n.shape[3]]));else throw new Error(`Gradient for tile operation is not implemented for rank-${n.rank} tensors yet.`);return a}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jX={kernelName:Bh,gradFunc:(r,e,t)=>{const n=t,{perm:s}=n,o=Eu(s);return{x:()=>nr(r,o)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BX={kernelName:L0,gradFunc:(r,e,t)=>{const n=t,{axis:s}=n;return{value:()=>Lc(r,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UX={kernelName:P0,inputsToSave:["segmentIds"],gradFunc:(r,e)=>{const[t]=e;return{x:()=>zX(r,t)}}};function zX(r,e){const t=Cu(e,ir(e)),n=Zw(r,t);let s=Sd(e,An(0,"int32"));const o=n.rank-s.rank;for(let i=0;i<o;++i)s=Oi(s,i+1);s=El(s,$u(n.shape,"bool"));const a=ir(n);return zo(s,n,a)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VX={kernelName:j0,gradFunc:r=>({x:()=>ir(r)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GX=[AN,U9,z9,V9,G9,W9,H9,q9,X9,K9,Y9,Z9,eq,rq,sq,oq,iq,aq,lq,uq,cq,hq,fq,dq,gq,yq,vq,bq,xq,wq,hX,Sq,_q,Tq,kq,Iq,Cq,Eq,$q,Nq,Aq,Rq,Dq,Oq,Mq,Fq,Lq,Pq,jq,zq,iI,iI,Vq,Hq,Kq,Yq,Zq,Qq,Jq,eX,tX,nX,rX,sX,oX,aI,aI,iX,aX,cX,dX,fX,pX,mX,gX,yX,vX,bX,xX,wX,SX,_X,TX,kX,IX,EX,CX,$X,lI,lI,uI,uI,NX,RX,AX,DX,OX,MX,FX,LX,PX,jX,BX,UX,VX];for(const r of GX)aV(r);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.abs=function(){return this.throwIfDisposed(),bs(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.acos=function(){return this.throwIfDisposed(),DG(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.acosh=function(){return this.throwIfDisposed(),MG(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.add=function(r){return this.throwIfDisposed(),Rt(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.all=function(r,e){return this.throwIfDisposed(),S$(this,r,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.any=function(r,e){return this.throwIfDisposed(),Db(this,r,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.argMax=function(r){return this.throwIfDisposed(),If(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.argMin=function(r){return this.throwIfDisposed(),BG(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.asScalar=function(){return this.throwIfDisposed(),xe(this.size===1,()=>"The array must have only 1 element."),Qe(this,[])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.asType=function(r){return this.throwIfDisposed(),Yt(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.as1D=function(){return this.throwIfDisposed(),Qe(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.as2D=function(r,e){return this.throwIfDisposed(),Qe(this,[r,e])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.as3D=function(r,e,t){return this.throwIfDisposed(),Qe(this,[r,e,t])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.as4D=function(r,e,t,n){return this.throwIfDisposed(),Qe(this,[r,e,t,n])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.as5D=function(r,e,t,n,s){return this.throwIfDisposed(),Qe(this,[r,e,t,n,s])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.asin=function(){return this.throwIfDisposed(),zG(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.asinh=function(){return this.throwIfDisposed(),GG(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.atan=function(){return this.throwIfDisposed(),HG(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.atan2=function(r){return this.throwIfDisposed(),XG(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.atanh=function(){return this.throwIfDisposed(),YG(this)};ft().prototype.avgPool=function(r,e,t,n){return this.throwIfDisposed(),Gw(this,r,e,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.batchToSpaceND=function(r,e){return this.throwIfDisposed(),Hw(this,r,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.batchNorm=function(r,e,t,n,s){return this.throwIfDisposed(),W0(this,r,e,t,n,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.broadcastTo=function(r){return this.throwIfDisposed(),Sf(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.cast=function(r){return this.throwIfDisposed(),Yt(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.ceil=function(){return this.throwIfDisposed(),SW(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.clipByValue=function(r,e){return this.throwIfDisposed(),pi(this,r,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.concat=function(r,e){return this.throwIfDisposed(),r instanceof os&&(r=[r]),Hs([this,...r],e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.conv1d=function(r,e,t,n,s,o){return this.throwIfDisposed(),_$(this,r,e,t,n,s,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.conv2dTranspose=function(r,e,t,n,s){return this.throwIfDisposed(),T$(this,r,e,t,n,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.conv2d=function(r,e,t,n,s,o){return this.throwIfDisposed(),Oc(this,r,e,t,n,s,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.cos=function(){return this.throwIfDisposed(),Xw(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.cosh=function(){return this.throwIfDisposed(),I$(this)};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.cumprod=function(r,e,t){return this.throwIfDisposed(),Mb(this,r,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.cumsum=function(r,e,t){return this.throwIfDisposed(),E$(this,r,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.depthToSpace=function(r,e){return this.throwIfDisposed(),HW(this,r,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.depthwiseConv2d=function(r,e,t,n,s,o){return this.throwIfDisposed(),Kw(this,r,e,t,n,s,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.dilation2d=function(r,e,t,n,s){return this.throwIfDisposed(),KW(this,r,e,t,n,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.divNoNan=function(r){return this.throwIfDisposed(),e8(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.div=function(r){return this.throwIfDisposed(),fn(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.dot=function(r){return this.throwIfDisposed(),n8(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.elu=function(){return this.throwIfDisposed(),H0(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.equal=function(r){return this.throwIfDisposed(),Za(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.erf=function(){return this.throwIfDisposed(),o8(this)};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.euclideanNorm=function(r,e){return this.throwIfDisposed(),p8(this,r,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.exp=function(){return this.throwIfDisposed(),Gi(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.expandDims=function(r){return this.throwIfDisposed(),Oi(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.expm1=function(){return this.throwIfDisposed(),v8(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.fft=function(){return this.throwIfDisposed(),Z$(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.flatten=function(){return this.throwIfDisposed(),Qe(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.floor=function(){return this.throwIfDisposed(),X0(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.floorDiv=function(r){return this.throwIfDisposed(),w$(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.gather=function(r,e){return this.throwIfDisposed(),Zw(this,r,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.greaterEqual=function(r){return this.throwIfDisposed(),Sd(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.greater=function(r){return this.throwIfDisposed(),Ki(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.ifft=function(){return this.throwIfDisposed(),Lb(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.irfft=function(){return this.throwIfDisposed(),KH(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.isFinite=function(){return this.throwIfDisposed(),I8(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.isInf=function(){return this.throwIfDisposed(),C8(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.isNaN=function(){return this.throwIfDisposed(),N8(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.leakyRelu=function(r){return this.throwIfDisposed(),Qw(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.lessEqual=function(r){return this.throwIfDisposed(),_d(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.less=function(r){return this.throwIfDisposed(),A$(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.localResponseNormalization=function(r,e,t,n){return this.throwIfDisposed(),M8(this,r,e,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.logSigmoid=function(){return this.throwIfDisposed(),U8(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.logSoftmax=function(r){return this.throwIfDisposed(),R$(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.logSumExp=function(r,e){return this.throwIfDisposed(),D$(this,r,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.log=function(){return this.throwIfDisposed(),Wi(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.log1p=function(){return this.throwIfDisposed(),Jw(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.logicalAnd=function(r){return this.throwIfDisposed(),El(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.logicalNot=function(){return this.throwIfDisposed(),e2(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.logicalOr=function(r){return this.throwIfDisposed(),O$(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.logicalXor=function(r){return this.throwIfDisposed(),K8(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.matMul=function(r,e,t){return this.throwIfDisposed(),lr(this,r,e,t)};ft().prototype.maxPool=function(r,e,t,n){return this.throwIfDisposed(),t2(this,r,e,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.max=function(r,e){return this.throwIfDisposed(),Ha(this,r,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.maximum=function(r){return this.throwIfDisposed(),Cu(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.mean=function(r,e){return this.throwIfDisposed(),Qr(this,r,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.min=function(r,e){return this.throwIfDisposed(),Fb(this,r,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.minimum=function(r){return this.throwIfDisposed(),K0(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.mirrorPad=function(r,e){return this.throwIfDisposed(),rH(this,r,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.mod=function(r){return this.throwIfDisposed(),oH(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.mul=function(r){return this.throwIfDisposed(),We(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.neg=function(){return this.throwIfDisposed(),Wr(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.norm=function(r,e,t){return this.throwIfDisposed(),q0(this,r,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.notEqual=function(r){return this.throwIfDisposed(),Ef(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.oneHot=function(r,e=1,t=0){return this.throwIfDisposed(),c$(this,r,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.onesLike=function(){return this.throwIfDisposed(),Hi(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.pad=function(r,e){return this.throwIfDisposed(),r2(this,r,e)};ft().prototype.pool=function(r,e,t,n,s,o){return this.throwIfDisposed(),pH(this,r,e,t,n,s,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.pow=function(r){return this.throwIfDisposed(),ed(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.prelu=function(r){return this.throwIfDisposed(),o2(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.prod=function(r,e){return this.throwIfDisposed(),yH(this,r,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.reciprocal=function(){return this.throwIfDisposed(),$H(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.relu=function(){return this.throwIfDisposed(),Dl(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.relu6=function(){return this.throwIfDisposed(),V$(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.reshapeAs=function(r){return this.throwIfDisposed(),Qe(this,r.shape)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.reshape=function(r){return this.throwIfDisposed(),Qe(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.resizeBilinear=function(r,e,t){return this.throwIfDisposed(),sN(this,r,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.resizeNearestNeighbor=function(r,e,t){return this.throwIfDisposed(),oN(this,r,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.reverse=function(r){return this.throwIfDisposed(),Fc(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.rfft=function(){return this.throwIfDisposed(),Q$(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.round=function(){return this.throwIfDisposed(),G$(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.rsqrt=function(){return this.throwIfDisposed(),W$(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.selu=function(){return this.throwIfDisposed(),H$(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.separableConv2d=function(r,e,t,n,s,o){return this.throwIfDisposed(),q$(this,r,e,t,n,s,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.sigmoid=function(){return this.throwIfDisposed(),wd(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.sign=function(){return this.throwIfDisposed(),PH(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.sin=function(){return this.throwIfDisposed(),X$(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.sinh=function(){return this.throwIfDisposed(),K$(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.slice=function(r,e){return this.throwIfDisposed(),_r(this,r,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.softmax=function(r){return this.throwIfDisposed(),u2(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.softplus=function(){return this.throwIfDisposed(),Kp(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.spaceToBatchND=function(r,e){return this.throwIfDisposed(),s2(this,r,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.split=function(r,e){return this.throwIfDisposed(),fi(this,r,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.sqrt=function(){return this.throwIfDisposed(),io(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.square=function(){return this.throwIfDisposed(),Ar(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.squaredDifference=function(r){return this.throwIfDisposed(),J$(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.squeeze=function(r){return this.throwIfDisposed(),Yp(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.stack=function(r,e){this.throwIfDisposed();const t=r instanceof os?[this,r]:[this,...r];return Lc(t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.step=function(r){return this.throwIfDisposed(),Zp(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.stridedSlice=function(r,e,t,n,s,o,a,i){return this.throwIfDisposed(),r7(this,r,e,t,n,s,o,a,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.sub=function(r){return this.throwIfDisposed(),sn(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.sum=function(r,e){return this.throwIfDisposed(),rn(this,r,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.tan=function(){return this.throwIfDisposed(),o7(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.tanh=function(){return this.throwIfDisposed(),Ww(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.tile=function(r){return this.throwIfDisposed(),da(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.toBool=function(){return this.throwIfDisposed(),Yt(this,"bool")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.toFloat=function(){return this.throwIfDisposed(),Yt(this,"float32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.toInt=function(){return this.throwIfDisposed(),Yt(this,"int32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.topk=function(r,e){return this.throwIfDisposed(),a7(this,r,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.transpose=function(r){return this.throwIfDisposed(),nr(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.unique=function(r){return this.throwIfDisposed(),c7(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.unsortedSegmentSum=function(r,e){return this.throwIfDisposed(),tN(this,r,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.unstack=function(r){return this.throwIfDisposed(),td(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.where=function(r,e){return this.throwIfDisposed(),zo(r,this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ft().prototype.zerosLike=function(){return this.throwIfDisposed(),ir(this)};/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class La extends Error{constructor(e){super(e),Object.setPrototypeOf(this,La.prototype)}}class ji extends Error{constructor(e){super(e),Object.setPrototypeOf(this,ji.prototype)}}class Ye extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Ye.prototype)}}class On extends Error{constructor(e){super(e),Object.setPrototypeOf(this,On.prototype)}}class G2 extends Error{constructor(e){super(e),Object.setPrototypeOf(this,G2.prototype)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class DN{constructor(e){this.maxEntries=e||100,this.cache=new Map}get(e){let t;return this.cache.has(e)&&(t=this.cache.get(e),this.cache.delete(e),this.cache.set(e,t)),t}put(e,t){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxEntries){const n=this.cache.keys().next().value;this.cache.delete(n)}this.cache.set(e,t)}getMaxEntries(){return this.maxEntries}setMaxEntries(e){if(e<0)throw new Error(`The maxEntries of LRU caches must be at least 0, but got ${e}.`);if(this.maxEntries>e)for(let t=0;t<this.maxEntries-e;t++){const n=this.cache.keys().next().value;this.cache.delete(n)}this.maxEntries=e}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function jc(r,e){if(Array.isArray(r)){let t=[];for(let n=0;n<e;n++)t=t.concat(r);return t}else{const t=new Array(e);return t.fill(r),t}}function Pa(r,e){if(!r)throw new G2(e)}function cI(r,e){let t=0;for(const n of r)n===e&&t++;return t}function vo(r){return r.length===1?r[0]:r}function Mr(r){return Array.isArray(r)?r:[r]}function xl(r){const t=r.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return t[0]!=="_"?t:"private"+t}function mc(r){return r.length<=1||r.indexOf("_")===-1?r:r.replace(/[_]+(\w|$)/g,(e,t)=>t.toUpperCase())}let $i={};function W2(r){if(r==null)return null;const e={};return e.className=r.getClassName(),e.config=r.getConfig(),e}function jb(r){if(!(r==null||typeof r!="object"))if(Array.isArray(r))r.forEach(e=>jb(e));else{const e=Object.keys(r);for(const t of e){const n=r[t];n!=null&&typeof n=="object"&&(!Array.isArray(n)&&n.type==="ndarray"&&typeof n.value=="number"?r[t]=n.value:jb(n))}}}function tm(r,e={},t={},n="object",s=!1){if(typeof r=="string"){const o=r;let a;if(o in t)a=t[o];else if(o in $i)a=$i[o];else if(a=e[o],a==null)throw new Ye(`Unknown ${n}: ${r}. This may be due to one of the following reasons:
1. The ${n} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${n} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return a}else{const o=r;if(o.className==null||o.config==null)throw new Ye(`${n}: Improper config format: ${JSON.stringify(o)}.
'className' and 'config' must set.`);const a=o.className;let i,l;if(a in t?[i,l]=t[a]:a in $i?[i,l]=$i.className:a in e&&([i,l]=e[a]),i==null)throw new Ye(`Unknown ${n}: ${a}. This may be due to one of the following reasons:
1. The ${n} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${n} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(l!=null){const u={};for(const f of Object.keys($i))u[f]=$i[f];for(const f of Object.keys(t))u[f]=t[f];const h=o.config;h.customObjects=u;const d=Object.assign({},$i);for(const f of Object.keys(t))$i[f]=t[f];jb(o.config);const c=l(i,o.config,t,s);return $i=Object.assign({},d),c}else{const u=Object.assign({},$i);for(const d of Object.keys(t))$i[d]=t[d];const h=new i(o.config);return $i=Object.assign({},u),h}}}function WX(r,e){return r<e?-1:r>e?1:0}function dg(r,e){return-1*WX(r,e)}function hu(r){if(r==null)return r;const e=[];for(const t of r)e.indexOf(t)===-1&&e.push(t);return e}function HX(r){if(r==null)throw new Ye(`Invalid value in obj: ${JSON.stringify(r)}`);for(const e in r)if(r.hasOwnProperty(e))return!1;return!0}function Zc(r,e,t){if(t!=null&&r.indexOf(t)<0)throw new Ye(`${t} is not a valid ${e}.  Valid values are ${r} or null/undefined.`)}function H2(r,e,t=0,n=1/0){return Pa(t>=0),Pa(n>=t),Array.isArray(r)&&r.length>=t&&r.length<=n&&r.every(s=>typeof s===e)}function Ts(r,e){Array.isArray(r)?(xe(r.length>0,()=>`${e} is unexpectedly an empty array.`),r.forEach((t,n)=>Ts(t,`element ${n+1} of ${e}`))):xe(Number.isInteger(r)&&r>0,()=>`Expected ${e} to be a positive integer, but got ${ON(r)}.`)}function ON(r){return r===null?"null":Array.isArray(r)?"["+r.map(e=>ON(e)).join(",")+"]":typeof r=="string"?`"${r}"`:`${r}`}function qX(r,e,t){let n=t!=null?t():yo(),s;return(...a)=>{const i=t!=null?t():yo();return i-n<e||(n=i,s=r(...a)),s}}function MN(r){return r==="relu"?"relu":r==="linear"?"linear":r==="elu"?"elu":null}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let XX=0;function FN(){return XX++}const fg={};function t1(r=""){return r in fg||(fg[r]=0),fg[r]+=1,r+fg[r].toString()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const KX=["channelsFirst","channelsLast"],YX=["nearest","bilinear"],ZX=["valid","same","causal"],QX=["max","avg"],JX=["sum","mul","concat","ave"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const _h=new Map;function ns(r){Zc(KX,"DataFormat",r)}function eK(r){Zc(YX,"InterpolationFormat",r)}function mi(r){Zc(ZX,"PaddingMode",r)}function LN(r){Zc(QX,"PoolMode",r)}const _f=[],hI="/";function Tc(r,e){_f.push(r);try{const t=e();return _f.pop(),t}catch(t){throw _f.pop(),t}}function tK(){return _f.length===0?"":_f.join(hI)+hI}function PN(r){if(!BN(r))throw new Error("Not a valid tensor name: '"+r+"'");return tK()+r}function jN(r){if(!BN(r))throw new Error("Not a valid tensor name: '"+r+"'");_h.has(r)||_h.set(r,0);const e=_h.get(r);if(_h.set(r,_h.get(r)+1),e>0){const t=`${r}_${e}`;return _h.set(t,1),t}else return r}const nK=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function BN(r){return!!r.match(nK)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function rK(r){return r===parseInt(r.toString(),10)}function du(r,e,t){e==null&&(e=0),t==null&&(t=r.length);let n=1;for(let s=e;s<t;++s)n*=r[s];return n}function nd(r){if(r.length===0)return Number.NaN;let e=Number.POSITIVE_INFINITY;for(let t=0;t<r.length;t++){const n=r[t];n<e&&(e=n)}return e}function gu(r){if(r.length===0)return Number.NaN;let e=Number.NEGATIVE_INFINITY;for(let t=0;t<r.length;t++){const n=r[t];n>e&&(e=n)}return e}function ma(r,e){if(e<r)throw new Ye(`end (${e}) < begin (${r}) is forbidden.`);const t=[];for(let n=r;n<e;++n)t.push(n);return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let zv;function ls(){return zv==null&&(zv=gG().epsilon()),zv}function ga(){return"channelsLast"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function nm(r,e){return Yt(r,e)}function rm(r,e=-1){const t=r.shape.slice();return e<0&&(e=t.length+e+1),t.splice(e,0,1),Qe(r,t)}function sK(r,e){return at(()=>{if(r.shape.length!==2)throw new Ye(`repeat() expects a rank-2 tensor, but received a rank-${r.shape.length} tensor.`);const t=rm(r,1);return Bb(t,[1,e,1])})}function oK(r){const e=[du(r.shape)];return Qe(r,e)}function iK(r){if(r.rank<=1)throw new Ye(`batchFlatten requires a minimum rank of 2. Got rank: ${r.rank}.`);const e=[r.shape[0],du(r.shape,1)];return Qe(r,e)}function kc(r,e,t){return at(()=>{switch(r.rank){case 1:return a2(r,e,t);case 2:return Y$(r,[e,0],[t,r.shape[1]]);case 3:return l2(r,[e,0,0],[t,r.shape[1],r.shape[2]]);case 4:return oy(r,[e,0,0,0],[t,r.shape[1],r.shape[2],r.shape[3]]);case 5:return _r(r,[e,0,0,0,0],[t,r.shape[1],r.shape[2],r.shape[3],r.shape[4]]);case 6:return _r(r,[e,0,0,0,0,0],[t,r.shape[1],r.shape[2],r.shape[3],r.shape[4],r.shape[5]]);default:throw new Ye(`sliceAlongFirstAxis() received an unsupported tensor rank: ${r.rank}`)}})}function Vv(r,e,t){return at(()=>{switch(r.rank){case 1:return a2(r,e,t);case 2:return Y$(r,[0,e],[r.shape[0],t]);case 3:return l2(r,[0,0,e],[r.shape[0],r.shape[1],t]);case 4:return oy(r,[0,0,0,e],[r.shape[0],r.shape[1],r.shape[2],t]);default:throw new Ye(`sliceAlongLastAxis() received an unsupported tensor rank: ${r.rank}`)}})}function pg(r,e,t,n){return at(()=>{switch(r.rank){case 1:return a2(r,e,t);case 2:switch(n){case 1:return kc(r,e,t);case 2:return Vv(r,e,t);default:throw new Ye(`The axis is not within the rank of the tensor ${n}`)}case 3:switch(n){case 1:return kc(r,e,t);case 2:return l2(r,[0,e,0],[r.shape[0],t,r.shape[2]]);case 3:return Vv(r,e,t);default:throw new Ye(`The axis is not within the rank of the tensor ${n}`)}case 4:switch(n){case 1:return kc(r,e,t);case 2:return oy(r,[0,e,0,0],[r.shape[0],t,r.shape[2],r.shape[3]]);case 3:return oy(r,[0,0,e,0],[r.shape[0],r.shape[1],t,r.shape[3]]);case 4:return Vv(r,e,t);default:throw new Ye(`The axis is not within the rank of the tensor ${n}`)}default:throw new Ye(`sliceAlongLastAxis() received an unsupported tensor rank: ${r.rank}`)}})}function q2(r,e=-1){let t;return e<0&&(t=r[0].rank,t!==0?e=t:e=0),e===r[0].rank&&(e=-1),Hs(r,e)}function dI(r,e){switch(r.rank){case 1:return kW([r,e]);case 2:return EW([r,e],0);case 3:return $W([r,e],0);case 4:return AW([r,e],0);default:throw new Ye(`concatAlongFirstAxis() received an unsupported tensor rank: ${r.rank}`)}}function Bb(r,e){if(Array.isArray(e)||(e=[e]),r.rank!==e.length)throw new Ye(`The length of input n (${e.length}) does not match the number of dimensions in input x (${r.rank})`);return da(r,e)}function n1(r,e=0,t=1,n,s){return IH(r,e,t,n,s)}function Xa(r,e,t,n){if(r.rank<2||e.rank<2)throw new On(`dot requires both inputs to be rank >= 2 but got x shape = ${r.shape} and y shape = ${e.shape}`);if(e.rank>=3){const s=r.shape.slice(-1)[0],o=e.shape.slice(-2)[0];if(s!==o)throw new On(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${r.shape} and  y shape = ${e.shape}`)}if(r.rank===2&&e.rank===2)return Jk({a:r,b:e,transposeA:!1,transposeB:!1,bias:n?Ub(r.rank,n,ga()):null,activation:t});{const s=r.shape.slice(),o=s.pop();r=Qe(r,[-1,o]);const a=e.shape.slice(),i=a.pop(),l=a.pop(),u=[...a,i],h=Array.from({length:e.rank},(p,m)=>m===0?e.rank-2:m<=e.rank-2?m-1:m);e=Qe(nr(e,h),[l,-1]);const d=[...s,...u];return Qe(Jk({a:r,b:e,transposeA:!1,transposeB:!1,bias:n?Ub(r.rank,n,ga()):null,activation:t}),d)}}function UN(r,e,t){return at(()=>(Array.isArray(e)?e=Po(e,"int32"):e=Yt(e,"int32"),Zw(r,e,t)))}function sm(r){return We(r,r)}function Ub(r,e,t){const n=e.shape;if(e.rank!==1&&e.rank!==r)throw new Ye(`Unexpected bias dimensions: ${e.rank}; expected it to be 1 or ${r}`);if(r===5){if(t==="channelsFirst")return n.length===1?Qe(e,[1,n[0],1,1,1]):Qe(e,[1,n[3],n[0],n[1],n[2]]);if(t==="channelsLast")return n.length===1?Qe(e,[1,1,1,1,n[0]]):Qe(e,[1].concat(n))}else if(r===4){if(t==="channelsFirst")return n.length===1?Qe(e,[1,n[0],1,1]):Qe(e,[1,n[2],n[0],n[1]]);if(t==="channelsLast")return n.length===1?Qe(e,[1,1,1,n[0]]):Qe(e,[1].concat(n))}else if(r===3){if(t==="channelsFirst")return n.length===1?Qe(e,[1,n[0],1]):Qe(e,[1,n[1],n[0]]);if(t==="channelsLast")return n.length===1?Qe(e,[1,1,n[0]]):Qe(e,[1].concat(n))}else if(r<3)return e;throw new Ye(`Unsupported input rank by biasAdd: ${e.rank}`)}function xa(r,e,t){return at(()=>(t==null&&(t=ga()),ns(t),Rt(r,Ub(r.rank,e,t))))}function aK(r,e=1){if(e!==1)throw new On(`Support for alpha values other than 1 (${e}) is not implemented yet.`);return H0(r)}function lK(r){return at(()=>fn(r,Rt(bs(r),1)))}function zN(r,e,t,n){return at(()=>g7(r,e,t,n))}function uK(r){return at(()=>{const e=Rt(.5,We(.2,r));return pi(e,0,1)})}function om(r,e,t=!1){return t?r():e()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const cK=["fanIn","fanOut","fanAvg"],hK=["normal","uniform","truncatedNormal"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function dK(r){Zc(cK,"FanMode",r)}function fK(r){Zc(hK,"Distribution",r)}class Yi extends xd{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class VN extends Yi{apply(e,t){return Ss(e,t)}}VN.className="Zeros";Et(VN);class X2 extends Yi{apply(e,t){return $u(e,t)}}X2.className="Ones";Et(X2);class GN extends Yi{constructor(e){if(super(),typeof e!="object")throw new Ye(`Expected argument of type ConstantConfig but got ${e}`);if(e.value===void 0)throw new Ye(`config must have value set but got ${e}`);this.value=e.value}apply(e,t){return at(()=>We(An(this.value),$u(e,t)))}getConfig(){return{value:this.value}}}GN.className="Constant";Et(GN);class WN extends Yi{constructor(e){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=e.minval||this.DEFAULT_MINVAL,this.maxval=e.maxval||this.DEFAULT_MAXVAL,this.seed=e.seed}apply(e,t){return Y0(e,this.minval,this.maxval,t)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}WN.className="RandomUniform";Et(WN);class HN extends Yi{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,t){if(t=t||"float32",t!=="float32"&&t!=="int32")throw new On(`randomNormal does not support dType ${t}.`);return n1(e,this.mean,this.stddev,t,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}HN.className="RandomNormal";Et(HN);class qN extends Yi{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,t){if(t=t||"float32",t!=="float32"&&t!=="int32")throw new On(`truncatedNormal does not support dType ${t}.`);return eN(e,this.mean,this.stddev,t,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}qN.className="TruncatedNormal";Et(qN);class XN extends Yi{constructor(e){super(),this.gain=e.gain!=null?e.gain:1}apply(e,t){return at(()=>{if(e.length!==2||e[0]!==e[1])throw new Ye("Identity matrix initializer can only be used for 2D square matrices.");return We(this.gain,N$(e[0]))})}getConfig(){return{gain:this.gain}}}XN.className="Identity";Et(XN);function pK(r,e="channelsLast"){let t,n;if(ns(e),r.length===2)t=r[0],n=r[1];else if([3,4,5].indexOf(r.length)!==-1){if(e==="channelsFirst"){const s=du(r,2);t=r[1]*s,n=r[0]*s}else if(e==="channelsLast"){const s=du(r,0,r.length-2);t=r[r.length-2]*s,n=r[r.length-1]*s}}else{const s=du(r);t=Math.sqrt(s),n=Math.sqrt(s)}return[t,n]}class Vo extends Yi{constructor(e){if(super(),e.scale<0)throw new Ye(`scale must be a positive float. Got: ${e.scale}`);this.scale=e.scale==null?1:e.scale,this.mode=e.mode==null?"fanIn":e.mode,dK(this.mode),this.distribution=e.distribution==null?"normal":e.distribution,fK(this.distribution),this.seed=e.seed}apply(e,t){const n=pK(e),s=n[0],o=n[1];let a=this.scale;if(this.mode==="fanIn"?a/=Math.max(1,s):this.mode==="fanOut"?a/=Math.max(1,o):a/=Math.max(1,(s+o)/2),this.distribution==="normal"){const i=Math.sqrt(a);if(t=t||"float32",t!=="float32"&&t!=="int32")throw new On(`${this.getClassName()} does not support dType ${t}.`);return eN(e,0,i,t,this.seed)}else{const i=Math.sqrt(3*a);return Y0(e,-i,i,t)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}Vo.className="VarianceScaling";Et(Vo);class K2 extends Vo{constructor(e){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return Vo.className}}K2.className="GlorotUniform";Et(K2);class Y2 extends Vo{constructor(e){super({scale:1,mode:"fanAvg",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return Vo.className}}Y2.className="GlorotNormal";Et(Y2);class Z2 extends Vo{constructor(e){super({scale:2,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return Vo.className}}Z2.className="HeNormal";Et(Z2);class Q2 extends Vo{constructor(e){super({scale:2,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return Vo.className}}Q2.className="HeUniform";Et(Q2);class J2 extends Vo{constructor(e){super({scale:1,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return Vo.className}}J2.className="LeCunNormal";Et(J2);class eS extends Vo{constructor(e){super({scale:1,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return Vo.className}}eS.className="LeCunNormal";Et(eS);class KN extends Yi{constructor(e){if(super(),this.DEFAULT_GAIN=1,this.gain=e.gain==null?this.DEFAULT_GAIN:e.gain,this.seed=e.seed,this.seed!=null)throw new On("Random seed is not implemented for Orthogonal Initializer yet.")}apply(e,t){return at(()=>{if(e.length<2)throw new On("Shape must be at least 2D.");e[0]*e[1]>2e3&&console.warn(`Orthogonal initializer is being called on a matrix with more than 2000 (${e[0]*e[1]}) elements: Slowness may result.`);const n=e[0]>e[1]?[e[1],e[0]]:e,s=n1(n,0,1,"float32");let o=M9.gramSchmidt(s);return e[0]>e[1]&&(o=nr(o)),We(this.gain,o)})}getConfig(){return{gain:this.gain,seed:this.seed}}}KN.className="Orthogonal";Et(KN);const fI={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function pI(r,e={}){return tm(r,Mi.getMap().classNameMap,e,"initializer")}function Gr(r){return W2(r)}function jr(r){if(typeof r=="string"){const e=r in fI?fI[r]:r;if(e==="GlorotNormal")return new Y2;if(e==="GlorotUniform")return new K2;if(e==="HeNormal")return new Z2;if(e==="HeUniform")return new Q2;if(e==="LeCunNormal")return new J2;if(e==="LeCunUniform")return new eS;{const t={};return t.className=e,t.config={},pI(t)}}else return r instanceof Yi?r:pI(r)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function zb(r){return Array.isArray(r)&&Array.isArray(r[0])}function iy(r){return r.length===0?[]:Array.isArray(r[0])?r:[r]}function Mn(r){let e;if(Array.isArray(r)){if(r.length!==1)throw new Ye(`Expected Tensor length to be 1; got ${r.length}`);e=r[0]}else e=r;return e}function xr(r){if(Array.isArray(r)&&Array.isArray(r[0])){if(r.length===1)return r=r,r[0];throw new Ye(`Expected exactly 1 Shape; got ${r.length}`)}else return r}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function ay(r){let e=0;for(const t of r)t.shape.length===0?e+=1:e+=t.shape.reduce((n,s)=>n*s);return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const mI="Variable";class mK{constructor(e,t="float32",n=mI,s=!0,o=null){this.dtype=t==null?"float32":t,this.shape=e.shape,this.id=FN(),n=n==null?mI:n,this.originalName=PN(n),this.name=jN(this.originalName),this.trainable_=s,this.constraint=o,this.val=f7(e,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(e){return this.assertNotDisposed(),gK(this.val,e),this.val.id!==e.id&&(this.val.assign(e),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(e){this.trainable_=e,this.val.trainable=e}}function gK(r,e){if(r.shape.toString()!==e.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(r.shape)+" vs. "+JSON.stringify(e.shape))}function Vb(r){return r.map(e=>e.read())}function tS(r){r.forEach(e=>{e[0].write(e[1])})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class us{constructor(e){this.dtype=e.dtype,this.shape=e.shape,e.shape!=null?this.ndim=e.shape.length:this.ndim=e.ndim,this.maxNDim=e.maxNDim,this.minNDim=e.minNDim,this.axes=e.axes||{}}}class Ua{constructor(e,t,n,s,o,a,i){this.dtype=e,this.shape=t,this.sourceLayer=n,this.inputs=s,this.callArgs=o,this.outputTensorIndex=i,this.id=FN(),a!=null&&(this.originalName=PN(a),this.name=jN(this.originalName)),this.rank=t.length}}let yK=0;class r1{constructor(e,t){this.callArgs=t,this.id=yK++,this.outboundLayer=e.outboundLayer,this.inboundLayers=e.inboundLayers,this.nodeIndices=e.nodeIndices,this.tensorIndices=e.tensorIndices,this.inputTensors=e.inputTensors,this.outputTensors=e.outputTensors,this.inputMasks=e.inputMasks,this.outputMasks=e.outputMasks,this.inputShapes=e.inputShapes,this.outputShapes=e.outputShapes;for(const n of e.inboundLayers)n!=null&&n.outboundNodes.push(this);e.outboundLayer.inboundNodes.push(this)}getConfig(){const e=[];for(const t of this.inboundLayers)t!=null?e.push(t.name):e.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:e,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}let vK=0;class rr extends xd{constructor(e={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=vK++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let t=e.name;if(!t){const n=this.getClassName();t=xl(n)+"_"+t1(n)}if(this.name=t,this.trainable_=e.trainable==null?!0:e.trainable,e.inputShape!=null||e.batchInputShape!=null){let n;if(e.batchInputShape!=null)n=e.batchInputShape;else if(e.inputShape!=null){let o=null;e.batchSize!=null&&(o=e.batchSize),n=[o].concat(e.inputShape)}this.batchInputShape=n;let s=e.dtype;s==null&&(s=e.inputDType),s==null&&(s="float32"),this.dtype=s}e.weights!=null?this.initialWeights=e.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(e,t){return e.name+"_ib-"+t.toString()}getNodeAtIndex(e,t){if(this.inboundNodes.length===0)throw new ji(`The layer has never been called and thus has no defined ${t}.`);if(this.inboundNodes.length<=e)throw new Ye(`Asked to get ${t} at node ${e}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[e]}getInputAt(e){return vo(this.getNodeAtIndex(e,"input").inputTensors)}getOutputAt(e){return vo(this.getNodeAtIndex(e,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new La(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use \`getInputAt(nodeIndex)\` instead.`);if(this.inboundNodes.length===0)throw new La(`Layer ${this.name} is not connected, no input to return.`);return vo(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(this.inboundNodes.length===0)throw new La(`Layer ${this.name} has no inbound nodes.`);if(this.inboundNodes.length>1)throw new La(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use \`getOutputAt(nodeIndex)\` instead.`);return vo(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(e=>e())}get updates(){return this._updates}get built(){return this._built}set built(e){this._built=e}get trainable(){return this.trainable_}set trainable(e){this._trainableWeights.forEach(t=>t.trainable=e),this.trainable_=e}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(e=>e.trainable):[]}set trainableWeights(e){this._trainableWeights=e}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(e=>!e.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(e){this._nonTrainableWeights=e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(e){if(e=Mr(e),this.inputSpec==null||this.inputSpec.length===0)return;const t=Mr(this.inputSpec);if(e.length!==t.length)throw new Ye(`Layer ${this.name} expects ${t.length} inputs, but it received ${e.length} input tensors. Input received: ${e}`);for(let n=0;n<e.length;n++){const s=e[n],o=t[n];if(o==null)continue;const a=s.rank;if(o.ndim!=null&&a!==o.ndim)throw new Ye(`Input ${n} is incompatible with layer ${this.name}: expected ndim=${o.ndim}, found ndim=${a}`);if(o.maxNDim!=null&&a>o.maxNDim)throw new Ye(`Input ${n} is incompatible with layer ${this.name}: expected max_ndim=${o.maxNDim}, found ndim=${a}`);if(o.minNDim!=null&&a<o.minNDim)throw new Ye(`Input ${n} is incompatible with layer ${this.name}: expected min_ndim=${o.minNDim}, found ndim=${a}.`);if(o.dtype!=null&&s.dtype!==o.dtype)throw new Ye(`Input ${n} is incompatible with layer ${this.name} : expected dtype=${o.dtype}, found dtype=${s.dtype}.`);if(o.axes){const i=s.shape;for(const l in o.axes){const u=Number(l),h=o.axes[l],d=u>=0?i[u]:i[i.length+u];if(h!=null&&[h,null].indexOf(d)===-1)throw new Ye(`Input ${n} is incompatible with layer ${this.name}: expected axis ${u} of input shape to have value ${h} but got shape ${i}.`)}}if(o.shape!=null)for(let i=0;i<o.shape.length;++i){const l=o.shape[i],u=s.shape[i];if(l!=null&&u!=null&&l!==u)throw new Ye(`Input ${n} is incompatible with layer ${this.name}: expected shape=${o.shape}, found shape=${s.shape}.`)}}}call(e,t){return e}invokeCallHook(e,t){this._callHook!=null&&this._callHook(e,t)}setCallHook(e){this._callHook=e}clearCallHook(){this._callHook=null}apply(e,t){t=t||{},this.assertNotDisposed();const n=Mr(e);let s=!0;for(const a of n)if(!(a instanceof Ua)){s=!1;break}let o=!0;for(const a of n)if(a instanceof Ua){o=!1;break}if(s===o)throw new Ye("Arguments to apply() must be all SymbolicTensors or all Tensors");return Tc(this.name,()=>{if(!this.built){this.assertInputCompatibility(e);const a=[];for(const i of Mr(e))a.push(i.shape);this.build(vo(a)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),this._refCount===null&&o&&(this._refCount=1)}if(this.assertInputCompatibility(e),o){let a=this.call(e,t);const i=Mr(a),l=[];for(let u of i)n.indexOf(u)!==-1&&(u=u.clone()),l.push(u);if(a=vo(l),this.activityRegularizer!=null)throw new On("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return a}else{const a=bK(e),i=this.computeOutputShape(a);let l;const u=xK(e);if(this.warnOnIncompatibleInputShape(Array.isArray(e)?a[0]:a),i!=null&&i.length>0&&Array.isArray(i[0])?l=i.map((h,d)=>new Ua(u,h,this,Mr(e),t,this.name,d)):l=new Ua(u,i,this,Mr(e),t,this.name),this.addInboundNode(e,l,null,null,a,i,t),this._refCount++,this.activityRegularizer!=null)throw new On("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return l}})}warnOnIncompatibleInputShape(e){if(this.batchInputShape!=null)if(e.length!==this.batchInputShape.length)console.warn(`The rank of the input tensor provided (shape: ${JSON.stringify(e)}) does not match that of the batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer ${this.name}`);else{let t=!1;this.batchInputShape.forEach((n,s)=>{n!=null&&e[s]!=null&&e[s]!==n&&(t=!0)}),t&&console.warn(`The shape of the input tensor (${JSON.stringify(e)}) does not match the expectation of layer ${this.name}: ${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new La(`The layer ${this.name} has never been called and thus has no defined output shape.`);const e=[];for(const t of this.inboundNodes){const n=JSON.stringify(t.outputShapes);e.indexOf(n)===-1&&e.push(n)}if(e.length===1){const t=this.inboundNodes[0].outputShapes;return Array.isArray(t)&&Array.isArray(t[0])&&t.length===1?t[0]:t}else throw new La(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new ji(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return ay(this.weights)}build(e){this.built=!0}getWeights(e=!1){return Vb(e?this.trainableWeights:this.weights)}setWeights(e){at(()=>{const t=this.weights;if(t.length!==e.length)throw new Ye(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${e.length}, but the layer was expecting ${t.length} weights. Provided weights: ${e}...`);if(t.length===0)return;const n=[],s=Vb(t);for(let o=0;o<s.length;++o){const a=s[o],i=t[o],l=e[o];if(!ur(a.shape,l.shape))throw new Ye(`Layer weight shape ${a.shape} not compatible with provided weight shape ${l.shape}`);n.push([i,l])}tS(n)})}addWeight(e,t,n,s,o,a,i,l){if(this._addedWeightNames.indexOf(e)!==-1)throw new Ye(`Duplicate weight name ${e} for layer ${this.name}`);this._addedWeightNames.push(e),n==null&&(n="float32"),this.fastWeightInitDuringBuild&&(s=l!=null?l():jr("zeros"));const u=s.apply(t,n),h=new mK(u,n,e,a,i);return u.dispose(),o!=null&&this.addLoss(()=>o.apply(h.read())),a==null&&(a=!0),a?this._trainableWeights.push(h):this._nonTrainableWeights.push(h),h}setFastWeightInitDuringBuild(e){this.fastWeightInitDuringBuild=e}addLoss(e){e==null||Array.isArray(e)&&e.length===0||(e=Mr(e),this._losses!==void 0&&this._losses!==null&&this.losses.push(...e))}computeOutputShape(e){return e}computeMask(e,t){if(!this.supportsMasking){if(t!=null)if(Array.isArray(t))t.forEach(n=>{if(n!=null)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)});else throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);return null}return t}addInboundNode(e,t,n,s,o,a,i=null){const l=Mr(e);t=Mr(t),n=Mr(n),s=Mr(s),o=iy(o),a=iy(a);const u=[],h=[],d=[];for(const c of l)u.push(c.sourceLayer),h.push(c.nodeIndex),d.push(c.tensorIndex);new r1({outboundLayer:this,inboundLayers:u,nodeIndices:h,tensorIndices:d,inputTensors:l,outputTensors:t,inputMasks:n,outputMasks:s,inputShapes:o,outputShapes:a},i);for(let c=0;c<t.length;c++)t[c].sourceLayer=this,t[c].nodeIndex=this.inboundNodes.length-1,t[c].tensorIndex=c}getConfig(){const e={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(e.batchInputShape=this.batchInputShape),this.dtype!=null&&(e.dtype=this.dtype),e}disposeWeights(){return this.weights.forEach(e=>e.dispose()),this.weights.length}assertNotDisposed(){if(this._refCount===0)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(this._refCount===null)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let e=0;return--this._refCount===0&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}}}function bK(r){r=Mr(r);const e=[];for(const t of r)e.push(t.shape);return vo(e)}function xK(r){return"float32"}function YN(r,e,t){if((e==null||t!=null&&t>0)&&(e=r.sourceLayer,t=r.nodeIndex),e.inboundNodes.length===0)return[r];{const n=e.inboundNodes[t];if(n.inboundLayers.length===0)return n.inputTensors;{const s=[];for(let o=0;o<n.inboundLayers.length;o++){const a=n.inputTensors[o],i=n.inboundLayers[o],l=n.nodeIndices[o],u=YN(a,i,l);for(const h of u)s.indexOf(h)===-1&&s.push(h)}return s}}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class im extends rr{constructor(e){if(super({dtype:e.dtype,name:e.name!=null?e.name:t1("input").toString()}),e.batchSize==null&&(e.batchSize=null),e.sparse==null&&(e.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=e.sparse,e.inputShape!=null&&e.batchInputShape!=null)throw new Ye("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let t=e.batchInputShape;if(t==null){if(e.inputShape==null)throw new Ye("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");t=[e.batchSize].concat(e.inputShape)}else if(e.batchSize!=null)throw new Ye("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const n=e.dtype||"float32";this.batchInputShape=t,this.dtype=n,this.inputSpec=[{shape:t}];const s=new Ua(this.dtype,this.batchInputShape,this,[],{},this.name);s.nodeIndex=0,s.tensorIndex=0,new r1({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[s],outputTensors:[s],inputMasks:[null],outputMasks:[null],inputShapes:[t],outputShapes:[t]})}apply(e,t){throw new Ye(`Cannot pass any input to an InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}im.className="InputLayer";Et(im);function wK(r){if(r.batchShape==null&&r.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(r.batchShape!=null&&r.shape!=null)throw new Ye("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let e=r.batchShape;r.shape!=null&&e==null&&(e=[null].concat(r.shape));let t=r.dtype;return t==null&&(t="float32"),new im({batchInputShape:e,name:r.name,dtype:t,sparse:r.sparse}).inboundNodes[0].outputTensors[0]}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function SK(r,e){if(r.dtype==null||r.dtype===e.dtype)return e;try{return Yt(e,r.dtype)}catch{throw new Ye(`The dtype of the feed (${e.dtype}) can not be cast to the dtype of the key '${r.name}' (${r.dtype}).`)}}class ou{constructor(e){if(this.id2Value={},this.id2Mask={},this.name2Id={},e instanceof ou)for(const t in e.id2Value)this.id2Value[t]=e.id2Value[t],t in e.id2Mask&&(this.id2Mask[t]=e.id2Mask[t]);else{if(e==null)return;for(const t of e)this.add(t.key,t.value)}}add(e,t,n){if(this.id2Value[e.id]==null)this.id2Value[e.id]=SK(e,t),this.name2Id[e.name]=e.id,n!=null&&(this.id2Mask[e.id]=n);else throw new Ye(`Duplicate key: name=${e.name}, id=${e.id}`);return this}addFeed(e){this.add(e.key,e.value)}hasKey(e){return this.id2Value[e.id]!=null}names(){return Object.keys(this.name2Id)}getValue(e){if(e instanceof Ua){if(this.id2Value[e.id]==null)throw new Ye(`Nonexistent key: ${e.name}`);return this.id2Value[e.id]}else{const t=this.name2Id[e];if(t==null)throw new Ye(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Value[t]}}getMask(e){if(e instanceof Ua){if(this.id2Value[e.id]==null)throw new Ye(`Nonexistent key: ${e.name}`);return this.id2Mask[e.id]}else{const t=this.name2Id[e];if(t==null)throw new Ye(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Mask[t]}}disposeMasks(){this.id2Mask!=null&&Kn(this.id2Mask)}}const ly=new DN,uy=new DN;function _K(r){ly!=null&&ly.setMaxEntries(r),uy!=null&&uy.setMaxEntries(r)}function uf(r,e,t,n){const s=t==null?!1:t.training,o=Array.isArray(r),a=o?r:[r],i=a.map(p=>p.name),l=[],u=e.names();for(const p of i)u.indexOf(p)!==-1?l.push(e.getValue(p)):l.push(null);n!=null&&(n.maxNumTensors=-1/0,n.minNumTensors=1/0);const h=i.join(",")+"|"+e.names().sort().join(",");let d=ly.get(h),c;if(d==null){const p=TK(a,e);d=p.sorted,c=p.recipientCounts,ly.put(h,d),uy.put(h,c)}c={},s||Object.assign(c,uy.get(h));const f=new ou(e);for(let p=0;p<d.length;++p){if(n!=null){const O=Ab().numTensors;O>n.maxNumTensors&&(n.maxNumTensors=O),O<n.minNumTensors&&(n.minNumTensors=O)}const m=d[p],g=m.sourceLayer;if(g instanceof im)continue;const y=[],v=[],b=[];let w=!1;for(const O of m.inputs){const D=f.getValue(O),M=f.getMask(O);y.push(D),v.push(M),M!=null&&(w=!0),s||(c[O.name]--,c[O.name]===0&&!e.hasKey(O)&&i.indexOf(O.name)===-1&&!D.isDisposed&&O.sourceLayer.stateful!==!0&&b.push(D))}w&&(t=t||{},t.mask=v[0]);const _=Mr(g.apply(y,t));let I=null;g.supportsMasking&&(I=g.computeMask(y,v));const C=IK(m),N=Array.isArray(C)?C:[C];for(let O=0;O<N.length;++O){f.hasKey(N[O])||f.add(N[O],_[O],Array.isArray(I)?I[0]:I);const D=i.indexOf(N[O].name);D!==-1&&(l[D]=_[O])}s||Kn(b)}return f.disposeMasks(),o?l:l[0]}function TK(r,e){xe(r!=null&&r.length>0,()=>"Expected at least one fetch, got none");let t=[],n={};if(r.length===1){const s=gI(r[0],e);t=s.sorted,n=s.recipientMap}else{const s=new Set;for(const o of r){const{sorted:a,recipientMap:i}=gI(o,e);for(const l of a)s.has(l.name)||(t.push(l),s.add(l.name));for(const l in i)n[l]==null&&(n[l]=new Set),i[l].forEach(u=>n[l].add(u))}}return{sorted:t,recipientCounts:kK(n)}}function kK(r){const e={};for(const t in r)e[t]=r[t].size;return e}function gI(r,e){const t=new Set,n=[],s={};for(const i of e.names())t.add(i);const o=[],a=[];for(o.push(r);o.length>0;){const i=o[o.length-1];if(t.has(i.name)){o.pop();continue}const l=a[a.length-1]===o.length-1;if(i.inputs.length===0||l)o.pop(),n.push(i),t.add(i.name),l&&a.pop();else{a.push(o.length-1);for(const u of i.inputs)s[u.name]==null&&(s[u.name]=new Set),s[u.name].add(i.name),!t.has(u.name)&&o.push(u)}}return{sorted:n,recipientMap:s}}function IK(r){let e;if(r.sourceLayer.inboundNodes.length===1)e=r.sourceLayer.output;else{let t=null;for(let n=0;n<r.sourceLayer.inboundNodes.length;++n)for(const s of r.sourceLayer.inboundNodes[n].outputTensors)if(s.id===r.id){t=n;break}e=r.sourceLayer.getOutputAt(t)}return e}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EK=ut();EK.registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",()=>100,_K);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function nS(r,e){return at(()=>io(rn(We(r,r),e,!0)))}class am extends xd{getConfig(){return{}}}class ZN extends am{constructor(e){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return at(()=>{const t=nS(e,this.axis),n=pi(t,0,this.maxValue);return We(e,fn(n,Rt(ls(),t)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}ZN.className="MaxNorm";Et(ZN);class QN extends am{constructor(e){super(),this.defaultAxis=0,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return at(()=>fn(e,Rt(ls(),nS(e,this.axis))))}getConfig(){return{axis:this.axis}}}QN.className="UnitNorm";Et(QN);class JN extends am{apply(e){return Dl(e)}}JN.className="NonNeg";Et(JN);class eA extends am{constructor(e){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=e.minValue!=null?e.minValue:this.defaultMinValue,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.rate=e.rate!=null?e.rate:this.defaultRate,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return at(()=>{const t=nS(e,this.axis),n=Rt(We(this.rate,pi(t,this.minValue,this.maxValue)),We(1-this.rate,t));return We(e,fn(n,Rt(ls(),t)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}eA.className="MinMaxNorm";Et(eA);const yI={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function hs(r){return W2(r)}function vI(r,e={}){return tm(r,Mi.getMap().classNameMap,e,"constraint")}function ds(r){if(r==null)return null;if(typeof r=="string"){const t={className:r in yI?yI[r]:r,config:{}};return vI(t)}else return r instanceof am?r:vI(r)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */async function uc(r){if(r==null)return;const e=[],t=[],n=[];for(const s in r){const o=r[s];if(typeof o!="number"){const a=o;e.push(a.data()),t.push(s),n.push(a)}}if(e.length>0){const s=await Promise.all(e);for(let o=0;o<s.length;++o)r[t[o]]=s[o][0];Kn(n)}}function tA(r){if(r!=null)for(const e in r){const t=r[e];typeof t!="number"&&t.dispose()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var bI;(function(r){r[r.SILENT=0]="SILENT",r[r.VERBOSE=1]="VERBOSE"})(bI||(bI={}));const CK=125;class Cf{constructor(){this.validationData=null}setParams(e){this.params=e}async onEpochBegin(e,t){}async onEpochEnd(e,t){}async onBatchBegin(e,t){}async onBatchEnd(e,t){}async onTrainBegin(e){}async onTrainEnd(e){}setModel(e){}}class $K{constructor(e,t=10){e==null&&(e=[]),this.callbacks=e,this.queueLength=t}append(e){this.callbacks.push(e)}setParams(e){for(const t of this.callbacks)t.setParams(e)}setModel(e){for(const t of this.callbacks)t.setModel(e)}async onEpochBegin(e,t){t==null&&(t={});for(const n of this.callbacks)await n.onEpochBegin(e,t)}async onEpochEnd(e,t){t==null&&(t={});for(const n of this.callbacks)await n.onEpochEnd(e,t)}async onBatchBegin(e,t){t==null&&(t={});for(const n of this.callbacks)await n.onBatchBegin(e,t)}async onBatchEnd(e,t){t==null&&(t={});for(const n of this.callbacks)await n.onBatchEnd(e,t)}async onTrainBegin(e){e==null&&(e={});for(const t of this.callbacks)await t.onTrainBegin(e)}async onTrainEnd(e){e==null&&(e={});for(const t of this.callbacks)await t.onTrainEnd(e)}}class NK extends Cf{constructor(){super()}async onEpochBegin(e){this.seen=0,this.totals={}}async onBatchEnd(e,t){t==null&&(t={});const n=t.size==null?0:t.size;this.seen+=n;for(const s in t){const o=t[s];if(typeof o=="number")this.totals.hasOwnProperty(s)||(this.totals[s]=0),this.totals[s]=this.totals[s]+o*n;else{let a;s in this.totals?a=this.totals[s]:this.totals[s]=0;const i=at(()=>Rt(this.totals[s],We(o,n)));this.totals[s]=i,a!=null&&a.dispose()}}}async onEpochEnd(e,t){if(t!=null)for(const n of this.params.metrics)this.totals[n]!=null&&(typeof this.totals[n]=="number"?t[n]=this.totals[n]/this.seen:at(()=>{const s=We(fn(1,this.seen),this.totals[n]);t[n]=s,this.totals[n].dispose(),Ya(t[n])}))}}class AK extends Cf{async onTrainBegin(e){this.epoch=[],this.history={}}async onEpochEnd(e,t){t==null&&(t={}),this.epoch.push(e);for(const n in t)this.history[n]==null&&(this.history[n]=[]),this.history[n].push(t[n])}async syncData(){const e=[],t=[],n=[];for(const o in this.history){const a=this.history[o];for(let i=0;i<a.length;++i)if(typeof a[i]!="number"){const l=a[i];e.push(l.data()),t.push(o),n.push(i)}}const s=await Promise.all(e);for(let o=0;o<s.length;++o)this.history[t[o]][n[o]].dispose(),this.history[t[o]][n[o]]=s[o][0]}}class RK extends Cf{constructor(e,t){if(super(),this.currentEpoch=0,this.nowFunc=e.nowFunc,this.nextFrameFunc=e.nextFrameFunc||iN,this.yieldEvery=t||"auto",this.yieldEvery==="auto"&&(this.yieldEvery=CK),this.yieldEvery==="never"&&e.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");gb(this.yieldEvery)&&(this.maybeWait=qX(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=e.onTrainBegin,this.trainEnd=e.onTrainEnd,this.epochBegin=e.onEpochBegin,this.epochEnd=e.onEpochEnd,this.batchBegin=e.onBatchBegin,this.batchEnd=e.onBatchEnd,this.yield=e.onYield}async maybeWait(e,t,n){const s=[];this.yield!=null&&(await uc(n),s.push(this.yield(e,t,n))),s.push(this.nextFrameFunc()),await Promise.all(s)}async onEpochBegin(e,t){this.currentEpoch=e,this.epochBegin!=null&&(await uc(t),await this.epochBegin(e,t))}async onEpochEnd(e,t){const n=[];this.epochEnd!=null&&(await uc(t),n.push(this.epochEnd(e,t))),this.yieldEvery==="epoch"&&n.push(this.nextFrameFunc()),await Promise.all(n)}async onBatchBegin(e,t){this.batchBegin!=null&&(await uc(t),await this.batchBegin(e,t))}async onBatchEnd(e,t){const n=[];this.batchEnd!=null&&(await uc(t),n.push(this.batchEnd(e,t))),this.yieldEvery==="batch"?n.push(this.nextFrameFunc()):gb(this.yieldEvery)&&n.push(this.maybeWait(this.currentEpoch,e,t)),await Promise.all(n)}async onTrainBegin(e){this.trainBegin!=null&&(await uc(e),await this.trainBegin(e))}async onTrainEnd(e){this.trainEnd!=null&&(await uc(e),await this.trainEnd(e))}}function nA(r,e){return r==null&&(r={}),r instanceof Cf?[r]:Array.isArray(r)&&r[0]instanceof Cf?r:Mr(r).map(n=>new RK(n,e))}class Ri{constructor(){}static registerCallbackConstructor(e,t){xe(e>=0&&Number.isInteger(e),()=>`Verbosity level is expected to be an integer >= 0, but got ${e}`),Ri.checkForDuplicate(t),Ri.constructors[e]==null&&(Ri.constructors[e]=[]),Ri.constructors[e].push(t)}static checkForDuplicate(e){for(const t in Ri.constructors)Ri.constructors[+t].forEach(s=>{if(s===e)throw new Ye("Duplicate callback constructor.")})}static clear(){Ri.constructors={}}static createCallbacks(e){const t=[];for(const n in Ri.constructors){const s=+n;e>=s&&t.push(...Ri.constructors[s])}return t.map(n=>new n)}}Ri.constructors={};function rA(r,e,t,n,s,o,a,i,l){const u=new AK,h=[new NK,...Ri.createCallbacks(e)];r!=null&&h.push(...r),h.push(u);const d=new $K(h);return d.setParams({epochs:t,initialEpoch:n,samples:s,steps:o,batchSize:a,verbose:e,doValidation:i,metrics:l}),{callbackList:d,history:u}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function kl(r,e={},t=!1){return tm(r,Mi.getMap().classNameMap,e,"layer",t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function cy(r,e){return at(()=>{r.dtype!=="float32"&&(r=Yt(r,"float32"));const t=rn(sm(r),e,!0),n=Xp(t.shape,ls()),s=io(Cu(t,n));return fn(r,s)})}function s1(r,e){return at(()=>Qr(sm(sn(e,r)),-1))}function rS(r,e){return at(()=>Qr(bs(sn(e,r)),-1))}function sS(r,e){return at(()=>{const t=sn(r,e),n=pi(bs(r),ls(),Number.MAX_VALUE),s=bs(fn(t,n));return We(100,Qr(s,-1))})}function DK(r,e){return at(()=>{const t=pi(e,ls(),Number.MAX_VALUE),n=Wi(Rt(1,t)),s=pi(r,ls(),Number.MAX_VALUE),o=Wi(Rt(1,s));return Qr(sm(sn(n,o)),-1)})}function OK(r,e){return at(()=>{const t=Cu(0,sn(1,We(r,e)));return Qr(sm(t),-1)})}function MK(r,e){return at(()=>{const t=Cu(0,sn(1,We(r,e)));return Qr(t,-1)})}function FK(r,e){return at(()=>{const t=rn(We(r,e),-1),n=Ha(We(sn(1,r),e),-1);return Cu(0,Rt(1,sn(n,t)))})}function LK(r,e){return at(()=>{const t=Math.log(2),n=sn(e,r),s=sn(Rt(n,Kp(We(-2,n))),t);return Qr(s,-1)})}function $f(r,e,t=!1){return at(()=>{if(t)e=u2(e);else{const n=rn(e,e.shape.length-1,!0);e=fn(e,n)}return e=pi(e,ls(),1-ls()),Wr(rn(We(Yt(r,"float32"),Wi(e)),e.shape.length-1))})}function hy(r,e,t=!1){return at(()=>{const n=Yt(X0(oK(r)),"int32");e=pi(e,ls(),1-ls());const s=e.shape,o=Qe(c$(n,s[s.length-1]),s);return $f(o,e,t)})}function PK(r,e){if(!ur(r.shape,e.shape))throw new Ye(`logits and labels must have the same shape, but got shapes ${JSON.stringify(r.shape)} and ${JSON.stringify(e.shape)}`);return at(()=>{const t=Dl(e),n=Wr(bs(e));return Rt(sn(t,We(e,r)),Jw(Gi(n)))})}function o1(r,e){return at(()=>{let t;return t=pi(e,ls(),1-ls()),t=Wi(fn(t,sn(1,t))),Qr(PK(r,t),-1)})}function jK(r,e){return at(()=>{const t=pi(r,ls(),1),n=pi(e,ls(),1);return rn(We(r,Wi(fn(t,n))),-1)})}function BK(r,e){return at(()=>{const t=Wi(Rt(ls(),e));return Qr(sn(e,We(r,t)),-1)})}function sA(r,e){return at(()=>{const t=cy(r,-1),n=cy(e,-1),s=We(t,n);return Wr(rn(s,-1))})}const dy={meanSquaredError:s1,meanAbsoluteError:rS,meanAbsolutePercentageError:sS,meanSquaredLogarithmicError:DK,squaredHinge:OK,hinge:MK,categoricalHinge:FK,logcosh:LK,categoricalCrossentropy:$f,sparseCategoricalCrossentropy:hy,binaryCrossentropy:o1,kullbackLeiblerDivergence:jK,poisson:BK,cosineProximity:sA};function Gv(r){if(typeof r=="string"){if(r in dy)return dy[r];let e=`Unknown loss ${r}`;throw r.toLowerCase().includes("softmaxcrossentropy")&&(e=`Unknown loss ${r}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new Ye(e)}else return r}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function oA(r,e){return at(()=>{const t=We(.5,Hi(e)),n=nm(Ki(e,t),r.dtype);return Qr(Za(r,n),-1)})}function iA(r,e){return at(()=>nm(Za(If(r,-1),If(e,-1)),"float32"))}function UK(r,e){return at(()=>Yt(rn(El(Za(r,1),Za(e,1))),"float32"))}function zK(r,e){return at(()=>Yt(rn(El(Za(r,0),Za(e,1))),"float32"))}function VK(r,e){return at(()=>{const t=UK(r,e),n=zK(r,e),s=Rt(t,n);return Yt(zo(Ki(s,0),fn(t,s),0),"float32")})}function GK(r,e){return o1(r,e)}function WK(r,e){return r.rank===e.rank&&(r=Yp(r,[r.rank-1])),e=If(e,-1),e.dtype!==r.dtype&&(e=Yt(e,r.dtype)),Yt(Za(r,e),"float32")}const HK=s1,qK=s1,XK=rS,KK=rS,YK=sS,ZK=sS,aA=$f,QK=sA,lA=hy,fy={binaryAccuracy:oA,categoricalAccuracy:iA,precision:VK,categoricalCrossentropy:aA,sparseCategoricalCrossentropy:lA,mse:HK,MSE:qK,mae:XK,MAE:KK,mape:YK,MAPE:ZK,cosine:QK};function JK(r){if(typeof r=="string"&&r in fy)return fy[r];if(typeof r!="string"&&r!=null)return r;throw new Ye(`Unknown metric ${r}`)}function mg(r){if(Pa(r!==null,`Unknown LossOrMetricFn ${r}`),typeof r=="string")return r;{let e;for(const t of Object.keys(dy))if(dy[t]===r){e=t;break}if(e!==void 0)return e;for(const t of Object.keys(fy))if(fy[t]===r){e=t;break}return e!==void 0?e:r.name}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function eY(r){const e={Adagrad:()=>Sh.adagrad(.01),Adadelta:()=>Sh.adadelta(1,.95,ls()),Adam:()=>Sh.adam(.001,.9,.999,ls()),Adamax:()=>Sh.adamax(.002,.9,.999,ls(),0),RMSProp:()=>Sh.rmsprop(.001,.9,0,ls()),SGD:()=>Sh.sgd(.01)};if(e.adagrad=e.Adagrad,e.adadelta=e.Adadelta,e.adam=e.Adam,e.adamax=e.Adamax,e.rmsprop=e.RMSProp,e.sgd=e.SGD,r in e)return e[r]();throw new Ye(`Unknown Optimizer ${r}`)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const xI=1*1024*1024;function wI(r,e,t=!1){if(r==null||typeof r!="object"||Object.getPrototypeOf(r)!==Object.prototype||!Gb(r))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(t){const n=JSON.stringify(r);n.length>xI&&console.warn(`User-defined metadata of model "${e}" is too large in size (length=${n.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= ${xI}.`)}}function Gb(r){if(r===null)return!0;if(typeof r=="object")if(Object.getPrototypeOf(r)===Object.prototype){const e=Object.keys(r);for(const t of e)if(typeof t!="string"||!Gb(r[t]))return!1;return!0}else if(Array.isArray(r)){for(const e of r)if(!Gb(e))return!1;return!0}else return!1;else{const e=typeof r;return e==="string"||e==="number"||e==="boolean"}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function tY(r,e,t,n=console.log){const s=rY(r),o=["Layer (type)","Input Shape","Output shape","Param #"];s?(e=e||90,t=t||[.32,.61,.89,1]):(e=e||115,t=t||[.24,.48,.7,.8,1]),t[t.length-1]<=1&&(t=t.map(h=>Math.floor(e*h)));let a;if(!s){o.push("Receives inputs"),a=[];for(const h in r.nodesByDepth)a.push(...r.nodesByDepth[h])}n("_".repeat(e)),py(o,t,n),n("=".repeat(e));const i=r.layers;for(let h=0;h<i.length;++h)s?sY(i[h],t,n):oY(i[h],t,a,n),n((h===i.length-1?"=":"_").repeat(e));r.checkTrainableWeightsConsistency();const l=nY(r),u=ay(r.nonTrainableWeights);n(`Total params: ${l+u}`),n(`Trainable params: ${l}`),n(`Non-trainable params: ${u}`),n("_".repeat(e))}function nY(r){let e;return r.collectedTrainableWeights!=null?e=ay(r.collectedTrainableWeights):e=ay(r.trainableWeights),e}function rY(r){let e=!0;const t=[],n=[];for(const s in r.nodesByDepth)t.push(r.nodesByDepth[s]);for(const s of t){if(s.length>1||s.length===1&&s[0].inboundLayers.length>1){e=!1;break}n.push(...s)}if(e)for(const s of r.layers){let o=!1;for(const a of s.inboundNodes)if(n.indexOf(a)!==-1)if(o){e=!1;break}else o=!0;if(!e)break}return e}function py(r,e,t=console.log){let n="";for(let s=0;s<r.length;++s)s>0&&(n=n.slice(0,n.length-1)+" "),n+=r[s],n=n.slice(0,e[s]),n+=" ".repeat(e[s]-n.length);t(n)}function sY(r,e,t){let n,s;try{s=r.inboundNodes.map(l=>JSON.stringify(l.inputShapes)).join(",")}catch{s="multiple"}try{n=JSON.stringify(r.outputShape)}catch{n="multiple"}const o=r.name,a=r.getClassName(),i=[`${o} (${a})`,s,n,r.countParams().toString()];py(i,e,t)}function oY(r,e,t,n){let s,o;try{o=r.inboundNodes.map(d=>JSON.stringify(d.inputShapes)).join(",")}catch{o="multiple"}try{s=JSON.stringify(r.outputShape)}catch{s="multiple"}const a=[];for(const d of r.inboundNodes)if(!(t!=null&&t.length>0&&t.indexOf(d)===-1))for(let c=0;c<d.inboundLayers.length;++c){const f=d.inboundLayers[c].name,p=d.nodeIndices[c],m=d.tensorIndices[c];a.push(`${f}[${p}][${m}]`)}const i=r.name,l=r.getClassName(),u=a.length===0?"":a[0],h=[`${i} (${l})`,o,s,r.countParams().toString(),u];py(h,e,n);for(let d=1;d<a.length;++d)py(["","","","",a[d]],e,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function uA(r,e,t){return(r==="inboundNodes"||r==="outputLayers"||r==="inputLayers")&&e===0&&typeof t=="string"}function Wb(r,e){if(r===null)return null;if(typeof r=="string")return mc(r);if(typeof r=="number"||typeof r=="boolean")return r;if(r instanceof Array){const t=[],n=r.length;for(let s=0;s<n;++s){const o=r[s];uA(e,s,o)?t.push(o):t.push(Wb(o,e))}return t}else{const t={};for(const n of Object.keys(r)){const s=r[n];if(n==="name"&&typeof s=="string")t[n]=s;else{const o=mc(n);t[o]=Wb(s,o)}}return t}}function Hb(r,e){if(r==null)return null;if(typeof r=="string")return xl(r);if(typeof r=="number"||typeof r=="boolean")return r;if(r instanceof Array){const t=[],n=r.length;for(let s=0;s<n;++s){const o=r[s];uA(e,s,o)?t.push(o):t.push(Hb(o,e))}return t}else{const t={};for(const n of Object.keys(r)){const s=r[n],o=xl(n);(n==="name"||n==="className")&&typeof s=="string"?t[o]=s:t[o]=Hb(s,n)}return t}}/** @license See the LICENSE file. */const cA="3.21.0";/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class oa extends rr{constructor(e){if(super({}),this.containerNodes=new Set,this.name=e.name,this.name==null){const v=this.getClassName().toLowerCase();this.name=t1(v)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(e.inputs)?this.inputs=e.inputs.slice():this.inputs=[e.inputs],Array.isArray(e.outputs)?this.outputs=e.outputs.slice():this.outputs=[e.outputs],hu(this.inputs).length!==this.inputs.length)throw new Ye(`The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ${this.inputs.map(v=>v.name)}`);hu(this.outputs).length!==this.outputs.length&&console.warn(`The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ${this.outputs.map(v=>v.name)}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const v of this.outputs){const b=v.sourceLayer,w=v.nodeIndex,_=v.tensorIndex;this.outputLayers.push(b),this.outputLayersNodeIndices.push(w),this.outputLayersTensorIndices.push(_)}for(const v of this.inputs){const b=v.sourceLayer,w=v.nodeIndex,_=v.tensorIndex;Pa(w===0,"input layer has >1 nodes"),Pa(_===0,"input layer has >1 tensors"),this.inputLayers.push(b),this.inputLayersNodeIndices.push(w),this.inputLayersTensorIndices.push(_)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let v=0;v<this.inputLayers.length;v++){const b=this.inputLayers[v];if(!(b instanceof im))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${e.inputs}. Input ${v} (0-based) originates from layer type ${b.getClassName()}.`);this.inputNames.push(b.name),this.feedInputShapes.push(b.batchInputShape),this.feedInputNames.push(b.name)}for(const v of this.outputLayers)this.outputNames.push(v.name);this.internalInputShapes=this.inputs.map(v=>v.shape),this.internalOutputShapes=this.outputs.map(v=>v.shape);const t={},n={},s={},o={},a={},i=[],l=(v,b,w,_,I,C)=>{(_==null||I==null||C==null)&&(_=v.sourceLayer,I=v.nodeIndex,C=v.tensorIndex);const N=_.inboundNodes[I];if(w.indexOf(N)!==-1)throw new ji(`The tensor ${v.name} at layer "${_.name}" is part of a cycle.`);if(b.indexOf(N)!==-1)return;this.containerNodes.add(oa.nodeKey(_,I)),_.id in a||(a[_.id]=Object.keys(a).length),w.indexOf(N)===-1&&w.push(N);const O=N.inboundLayers.length;for(let D=0;D<O;D++){const M=N.inputTensors[D],P=N.inboundLayers[D],F=N.nodeIndices[D],B=N.tensorIndices[D];l(M,b,w,P,F,B)}for(b.push(N);w.indexOf(N)>=0;)w.splice(w.indexOf(N),1);i.push(N)},u=[],h=[];for(const v of this.outputs)l(v,u,h);const d=i.slice().reverse();for(const v of d){n[v.id]=v,v.id in t||(t[v.id]=0);let b=t[v.id];const w=s[v.outboundLayer.id]==null?0:s[v.outboundLayer.id];b=Math.max(b,w),s[v.outboundLayer.id]=b,o[v.outboundLayer.id]=v.outboundLayer,t[v.id]=b;for(let _=0;_<v.inboundLayers.length;_++){const I=v.inboundLayers[_],C=v.nodeIndices[_],N=I.inboundNodes[C],O=t[N.id]==null?0:t[N.id];t[N.id]=Math.max(b+1,O),n[N.id]=N}}const c={};for(const v in t){const b=t[v];b in c||(c[b]=[]),c[b].push(n[v])}const f={};for(const v in s){const b=s[v];b in f||(f[b]=[]),f[b].push(o[v])}let p=Object.keys(f).map(v=>parseInt(v,10)).sort(dg);this.layers=[];for(const v of p){const b=f[v];b.sort((w,_)=>{const I=a[w.id],C=a[_.id];return I<C?-1:I>C?1:0});for(const w of b)w instanceof oa&&this.internalContainerRefs.push(w),this.layers.push(w)}this.layersByDepth=f,p=Object.keys(c).map(v=>parseInt(v,10)).sort(dg);const m=this.inputs.slice(),g=[];for(const v of p)for(const b of c[v]){const w=b.outboundLayer;if(w!=null){for(const _ of b.inputTensors)if(m.indexOf(_)===-1)throw new ji(`Graph disconnected: cannot obtain value for tensor ${_} at layer "${w.name}". The following previous layers were accessed without issue: ${g}`);for(const _ of b.outputTensors)m.push(_);g.push(w.name)}}this.nodesByDepth=c;const y=this.layers.map(v=>v.name);for(const v of y){const b=y.filter(w=>w===v).length;if(b!==1)throw new ji(`The name "${v}" is used ${b} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(y))}this.outboundNodes=[],this.inboundNodes=[],new r1({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(v=>null),outputMasks:this.outputs.map(v=>null),inputShapes:this.inputs.map(v=>v.shape),outputShapes:this.outputs.map(v=>v.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(this._refCount===0)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();const e={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount===0){for(const t of this.layers)e.numDisposedVariables+=t.dispose().numDisposedVariables;for(const t of this.internalContainerRefs)e.numDisposedVariables+=t.dispose().numDisposedVariables}return e.refCountAfterDispose=this._refCount,e}get trainable(){return this.trainable_}set trainable(e){this.layers.forEach(t=>{t._trainableWeights.forEach(n=>n.trainable=e)}),this.trainable_=e}get trainableWeights(){if(this._trainableWeights.length>0)throw new Ye("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let e=[];for(const t of this.layers)e=e.concat(t.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const t of this.layers)e.push(...t.nonTrainableWeights);if(!this.trainable){const t=[];for(const n of this.layers)t.push(...n.trainableWeights);return t.concat(e)}return e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(e,t=!0){const n={};let s=0;for(const a of this.layers)for(const i of a.weights){if(n[i.originalName]!=null)throw new Ye(`Duplicate weight name: ${i.originalName}`);n[i.originalName]=i,s++}const o=[];for(const a in e){let i=a;if(n[a]==null){const l=a.split("/");i=l.slice(0,-2).concat([l[l.length-1]]).join("/")}if(n[i]!=null)o.push([n[i],e[a]]);else if(t)throw new Ye(`Provided weight data has no target variable: ${a}`);delete n[i]}if(t){const a=[];for(const i in n)a.push(i);if(a.length>0)throw new Ye(`${a.length} of ${s} weights are not set: ${a}`)}tS(o)}updatedConfig(){const e=this.getConfig(),t={};return t.className=this.getClassName(),t.config=e,t.kerasVersion=`tfjs-layers ${cA}`,t.backend="TensorFlow.js",t}toJSON(e,t=!0){const n=Hb(this.updatedConfig());return t?JSON.stringify(n):n}call(e,t){return at(()=>{e=Mr(e);const n=new ou;for(let s=0;s<this.inputs.length;++s)n.add(this.inputs[s],e[s]);return uf(this.outputs,n,t)})}computeMask(e,t){return at(()=>{e=Mr(e);let n;return t==null?n=jc(null,e.length):n=Mr(t),this.runInternalGraph(e,n)[1]})}computeOutputShape(e){const t=iy(e);if(t.length!==this.inputLayers.length)throw new Ye(`Invalid inputShape argument ${e}: model has ${this.inputLayers.length} tensor inputs.`);const n={};for(let i=0;i<t.length;i++){const l=this.inputLayers[i],u=t[i],h=l.name+"_0_0";n[h]=u}const s=Object.keys(this.nodesByDepth).map(i=>parseInt(i,10)).sort(dg);if(s.length>1)for(const i of s){const l=this.nodesByDepth[i];for(const u of l){const h=u.outboundLayer;if(this.inputLayers.map(m=>m.id).indexOf(h.id)!==-1)continue;const d=[];for(let m=0;m<u.inboundLayers.length;m++){const g=u.inboundLayers[m],y=u.nodeIndices[m],v=u.tensorIndices[m],b=`${g.name}_${y}_${v}`,w=n[b];d.push(w)}const c=h.computeOutputShape(vo(d)),f=iy(c),p=h.inboundNodes.indexOf(u);for(let m=0;m<f.length;m++){const g=`${h.name}_${p}_${m}`;n[g]=f[m]}}}const o=[],a=[];for(let i=0;i<this.outputLayers.length;i++){const l=this.outputLayers[i],u=this.outputLayersNodeIndices[i],h=this.outputLayersTensorIndices[i],d=`${l.name}_${u}_${h}`;a.push(d)}for(let i=0;i<a.length;i++){const l=a[i];Pa(l in n),o.push(n[l])}return vo(o)}runInternalGraph(e,t){t==null&&(t=jc(null,e.length));const n={};for(let l=0;l<this.inputs.length;++l){const u=this.inputs[l],h=e[l],d=t[l];n[u.id]=[h,d]}const s=Object.keys(this.nodesByDepth).map(l=>parseInt(l,10)).sort(dg);for(const l of s){const u=this.nodesByDepth[l];for(const h of u){const d=h.outboundLayer,c=h.inputTensors,f=h.outputTensors,p=new Array;for(const m of c)m.id in n&&p.push(n[m.id]);if(p.length===c.length){let m={},g,y,v,b;if(h.callArgs!=null&&(m=h.callArgs),p.length===1){const[w,_]=p[0];m.mask==null&&(m.mask=_),v=Mr(d.call(w,m)),b=Mr(d.computeMask(w,_)),g=[w],y=[_]}else g=p.map(w=>w[0]),y=p.map(w=>w[1]),m.mask==null&&(m.mask=y),v=Mr(d.call(g,m)),b=Mr(d.computeMask(g,y));if(d.activityRegularizer)throw new On("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let w=0;w<f.length;++w){const _=f[w],I=v[w],C=b[w];n[_.id]=[I,C]}}}}const o=[],a=[],i=[];for(const l of this.outputs){Pa(l.id in n,`Could not compute output ${l.name} : ${l.id}`);const[u,h]=n[l.id];i.push(u.shape),o.push(u),a.push(h)}return[o,a,i]}buildNodeConversionMap(e){const t={};let n;for(const s of this.layers){n=s instanceof oa?1:0;for(let o=0;o<s.inboundNodes.length;o++){const a=oa.nodeKey(s,o);this.containerNodes.has(a)&&(t[a]=n,n+=1)}}return t}getLayer(e,t){if(t!=null){if(this.layers.length<=t)throw new Ye(`Was asked to retrieve layer at index ${t}, but model only has ${this.layers.length} layer(s).`);return this.layers[t]}else if(e==null)throw new Ye("Provide either a layer name or layer index");for(const n of this.layers)if(n.name===e)return n;throw new Ye(`No such layer: ${e}`)}calculateLosses(){return at(()=>{const e=[];for(const t of this.layers)for(let n=0;n<t.inboundNodes.length;++n){const s=oa.nodeKey(t,n);this.containerNodes.has(s)&&e.push(...t.calculateLosses())}return e})}getConfig(){const e={name:this.name},t=this.buildNodeConversionMap(this.layers),n=[];for(const a of this.layers){const i=a.getClassName(),l=a.getConfig(),u=[];for(let d=0;d<a.inboundNodes.length;d++){const c=a.inboundNodes[d],f=oa.nodeKey(a,d);let p={};if(this.containerNodes.has(f)){if(c.callArgs)try{JSON.stringify(c.callArgs),p=c.callArgs}catch{console.warn(`Layer ${a.name} was passed non-serializable keyword arguments: ${c.callArgs}. They will not be included in the serialized model (and thus will be missing at deserialization time).`),p={}}if(c.inboundLayers.length>0){const m=[];for(let g=0;g<c.inboundLayers.length;g++){const y=c.inboundLayers[g],v=c.nodeIndices[g],b=c.tensorIndices[g],w=oa.nodeKey(y,v);let _=t[w];_==null&&(_=0),m.push([y.name,_,b,p])}u.push(m)}}}const h={};h.name=a.name,h.className=i,h.config=l,h.inboundNodes=u,n.push(h)}e.layers=n;const s=[];for(let a=0;a<this.inputLayers.length;a++){const i=this.inputLayers[a],l=this.inputLayersNodeIndices[a],u=oa.nodeKey(i,l);if(!this.containerNodes.has(u))continue;let h=t[u];h==null&&(h=0);const d=this.inputLayersTensorIndices[a];s.push([i.name,h,d])}e.inputLayers=s;const o=[];for(let a=0;a<this.outputLayers.length;a++){const i=this.outputLayers[a],l=this.outputLayersNodeIndices[a],u=oa.nodeKey(i,l);if(!this.containerNodes.has(u))continue;let h=t[u];h==null&&(h=0);const d=this.outputLayersTensorIndices[a];o.push([i.name,h,d])}return e.outputLayers=o,e}static fromConfig(e,t,n={},s=!1){const o={},a={};function i(g,y){g.name in a?a[g.name].push(y):a[g.name]=[y]}function l(g,y){const v=[];let b;for(const w of y){const _=w[0],I=w[1],C=w[2];if(b=w[3]==null?{}:w[3],!(_ in o)){i(g,y);return}const N=o[_];if(N.inboundNodes.length<=I){i(g,y);return}const O=N.inboundNodes[I];v.push(O.outputTensors[C])}v.length>0&&g.apply(vo(v),b)}function u(g){const y=g.name,v=kl(g,t.customObjects!=null?t.customObjects:{});v.setFastWeightInitDuringBuild(s),o[y]=v,g.inboundNodes.forEach(w=>{if(!(w instanceof Array))throw new Ye(`Corrupted configuration, expected array for nodeData: ${w}`);i(v,w)})}const h=t.name,d=t.layers;for(const g of d)u(g);for(;!HX(a);)for(const g of d){const y=o[g.name];if(y.name in a){const v=a[y.name];delete a[y.name];for(const b of v)l(y,b)}}const c=[],f=[],p=t.inputLayers;for(const g of p){const y=g[0],v=g[1],b=g[2];Pa(y in o);const _=o[y].inboundNodes[v].outputTensors;c.push(_[b])}const m=t.outputLayers;for(const g of m){const y=g[0],v=g[1],b=g[2];Pa(y in o);const _=o[y].inboundNodes[v].outputTensors;f.push(_[b])}return new e({inputs:c,outputs:f,name:h})}get stateful(){if(this._stateful)throw new Ye("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const e of this.layers)if(e.stateful)return!0;return!1}resetStates(){at(()=>{this.layers.forEach(e=>{e.stateful&&e.resetStates()})})}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function iY(r,e,t){const n=e.length;if(r==null||Array.isArray(r)&&r.length===0)return e.map(s=>null);if(n===1)return Array.isArray(r)&&r.length===1?r:typeof r=="object"&&e[0]in r?[r[e[0]]]:[r];if(Array.isArray(r)){if(r.length!==n)throw new Error(`Provided ${t} is an array of ${r.length} element(s), but the model has ${n} outputs. Make sure a set of weights is provided for each model output.`);return r}else if(typeof r=="object"&&Object.keys(r).length>0&&typeof r[Object.keys(r)[0]]=="object"){const s=[];return e.forEach(o=>{o in r?s.push(r[o]):s.push(null)}),s}else throw new Error(`The model has multiple (${n}) outputs, so ${t} must be either an array with ${n} elements or an object with ${e} keys. Provided ${t} not understood: ${JSON.stringify(r)}`)}function hA(r,e){return iY(r,e,"classWeight")}async function dA(r,e,t,n){if(e!=null||n!=null)throw new Error("Support sampleWeight is not implemented yet");if(t!=null){const s=at(()=>{if(r.shape.length===1)return Sc(r);if(r.shape.length===2){if(r.shape[1]>1)return If(r,1);if(r.shape[1]===1)return Qe(r,[r.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${r.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}else throw new Error(`Unexpected rank of target (y) tensor (${r.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)}),o=Array.from(await s.data());Kn(s);const a=[];return o.forEach(i=>{if(t[i]==null)throw new Error(`classWeight must contain all classes in the training data. The class ${i} exists in the data but not in classWeight`);a.push(t[i])}),Po(a,"float32")}else return null}function aY(r,e){return We(r,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const lY=32;function fA(r,e){let t,n;const s=e;t=s.xs,n=s.ys,xe(t!=null&&n!=null,()=>`A Dataset iterator for fitDataset() is expected to generate objects of the form \`{xs: xVal, ys: yVal}\`, where the two values may be \`tf.Tensor\`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ${e}`);const o=SI("input",r.inputNames,t),a=SI("output",r.outputNames,n),i=o[0].shape[0];xe(o.length===r.inputs.length,()=>`LayersModel has ${r.inputs.length} inputs, but the dataset provides ${o.length} inputs.  (Expected input keys: ${JSON.stringify(r.inputNames)})`),xe(a.length===r.outputs.length,()=>`LayersModel has ${r.outputs.length} outputs, but the dataset provides ${a.length} outputs.  (Expected output keys: ${JSON.stringify(r.outputNames)})`);for(let l=0;l<o.length;l++)xe(o[l].shape[0]===i,()=>`Batch size mismatch: input ${r.inputNames[l]} has ${o[l].shape[0]}; expected  ${i} based on input ${r.inputNames[0]}.`);for(let l=0;l<a.length;l++)xe(a[l].shape[0]===i,()=>`Batch size mismatch: output ${r.outputNames[l]} has ${a[l].shape[0]}; expected  ${i} based on input ${r.inputNames[0]}.`);return{xs:o,ys:a}}function SI(r,e,t){if(t instanceof os)return[t];if(Array.isArray(t))return xe(t.length===e.length,()=>`Received an array of ${t.length} Tensors, but expected ${e.length} to match the ${r} keys ${e}.`),t;{const n=[];for(const s of e){if(t[s]==null)throw new Ye(`The feature data generated by the dataset lacks the required ${r} key '${s}'.`);n.push(t[s])}return n}}function uY(r){if(r.length===3)throw new On("Validation with sample weights is not implemented yet.");return{xs:r[0],ys:r[1]}}async function cY(r,e,t){const n=t.batchesPerEpoch!=null;if(xe(r.optimizer!=null,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),xe(t!=null,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),xe(t.epochs!=null&&t.epochs>0&&Number.isInteger(t.epochs),()=>`For fitDataset(), config.epochs is expected to be a positive integer, but got ${t.epochs}`),xe(!n||t.batchesPerEpoch>0&&Number.isInteger(t.batchesPerEpoch),()=>`For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ${t.batchesPerEpoch}`),xe(t.validationSplit==null,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),r.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");r.isTraining=!0;try{const s=t.validationData!=null;let o,a;if(s)if(_I(t.validationData))xe(t.validationBatches==null||t.validationBatches>0&&Number.isInteger(t.validationBatches),()=>`For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ${t.validationBatches}`);else{const g=uY(t.validationData);o=g.xs,a=g.ys}const i=r.makeTrainFunction(),l=r.getDedupedMetricsNames();let u;s?u=l.slice().concat(l.map(g=>"val_"+g)):u=l.slice();const h=nA(t.callbacks,t.yieldEvery),d=t.verbose==null?1:t.verbose,{callbackList:c,history:f}=rA(h,d,t.epochs,null,null,hY(e,t),null,s,u);c.setModel(r),r.history=f,await c.onTrainBegin(),r.stopTraining_=!1;let p=t.initialEpoch==null?0:t.initialEpoch,m=await e.iterator();for(;p<t.epochs;){const g={};await c.onEpochBegin(p);let y=0,v=0;for(n||(m=await e.iterator());!n||y<t.batchesPerEpoch;){const b=await m.next();if(n&&b.done){console.warn(`You provided \`batchesPerEpoch\` as ${t.batchesPerEpoch}, but your dataset iterator ran out of data after ${y} batches; interrupting training. Make sure that your dataset can generate at least \`batchesPerEpoch * epochs\` batches (in this case, ${t.batchesPerEpoch*t.epochs} batches). You may need to use the repeat() function when building your dataset.`);break}if(b.value!=null){const{xs:w,ys:_}=fA(r,b.value),I={};I.batch=v,I.size=w[0].shape[0],await c.onBatchBegin(v,I);const C=[];if(t.classWeight!=null){const D=hA(t.classWeight,r.outputNames);for(let M=0;M<D.length;++M)C.push(await dA(_[M],null,D[M]))}const N=w.concat(_).concat(C),O=i(N);Kn(N);for(let D=0;D<l.length;++D){const M=l[D],P=O[D];I[M]=P,Ya(P)}await c.onBatchEnd(v,I),tA(I),v++,y++}if(n?y>=t.batchesPerEpoch:b.done){if(s){let w;_I(t.validationData)?w=Mr(await r.evaluateDataset(t.validationData,{batches:t.validationBatches})):w=Mr(r.evaluate(o,a,{batchSize:t.validationBatchSize==null?lY:t.validationBatchSize,verbose:0}));for(let _=0;_<r.metricsNames.length;++_)g[`val_${r.metricsNames[_]}`]=w[_]}break}if(r.stopTraining_)break}if(await c.onEpochEnd(p,g),p++,r.stopTraining_)break}return await c.onTrainEnd(),await r.history.syncData(),r.history}finally{r.isTraining=!1}}function hY(r,e){let t=null;return e.batchesPerEpoch!=null?t=e.batchesPerEpoch:Number.isFinite(r.size)&&(t=r.size),t}function _I(r){return typeof r.iterator=="function"}function dY(r){return typeof r.next=="function"}async function fY(r,e,t){t=t||{};const n=t.batches!=null,s=r.testFunction;let o=[];if(t.verbose>0)throw new On("Verbose mode is not implemented yet.");xe(!n||t.batches>0&&Number.isInteger(t.batches),()=>`Test loop expects \`batches\` to be a positive integer, but received ${JSON.stringify(t.batches)}`);const a=dY(e)?e:await e.iterator();let i=0,l=0;for(;!n||l<t.batches;){const u=await a.next();if(o=at(()=>{if(u.value){const{xs:h,ys:d}=fA(r,u.value),c=h.concat(d),f=at(()=>s(c));if(Kn(c),l===0)for(let m=0;m<f.length;++m)o.push(An(0));const p=c[0].shape[0];for(let m=0;m<f.length;++m){const g=f[m],y=o[m];o[m]=at(()=>Rt(o[m],We(p,g))),l>0&&Kn(y)}Kn(f),i+=p,++l}return o}),u.done){n&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${t.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let u=0;u<o.length;++u){const h=o[u];o[u]=fn(o[u],i),Kn(h)}return vo(o)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function qb(r){xe(r>0&&Number.isInteger(r),()=>`batchSize is required to be a positive integer, but got ${r}`)}function cf(r,e,t){return r==null?[null]:Array.isArray(r)?r.map(n=>kc(n,e,t-e)):kc(r,e,t-e)}function oS(r,e){return at(()=>r==null?null:Array.isArray(r)?r.map(t=>oS(t,e)):UN(r,e.dtype==="int32"?e:Yt(e,"int32")))}function Xb(r,e){const t=[];let n=0,s=null;for(;n<r;)s=n+e,s>=r&&(s=r),t.push([n,s]),n=s;return t}async function pY(r,e,t,n,s,o,a,i,l,u,h,d,c,f,p){s==null&&(s=32),o==null&&(o=1),h==null&&(h=!0),c==null&&(c=0);let m=!1;if(l!=null&&u!=null&&(m=!0),p!=null&&(m=!0,f==null))throw new Ye("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");const g=r.checkNumSamples(t,s,f,"steps_per_epoch");let y;g!=null&&(y=ma(0,g)),a==null&&(a=1);const{callbackList:v,history:b}=rA(i,a,o,c,g,f,s,m,d);v.setModel(r),r.history=b,await v.onTrainBegin(),r.stopTraining_=!1;for(let w=c;w<o;++w){await v.onEpochBegin(w);const _={};if(f!=null)throw new On("stepsPerEpoch mode is not implemented yet.");{if(h==="batch")throw new On("batch shuffling is not implemneted yet");h&&W6(y);const I=Po(y),C=Xb(g,s);for(let N=0;N<C.length;++N){const O={};if(await v.onBatchBegin(N,O),at(()=>{const D=C[N][0],M=C[N][1],P=kc(I,D,M-D);O.batch=N,O.size=M-D;const F=oS(t,P),B=e(F);for(let z=0;z<n.length;++z){const Z=n[z],Q=B[z];O[Z]=Q,Ya(Q)}if(N===C.length-1&&m){const z=r.testLoop(l,u,s);for(let Z=0;Z<n.length;++Z){const Q=n[Z],K=z[Z];Ya(K),_["val_"+Q]=K}}}),await v.onBatchEnd(N,O),tA(O),r.stopTraining_)break}I.dispose()}if(await v.onEpochEnd(w,_),r.stopTraining_)break}return await v.onTrainEnd(),await r.history.syncData(),r.history}async function mY(r,e,t,n={}){if(r.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");r.isTraining=!0;let s,o,a,i,l,u,h,d,c;try{const f=n.batchSize==null?32:n.batchSize;qb(f);const p=!1,m=await r.standardizeUserData(e,t,n.sampleWeight,n.classWeight,p,f);s=m[0],o=m[1],c=m[2];let g=!1,y;if(n.validationData!=null&&n.validationData.length>0){if(g=!0,n.validationData.length===2)l=n.validationData[0],u=n.validationData[1];else throw n.validationData.length===3?new On("validationData including sample weights is not supported yet."):new Ye(`When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ${n.validationData} is invalid.`);const O=!0,D=await r.standardizeUserData(l,u,null,null,O,f);h=D[0],d=D[1],y=h.concat(d)}else if(n.validationSplit!=null&&n.validationSplit>0&&n.validationSplit<1){g=!0;const O=Math.floor(s[0].shape[0]*(1-n.validationSplit)),D=s[0].shape[0];h=cf(s,O,D),a=s,s=cf(s,0,O),d=cf(o,O,D),i=o,o=cf(o,0,O),y=h.concat(d)}else n.validationSteps!=null&&(g=!0);const v=s.concat(o).concat(c);r.checkTrainableWeightsConsistency();const b=r.makeTrainFunction(),w=r.getDedupedMetricsNames();let _,I;g?(r.makeTestFunction(),_=r.testFunction,I=w.slice().concat(w.map(O=>"val_"+O))):(_=null,y=[],I=w.slice());const C=nA(n.callbacks,n.yieldEvery);return await pY(r,b,v,w,f,n.epochs,n.verbose,C,_,y,n.shuffle,I,n.initialEpoch,null,null)}finally{r.isTraining=!1,la(s,e),la(o,t),la(a,e),la(i,t),la(h,l),la(d,u),c!=null&&Kn(c)}}function pA(r){const e=[];r instanceof os&&(r=[r]);for(let t=0;t<r.length;++t){const n=r[t];if(n.rank===1)e.push(rm(n,1));else{if(n.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");e.push(n)}}return e}function la(r,e){if(r==null)return;const t=[];if(e instanceof os)t.push(e.id);else if(Array.isArray(e))e.forEach(s=>t.push(s.id));else if(e!=null)for(const s in e){const o=e[s];t.push(o.id)}const n=[];if(r instanceof os)t.indexOf(r.id)===-1&&n.push(r);else if(Array.isArray(r))r.forEach(s=>{t.indexOf(s.id)===-1&&n.push(s)});else if(r!=null)for(const s in r){const o=r[s];t.indexOf(o.id)===-1&&n.push(o)}n.forEach(s=>{s.isDisposed||s.dispose()})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function gY(r){return r instanceof os}function Kb(r){return Array.isArray(r)}function TI(r){return!gY(r)&&!Kb(r)}function kI(r,e,t,n=!0,s=""){if(e==null||e.length===0){if(r!=null){let a=!1;if(Kb(r)&&r.length>0)a=!0;else if(TI(r)){for(const i in r)if(r.hasOwnProperty(i)){a=!0;break}}else a=!0;if(a)throw new Ye(`Error when checking model ${s} expected no data, but got ${r}`)}return[]}if(r==null)return e.map(a=>null);let o;if(TI(r)){r=r,o=[];for(const a of e){if(r[a]==null)throw new Ye(`No data provided for "${a}". Need data for each key in: ${e}`);o.push(r[a])}}else if(Kb(r)){if(r=r,r.length!==e.length)throw new Ye(`Error when checking model ${s}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${e.length} Tensor(s), but instead got the following list of Tensor(s): ${r}`);o=r}else{if(r=r,e.length>1)throw new Ye(`The model ${s} expects ${e.length} Tensor(s), but only received one Tensor. Found: Tensor with shape ${r.shape}`);o=[r]}if(o=pA(o),t!=null)for(let a=0;a<e.length;++a){if(t[a]==null)continue;const i=o[a];if(i.shape.length!==t[a].length)throw new Ye(`Error when checking ${s}: expected ${e[a]} to have ${t[a].length} dimension(s). but got array with shape ${i.shape}`);for(let l=0;l<t[a].length;++l){if(l===0&&!n)continue;const u=i.shape[l],h=t[a][l];if(h!=null&&h>=0&&u!==h)throw new Ye(`${s} expected a batch of elements where each example has shape [${t[a].slice(1,t[a].length)}] (i.e.,tensor shape [*,${t[a].slice(1,t[a].length)}]) but the ${s} received an input with ${i.shape[0]} examples, each with shape [${i.shape.slice(1,i.shape.length)}] (tensor shape [${i.shape}])`)}}return o}function yY(r,e,t){const n=hu(r.map(o=>o.shape[0]));n.sort();const s=hu(e.map(o=>o.shape[0]));if(s.sort(),n.length>1)throw new Ye(`All input Tensors (x) should have the same number of samples. Got array shapes: ${JSON.stringify(r.map(o=>o.shape))}`);if(s.length>1)throw new Ye(`All target Tensors (y) should have the same number of samples. Got array shapes: ${JSON.stringify(e.map(o=>o.shape))}`);if(n.length>0&&s.length>0&&!ur(n,s))throw new Ye(`Input Tensors should have the same number of samples as target Tensors. Found ${n[0]} input sample(s) and ${s[0]} target sample(s).`)}function vY(r,e,t){const n=[s1,o1,$f];for(let s=0;s<r.length;++s){const o=r[s],a=e[s],i=t[s];if(a!=null){if(a===$f&&o.shape[o.shape.length-1]===1)throw new Ye(`You are passing a target array of shape ${o.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(n.indexOf(a)!==-1){const l=o.shape.slice(1),u=i.slice(1);for(let h=0;h<l.length;++h){const d=l[h],c=u[h];if(c!=null&&d!==c)throw new Ye(`A target Tensor with shape ${o.shape} was passed for an output of shape ${i}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}function II(r,e,t,n=!0,s=""){let o;if(Array.isArray(r)){if(r.length!==e.length)throw new Ye(`Error when checking model ${s}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${e.length} Tensor(s), but instead got ${r.length} Tensors(s).`);o=r}else{if(e.length>1)throw new Ye(`The model expects ${e.length} ${s} Tensors, but only received one Tensor. Found: array with shape ${JSON.stringify(r.shape)}.`);o=[r]}if(t!=null)for(let a=0;a<e.length;++a){if(t[a]==null)continue;const i=o[a];if(i.shape.length!==t[a].length)throw new Ye(`Error when checking ${s}: expected ${e[a]} to have ${t[a].length} dimension(s), but got array with shape ${JSON.stringify(i.shape)}`);for(let l=0;l<t[a].length;++l){if(l===0&&!n)continue;const u=i.shape[l],h=t[a][l];if(h!=null&&h!==u)throw new Ye(`Error when checking ${s}: expected ${e[a]} to have shape ${JSON.stringify(t[a])} but got array with shape ${JSON.stringify(i.shape)}.`)}}}function bY(r,e){if(r==null||Array.isArray(r)&&r.length===0)return e.map(n=>[]);let t;if(typeof r=="string"||typeof r=="function")t=[r];else if(Array.isArray(r)||typeof r=="object")t=r;else throw new TypeError(`Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ${r}`);if(Array.isArray(t))return e.map(n=>t);{const n=[];for(const s of e){let o=t.hasOwnProperty(s)?t[s]:[];Array.isArray(o)||(o=[o]),n.push(o)}return n}}const xY="layers-model";class zh extends oa{constructor(e){super(e),this.isTraining=!1}summary(e,t,n=console.log){if(!this.built)throw new Ye("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");tY(this,e,t,n)}compile(e){if(e.loss==null&&(e.loss=[]),this.loss=e.loss,typeof e.optimizer=="string")this.optimizer_=eY(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof Au))throw new Ye("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}let t=[];if(!Array.isArray(e.loss)&&typeof e.loss!="string"&&typeof e.loss!="function"){e.loss=e.loss;for(const a in e.loss)if(this.outputNames.indexOf(a)===-1)throw new Ye(`Unknown entry in loss dictionary: "${a}". Only expected the following keys: ${this.outputNames}`);for(const a of this.outputNames)e.loss[a]==null&&console.warn(`Output "${a}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${a} during training`),t.push(Gv(e.loss[a]))}else if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new Ye(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${e.loss}.`);t=e.loss.map(i=>Gv(i))}else{const a=Gv(e.loss);this.outputs.forEach(i=>{t.push(a)})}this.lossFunctions=t,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let a=0;a<this.outputs.length;++a){const i=this.internalOutputShapes[a],l=this.outputNames[a];this.feedOutputNames.push(l),this.feedOutputShapes.push(i),this.feedLossFns.push(this.lossFunctions[a])}const n=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],Tc("loss",()=>{for(let a=0;a<this.outputs.length;++a){if(n.indexOf(a)!==-1)continue;const i=this.lossFunctions[a];this.outputs.length>1&&(this.metricsTensors.push([i,a]),this.metricsNames.push(this.outputNames[a]+"_loss"))}});const s=bY(e.metrics,this.outputNames),o=(a,i,l)=>{this.outputNames.length>1&&(i=this.outputNames[a]+"_"+i),this.metricsNames.push(i),this.metricsTensors.push([l,a])};Tc("metric",()=>{for(let a=0;a<this.outputs.length;++a){if(n.indexOf(a)!==-1)continue;const i=s[a];(u=>{const h="";let d,c,f;for(const p of u){if(typeof p=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(p)!==-1){const g=this.internalOutputShapes[a];g[g.length-1]===1||this.lossFunctions[a]===o1?["accuracy","acc"].indexOf(p)!==-1?c=oA:["crossentropy","ce"].indexOf(p)!==-1&&(c=GK):this.lossFunctions[a]===hy?["accuracy","acc"].indexOf(p)!==-1?c=WK:["crossentropy","ce"].indexOf(p)!==-1&&(c=lA):["accuracy","acc"].indexOf(p)!==-1?c=iA:["crossentropy","ce"].indexOf(p)!==-1&&(c=aA);let y;["accuracy","acc"].indexOf(p)!==-1?y="acc":["crossentropy","ce"].indexOf(p)!==-1&&(y="ce"),f=c,d=h+y}else f=JK(p),d=h+mg(p);let m;Tc(d,()=>{m=f}),o(a,d,m)}})(i)}}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(e,t,n={}){const s=n.batchSize==null?32:n.batchSize;qb(s);const o=!0,a=this.standardizeUserDataXY(e,t,o,s);try{const i=a[0].concat(a[1]);this.makeTestFunction();const l=this.testFunction,u=this.testLoop(l,i,s,n.verbose,n.steps);return vo(u)}finally{la(a[0],e),la(a[1],t)}}async evaluateDataset(e,t){return this.makeTestFunction(),fY(this,e,t)}checkNumSamples(e,t,n,s="steps"){let o;if(n!=null){if(o=null,t!=null)throw new Ye(`If ${s} is set, batchSize must be null or undefined.Got batchSize = ${t}`)}else if(e!=null)Array.isArray(e)?o=e[0].shape[0]:o=e.shape[0];else throw new Ye(`Either the input data should have a defined shape, or ${s} shoud be specified.`);return o}execute(e,t){if(Array.isArray(t)&&t.length===0)throw new Ye("`outputs` is an empty Array, which is not allowed.");const n=Array.isArray(t),s=n?t:[t],o=this.retrieveSymbolicTensors(s),a=new ou;if(e instanceof os&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new Ye(`The number of inputs provided (${e.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let l=0;l<this.inputs.length;++l)a.add(this.inputs[l],e[l])}else for(const l of this.inputs){const u=e[l.name];if(u==null)throw new Ye(`No value is provided for the model's input ${l.name}`);a.add(l,u)}const i=uf(o,a);return n?i:i[0]}retrieveSymbolicTensors(e){const t=jc(null,e.length);let n=e.length;for(const s of this.layers){const o=Array.isArray(s.output)?s.output:[s.output],a=o.map(i=>i.name);for(let i=0;i<e.length;++i){const l=a.indexOf(e[i]);if(l!==-1&&(t[i]=o[l],n--),n===0)break}if(n===0)break}if(n>0){const s=[];throw t.forEach((o,a)=>{o==null&&s.push(e[a])}),new Ye(`Cannot find SymbolicTensors for output name(s): ${JSON.stringify(s)}`)}return t}predictLoop(e,t=32,n=!1){return at(()=>{const s=this.checkNumSamples(e);if(n)throw new On("Verbose predictLoop() is not implemented yet.");const o=Xb(s,t),a=this.outputs.map(i=>[]);for(let i=0;i<o.length;++i)at(()=>{const u=o[i][0],h=o[i][1],d=cf(e,u,h),c=[];if(Array.isArray(d))for(let p=0;p<d.length;++p)c.push({key:this.inputs[p],value:d[p]});else c.push({key:this.inputs[0],value:d});const f=new ou(c);return uf(this.outputs,f)}).forEach((u,h)=>a[h].push(u));return vo(a.map(i=>Hs(i,0)))})}predict(e,t={}){const n=pA(e);II(n,this.inputNames,this.feedInputShapes,!1);try{const s=t.batchSize==null?32:t.batchSize;return qb(s),this.predictLoop(n,s)}finally{la(n,e)}}predictOnBatch(e){II(e,this.inputNames,this.feedInputShapes,!0);const t=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,t)}standardizeUserDataXY(e,t,n=!0,s){if(this.optimizer_==null)throw new ji("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const o=[];for(let a=0;a<this.feedOutputShapes.length;++a){const i=this.feedOutputShapes[a];this.feedLossFns[a]===hy?o.push(i.slice(0,i.length-1).concat([1])):o.push(i)}if(e=kI(e,this.feedInputNames,this.feedInputShapes,!1,"input"),t=kI(t,this.feedOutputNames,o,!1,"target"),yY(e,t),vY(t,this.feedLossFns,this.feedOutputShapes),this.stateful&&s!=null&&s>0&&e[0].shape[0]%s!==0)throw new Ye(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${s}. Found: ${e[0].shape[0]} sample(s).`);return[e,t]}async standardizeUserData(e,t,n,s,o=!0,a){const[i,l]=this.standardizeUserDataXY(e,t,o,a);if(n!=null)throw new Error("sample weight is not supported yet.");let u=null;if(s!=null){const h=hA(s,this.outputNames);u=[];for(let d=0;d<h.length;++d)u.push(await dA(l[d],null,h[d]))}return[i,l,u]}testLoop(e,t,n,s=0,o){return at(()=>{const a=this.checkNumSamples(t,n,o,"steps"),i=[];if(s>0)throw new On("Verbose mode is not implemented yet.");if(o!=null)throw new On("steps mode in testLoop() is not implemented yet");{const l=Xb(a,n),u=Po(ma(0,a));for(let h=0;h<l.length;++h){const d=l[h][0],c=l[h][1],f=kc(u,d,c-d),p=oS(t,f),m=e(p);if(h===0)for(let g=0;g<m.length;++g)i.push(An(0));for(let g=0;g<m.length;++g){const y=m[g];i[g]=Rt(i[g],We(c-d,y))}}for(let h=0;h<i.length;++h)i[h]=fn(i[h],a)}return i})}getDedupedMetricsNames(){const e=this.metricsNames,t=[];for(let n=0;n<e.length;++n){const s=e[n];let o=s;cI(e,s)>1&&(o+=`_${cI(e.slice(0,n),s)}`),t.push(o)}return t}makeTrainFunction(){return e=>{const t=[],n=e.slice(0,this.inputs.length),s=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),o=e.slice(this.inputs.length+this.outputs.length,this.inputs.length+this.outputs.length*2),a=[],i=()=>{const d=[];for(let m=0;m<this.inputs.length;++m)d.push({key:this.inputs[m],value:n[m]});const c=new ou(d),f=uf(this.outputs,c,{training:!0});let p;for(let m=0;m<this.lossFunctions.length;++m){const g=this.lossFunctions[m];let y=g(s[m],f[m]);o[m]!=null&&(y=aY(y,o[m]));const v=Qr(y);t.push(v),m===0?p=y:p=Rt(p,y)}for(let m=0;m<this.metricsTensors.length;++m){let g;if(this.outputs.length>1&&m<this.outputs.length)g=t[m];else{const y=this.metricsTensors[m][0],v=this.metricsTensors[m][1];g=Qr(y(s[v],f[v]))}Ya(g),a.push(g)}return p=Qr(p),this.calculateLosses().forEach(m=>{p=Rt(p,m)}),p},l=this.collectedTrainableWeights.map(d=>d.read()),u=!0;return[this.optimizer_.minimize(i,u,l)].concat(a)}}makeTestFunction(){this.testFunction=e=>at(()=>{const t=[];let n;const s=e.slice(0,this.inputs.length),o=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),a=[];for(let u=0;u<this.inputs.length;++u)a.push({key:this.inputs[u],value:s[u]});const i=new ou(a),l=uf(this.outputs,i);for(let u=0;u<this.lossFunctions.length;++u){const h=this.lossFunctions[u],d=Qr(h(o[u],l[u]));u===0?n=d:n=Rt(n,d),t.push(n)}for(let u=0;u<this.metricsTensors.length;++u){const h=this.metricsTensors[u][0],d=this.metricsTensors[u][1],c=Qr(h(o[d],l[d]));t.push(c)}return t})}async fit(e,t,n={}){return mY(this,e,t,n)}async fitDataset(e,t){return cY(this,e,t)}async trainOnBatch(e,t){const n=await this.standardizeUserData(e,t),s=n[0],o=n[1],i=this.makeTrainFunction()(s.concat(o)),l=[];for(const u of i){const h=await u.data();l.push(h[0])}return Kn(i),la(n[0],e),la(n[1],t),vo(l)}getNamedWeights(e){const t=[],n=e!=null&&e.trainableOnly,s=n?this.trainableWeights:this.weights,o=this.getWeights(n);for(let a=0;a<s.length;++a)n&&!s[a].trainable||t.push({name:s[a].originalName,tensor:o[a]});return t}set stopTraining(e){this.stopTraining_=e}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}dispose(){const e=super.dispose();if(e.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){const t=Ab().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=t-Ab().numTensors}return e}getLossIdentifiers(){let e;if(typeof this.loss=="string")e=xl(this.loss);else if(Array.isArray(this.loss)){for(const t of this.loss)if(typeof t!="string")throw new Error("Serialization of non-string loss is not supported.");e=this.loss.map(t=>xl(t))}else{const t=Object.keys(this.loss);e={};const n=this.loss;for(const s of t)if(typeof n[s]=="string")e[s]=xl(n[s]);else throw new Error("Serialization of non-string loss is not supported.")}return e}getMetricIdentifiers(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[xl(mg(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(e=>xl(mg(e)));{const e={};for(const t in this.metrics)e[t]=xl(mg(this.metrics[t]));return e}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(e){if(e.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(e.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(e.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");const t=Wb(e.optimizer_config),n=kl(t);let s;if(typeof e.loss=="string")s=mc(e.loss);else if(Array.isArray(e.loss))s=e.loss.map(a=>mc(a));else if(e.loss!=null){s={};for(const a in e.loss)s[a]=mc(e.loss[a])}let o;if(Array.isArray(e.metrics))o=e.metrics.map(a=>mc(a));else if(e.metrics!=null){o={};for(const a in e.metrics)o[a]=mc(e.metrics[a])}this.compile({loss:s,metrics:o,optimizer:n})}async save(e,t){if(typeof e=="string"){const u=PV(e);if(u.length===0)throw new Ye(`Cannot find any save handlers for URL '${e}'`);if(u.length>1)throw new Ye(`Found more than one (${u.length}) save handlers for URL '${e}'`);e=u[0]}if(e.save==null)throw new Ye("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const n=await Hk(this.getNamedWeights(t)),s=!1,o=null,i={modelTopology:this.toJSON(o,s),format:xY,generatedBy:`TensorFlow.js tfjs-layers v${cA}`,convertedBy:null};if((t==null?!1:t.includeOptimizer)&&this.optimizer!=null){i.trainingConfig=this.getTrainingConfig();const u="optimizer",{data:h,specs:d}=await Hk(await this.optimizer.getWeights(),u);n.specs.push(...d),n.data=t$([n.data,h])}return this.userDefinedMetadata!=null&&(wI(this.userDefinedMetadata,this.name,!0),i.userDefinedMetadata=this.userDefinedMetadata),i.weightData=n.data,i.weightSpecs=n.specs,e.save(i)}setUserDefinedMetadata(e){wI(e,this.name),this.userDefinedMetadata=e}getUserDefinedMetadata(){return this.userDefinedMetadata}}zh.className="Model";Et(zh);class mA extends zh{}mA.className="Functional";Et(mA);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Nf extends zh{constructor(e){if(super({inputs:[],outputs:[]}),e=e||{},this.trainable=!0,this.built=!1,this.name=e.name!=null?e.name:t1("sequential_"),e.layers!=null)for(const t of e.layers)this.add(t)}checkShape(e){if(e.inboundNodes[0].outputTensors[0].shape.some(n=>n<0))throw new Ye(`Negative dimension size caused by adding layer ${e.name} with input shape [${e.inboundNodes[0].inputTensors[0].shape}]`)}add(e){const t=e instanceof Nf||e instanceof zh;let n;if(t){if(n=e,n.outputs.length!==1)throw new Ye("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(n.inputs.length!==1)throw new Ye("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(e.inboundNodes.length===0){if(e.batchInputShape==null)throw new Ye("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const s=wK({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(s)}if(t)this.outputs=n.outputs,this.inputs=n.inputs;else{if(e.inboundNodes.length!==1)throw new Ye(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${e.name} which has ${e.inboundNodes.length} pre-existing inbound connections.`);if(e.inboundNodes[0].outputTensors.length!==1)throw new Ye("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=YN(this.outputs[0])}this.inboundNodes=[],new r1({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:jc(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(s=>s.shape),outputShapes:this.outputs[0].shape})}else{const s=e.apply(this.outputs[0]);if(Array.isArray(s))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[s],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1}pop(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(e,t){return this.model==null&&this.build(),this.model.call(e,t)}build(e){if(xr(e),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new zh({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(e,t,n=console.log){this.built||this.build(),super.summary(e,t,n)}setWeights(e){this.model==null&&this.build(),this.model.setWeights(e)}evaluate(e,t,n={}){if(!this.built)throw new ji("The model needs to be compiled before being used.");return this.model.evaluate(e,t,n)}async evaluateDataset(e,t){if(!this.built)throw new ji("The model needs to be compiled before being used.");return this.model.evaluateDataset(e,t)}predict(e,t={}){return this.model==null&&this.build(),this.model.predict(e,t)}predictOnBatch(e){return this.model==null&&this.build(),this.model.predictOnBatch(e)}compile(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return this.model==null?void 0:this.model.optimizer}set optimizer(e){this.model.optimizer=e}async fit(e,t,n={}){if(!this.built)throw new ji("The model needs to be compiled before being used.");return this.model.fit(e,t,n)}async fitDataset(e,t){if(!this.built)throw new ji("The model needs to be compiled before being used.");return this.model.fitDataset(e,t)}async trainOnBatch(e,t){return this.model.trainOnBatch(e,t)}static fromConfig(e,t,n={},s=!1){let o,a={};if(t instanceof Array){if(t[0].className==null||t[0].className==="Merge")throw new Ye("Legacy serialization format not supported yet.");o=t}else xe(t.layers!=null,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),o=t.layers,delete t.layers,a=t;const i=new e(a);if(!(i instanceof Nf))throw new On(`Sequential.fromConfig called on non-Sequential input: ${i}`);for(const l of o){const h=kl(l,void 0,s);s&&h.setFastWeightInitDuringBuild(!0),i.add(h)}return i}set stopTraining(e){if(this.model==null)throw new Ye("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}get stopTraining(){if(this.model==null)throw new Ye("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const e=[];for(const t of this.layers){const n={};n.className=t.getClassName(),n.config=t.getConfig(),e.push(n)}return{name:this.name,layers:e}}}Nf.className="Sequential";Et(Nf);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class To extends xd{getConfig(){return{}}}class gA extends To{apply(e,t=1){return aK(e,t)}}gA.className="elu";Et(gA);class yA extends To{apply(e){return H$(e)}}yA.className="selu";Et(yA);class vA extends To{apply(e){return Dl(e)}}vA.className="relu";Et(vA);class bA extends To{apply(e){return at(()=>K0(6,Dl(e)))}}bA.className="relu6";Et(bA);class xA extends To{apply(e){return e}}xA.className="linear";Et(xA);class wA extends To{apply(e){return wd(e)}}wA.className="sigmoid";Et(wA);class SA extends To{apply(e){return uK(e)}}SA.className="hardSigmoid";Et(SA);class _A extends To{apply(e){return Kp(e)}}_A.className="softplus";Et(_A);class TA extends To{apply(e){return lK(e)}}TA.className="softsign";Et(TA);class kA extends To{apply(e){return Ww(e)}}kA.className="tanh";Et(kA);class iS extends To{apply(e,t=-1){return u2(e,t)}}iS.className="softmax";Et(iS);class IA extends To{apply(e,t=-1){return R$(e,t)}}IA.className="logSoftmax";Et(IA);class EA extends To{apply(e,t=1){return at(()=>We(wd(We(e,t)),e))}}EA.className="swish";Et(EA);class CA extends To{apply(e){return at(()=>We(e,Ww(Kp(e))))}}CA.className="mish";Et(CA);function yu(r){return r.getClassName()}function Wv(r,e={}){return tm(r,Mi.getMap().classNameMap,e,"activation")}function vu(r){if(r==null){const e={};return e.className="linear",e.config={},Wv(e)}if(typeof r=="string"){const e={};return e.className=r,e.config={},Wv(e)}else return r instanceof To?r:Wv(r)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function wY(r){if(r!=null&&typeof r!="object")throw new Error(`Argument to L1L2 regularizer's constructor is expected to be an object, but received: ${r}`)}class $A extends xd{}class NA extends $A{constructor(e){super(),wY(e),this.l1=e==null||e.l1==null?.01:e.l1,this.l2=e==null||e.l2==null?.01:e.l2,this.hasL1=this.l1!==0,this.hasL2=this.l2!==0}apply(e){return at(()=>{let t=Ss([1]);return this.hasL1&&(t=Rt(t,rn(We(this.l1,bs(e))))),this.hasL2&&(t=Rt(t,rn(We(this.l2,sm(e))))),Qe(t,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(e,t){return new e({l1:t.l1,l2:t.l2})}}NA.className="L1L2";Et(NA);const EI={l1l2:"L1L2"};function Ir(r){return W2(r)}function CI(r,e={}){return tm(r,Mi.getMap().classNameMap,e,"regularizer")}function Br(r){if(r==null)return null;if(typeof r=="string"){const t={className:r in EI?EI[r]:r,config:{}};return CI(t)}else return r instanceof $A?r:CI(r)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class AA extends rr{constructor(e){super(e==null?{}:e),this.supportsMasking=!0,e!=null&&(this.maxValue=e.maxValue)}call(e,t){e=Mn(e);let n=Dl(e);return this.maxValue!=null&&(n=pi(n,0,this.maxValue)),n}computeOutputShape(e){return e}getConfig(){const e={maxValue:this.maxValue},t=super.getConfig();return Object.assign(e,t),e}}AA.className="ReLU";Et(AA);class RA extends rr{constructor(e){super(e==null?{}:e),this.DEFAULT_ALPHA=.3,e==null&&(e={}),this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,t){const n=Mn(e);return Qw(n,this.alpha)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},t=super.getConfig();return Object.assign(e,t),e}}RA.className="LeakyReLU";Et(RA);class DA extends rr{constructor(e){if(super(e==null?{}:e),this.DEFAULT_ALPHA_INITIALIZER="zeros",e==null&&(e={}),this.supportsMasking=!0,this.alphaInitializer=jr(e.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=Br(e.alphaRegularizer),this.alphaConstraint=ds(e.alphaConstraint),e.sharedAxes==null)this.sharedAxes=null;else if(Array.isArray(e.sharedAxes))this.sharedAxes=e.sharedAxes;else if(typeof e.sharedAxes=="number")this.sharedAxes=[e.sharedAxes];else throw new Ye(`Expected sharedAxes to be a number or an array of numbers, but got ${e.sharedAxes}`)}build(e){e=xr(e);const t=e.slice(1);if(this.sharedAxes!=null)for(const s of this.sharedAxes)t[s-1]=1;this.alpha=this.addWeight("alpha",t,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const n={};if(this.sharedAxes!=null)for(let s=1;s<e.length;++s)n[s]=e[s];this.inputSpec=[new us({ndim:e.length,axes:n})],this.built=!0}call(e,t){return e=Mn(e),o2(e,this.alpha.read())}getConfig(){const e={alphaInitializer:Gr(this.alphaInitializer),alphaRegularizer:Ir(this.alphaRegularizer),alphaConstraint:hs(this.alphaConstraint),sharedAxes:this.sharedAxes},t=super.getConfig();return Object.assign(e,t),e}}DA.className="PReLU";Et(DA);class OA extends rr{constructor(e){if(super(e==null?{}:e),this.DEFAULT_ALPHA=1,e==null&&(e={}),e.alpha!=null&&e.alpha!==this.DEFAULT_ALPHA)throw new On(`Non-default alpha value (${e.alpha}) is not supported by the ELU layer yet.`);this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,t){const n=Mn(e);return H0(n)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},t=super.getConfig();return Object.assign(e,t),e}}OA.className="ELU";Et(OA);class MA extends rr{constructor(e){super(e==null?{}:e),this.DEFAULT_THETA=1,e==null&&(e={}),this.theta=e.theta==null?this.DEFAULT_THETA:e.theta}call(e,t){const n=Mn(e);return We(n,Yt(Ki(n,this.theta),"float32"))}computeOutputShape(e){return e}getConfig(){const e={theta:this.theta},t=super.getConfig();return Object.assign(e,t),e}}MA.className="ThresholdedReLU";Et(MA);class FA extends rr{constructor(e){super(e==null?{}:e),this.DEFAULT_AXIS=1,e==null&&(e={}),this.softmax=new iS().apply,this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis}call(e,t){const n=Mn(e);return this.softmax(n,this.axis)}computeOutputShape(e){return e}getConfig(){const e={axis:this.axis},t=super.getConfig();return Object.assign(e,t),e}}FA.className="Softmax";Et(FA);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Vh(r,e,t){if(typeof r=="number")return jc(r,e);if(r.length!==e)throw new Ye(`The ${t} argument must be an integer or tuple of ${e} integers. Received: ${r.length} elements.`);for(let n=0;n<e;++n){const s=r[n];if(!rK(s))throw new Ye(`The ${t} argument must be an integer or tuple of ${e} integers. Received: ${JSON.stringify(r)} including a non-integer number ${s}`)}return r}function pa(r,e,t,n,s=1){if(r==null)return r;const o=e+(e-1)*(s-1);let a;return t==="same"?a=r:a=r-o+1,Math.floor((a+n-1)/n)}function ja(r,e,t,n){if(r==null)return null;if(n==="valid")r=r*e+gu([t-e,0]);else if(n==="same")r=r*e;else throw new Ye(`Unsupport padding mode: ${n}.`);return r}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function aS(r,e){return at(()=>(ns(e),e==="channelsFirst"?nr(r,[0,2,3,1]):r))}function LA(r,e){return at(()=>(ns(e),e==="channelsFirst"?nr(r,[0,2,3,4,1]):r))}function SY(r,e,t,n=1,s="valid",o,a=1){return at(()=>{if(o==null&&(o=ga()),ns(o),r.shape.length!==3)throw new Ye(`The input of a conv1dWithBias operation should be 3, but is ${r.shape.length} instead.`);if(e.shape.length!==3)throw new Ye(`The kernel for a conv1dWithBias operation should be 3, but is ${e.shape.length} instead`);if(t!=null&&t.shape.length!==1)throw new Ye(`The bias for a conv1dWithBias operation should be 1, but is ${e.shape.length} instead`);if(o==="channelsFirst"&&(r=nr(r,[0,2,1])),s==="causal")throw new On("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let i=_$(r,e,n,s==="same"?"same":"valid","NWC",a);return t!=null&&(i=xa(i,t)),i})}function $I(r,e,t,n=[1,1],s="valid",o,a,i=null){return at(()=>{if(o==null&&(o=ga()),ns(o),r.rank!==3&&r.rank!==4)throw new Ye(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${r.rank}.`);if(e.rank!==3&&e.rank!==4)throw new Ye(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${r.rank}.`);let l=aS(r,o);if(s==="causal")throw new On("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return l=x7({x:l,filter:e,strides:n,pad:s==="same"?"same":"valid",dilations:a,dataFormat:"NHWC",bias:t,activation:i}),o==="channelsFirst"&&(l=nr(l,[0,3,1,2])),l})}function _Y(r,e,t,n=[1,1,1],s="valid",o,a){return at(()=>{if(o==null&&(o=ga()),ns(o),r.rank!==4&&r.rank!==5)throw new Ye(`conv3dWithBias expects input to be of rank 4 or 5, but received ${r.rank}.`);if(e.rank!==4&&e.rank!==5)throw new Ye(`conv3dWithBias expects kernel to be of rank 4 or 5, but received ${r.rank}.`);let i=LA(r,o);if(s==="causal")throw new On("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return i=LW(i,e,n,s==="same"?"same":"valid","NDHWC",a),t!=null&&(i=xa(i,t)),o==="channelsFirst"&&(i=nr(i,[0,4,1,2,3])),i})}class i1 extends rr{constructor(e,t){if(super(t),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",i1.verifyArgs(t),this.rank=e,Ts(this.rank,"rank"),this.rank!==1&&this.rank!==2&&this.rank!==3)throw new On(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=Vh(t.kernelSize,e,"kernelSize"),this.strides=Vh(t.strides==null?1:t.strides,e,"strides"),this.padding=t.padding==null?"valid":t.padding,mi(this.padding),this.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,ns(this.dataFormat),this.activation=vu(t.activation),this.useBias=t.useBias==null?!0:t.useBias,this.biasInitializer=jr(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=ds(t.biasConstraint),this.biasRegularizer=Br(t.biasRegularizer),this.activityRegularizer=Br(t.activityRegularizer),this.dilationRate=Vh(t.dilationRate==null?1:t.dilationRate,e,"dilationRate"),this.rank===1&&Array.isArray(this.dilationRate)&&this.dilationRate.length!==1)throw new Ye(`dilationRate must be a number or an array of a single number for 1D convolution, but received ${JSON.stringify(this.dilationRate)}`);if(this.rank===2){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==2)throw new Ye(`dilationRate must be a number or array of two numbers for 2D convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(this.rank===3){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==3)throw new Ye(`dilationRate must be a number or array of three numbers for 3D convolution, but received ${JSON.stringify(this.dilationRate)}`)}}static verifyArgs(e){if(Pa("kernelSize"in e,"required key 'kernelSize' not in config"),typeof e.kernelSize!="number"&&!H2(e.kernelSize,"number",1,3))throw new Ye(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(e.kernelSize)}.`)}getConfig(){const e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:yu(this.activation),useBias:this.useBias,biasInitializer:Gr(this.biasInitializer),biasRegularizer:Ir(this.biasRegularizer),activityRegularizer:Ir(this.activityRegularizer),biasConstraint:hs(this.biasConstraint)},t=super.getConfig();return Object.assign(e,t),e}}class kd extends i1{constructor(e,t){super(e,t),this.kernel=null,kd.verifyArgs(t),this.filters=t.filters,Ts(this.filters,"filters"),this.kernelInitializer=jr(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=ds(t.kernelConstraint),this.kernelRegularizer=Br(t.kernelRegularizer)}build(e){e=xr(e);const t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null)throw new Ye(`The channel dimension of the input should be defined. Found ${e[t]}`);const n=e[t],s=this.kernelSize.concat([n,this.filters]);this.kernel=this.addWeight("kernel",s,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[t]:n}}],this.built=!0}call(e,t){return at(()=>{e=Mn(e);let n;const s=this.bias==null?null:this.bias.read(),o=MN(this.activation.getClassName());if(o!=null&&this.rank===2)n=$I(e,this.kernel.read(),s,this.strides,this.padding,this.dataFormat,this.dilationRate,o);else{if(this.rank===1)n=SY(e,this.kernel.read(),s,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(this.rank===2)n=$I(e,this.kernel.read(),s,this.strides,this.padding,this.dataFormat,this.dilationRate);else if(this.rank===3)n=_Y(e,this.kernel.read(),s,this.strides,this.padding,this.dataFormat,this.dilationRate);else throw new On("convolutions greater than 3D are not implemented yet.");this.activation!=null&&(n=this.activation.apply(n))}return n})}computeOutputShape(e){e=xr(e);const t=[],n=this.dataFormat==="channelsLast"?e.slice(1,e.length-1):e.slice(2);for(let o=0;o<n.length;++o){const a=pa(n[o],this.kernelSize[o],this.padding,this.strides[o],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[o]);t.push(a)}let s=[e[0]];return this.dataFormat==="channelsLast"?(s=s.concat(t),s.push(this.filters)):(s.push(this.filters),s=s.concat(t)),s}getConfig(){const e={filters:this.filters,kernelInitializer:Gr(this.kernelInitializer),kernelRegularizer:Ir(this.kernelRegularizer),kernelConstraint:hs(this.kernelConstraint)},t=super.getConfig();return Object.assign(e,t),e}static verifyArgs(e){if(!("filters"in e)||typeof e.filters!="number"||e.filters<1)throw new Ye(`Convolution layer expected config.filters to be a 'number' > 0 but got ${JSON.stringify(e.filters)}`)}}class lm extends kd{constructor(e){super(2,e),lm.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!H2(e.kernelSize,"number",1,2))throw new Ye(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(e.kernelSize)}.`)}}lm.className="Conv2D";Et(lm);class um extends kd{constructor(e){super(3,e),um.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!(Array.isArray(e.kernelSize)&&(e.kernelSize.length===1||e.kernelSize.length===3)))throw new Ye(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(e.kernelSize)}.`)}}um.className="Conv3D";Et(um);class PA extends lm{constructor(e){if(super(e),this.inputSpec=[new us({ndim:4})],this.padding!=="same"&&this.padding!=="valid")throw new Ye(`Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=xr(e),e.length!==4)throw new Ye("Input should have rank 4; Received input shape: "+JSON.stringify(e));const t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null)throw new Ye("The channel dimension of the inputs should be defined. Found `None`.");const n=e[t],s=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight("kernel",s,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new us({ndim:4,axes:{[t]:n}})],this.built=!0}call(e,t){return at(()=>{let n=Mn(e);if(n.shape.length!==4)throw new Ye(`Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${n.shape.length}`);const s=n.shape,o=s[0];let a,i;this.dataFormat==="channelsFirst"?(a=2,i=3):(a=1,i=2);const l=s[a],u=s[i],h=this.kernelSize[0],d=this.kernelSize[1],c=this.strides[0],f=this.strides[1],p=ja(l,c,h,this.padding),m=ja(u,f,d,this.padding),g=[o,p,m,this.filters];this.dataFormat!=="channelsLast"&&(n=nr(n,[0,2,3,1]));let y=T$(n,this.kernel.read(),g,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(y=nr(y,[0,3,1,2])),this.bias!=null&&(y=xa(y,this.bias.read(),this.dataFormat)),this.activation!=null&&(y=this.activation.apply(y)),y})}computeOutputShape(e){e=xr(e);const t=e.slice();let n,s,o;this.dataFormat==="channelsFirst"?(n=1,s=2,o=3):(n=3,s=1,o=2);const a=this.kernelSize[0],i=this.kernelSize[1],l=this.strides[0],u=this.strides[1];return t[n]=this.filters,t[s]=ja(t[s],l,a,this.padding),t[o]=ja(t[o],u,i,this.padding),t}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}PA.className="Conv2DTranspose";Et(PA);class jA extends um{constructor(e){if(super(e),this.inputSpec=[new us({ndim:5})],this.padding!=="same"&&this.padding!=="valid")throw new Ye(`Conv3DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=xr(e),e.length!==5)throw new Ye("Input should have rank 5; Received input shape: "+JSON.stringify(e));const t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null)throw new Ye("The channel dimension of the inputs should be defined. Found `None`.");const n=e[t],s=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight("kernel",s,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new us({ndim:5,axes:{[t]:n}})],this.built=!0}call(e,t){return at(()=>{let n=Mn(e);if(n.shape.length!==5)throw new Ye(`Conv3DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${n.shape.length}`);const s=n.shape,o=s[0];let a,i,l;this.dataFormat==="channelsFirst"?(l=2,a=3,i=4):(l=1,a=2,i=3);const u=s[l],h=s[a],d=s[i],c=this.kernelSize[0],f=this.kernelSize[1],p=this.kernelSize[2],m=this.strides[0],g=this.strides[1],y=this.strides[2],v=ja(u,m,c,this.padding),b=ja(h,g,f,this.padding),w=ja(d,y,p,this.padding),_=[o,v,b,w,this.filters];this.dataFormat!=="channelsLast"&&(n=nr(n,[0,2,3,4,1]));let I=BW(n,this.kernel.read(),_,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(I=nr(I,[0,4,1,2,3])),this.bias!==null&&(I=xa(I,this.bias.read(),this.dataFormat)),this.activation!==null&&(I=this.activation.apply(I)),I})}computeOutputShape(e){e=xr(e);const t=e.slice();let n,s,o,a;this.dataFormat==="channelsFirst"?(n=1,s=2,o=3,a=4):(n=4,s=1,o=2,a=3);const i=this.kernelSize[0],l=this.kernelSize[1],u=this.kernelSize[2],h=this.strides[0],d=this.strides[1],c=this.strides[2];return t[n]=this.filters,t[s]=ja(t[s],h,i,this.padding),t[o]=ja(t[o],d,l,this.padding),t[a]=ja(t[a],c,u,this.padding),t}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}jA.className="Conv3DTranspose";Et(jA);class BA extends kd{constructor(e,t){if(super(e,t),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,t.filters==null)throw new Ye("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(t.kernelInitializer!=null||t.kernelRegularizer!=null||t.kernelConstraint!=null)throw new Ye("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(t.padding!=null&&t.padding!=="same"&&t.padding!=="valid")throw new Ye(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received ${JSON.stringify(t.padding)}`);this.depthMultiplier=t.depthMultiplier==null?1:t.depthMultiplier,this.depthwiseInitializer=jr(t.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=Br(t.depthwiseRegularizer),this.depthwiseConstraint=ds(t.depthwiseConstraint),this.pointwiseInitializer=jr(t.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=Br(t.pointwiseRegularizer),this.pointwiseConstraint=ds(t.pointwiseConstraint)}build(e){if(e=xr(e),e.length<this.rank+2)throw new Ye(`Inputs to SeparableConv${this.rank}D should have rank ${this.rank+2}, but received input shape: ${JSON.stringify(e)}`);const t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null||e[t]<0)throw new Ye(`The channel dimension of the inputs should be defined, but found ${JSON.stringify(e[t])}`);const n=e[t],s=this.kernelSize.concat([n,this.depthMultiplier]),o=[];for(let i=0;i<this.rank;++i)o.push(1);o.push(n*this.depthMultiplier,this.filters);const a=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",s,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,a,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",o,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,a,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,a,this.biasConstraint):this.bias=null,this.inputSpec=[new us({ndim:this.rank+2,axes:{[t]:n}})],this.built=!0}call(e,t){return at(()=>{e=Mn(e);let n;if(this.rank===1)throw new On("1D separable convolution is not implemented yet.");return this.rank===2&&(this.dataFormat==="channelsFirst"&&(e=nr(e,[0,2,3,1])),n=q$(e,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(n=xa(n,this.bias.read(),this.dataFormat)),this.activation!=null&&(n=this.activation.apply(n)),this.dataFormat==="channelsFirst"&&(n=nr(n,[0,3,1,2])),n})}getConfig(){const e=super.getConfig();return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=Gr(this.depthwiseInitializer),e.pointwiseInitializer=Gr(this.pointwiseInitializer),e.depthwiseRegularizer=Ir(this.depthwiseRegularizer),e.pointwiseRegularizer=Ir(this.pointwiseRegularizer),e.depthwiseConstraint=hs(this.depthwiseConstraint),e.pointwiseConstraint=hs(this.pointwiseConstraint),e}}BA.className="SeparableConv";class UA extends BA{constructor(e){super(2,e)}}UA.className="SeparableConv2D";Et(UA);class a1 extends kd{constructor(e){super(1,e),a1.verifyArgs(e),this.inputSpec=[{ndim:3}]}getConfig(){const e=super.getConfig();return delete e.rank,delete e.dataFormat,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!H2(e.kernelSize,"number",1,1))throw new Ye(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(e.kernelSize)}.`)}}a1.className="Conv1D";Et(a1);class zA extends rr{constructor(e){super(e),typeof e.cropping=="number"?this.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:typeof e.cropping[0]=="number"?this.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:this.cropping=e.cropping,this.dataFormat=e.dataFormat===void 0?"channelsLast":e.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(e){return this.dataFormat==="channelsFirst"?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}call(e,t){return at(()=>{if(e=Mn(e),this.dataFormat==="channelsLast"){const n=pg(e,this.cropping[0][0],e.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return pg(n,this.cropping[1][0],e.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}else{const n=pg(e,this.cropping[0][0],e.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return pg(n,this.cropping[1][0],e.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){const e={cropping:this.cropping,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}zA.className="Cropping2D";Et(zA);class VA extends rr{constructor(e){super(e),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=e.size==null?this.DEFAULT_SIZE:e.size,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,ns(this.dataFormat),this.interpolation=e.interpolation==null?"nearest":e.interpolation,eK(this.interpolation)}computeOutputShape(e){if(this.dataFormat==="channelsFirst"){const t=e[2]==null?null:this.size[0]*e[2],n=e[3]==null?null:this.size[1]*e[3];return[e[0],e[1],t,n]}else{const t=e[1]==null?null:this.size[0]*e[1],n=e[2]==null?null:this.size[1]*e[2];return[e[0],t,n,e[3]]}}call(e,t){return at(()=>{let n=Mn(e);const s=n.shape;if(this.dataFormat==="channelsFirst"){n=nr(n,[0,2,3,1]);const o=this.size[0]*s[2],a=this.size[1]*s[3],i=this.interpolation==="nearest"?hg.resizeNearestNeighbor(n,[o,a]):hg.resizeBilinear(n,[o,a]);return nr(i,[0,3,1,2])}else{const o=this.size[0]*s[1],a=this.size[1]*s[2];return this.interpolation==="nearest"?hg.resizeNearestNeighbor(n,[o,a]):hg.resizeBilinear(n,[o,a])}})}getConfig(){const e={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},t=super.getConfig();return Object.assign(e,t),e}}VA.className="UpSampling2D";Et(VA);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function TY(r,e,t=[1,1],n="valid",s,o){return at(()=>{s==null&&(s=ga()),ns(s);let a=aS(r,s);if(r.rank!==4)throw new Ye(`Input for depthwiseConv2d is required to be 4-D, but is instead ${r.rank}-D`);if(e.rank!==4)throw new Ye(`depthwiseKernel is required to be 4-D, but is instead ${e.rank}-D`);return a=Kw(a,e,t,n==="same"?"same":"valid","NHWC",o),s==="channelsFirst"&&(a=nr(a,[0,3,1,2])),a})}class GA extends i1{constructor(e){super(2,e),this.depthwiseKernel=null,this.depthMultiplier=e.depthMultiplier==null?1:e.depthMultiplier,this.depthwiseInitializer=jr(e.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=ds(e.depthwiseConstraint),this.depthwiseRegularizer=Br(e.depthwiseRegularizer)}build(e){if(e=xr(e),e.length<4)throw new Ye(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(e)}.`);const t=this.dataFormat==="channelsFirst"?1:3;if(e[t]==null||e[t]<0)throw new Ye(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${e[t]}).`);const n=e[t],s=[this.kernelSize[0],this.kernelSize[1],n,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",s,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[n*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return at(()=>{e=Mn(e);let n=TY(e,this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(n=xa(n,this.bias.read(),this.dataFormat)),this.activation!=null&&(n=this.activation.apply(n)),n})}computeOutputShape(e){e=xr(e);const t=this.dataFormat==="channelsFirst"?e[2]:e[1],n=this.dataFormat==="channelsFirst"?e[3]:e[2],s=this.dataFormat==="channelsFirst"?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,o=pa(t,this.kernelSize[0],this.padding,this.strides[0]),a=pa(n,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[e[0],s,o,a]:[e[0],o,a,s]}getConfig(){const e=super.getConfig();return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=Gr(this.depthwiseInitializer),e.depthwiseRegularizer=Ir(this.depthwiseRegularizer),e.depthwiseConstraint=hs(this.depthwiseRegularizer),e}}GA.className="DepthwiseConv2D";Et(GA);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function WA(r,e,t,n){if(Array.isArray(r)){if(e!=null||t!=null)throw new Ye("When inputs is an array, neither initialState or constants should be provided");n!=null&&(t=r.slice(r.length-n,r.length),r=r.slice(0,r.length-n)),r.length>1&&(e=r.slice(1,r.length)),r=r[0]}function s(o){return o==null||Array.isArray(o)?o:[o]}return e=s(e),t=s(t),{inputs:r,initialState:e,constants:t}}function HA(r,e,t,n=!1,s,o,a=!1,i=!1){return at(()=>{const l=e.shape.length;if(l<3)throw new Ye(`Input should be at least 3D, but is ${l}D.`);const u=[1,0].concat(ma(2,l));if(e=nr(e,u),o!=null)throw new On("The rnn() functoin of the deeplearn.js backend does not support constants yet.");a&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),s!=null&&(s=Yt(Yt(s,"bool"),"float32"),s.rank===l-1&&(s=Oi(s,-1)),s=nr(s,u)),n&&(e=Fc(e,0),s!=null&&(s=Fc(s,0)));const h=[];let d,c=t;const f=e.shape[0],p=td(e);let m;s!=null&&(m=td(s));for(let y=0;y<f;++y){const v=p[y],b=at(()=>r(v,c));if(s==null)d=b[0],c=b[1];else{const w=at(()=>{const _=m[y],I=sn(Hi(_),_),C=Rt(We(b[0],_),We(c[0],I)),N=c.map((O,D)=>Rt(We(b[1][D],_),We(O,I)));return{output:C,newStates:N}});d=w.output,c=w.newStates}i&&h.push(d)}let g;return i&&(g=Lc(h,1)),[d,g,c]})}class Ru extends rr{constructor(e){super(e);let t;if(e.cell==null)throw new Ye("cell property is missing for the constructor of RNN.");if(Array.isArray(e.cell)?t=new cS({cells:e.cell}):t=e.cell,t.stateSize==null)throw new Ye("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=t,this.returnSequences=e.returnSequences==null?!1:e.returnSequences,this.returnState=e.returnState==null?!1:e.returnState,this.goBackwards=e.goBackwards==null?!1:e.goBackwards,this._stateful=e.stateful==null?!1:e.stateful,this.unroll=e.unroll==null?!1:e.unroll,this.supportsMasking=!0,this.inputSpec=[new us({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;return ma(0,e).map(t=>null)}else return this.states_}setStates(e){this.states_=e}computeOutputShape(e){zb(e)&&(e=e[0]),e=e;let t=this.cell.stateSize;Array.isArray(t)||(t=[t]);const n=t[0];let s;if(this.returnSequences?s=[e[0],e[1],n]:s=[e[0],n],this.returnState){const o=[];for(const a of t)o.push([e[0],a]);return[s].concat(o)}else return s}computeMask(e,t){return at(()=>{Array.isArray(t)&&(t=t[0]);const n=this.returnSequences?t:null;if(this.returnState){const s=this.states.map(o=>null);return[n].concat(s)}else return n})}get states(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,t=[];for(let n=0;n<e;++n)t.push(null);return t}else return this.states_}set states(e){this.states_=e}build(e){if(this.numConstants!=null)throw new On("Constants support is not implemented in RNN yet.");zb(e)&&(e=e[0]),e=e;const t=this.stateful?e[0]:null,n=e.slice(2);this.inputSpec[0]=new us({shape:[t,null,...n]});const s=[e[0]].concat(e.slice(2));this.cell.build(s);let o;if(Array.isArray(this.cell.stateSize)?o=this.cell.stateSize:o=[this.cell.stateSize],this.stateSpec!=null){if(!ur(this.stateSpec.map(a=>a.shape[a.shape.length-1]),o))throw new Ye(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=o.map(a=>new us({shape:[null,a]}));this.stateful&&this.resetStates()}resetStates(e,t=!1){at(()=>{if(!this.stateful)throw new La("Cannot call resetStates() on an RNN Layer that is not stateful.");const n=this.inputSpec[0].shape[0];if(n==null)throw new Ye("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.states_==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(s=>Ss([n,s])):this.states_=[Ss([n,this.cell.stateSize])];else if(e==null)Kn(this.states_),this.keptStates!=null&&(Kn(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(s=>Ss([n,s])):this.states_[0]=Ss([n,this.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new Ye(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);t===!0?this.keptStates.push(this.states_.slice()):Kn(this.states_);for(let s=0;s<this.states_.length;++s){const o=e[s],a=Array.isArray(this.cell.stateSize)?this.cell.stateSize[s]:this.cell.stateSize,i=[n,a];if(!ur(o.shape,i))throw new Ye(`State ${s} is incompatible with layer ${this.name}: expected shape=${i}, received shape=${o.shape}`);this.states_[s]=o}}this.states_=this.states_.map(s=>Ya(s.clone()))})}apply(e,t){let n=t==null?null:t.initialState,s=t==null?null:t.constants;t==null&&(t={});const o=WA(e,n,s,this.numConstants);e=o.inputs,n=o.initialState,s=o.constants;let a=[],i=[];if(n!=null){t.initialState=n,a=a.concat(n),this.stateSpec=[];for(const u of n)this.stateSpec.push(new us({shape:u.shape}));i=i.concat(this.stateSpec)}if(s!=null&&(t.constants=s,a=a.concat(s),this.numConstants=s.length),a[0]instanceof Ua){const u=[e].concat(a),h=this.inputSpec.concat(i),d=this.inputSpec;this.inputSpec=h;const c=super.apply(u,t);return this.inputSpec=d,c}else return super.apply(e,t)}call(e,t){return at(()=>{const n=t==null?null:t.mask,s=t==null?null:t.training;let o=t==null?null:t.initialState;e=Mn(e),o==null&&(this.stateful?o=this.states_:o=this.getInitialState(e));const a=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(o.length!==a)throw new Ye(`RNN Layer has ${a} state(s) but was passed ${o.length} initial state(s).`);this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const i={training:s},u=HA((p,m)=>{const g=this.cell.call([p].concat(m),i);return[g[0],g.slice(1)]},e,o,this.goBackwards,n,null,this.unroll,this.returnSequences),h=u[0],d=u[1],c=u[2];this.stateful&&this.resetStates(c,s);const f=this.returnSequences?d:h;return this.returnState?[f].concat(c):f})}getInitialState(e){return at(()=>{let t=Ss(e.shape);return t=rn(t,[1,2]),t=rm(t),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(n=>n>1?Bb(t,[1,n]):t):this.cell.stateSize>1?[Bb(t,[1,this.cell.stateSize])]:[t]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(e)}getConfig(){const e=super.getConfig(),t={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(t.numConstants=this.numConstants);const n=this.cell.getConfig();return this.getClassName()===Ru.className&&(t.cell={className:this.cell.getClassName(),config:n}),Object.assign({},n,e,t)}static fromConfig(e,t,n={}){const s=t.cell,o=kl(s,n);return new e(Object.assign(t,{cell:o}))}}Ru.className="RNN";Et(Ru);class l1 extends rr{}class lS extends l1{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,Ts(this.units,"units"),this.activation=vu(e.activation==null?this.DEFAULT_ACTIVATION:e.activation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=jr(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=jr(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=jr(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Br(e.kernelRegularizer),this.recurrentRegularizer=Br(e.recurrentRegularizer),this.biasRegularizer=Br(e.biasRegularizer),this.kernelConstraint=ds(e.kernelConstraint),this.recurrentConstraint=ds(e.recurrentConstraint),this.biasConstraint=ds(e.biasConstraint),this.dropout=nd([1,gu([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=nd([1,gu([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=xr(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return at(()=>{if(e=e,e.length!==2)throw new Ye(`SimpleRNNCell expects 2 input Tensors, got ${e.length}.`);let n=e[1];e=e[0];const s=t.training==null?!1:t.training;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=bu({ones:()=>Hi(e),rate:this.dropout,training:s,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=bu({ones:()=>Hi(n),rate:this.recurrentDropout,training:s,dropoutFunc:this.dropoutFunc}));let o;const a=this.dropoutMask,i=this.recurrentDropoutMask;a!=null?o=Xa(We(e,a),this.kernel.read()):o=Xa(e,this.kernel.read()),this.bias!=null&&(o=xa(o,this.bias.read())),i!=null&&(n=We(n,i));let l=Rt(o,Xa(n,this.recurrentKernel.read()));return this.activation!=null&&(l=this.activation.apply(l)),[l,l]})}getConfig(){const e=super.getConfig(),t={units:this.units,activation:yu(this.activation),useBias:this.useBias,kernelInitializer:Gr(this.kernelInitializer),recurrentInitializer:Gr(this.recurrentInitializer),biasInitializer:Gr(this.biasInitializer),kernelRegularizer:Ir(this.kernelRegularizer),recurrentRegularizer:Ir(this.recurrentRegularizer),biasRegularizer:Ir(this.biasRegularizer),activityRegularizer:Ir(this.activityRegularizer),kernelConstraint:hs(this.kernelConstraint),recurrentConstraint:hs(this.recurrentConstraint),biasConstraint:hs(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign({},e,t)}}lS.className="SimpleRNNCell";Et(lS);class qA extends Ru{constructor(e){e.cell=new lS(e),super(e)}call(e,t){return at(()=>{this.cell.dropoutMask!=null&&(Kn(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Kn(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const n=t==null?null:t.mask,s=t==null?null:t.training,o=t==null?null:t.initialState;return super.call(e,{mask:n,training:s,initialState:o})})}static fromConfig(e,t){return new e(t)}}qA.className="SimpleRNN";Et(qA);class uS extends l1{constructor(e){if(super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new Ye("GRUCell does not support reset_after parameter set to true.");this.units=e.units,Ts(this.units,"units"),this.activation=vu(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=vu(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=jr(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=jr(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=jr(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Br(e.kernelRegularizer),this.recurrentRegularizer=Br(e.recurrentRegularizer),this.biasRegularizer=Br(e.biasRegularizer),this.kernelConstraint=ds(e.kernelConstraint),this.recurrentConstraint=ds(e.recurrentConstraint),this.biasConstraint=ds(e.biasConstraint),this.dropout=nd([1,gu([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=nd([1,gu([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=xr(e);const t=e[e.length-1];this.kernel=this.addWeight("kernel",[t,this.units*3],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*3],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units*3],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return at(()=>{if(e=e,e.length!==2)throw new Ye(`GRUCell expects 2 input Tensors (inputs, h, c), got ${e.length}.`);const n=t.training==null?!1:t.training;let s=e[1];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=bu({ones:()=>Hi(e),rate:this.dropout,training:n,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=bu({ones:()=>Hi(s),rate:this.recurrentDropout,training:n,count:3,dropoutFunc:this.dropoutFunc}));const o=this.dropoutMask,a=this.recurrentDropoutMask;let i,l,u;0<this.dropout&&this.dropout<1&&(e=We(e,o[0]));let h=Xa(e,this.kernel.read());this.useBias&&(h=xa(h,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(s=We(s,a[0]));const d=this.recurrentKernel.read(),[c,f]=fi(d,[2*this.units,this.units],d.rank-1),p=Xa(s,c),[m,g,y]=fi(h,3,h.rank-1),[v,b]=fi(p,2,p.rank-1);i=this.recurrentActivation.apply(Rt(m,v)),l=this.recurrentActivation.apply(Rt(g,b));const w=Xa(We(l,s),f);u=this.activation.apply(Rt(y,w));const _=Rt(We(i,s),We(Rt(1,Wr(i)),u));return[_,_]})}getConfig(){const e=super.getConfig(),t={units:this.units,activation:yu(this.activation),recurrentActivation:yu(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Gr(this.kernelInitializer),recurrentInitializer:Gr(this.recurrentInitializer),biasInitializer:Gr(this.biasInitializer),kernelRegularizer:Ir(this.kernelRegularizer),recurrentRegularizer:Ir(this.recurrentRegularizer),biasRegularizer:Ir(this.biasRegularizer),activityRegularizer:Ir(this.activityRegularizer),kernelConstraint:hs(this.kernelConstraint),recurrentConstraint:hs(this.recurrentConstraint),biasConstraint:hs(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign({},e,t)}}uS.className="GRUCell";Et(uS);class XA extends Ru{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new uS(e),super(e)}call(e,t){return at(()=>{this.cell.dropoutMask!=null&&(Kn(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Kn(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const n=t==null?null:t.mask,s=t==null?null:t.training,o=t==null?null:t.initialState;return super.call(e,{mask:n,training:s,initialState:o})})}static fromConfig(e,t){return t.implmentation===0&&(t.implementation=1),new e(t)}}XA.className="GRU";Et(XA);class u1 extends l1{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,Ts(this.units,"units"),this.activation=vu(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=vu(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=jr(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=jr(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=jr(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=e.unitForgetBias,this.kernelRegularizer=Br(e.kernelRegularizer),this.recurrentRegularizer=Br(e.recurrentRegularizer),this.biasRegularizer=Br(e.biasRegularizer),this.kernelConstraint=ds(e.kernelConstraint),this.recurrentConstraint=ds(e.recurrentConstraint),this.biasConstraint=ds(e.biasConstraint),this.dropout=nd([1,gu([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=nd([1,gu([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){var t;e=xr(e);const n=e[e.length-1];this.kernel=this.addWeight("kernel",[n,this.units*4],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*4],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint);let s;if(this.useBias){if(this.unitForgetBias){const o=this.biasInitializer,a=this.units;s=new(t=class extends Yi{apply(l,u){const h=o.apply([a]),d=new X2().apply([a]),c=o.apply([a*2]);return dI(dI(h,d),c)}},t.className="CustomInit",t)}else s=this.biasInitializer;this.bias=this.addWeight("bias",[this.units*4],null,s,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(e,t){return at(()=>{const n=t.training==null?!1:t.training;if(e=e,e.length!==3)throw new Ye(`LSTMCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);let s=e[1];const o=e[2];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=bu({ones:()=>Hi(e),rate:this.dropout,training:n,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=bu({ones:()=>Hi(s),rate:this.recurrentDropout,training:n,count:4,dropoutFunc:this.dropoutFunc}));const a=this.dropoutMask,i=this.recurrentDropoutMask;let l,u,h,d;0<this.dropout&&this.dropout<1&&(e=We(e,a[0]));let c=Xa(e,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(s=We(s,i[0])),c=Rt(c,Xa(s,this.recurrentKernel.read())),this.useBias&&(c=xa(c,this.bias.read()));const[f,p,m,g]=fi(c,4,c.rank-1);l=this.recurrentActivation.apply(f),u=this.recurrentActivation.apply(p),h=Rt(We(u,o),We(l,this.activation.apply(m))),d=this.recurrentActivation.apply(g);const y=We(d,this.activation.apply(h));return[y,y,h]})}getConfig(){const e=super.getConfig(),t={units:this.units,activation:yu(this.activation),recurrentActivation:yu(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Gr(this.kernelInitializer),recurrentInitializer:Gr(this.recurrentInitializer),biasInitializer:Gr(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:Ir(this.kernelRegularizer),recurrentRegularizer:Ir(this.recurrentRegularizer),biasRegularizer:Ir(this.biasRegularizer),activityRegularizer:Ir(this.activityRegularizer),kernelConstraint:hs(this.kernelConstraint),recurrentConstraint:hs(this.recurrentConstraint),biasConstraint:hs(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign({},e,t)}}u1.className="LSTMCell";Et(u1);class KA extends Ru{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new u1(e),super(e)}call(e,t){return at(()=>{this.cell.dropoutMask!=null&&(Kn(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Kn(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const n=t==null?null:t.mask,s=t==null?null:t.training,o=t==null?null:t.initialState;return super.call(e,{mask:n,training:s,initialState:o})})}static fromConfig(e,t){return t.implmentation===0&&(t.implementation=1),new e(t)}}KA.className="LSTM";Et(KA);class cS extends l1{constructor(e){super(e),this.cells=e.cells}get stateSize(){const e=[];for(const t of this.cells.slice().reverse())Array.isArray(t.stateSize)?e.push(...t.stateSize):e.push(t.stateSize);return e}call(e,t){return at(()=>{e=e;let n=e.slice(1);const s=[];for(const i of this.cells.slice().reverse())Array.isArray(i.stateSize)?s.push(n.splice(0,i.stateSize.length)):s.push(n.splice(0,1));s.reverse();const o=[];let a;for(let i=0;i<this.cells.length;++i){const l=this.cells[i];n=s[i],i===0?a=[e[0]].concat(n):a=[a[0]].concat(n),a=l.call(a,t),o.push(a.slice(1))}n=[];for(const i of o.slice().reverse())n.push(...i);return[a[0]].concat(n)})}build(e){zb(e)&&(e=e[0]),e=e;let t;this.cells.forEach((n,s)=>{Tc(`RNNCell_${s}`,()=>{n.build(e),Array.isArray(n.stateSize)?t=n.stateSize[0]:t=n.stateSize,e=[e[0],t]})}),this.built=!0}getConfig(){const e=super.getConfig(),t=o=>({className:o.getClassName(),config:o.getConfig()}),s={cells:this.cells.map(t)};return Object.assign({},e,s)}static fromConfig(e,t,n={}){const s=[];for(const o of t.cells)s.push(kl(o,n));return new e({cells:s})}get trainableWeights(){if(!this.trainable)return[];const e=[];for(const t of this.cells)e.push(...t.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const t of this.cells)e.push(...t.nonTrainableWeights);if(!this.trainable){const t=[];for(const n of this.cells)t.push(...n.trainableWeights);return t.concat(e)}return e}getWeights(){const e=[];for(const t of this.cells)e.push(...t.weights);return Vb(e)}setWeights(e){const t=[];for(const n of this.cells){const s=n.weights.length,o=e.splice(s);for(let a=0;a<n.weights.length;++a)t.push([n.weights[a],o[a]])}tS(t)}}cS.className="StackedRNNCells";Et(cS);function bu(r){const{ones:e,rate:t,training:n=!1,count:s=1,dropoutFunc:o}=r,a=()=>o!=null?o(e(),t):zN(e(),t),i=()=>om(a,e,n);return!s||s<=1?Ya(i().clone()):Array(s).fill(void 0).map(i).map(u=>Ya(u.clone()))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var kY=globalThis&&globalThis.__rest||function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(r);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(r,n[s])&&(t[n[s]]=r[n[s]]);return t};class YA extends Ru{constructor(e){if(e.unroll)throw new On("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new On("It is not possible at the moment to stack convolutional cells.");super(e),this.inputSpec=[new us({ndim:5})]}call(e,t){return at(()=>{if(this.cell.dropoutMask!=null&&(Kn(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Kn(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),t&&t.constants)throw new Ye("ConvRNN2D cell does not support constants");const n=t==null?null:t.mask,s=t==null?null:t.training,o=t==null?null:t.initialState;return super.call(e,{mask:n,training:s,initialState:o})})}computeOutputShape(e){let t=this.computeSingleOutputShape(e);return this.returnSequences||(t=[t[0],...t.slice(2)]),this.returnState&&(t=[t,...Array(2).fill([e[0],...t.slice(-3)])]),t}getInitialState(e){return at(()=>{const{stateSize:t}=this.cell,n=e.shape,s=this.computeSingleOutputShape(n),o=[s[0],...s.slice(2)],a=Ss(o);return Array.isArray(t)?Array(t.length).fill(a):[a]})}resetStates(e,t=!1){at(()=>{if(!this.stateful)throw new La("Cannot call resetStates() on an RNN Layer that is not stateful.");const n=this.inputSpec[0].shape,s=this.computeSingleOutputShape(n),o=[s[0],...s.slice(2)];if(n[0]==null)throw new Ye("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.getStates()==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>Ss(o)):this.states_=[Ss(o)];else if(e==null)Kn(this.states_),this.keptStates!=null&&(Kn(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>Ss(o)):this.states_[0]=Ss(o);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new Ye(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);t?this.keptStates.push(this.states_.slice()):Kn(this.states_);for(let i=0;i<this.states_.length;++i){const l=e[i],u=o;if(!ur(l.shape,u))throw new Ye(`State ${i} is incompatible with layer ${this.name}: expected shape=${u}, received shape=${l.shape}`);this.states_[i]=l}}this.states_=this.states_.map(i=>Ya(i.clone()))})}computeSingleOutputShape(e){const{dataFormat:t,filters:n,kernelSize:s,padding:o,strides:a,dilationRate:i}=this.cell,l=t==="channelsFirst",u=e[l?3:2],h=e[l?4:3],d=pa(u,s[0],o,a[0],i[0]),c=pa(h,s[1],o,a[1],i[1]);return[...e.slice(0,2),...l?[n,d,c]:[d,c,n]]}}YA.className="ConvRNN2D";class hS extends u1{constructor(e){const{filters:t,kernelSize:n,strides:s,padding:o,dataFormat:a,dilationRate:i}=e;super(Object.assign({},e,{units:t})),this.filters=t,Ts(this.filters,"filters"),this.kernelSize=Vh(n,2,"kernelSize"),this.kernelSize.forEach(l=>Ts(l,"kernelSize")),this.strides=Vh(s||1,2,"strides"),this.strides.forEach(l=>Ts(l,"strides")),this.padding=o||"valid",mi(this.padding),this.dataFormat=a||"channelsLast",ns(this.dataFormat),this.dilationRate=Vh(i||1,2,"dilationRate"),this.dilationRate.forEach(l=>Ts(l,"dilationRate"))}build(e){var t;e=xr(e);const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new Ye(`The channel dimension of the input should be defined. Found ${e[n]}`);const s=e[n],o=4,a=this.kernelSize.concat([s,this.filters*o]);this.kernel=this.addWeight("kernel",a,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const i=this.kernelSize.concat([this.filters,this.filters*o]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",i,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let l;if(this.unitForgetBias){const u=this.biasInitializer,h=this.filters;l=new(t=class extends Yi{apply(c,f){const p=u.apply([h]),m=$u([h]),g=u.apply([h*2]);return q2([p,m,g])}},t.className="CustomInit",t)}else l=this.biasInitializer;this.bias=this.addWeight("bias",[this.filters*o],null,l,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(e,t){return at(()=>{if(e.length!==3)throw new Ye(`ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);const n=t.training||!1,s=e[0],o=e[1],a=e[2],i=4;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=bu({ones:()=>Hi(s),rate:this.dropout,training:n,count:i,dropoutFunc:this.dropoutFunc}));const l=this.dropoutMask,u=(re,ce,be)=>!ce||!ce[be]?re:We(ce[be],re);let h=u(s,l,0),d=u(s,l,1),c=u(s,l,2),f=u(s,l,3);0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=bu({ones:()=>Hi(o),rate:this.recurrentDropout,training:n,count:i,dropoutFunc:this.dropoutFunc}));const p=this.recurrentDropoutMask;let m=u(o,p,0),g=u(o,p,1),y=u(o,p,2),v=u(o,p,3);const b=3,[w,_,I,C]=fi(this.kernel.read(),i,b),[N,O,D,M]=this.useBias?fi(this.bias.read(),i):[null,null,null,null];h=this.inputConv(h,w,N,this.padding),d=this.inputConv(d,_,O,this.padding),c=this.inputConv(c,I,D,this.padding),f=this.inputConv(f,C,M,this.padding);const[P,F,B,z]=fi(this.recurrentKernel.read(),i,b);m=this.recurrentConv(m,P),g=this.recurrentConv(g,F),y=this.recurrentConv(y,B),v=this.recurrentConv(v,z);const Z=this.recurrentActivation.apply(Rt(h,m)),Q=this.recurrentActivation.apply(Rt(d,g)),K=Rt(We(Q,a),We(Z,this.activation.apply(Rt(c,y)))),ne=We(this.recurrentActivation.apply(Rt(f,v)),this.activation.apply(K));return[ne,ne,K]})}getConfig(){const e=super.getConfig(),t=kY(e,["units"]),n={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign({},t,n)}inputConv(e,t,n,s){const o=Oc(e,t,this.strides,s||"valid",this.dataFormat==="channelsFirst"?"NCHW":"NHWC",this.dilationRate);return n?xa(o,n,this.dataFormat):o}recurrentConv(e,t){return Oc(e,t,1,"same",this.dataFormat==="channelsFirst"?"NCHW":"NHWC")}}hS.className="ConvLSTM2DCell";Et(hS);class ZA extends YA{constructor(e){const t=new hS(e);super(Object.assign({},e,{cell:t}))}static fromConfig(e,t){return new e(t)}}ZA.className="ConvLSTM2D";Et(ZA);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class dS extends rr{constructor(e){super(e),this.rate=Math.max(Math.min(e.rate,1),0),this.noiseShape=e.noiseShape,this.seed=e.seed,this.supportsMasking=!0}getNoiseShape(e){if(this.noiseShape==null)return this.noiseShape;const t=e.shape,n=[];for(let s=0;s<this.noiseShape.length;++s)n.push(this.noiseShape[s]==null?t[s]:this.noiseShape[s]);return n}call(e,t){return at(()=>{this.invokeCallHook(e,t);const n=Mn(e);if(0<this.rate&&this.rate<1){const s=t.training==null?!1:t.training,o=this.getNoiseShape(n);return om(()=>zN(n,this.rate,o,this.seed),()=>n,s)}return e})}getConfig(){const e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},t=super.getConfig();return Object.assign(e,t),e}dispose(){return super.dispose()}}dS.className="Dropout";Et(dS);class QA extends dS{constructor(e){super(e),this.inputSpec=[{ndim:3}]}getNoiseShape(e){const t=e.shape;return[t[0],1,t[2]]}}QA.className="SpatialDropout1D";Et(QA);class JA extends rr{constructor(e){if(super(e),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.batchInputShape==null&&e.inputShape==null&&e.inputDim!=null){let t=null;e.batchSize!=null&&(t=e.batchSize),this.batchInputShape=[t,e.inputDim]}this.units=e.units,Ts(this.units,"units"),this.activation=vu(e.activation),e.useBias!=null&&(this.useBias=e.useBias),this.kernelInitializer=jr(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=jr(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=ds(e.kernelConstraint),this.biasConstraint=ds(e.biasConstraint),this.kernelRegularizer=Br(e.kernelRegularizer),this.biasRegularizer=Br(e.biasRegularizer),this.activityRegularizer=Br(e.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(e){e=xr(e);const t=e[e.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[t,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:t}}],this.built=!0}computeOutputShape(e){e=xr(e);const t=e.slice();return t[t.length-1]=this.units,t}call(e,t){return at(()=>{this.invokeCallHook(e,t);const n=Mn(e),s=MN(this.activation.getClassName());let o;return s!=null?o=Xa(n,this.kernel.read(),s,this.bias?this.bias.read():null):(o=Xa(n,this.kernel.read()),this.bias!=null&&(o=xa(o,this.bias.read())),this.activation!=null&&(o=this.activation.apply(o))),o})}getConfig(){const e={units:this.units,activation:yu(this.activation),useBias:this.useBias,kernelInitializer:Gr(this.kernelInitializer),biasInitializer:Gr(this.biasInitializer),kernelRegularizer:Ir(this.kernelRegularizer),biasRegularizer:Ir(this.biasRegularizer),activityRegularizer:Ir(this.activityRegularizer),kernelConstraint:hs(this.kernelConstraint),biasConstraint:hs(this.biasConstraint)},t=super.getConfig();return Object.assign(e,t),e}}JA.className="Dense";Et(JA);class eR extends rr{constructor(e){e=e||{},super(e),this.inputSpec=[{minNDim:3}],this.dataFormat=e.dataFormat}computeOutputShape(e){e=xr(e);for(const t of e.slice(1))if(t==null)throw new Ye(`The shape of the input to "Flatten" is not fully defined (got ${e.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[e[0],du(e,1)]}call(e,t){return at(()=>{this.invokeCallHook(e,t);let n=Mn(e);if(this.dataFormat==="channelsFirst"&&n.rank>1){const s=[0];for(let o=2;o<n.rank;++o)s.push(o);s.push(1),n=nr(n,s)}return iK(n)})}getConfig(){const e={};this.dataFormat!=null&&(e.dataFormat=this.dataFormat);const t=super.getConfig();return Object.assign(e,t),e}}eR.className="Flatten";Et(eR);class tR extends rr{constructor(e){super(e),this.supportsMasking=!0,this.activation=vu(e.activation)}call(e,t){return at(()=>{this.invokeCallHook(e,t);const n=Mn(e);return this.activation.apply(n)})}getConfig(){const e={activation:yu(this.activation)},t=super.getConfig();return Object.assign(e,t),e}}tR.className="Activation";Et(tR);class nR extends rr{constructor(e){super(e),this.n=e.n,this.inputSpec=[{ndim:2}]}computeOutputShape(e){return[e[0],this.n,e[1]]}call(e,t){return at(()=>(e=Mn(e),sK(e,this.n)))}getConfig(){const e={n:this.n},t=super.getConfig();return Object.assign(e,t),e}}nR.className="RepeatVector";Et(nR);class rR extends rr{constructor(e){super(e),this.targetShape=e.targetShape;for(let t=0;t<this.targetShape.length;++t)this.isUnknown(this.targetShape[t])&&(this.targetShape[t]=null)}isUnknown(e){return e<0||e==null}fixUnknownDimension(e,t){const n="Total size of new array must be unchanged.",s=t.slice();let o=1,a=null;for(let l=0;l<s.length;++l){const u=s[l];if(this.isUnknown(u))if(a===null)a=l;else throw new Ye("Can only specifiy one unknown dimension.");else o*=u}const i=du(e);if(a!==null){if(o===0||i%o!==0)throw new Ye(n);s[a]=i/o}else if(i!==o)throw new Ye(n);return s}computeOutputShape(e){let t=!1;for(let n=0;n<e.length;++n)if(this.isUnknown(e[n])){t=!0;break}return t?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}call(e,t){return at(()=>{this.invokeCallHook(e,t);const n=Mn(e),s=n.shape,o=s.slice(0,1).concat(this.fixUnknownDimension(s.slice(1),this.targetShape));return Qe(n,o)})}getConfig(){const e={targetShape:this.targetShape},t=super.getConfig();return Object.assign(e,t),e}}rR.className="Reshape";Et(rR);class sR extends rr{constructor(e){if(super(e),e.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error(`Permute constructor requires \`dims\` to be an Array, but received ${e.dims} instead.`);const t=ma(1,e.dims.length+1);if(!ur(e.dims.slice().sort(),t))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=e.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new us({ndim:this.dims.length+1})]}computeOutputShape(e){e=xr(e);const t=e.slice();return this.dims.forEach((n,s)=>{t[s+1]=e[n]}),t}call(e,t){return nr(Mn(e),this.dimsIncludingBatch)}getConfig(){const e={dims:this.dims},t=super.getConfig();return Object.assign(e,t),e}}sR.className="Permute";Et(sR);class oR extends rr{constructor(e){super(e==null?{}:e),this.supportsMasking=!0,e!=null?this.maskValue=e.maskValue==null?0:e.maskValue:this.maskValue=0}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={maskValue:this.maskValue};return Object.assign(t,e),t}computeMask(e,t){const n=Mn(e),s=-1;return Db(Ef(n,this.maskValue),s)}call(e,t){return at(()=>{this.invokeCallHook(e,t);const n=Mn(e),s=-1,o=!0,a=Db(Ef(n,this.maskValue),s,o);return We(n,Yt(a,n.dtype))})}}oR.className="Masking";Et(oR);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class iR extends rr{constructor(e){if(super(e),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",e.batchInputShape==null&&e.inputShape==null){let t=null;e.batchSize!=null&&(t=e.batchSize),e.inputLength==null?this.batchInputShape=[t,null]:this.batchInputShape=[t].concat(Mr(e.inputLength))}this.inputDim=e.inputDim,Ts(this.inputDim,"inputDim"),this.outputDim=e.outputDim,Ts(this.outputDim,"outputDim"),this.embeddingsInitializer=jr(e.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=Br(e.embeddingsRegularizer),this.activityRegularizer=Br(e.activityRegularizer),this.embeddingsConstraint=ds(e.embeddingsConstraint),this.maskZero=e.maskZero,this.supportsMasking=e.maskZero,this.inputLength=e.inputLength}build(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(e){}computeMask(e,t){return at(()=>this.maskZero?(e=Mn(e),Ef(e,ir(e))):null)}computeOutputShape(e){if(e=xr(e),this.inputLength==null)return[...e,this.outputDim];const t=Mr(this.inputLength);if(t.length!==e.length-1)throw new Ye(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);{let n=0;for(let s=0;s<t.length;++s){const o=t[s],a=e[s+1];if(o!=null&&a!=null&&o!==a)throw new Ye(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);o==null&&(t[n]=a),n++}}return[e[0],...t,this.outputDim]}call(e,t){return at(()=>{this.invokeCallHook(e,t);let n=Mn(e);n.dtype!=="int32"&&(n=nm(n,"int32"));const s=UN(this.embeddings.read(),Qe(n,[n.size]));return Qe(s,xr(this.computeOutputShape(n.shape)))})}getConfig(){const e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:Gr(this.embeddingsInitializer),embeddingsRegularizer:Ir(this.embeddingsRegularizer),activityRegularizer:Ir(this.activityRegularizer),embeddingsConstraint:hs(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},t=super.getConfig();return Object.assign(e,t),e}}iR.className="Embedding";Et(iR);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Qc extends rr{constructor(e){super(e||{}),this.supportsMasking=!0}mergeFunction(e){throw new On}computeElementwiseOpOutputShape(e,t){if(e==null||t==null)return null;if(e.length<t.length)return this.computeElementwiseOpOutputShape(t,e);if(t.length===0)return e;const n=e.slice(0,e.length-t.length);for(let s=0;s<t.length;++s){const o=e[e.length-t.length+s],a=t[s];if(o==null||a==null||o<0||a<0)n.push(null);else if(o===1)n.push(a);else if(a===1)n.push(o);else{if(o!==a)throw new Ye("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(t));n.push(o)}}return n}build(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[xr(e)]),e=e,e.length<2)throw new Ye(`A merge layer should be called on an Array of at least 2 inputs. Got ${e.length} input(s).`);let t=[];for(const o of e)o!=null&&o[0]!==null&&t.push(o[0]);if(t=hu(t),t.length>1)throw new Ye(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(e)}.`);let n=e[0]==null?null:e[0].slice(1);for(let o=1;o<e.length;++o){const a=e[o]==null?null:e[o].slice(1);n=this.computeElementwiseOpOutputShape(n,a)}const s=e.map(o=>o.length);e.indexOf(null)===-1&&hu(s).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0}call(e,t){return at(()=>{if(e=e,this.reshapeRequired){const n=[],s=e.map(o=>o.rank);if(s.indexOf(null)===-1){const o=gu(s);for(let a of e){const i=a.rank;for(let l=0;l<o-i;++l)a=rm(a,1);n.push(a)}return this.mergeFunction(n)}else{let o=!1;for(const l of e){const u=l.rank;if(u==null){const h=l.shape,d=h[0],c=h.slice(1).concat([d]);let f=Qe(l,[d].concat(du(h.slice(1))));f=nr(f,[1,0]),f=Qe(f,c),n.push(f),o=!0}else if(u>1){const h=ma(1,u).concat([0]);n.push(nr(l,h)),o=!0}else n.push(l)}let a=this.mergeFunction(n);const i=a.rank;if(o){if(i==null){const l=a.shape,u=l.length,h=l[u-1],d=[h].concat(l.slice(0,l.length-1));a=Qe(nr(Qe(a,[-1,h]),[1,0]),d)}else if(i>1){const l=[i-1].concat(ma(0,i-1));a=nr(a,l)}}return a}}else return this.mergeFunction(e)})}computeOutputShape(e){e=e;let t;e[0]==null?t=null:t=e[0].slice(1);for(let s=1;s<e.length;++s){const o=e[s]==null?null:e[s].slice(1);t=this.computeElementwiseOpOutputShape(t,o)}let n=[];for(const s of e)s!=null&&s[0]!==null&&n.push(s[0]);return n=hu(n),n.length===1?t=n.concat(t):t=[null].concat(t),t}computeMask(e,t){return at(()=>{if(t==null)return null;if(!Array.isArray(t))throw new Ye("`mask` should be an Array");if(!Array.isArray(e))throw new Ye("`inputs` should be an Array");if(t.length!==e.length)throw new Ye(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${e.length} vs ${t.length})`);if(t.every(s=>s==null))return null;t=t.map(s=>s==null?s:Oi(s,0));let n=t[0];for(let s=1;s<t.length-1;++s)n=El(n,t[s]);return n})}}class aR extends Qc{constructor(e){super(e)}mergeFunction(e){return at(()=>{let t=e[0].clone();for(let n=1;n<e.length;++n)t=Rt(t,e[n]);return t})}}aR.className="Add";Et(aR);class lR extends Qc{constructor(e){super(e)}mergeFunction(e){return at(()=>{let t=e[0].clone();for(let n=1;n<e.length;++n)t=We(t,e[n]);return t})}}lR.className="Multiply";Et(lR);class uR extends Qc{constructor(e){super(e)}mergeFunction(e){return at(()=>{let t=e[0].clone();for(let n=1;n<e.length;++n)t=Rt(t,e[n]);return We(1/e.length,t)})}}uR.className="Average";Et(uR);class cR extends Qc{constructor(e){super(e)}mergeFunction(e){return at(()=>{let t=e[0];for(let n=1;n<e.length;++n)t=Cu(t,e[n]);return t})}}cR.className="Maximum";Et(cR);class hR extends Qc{constructor(e){super(e)}mergeFunction(e){return at(()=>{let t=e[0];for(let n=1;n<e.length;++n)t=K0(t,e[n]);return t})}}hR.className="Minimum";Et(hR);class dR extends Qc{constructor(e){super(e),this.DEFAULT_AXIS=-1,e==null&&(e={}),this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){if(!(Array.isArray(e)&&Array.isArray(e[0]))||e.length===1)throw new Ye("A `Concatenate` layer should be called on a list of at least 2 inputs");e=e;let t=!0;for(const s of e)if(s!=null){t=!1;break}if(t)return;const n=[];for(let s=0;s<e.length;++s){const o=e[s].slice();o.splice(this.axis,1);let a=!1;for(const i of n)if(ur(i,o)){a=!0;break}a||n.push(o)}if(n.length>1)throw new Ye("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}mergeFunction(e){return at(()=>q2(e,this.axis))}computeOutputShape(e){if(!(Array.isArray(e)&&Array.isArray(e[0])))throw new Ye("A `Concatenate` layer should be called on a list of inputs.");const t=e,n=t[0].slice(),s=this.axis<0?n.length+this.axis:this.axis;for(const o of t.slice(1)){if(n[s]==null||o[s]==null){n[s]=null;break}n[s]+=o[s]}return n}computeMask(e,t){if(t==null)return null;if(!Array.isArray(t))throw new Ye("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new Ye("`inputs` should be an array for Concatenate");if(t.length!==e.length)throw new Ye(`Mismatch in the length of mask (${t.length}) and the legnth of inputs (${e.length})`);return at(()=>{let n=!0;if(t.forEach(a=>{if(a!=null){n=!1;return}}),n)return null;const s=[];for(let a=0;a<e.length;++a)t[a]==null?s.push(Yt(Hi(e[a]),"bool")):t[a].rank<e[a].rank?s.push(Oi(t[a],-1)):s.push(t[a]);const o=Hs(s,this.axis);return S$(o,-1,!1)})}getConfig(){const e={axis:this.axis},t=super.getConfig();return Object.assign(e,t),e}}dR.className="Concatenate";Et(dR);function tf(r,e){for(;r<0;)r+=e;return r}function IY(r,e,t){if(r.shape.length>3||e.shape.length>3)throw new On("batchDot is not implemented for tensors of 4D or higher rank yet");if(xe(r.shape.length>=2,()=>`batchDot requires the rank of x to be >= 2, but got ${r.shape.length}`),xe(r.shape.length>=2,()=>`batchDot requires the rank of y to be >= 2, but got ${e.shape.length}`),typeof t=="number"&&(t=[t,t]),r.dtype==="complex64"||e.dtype==="complex64")throw new On("batchDot is not implemented for complex64-type Tensors yet.");const n=r.shape.length,s=e.shape.length;t==null&&(t=[n-1,s-2]);const o=t;return at(()=>{let a;if(n>s){a=n-s;const l=[];for(let u=0;u<a;++u)l.push(1);e=Qe(e,e.shape.concat(l))}else if(s>n){a=s-n;const l=[];for(let u=0;u<a;++u)l.push(1);r=Qe(r,r.shape.concat(l))}else a=0;let i;if(r.shape.length===2&&e.shape.length===2)o[0]===o[1]?i=rn(We(r,e),o[0]):i=rn(We(nr(r,[1,0]),e),o[1]);else{const l=o[0]!==r.shape.length-1,u=o[1]===e.shape.length-1;i=lr(r,e,l,u)}if(a>0){let l;n>s?l=n+s-3:l=n-1;const u=[];for(let h=l;h<l+a;++h)u.push(h);i=Yp(i,u)}return i.shape.length===1&&(i=Oi(i,1)),i})}class fR extends Qc{constructor(e){super(e),this.axes=e.axes,this.normalize=e.normalize==null?!1:e.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){xe(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const t=e[0],n=e[1];if(t.length>3||n.length>3)throw new On("Dot layer does not support tensors of 4D or higher rank yet.");const s=this.interpretAxes(t,n);if(t[s[0]]!==n[s[1]])throw new Ye(`Dimension incompatibility: ${t[s[0]]} !== ${n[s[1]]}`)}mergeFunction(e){if(e.length!==2)throw new Ye(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${e.length} input(s).`);let t=e[0],n=e[1],s;return Array.isArray(this.axes)?s=this.axes.map((o,a)=>tf(o,e[a].shape.length)):s=[tf(this.axes,t.shape.length),tf(this.axes,n.shape.length)],this.normalize&&(t=cy(t,s[0]),n=cy(n,s[1])),IY(t,n,s)}interpretAxes(e,t){let n;return Array.isArray(this.axes)?n=this.axes:n=[tf(this.axes,e.length),tf(this.axes,t.length)],n}computeOutputShape(e){xe(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const t=e[0].slice(),n=e[1].slice();if(t.length>3||n.length>3)throw new On("Dot layer does not support tensors of 4D or higher rank yet.");const s=this.interpretAxes(t,n);t.splice(s[0],1),n.splice(s[1],1),n.splice(0,1);const o=t.concat(n);return o.length===1&&o.push(1),o}computeMask(e,t){return null}getConfig(){const e={axes:this.axes,normalize:this.normalize},t=super.getConfig();return Object.assign(e,t),e}}fR.className="Dot";Et(fR);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class pR extends rr{constructor(e){super(e),this.supportsMasking=!0,this.stddev=e.stddev}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={stddev:this.stddev};return Object.assign(t,e),t}call(e,t){return at(()=>{this.invokeCallHook(e,t);const n=Mn(e);return om(()=>Rt(n1(n.shape,0,this.stddev),n),()=>n,t.training||!1)})}}pR.className="GaussianNoise";Et(pR);class mR extends rr{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={rate:this.rate};return Object.assign(t,e),t}call(e,t){return at(()=>{this.invokeCallHook(e,t);const n=Mn(e);return this.rate>0&&this.rate<1?om(()=>{const o=Math.sqrt(this.rate/(1-this.rate));return We(n,n1(n.shape,1,o))},()=>n,t.training||!1):n})}}mR.className="GaussianDropout";Et(mR);class gR extends rr{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate,this.noiseShape=e.noiseShape}_getNoiseShape(e){return this.noiseShape||Mn(e).shape}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={rate:this.rate};return Object.assign(t,e),t}call(e,t){return at(()=>{if(this.rate<1&&this.rate>0){const n=this._getNoiseShape(e);return om(()=>{const o=Mn(e),a=1.6732632423543772,i=1.0507009873554805,l=-a*i;let u=Sd(Y0(n),this.rate);u=nm(u,"float32");const h=((1-this.rate)*(1+this.rate*l**2))**-.5,d=-h*l*this.rate,c=Rt(We(o,u),We(Rt(u,-1),l));return Rt(We(c,h),d)},()=>Mn(e),t.training||!1)}return e})}}gR.className="AlphaDropout";Et(gR);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Af(r,e,t,n,s,o=.001){let a;if(r.rank===2)a=fW(r,e,t,n,s,o);else if(r.rank===3)a=mW(r,e,t,n,s,o);else if(r.rank===4)a=yW(r,e,t,n,s,o);else throw new On(`batchNormalization is not implemented for array of rank ${r.rank} yet`);return a}function EY(r,e,t,n,s=.001){return at(()=>{const o=n2(r,n),a=o.mean,i=o.variance;return[Af(r,a,i,t,e,s),a,i]})}function CY(r,e,t,n,s=.001){return at(()=>{const o=n2(r,n),a=o.mean,i=o.variance,l=[];for(const p of ma(0,r.rank))n.indexOf(p)!==-1?l.push(1):l.push(r.shape[p]);const u=Qe(a,l),h=Qe(i,l),d=e==null?null:Qe(e,l),c=t==null?null:Qe(t,l);return[Af(r,u,h,c,d,s),a,i]})}function $Y(r,e,t,n,s=.001){return ur(n.slice().sort(),ma(0,r.rank-1))?EY(r,e,t,n,s):CY(r,e,t,n,s)}class yR extends rr{constructor(e){e==null&&(e={}),super(e),this.supportsMasking=!0,this.axis=e.axis==null?-1:e.axis,this.momentum=e.momentum==null?.99:e.momentum,this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=jr(e.betaInitializer||"zeros"),this.gammaInitializer=jr(e.gammaInitializer||"ones"),this.movingMeanInitializer=jr(e.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=jr(e.movingVarianceInitializer||"ones"),this.betaConstraint=ds(e.betaConstraint),this.gammaConstraint=ds(e.gammaConstraint),this.betaRegularizer=Br(e.betaRegularizer),this.gammaRegularizer=Br(e.gammaRegularizer)}build(e){e=xr(e);const t=this.axis>=0?this.axis:this.axis+e.length,n=e[t];if(n==null)throw new Ye(`Axis ${t} of input tensor should have a defined dimension but the layer received an input with shape ${JSON.stringify(e)}.`);this.inputSpec=[new us({ndim:e.length,axes:{[t]:n}})];const s=[n];this.scale&&(this.gamma=this.addWeight("gamma",s,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",s,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",s,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",s,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(e,t){return at(()=>{const n=t.training==null?!1:t.training,s=Mn(e),o=s.shape,a=o.length,i=ma(0,a),l=this.axis>=0?this.axis:this.axis+a;i.splice(l,1);const u=jc(1,a);u[l]=o[l];const h=i.slice();h.sort();const d=!ur(h,ma(0,a).slice(0,a-1)),c=()=>{if(d){const v=Qe(this.movingMean.read(),u),b=Qe(this.movingVariance.read(),u),w=this.center?Qe(this.beta.read(),u):null,_=this.scale?Qe(this.gamma.read(),u):null;return Af(s,v,b,w,_,this.epsilon)}else return Af(s,this.movingMean.read(),this.movingVariance.read(),this.beta==null?null:this.beta.read(),this.gamma==null?null:this.gamma.read(),this.epsilon)};if(!n)return c();const[f,p,m]=$Y(s,this.gamma.read(),this.beta.read(),i,this.epsilon),g=(v,b,w)=>{at(()=>{const _=1-w,I=v.read(),C=We(sn(I,b),_);v.write(sn(I,C))})};return(()=>{g(this.movingMean,p,this.momentum),g(this.movingVariance,m,this.momentum)})(),f})}getConfig(){const e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Gr(this.betaInitializer),gammaInitializer:Gr(this.gammaInitializer),movingMeanInitializer:Gr(this.movingMeanInitializer),movingVarianceInitializer:Gr(this.movingVarianceInitializer),betaRegularizer:Ir(this.betaRegularizer),gammaRegularizer:Ir(this.gammaRegularizer),betaConstraint:hs(this.betaConstraint),gammaConstraint:hs(this.gammaConstraint)},t=super.getConfig();return Object.assign(e,t),e}}yR.className="BatchNormalization";Et(yR);class vR extends rr{constructor(e){if(e==null&&(e={}),super(e),this.axis=e.axis==null?-1:e.axis,typeof this.axis=="number"){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else if(Array.isArray(this.axis)){for(const t of this.axis)if(!Number.isInteger(t))throw new Error(`Expected axis to be an array of integers, but received ${JSON.stringify(this.axis)}`)}else throw new Error(`Expected axis to be an integer or an array of integers, but received ${JSON.stringify(this.axis)}`);this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=jr(e.betaInitializer||"zeros"),this.gammaInitializer=jr(e.gammaInitializer||"ones"),this.betaRegularizer=Br(e.betaRegularizer),this.gammaRegularizer=Br(e.gammaRegularizer),this.supportsMasking=!0}build(e){e=xr(e);const t=e.length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(let o=0;o<this.axis.length;++o)this.axis[o]<0&&(this.axis[o]+=t);for(const o of this.axis)if(o<0||o>=t)throw new Error(`Invalid axis: ${o}`);if(this.axis.length!==hu(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);const n=this.axis.map(o=>e[o]),s=!0;this.scale?this.gamma=this.addWeight("gamma",n,"float32",this.gammaInitializer,this.gammaRegularizer,s):this.gamma=null,this.center?this.beta=this.addWeight("beta",n,"float32",this.betaInitializer,this.betaRegularizer,s):this.beta=null,this.built=!0}call(e,t){const n=Mn(e),s=n.shape,o=s.length;return at(()=>{let{mean:i,variance:l}=n2(n,this.axis,!0);const u=jc(1,o);for(const m of this.axis)u[m]=s[m];const h=m=>m!=null&&m.shape.length!==o?Qe(m,u):m;let d=this.scale?h(this.gamma.read()):null,c=this.center?h(this.beta.read()):null;const f=[],p=[];for(let m=0;m<o;++m)this.axis.indexOf(m)!==-1?(f.push(s[m]),p.push(1)):(f.push(1),p.push(s[m]));return i=da(i,f),l=da(l,f),d!=null&&(d=da(d,p)),c!=null&&(c=da(c,p)),Af(n,i,l,c,d,this.epsilon)})}getConfig(){const e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Gr(this.betaInitializer),gammaInitializer:Gr(this.gammaInitializer),betaRegularizer:Ir(this.betaRegularizer),gammaRegularizer:Ir(this.gammaRegularizer)},t=super.getConfig();return Object.assign(e,t),e}}vR.className="LayerNormalization";Et(vR);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function NY(r,e,t){return at(()=>{if(r.rank!==4)throw new Ye(`temporalPadding expects input tensor to be 4-D, but received a ${r.rank}-D tensor.`);if(e==null&&(e=[[1,1],[1,1]]),e.length!==2||e[0].length!==2||e[1].length!==2)throw new Ye("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(t==null&&(t=ga()),t!=="channelsLast"&&t!=="channelsFirst")throw new Ye(`Unknown data format: ${t}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let n;return t==="channelsFirst"?n=[[0,0],[0,0],e[0],e[1]]:n=[[0,0],e[0],e[1],[0,0]],r2(r,n)})}class bR extends rr{constructor(e){if(e==null&&(e={}),super(e),this.dataFormat=e.dataFormat==null?ga():e.dataFormat,e.padding==null)this.padding=[[1,1],[1,1]];else if(typeof e.padding=="number")this.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,e.padding.length!==2)throw new Ye(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${e.padding.length} array.`);let t,n;if(typeof e.padding[0]=="number")t=[e.padding[0],e.padding[0]],n=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,e.padding[0].length!==2)throw new Ye(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${e.padding[0].length} array.`);if(t=e.padding[0],e.padding[1].length!==2)throw new Ye(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${e.padding[1].length} array.`);n=e.padding[1]}this.padding=[t,n]}this.inputSpec=[new us({ndim:4})]}computeOutputShape(e){e=xr(e);let t,n;return this.dataFormat==="channelsFirst"?(e[2]!=null&&e[2]>=0?t=e[2]+this.padding[0][0]+this.padding[0][1]:t=null,e[3]!=null&&e[3]>=0?n=e[3]+this.padding[1][0]+this.padding[1][1]:n=null,[e[0],e[1],t,n]):(e[1]!=null&&e[1]>=0?t=e[1]+this.padding[0][0]+this.padding[0][1]:t=null,e[2]!=null&&e[2]>=0?n=e[2]+this.padding[1][0]+this.padding[1][1]:n=null,[e[0],t,n,e[3]])}call(e,t){return at(()=>NY(Mn(e),this.padding,this.dataFormat))}getConfig(){const e={padding:this.padding,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}bR.className="ZeroPadding2D";Et(bR);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function c1(r,e,t,n,s,o){return at(()=>{ns(s),LN(o),mi(n),t==null&&(t=[1,1]),n==null&&(n="valid"),s==null&&(s=ga()),o==null&&(o="max"),r=aS(r,s);let a;const i=n==="same"?"same":"valid";return o==="max"?a=t2(r,e,t,i):a=Gw(r,e,t,i),s==="channelsFirst"&&(a=nr(a,[0,3,1,2])),a})}function xR(r,e,t,n,s,o){return at(()=>{ns(s),LN(o),mi(n),t==null&&(t=[1,1,1]),n==null&&(n="valid"),s==null&&(s=ga()),o==null&&(o="max"),r=LA(r,s);let a;const i=n==="same"?"same":"valid";return o==="max"?a=Q8(r,e,t,i):a=sW(r,e,t,i),s==="channelsFirst"&&(a=nr(a,[0,4,1,2,3])),a})}class wR extends rr{constructor(e){if(e.poolSize==null&&(e.poolSize=2),super(e),typeof e.poolSize=="number")this.poolSize=[e.poolSize];else if(Array.isArray(e.poolSize)&&e.poolSize.length===1&&typeof e.poolSize[0]=="number")this.poolSize=e.poolSize;else throw new Ye(`poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.poolSize)}`);if(Ts(this.poolSize,"poolSize"),e.strides==null)this.strides=this.poolSize;else if(typeof e.strides=="number")this.strides=[e.strides];else if(Array.isArray(e.strides)&&e.strides.length===1&&typeof e.strides[0]=="number")this.strides=e.strides;else throw new Ye(`strides for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.strides)}`);Ts(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,mi(this.padding),this.inputSpec=[new us({ndim:3})]}computeOutputShape(e){e=xr(e);const t=pa(e[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],t,e[2]]}call(e,t){return at(()=>{this.invokeCallHook(e,t),e=rm(Mn(e),2);const n=this.poolingFunction(Mn(e),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return Yp(n,[2])})}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},t=super.getConfig();return Object.assign(e,t),e}}class SR extends wR{constructor(e){super(e)}poolingFunction(e,t,n,s,o){return ns(o),mi(s),c1(e,t,n,s,o,"max")}}SR.className="MaxPooling1D";Et(SR);class _R extends wR{constructor(e){super(e)}poolingFunction(e,t,n,s,o){return ns(o),mi(s),c1(e,t,n,s,o,"avg")}}_R.className="AveragePooling1D";Et(_R);class TR extends rr{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==2)throw new Ye(`If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides];Ts(this.poolSize,"poolSize"),Ts(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,ns(this.dataFormat),mi(this.padding),this.inputSpec=[new us({ndim:4})]}computeOutputShape(e){e=xr(e);let t=this.dataFormat==="channelsFirst"?e[2]:e[1],n=this.dataFormat==="channelsFirst"?e[3]:e[2];return t=pa(t,this.poolSize[0],this.padding,this.strides[0]),n=pa(n,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[e[0],e[1],t,n]:[e[0],t,n,e[3]]}call(e,t){return at(()=>(this.invokeCallHook(e,t),this.poolingFunction(Mn(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}class kR extends TR{constructor(e){super(e)}poolingFunction(e,t,n,s,o){return ns(o),mi(s),c1(e,t,n,s,o,"max")}}kR.className="MaxPooling2D";Et(kR);class IR extends TR{constructor(e){super(e)}poolingFunction(e,t,n,s,o){return ns(o),mi(s),c1(e,t,n,s,o,"avg")}}IR.className="AveragePooling2D";Et(IR);class ER extends rr{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==3)throw new Ye(`If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides,e.strides];Ts(this.poolSize,"poolSize"),Ts(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,ns(this.dataFormat),mi(this.padding),this.inputSpec=[new us({ndim:5})]}computeOutputShape(e){e=xr(e);let t=this.dataFormat==="channelsFirst"?e[2]:e[1],n=this.dataFormat==="channelsFirst"?e[3]:e[2],s=this.dataFormat==="channelsFirst"?e[4]:e[3];return t=pa(t,this.poolSize[0],this.padding,this.strides[0]),n=pa(n,this.poolSize[1],this.padding,this.strides[1]),s=pa(s,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[e[0],e[1],t,n,s]:[e[0],t,n,s,e[4]]}call(e,t){return at(()=>(this.invokeCallHook(e,t),this.poolingFunction(Mn(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}class CR extends ER{constructor(e){super(e)}poolingFunction(e,t,n,s,o){return ns(o),mi(s),xR(e,t,n,s,o,"max")}}CR.className="MaxPooling3D";Et(CR);class $R extends ER{constructor(e){super(e)}poolingFunction(e,t,n,s,o){return ns(o),mi(s),xR(e,t,n,s,o,"avg")}}$R.className="AveragePooling3D";Et($R);class NR extends rr{constructor(e){super(e),this.inputSpec=[new us({ndim:3})]}computeOutputShape(e){return[e[0],e[2]]}call(e,t){throw new On}}class AR extends NR{constructor(e){super(e||{})}call(e,t){return at(()=>{const n=Mn(e);return Qr(n,1)})}}AR.className="GlobalAveragePooling1D";Et(AR);class RR extends NR{constructor(e){super(e||{})}call(e,t){return at(()=>{const n=Mn(e);return Ha(n,1)})}}RR.className="GlobalMaxPooling1D";Et(RR);class DR extends rr{constructor(e){super(e),this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,ns(this.dataFormat),this.inputSpec=[new us({ndim:4})]}computeOutputShape(e){return e=e,this.dataFormat==="channelsLast"?[e[0],e[3]]:[e[0],e[1]]}call(e,t){throw new On}getConfig(){const e={dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}class OR extends DR{call(e,t){return at(()=>{const n=Mn(e);return this.dataFormat==="channelsLast"?Qr(n,[1,2]):Qr(n,[2,3])})}}OR.className="GlobalAveragePooling2D";Et(OR);class MR extends DR{call(e,t){return at(()=>{const n=Mn(e);return this.dataFormat==="channelsLast"?Ha(n,[1,2]):Ha(n,[2,3])})}}MR.className="GlobalMaxPooling2D";Et(MR);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class FR extends rr{constructor(e){super(e),this.layer=e.layer}build(e){this.built=!0}get trainable(){return this.layer!=null?this.layer.trainable:!1}set trainable(e){this.layer!=null&&(this.layer.trainable=e)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(e){this.layer.setWeights(e)}getConfig(){const e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},t=super.getConfig();return Object.assign(e,t),e}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(e)}static fromConfig(e,t,n={}){const s=t.layer,o=kl(s,n);delete t.layer;const a={layer:o};return Object.assign(a,t),new e(a)}}class LR extends FR{constructor(e){super(e),this.supportsMasking=!0}build(e){if(e=xr(e),e.length<3)throw new Ye(`TimeDistributed layer expects an input shape >= 3D, but received input shape ${JSON.stringify(e)}`);this.inputSpec=[{shape:e}];const t=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(t),this.layer.built=!0),super.build(e)}computeOutputShape(e){e=xr(e);const t=[e[0]].concat(e.slice(2)),n=this.layer.computeOutputShape(t),s=e[1];return[n[0],s].concat(n.slice(1))}call(e,t){return at(()=>(e=Mn(e),HA((a,i)=>[Mn(this.layer.call(a,t)),[]],e,[],!1,null,null,!1,!0)[1]))}}LR.className="TimeDistributed";Et(LR);function AY(r){Zc(JX,"BidirectionalMergeMode",r)}const RY="concat";class PR extends FR{constructor(e){super(e);const t=e.layer.getConfig(),n={};n.className=e.layer.getClassName(),n.config=t,this.forwardLayer=kl(n),t.goBackwards=t.goBackwards!==!0;const s={};if(s.className=e.layer.getClassName(),s.config=t,this.backwardLayer=kl(s),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=e.mergeMode===void 0?RY:e.mergeMode,AY(this.mergeMode),e.weights)throw new On("weights support is not implemented for Bidirectional layer yet.");this._stateful=e.layer.stateful,this.returnSequences=e.layer.returnSequences,this.returnState=e.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=e.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(e){this._trainable=e,this.forwardLayer!=null&&(this.forwardLayer.trainable=e),this.backwardLayer!=null&&(this.backwardLayer.trainable=e)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(e){const t=e.length,n=Math.floor(t/2);this.forwardLayer.setWeights(e.slice(0,n)),this.backwardLayer.setWeights(e.slice(n))}computeOutputShape(e){let t=this.forwardLayer.computeOutputShape(e);Array.isArray(t)&&Array.isArray(t[0])||(t=[t]),t=t;let n,s,o;return this.returnState&&(o=t.slice(1)),n=t[0],n=n,this.mergeMode==="concat"?(n[n.length-1]*=2,s=[n]):this.mergeMode==null?s=[n,n.slice()]:s=[n],this.returnState?this.mergeMode==null?s.concat(o).concat(o.slice()):[n].concat(o).concat(o.slice()):vo(s)}apply(e,t){let n=t==null?null:t.initialState,s=t==null?null:t.constants;t==null&&(t={});const o=WA(e,n,s,this.numConstants);if(e=o.inputs,n=o.initialState,s=o.constants,Array.isArray(e)&&(n=e.slice(1),e=e[0]),(n==null||n.length===0)&&s==null)return super.apply(e,t);const a=[],i=[];if(n!=null){const u=n.length;if(u%2>0)throw new Ye("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");t.initialState=n,a.push(...n);const h=n.map(d=>new us({shape:d.shape}));this.forwardLayer.stateSpec=h.slice(0,u/2),this.backwardLayer.stateSpec=h.slice(u/2),i.push(...h)}if(s!=null)throw new On("Support for constants in Bidirectional layers is not implemented yet.");const l=a[0]instanceof Ua;for(const u of a)if(u instanceof Ua!==l)throw new Ye("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(l){const u=[e].concat(a),h=this.inputSpec.concat(i),d=this.inputSpec;this.inputSpec=h;const c=super.apply(u,t);return this.inputSpec=d,c}else return super.apply(e,t)}call(e,t){return at(()=>{const n=t.initialState;let s,o;if(n==null)s=this.forwardLayer.call(e,t),o=this.backwardLayer.call(e,t);else{const l=n.slice(0,n.length/2),u=n.slice(n.length/2);s=this.forwardLayer.call(e,Object.assign(t,{initialState:l})),o=this.backwardLayer.call(e,Object.assign(t,{initialState:u}))}let a;this.returnState&&(Array.isArray(s)&&(a=s.slice(1).concat(o.slice(1))),s=s[0],o=o[0]),this.returnSequences&&(o=Fc(o,1));let i;return this.mergeMode==="concat"?i=q2([s,o]):this.mergeMode==="sum"?i=Rt(s,o):this.mergeMode==="ave"?i=We(.5,Rt(s,o)):this.mergeMode==="mul"?i=We(s,o):this.mergeMode==null&&(i=[s,o]),this.returnState?this.mergeMode==null?i.concat(a):[i].concat(a):i})}resetStates(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(e){Tc(this.forwardLayer.name,()=>{this.forwardLayer.build(e)}),Tc(this.backwardLayer.name,()=>{this.backwardLayer.build(e)}),this.built=!0}computeMask(e,t){Array.isArray(t)&&(t=t[0]);let n;if(this.returnSequences?this.mergeMode==null?n=[t,t]:n=t:this.mergeMode==null?n=[null,null]:n=null,this.returnState){const o=this.forwardLayer.states.map(a=>null);return Array.isArray(n)?n.concat(o).concat(o):[n].concat(o).concat(o)}else return n}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(e),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(e)}getConfig(){const e={mergeMode:this.mergeMode},t=super.getConfig();return Object.assign(e,t),e}static fromConfig(e,t){const n=kl(t.layer);if(delete t.layer,t.numConstants!=null)throw new On("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const s=t;return s.layer=n,new e(s)}}PR.className="Bidirectional";Et(PR);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class jR extends rr{constructor(e){super(e),this.scale=e.scale,e.offset?this.offset=e.offset:this.offset=0}getConfig(){const e={scale:this.scale,offset:this.offset},t=super.getConfig();return Object.assign(e,t),e}call(e,t){return at(()=>(e=Mn(e),e.dtype!=="float32"&&(e=nm(e,"float32")),Rt(We(e,this.scale),this.offset)))}}jR.className="Rescaling";Et(jR);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DY=ut();DY.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,r=>{r&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var NI;(function(r){r[r.DT_INVALID=0]="DT_INVALID",r[r.DT_FLOAT=1]="DT_FLOAT",r[r.DT_DOUBLE=2]="DT_DOUBLE",r[r.DT_INT32=3]="DT_INT32",r[r.DT_UINT8=4]="DT_UINT8",r[r.DT_INT16=5]="DT_INT16",r[r.DT_INT8=6]="DT_INT8",r[r.DT_STRING=7]="DT_STRING",r[r.DT_COMPLEX64=8]="DT_COMPLEX64",r[r.DT_INT64=9]="DT_INT64",r[r.DT_BOOL=10]="DT_BOOL",r[r.DT_QINT8=11]="DT_QINT8",r[r.DT_QUINT8=12]="DT_QUINT8",r[r.DT_QINT32=13]="DT_QINT32",r[r.DT_BFLOAT16=14]="DT_BFLOAT16",r[r.DT_QINT16=15]="DT_QINT16",r[r.DT_QUINT16=16]="DT_QUINT16",r[r.DT_UINT16=17]="DT_UINT16",r[r.DT_COMPLEX128=18]="DT_COMPLEX128",r[r.DT_HALF=19]="DT_HALF",r[r.DT_RESOURCE=20]="DT_RESOURCE",r[r.DT_VARIANT=21]="DT_VARIANT",r[r.DT_UINT32=22]="DT_UINT32",r[r.DT_UINT64=23]="DT_UINT64",r[r.DT_FLOAT_REF=101]="DT_FLOAT_REF",r[r.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",r[r.DT_INT32_REF=103]="DT_INT32_REF",r[r.DT_UINT8_REF=104]="DT_UINT8_REF",r[r.DT_INT16_REF=105]="DT_INT16_REF",r[r.DT_INT8_REF=106]="DT_INT8_REF",r[r.DT_STRING_REF=107]="DT_STRING_REF",r[r.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",r[r.DT_INT64_REF=109]="DT_INT64_REF",r[r.DT_BOOL_REF=110]="DT_BOOL_REF",r[r.DT_QINT8_REF=111]="DT_QINT8_REF",r[r.DT_QUINT8_REF=112]="DT_QUINT8_REF",r[r.DT_QINT32_REF=113]="DT_QINT32_REF",r[r.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",r[r.DT_QINT16_REF=115]="DT_QINT16_REF",r[r.DT_QUINT16_REF=116]="DT_QUINT16_REF",r[r.DT_UINT16_REF=117]="DT_UINT16_REF",r[r.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",r[r.DT_HALF_REF=119]="DT_HALF_REF",r[r.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",r[r.DT_VARIANT_REF=121]="DT_VARIANT_REF",r[r.DT_UINT32_REF=122]="DT_UINT32_REF",r[r.DT_UINT64_REF=123]="DT_UINT64_REF"})(NI||(NI={}));var AI;(function(r){(function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"})(r.CheckpointFormatVersion||(r.CheckpointFormatVersion={}))})(AI||(AI={}));/** @license See the LICENSE file. *//**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var RI;(function(r){r[r.FAIL=0]="FAIL",r[r.SHORTEST=1]="SHORTEST",r[r.LONGEST=2]="LONGEST"})(RI||(RI={}));/** @license See the LICENSE file. *//**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tn(r,e){Array.isArray(r)||(r=[r]),r.forEach(t=>{t!=null&&xe(t.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the CPU backend.`)})}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OY=nN;class h1 extends Px{constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new pC(this,tu())}nextDataId(){return h1.nextDataId++}write(e,t,n){this.firstUse&&(this.firstUse=!1,ut().get("IS_NODE")&&ci(`
============================
Hi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. 
============================`));const s={id:this.nextDataId()};return this.data.set(s,{values:e,dtype:n,refCount:1}),s}makeTensorInfo(e,t,n){let s;if(t==="string"&&n!=null&&n.length>0&&Kf(n[0])){const o=n.map(a=>cu(a));s=this.write(o,e,t)}else s=this.write(n,e,t);return{dataId:s,shape:e,dtype:t}}refCount(e){return this.data.has(e)?this.data.get(e).refCount:0}incRef(e){const t=this.data.get(e);t.refCount++}decRef(e){if(this.data.has(e)){const t=this.data.get(e);t.refCount--}}move(e,t,n,s,o){this.data.set(e,{values:t,dtype:s,refCount:o})}numDataIds(){return this.data.numDataIds()}async read(e){return this.readSync(e)}readSync(e){const{dtype:t,complexTensorInfos:n}=this.data.get(e);if(t==="complex64"){const s=this.readSync(n.real.dataId),o=this.readSync(n.imag.dataId);return Cl(s,o)}return this.data.get(e).values}bufferSync(e){const t=this.readSync(e.dataId);if(e.dtype==="string")try{const n=t.map(s=>mu(s));return Wn(e.shape,e.dtype,n)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Wn(e.shape,e.dtype,t)}makeOutput(e,t,n){return tu().makeTensorFromTensorInfo(this.makeTensorInfo(t,n,e),this)}disposeData(e,t=!1){if(this.data.has(e)){if(this.data.get(e).refCount--,!t&&this.data.get(e).refCount>0)return!1;const{complexTensorInfos:n}=this.data.get(e);n!=null&&(this.disposeData(n.real.dataId,!0),this.disposeData(n.imag.dataId,!0)),this.data.delete(e)}return!0}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}async time(e){const t=yo();return e(),{kernelMs:yo()-t}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(e){tn([e],"where");const t=this.readSync(e.dataId);return OY(e.shape,t)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}h1.nextDataId=0;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BR(r){const e=new Float32Array(r.length);for(let t=0;t<r.length;++t)e[t]=Math.abs(r[t]);return e}const MY=r=>{const{x:e}=r.inputs,t=r.backend;tn(e,"abs");let n=new Float32Array(pt(e.shape));const s=t.data.get(e.dataId).values;return n=BR(s),t.makeOutput(n,e.shape,e.dtype)},FY={kernelName:By,backendName:"cpu",kernelFunc:MY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function is(r){return(e,t,n,s,o)=>{const a=Dn(e,t),i=a.length,l=pn(a),u=pt(a),h=Os(o,u),d=e.length,c=t.length,f=pn(e),p=pn(t),m=Jh(e,a),g=Jh(t,a);if(m.length+g.length===0)for(let y=0;y<h.length;++y)h[y]=r(n[y%n.length],s[y%s.length]);else for(let y=0;y<h.length;++y){const v=vd(y,i,l),b=v.slice(-d);m.forEach(C=>b[C]=0);const w=Wa(b,d,f),_=v.slice(-c);g.forEach(C=>_[C]=0);const I=Wa(_,c,p);h[y]=r(n[w],s[I])}return[h,a]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mo(r){const{inputs:e,backend:t}=r,{real:n,imag:s}=e,o=t.data.get(n.dataId).values,a=t.data.get(s.dataId).values,i=t.makeTensorInfo(n.shape,"complex64"),l=t.data.get(i.dataId);return l.complexTensorInfos={real:t.makeTensorInfo(n.shape,"float32",o),imag:t.makeTensorInfo(s.shape,"float32",a)},i}const LY={kernelName:Xx,backendName:"cpu",kernelFunc:Mo};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function my(r,e,t="float32"){if(t==="complex64"){const s=my(r,e,"float32"),o=my(r,e,"float32");return Mo({inputs:{real:s,imag:o},backend:r})}const n=Xs(pt(e),t);return r.makeTensorInfo(e,t,n)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qa(r){const{inputs:e,backend:t}=r,{x:n}=e;return t.incRef(n.dataId),{dataId:n.dataId,shape:n.shape,dtype:n.dtype}}const PY={kernelName:yp,backendName:"cpu",kernelFunc:Qa};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bc(r){const{inputs:e,backend:t}=r,{input:n}=e,s=t.data.get(n.dataId).complexTensorInfos.real,o=t.data.get(s.dataId).values;return t.makeTensorInfo(s.shape,s.dtype,o)}const jY={kernelName:gw,backendName:"cpu",kernelFunc:Bc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UR(r,e,t,n){if(n==="int32"){const s=Int32Array.from(r);return[e,"int32",s]}if(n==="bool"){const s=Kc([0],t),[o,a]=is((i,l)=>i!==l?1:0)(e,[],r,s,"bool");return[a,"bool",o]}throw new Error(`Error in Cast: failed to cast ${t} to ${n}`)}function xu(r){const{inputs:e,backend:t,attrs:n}=r,{x:s}=e,{dtype:o}=n;if(o==="complex64"){if(s.dtype==="complex64")return Qa({inputs:{x:s},backend:t});const h=my(t,s.shape,s.dtype),d=xu({inputs:{x:s},backend:t,attrs:{dtype:"float32"}}),c=Mo({inputs:{real:d,imag:h},backend:t});return t.disposeIntermediateTensorInfo(h),t.disposeIntermediateTensorInfo(d),c}if(s.dtype==="complex64"){const h=Bc({inputs:{input:s},backend:t}),d=xu({inputs:{x:h},backend:t,attrs:{dtype:o}});return t.disposeIntermediateTensorInfo(h),d}if(!yC(s.dtype,o)){const h=Qa({inputs:{x:s},backend:t});return{dataId:h.dataId,shape:h.shape,dtype:o}}const a=t.data.get(s.dataId).values,[i,l,u]=UR(a,s.shape,s.dtype,o);return t.makeTensorInfo(i,l,u)}const BY={kernelName:sp,backendName:"cpu",kernelFunc:xu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Is(r,e,t,n){return t==null?({inputs:s,backend:o})=>{const{a,b:i}=s,l=o;tn([a,i],r);const u=l.data.get(a.dataId).values,h=l.data.get(i.dataId).values,d=a.dtype==="string"?Pc(u):u,c=a.dtype==="string"?Pc(h):h,f=n||a.dtype,[p,m]=e(a.shape,i.shape,d,c,f);return l.makeTensorInfo(m,f,p)}:({inputs:s,backend:o})=>{const{a,b:i}=s,l=o;if(a.dtype==="complex64"||i.dtype==="complex64"){const u=xu({inputs:{x:a},backend:l,attrs:{dtype:"complex64"}}),h=l.data.get(u.dataId),d=h.complexTensorInfos.real,c=h.complexTensorInfos.imag,f=l.data.get(d.dataId).values,p=l.data.get(c.dataId).values,m=xu({inputs:{x:i},backend:l,attrs:{dtype:"complex64"}}),g=l.data.get(m.dataId),y=g.complexTensorInfos.real,v=g.complexTensorInfos.imag,b=l.data.get(y.dataId).values,w=l.data.get(v.dataId).values,[_,I,C]=t(a.shape,i.shape,f,p,b,w),N=l.makeTensorInfo(C,"float32",_),O=l.makeTensorInfo(C,"float32",I),D=Mo({inputs:{real:N,imag:O},backend:l});return l.disposeIntermediateTensorInfo(u),l.disposeIntermediateTensorInfo(m),l.disposeIntermediateTensorInfo(N),l.disposeIntermediateTensorInfo(O),D}else{const u=l.data.get(a.dataId).values,h=l.data.get(i.dataId).values,d=n||a.dtype,[c,f]=e(a.shape,i.shape,u,h,d);return l.makeTensorInfo(f,d,c)}}}function fS(r){return(e,t,n,s,o,a)=>{const i=Dn(e,t),l=pt(i),u=i.length,h=pn(i),d=Os("float32",l),c=Os("float32",l),f=Jh(e,i),p=Jh(t,i),m=Cl(n,s),g=Cl(o,a),y=e.length,v=pn(e),b=t.length,w=pn(t);if(f.length+p.length===0)for(let _=0;_<d.length;_++){const I=_%m.length,C=_%g.length,N=r(m[I*2],m[I*2+1],g[C*2],g[C*2+1]);d[_]=N.real,c[_]=N.imag}else for(let _=0;_<d.length;_++){const I=vd(_,u,h),C=I.slice(-y);f.forEach(P=>C[P]=0);const N=Wa(C,y,v),O=I.slice(-b);p.forEach(P=>O[P]=0);const D=Wa(O,b,w),M=r(m[N*2],m[N*2+1],g[D*2],g[D*2+1]);d[_]=M.real,c[_]=M.imag}return[d,c,i]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zR=is((r,e)=>r+e),UY=fS((r,e,t,n)=>({real:r+t,imag:e+n})),rd=Is(bd,zR,UY),zY={kernelName:bd,backendName:"cpu",kernelFunc:rd};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pS(r,e,t,n,s){const o=pt(n),a=Xs(s,t);for(let i=0;i<r.length;i++){const l=r[i];if(l<0)throw new Error("Input x must be non-negative!");l>=s||(o>0?a[l]+=e[i]:a[l]+=1)}return a}function VR(r,e,t,n=!1){const s=r.shape[0],o=r.shape[1],a=Wn([s,t],e.dtype);for(let i=0;i<s;i++)for(let l=0;l<o;l++){const u=r.get(i,l);if(u<0)throw new Error("Input x must be non-negative!");u>=t||(n?a.set(1,i,u):e.size>0?a.set(a.get(i,u)+e.get(i,l),i,u):a.set(a.get(i,u)+1,i,u))}return a}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Du(r){return(e,t,n)=>{const s=Os(t,e.length);for(let o=0;o<e.length;++o)s[o]=r(e[o],n);return s}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wr(r,e,t){return({inputs:n,attrs:s,backend:o})=>{const{x:a}=n;if(tn(a,r),a.dtype==="string"||t==="string")throw new Error("unaryKernelFunc does not support string input/output");const i=o,l=i.data.get(a.dataId).values,u=pt(a.shape),h=t||a.dtype,d=_s(h,u);for(let c=0;c<u;++c)d[c]=e(l[c],s);return i.makeTensorInfo(a.shape,h,d)}}function Id(r,e,t){return({inputs:n,attrs:s,backend:o})=>{const{x:a}=n;if(tn(a,r),a.dtype==="string"||t==="string")throw new Error("unaryKernelFunc does not support string input/output");const i=o,l=i.data.get(a.dataId).values,u=t||a.dtype,h=e(l,u,s);return i.makeTensorInfo(a.shape,u,h)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GR=Du(r=>Math.ceil(r)),VY=Id(op,GR),GY={kernelName:op,backendName:"cpu",kernelFunc:VY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WR(r,e,t,n){const s=_s(t,pt(e));if(n&&t!=="string"){let o=0;r.forEach(a=>{const i=pt(a.shape);s.set(a.vals,o),o+=i})}else{let o=0;r.forEach(a=>{const i=t==="string"?Pc(a.vals):a.vals;let l=0;for(let u=0;u<a.shape[0];++u){const h=u*e[1]+o;for(let d=0;d<a.shape[1];++d)s[h+d]=i[l++]}o+=a.shape[1]})}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HR=is((r,e)=>r===e?1:0),qR=Is(t0,HR,null,"bool"),WY={kernelName:t0,backendName:"cpu",kernelFunc:qR};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XR=Du(r=>Math.exp(r)),KR=Id(dp,XR,"float32"),HY={kernelName:dp,backendName:"cpu",kernelFunc:KR};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YR=Du(r=>Math.expm1(r)),qY=Id(fp,YR),XY={kernelName:fp,backendName:"cpu",kernelFunc:qY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZR=Du(r=>Math.floor(r)),KY=Id(pp,ZR),YY={kernelName:pp,backendName:"cpu",kernelFunc:KY};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QR(r,e,t,n,s,o,a,i,l){const u=Wn([n,o],t);for(let h=0;h<n;h++){const d=[];let c=0;for(let f=0;f<s;f++){const p=r[h*s+f];c+=p*a[f],d.push(p)}if(c<0||c>=l/o)throw new Error(`Invalid indices: ${d} does not index into ${i}`);for(let f=0;f<o;f++)u.values[h*o+f]=e.get(...e.indexToLoc(c*o+f))}return u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JR(r,e,t){const n=Wn(t,r.dtype);for(let s=0;s<n.size;++s){const a=n.indexToLoc(s).slice(),i=a[0],l=a[2],u=e.locToIndex([i,l]);a[2]=e.values[u];const h=r.locToIndex(a);0<=h&&h<r.values.length&&(n.values[s]=r.values[h])}return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eD=is((r,e)=>r>e?1:0),ZY=Is(o0,eD,null,"bool"),QY={kernelName:o0,backendName:"cpu",kernelFunc:ZY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tD=is((r,e)=>r>=e?1:0),JY=Is(gp,tD,null,"bool"),eZ={kernelName:gp,backendName:"cpu",kernelFunc:JY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nD=is((r,e)=>r<e?1:0),tZ=Is(a0,nD,null,"bool"),nZ={kernelName:a0,backendName:"cpu",kernelFunc:tZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rD=is((r,e)=>r<=e?1:0),rZ=Is(l0,rD,null,"bool"),sZ={kernelName:l0,backendName:"cpu",kernelFunc:rZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sD(r,e,t){const n=(e-r)/(t-1),s=Xs(t,"float32");s[0]=r;for(let o=1;o<s.length;o++)s[o]=s[o-1]+n;return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oD=Du(r=>Math.log(r)),oZ=Id(wp,oD),iZ={kernelName:wp,backendName:"cpu",kernelFunc:oZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iD(r,e,t,n){const s=Os(n,pt(t));for(let o=0;o<s.length;++o){const a=o*e;let i=r[a];for(let l=0;l<e;++l){const u=r[a+l];(Number.isNaN(u)||u>i)&&(i=u)}s[o]=i}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aD=is((r,e)=>Math.max(r,e)),aZ=Is(_p,aD),lZ={kernelName:_p,backendName:"cpu",kernelFunc:aZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lD=is((r,e)=>Math.min(r,e)),uZ=Is(Tp,lD),cZ={kernelName:Tp,backendName:"cpu",kernelFunc:uZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mS=is((r,e)=>r*e),hZ=fS((r,e,t,n)=>({real:r*t-e*n,imag:r*n+e*t})),d1=Is(Ip,mS,hZ),dZ={kernelName:Ip,backendName:"cpu",kernelFunc:d1};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uD(r,e,t){const n=ku(-1,t);return mS([],e,n,r,t)}function fZ(r){const{inputs:e,backend:t}=r,{x:n}=e;tn(n,"neg");const s=t.data.get(n.dataId).values,[o,a]=uD(s,n.shape,n.dtype);return t.makeTensorInfo(a,n.dtype,o)}const pZ={kernelName:b0,backendName:"cpu",kernelFunc:fZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cD=is((r,e)=>r!==e?1:0),mZ=Is(x0,cD,null,"bool"),gZ={kernelName:x0,backendName:"cpu",kernelFunc:mZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gS(r,e,t,n,s){const o=e.length,a=pt(e),i=pn(e),l=pn(s),u=Os(t,pt(s));for(let h=0;h<a;++h){const d=vd(h,o,i),c=new Array(d.length);for(let p=0;p<c.length;p++)c[p]=d[n[p]];const f=Wa(c,o,l);u[f]=r[h]}return u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function So(r){const{inputs:e,attrs:t,backend:n}=r,{x:s}=e,{perm:o}=t;tn(s,"transpose");const a=s.shape.length,i=new Array(a);for(let d=0;d<i.length;d++)i[d]=s.shape[o[d]];const l=n.data.get(s.dataId).values,u=gS(l,s.shape,s.dtype,o,i);return{dataId:n.write(u,i,s.dtype),shape:i,dtype:s.dtype}}const yZ={kernelName:Bh,backendName:"cpu",kernelFunc:So};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hD(r,e,t,n){const[s,o]=ks(r,n),a=Bo(e,"int32"),i=Xs(pt(s),a),l=pt(o);for(let u=0;u<i.length;++u){const h=u*l;let d=1;for(let c=0;c<l;++c)d*=t[h+c];i[u]=d}return{outVals:i,outShape:s,outDtype:a}}function vZ(r){const{inputs:e,backend:t,attrs:n}=r,{x:s}=e,{axis:o,keepDims:a}=n;tn(s,"prod");const i=s.shape.length,l=Hn(o,s.shape),u=qr(l,i);let h=l,d=s;const c=[];u!=null&&(d=So({inputs:{x:s},backend:t,attrs:{perm:u}}),c.push(d),h=ts(h.length,i));const f=t.data.get(d.dataId).values,{outVals:p,outShape:m,outDtype:g}=hD(d.shape,d.dtype,f,h);let y=m;return a&&(y=es(m,l)),c.forEach(v=>t.disposeIntermediateTensorInfo(v)),t.makeTensorInfo(y,g,p)}const bZ={kernelName:I0,backendName:"cpu",kernelFunc:vZ};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xZ(r,e,t){r.forEach((n,s)=>{if(n<0||n>=t){const o=vd(s,e.length,pn(e)).join(",");throw new Error(`indices[${o}] = ${n} is not in [0, ${t})`)}})}function wZ(r,e){for(let t=0;t<r.length;++t){const n=r[t],s=t===r.length-1?e:r[t+1].length;if(n.length===0)throw new Error("Ragged splits may not be empty");if(n[0]<0)throw new Error("Ragged splits must be non-negative");if(n[n.length-1]>s)throw new Error("Ragged splits must not point past values");for(let o=1;o<n.length;++o)if(n[o-1]>n[o])throw new Error("Ragged splits must be sorted in ascending order")}}function SZ(r,e,t,n){const s=[];let o=0;const a=e.length-1+t.length,i=new Array(a).fill(null).map(()=>[0]);wZ(t,n);let l=1;for(let u=0;u<e.length-1;++u){l*=e[u];const h=e[u+1];for(let d=1;d<l+1;++d)i[u].push(d*h)}for(let u=0;u<r.length;++u){let h=r[u],d=r[u]+1;for(let c=0;c<t.length;++c){const f=t[c],p=c+e.length-1;if(p>=0){const m=i[p],g=m[m.length-1]-f[h];for(let y=h;y<d;++y)i[p].push(f[y+1]+g)}h=f[h],d=f[d]}d!==h&&(s.push([h,d]),o+=d-h)}return{outSplits:i,valueSlices:s,numValues:o}}function _Z(r){const e=[];for(let t=0;t<r.length;++t){const n=r[t].length,s=_s("int32",n);e.push(s),r[t].forEach((o,a)=>s[a]=o)}return e}function DI(r,e){const t=r.slice(0,e);for(;t.length<e;)t.push(1);for(let n=e;n<r.length;n++)t[e-1]*=r[n];return t}function TZ(r,e,t,n,s,o){const a=DI(e,2)[1],i=DI(o,2)[1];let l=0;for(const u of t)for(let h=u[0];h<u[1];++h){for(let d=0;d<n;++d)s[l*i+d]=r[h*a+d];++l}}function kZ(r,e,t,n,s){const o=e.slice();o[0]=s;const a=_s(t,pt(o)),i=r.length,l=i===0?0:i/e[0];return TZ(r,e,n,l,a,o),[a,o]}function dD(r,e,t,n,s,o,a,i){if(r.length===0)throw new Error("paramsNestedSplits must be non empty");if(e[0].length===0)throw new Error("Split tensors must not be scalars");const l=e[0][0]-1;if(xZ(o,a,l),n.length===0)throw new Error("params.rank must be nonzero");const u=n[0],{outSplits:h,valueSlices:d,numValues:c}=SZ(o,a,r,u),f=_Z(h),p=kZ(t,n,s,d,c);return[f,p[0],p[1]]}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Ni=aa;class gy{constructor(e,t,n,s,o,a,i,l,u,h){this.shape=e,this.shapeShape=t,this.values=n,this.valuesShape=s,this.valuesDType=o,this.defaultValue=a,this.defaultValueShape=i,this.rowPartitionValues=l,this.rowPartitionValuesShapes=u,this.rowPartitionTypes=lN(h),this.raggedRank=uN(this.rowPartitionTypes)}getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===Ni.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===Ni.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(e){const t=this.getRowPartitionTensor(e-1);switch(this.getRowPartitionTypeByDimension(e-1)){case Ni.VALUE_ROWIDS:return gy.getMaxWidthValueRowID(t);case Ni.ROW_SPLITS:return gy.getMaxWidthRowSplit(t);default:throw new Error(`Cannot handle partition type ${Ni[this.getRowPartitionTypeByDimension(e-1)]}`)}}static getMaxWidthRowSplit(e){const t=e.length;if(t===0||t===1)return 0;let n=0;for(let s=0;s<t-1;++s){const o=e[s+1]-e[s];o>n&&(n=o)}return n}static getMaxWidthValueRowID(e){const t=e.length;if(t===0)return 0;let n=0,s=e[0],o=0;for(let a=1;a<t;++a){const i=e[a];i!==s&&(s=i,o=Math.max(a-n,o),n=a)}return Math.max(t-n,o)}tensorShapeFromTensor(e,t,n=!0){if(t.length===0){if(e[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return MI(e,n)}calculateOutputSize(e){const t=this.valuesShape,n=this.defaultValueShape;cN(n,t);const s=this.tensorShapeFromTensor(this.shape,this.shapeShape),a=aN(this.raggedRank,s,t);a[0]<0&&(a[0]=e);for(let i=1;i<=this.raggedRank;++i)a[i]<0&&(a[i]=this.getMaxWidth(i));return a}calculateFirstParentOutputIndex(e,t,n){const s=Math.min(e,n),o=[];let a=0;for(let i=0;i<s;++i,a+=t)o.push(a);for(let i=s;i<e;++i)o.push(-1);return xe(o.length===e,()=>"Final length of result must be equal to firstDimension."),o}calculateOutputIndexRowSplit(e,t,n,s){const o=e.length,a=[];for(let i=0;i<o-1;++i){const l=e[i+1]-e[i];let u=Math.min(s,l),h=t[i];h===-1&&(u=0);for(let d=0;d<u;++d)a.push(h),h+=n;for(let d=0;d<l-u;++d)a.push(-1)}if(o>0&&a.length!==e[o-1])throw new Error("Invalid row split size.");return a}calculateOutputIndexValueRowID(e,t,n,s){const o=e.length,a=[];if(o===0)return[];let i=0,l=e[0];if(l>=t.length)throw new Error(`Got currentValueRowId=${l}, which is not less than ${t.length}`);let u=t[l];a.push(u);for(let h=1;h<o;++h){const d=e[h];if(d===l)u>=0&&(++i,i<s?u+=n:u=-1);else{if(i=0,l=d,d>=t.length)throw new Error(`Got nextValueRowId=${d} which is not less than ${t.length}`);u=t[d]}a.push(u)}if(a.length!==e.length)throw new Error("Invalid row ids.");return a}calculateOutputIndex(e,t,n,s){const o=this.getRowPartitionTensor(e),a=this.getRowPartitionTypeByDimension(e);switch(a){case Ni.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(o,t,n,s);case Ni.ROW_SPLITS:if(o.length-1>t.length)throw new Error(`Row partition size is greater than output size: ${o.length-1} > ${t.length}`);return this.calculateOutputIndexRowSplit(o,t,n,s);default:throw new Error(`Unsupported partition type: ${Ni[a]}`)}}getFirstDimensionSize(){const e=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");const t=this.rowPartitionTypes[0];switch(t){case Ni.FIRST_DIM_SIZE:return e[0];case Ni.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case Ni.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${Ni[t]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const t=this.getFirstDimensionSize(),n=this.calculateOutputSize(t),s=new Array(this.raggedRank+1);s[s.length-1]=1;for(let l=s.length-2;l>=0;--l)s[l]=s[l+1]*n[l+1];const o=MI(n,!1),a=_s(this.valuesDType,pt(o));if(s[0]*n[0]>0){let l=this.calculateFirstParentOutputIndex(t,s[0],n[0]);for(let u=1;u<=this.raggedRank;++u)l=this.calculateOutputIndex(u-1,l,s[u],n[u]);this.setOutput(this.raggedRank,l,a,o)}return[o,a]}setOutput(e,t,n,s){if(n.length===0)return;const o=this.values,a=n;let i=s.slice();i=i.slice(e+1);const l=pt(i),u=t.length;let h=this.defaultValue;if(h.length!==l&&h.length!==1){const p=this.defaultValueShape;at(()=>{const m=Qe(h,p);h=Sf(m,i).dataSync()})}let d=0,c=0,f=0;for(let p=0;p<=u;++p){let m=p<u?t[p]:-1;if(m===f){++f;continue}if(c<f){const g=o.subarray(d*l),y=a.subarray(c*l),v=(f-c)*l;OI(y,g,v)}if(p>=u){const g=n.length;m=Math.floor(g/l)}if(m>f)if(this.defaultValue.length===1)a.subarray(f*l,m*l).fill(this.defaultValue[0]),f=m;else for(;m>f;){const g=a.slice(f*l);OI(g,h,l),++f}m<0?(d=p+1,c=f):(d=p,c=f,f=c+1)}}}function OI(r,e,t){for(let n=0;n<t;n++)r[n]=e[n]}function MI(r,e){const t=[];for(let n of r){if(n<0){if(!e)throw new Error(`Dimension ${n} must be >= 0`);if(n<-1)throw new Error(`Dimension ${n} must be >= -1`);n=-1}t.push(n)}return t}function fD(r,e,t,n,s,o,a,i,l,u){return new gy(r,e,t,n,s,o,a,i,l,u).compute()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pD(r,e,t,n){const s=r===e,o=r<e&&t<0,a=e<r&&t>1;if(s||o||a)return Xs(0,n);const i=Math.abs(Math.ceil((e-r)/t)),l=Xs(i,n);e<r&&t===1&&(t=-1),l[0]=r;for(let u=1;u<l.length;u++)l[u]=l[u-1]+t;return l}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mD=Du(r=>1/Math.sqrt(r)),IZ=Id(Rp,mD),EZ={kernelName:Rp,backendName:"cpu",kernelFunc:IZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lh(r,e,t,n,s,o,a,i,l,u){const h=[n/s,s],d=r.values,c=e.values;if(n===0)return Wn(t,e.dtype);const f=Wn(h,e.dtype);typeof l=="string"||typeof l=="number"?f.values.fill(l):typeof l=="boolean"&&f.values.fill(+l);for(let p=0;p<o;p++){const m=[];let g=0;for(let y=0;y<a;y++){const v=d[p*a+y];m.push(v),g+=v*i[y]}if(g<0||g>=n/s)throw new Error(`Invalid indices: ${m} does not index into ${t}`);for(let y=0;y<s;y++)u?f.values[g*s+y]+=c[p*s+y]:f.values[g*s+y]=e.rank===0?c[0]:c[p*s+y]}return f}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CZ=Du(r=>1/(1+Math.exp(-r))),gD=wr(Lp,r=>1/(1+Math.exp(-r))),$Z={kernelName:Lp,backendName:"cpu",kernelFunc:gD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yD(r,e,t,n,s){const o=Bw(n,e,t),a=pt(t),i=pn(n);if(o){const d=Uw(e,i);return s==="string"?r.slice(d,d+a):r.subarray(d,d+a)}const l=s==="string"?Pc(r):r,u=Wn(n,s,l),h=Wn(t,s);for(let d=0;d<h.size;++d){const c=h.indexToLoc(d),f=c.map((p,m)=>p+e[m]);h.set(u.get(...f),...c)}return s==="string"?NN(h.values):h.values}function Uc(r){const{inputs:e,backend:t,attrs:n}=r,{x:s}=e,{begin:o,size:a}=n;tn(s,"slice");const[i,l]=G0(s,o,a);Pw(s,i,l);const u=t.data.get(s.dataId).values,h=yD(u,i,l,s.shape,s.dtype);return t.makeTensorInfo(l,s.dtype,h)}const NZ={kernelName:R0,backendName:"cpu",kernelFunc:Uc};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vD(r,e,t,n,s,o,a){const i=e[0],l=o[0],u=new Array(l),h=new Array(i),d=e[1];if(l===0){if(i!==0)throw new Error(yN(i));const g=_s(t,0),y=_s(s,0);return[g,[0,d],y,u,h]}let c=!0,f=0;const p=new Array(l).fill(0);for(let g=0;g<i;++g){const y=r[g*d];if(y<0)throw new Error(vN(g,y));if(y>=l)throw new Error(bN(g,y,l));++p[y],c=c&&y>=f,f=y}let m=!0;for(let g=0;g<l;++g){const y=p[g]===0;u[g]=y,m=m&&!y,p[g]=Math.max(p[g],1),g>0&&(p[g]+=p[g-1])}if(m&&c){const g=r,y=n;for(let v=0;v<i;++v)h[v]=v;return[g,[i,d],y,u,h]}else{const g=p[l-1],y=_s(t,g*d),v=_s(s,g),b=new Array(l).fill(0);for(let w=0;w<i;++w){const _=r[w*d],I=b[_],C=(_===0?0:p[_-1])+I;b[_]++;for(let N=0;N<d;++N)y[C*d+N]=r[w*d+N];v[C]=n[w],h[w]=C}for(let w=0;w<l;++w)if(b[w]===0){const I=w===0?0:p[w-1];y[I*d+0]=w;for(let C=1;C<d;++C)y[I*d+C]=0;v[I]=a}return[y,[g,d],v,u,h]}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bD(r,e,t,n,s){const o=pt(n),a=e[0],i=s.length,l=[];let u=1,h=-1;for(let g=0;g<i;++g){const y=s[g];if(y===-1){if(h!==-1)throw new Error(xN(h,g));h=g,l.push(1)}else{if(y<0)throw new Error(wN(g,y));u*=y,l.push(y)}}if(h!==-1){if(u<=0)throw new Error(SN());const g=Math.trunc(o/u);if(u*g!==o)throw new Error(_N(n,l));l[h]=g}if(pt(l)!==o)throw new Error(TN(n,l));const c=n.length,f=[];if(c>0){f[c-1]=1;for(let g=c-2;g>=0;--g)f[g]=f[g+1]*n[g+1]}const p=[];if(i>0){p[i-1]=1;for(let g=i-2;g>=0;--g)p[g]=p[g+1]*l[g+1]}const m=_s(t,a*i);for(let g=0;g<a;++g){let y=0;for(let v=0;v<c;++v)y+=r[g*c+v]*f[v];for(let v=0;v<i;++v)m[g*i+v]=Math.trunc(y/p[v]),y%=p[v]}return[m,[a,i],l]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yS(r,e,t,n,s,o=!1,a=0){const i=n.length,l=[e[0],r.length/e[0]],u=l[1],d=i>0?s[i-1]+1:0;if(d<0)throw new Error(Pb());const c=e.slice();c[0]=d;const f=c.reduce((b,w)=>b*w,1),p=_s(t,f);if(i===0)return d>0&&p.fill(a),[p,c];if(d<=0)throw new Error(Pb());let m=0,g=1,y=0,v=s[m];for(;;){let b=0;if(g<i){if(b=s[g],v===b){++g;continue}if(v>=b)throw new Error(kN())}if(v<0||v>=d)throw new Error(IN(v,d));v>y&&p.fill(a,y*u,v*u);for(let w=m;w<g;++w){const _=n[w];if(_<0||_>=l[0])throw new Error(EN(w,n[w],l[0]));for(let I=0;I<u;I++)p[v*u+I]+=r[_*u+I]}if(o)for(let w=0;w<u;w++)p[v*u+w]/=g-m;if(m=g,++g,y=v+1,v=b,g>i)break}return y<d&&p.fill(a,y*u,d*u),[p,c]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AZ=Du(r=>Math.sqrt(r)),RZ=wr(jp,r=>Math.sqrt(r)),DZ={kernelName:jp,backendName:"cpu",kernelFunc:RZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xD=is((r,e)=>{const t=r-e;return t*t}),OZ=Is(Bp,xD),MZ={kernelName:Bp,backendName:"cpu",kernelFunc:OZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wD(r,e,t,n){const s=Wn(r,e.dtype);for(let o=0;o<s.size;o++){const a=s.indexToLoc(o),i=new Array(a.length);for(let l=0;l<i.length;l++)i[l]=a[l]*t[l]+n[l];s.set(e.get(...i),...a)}return s}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class FZ{constructor(e,t,n,s,o,a){this.separator=cu(e),this.nGramWidths=t,this.leftPad=cu(n),this.rightPad=cu(s),this.padWidth=o,this.preserveShort=a}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,t){const n=this.getPadWidth(t);return Math.max(0,e+2*n-t+1)}createNGrams(e,t,n,s,o,a){for(let i=0;i<o;++i){const l=this.getPadWidth(a),u=Math.max(0,l-i),h=Math.max(0,l-(o-(i+1))),d=a-(u+h),c=t+(u>0?0:i-l);let f=0;f+=u*this.leftPad.length;for(let v=0;v<d;++v)f+=e[c+v].length;f+=h*this.rightPad.length,f+=(u+h+d-1)*this.separator.length,n[s+i]=new Uint8Array(f);const m=n[s+i];let g=0;const y=v=>v.forEach(b=>m[g++]=b);for(let v=0;v<u;++v)y(this.leftPad),y(this.separator);for(let v=0;v<d-1;++v)y(e[c+v]),y(this.separator);if(d>0){y(e[c+d-1]);for(let v=0;v<h;++v)y(this.separator),y(this.rightPad)}else{for(let v=0;v<h-1;++v)y(this.rightPad),y(this.separator);y(this.rightPad)}}}compute(e,t){const n=e.length,s=t.length;if(s>0){let l=t[0];if(l!==0)throw new Error(`First split value must be 0, got ${l}`);for(let u=1;u<s;++u){let h=t[u]>=l;if(h=h&&t[u]<=n,!h)throw new Error(`Invalid split value ${t[u]}, must be in [${l}, ${n}]`);l=t[u]}if(l!==n)throw new Error(`Last split value must be data size. Expected ${n}, got ${l}`)}const o=s-1,a=_s("int32",s);if(n===0||s===0){const l=new Array(n);for(let u=0;u<=o;++u)a[u]=0;return[l,a]}a[0]=0;for(let l=1;l<=o;++l){const u=t[l]-t[l-1];let h=0;this.nGramWidths.forEach(d=>{h+=this.getNumNGrams(u,d)}),this.preserveShort&&u>0&&h===0&&(h=1),a[l]=a[l-1]+h}const i=new Array(a[o]);for(let l=0;l<o;++l){const u=t[l];let h=a[l];if(this.nGramWidths.forEach(d=>{const c=t[l+1]-t[l],f=this.getNumNGrams(c,d);this.createNGrams(e,u,i,h,f,d),h+=f}),this.preserveShort&&h===a[l]){const d=t[l+1]-t[l];if(d===0)continue;const c=d+2*this.padWidth,f=1;this.createNGrams(e,u,i,h,f,c)}}return[i,a]}}function SD(r,e,t,n,s,o,a,i){return new FZ(t,n,s,o,a,i).compute(r,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LZ(r,e,t,n){if(!r.length)return;if(e.length===0){for(let o=0;o<r.length;++o)n.push(r.subarray(o,o+1));return}if(e.length===1){const o=e[0];let a=r.indexOf(o);for(;a!==-1;){const i=r.subarray(0,a);(!t||i.length!==0)&&n.push(i),r=r.subarray(a+1),a=r.indexOf(o)}(!t||r.length!==0)&&n.push(r);return}let s=0;for(let o=0;o<r.length+1;o++)if(o===r.length||e.indexOf(r[o])!==-1){const a=r.subarray(s,o);(!t||a.length!==0)&&n.push(a),s=o+1}}function _D(r,e,t){const n=r.length,s=[];let o=0,a=0;const i=new Array(n);for(let c=0;c<n;++c){const f=s.length;LZ(r[c],e,t,s);const p=s.length-f;i[c]=p,o+=p,a=Math.max(a,p)}const l=_s("int32",o*2),u=new Array(o),h=[n,a];let d=0;for(let c=0;c<n;++c)for(let f=0;f<i[c];++f)l[d*2]=c,l[d*2+1]=f,u[d]=s[d],++d;return[l,u,h]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TD(r,e){const t=_s("int32",r.length);for(let n=0;n<r.length;++n)t[n]=fV(r[n]).modulo(e).getLowBitsUnsigned();return t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kD=is((r,e)=>r-e),PZ=fS((r,e,t,n)=>({real:r-t,imag:e-n})),vS=Is(Up,kD,PZ),jZ={kernelName:Up,backendName:"cpu",kernelFunc:vS};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ID(r,e){const t=new Array(r.rank);for(let s=0;s<t.length;s++)t[s]=r.shape[s]*e[s];const n=Wn(t,r.dtype);for(let s=0;s<n.values.length;++s){const o=n.indexToLoc(s),a=new Array(r.rank);for(let l=0;l<a.length;l++)a[l]=o[l]%r.shape[l];const i=r.locToIndex(a);n.values[s]=r.values[i]}return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hf=(r,e)=>{const t=e.value-r.value;return t===0?r.index-e.index:t};function ED(r,e,t=0,n=r.length-1){for(;n>t;){if(n-t>600){const i=n-t+1,l=e-t+1,u=Math.log(i),h=.5*Math.exp(2*u/3),d=.5*Math.sqrt(u*h*(i-h)/i)*Math.sign(l-i/2),c=Math.max(t,Math.floor(e-l*h/i+d)),f=Math.min(n,Math.floor(e+(i-l)*h/i+d));ED(r,e,c,f)}const s=r[e];let o=t,a=n;for(Ah(r,t,e),hf(r[n],s)>0&&Ah(r,t,n);o<a;){for(Ah(r,o,a),o++,a--;hf(r[o],s)<0;)o=o+1;for(;hf(r[a],s)>0;)a=a-1}hf(r[t],s)===0?Ah(r,t,a):(a=a+1,Ah(r,a,n)),a<=e&&(t=a+1),e<=a&&(n=a-1)}}function CD(r,e,t,n,s){const o=e[e.length-1],[a,i]=[r.length/o,o],l=Os(t,a*n),u=Os("int32",a*n);for(let d=0;d<a;d++){const c=d*i,f=r.subarray(c,c+i);let p=new Array(f.length);f.forEach((v,b)=>p[b]={value:v,index:b}),n<p.length&&(ED(p,n),p=p.slice(0,n)),s&&p.sort(hf);const m=d*n,g=l.subarray(m,m+n),y=u.subarray(m,m+n);for(let v=0;v<n;v++)g[v]=p[v].value,y[v]=p[v].index}const h=e.slice();return h[h.length-1]=n,[Wn(h,t,l),Wn(h,"int32",u)]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $D(r,e,t,n){const s=Hn(e,t)[0],o=[1,t[0],1];for(let p=0;p<s;p++)o[0]*=t[p];o[1]=t[s];for(let p=s+1;p<t.length;p++)o[2]*=t[p];const a={},i=new Int32Array(t[s]),l=new Ws(o,n,r),u=[],h=o[0]===1&&o[2]===1;for(let p=0;p<t[s];p++){let m;if(h)m=r[p].toString();else{const g=[];for(let y=0;y<o[0];y++)for(let v=0;v<o[2];v++)g.push(l.get(y,p,v));m=g.join(",")}if(a[m]!==void 0)i[p]=a[m];else{const g=Object.keys(a).length;a[m]=g,i[p]=g,u.push(p)}}const d=o.slice();d[1]=Object.keys(a).length;const c=new Ws(d,n);u.forEach((p,m)=>{for(let g=0;g<o[0];g++)for(let y=0;y<o[2];y++)c.set(l.get(g,p,y),g,m,y)});const f=t.slice();return f[s]=d[1],{outputValues:c.values,outputShape:f,indices:i}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var BZ=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",simpleAbsImpl:BR,addImpl:zR,bincountImpl:pS,bincountReduceImpl:VR,castImpl:UR,ceilImpl:GR,concatImpl:WR,equalImpl:HR,expImpl:XR,expm1Impl:YR,floorImpl:ZR,gatherNdImpl:QR,gatherV2Impl:JR,greaterImpl:eD,greaterEqualImpl:tD,lessImpl:nD,lessEqualImpl:rD,linSpaceImpl:sD,logImpl:oD,maxImpl:iD,maximumImpl:aD,minimumImpl:lD,multiplyImpl:mS,negImpl:uD,notEqualImpl:cD,prodImpl:hD,raggedGatherImpl:dD,raggedTensorToTensorImpl:fD,rangeImpl:pD,rsqrtImpl:mD,scatterImpl:Lh,sigmoidImpl:CZ,sliceImpl:yD,sparseFillEmptyRowsImpl:vD,sparseReshapeImpl:bD,sparseSegmentReductionImpl:yS,sqrtImpl:AZ,squaredDifferenceImpl:xD,stridedSliceImpl:wD,stringNGramsImpl:SD,stringSplitImpl:_D,stringToHashBucketFastImpl:TD,subImpl:kD,tileImpl:ID,topKImpl:CD,transposeImpl:gS,uniqueImpl:$D});/** @license See the LICENSE file. *//**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */h$("cpu",()=>new h1,1);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ND=wr(cp,r=>r>=0?r:Math.exp(r)-1),UZ={kernelName:cp,backendName:"cpu",kernelFunc:ND};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AD(r){const{inputs:e,backend:t,attrs:n}=r,{x:s}=e,{alpha:o}=n;tn([s],"leakyRelu");const a=pt(s.shape),i=t.data.get(s.dataId).values,l=Os("float32",a);for(let u=0;u<i.length;u++)l[u]=i[u]<0?o*i[u]:i[u];return t.makeTensorInfo(s.shape,"float32",l)}const zZ={kernelName:i0,backendName:"cpu",kernelFunc:AD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VZ=is((r,e)=>r<0?e*r:r);function RD(r){const{inputs:e,backend:t}=r,{x:n,alpha:s}=e;tn([n,s],"prelu");const o=t.data.get(n.dataId).values,a=t.data.get(s.dataId).values,[i,l]=VZ(n.shape,s.shape,o,a,"float32");return t.makeTensorInfo(l,"float32",i)}const GZ={kernelName:k0,backendName:"cpu",kernelFunc:RD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DD=wr($p,r=>Math.max(0,r)),WZ={kernelName:$p,backendName:"cpu",kernelFunc:DD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OD=wr(Np,r=>Math.min(Math.max(0,r),6)),HZ={kernelName:Np,backendName:"cpu",kernelFunc:OD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yy(r,e,t,n,s){if(t==="linear")return Qa({inputs:{x:e},backend:r});if(t==="relu")return DD({inputs:{x:e},backend:r});if(t==="elu")return ND({inputs:{x:e},backend:r});if(t==="relu6")return OD({inputs:{x:e},backend:r});if(t==="prelu")return RD({inputs:{x:e,alpha:n},backend:r});if(t==="leakyrelu")return AD({inputs:{x:e},backend:r,attrs:{alpha:s}});if(t==="sigmoid")return gD({inputs:{x:e},backend:r});throw new Error(`Activation ${t} has not been implemented for the CPU backend.`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rr(r){const{inputs:e,backend:t,attrs:n}=r,{x:s}=e,{shape:o}=n,a=pt(s.shape),i=gC(o,a),l=pt(i);xe(a===l,()=>`The new shape (${i}) has ${l} elements and the old shape (${s.shape}) has ${a} elements. The new shape and old shape must have the same number of elements.`),t.incRef(s.dataId);const u=t.data.get(s.dataId);if(u.complexTensorInfos!=null){const h=u.complexTensorInfos.real,d=u.complexTensorInfos.imag;h.shape=i,d.shape=i}return{dataId:s.dataId,shape:i,dtype:s.dtype}}const qZ={kernelName:E0,backendName:"cpu",kernelFunc:Rr};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MD(r){const{inputs:e,backend:t,attrs:n}=r,{a:s,b:o}=e,{transposeA:a,transposeB:i}=n;tn([s,o],"matMul");const l=s.shape.length,u=o.shape.length,h=a?s.shape[l-2]:s.shape[l-1],d=i?o.shape[u-1]:o.shape[u-2],c=a?s.shape[l-1]:s.shape[l-2],f=i?o.shape[u-2]:o.shape[u-1],p=s.shape.slice(0,-2),m=o.shape.slice(0,-2),g=pt(p),y=pt(m),b=Dn(s.shape.slice(0,-2),o.shape.slice(0,-2)).concat([c,f]);xe(h===d,()=>`Error in matMul: inner shapes (${h}) and (${d}) of Tensors with shapes ${s.shape} and ${o.shape} and transposeA=${a} and transposeB=${i} must match.`);const w=a?[g,h,c]:[g,c,h],_=i?[y,f,d]:[y,d,f],I=Rr({inputs:{x:s},backend:t,attrs:{shape:w}}),C=Rr({inputs:{x:o},backend:t,attrs:{shape:_}}),N=a?I.shape[1]:I.shape[2],O=a?I.shape[2]:I.shape[1],D=i?C.shape[1]:C.shape[2],M=Math.max(g,y),P=t.data.get(I.dataId).values,F=t.data.get(C.dataId).values,B=pn(I.shape),z=pn(C.shape),[Z,Q,K]=a?[B[0],1,B[1]]:[B[0],B[1],1],[ne,re,ce]=i?[1,z[1],z[0]]:[z[1],1,z[0]],be=O*D,we=Wn([M,O,D],I.dtype),ye=we.values,Oe=t.blockSize;for(let Se=0;Se<M;Se++)for(let Ee=0;Ee<O;Ee+=Oe)for(let j=0;j<D;j+=Oe)for(let W=0;W<N;W+=Oe){const J=Math.min(Ee+Oe,O),ie=Math.min(j+Oe,D),ve=Math.min(W+Oe,N);for(let he=Ee;he<J;he++)for(let Fe=j;Fe<ie;Fe++){let me=0;for(let Le=W;Le<ve;Le++){const De=Math.min(Se,g-1)*Z,Ne=Math.min(Se,y-1)*ce,rt=P[De+he*Q+Le*K],tt=F[Le*ne+Fe*re+Ne];me+=rt*tt}ye[Se*be+(he*D+Fe)]+=me}}return t.disposeIntermediateTensorInfo(I),t.disposeIntermediateTensorInfo(C),t.makeTensorInfo(b,we.dtype,we.values)}const XZ={kernelName:Wy,backendName:"cpu",kernelFunc:MD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KZ(r){const{inputs:e,backend:t,attrs:n}=r,{a:s,b:o,bias:a,preluActivationWeights:i}=e,{transposeA:l,transposeB:u,activation:h,leakyreluAlpha:d}=n;let c,f,p;const m=[];c=MD({inputs:{a:s,b:o},attrs:{transposeA:l,transposeB:u},backend:t}),a&&(f=rd({inputs:{a:c,b:a},backend:t}),m.push(c),c=f),h&&(p=yy(t,c,h,i,d),m.push(c),c=p);for(const y of m)t.disposeIntermediateTensorInfo(y);return c}const YZ={kernelName:Yg,backendName:"cpu",kernelFunc:KZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZZ=wr(Zf,r=>Math.acos(r)),QZ={kernelName:Zf,backendName:"cpu",kernelFunc:ZZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JZ=wr(Qf,r=>Math.acosh(r)),eQ={kernelName:Qf,backendName:"cpu",kernelFunc:JZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tQ(r){const{inputs:e,backend:t}=r,n=e;tn(e,"addN");const s=n.map(i=>t.data.get(i.dataId).values),o=Wn(n[0].shape,n[0].dtype),a=o.values;for(let i=0;i<n.length;i++){const l=s[i];for(let u=0;u<a.length;u++)a[u]+=l[u]}return t.makeTensorInfo(o.shape,o.dtype,o.values)}const nQ={kernelName:zx,backendName:"cpu",kernelFunc:tQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rQ(r){const{inputs:e,backend:t,attrs:n}=r,{x:s}=e,{axis:o,keepDims:a}=n;tn(s,"all");const i=Hn(o,s.shape);let l=i;const u=qr(l,s.shape.length);let h=s;u!=null&&(h=So({inputs:{x:s},backend:t,attrs:{perm:u}}),l=ts(l.length,s.shape.length)),Fs("all",l,h.shape.length);const[d,c]=ks(h.shape,l),f=pt(c),p=Xs(pt(d),h.dtype),m=t.data.get(h.dataId).values;for(let y=0;y<p.length;++y){const v=y*f;let b=m[v];for(let w=0;w<f;++w){const _=m[v+w];b=b&&_}p[y]=b}u!=null&&t.disposeIntermediateTensorInfo(h);const g=t.makeTensorInfo(d,h.dtype,p);if(a){const y=es(d,i),v=Rr({inputs:{x:g},backend:t,attrs:{shape:y}});return t.disposeIntermediateTensorInfo(g),v}return g}const sQ={kernelName:Vx,backendName:"cpu",kernelFunc:rQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oQ(r){const{inputs:e,backend:t,attrs:n}=r,{x:s}=e,{axis:o,keepDims:a}=n;tn(s,"any");const i=Hn(o,s.shape);let l=i;const u=qr(l,s.shape.length);let h=s;u!=null&&(h=So({inputs:{x:s},backend:t,attrs:{perm:u}}),l=ts(l.length,s.shape.length)),Fs("any",l,h.shape.length);const[d,c]=ks(h.shape,l),f=pt(c),p=Xs(pt(d),h.dtype),m=t.data.get(h.dataId).values;for(let y=0;y<p.length;++y){const v=y*f;let b=m[v];for(let w=0;w<f;++w){const _=m[v+w];b=b||_}p[y]=b}u!=null&&t.disposeIntermediateTensorInfo(h);const g=t.makeTensorInfo(d,h.dtype,p);if(a){const y=es(d,i),v=Rr({inputs:{x:g},backend:t,attrs:{shape:y}});return t.disposeIntermediateTensorInfo(g),v}return g}const iQ={kernelName:Gx,backendName:"cpu",kernelFunc:oQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aQ(r){const{inputs:e,backend:t,attrs:n}=r,{x:s}=e,{axis:o}=n;tn(s,"argMax");let a=Hn(o,s.shape);const i=qr(a,s.shape.length);let l=s;const u=[];i!=null&&(l=So({inputs:{x:s},backend:t,attrs:{perm:i}}),u.push(l),a=ts(a.length,l.shape.length)),a=[a[0]],Fs("argMax",a,l.shape.length);const[h,d]=ks(l.shape,a),c=pt(h),f=Xs(c,"int32"),p=pt(d),m=t.data.get(l.dataId).values;for(let g=0;g<f.length;++g){const y=g*p;let v=m[y],b=0;for(let w=0;w<p;++w){const _=m[y+w];_>v&&(v=_,b=w)}f[g]=b}return u.forEach(g=>t.disposeIntermediateTensorInfo(g)),t.makeTensorInfo(h,"int32",f)}const lQ={kernelName:Uy,backendName:"cpu",kernelFunc:aQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uQ(r){const{inputs:e,backend:t,attrs:n}=r,{x:s}=e,{axis:o}=n;tn(s,"argMin");let a=Hn(o,s.shape);const i=qr(a,s.shape.length);let l=s;const u=[];i!=null&&(l=So({inputs:{x:s},backend:t,attrs:{perm:i}}),u.push(l),a=ts(a.length,l.shape.length)),a=[a[0]],Fs("argMin",a,l.shape.length);const[h,d]=ks(l.shape,a),c=pt(h),f=Xs(c,"int32"),p=pt(d),m=t.data.get(l.dataId).values;for(let g=0;g<f.length;++g){const y=g*p;let v=m[y],b=0;for(let w=0;w<p;++w){const _=m[y+w];_<v&&(v=_,b=w)}f[g]=b}return u.forEach(g=>t.disposeIntermediateTensorInfo(g)),t.makeTensorInfo(h,"int32",f)}const cQ={kernelName:zy,backendName:"cpu",kernelFunc:uQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hQ=wr(Jf,r=>Math.asin(r)),dQ={kernelName:Jf,backendName:"cpu",kernelFunc:hQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fQ=wr(ep,r=>Math.asinh(r)),pQ={kernelName:ep,backendName:"cpu",kernelFunc:fQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mQ=wr(tp,r=>Math.atan(r)),gQ={kernelName:tp,backendName:"cpu",kernelFunc:mQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yQ=is((r,e)=>Math.atan2(r,e)),vQ=Is(rp,yQ),bQ={kernelName:rp,backendName:"cpu",kernelFunc:vQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xQ=wr(np,r=>Math.atanh(r)),wQ={kernelName:np,backendName:"cpu",kernelFunc:xQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bS(r,e,t,n,s,o){const a=s.strideHeight,i=s.strideWidth,l=s.dilationHeight,u=s.dilationWidth,h=s.effectiveFilterHeight,d=s.effectiveFilterWidth,c=s.padInfo.top,f=s.padInfo.left,p=o==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,m=Wn(s.outShape,t),g=m.values,y=s.outShape[1]*s.outShape[2]*s.outShape[3],v=s.outShape[2]*s.outShape[3],b=s.outShape[3];for(let w=0;w<s.batchSize;++w){const _=w*y,I=w*n[0];for(let C=0;C<s.inChannels;++C)for(let N=0;N<s.outHeight;++N){const O=N*a-c,D=Math.max(0,O),M=Math.min(s.inHeight,h+O),P=_+N*v;for(let F=0;F<s.outWidth;++F){const B=F*i-f,z=Math.max(0,B),Z=Math.min(s.inWidth,d+B);let Q=p,K=0,ne=0;for(let ce=D;ce<M;ce+=l){const be=I+ce*n[1];for(let we=z;we<Z;we+=u){const ye=be+we*n[2],Oe=r[ye+C];o==="max"&&Oe>Q?Q=Oe:o==="avg"&&(K+=Oe,ne++)}if(isNaN(Q))break}const re=P+F*b+C;g[re]=o==="avg"?K/ne:Q}}}return m}function FD(r,e,t,n,s=!1,o=!1){const a=Wn(n.outShape,"int32"),i=n.strideHeight,l=n.strideWidth,u=n.dilationHeight,h=n.dilationWidth,d=n.effectiveFilterHeight,c=n.effectiveFilterWidth,f=n.padInfo.top,p=n.padInfo.left,m=Wn(e,t,r);for(let g=0;g<n.batchSize;++g)for(let y=0;y<n.inChannels;++y)for(let v=0;v<n.outHeight;++v){const b=v*i-f;let w=b;for(;w<0;)w+=u;const _=Math.min(n.inHeight,d+b);for(let I=0;I<n.outWidth;++I){const C=I*l-p;let N=C;for(;N<0;)N+=h;const O=Math.min(n.inWidth,c+C);let D=Number.NEGATIVE_INFINITY,M=-1;for(let P=w;P<_;P+=u){const F=P-b;for(let B=N;B<O;B+=h){const z=B-C,Z=m.get(g,P,B,y);Z>D&&(D=Z,s?M=o?((g*n.inHeight+P)*n.inWidth+B)*n.inChannels+y:(P*n.inWidth+B)*n.inChannels+y:M=F*c+z)}}a.set(M,g,v,I,y)}}return a}function LD(r,e,t,n,s,o){const a=s.strideDepth,i=s.strideHeight,l=s.strideWidth,u=s.dilationDepth,h=s.dilationHeight,d=s.dilationWidth,c=s.effectiveFilterDepth,f=s.effectiveFilterHeight,p=s.effectiveFilterWidth,m=s.padInfo.front,g=s.padInfo.top,y=s.padInfo.left,v=o==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,b=Wn(s.outShape,t),w=b.values,_=s.outShape[1]*s.outShape[2]*s.outShape[3]*s.outShape[4],I=s.outShape[2]*s.outShape[3]*s.outShape[4],C=s.outShape[3]*s.outShape[4],N=s.outShape[4];for(let O=0;O<s.batchSize;++O){const D=O*_,M=O*n[0];for(let P=0;P<s.inChannels;++P)for(let F=0;F<s.outDepth;++F){const B=F*a-m;let z=B;for(;z<0;)z+=u;const Z=Math.min(s.inDepth,c+B),Q=D+F*I;for(let K=0;K<s.outHeight;++K){const ne=K*i-g;let re=ne;for(;re<0;)re+=h;const ce=Math.min(s.inHeight,f+ne),be=Q+K*C;for(let we=0;we<s.outWidth;++we){const ye=we*l-y;let Oe=ye;for(;Oe<0;)Oe+=d;const Se=Math.min(s.inWidth,p+ye),Ee=be+we*N;let j=v,W=0,J=0;for(let ve=z;ve<Z;ve+=u){const he=M+ve*n[1];for(let Fe=re;Fe<ce;Fe+=h){const me=he+Fe*n[2];for(let Le=Oe;Le<Se;Le+=d){const De=me+Le*n[3],Ne=r[De+P];if(o==="max"&&Ne>j?j=Ne:o==="avg"&&(W+=Ne,J++),isNaN(j))break}if(isNaN(j))break}if(isNaN(j))break}const ie=Ee+P;w[ie]=o==="avg"?W/J:j}}}}return b}function SQ(r,e){const t=Wn(e.outShape,"int32"),n=e.strideDepth,s=e.strideHeight,o=e.strideWidth,a=e.dilationDepth,i=e.dilationHeight,l=e.dilationWidth,u=e.effectiveFilterDepth,h=e.effectiveFilterHeight,d=e.effectiveFilterWidth,c=e.padInfo.front,f=e.padInfo.top,p=e.padInfo.left;for(let m=0;m<e.batchSize;++m)for(let g=0;g<e.inChannels;++g)for(let y=0;y<e.outDepth;++y){const v=y*n-c;let b=v;for(;b<0;)b+=a;const w=Math.min(e.inDepth,u+v);for(let _=0;_<e.outHeight;++_){const I=_*s-f;let C=I;for(;C<0;)C+=i;const N=Math.min(e.inHeight,h+I);for(let O=0;O<e.outWidth;++O){const D=O*o-p;let M=D;for(;M<0;)M+=l;const P=Math.min(e.inWidth,d+D);let F=Number.NEGATIVE_INFINITY,B=-1;for(let z=b;z<w;z+=a){const Z=z-v;for(let Q=C;Q<N;Q+=i){const K=Q-I;for(let ne=M;ne<P;ne+=l){const re=ne-D,ce=r.get(m,z,Q,ne,g);ce>=F&&(F=ce,B=Z*h*d+K*h+re)}}}t.set(B,m,y,_,O,g)}}}return t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Q(r){const{inputs:e,backend:t,attrs:n}=r,{x:s}=e;tn(s,"avgPool");const{filterSize:o,strides:a,pad:i,dimRoundingMode:l}=n,u=1;xe(Ks(a,u),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${a} and dilations '${u}'`);const h=Xi(s.shape,o,a,u,i,l);let d;if(h.filterWidth===1&&h.filterHeight===1&&ur(h.inShape,h.outShape))d=Qa({inputs:{x:s},backend:t});else{const c=t.data.get(s.dataId).values,f=pn(s.shape),p=bS(c,s.shape,s.dtype,f,h,"avg");d=t.makeTensorInfo(h.outShape,s.dtype,p.values)}return d}const TQ={kernelName:Vy,backendName:"cpu",kernelFunc:_Q};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kQ(r){const{inputs:e,backend:t,attrs:n}=r,{x:s}=e,{filterSize:o,strides:a,pad:i,dimRoundingMode:l,dataFormat:u}=n;tn(s,"avgPool3d");const h=Al(s.shape,o,a,1,i,l,u),d=t.data.get(s.dataId).values,c=LD(d,s.shape,s.dtype,pn(s.shape),h,"avg");return t.makeTensorInfo(c.shape,"float32",c.values)}const IQ={kernelName:Gy,backendName:"cpu",kernelFunc:kQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EQ(r){const{inputs:e,backend:t,attrs:n}=r,{dy:s,input:o}=e,{filterSize:a,strides:i,pad:l,dimRoundingMode:u}=n;tn([s,o],"avgPool3DGrad");const h=Al(o.shape,a,i,1,l,u),d=h.strideDepth,c=h.strideHeight,f=h.strideWidth,p=h.filterDepth,m=h.filterHeight,g=h.filterWidth,y=h.dilationDepth,v=h.dilationHeight,b=h.dilationWidth,w=h.effectiveFilterDepth,_=h.effectiveFilterHeight,I=h.effectiveFilterWidth,C=w-1-h.padInfo.front,N=I-1-h.padInfo.left,O=_-1-h.padInfo.top,D=Wn(o.shape,"float32"),M=1/(p*m*g),P=t.bufferSync(s);for(let F=0;F<h.batchSize;++F)for(let B=0;B<h.inChannels;++B)for(let z=0;z<h.inDepth;++z)for(let Z=0;Z<h.inHeight;++Z)for(let Q=0;Q<h.inWidth;++Q){const K=z-C,ne=Z-O,re=Q-N;let ce=0;for(let be=0;be<w;be+=y){const we=(K+be)/d;if(!(we<0||we>=h.outDepth||Math.floor(we)!==we))for(let ye=0;ye<_;ye+=v){const Oe=(ne+ye)/c;if(!(Oe<0||Oe>=h.outHeight||Math.floor(Oe)!==Oe))for(let Se=0;Se<I;Se+=b){const Ee=(re+Se)/f;if(Ee<0||Ee>=h.outWidth||Math.floor(Ee)!==Ee)continue;ce+=P.get(F,we,Oe,Ee,B)}}}D.set(ce*M,F,z,Z,Q,B)}return t.makeTensorInfo(D.shape,D.dtype,D.values)}const CQ={kernelName:Hx,backendName:"cpu",kernelFunc:EQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Q(r){const{inputs:e,backend:t,attrs:n}=r,{dy:s,input:o}=e,a=o;tn([s,o],"avgPoolGrad");const{filterSize:i,strides:l,pad:u}=n,h=Xi(a.shape,i,l,1,u),d=h.strideHeight,c=h.strideWidth,f=h.filterHeight,p=h.filterWidth,m=h.dilationHeight,g=h.dilationWidth,y=h.effectiveFilterHeight,v=h.effectiveFilterWidth,b=v-1-h.padInfo.left,w=y-1-h.padInfo.top,_=Wn(a.shape,"float32"),I=1/(f*p),C=t.data.get(s.dataId).values,N=Wn(s.shape,"float32",C);for(let O=0;O<h.batchSize;++O)for(let D=0;D<h.inChannels;++D)for(let M=0;M<h.inHeight;++M)for(let P=0;P<h.inWidth;++P){const F=M-w,B=P-b;let z=0;for(let Z=0;Z<y;Z+=m){const Q=(F+Z)/d;if(!(Q<0||Q>=h.outHeight||Math.floor(Q)!==Q))for(let K=0;K<v;K+=g){const ne=(B+K)/c;if(ne<0||ne>=h.outWidth||Math.floor(ne)!==ne)continue;z+=N.get(O,Q,ne,D)}}_.set(z*I,O,M,P,D)}return t.makeTensorInfo(_.shape,_.dtype,_.values)}const NQ={kernelName:Wx,backendName:"cpu",kernelFunc:$Q};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AQ(r){const{inputs:e,backend:t,attrs:n}=r,{x:s,scale:o,offset:a,mean:i,variance:l}=e;xe(i.shape.length===l.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),xe(a==null||i.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),xe(o==null||i.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),tn([s,i,l,o,a],"batchNorm");let{varianceEpsilon:u}=n;u==null&&(u=.001);const h=t.data.get(s.dataId).values,d=t.data.get(i.dataId).values,c=t.data.get(l.dataId).values,f=o?t.data.get(o.dataId).values:new Float32Array([1]),p=a?t.data.get(a.dataId).values:new Float32Array([0]),m=new Float32Array(h.length),g=p.length,y=f.length,v=c.length,b=d.length;let w=0,_=0,I=0,C=0;for(let N=0;N<h.length;++N)m[N]=p[w++]+(h[N]-d[_++])*f[I++]/Math.sqrt(c[C++]+u),w>=g&&(w=0),_>=b&&(_=0),I>=y&&(I=0),C>=v&&(C=0);return t.makeTensorInfo(s.shape,s.dtype,m)}const RQ={kernelName:r0,backendName:"cpu",kernelFunc:AQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DQ(r){const{inputs:e,backend:t,attrs:n}=r,{x:s}=e,{blockShape:o,crops:a}=n;tn([s],"batchToSpaceND");const i=o.reduce((y,v)=>y*v),l=Qp(s.shape,o,i),u=Jp(l.length,o.length),h=em(s.shape,o,i),d=C2(a,o.length),c=$2(h,a,o.length),f=Rr({inputs:{x:s},backend:t,attrs:{shape:l}}),p=So({inputs:{x:f},backend:t,attrs:{perm:u}}),m=Rr({inputs:{x:p},backend:t,attrs:{shape:h}}),g=Uc({inputs:{x:m},backend:t,attrs:{begin:d,size:c}});return t.disposeIntermediateTensorInfo(f),t.disposeIntermediateTensorInfo(p),t.disposeIntermediateTensorInfo(m),g}const OQ={kernelName:Hy,backendName:"cpu",kernelFunc:DQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MQ(r){const{inputs:e,backend:t,attrs:n}=r,{x:s,weights:o}=e,{size:a}=n,i=t.data.get(s.dataId).values,l=t.data.get(o.dataId).values,u=pS(i,l,o.dtype,o.shape,a);return t.makeTensorInfo([a],o.dtype,u)}const FQ={kernelName:qx,backendName:"cpu",kernelFunc:MQ};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LQ(r){const{inputs:e,backend:t}=r,{s0:n,s1:s}=e,o=t.data.get(n.dataId).values,a=t.data.get(s.dataId).values,i=Dn(Array.from(o),Array.from(a));return t.makeTensorInfo([i.length],"int32",Int32Array.from(i))}const PQ={kernelName:TC,backendName:"cpu",kernelFunc:LQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jQ=wr(ip,(r,e)=>{const t=e;return r>t.clipValueMax?t.clipValueMax:r<t.clipValueMin?t.clipValueMin:r}),BQ={kernelName:ip,backendName:"cpu",kernelFunc:jQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UQ=r=>{const{x:e}=r.inputs,t=r.backend,n=new Float32Array(pt(e.shape)),s=t.data.get(e.dataId),o=s.complexTensorInfos.real,a=s.complexTensorInfos.imag,i=t.data.get(o.dataId).values,l=t.data.get(a.dataId).values;for(let u=0;u<i.length;u++){const h=i[u],d=l[u];n[u]=Math.hypot(h,d)}return t.makeOutput(n,e.shape,"float32")},zQ={kernelName:qy,backendName:"cpu",kernelFunc:UQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sd(r){const{inputs:e,backend:t}=r,{input:n}=e,s=t.data.get(n.dataId).complexTensorInfos.imag,o=t.data.get(s.dataId).values;return t.makeTensorInfo(s.shape,s.dtype,o)}const VQ={kernelName:lw,backendName:"cpu",kernelFunc:sd};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function od(r){const{inputs:e,backend:t,attrs:n}=r,{axis:s}=n,o=Hn(s,e[0].shape)[0],a=e.map(m=>m.shape);k2(a,o);let i=qa(e.map(m=>m.shape),o);if(pt(i)===0)return t.makeTensorInfo(i,e[0].dtype,[]);const l=e.filter(m=>pt(m.shape)>0);if(l.length===1)return Qa({inputs:{x:l[0]},backend:t});if(l[0].dtype==="complex64"){const m=l.map(w=>Bc({inputs:{input:w},backend:t})),g=l.map(w=>sd({inputs:{input:w},backend:t})),y=od({inputs:m,backend:t,attrs:{axis:o}}),v=od({inputs:g,backend:t,attrs:{axis:o}}),b=Mo({inputs:{real:y,imag:v},backend:t});return m.forEach(w=>t.disposeIntermediateTensorInfo(w)),g.forEach(w=>t.disposeIntermediateTensorInfo(w)),t.disposeIntermediateTensorInfo(y),t.disposeIntermediateTensorInfo(v),b}const u=l.map(m=>{const g=pt(m.shape.slice(o));return Rr({inputs:{x:m},backend:t,attrs:{shape:[-1,g]}})}),h=u.map(m=>({vals:t.data.get(m.dataId).values,shape:m.shape}));i=qa(u.map(m=>m.shape),1);const d=u[0].shape[0]===1,c=WR(h,i,e[0].dtype,d),f=qa(l.map(m=>m.shape),o),p=t.makeTensorInfo(f,e[0].dtype,c);return u.forEach(m=>t.disposeIntermediateTensorInfo(m)),p}const GQ={kernelName:Xy,backendName:"cpu",kernelFunc:od};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PD(r){const{inputs:e,backend:t,attrs:n}=r,{x:s,filter:o}=e,{strides:a,pad:i,dataFormat:l,dilations:u,dimRoundingMode:h}=n;tn([s,o],"conv2d");const d=Rl(l),c=Ms(s.shape,o.shape,a,u,i,h,!1,d),f=c.filterHeight,p=c.filterWidth,m=c.dilationHeight,g=c.dilationWidth,y=c.padInfo.left,v=c.padInfo.top,b=c.dataFormat==="channelsLast",w=new Ws(c.outShape,s.dtype),_=pn(s.shape),I=pn(o.shape),C=_[0],N=b?_[1]:_[2],O=b?_[2]:1,D=b?1:_[1],M=w.strides[0],P=b?w.strides[1]:w.strides[2],F=b?w.strides[2]:1,B=b?1:w.strides[1],z=t.data.get(s.dataId).values,Z=t.data.get(o.dataId).values,Q=w.values;for(let K=0;K<c.batchSize;++K){const ne=K*C,re=K*M;for(let ce=0;ce<c.outHeight;++ce){const be=re+ce*P,we=ce*c.strideHeight-v;for(let ye=0;ye<f;++ye){const Oe=we+ye*m;if(Oe<0||Oe>=c.inHeight)continue;const Se=ye*I[0],Ee=ne+Oe*N;for(let j=0;j<c.outWidth;++j){const W=be+j*F,J=j*c.strideWidth-y;for(let ie=0;ie<p;++ie){const ve=J+ie*g;if(ve<0||ve>=c.inWidth)continue;const he=Se+ie*I[1],Fe=Ee+ve*O;let me=he;for(let Le=0;Le<c.inChannels;++Le){const De=z[Fe+Le*D];for(let Ne=0;Ne<c.outChannels;++Ne)Q[W+Ne*B]+=De*Z[me+Ne];me+=c.outChannels}}}}}}return t.makeTensorInfo(w.shape,w.dtype,Q)}const WQ={kernelName:Ky,backendName:"cpu",kernelFunc:PD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HQ(r){const{inputs:e,backend:t,attrs:n}=r,{x:s,dy:o}=e,{strides:a,pad:i,dataFormat:l,dimRoundingMode:u,filterShape:h}=n;tn([s,o],"conv2dBackpropFilter");const d=Rl(l),c=Ms(s.shape,h,a,1,i,u,!1,d),{strideHeight:f,strideWidth:p,filterHeight:m,filterWidth:g}=c,y=c.dataFormat==="channelsLast",v=new Ws(c.filterShape,"float32"),b=c.padInfo.left,w=c.padInfo.top,_=t.data.get(s.dataId).values,I=t.data.get(o.dataId).values,C=new Ws(s.shape,s.dtype,_),N=new Ws(o.shape,o.dtype,I);for(let O=0;O<m;++O){const D=Math.max(0,Math.ceil((w-O)/f)),M=Math.min(c.outHeight,(c.inHeight+w-O)/f);for(let P=0;P<g;++P){const F=Math.max(0,Math.ceil((b-P)/p)),B=Math.min(c.outWidth,(c.inWidth+b-P)/p);for(let z=0;z<c.inChannels;++z)for(let Z=0;Z<c.outChannels;++Z){let Q=0;for(let K=0;K<c.batchSize;++K)for(let ne=D;ne<M;++ne){const re=O+ne*f-w;for(let ce=F;ce<B;++ce){const be=P+ce*p-b;y?Q+=C.get(K,re,be,z)*N.get(K,ne,ce,Z):Q+=C.get(K,z,re,be)*N.get(K,Z,ne,ce)}}v.set(Q,O,P,z,Z)}}}return t.makeTensorInfo(v.shape,v.dtype,v.values)}const qQ={kernelName:Kx,backendName:"cpu",kernelFunc:HQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XQ(r){const{inputs:e,backend:t,attrs:n}=r,{dy:s,filter:o}=e,{inputShape:a,strides:i,pad:l,dataFormat:u,dimRoundingMode:h}=n;tn([s,o],"conv2dBackpropInput");const d=pn(o.shape),c=pn(s.shape);let f=Rl(u);const p=Ms(a,o.shape,i,1,l,h,!1,f),m=new Ws(p.inShape,"float32"),g=m.values,y=t.data.get(s.dataId).values,v=t.data.get(o.dataId).values,[b,w,_]=d,{batchSize:I,filterHeight:C,filterWidth:N,inChannels:O,inHeight:D,inWidth:M,outChannels:P,outHeight:F,outWidth:B,strideHeight:z,strideWidth:Z}=p;f=p.dataFormat;const Q=C-1-p.padInfo.top,K=N-1-p.padInfo.left,ne=f==="channelsLast",re=m.strides[0],ce=ne?m.strides[1]:m.strides[2],be=ne?m.strides[2]:1,we=ne?1:m.strides[1],ye=c[0],Oe=ne?c[1]:c[2],Se=ne?c[2]:1,Ee=ne?1:c[1];for(let j=0;j<I;++j)for(let W=0;W<O;++W)for(let J=0;J<D;++J){const ie=J-Q,ve=Math.max(0,Math.ceil(ie/z)),he=Math.min(F,(C+ie)/z);for(let Fe=0;Fe<M;++Fe){const me=Fe-K,Le=Math.max(0,Math.ceil(me/Z)),De=Math.min(B,(N+me)/Z);let Ne=0;for(let tt=ve;tt<he;++tt){const Je=tt*z-ie;for(let xt=Le;xt<De;++xt){const Pt=xt*Z-me,Dt=ye*j+Oe*tt+Se*xt,St=b*(C-1-Je)+w*(N-1-Pt)+_*W;for(let Jt=0;Jt<P;++Jt){const ht=y[Dt+Ee*Jt],ct=v[St+Jt];Ne+=ht*ct}}}const rt=re*j+ce*J+be*Fe+we*W;g[rt]=Ne}}return t.makeTensorInfo(m.shape,m.dtype,m.values)}const KQ={kernelName:Yy,backendName:"cpu",kernelFunc:XQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YQ(r){const{inputs:e,backend:t,attrs:n}=r,{x:s,filter:o}=e,{strides:a,pad:i,dilations:l}=n;tn([s,o],"conv3d");const u=Iu(s.shape,o.shape,a,l,i),{filterDepth:h,filterHeight:d,filterWidth:c,dilationDepth:f,dilationHeight:p,dilationWidth:m,padInfo:g}=u,y=g.front,v=g.left,b=g.top,w=new Ws(u.outShape,s.dtype),_=t.data.get(s.dataId).values,I=t.data.get(o.dataId).values,C=w.values,N=pn(s.shape),O=pn(o.shape);for(let D=0;D<u.batchSize;++D){const M=D*N[0],P=D*w.strides[0];for(let F=0;F<u.outDepth;++F){const B=P+F*w.strides[1],z=F*u.strideDepth-y;for(let Z=0;Z<h;++Z){const Q=z+Z*f;if(Q<0||Q>=u.inDepth)continue;const K=Z*O[0],ne=M+Q*N[1];for(let re=0;re<u.outHeight;++re){const ce=B+re*w.strides[2],be=re*u.strideHeight-b;for(let we=0;we<d;++we){const ye=be+we*p;if(ye<0||ye>=u.inHeight)continue;const Oe=K+we*O[1],Se=ne+ye*N[2];for(let Ee=0;Ee<u.outWidth;++Ee){const j=ce+Ee*u.outChannels,W=Ee*u.strideWidth-v;for(let J=0;J<c;++J){const ie=W+J*m;if(ie<0||ie>=u.inWidth)continue;const ve=Oe+J*O[2],he=Se+ie*u.inChannels;let Fe=ve;for(let me=0;me<u.inChannels;++me){const Le=_[he+me];for(let De=0;De<u.outChannels;++De)C[j+De]+=Le*I[Fe+De];Fe+=u.outChannels}}}}}}}}return t.makeTensorInfo(w.shape,w.dtype,w.values)}const ZQ={kernelName:Zy,backendName:"cpu",kernelFunc:YQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QQ(r){const{inputs:e,backend:t,attrs:n}=r,{x:s,dy:o}=e,{strides:a,pad:i,filterShape:l}=n;tn([s,o],"conv3dBackpropFilterV2");const u=pn(s.shape),h=pn(o.shape),d=Iu(s.shape,l,a,1,i),c=d.strideDepth,f=d.strideHeight,p=d.strideWidth,m=d.filterDepth,g=d.filterHeight,y=d.filterWidth,v=new Ws(d.filterShape,"float32"),b=v.values,[w,_,I,C]=v.strides,N=t.data.get(o.dataId).values,[O,D,M,P]=h,F=t.data.get(s.dataId).values,[B,z,Z,Q]=u,K=d.padInfo.front,ne=d.padInfo.left,re=d.padInfo.top;for(let ce=0;ce<m;++ce){const be=Math.max(0,Math.ceil((K-ce)/c)),we=Math.min(d.outDepth,(d.inDepth+K-ce)/c),ye=ce*w;for(let Oe=0;Oe<g;++Oe){const Se=Math.max(0,Math.ceil((re-Oe)/f)),Ee=Math.min(d.outHeight,(d.inHeight+re-Oe)/f),j=Oe*_+ye;for(let W=0;W<y;++W){const J=Math.max(0,Math.ceil((ne-W)/p)),ie=Math.min(d.outWidth,(d.inWidth+ne-W)/p),ve=W*I+j;for(let he=0;he<d.inChannels;++he){const Fe=he*C+ve;for(let me=0;me<d.outChannels;++me){let Le=0;for(let De=0;De<d.batchSize;++De){const Ne=De*B,rt=De*O;for(let tt=be;tt<we;++tt){const xt=(ce+tt*c-K)*z+Ne,Pt=tt*D+rt;for(let Dt=Se;Dt<Ee;++Dt){const Jt=(Oe+Dt*f-re)*Z+xt,ht=Dt*M+Pt;for(let ct=J;ct<ie;++ct){const Ft=(W+ct*p-ne)*Q+Jt,Be=ct*P+ht;Le+=F[Ft+he]*N[Be+me]}}}}b[Fe+me]=Le}}}}}return t.makeTensorInfo(v.shape,v.dtype,v.values)}const JQ={kernelName:Yx,backendName:"cpu",kernelFunc:QQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eJ(r){const{inputs:e,backend:t,attrs:n}=r,{dy:s,filter:o}=e,{pad:a,strides:i,inputShape:l}=n;tn([s],"conv3dBackpropInputV2");const u=pn(s.shape),h=pn(o.shape),d=Iu(l,o.shape,i,1,a),c=new Ws(d.inShape,"float32"),f=c.values,[p,m,g,y]=c.strides,v=t.data.get(s.dataId).values,[b,w,_,I]=u,C=t.data.get(o.dataId).values,[N,O,D,M]=h,{batchSize:P,filterDepth:F,filterHeight:B,filterWidth:z,inChannels:Z,inDepth:Q,inHeight:K,inWidth:ne,outChannels:re,outDepth:ce,outHeight:be,outWidth:we,strideDepth:ye,strideHeight:Oe,strideWidth:Se}=d,Ee=F-1-d.padInfo.front,j=B-1-d.padInfo.top,W=z-1-d.padInfo.left;for(let J=0;J<P;++J)for(let ie=0;ie<Z;++ie)for(let ve=0;ve<Q;++ve){const he=ve-Ee,Fe=Math.max(0,Math.ceil(he/ye)),me=Math.min(ce,(F+he)/ye);for(let Le=0;Le<K;++Le){const De=Le-j,Ne=Math.max(0,Math.ceil(De/Oe)),rt=Math.min(be,(B+De)/Oe);for(let tt=0;tt<ne;++tt){const Je=tt-W,xt=Math.max(0,Math.ceil(Je/Se)),Pt=Math.min(we,(z+Je)/Se);let Dt=0;for(let St=Fe;St<me;++St){const Jt=St*ye-he;for(let ht=Ne;ht<rt;++ht){const ct=ht*Oe-De;for(let At=xt;At<Pt;++At){const Ft=At*Se-Je,Be=b*J+w*St+_*ht+I*At,qt=N*(F-1-Jt)+O*(B-1-ct)+D*(z-1-Ft)+M*ie;for(let Y=0;Y<re;++Y){const le=v[Be+Y],ee=C[qt+Y];Dt+=le*ee}}}}f[p*J+m*ve+g*Le+y*tt+ie]=Dt}}}return t.makeTensorInfo(c.shape,c.dtype,c.values)}const tJ={kernelName:Zx,backendName:"cpu",kernelFunc:eJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nJ=wr(ap,r=>Math.cos(r)),rJ={kernelName:ap,backendName:"cpu",kernelFunc:nJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sJ=wr(lp,r=>Math.cosh(r)),oJ={kernelName:lp,backendName:"cpu",kernelFunc:sJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iJ(r){const{inputs:e,backend:t,attrs:n}=r,{image:s,boxes:o,boxInd:a}=e,{cropSize:i,method:l,extrapolationValue:u}=n,[h,d,c,f]=s.shape,p=o.shape[0],[m,g]=i,y=Wn([p,m,g,f],"float32"),v=t.data.get(o.dataId).values,b=t.data.get(a.dataId).values,w=t.data.get(s.dataId).values,_=pn(s.shape),I=pn(y.shape);for(let C=0;C<p;C++){const N=C*4,O=v[N],D=v[N+1],M=v[N+2],P=v[N+3],F=b[C];if(F>=h)continue;const B=m>1?(M-O)*(d-1)/(m-1):0,z=g>1?(P-D)*(c-1)/(g-1):0;for(let Z=0;Z<m;Z++){const Q=m>1?O*(d-1)+Z*B:.5*(O+M)*(d-1);if(Q<0||Q>d-1){for(let K=0;K<g;K++)for(let ne=0;ne<f;ne++){const re=ne+K*I[2]+Z*I[1]+C*I[0];y.values[re]=u}continue}if(l==="bilinear"){const K=Math.floor(Q),ne=Math.ceil(Q),re=Q-K;for(let ce=0;ce<g;ce++){const be=g>1?D*(c-1)+ce*z:.5*(D+P)*(c-1);if(be<0||be>c-1){for(let Se=0;Se<f;Se++){const Ee=Se+ce*I[2]+Z*I[1]+C*I[0];y.values[Ee]=u}continue}const we=Math.floor(be),ye=Math.ceil(be),Oe=be-we;for(let Se=0;Se<f;Se++){let Ee=Se+we*_[2]+K*_[1]+F*_[0];const j=w[Ee];Ee=Se+ye*_[2]+K*_[1]+F*_[0];const W=w[Ee];Ee=Se+we*_[2]+ne*_[1]+F*_[0];const J=w[Ee];Ee=Se+ye*_[2]+ne*_[1]+F*_[0];const ie=w[Ee],ve=j+(W-j)*Oe,he=J+(ie-J)*Oe;Ee=Se+ce*I[2]+Z*I[1]+C*I[0],y.values[Ee]=ve+(he-ve)*re}}}else for(let K=0;K<g;++K){const ne=g>1?D*(c-1)+K*z:.5*(D+P)*(c-1);if(ne<0||ne>c-1){for(let be=0;be<f;be++){const we=be+K*I[2]+Z*I[1]+C*I[0];y.values[we]=u}continue}const re=Math.round(ne),ce=Math.round(Q);for(let be=0;be<f;be++){const we=be+re*_[2]+ce*_[1]+F*_[0],ye=be+K*I[2]+Z*I[1]+C*I[0];y.values[ye]=w[we]}}}}return t.makeTensorInfo(y.shape,y.dtype,y.values)}const aJ={kernelName:Jx,backendName:"cpu",kernelFunc:iJ};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lJ(r){const{inputs:e,backend:t,attrs:n}=r,{x:s}=e,{axis:o,exclusive:a,reverse:i}=n;tn(s,"cumprod");const l=qr([o],s.shape.length);let u=s;l!=null&&(u=So({inputs:{x:s},backend:t,attrs:{perm:l}}));const h=ts(1,s.shape.length)[0];if(h!==u.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${u.shape.length-1} but got axis=${h}`);const d=Bo(u.dtype,"int32"),c=Bx(pt(u.shape),d),f=t.data.get(u.dataId).values,p=u.shape[u.shape.length-1],m=i?(y,v)=>y+p-v-1:(y,v)=>y+v;for(let y=0;y<f.length;y+=p)for(let v=0;v<p;v++){const b=m(y,v);if(v===0)c[b]=a?1:f[b];else{const w=m(y,v-1);c[b]=a?f[w]*c[w]:f[b]*c[w]}}const g=t.makeTensorInfo(u.shape,d,c);if(l!=null){const y=Eu(l),v=So({inputs:{x:g},backend:t,attrs:{perm:y}});return t.disposeIntermediateTensorInfo(g),t.disposeIntermediateTensorInfo(u),v}return g}const uJ={kernelName:Qx,backendName:"cpu",kernelFunc:lJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cJ(r){const{inputs:e,backend:t,attrs:n}=r,{x:s}=e,{axis:o,exclusive:a,reverse:i}=n;tn(s,"cumsum");const l=qr([o],s.shape.length);let u=s;l!=null&&(u=So({inputs:{x:s},backend:t,attrs:{perm:l}}));const h=ts(1,s.shape.length)[0];if(h!==u.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${u.shape.length-1} but got axis=${h}`);const d=Bo(u.dtype,"int32"),c=Xs(pt(u.shape),d),f=t.data.get(u.dataId).values,p=u.shape[u.shape.length-1],m=i?(y,v)=>y+p-v-1:(y,v)=>y+v;for(let y=0;y<f.length;y+=p)for(let v=0;v<p;v++){const b=m(y,v);if(v===0)c[b]=a?0:f[b];else{const w=m(y,v-1);c[b]=a?f[w]+c[w]:f[b]+c[w]}}const g=t.makeTensorInfo(u.shape,d,c);if(l!=null){const y=Eu(l),v=So({inputs:{x:g},backend:t,attrs:{perm:y}});return t.disposeIntermediateTensorInfo(g),t.disposeIntermediateTensorInfo(u),v}return g}const hJ={kernelName:Qy,backendName:"cpu",kernelFunc:cJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dJ(r){const{inputs:e,backend:t,attrs:n}=r,{x:s,weights:o}=e,{size:a,binaryOutput:i}=n;if(s.shape.length===1){const l=t.data.get(s.dataId).values,u=t.data.get(o.dataId).values,h=pS(l,u,o.dtype,o.shape,a);return t.makeTensorInfo([a],o.dtype,h)}else if(s.shape.length===2){const l=t.bufferSync(s),u=t.bufferSync(o),h=VR(l,u,a,i);return t.makeTensorInfo(h.shape,o.dtype,h.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${s.shape.length}.`)}const fJ={kernelName:kC,backendName:"cpu",kernelFunc:dJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pJ(r){const{inputs:e,backend:t,attrs:n}=r,{x:s}=e,{blockSize:o,dataFormat:a}=n;xe(a==="NHWC",()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${a}`);const i=s.shape[0],l=s.shape[1],u=s.shape[2],h=s.shape[3],d=l*o,c=u*o,f=h/(o*o),p=t.data.get(s.dataId).values,m=new Float32Array(i*d*c*f);let g=0;for(let y=0;y<i;++y)for(let v=0;v<d;++v){const b=Math.floor(v/o),w=v%o;for(let _=0;_<c;++_){const I=Math.floor(_/o),C=_%o,N=(w*o+C)*f;for(let O=0;O<f;++O){const M=O+N+h*(I+u*(b+l*y));m[g++]=p[M]}}}return t.makeTensorInfo([i,d,c,f],s.dtype,m)}const mJ={kernelName:ew,backendName:"cpu",kernelFunc:pJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jD(r){const{inputs:e,backend:t,attrs:n}=r,{x:s,filter:o}=e,{strides:a,pad:i,dilations:l,dimRoundingMode:u}=n;tn([s,o],"depthwiseConv2DNative");const h=pn(s.shape),d=pn(o.shape);let c=l;c==null&&(c=[1,1]),xe(Ks(a,c),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${a} and dilations '${c}'`);const f=Ms(s.shape,o.shape,a,c,i,u,!0),{filterHeight:p,filterWidth:m,dilationHeight:g,dilationWidth:y,padInfo:v}=f,b=v.left,w=v.top,_=f.outChannels/f.inChannels,I=new Ws(f.outShape,s.dtype),C=t.data.get(s.dataId).values,N=t.data.get(o.dataId).values,O=I.values;for(let D=0;D<f.batchSize;++D){const M=D*h[0],P=D*I.strides[0];for(let F=0;F<f.outHeight;++F){const B=P+F*I.strides[1],z=F*f.strideHeight-w;for(let Z=0;Z<p;++Z){const Q=z+Z*g;if(Q<0||Q>=f.inHeight)continue;const K=Z*d[0],ne=M+Q*h[1];for(let re=0;re<f.outWidth;++re){const ce=B+re*I.strides[2],be=re*f.strideWidth-b;for(let we=0;we<m;++we){const ye=be+we*y;if(ye<0||ye>=f.inWidth)continue;const Oe=K+we*d[1],Se=ne+ye*f.inChannels;let Ee=ce,j=Oe;for(let W=0;W<f.inChannels;++W){const J=C[Se+W];for(let ie=0;ie<_;++ie)O[Ee+ie]+=J*N[j+ie];Ee+=_,j+=_}}}}}}return t.makeTensorInfo(I.shape,I.dtype,I.values)}const gJ={kernelName:Jy,backendName:"cpu",kernelFunc:jD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yJ(r){const{inputs:e,backend:t,attrs:n}=r,{x:s,dy:o}=e,{strides:a,dilations:i,pad:l,dimRoundingMode:u,filterShape:h}=n;tn([s,o],"depthwiseConv2dNativeBackpropFilter");const d=Ms(s.shape,h,a,i,l,u,!0),{strideHeight:c,strideWidth:f,filterHeight:p,filterWidth:m}=d,g=new Ws(d.filterShape,"float32"),y=d.padInfo.left,v=d.padInfo.top,b=d.outChannels/d.inChannels,w=t.data.get(s.dataId).values,_=new Ws(s.shape,s.dtype,w),I=t.data.get(o.dataId).values,C=new Ws(o.shape,o.dtype,I);for(let N=0;N<p;++N){const O=Math.max(0,Math.ceil((v-N)/c)),D=Math.min(d.outHeight,(d.inHeight+v-N)/c);for(let M=0;M<m;++M){const P=Math.max(0,Math.ceil((y-M)/f)),F=Math.min(d.outWidth,(d.inWidth+y-M)/f);for(let B=0;B<d.outChannels;++B){const z=Math.trunc(B/b),Z=B%b;let Q=0;for(let K=0;K<d.batchSize;++K)for(let ne=O;ne<D;++ne){const re=N+ne*c-v;for(let ce=P;ce<F;++ce){const be=M+ce*f-y;Q+=_.get(K,re,be,z)*C.get(K,ne,ce,B)}}g.set(Q,N,M,z,Z)}}}return t.makeTensorInfo(g.shape,g.dtype,g.values)}const vJ={kernelName:tw,backendName:"cpu",kernelFunc:yJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bJ(r){const{inputs:e,backend:t,attrs:n}=r,{dy:s,filter:o}=e,{strides:a,dilations:i,pad:l,dimRoundingMode:u,inputShape:h}=n;tn([s,o],"depthwiseConv2DNativeBackpropInput");const d=pn(s.shape),c=pn(o.shape),f=Ms(h,o.shape,a,i,l,u,!0),p=new Ws(f.inShape,"float32"),m=p.values,[g,y,v]=p.strides,b=t.data.get(s.dataId).values,[w,_,I]=d,C=t.data.get(o.dataId).values,[N,O,D]=c,{batchSize:M,filterHeight:P,filterWidth:F,inChannels:B,inHeight:z,inWidth:Z,outChannels:Q,outHeight:K,outWidth:ne,strideHeight:re,strideWidth:ce}=f,be=P-1-f.padInfo.top,we=F-1-f.padInfo.left,ye=Q/B;for(let Oe=0;Oe<M;++Oe)for(let Se=0;Se<B;++Se)for(let Ee=0;Ee<z;++Ee){const j=Ee-be,W=Math.max(0,Math.ceil(j/re)),J=Math.min(K,(P+j)/re);for(let ie=0;ie<Z;++ie){const ve=ie-we,he=Math.max(0,Math.ceil(ve/ce)),Fe=Math.min(ne,(F+ve)/ce);let me=0;for(let Le=W;Le<J;++Le){const De=Le*re-j;for(let Ne=he;Ne<Fe;++Ne){const rt=Ne*ce-ve,tt=w*Oe+_*Le+I*Ne,Je=N*(P-1-De)+O*(F-1-rt)+D*Se;for(let xt=0;xt<ye;++xt){const Pt=Se*ye+xt,Dt=b[tt+Pt],St=C[Je+xt];me+=Dt*St}}}m[g*Oe+y*Ee+v*ie+Se]=me}}return t.makeTensorInfo(p.shape,p.dtype,p.values)}const xJ={kernelName:nw,backendName:"cpu",kernelFunc:bJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wJ(r){const{inputs:e,backend:t}=r,{x:n}=e,s=pt(n.shape),o=t.data.get(n.dataId).values,a=Wn([s,s],n.dtype),i=a.values;for(let u=0;u<o.length;u++)i[u*s+u]=o[u];const l=[...n.shape,...n.shape];return t.makeTensorInfo(l,a.dtype,a.values)}const SJ={kernelName:IC,backendName:"cpu",kernelFunc:wJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _J={kernelName:e0,backendName:"cpu",kernelFunc:({inputs:r,backend:e,attrs:t})=>{const{x:n,filter:s}=r,{strides:o,pad:a,dilations:i}=t,l=e,u=l.data.get(n.dataId).values,h=n.shape.length,d=l.data.get(s.dataId).values,c=s.shape.length,{batchSize:f,inHeight:p,inWidth:m,inChannels:g,outHeight:y,outWidth:v,padInfo:b,strideHeight:w,strideWidth:_,filterHeight:I,filterWidth:C,dilationHeight:N,dilationWidth:O,outShape:D}=qp(n.shape,s.shape,o,a,"NHWC",i),M=pt(D),P=D.length,F=_s(n.dtype,M);for(let z=0;z<f;++z)for(let Z=0;Z<y;++Z){const Q=Z*w-b.top;for(let K=0;K<v;++K){const ne=K*_-b.left;for(let re=0;re<g;++re){let ce=Number.MIN_SAFE_INTEGER;for(let we=0;we<I;++we){const ye=Q+we*N;if(ye>=0&&ye<p)for(let Oe=0;Oe<C;++Oe){const Se=ne+Oe*O;if(Se>=0&&Se<m){const Ee=Wa([z,ye,Se,re],h,pn(n.shape)),j=Wa([we,Oe,re],c,pn(s.shape)),W=u[Ee]+d[j];W>ce&&(ce=W)}}}const be=Wa([z,Z,K,re],P,pn(D));F[be]=ce}}}return{dataId:l.write(Kc(F,n.dtype),D,n.dtype),shape:D,dtype:n.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TJ={kernelName:xb,backendName:"cpu",kernelFunc:({inputs:r,backend:e,attrs:t})=>{const{x:n,filter:s,dy:o}=r,{strides:a,pad:i,dilations:l}=t,u=e,h=fa(n.shape,u.data.get(n.dataId).values),d=fa(s.shape,u.data.get(s.dataId).values),{batchSize:c,inHeight:f,inWidth:p,inChannels:m,outHeight:g,outWidth:y,padInfo:v,strideHeight:b,strideWidth:w,filterHeight:_,filterWidth:I,dilationHeight:C,dilationWidth:N,outShape:O}=qp(n.shape,s.shape,a,i,"NHWC",l);xe(o.rank===O.length,()=>`Error in ${xb}, dy must have the same rank as output ${O.length}, but got ${o.rank}`);const D=fa(O,u.data.get(o.dataId).values),M=bC(s.shape,s.dtype);for(let F=0;F<c;++F)for(let B=0;B<g;++B){const z=B*b-v.top;for(let Z=0;Z<y;++Z){const Q=Z*w-v.left;for(let K=0;K<m;++K){let ne=Number.MIN_SAFE_INTEGER,re=0,ce=0;for(let be=0;be<_;++be){const we=z+be*C;if(we>=0&&we<f)for(let ye=0;ye<I;++ye){const Oe=Q+ye*N;if(Oe>=0&&Oe<p){const Se=h[F][we][Oe][K]+d[be][ye][K];Se>ne&&(ne=Se,re=be,ce=ye)}}}M[re][ce][K]+=D[F][B][Z][K]}}}return{dataId:u.write(Kc(M,n.dtype),s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kJ={kernelName:bb,backendName:"cpu",kernelFunc:({inputs:r,backend:e,attrs:t})=>{const{x:n,filter:s,dy:o}=r,{strides:a,pad:i,dilations:l}=t,u=e,h=fa(n.shape,u.data.get(n.dataId).values),d=fa(s.shape,u.data.get(s.dataId).values),{batchSize:c,inHeight:f,inWidth:p,inChannels:m,outHeight:g,outWidth:y,padInfo:v,strideHeight:b,strideWidth:w,filterHeight:_,filterWidth:I,dilationHeight:C,dilationWidth:N,outShape:O}=qp(n.shape,s.shape,a,i,"NHWC",l);xe(o.rank===O.length,()=>`Error in ${bb}, dy must have the same rank as output ${O.length}, but got ${o.rank}`);const D=fa(O,u.data.get(o.dataId).values),M=bC(n.shape,n.dtype);for(let F=0;F<c;++F)for(let B=0;B<g;++B){const z=B*b-v.top;for(let Z=0;Z<y;++Z){const Q=Z*w-v.left;for(let K=0;K<m;++K){let ne=Number.MIN_SAFE_INTEGER,re=z<0?0:z,ce=Q<0?0:Q;for(let be=0;be<_;++be){const we=z+be*C;if(we>=0&&we<f)for(let ye=0;ye<I;++ye){const Oe=Q+ye*N;if(Oe>=0&&Oe<p){const Se=h[F][we][Oe][K]+d[be][ye][K];Se>ne&&(ne=Se,re=we,ce=Oe)}}}M[F][re][ce][K]+=D[F][B][Z][K]}}}return{dataId:u.write(Kc(M,n.dtype),n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cm(r){const{inputs:e,backend:t,attrs:n}=r,{x:s}=e,{axis:o,keepDims:a}=n;tn(s,"sum");let i;s.dtype==="bool"?i=xu({inputs:{x:s},backend:t,attrs:{dtype:"int32"}}):i=Qa({inputs:{x:s},backend:t});const l=i.shape.length,u=Hn(o,i.shape),h=qr(u,l);let d=u,c=i;h!=null&&(c=So({inputs:{x:i},backend:t,attrs:{perm:h}}),d=ts(d.length,l)),Fs("sum",d,c.shape.length);const[f,p]=ks(c.shape,d),m=Bo(c.dtype,"int32");let g=my(t,f,m);const y=pt(p),v=t.data.get(g.dataId).values,b=t.data.get(c.dataId).values;for(let w=0;w<v.length;++w){const _=w*y;let I=0;for(let C=0;C<y;++C)I+=b[_+C];v[w]=I}if(a){const w=es(g.shape,u),_=g;g=Rr({inputs:{x:g},backend:t,attrs:{shape:w}}),t.disposeIntermediateTensorInfo(_)}return t.disposeIntermediateTensorInfo(i),h!=null&&t.disposeIntermediateTensorInfo(c),g}const IJ={kernelName:D0,backendName:"cpu",kernelFunc:cm};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EJ(r){const{inputs:e,backend:t,attrs:n}=r,{equation:s}=n,o=e,{allDims:a,summedDims:i,idDims:l}=L2(s,o.length);j2(a.length,l,o);const{path:u,steps:h}=B2(i,l),d=h.length;let c=null,f=a.length;const p=[];for(let m=0;m<d;++m){for(const g of h[m]){const{permutationIndices:y,expandDims:v}=P2(f,l[g]);let b;U2(y)?b=o[g]:(b=So({inputs:{x:o[g]},backend:t,attrs:{perm:y}}),p.push(b));const w=b.shape.slice();for(let _=0;_<v.length;++_)w.splice(v[_],0,1);ur(b.shape,w)||(b=Rr({inputs:{x:b},backend:t,attrs:{shape:w}}),p.push(b)),c===null?c=b:(c=d1({inputs:{a:b,b:c},backend:t}),p.push(c))}m<d-1&&(u[m]>=0&&(c=cm({inputs:{x:c},backend:t,attrs:{axis:u[m]-(a.length-f),keepDims:!1}}),p.push(c)),f--)}for(const m of p)m!==c&&t.disposeIntermediateTensorInfo(m);return c}const CJ={kernelName:EC,backendName:"cpu",kernelFunc:EJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $J(r){const{inputs:e,backend:t}=r,{dy:n,y:s}=e;tn([n,s],"eluGrad");const o=new Float32Array(pt(s.shape)),a=t.data.get(s.dataId).values,i=t.data.get(n.dataId).values;for(let l=0;l<a.length;++l){const u=a[l];u>=1?o[l]=i[l]:o[l]=i[l]*(u+1)}return t.makeTensorInfo(s.shape,"float32",o)}const NJ={kernelName:rw,backendName:"cpu",kernelFunc:$J};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AJ=N2,RJ=A2,DJ=R2,OJ=D2,MJ=O2,FJ=M2,LJ=wr(hp,r=>{const e=Math.sign(r),t=Math.abs(r),n=1/(1+AJ*t);return e*(1-((((FJ*n+MJ)*n+OJ)*n+DJ)*n+RJ)*n*Math.exp(-t*t))}),PJ={kernelName:hp,backendName:"cpu",kernelFunc:LJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vy(r){const{inputs:e,backend:t,attrs:n}=r,{input:s}=e,{dim:o}=n,a=s.shape.length,i=s.shape.slice();let l=o;return o<0&&(xe(-(a+1)<=o,()=>`Axis must be in the interval [${-(a+1)}, ${a}]`),l=a+o+1),i.splice(l,0,1),Rr({inputs:{x:s},backend:t,attrs:{shape:i}})}const jJ={kernelName:n0,backendName:"cpu",kernelFunc:vy};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BJ=is((r,e)=>r/e),xS=Is(up,BJ),Yb={kernelName:up,backendName:"cpu",kernelFunc:xS};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BD(r,e,t){const n=r.shape,s=n[0],o=n[1],a=t.data.get(r.dataId),i=a.complexTensorInfos.real,l=a.complexTensorInfos.imag,u=[s,o],h=pt(u),d=Os("float32",h),c=Os("float32",h);for(let g=0;g<s;g++){const y=Uc({inputs:{x:i},backend:t,attrs:{begin:[g,0],size:[1,o]}}),v=Uc({inputs:{x:l},backend:t,attrs:{begin:[g,0],size:[1,o]}}),b=Mo({inputs:{real:y,imag:v},backend:t}),{real:w,imag:_}=UJ(b,e,t),I=Cl(w,_);for(let C=0;C<o;C++){const N=F2(I,C);d[g*o+C]=N.real,c[g*o+C]=N.imag}t.disposeIntermediateTensorInfo(y),t.disposeIntermediateTensorInfo(v),t.disposeIntermediateTensorInfo(b)}const f=t.makeTensorInfo(u,"float32",d),p=t.makeTensorInfo(u,"float32",c),m=Mo({inputs:{real:f,imag:p},backend:t});return t.disposeIntermediateTensorInfo(f),t.disposeIntermediateTensorInfo(p),m}function UJ(r,e,t){const n=pt(r.shape),s=t.data.get(r.dataId),o=t.data.get(s.complexTensorInfos.real.dataId).values,a=t.data.get(s.complexTensorInfos.imag.dataId).values;if(zJ(n)){const i=Zb(o,a,n,e,t),l=[r.shape[0],r.shape[1]];if(e){const u=t.makeTensorInfo(l,"float32",i.real),h=t.makeTensorInfo(l,"float32",i.imag),d=t.makeTensorInfo([],"float32",ku(n,"float32")),c=Qa({inputs:{x:d},backend:t}),f=Yb.kernelFunc({inputs:{a:u,b:d},backend:t}),p=Yb.kernelFunc({inputs:{a:h,b:c},backend:t}),m=t.data.get(f.dataId).values,g=t.data.get(p.dataId).values;return t.disposeIntermediateTensorInfo(u),t.disposeIntermediateTensorInfo(h),t.disposeIntermediateTensorInfo(d),t.disposeIntermediateTensorInfo(c),t.disposeIntermediateTensorInfo(f),t.disposeIntermediateTensorInfo(p),{real:m,imag:g}}return i}else{const i=Cl(o,a),l=VJ(i,n,e);return hN(l)}}function zJ(r){return(r&r-1)===0}function Zb(r,e,t,n,s){if(t===1)return{real:r,imag:e};const o=Cl(r,e),a=t/2,i=dN(o),l=i.real,u=i.imag,h=[l.length],d=s.makeTensorInfo(h,"float32",l),c=s.makeTensorInfo(h,"float32",u),f=Mo({inputs:{real:d,imag:c},backend:s}),p=fN(o),m=p.real,g=p.imag,y=[m.length],v=s.makeTensorInfo(y,"float32",m),b=s.makeTensorInfo(y,"float32",g),w=Mo({inputs:{real:v,imag:b},backend:s}),_=Zb(l,u,a,n,s),I=_.real,C=_.imag,N=[I.length],O=s.makeTensorInfo(N,"float32",I),D=s.makeTensorInfo(N,"float32",C),M=Mo({inputs:{real:O,imag:D},backend:s}),P=Zb(m,g,a,n,s),F=P.real,B=P.imag,z=[F.length],Z=s.makeTensorInfo(z,"float32",F),Q=s.makeTensorInfo(z,"float32",B),K=Mo({inputs:{real:Z,imag:Q},backend:s}),ne=mN(t,n),re=[ne.real.length],ce=s.makeTensorInfo(re,"float32",ne.real),be=s.makeTensorInfo(re,"float32",ne.imag),we=Mo({inputs:{real:ce,imag:be},backend:s}),ye=d1({inputs:{a:we,b:K},backend:s}),Oe=rd({inputs:{a:M,b:ye},backend:s}),Se=vS({inputs:{a:M,b:ye},backend:s}),Ee=Bc({inputs:{input:Oe},backend:s}),j=Bc({inputs:{input:Se},backend:s}),W=sd({inputs:{input:Oe},backend:s}),J=sd({inputs:{input:Se},backend:s}),ie=od({inputs:[Ee,j],backend:s,attrs:{axis:0}}),ve=od({inputs:[W,J],backend:s,attrs:{axis:0}}),he=s.data.get(ie.dataId).values,Fe=s.data.get(ve.dataId).values;return s.disposeIntermediateTensorInfo(d),s.disposeIntermediateTensorInfo(c),s.disposeIntermediateTensorInfo(f),s.disposeIntermediateTensorInfo(v),s.disposeIntermediateTensorInfo(b),s.disposeIntermediateTensorInfo(w),s.disposeIntermediateTensorInfo(O),s.disposeIntermediateTensorInfo(D),s.disposeIntermediateTensorInfo(M),s.disposeIntermediateTensorInfo(Z),s.disposeIntermediateTensorInfo(Q),s.disposeIntermediateTensorInfo(K),s.disposeIntermediateTensorInfo(ce),s.disposeIntermediateTensorInfo(be),s.disposeIntermediateTensorInfo(we),s.disposeIntermediateTensorInfo(ye),s.disposeIntermediateTensorInfo(Oe),s.disposeIntermediateTensorInfo(Se),s.disposeIntermediateTensorInfo(Ee),s.disposeIntermediateTensorInfo(W),s.disposeIntermediateTensorInfo(j),s.disposeIntermediateTensorInfo(J),s.disposeIntermediateTensorInfo(ie),s.disposeIntermediateTensorInfo(ve),{real:he,imag:Fe}}function VJ(r,e,t){const n=new Float32Array(e*2);for(let s=0;s<e;s++){let o=0,a=0;for(let i=0;i<e;i++){const l=gN(s*i,e,t),u=F2(r,i);o+=u.real*l.real-u.imag*l.imag,a+=u.real*l.imag+u.imag*l.real}t&&(o/=e,a/=e),pN(n,o,a,s)}return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GJ(r){const{inputs:e,backend:t}=r,{input:n}=e,s=pt(n.shape),o=n.shape[n.shape.length-1],a=s/o,i=Rr({inputs:{x:n},backend:t,attrs:{shape:[a,o]}}),l=BD(i,!1,t),u=Rr({inputs:{x:l},backend:t,attrs:{shape:n.shape}});return t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(l),u}const WJ={kernelName:sw,backendName:"cpu",kernelFunc:GJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wS(r){const{backend:e,attrs:t}=r,{shape:n,value:s,dtype:o}=t,a=o||Yf(s),i=_s(a,pt(n));return qJ(i,s,a),e.makeTensorInfo(n,a,i)}const HJ={kernelName:ow,backendName:"cpu",kernelFunc:wS};function qJ(r,e,t){r.fill(e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XJ={kernelName:iw,backendName:"cpu",kernelFunc:({inputs:r,attrs:e,backend:t})=>{const{image:n}=r,s=t,o=Os(n.dtype,pt(n.shape)),[a,i,l,u]=n.shape,h=s.data.get(n.dataId).values;for(let c=0;c<a;c++){const f=c*l*i*u;for(let p=0;p<i;p++){const m=p*(l*u);for(let g=0;g<l;g++){const y=g*u;for(let v=0;v<u;v++){const b=Math.round(l-g-1),w=f+m+y+v;let _=h[w];if(b>=0&&b<l){const I=b*u,C=f+m+I+v;_=h[C]}o[w]=_}}}}return{dataId:s.write(o,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KJ=is((r,e)=>Math.floor(r/e)),YJ=Is(mp,KJ,null,"int32"),ZJ={kernelName:mp,backendName:"cpu",kernelFunc:YJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QJ(r){const{inputs:e,backend:t,attrs:n}=r,{x:s,filter:o,bias:a,preluActivationWeights:i}=e,{strides:l,pad:u,dataFormat:h,dilations:d,dimRoundingMode:c,activation:f,leakyreluAlpha:p}=n;let m=PD({inputs:{x:s,filter:o},backend:t,attrs:{strides:l,pad:u,dataFormat:h,dilations:d,dimRoundingMode:c}});if(a){const g=m;if(h==="NCHW"&&a.shape.length===1&&a.shape[0]!==1){const y=Rr({inputs:{x:a},backend:t,attrs:{shape:[a.shape[0],1,1]}});m=rd({inputs:{a:m,b:y},backend:t}),t.disposeIntermediateTensorInfo(y)}else m=rd({inputs:{a:m,b:a},backend:t});t.disposeIntermediateTensorInfo(g)}if(f){const g=m;if(h==="NCHW"&&f==="prelu"&&i.shape.length===1&&i.shape[0]!==1){const y=Rr({inputs:{x:i},backend:t,attrs:{shape:[i.shape[0],1,1]}});m=yy(t,m,f,y,p),t.disposeIntermediateTensorInfo(y)}else m=yy(t,m,f,i,p);t.disposeIntermediateTensorInfo(g)}return m}const JJ={kernelName:Zg,backendName:"cpu",kernelFunc:QJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eee(r){const{inputs:e,backend:t,attrs:n}=r,{x:s,filter:o,bias:a,preluActivationWeights:i}=e,{strides:l,pad:u,dataFormat:h,dilations:d,dimRoundingMode:c,activation:f,leakyreluAlpha:p}=n;let m=jD({inputs:{x:s,filter:o},backend:t,attrs:{strides:l,pad:u,dataFormat:h,dilations:d,dimRoundingMode:c}});if(a){const g=m;m=rd({inputs:{a:m,b:a},backend:t}),t.disposeIntermediateTensorInfo(g)}if(f){const g=m;m=yy(t,m,f,i,p),t.disposeIntermediateTensorInfo(g)}return m}const tee={kernelName:LC,backendName:"cpu",kernelFunc:eee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nee(r){const{inputs:e,backend:t}=r,{params:n,indices:s}=e,o=pt(n.shape),a=s.shape,i=a[a.length-1],[l,u,h,d]=Lw(n,s);if(u===0)return t.makeTensorInfo(l,n.dtype,[]);const c=t.data.get(s.dataId).values,f=t.bufferSync(n),p=QR(c,f,n.dtype,u,i,h,d,n.shape,o);return t.makeTensorInfo(l,n.dtype,p.values)}const ree={kernelName:CC,backendName:"cpu",kernelFunc:nee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function see(r){const{inputs:e,backend:t,attrs:n}=r,{x:s,indices:o}=e,{axis:a,batchDims:i}=n;tn([s,o],"gatherV2");const l=Hn(a,s.shape)[0],u=t.data.get(o.dataId).values,h=s.shape[l];for(let w=0;w<u.length;++w){const _=u[w];xe(_<=h-1&&_>=0,()=>`GatherV2: the index value ${_} is not in [0, ${h-1}]`)}let d=i;i==null&&(d=0);const c=pt(o.shape),f=V2(s,o,l,d),p=Rr({inputs:{x:s},backend:t,attrs:{shape:[f.batchSize,f.outerSize,f.dimSize,f.sliceSize]}}),m=Rr({inputs:{x:o},backend:t,attrs:{shape:[f.batchSize,c/f.batchSize]}}),g=[f.batchSize,f.outerSize,c/f.batchSize,f.sliceSize],y=t.bufferSync(m),v=t.bufferSync(p),b=JR(v,y,g);return t.disposeIntermediateTensorInfo(p),t.disposeIntermediateTensorInfo(m),t.makeTensorInfo(f.outputShape,b.dtype,b.values)}const oee={kernelName:s0,backendName:"cpu",kernelFunc:see};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iee(r){const{inputs:e,backend:t}=r,{input:n}=e,s=pt(n.shape),o=n.shape[n.shape.length-1],a=s/o,i=Rr({inputs:{x:n},backend:t,attrs:{shape:[a,o]}}),l=BD(i,!0,t),u=Rr({inputs:{x:l},backend:t,attrs:{shape:n.shape}});return t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(l),u}const aee={kernelName:aw,backendName:"cpu",kernelFunc:iee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lee=wr(vp,r=>Number.isFinite(r)?1:0,"bool"),uee={kernelName:vp,backendName:"cpu",kernelFunc:lee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cee=wr(bp,r=>Math.abs(r)===1/0?1:0,"bool"),hee={kernelName:bp,backendName:"cpu",kernelFunc:cee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dee=wr(xp,r=>Number.isNaN(r)?1:0,"bool"),fee={kernelName:xp,backendName:"cpu",kernelFunc:dee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pee(r){const{backend:e,attrs:t}=r,{start:n,stop:s,num:o}=t,a=sD(n,s,o);return e.makeTensorInfo([a.length],"float32",a)}const mee={kernelName:$C,backendName:"cpu",kernelFunc:pee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gee=wr(Sp,r=>Math.log1p(r)),yee={kernelName:Sp,backendName:"cpu",kernelFunc:gee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vee=is((r,e)=>r&&e),bee=Is(u0,vee,null,"bool"),xee={kernelName:u0,backendName:"cpu",kernelFunc:bee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wee=wr(c0,r=>r?0:1,"bool"),See={kernelName:c0,backendName:"cpu",kernelFunc:wee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _ee=is((r,e)=>r||e),Tee=Is(h0,_ee,null,"bool"),kee={kernelName:h0,backendName:"cpu",kernelFunc:Tee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Iee(r){const{inputs:e,backend:t,attrs:n}=r,{x:s}=e,{depthRadius:o,bias:a,alpha:i,beta:l}=n;tn(s,"LRN");const u=s.shape[3],h=u-1,d=t.data.get(s.dataId).values,c=pt(s.shape),f=new Float32Array(c);function p(m){const g=m%u;let y=m-g+Math.max(0,g-o);const v=m-g+Math.min(g+o,h);let b=0;for(;y<=v;y++){const w=d[y];b+=w*w}return b}for(let m=0;m<c;m++){const g=p(m),y=d[m]*Math.pow(a+i*g,-l);f[m]=y}return t.makeTensorInfo(s.shape,s.dtype,f)}const Eee={kernelName:d0,backendName:"cpu",kernelFunc:Iee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cee(r){const{inputs:e,backend:t,attrs:n}=r,{x:s,y:o,dy:a}=e,{depthRadius:i,bias:l,alpha:u,beta:h}=n;tn(a,"LRNGrad");const d=pt(a.shape),c=a.shape[3],f=t.data.get(a.dataId).values,p=t.data.get(s.dataId).values,m=t.data.get(o.dataId).values,g=new Float32Array(d),y=d;for(let v=0;v<y;v++){const b=v%c,w=v-b+Math.max(0,b-i),_=v-b+Math.min(c,b+i+1);let I=0;for(let C=w;C<_;C++)I+=Math.pow(p[C],2);I=u*I+l;for(let C=w;C<_;C++){let N=-2*u*h*p[C]*m[v]/I;v===C&&(N+=Math.pow(I,-h)),N*=f[v],g[C]+=N}}return t.makeTensorInfo(a.shape,s.dtype,g)}const $ee={kernelName:uw,backendName:"cpu",kernelFunc:Cee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UD(r){const{inputs:e,backend:t,attrs:n}=r,{x:s}=e,{reductionIndices:o,keepDims:a}=n,i=t;let l=s.shape;const u=l.length,h=Hn(o,l);let d=h;const c=qr(d,u);let f=i.data.get(s.dataId).values;if(c!=null){const w=new Array(u);for(let _=0;_<w.length;_++)w[_]=l[c[_]];f=gS(f,l,s.dtype,c,w),d=ts(d.length,u),l=w}tn(s,"max"),Fs("max",d,u);const[p,m]=ks(l,d),g=pt(m),y=iD(f,g,p,s.dtype),v=i.write(y,p,s.dtype);let b=p;return a&&(b=es(p,h)),{dataId:v,shape:b,dtype:s.dtype}}const Nee={kernelName:f0,backendName:"cpu",kernelFunc:UD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Aee(r){const{inputs:e,backend:t,attrs:n}=r,{x:s}=e;tn(s,"maxPool");const{filterSize:o,strides:a,pad:i,dimRoundingMode:l}=n,u=1;xe(Ks(a,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${a} and dilations '${u}'`);const h=Xi(s.shape,o,a,u,i,l);let d;if(h.filterWidth===1&&h.filterHeight===1&&ur(h.inShape,h.outShape))d=Qa({inputs:{x:s},backend:t});else{const c=t.data.get(s.dataId).values,f=pn(s.shape),p=bS(c,s.shape,s.dtype,f,h,"max");d=t.makeTensorInfo(h.outShape,s.dtype,p.values)}return d}const Ree={kernelName:p0,backendName:"cpu",kernelFunc:Aee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dee(r){const{inputs:e,backend:t,attrs:n}=r,{x:s}=e,{filterSize:o,strides:a,pad:i,dimRoundingMode:l,dataFormat:u}=n;tn(s,"maxPool3d");const h=Al(s.shape,o,a,1,i,l,u),d=t.data.get(s.dataId).values,c=LD(d,s.shape,s.dtype,pn(s.shape),h,"max");return t.makeTensorInfo(c.shape,"float32",c.values)}const Oee={kernelName:m0,backendName:"cpu",kernelFunc:Dee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mee(r){const{inputs:e,backend:t,attrs:n}=r,{dy:s,input:o}=e,{filterSize:a,strides:i,pad:l,dimRoundingMode:u}=n;tn([s,o],"maxPool3DGrad");const h=Al(o.shape,a,i,1,l,u),d=t.bufferSync(o),c=SQ(d,h),f=h.strideDepth,p=h.strideHeight,m=h.strideWidth,g=h.dilationDepth,y=h.dilationHeight,v=h.dilationWidth,b=h.effectiveFilterDepth,w=h.effectiveFilterHeight,_=h.effectiveFilterWidth,I=b-1-h.padInfo.front,C=_-1-h.padInfo.left,N=w-1-h.padInfo.top,O=Wn(o.shape,"float32"),D=t.bufferSync(s);for(let M=0;M<h.batchSize;++M)for(let P=0;P<h.inChannels;++P)for(let F=0;F<h.inDepth;++F)for(let B=0;B<h.inHeight;++B)for(let z=0;z<h.inWidth;++z){const Z=F-I,Q=B-N,K=z-C;let ne=0;for(let re=0;re<b;re+=g){const ce=(Z+re)/f;if(!(ce<0||ce>=h.outDepth||Math.floor(ce)!==ce))for(let be=0;be<w;be+=y){const we=(Q+be)/p;if(!(we<0||we>=h.outHeight||Math.floor(we)!==we))for(let ye=0;ye<_;ye+=v){const Oe=(K+ye)/m;if(Oe<0||Oe>=h.outWidth||Math.floor(Oe)!==Oe)continue;const Se=b*w*_-1-c.get(M,ce,we,Oe,P),Ee=re*w*_+be*_+ye,j=Se===Ee?1:0;if(j===0)continue;ne+=D.get(M,ce,we,Oe,P)*j}}}O.set(ne,M,F,B,z,P)}return t.makeTensorInfo(O.shape,O.dtype,O.values)}const Fee={kernelName:hw,backendName:"cpu",kernelFunc:Mee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lee(r){const{inputs:e,backend:t,attrs:n}=r,{dy:s,input:o,output:a}=e,i=o;tn([o,a],"maxPoolGrad");const{filterSize:l,strides:u,pad:h,dimRoundingMode:d}=n,c=Xi(i.shape,l,u,1,h,d),f=t.data.get(i.dataId).values,p=Wn(c.outShape,i.dtype,FD(f,i.shape,i.dtype,c).values),m=c.strideHeight,g=c.strideWidth,y=c.dilationHeight,v=c.dilationWidth,b=c.effectiveFilterHeight,w=c.effectiveFilterWidth,_=w-1-c.padInfo.left,I=b-1-c.padInfo.top,C=Wn(i.shape,"float32"),N=t.data.get(s.dataId).values,O=Wn(s.shape,"float32",N);for(let D=0;D<c.batchSize;++D)for(let M=0;M<c.inChannels;++M)for(let P=0;P<c.inHeight;++P)for(let F=0;F<c.inWidth;++F){const B=P-I,z=F-_;let Z=0;for(let Q=0;Q<b;Q+=y){const K=(B+Q)/m;if(!(K<0||K>=c.outHeight||Math.floor(K)!==K))for(let ne=0;ne<w;ne+=v){const re=(z+ne)/g;if(re<0||re>=c.outWidth||Math.floor(re)!==re)continue;const ce=b*w-1-p.get(D,K,re,M),be=Q*w+ne,we=ce===be?1:0;if(we===0)continue;Z+=O.get(D,K,re,M)*we}}C.set(Z,D,P,F,M)}return t.makeTensorInfo(C.shape,C.dtype,C.values)}const Pee={kernelName:cw,backendName:"cpu",kernelFunc:Lee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jee(r,e,t,n,s){const o=pn(e),a=bS(r,e,t,o,s,"max"),i=FD(r,e,t,s,!0,n);return[a.values,i.values]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bee={kernelName:NC,backendName:"cpu",kernelFunc:({inputs:r,attrs:e,backend:t})=>{const{x:n}=r,{filterSize:s,strides:o,pad:a,includeBatchInIndex:i}=e,l=t;tn(n,"MaxPoolWithArgmax");const u=l.data.get(n.dataId).values,h=Xi(n.shape,s,o,[1,1],a),[d,c]=jee(u,n.shape,n.dtype,i,h),f=l.write(d,h.outShape,n.dtype),p=l.write(c,h.outShape,n.dtype);return[{dataId:f,shape:h.outShape,dtype:n.dtype},{dataId:p,shape:h.outShape,dtype:"int32"}]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uee(r){const{inputs:e,backend:t,attrs:n}=r,{x:s}=e,{axis:o,keepDims:a}=n,i=Hn(o,s.shape),u=ks(s.shape,i)[1],h=pt(u),d=[],c=t.makeTensorInfo([],"float32",new Float32Array([h]));d.push(c);const f=xu({inputs:{x:s},backend:t,attrs:{dtype:"float32"}});d.push(f);const p=xS({inputs:{a:f,b:c},backend:t});d.push(p);const m=cm({inputs:{x:p},backend:t,attrs:{axis:o,keepDims:a}});return d.forEach(g=>t.disposeIntermediateTensorInfo(g)),m}const zee={kernelName:g0,backendName:"cpu",kernelFunc:Uee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vee(r){const{inputs:e,backend:t,attrs:n}=r,{x:s}=e,{axis:o,keepDims:a}=n;tn(s,"min");const i=Hn(o,s.shape);let l=i;const u=qr(l,s.shape.length);let h=s;u!=null&&(h=So({inputs:{x:s},backend:t,attrs:{perm:u}}),l=ts(l.length,s.shape.length)),Fs("min",l,h.shape.length);const[d,c]=ks(h.shape,l),f=pt(c),p=Xs(pt(d),h.dtype),m=t.data.get(h.dataId).values;for(let y=0;y<p.length;++y){const v=y*f;let b=m[v];for(let w=0;w<f;++w){const _=m[v+w];(Number.isNaN(_)||_<b)&&(b=_)}p[y]=b}u!=null&&t.disposeIntermediateTensorInfo(h);const g=t.makeTensorInfo(d,h.dtype,p);if(a){const y=es(d,i),v=Rr({inputs:{x:g},backend:t,attrs:{shape:y}});return t.disposeIntermediateTensorInfo(g),v}return g}const Gee={kernelName:y0,backendName:"cpu",kernelFunc:Vee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wee(r){const{inputs:e,backend:t,attrs:n}=r,{x:s}=e,{paddings:o,mode:a}=n;tn(s,"mirrorPad");const i=o.map((b,w)=>b[0]+s.shape[w]+b[1]),l=o.map(b=>b[0]),u=o.map((b,w)=>b[0]+s.shape[w]),h=a==="reflect"?0:1,d=t.data.get(s.dataId).values,c=s.shape.length,f=pn(s.shape),p=pt(i),m=i.length,g=pn(i),y=Os(s.dtype,p);for(let b=0;b<p;b++){let w=vd(b,m,g);for(let I=0;I<m;I++)w[I]<l[I]?w[I]=l[I]*2-w[I]-h:w[I]>=u[I]&&(w[I]=(u[I]-1)*2-w[I]+h);w=w.map((I,C)=>I-l[C]);const _=Wa(w,c,f);y[b]=d[_]}return{dataId:t.write(y,i,s.dtype),shape:i,dtype:s.dtype}}const Hee={kernelName:v0,backendName:"cpu",kernelFunc:Wee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qee=is((r,e)=>{const t=r%e;return r<0&&e<0||r>=0&&e>=0?t:(t+e)%e}),Xee=Is(kp,qee),Kee={kernelName:kp,backendName:"cpu",kernelFunc:Xee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zD(r){const{inputs:e,backend:t,attrs:n}=r,{logits:s}=e,{dim:o}=n,a=s.shape.length;let i=o;if(i===-1&&(i=a-1),i!==a-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${a} and dim was ${i}`);const l=Hn([i],s.shape),u=UD({inputs:{x:s},backend:t,attrs:{reductionIndices:l,keepDims:!1}}),h=es(u.shape,l),d=Rr({inputs:{x:u},backend:t,attrs:{shape:h}}),c=vS({inputs:{a:s,b:d},backend:t}),f=KR({inputs:{x:c},backend:t}),p=cm({inputs:{x:f},backend:t,attrs:{axis:l,keepDims:!1}}),m=Rr({inputs:{x:p},backend:t,attrs:{shape:h}}),g=xS({inputs:{a:f,b:m},backend:t});return t.disposeIntermediateTensorInfo(u),t.disposeIntermediateTensorInfo(d),t.disposeIntermediateTensorInfo(c),t.disposeIntermediateTensorInfo(f),t.disposeIntermediateTensorInfo(p),t.disposeIntermediateTensorInfo(m),g}const Yee={kernelName:F0,backendName:"cpu",kernelFunc:zD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zee(r){const{inputs:e,backend:t,attrs:n}=r,{logits:s}=e,{numSamples:o,seed:a,normalized:i}=n;tn(s,"multinomial");const l=i?s:zD({inputs:{logits:s},backend:t,attrs:{dim:-1}}),u=l.shape[0],h=l.shape[1],d=t.data.get(l.dataId).values,c=[u,o],f=Xs(pt(c),"int32");for(let p=0;p<u;++p){const m=p*h,g=new Float32Array(h-1);g[0]=d[m];for(let b=1;b<g.length;++b)g[b]=g[b-1]+d[m+b];const y=i2.alea(a.toString()),v=p*o;for(let b=0;b<o;++b){const w=y();f[v+b]=g.length;for(let _=0;_<g.length;_++)if(w<g[_]){f[v+b]=_;break}}}return i||t.disposeIntermediateTensorInfo(l),t.makeTensorInfo(c,"int32",f)}const Qee={kernelName:AC,backendName:"cpu",kernelFunc:Zee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jee=m2;function ete(r){const{inputs:e,backend:t,attrs:n}=r,{boxes:s,scores:o}=e,{maxOutputSize:a,iouThreshold:i,scoreThreshold:l}=n;tn(s,"NonMaxSuppression");const u=t.data.get(s.dataId).values,h=t.data.get(o.dataId).values,{selectedIndices:d}=Jee(u,h,a,i,l);return t.makeTensorInfo([d.length],"int32",new Int32Array(d))}const tte={kernelName:dw,backendName:"cpu",kernelFunc:ete};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nte=g2;function rte(r){const{inputs:e,backend:t,attrs:n}=r,{boxes:s,scores:o}=e,{maxOutputSize:a,iouThreshold:i,scoreThreshold:l,padToMaxOutputSize:u}=n;tn(s,"NonMaxSuppressionPadded");const h=t.data.get(s.dataId).values,d=t.data.get(o.dataId).values,{selectedIndices:c,validOutputs:f}=nte(h,d,a,i,l,u);return[t.makeTensorInfo([c.length],"int32",new Int32Array(c)),t.makeTensorInfo([],"int32",new Int32Array([f]))]}const ste={kernelName:fw,backendName:"cpu",kernelFunc:rte};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ote=y2;function ite(r){const{inputs:e,backend:t,attrs:n}=r,{boxes:s,scores:o}=e,{maxOutputSize:a,iouThreshold:i,scoreThreshold:l,softNmsSigma:u}=n;tn(s,"NonMaxSuppressionWithScore");const h=t.data.get(s.dataId).values,d=t.data.get(o.dataId).values,c=a,f=i,p=l,m=u,{selectedIndices:g,selectedScores:y}=ote(h,d,c,f,p,m);return[t.makeTensorInfo([g.length],"int32",new Int32Array(g)),t.makeTensorInfo([y.length],"float32",new Float32Array(y))]}const ate={kernelName:pw,backendName:"cpu",kernelFunc:ite};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lte(r){const{inputs:e,backend:t,attrs:n}=r,{indices:s}=e,{dtype:o,depth:a,onValue:i,offValue:l}=n;tn(s,"oneHot");const u=pt(s.shape),h=new Float32Array(u*a);h.fill(l);const d=t.data.get(s.dataId).values;for(let c=0;c<u;++c)d[c]>=0&&d[c]<a&&(h[c*a+d[c]]=i);return t.makeTensorInfo([...s.shape,a],o,h)}const ute={kernelName:S0,backendName:"cpu",kernelFunc:lte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function by(r){const{inputs:e,backend:t}=r,{x:n}=e;if(n.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if(n.dtype==="complex64"){const s=Bc({inputs:{input:n},backend:t}),o=by({inputs:{x:s},backend:t}),a=sd({inputs:{input:n},backend:t}),i=by({inputs:{x:a},backend:t}),l=Mo({inputs:{real:o,imag:i},backend:t});return t.disposeIntermediateTensorInfo(s),t.disposeIntermediateTensorInfo(o),t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(i),l}else return wS({backend:t,attrs:{shape:n.shape,value:0,dtype:n.dtype}})}const cte={kernelName:j0,backendName:"cpu",kernelFunc:by};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VD(r){const{inputs:e,backend:t}=r,{x:n}=e;if(n.dtype==="string")throw new Error("onesLike is not supported for string tensors");if(n.dtype==="complex64"){const s=Bc({inputs:{input:n},backend:t}),o=VD({inputs:{x:s},backend:t}),a=sd({inputs:{input:n},backend:t}),i=by({inputs:{x:a},backend:t}),l=Mo({inputs:{real:o,imag:i},backend:t});return t.disposeIntermediateTensorInfo(s),t.disposeIntermediateTensorInfo(o),t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(i),l}else return wS({backend:t,attrs:{shape:n.shape,value:1,dtype:n.dtype}})}const hte={kernelName:w0,backendName:"cpu",kernelFunc:VD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GD(r){const{inputs:e,backend:t,attrs:n}=r,{axis:s}=n;if(e.length===1)return vy({inputs:{input:e[0]},backend:t,attrs:{dim:s}});const o=e[0].shape,a=e[0].dtype;e.forEach(h=>{qi(o,h.shape,"All tensors passed to stack must have matching shapes"),xe(a===h.dtype,()=>"All tensors passed to stack must have matching dtypes")});const i=[],l=e.map(h=>{const d=vy({inputs:{input:h},backend:t,attrs:{dim:s}});return i.push(d),d}),u=od({inputs:l,backend:t,attrs:{axis:s}});return i.forEach(h=>t.disposeIntermediateTensorInfo(h)),u}const dte={kernelName:_0,backendName:"cpu",kernelFunc:GD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fte(r){const{inputs:e,backend:t,attrs:n}=r,{x:s}=e,{paddings:o,constantValue:a}=n;tn(s,"pad");const i=o.map((v,b)=>v[0]+s.shape[b]+v[1]),l=o.map(v=>v[0]),u=t.data.get(s.dataId).values,h=pt(s.shape),d=s.shape.length,c=pn(s.shape),f=pt(i),p=i.length,m=pn(i),g=Os(s.dtype,f);a!==0&&g.fill(a);for(let v=0;v<h;v++){const w=vd(v,d,c).map((I,C)=>I+l[C]),_=Wa(w,p,m);g[_]=u[v]}return{dataId:t.write(g,i,s.dtype),shape:i,dtype:s.dtype}}const WD={kernelName:T0,backendName:"cpu",kernelFunc:fte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pte=is((r,e)=>Math.pow(r,e)),mte=Is(Ep,pte),gte={kernelName:Ep,backendName:"cpu",kernelFunc:mte};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yte(r){const{inputs:e,backend:t,attrs:n}=r,{paramsNestedSplits:s,paramsDenseValues:o,indices:a}=e,i=s.map(g=>t.data.get(g.dataId).values),l=s.map(g=>g.shape),u=t.data.get(o.dataId).values,h=t.data.get(a.dataId).values,[d,c,f]=dD(i,l,u,o.shape,o.dtype,h,a.shape),p=d.map(g=>t.makeTensorInfo([g.length],"int32",g)),m=t.makeTensorInfo(f,o.dtype,c);return p.concat([m])}const vte={kernelName:RC,backendName:"cpu",kernelFunc:yte};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bte(r){const{inputs:e,backend:t,attrs:n}=r,{shape:s,values:o,defaultValue:a,rowPartitionTensors:i}=e,{rowPartitionTypes:l}=n,u=t.data.get(s.dataId).values,h=t.data.get(o.dataId).values,d=t.data.get(a.dataId).values,c=i.map(g=>t.data.get(g.dataId).values),f=i.map(g=>g.shape),[p,m]=fD(u,s.shape,h,o.shape,o.dtype,d,a.shape,c,f,l);return t.makeTensorInfo(p,o.dtype,m)}const xte={kernelName:DC,backendName:"cpu",kernelFunc:bte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wte(r){const{backend:e,attrs:t}=r,{start:n,stop:s,dtype:o,step:a}=t,i=pD(n,s,a,o);return e.makeTensorInfo([i.length],o,i)}const Ste={kernelName:mw,backendName:"cpu",kernelFunc:wte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _te=wr(Cp,r=>1/r),Tte={kernelName:Cp,backendName:"cpu",kernelFunc:_te};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kte(r){const{inputs:e,backend:t,attrs:n}=r,{images:s}=e,{alignCorners:o,halfPixelCenters:a,size:i}=n;tn(s,"resizeBilinear");const l=pn(s.shape),[u,h]=i,[d,c,f,p]=s.shape,m=t.data.get(s.dataId).values,g=new Float32Array(pt([d,u,h,p])),y=[o&&u>1?c-1:c,o&&h>1?f-1:f],v=[o&&u>1?u-1:u,o&&h>1?h-1:h];let b=0;const w=y[0]/v[0],_=y[1]/v[1];for(let I=0;I<d;I++)for(let C=0;C<u;C++){let N;a?N=w*(C+.5)-.5:N=w*C;const O=Math.max(0,Math.floor(N)),D=N-O,M=Math.min(c-1,Math.ceil(N)),P=I*l[0]+O*l[1],F=I*l[0]+M*l[1];for(let B=0;B<h;B++){let z;a?z=_*(B+.5)-.5:z=_*B;const Z=Math.max(0,Math.floor(z)),Q=z-Z,K=Math.min(f-1,Math.ceil(z)),ne=P+Z*l[2],re=F+Z*l[2],ce=P+K*l[2],be=F+K*l[2];for(let we=0;we<p;we++){const ye=m[ne+we],Oe=m[re+we],Se=m[ce+we],Ee=m[be+we],j=ye+(Se-ye)*Q,W=Oe+(Ee-Oe)*Q,J=j+(W-j)*D;g[b++]=J}}}return t.makeTensorInfo([d,u,h,p],"float32",g)}const Ite={kernelName:$0,backendName:"cpu",kernelFunc:kte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ete(r){const{inputs:e,backend:t,attrs:n}=r,{images:s,dy:o}=e,{alignCorners:a}=n;tn([o,s],"resizeBilinearGrad");const i=pn(s.shape),[l,u,h,d]=s.shape,[,c,f]=o.shape,p=new Float32Array(l*u*h*d),m=[a&&c>1?u-1:u,a&&f>1?h-1:h],g=[a&&c>1?c-1:c,a&&f>1?f-1:f],y=m[0]/g[0],v=m[1]/g[1],b=t.data.get(o.dataId).values;let w=0;for(let _=0;_<l;_++){const I=_*i[0];for(let C=0;C<c;C++){const N=C*y,O=Math.floor(N),D=Math.min(Math.ceil(N),u-1),M=I+O*i[1],P=I+D*i[1],F=N-O,B=1-F;for(let z=0;z<f;z++){const Z=z*v,Q=Math.floor(Z),K=Math.min(Math.ceil(Z),h-1),ne=Z-Q,re=1-ne,ce=M+Q*i[2],be=M+K*i[2],we=P+Q*i[2],ye=P+K*i[2],Oe=B*re,Se=B*ne,Ee=F*re,j=F*ne;for(let W=0;W<d;W++){const J=b[w++];p[ce+W]+=J*Oe,p[be+W]+=J*Se,p[we+W]+=J*Ee,p[ye+W]+=J*j}}}}return t.makeTensorInfo([l,h,u,d],"float32",p)}const Cte={kernelName:vw,backendName:"cpu",kernelFunc:Ete};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $te(r){const{inputs:e,backend:t,attrs:n}=r,{images:s}=e,{alignCorners:o,halfPixelCenters:a,size:i}=n;tn(s,"resizeNearestNeighbor");const l=pn(s.shape),[u,h]=i,[d,c,f,p]=s.shape,m=t.data.get(s.dataId).values,g=new Float32Array(d*u*h*p),y=[o&&u>1?c-1:c,o&&h>1?f-1:f],v=[o&&u>1?u-1:u,o&&h>1?h-1:h],b=y[0]/v[0],w=y[1]/v[1];let _=0;for(let I=0;I<d;I++){const C=I*l[0];for(let N=0;N<u;N++){const O=a?b*(N+.5):b*N;let D=Math.min(c-1,o?Math.round(O):Math.floor(O));a&&(D=Math.max(0,D));const M=C+D*l[1];for(let P=0;P<h;P++){const F=a?w*(P+.5):w*P;let B=Math.min(f-1,o?Math.round(F):Math.floor(F));a&&(B=Math.max(0,B));const z=M+B*l[2];for(let Z=0;Z<p;Z++){const Q=m[z+Z];g[_++]=Q}}}}return t.makeTensorInfo([d,u,h,p],s.dtype,g)}const Nte={kernelName:C0,backendName:"cpu",kernelFunc:$te};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ate(r){const{inputs:e,backend:t,attrs:n}=r,{images:s,dy:o}=e,{alignCorners:a}=n;tn([o,s],"resizeNearestNeighborGrad");const i=pn(s.shape),l=pn(o.shape),[u,h,d,c]=s.shape,[,f,p]=o.shape,m=new Float32Array(u*h*d*c),g=t.data.get(o.dataId).values,y=[a&&f>1?h-1:h,a&&p>1?d-1:d],v=[a&&f>1?f-1:f,a&&p>1?p-1:p],b=y[0]/v[0],w=y[1]/v[1],_=1/b,I=1/w,C=Math.ceil(_)*2+2,N=Math.ceil(I)*2+2;for(let O=0;O<u;O++){const D=O*i[0];for(let M=0;M<h;M++){const P=D+M*i[1],F=Math.floor(M*_),B=Math.floor(F-C/2);for(let z=0;z<d;z++){const Z=P+z*i[2],Q=Math.floor(z*I),K=Math.floor(Q-N/2);for(let ne=0;ne<c;ne++){let re=0;for(let ce=0;ce<C;ce++){const be=ce+B;if(be<0||be>=f)continue;const we=D+be*l[1],ye=be*b,Oe=Math.min(h-1,a?Math.round(ye):Math.floor(ye));if(M===Oe)for(let Se=0;Se<N;Se++){const Ee=Se+K;if(Ee<0||Ee>=p)continue;const j=we+Ee*l[2],W=Ee*w,J=Math.min(d-1,a?Math.round(W):Math.floor(W));z===J&&(re+=g[j+ne])}}m[Z+ne]=re}}}}return t.makeTensorInfo(s.shape,s.dtype,m)}const Rte={kernelName:yw,backendName:"cpu",kernelFunc:Ate};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dte(r){const{inputs:e,backend:t,attrs:n}=r,{x:s}=e,{dims:o}=n;tn(s,"reverse");const a=s.shape.length,i=Hn(o,s.shape);if(a===0)return Qa({inputs:{x:s},backend:t});const l=new Ws(s.shape,s.dtype),u=t.bufferSync(s);for(let h=0;h<l.size;h++){const d=l.indexToLoc(h),c=d.slice();i.forEach(f=>c[f]=s.shape[f]-1-c[f]),l.set(u.get(...c),...d)}return t.makeTensorInfo(l.shape,l.dtype,l.values)}const Ote={kernelName:N0,backendName:"cpu",kernelFunc:Dte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mte={kernelName:Aw,backendName:"cpu",kernelFunc:({inputs:r,attrs:e,backend:t})=>{const{image:n}=r,{radians:s,fillValue:o,center:a}=e,i=t,l=Os(n.dtype,pt(n.shape)),[u,h,d,c]=n.shape,[f,p]=E2(a,h,d),m=255,g=Math.sin(s),y=Math.cos(s),v=i.data.get(n.dataId).values;for(let w=0;w<u;w++){const _=w*d*h*c;for(let I=0;I<h;I++){const C=I*(d*c);for(let N=0;N<d;N++){const O=N*c;for(let D=0;D<c;D++){const M=[u,I,N,D],P=M[2],F=M[1];let B=(P-f)*y-(F-p)*g,z=(P-f)*g+(F-p)*y;B=Math.round(B+f),z=Math.round(z+p);let Z=o;if(typeof o!="number"&&(D===3?Z=m:Z=o[D]),B>=0&&B<d&&z>=0&&z<h){const K=z*(d*c),ne=B*c,re=_+K+ne+D;Z=v[re]}const Q=_+C+O+D;l[Q]=Z}}}}return{dataId:i.write(l,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fte=wr(Ap,r=>{const e=Math.floor(r);return r-e<.5?Math.floor(r):r-e>.5?Math.ceil(r):e%2===0?e:e+1}),Lte={kernelName:Ap,backendName:"cpu",kernelFunc:Fte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pte(r){const{inputs:e,backend:t,attrs:n}=r,{indices:s,updates:o}=e,{shape:a}=n,{sliceRank:i,numUpdates:l,sliceSize:u,strides:h,outputSize:d}=Hp(o,s,a),c=!0,f=t.bufferSync(s),p=t.bufferSync(o),m=Lh(f,p,a,d,u,l,i,h,0,c);return t.makeTensorInfo(a,m.dtype,m.values)}const jte={kernelName:OC,backendName:"cpu",kernelFunc:Pte};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bte(r,e){let t=0,n=r.length,s=0;for(;t<n;)s=Math.floor((t+n)/2),r[s]<e?t=s+1:n=s;return n}function Ute(r,e){let t=0,n=r.length,s=0;for(;t<n;)s=Math.floor((t+n)/2),r[s]<=e?t=s+1:n=s;return n}function zte(r,e,t,n,s,o){const a=_s("int32",t*s);for(let i=0;i<t;++i){const l=r.slice(i*n,(i+1)*n),u=i*s;for(let h=0;h<s;++h)a[u+h]=o==="left"?Bte(l,e[h+u]):Ute(l,e[h+u])}return a}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vte(r){const{inputs:e,backend:t,attrs:n}=r,{sortedSequence:s,values:o}=e,{side:a}=n,i=t.data.get(s.dataId).values,l=t.data.get(o.dataId).values,u=zte(i,l,s.shape[0],s.shape[1],o.shape[1],a);return t.makeTensorInfo(o.shape,"int32",u)}const Gte={kernelName:MC,backendName:"cpu",kernelFunc:Vte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wte(r){const{inputs:e,backend:t}=r,{condition:n,t:s,e:o}=e;tn([n,s,o],"select");const a=n.shape.length,i=t.data.get(n.dataId).values,l=t.data.get(s.dataId).values,u=t.data.get(o.dataId).values,h=Bo(s.dtype,o.dtype),d=Xs(pt(s.shape),h);let c=0;const f=a===0||a>1||s.shape.length===1?1:pt(s.shape.slice(1));for(let p=0;p<i.length;p++)for(let m=0;m<f;m++)i[p]===1?d[c++]=l[p]:d[c++]=u[p];return t.makeTensorInfo(s.shape,h,d)}const Hte={kernelName:A0,backendName:"cpu",kernelFunc:Wte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qte=J0,Xte=e1,Kte=wr(Dp,r=>r>=0?Xte*r:qte*(Math.exp(r)-1)),Yte={kernelName:Dp,backendName:"cpu",kernelFunc:Kte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zte=wr(Fp,r=>r<0?-1:r>0?1:0),Qte={kernelName:Fp,backendName:"cpu",kernelFunc:Zte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jte=wr(Op,r=>Math.sin(r)),ene={kernelName:Op,backendName:"cpu",kernelFunc:Jte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tne=wr(Mp,r=>Math.sinh(r)),nne={kernelName:Mp,backendName:"cpu",kernelFunc:tne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rne=11920928955078125e-23,FI=Math.log(rne)+2,sne=wr(Pp,r=>{const e=r>-FI,t=r<FI,n=Math.exp(r);let s;return t?s=n:e?s=r:s=Math.log(1+n),s}),one={kernelName:Pp,backendName:"cpu",kernelFunc:sne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ine(r){const{inputs:e,backend:t,attrs:n}=r,{x:s}=e,{blockShape:o,paddings:a}=n;tn([s],"spaceToBatchND");const i=pt(o),l=[[0,0]];l.push(...a);for(let I=1+o.length;I<s.shape.length;++I)l.push([0,0]);const u=WD.kernelFunc({inputs:{x:s},backend:t,attrs:{paddings:l,constantValue:0}}),h=Qp(u.shape,o,i,!1),d=Jp(h.length,o.length,!1),c=em(u.shape,o,i,!1),m=Rr({inputs:{x:u},backend:t,attrs:{shape:h}}),v=So({inputs:{x:m},backend:t,attrs:{perm:d}}),_=Rr({inputs:{x:v},backend:t,attrs:{shape:c}});return t.disposeIntermediateTensorInfo(u),t.disposeIntermediateTensorInfo(m),t.disposeIntermediateTensorInfo(v),_}const ane={kernelName:O0,backendName:"cpu",kernelFunc:ine};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lne(r){const{inputs:e,backend:t}=r,{indices:n,values:s,denseShape:o,defaultValue:a}=e;if(o.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
        ${o.shape}`);if(n.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
        ${n.shape}`);if(s.shape.length!==1)throw new Error(`Values must be a vector, saw:
        ${s.shape}`);if(a.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${a.shape}`);const i=t.data.get(n.dataId).values,l=t.data.get(s.dataId).values,u=t.data.get(o.dataId).values,h=t.data.get(a.dataId).values[0],[d,c,f,p,m]=vD(i,n.shape,n.dtype,l,s.dtype,u,h);return[t.makeTensorInfo(c,n.dtype,d),t.makeTensorInfo([c[0]],s.dtype,f),t.makeTensorInfo([p.length],"bool",new Uint8Array(p.map(g=>Number(g)))),t.makeTensorInfo([m.length],n.dtype,new Int32Array(m))]}const une={kernelName:bw,backendName:"cpu",kernelFunc:lne};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cne(r){const{inputs:e,backend:t}=r,{inputIndices:n,inputShape:s,newShape:o}=e;if(n.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape
        ${n.shape}`);if(s.shape.length!==1)throw new Error(`Input shape should be a vector but received shape
        ${s.shape}`);if(o.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${o.shape}`);const a=Array.from(t.data.get(s.dataId).values),i=t.data.get(n.dataId).values,l=Array.from(t.data.get(o.dataId).values),[u,h,d]=bD(i,n.shape,n.dtype,a,l);return[t.makeTensorInfo(h,n.dtype,u),t.makeTensorInfo([d.length],o.dtype,new Int32Array(d))]}const hne={kernelName:xw,backendName:"cpu",kernelFunc:cne};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dne(r){const{inputs:e,backend:t}=r,{data:n,indices:s,segmentIds:o}=e;if(n.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.shape.length!==1)throw new Error(`Indices should be a vector but received shape
          ${s.shape}`);if(o.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
          ${o.shape}`);if(s.shape[0]!==o.shape[0])throw new Error("segmentIds and indices should have same size.");const a=t.data.get(n.dataId).values,i=t.data.get(s.dataId).values,l=t.data.get(o.dataId).values,[u,h]=yS(a,n.shape,n.dtype,i,l,!0);return t.makeTensorInfo(h,n.dtype,u)}const fne={kernelName:ww,backendName:"cpu",kernelFunc:dne};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pne(r){const{inputs:e,backend:t}=r,{data:n,indices:s,segmentIds:o}=e;if(n.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.shape.length!==1)throw new Error(`Indices should be a vector but received shape
         ${s.shape}`);if(o.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
         ${o.shape}`);if(s.shape[0]!==o.shape[0])throw new Error("segmentIds and indices should have same size.");const a=t.data.get(n.dataId).values,i=t.data.get(s.dataId).values,l=t.data.get(o.dataId).values,[u,h]=yS(a,n.shape,n.dtype,i,l);return t.makeTensorInfo(h,n.dtype,u)}const mne={kernelName:Sw,backendName:"cpu",kernelFunc:pne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gne(r){const{inputs:e,backend:t,attrs:n}=r,{sparseIndices:s,sparseValues:o,defaultValue:a}=e,{outputShape:i}=n,{sliceRank:l,numUpdates:u,sliceSize:h,strides:d,outputSize:c}=Hp(o,s,i),f=!1,p=t.bufferSync(s);let m;switch(o.dtype){case"bool":{const g=t.bufferSync(o),y=Boolean(t.data.get(a.dataId).values[0]);m=Lh(p,g,i,c,h,u,l,d,y,f);break}case"float32":{const g=t.bufferSync(o),y=t.data.get(a.dataId).values[0];m=Lh(p,g,i,c,h,u,l,d,y,f);break}case"int32":{const g=t.bufferSync(o),y=t.data.get(a.dataId).values[0];m=Lh(p,g,i,c,h,u,l,d,y,f);break}case"string":{const g=t.bufferSync(o),y=mu(t.data.get(a.dataId).values[0]);m=Lh(p,g,i,c,h,u,l,d,y,f);break}default:throw new Error(`Unsupported type ${o.dtype}`)}return t.makeTensorInfo(i,m.dtype,m.values)}const yne={kernelName:FC,backendName:"cpu",kernelFunc:gne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vne(r){const{inputs:e,backend:t,attrs:n}=r,{x:s}=e,{numOrSizeSplits:o,axis:a}=n,i=Hn(a,s.shape)[0],l=z2(s,o,i),u=new Array(s.shape.length).fill(0),h=s.shape.slice();return l.map(d=>{const c=[...h];c[i]=d;const f=Uc({inputs:{x:s},backend:t,attrs:{begin:u,size:c}});return u[i]+=d,f})}const bne={kernelName:M0,backendName:"cpu",kernelFunc:vne};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xne={kernelName:_w,backendName:"cpu",kernelFunc:({inputs:r,backend:e})=>{const{x:t}=r,n=e;tn(t,"square");const s=n.data.get(t.dataId).values,o=new Float32Array(s.length);for(let i=0;i<s.length;++i){const l=s[i];o[i]=l*l}return{dataId:n.write(o,t.shape,t.dtype),shape:t.shape,dtype:t.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wne=wr(Wp,(r,e)=>{const t=e;return isNaN(r)?NaN:r>0?1:t.alpha}),Sne={kernelName:Wp,backendName:"cpu",kernelFunc:wne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ne(r){const{inputs:e,backend:t,attrs:n}=r,{x:s}=e,{begin:o,end:a,strides:i,beginMask:l,endMask:u,ellipsisMask:h,newAxisMask:d,shrinkAxisMask:c}=n;tn(s,"stridedSlice");const{finalShapeSparse:f,finalShape:p,isIdentity:m,sliceDim0:g,isSimpleSlice:y,begin:v,end:b,strides:w}=zw(s.shape,o,a,i,l,u,h,d,c);let _;if(m)_=Rr({inputs:{x:s},backend:t,attrs:{shape:p}});else if(g||y){xe(s.shape.length>=1,()=>`Input must have rank at least 1, got: ${s.shape.length}`);const I=jw(v,b,w),C=Uc({inputs:{x:s},backend:t,attrs:{begin:v,size:I}});_=Rr({inputs:{x:C},backend:t,attrs:{shape:p}}),t.disposeIntermediateTensorInfo(C)}else{const I=t.bufferSync(s),C=wD(f,I,w,v);_=t.makeTensorInfo(p,C.dtype,C.values)}return _}const Tne={kernelName:Tw,backendName:"cpu",kernelFunc:_ne};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kne(r){const{inputs:e,backend:t,attrs:n}=r,{separator:s,nGramWidths:o,leftPad:a,rightPad:i,padWidth:l,preserveShortSequences:u}=n,{data:h,dataSplits:d}=e,c=t.data.get(h.dataId).values,f=t.data.get(d.dataId).values,[p,m]=SD(c,f,s,o,a,i,l,u);return[t.makeTensorInfo([p.length],"string",p),t.makeTensorInfo(d.shape,"int32",m)]}const Ine={kernelName:kw,backendName:"cpu",kernelFunc:kne};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ene(r){const{inputs:e,backend:t,attrs:n}=r,{skipEmpty:s}=n,{input:o,delimiter:a}=e;if(o.dtype!=="string")throw new Error("Input must be of datatype string");if(o.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${o.shape}`);if(a.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${a.shape}`);const i=t.data.get(o.dataId).values,l=t.data.get(a.dataId).values[0],[u,h,d]=_D(i,l,s),c=h.length;return[t.makeTensorInfo([c,2],"int32",u),t.makeTensorInfo([c],"string",h),t.makeTensorInfo([2],"int32",new Int32Array(d))]}const Cne={kernelName:Iw,backendName:"cpu",kernelFunc:Ene};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ne(r){const{inputs:e,backend:t,attrs:n}=r,{numBuckets:s}=n,{input:o}=e;if(o.dtype!=="string")throw new Error("Input must be of datatype string");if(s<=0)throw new Error("Number of buckets must be at least 1");const a=t.data.get(o.dataId).values,i=TD(a,s);return t.makeTensorInfo(o.shape,"int32",i)}const Nne={kernelName:Ew,backendName:"cpu",kernelFunc:$ne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ane=wr(zp,r=>Math.tan(r)),Rne={kernelName:zp,backendName:"cpu",kernelFunc:Ane};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dne=wr(Vp,r=>Math.tanh(r)),One={kernelName:Vp,backendName:"cpu",kernelFunc:Dne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mne(r){const{inputs:e,backend:t,attrs:n}=r,{x:s}=e,{reps:o}=n;tn(s,"tile");const a=ID(t.bufferSync(s),o);return t.makeTensorInfo(a.shape,a.dtype,a.values)}const Fne={kernelName:Gp,backendName:"cpu",kernelFunc:Mne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lne(r){const{inputs:e,backend:t,attrs:n}=r,{x:s}=e,{k:o,sorted:a}=n;tn(s,"topk");const i=t.data.get(s.dataId).values,[l,u]=CD(i,s.shape,s.dtype,o,a);return[t.makeTensorInfo(l.shape,l.dtype,l.values),t.makeTensorInfo(u.shape,u.dtype,u.values)]}const Pne={kernelName:Cw,backendName:"cpu",kernelFunc:Lne};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jne(r){const{inputs:e,attrs:t,backend:n}=r,{image:s,transforms:o}=e,{interpolation:a,fillMode:i,fillValue:l,outputShape:u}=t,[h,d,c,f]=s.shape,[p,m]=u!=null?u:[d,c],g=[h,p,m,f],y=pn(s.shape),v=y[0],b=y[1],w=y[2],_=pn(g),I=_[0],C=_[1],N=_[2],O=Os(s.dtype,pt(g));O.fill(l);const D=n.data.get(s.dataId).values,M=n.data.get(o.dataId).values;for(let F=0;F<h;++F){const B=o.shape[0]===1?M:M.subarray(F*8,F*8+8);for(let z=0;z<p;++z)for(let Z=0;Z<m;++Z)for(let Q=0;Q<f;++Q){let K;const ne=B[6]*Z+B[7]*z+1;if(ne===0)continue;const re=(B[0]*Z+B[1]*z+B[2])/ne,ce=(B[3]*Z+B[4]*z+B[5])/ne,be=LI(re,c,i),we=LI(ce,d,i);switch(a){case"nearest":K=Wne(D,d,c,v,b,w,F,we,be,Q,l);break;case"bilinear":K=Hne(D,d,c,v,b,w,F,we,be,Q,l);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${a}`)}const ye=F*I+z*C+Z*N+Q;O[ye]=K}return n.makeTensorInfo(g,s.dtype,O)}return{dataId:n.write(O,g,s.dtype),shape:s.shape,dtype:s.dtype}}const Bne={kernelName:$w,backendName:"cpu",kernelFunc:jne};function LI(r,e,t){switch(t){case"reflect":return Une(r,e);case"wrap":return zne(r,e);case"nearest":return Gne(r,e);case"constant":default:return Vne(r)}}function Une(r,e){let t=r;if(t<0)if(e<=1)t=0;else{const n=2*e;t<n&&(t=n*Math.trunc(-t/n)+t),t=t<-e?t+n:-t-1}else if(t>e-1)if(e<=1)t=0;else{const n=2*e;t-=n*Math.trunc(t/n),t>=e&&(t=n-t-1)}return $c(0,t,e-1)}function zne(r,e){let t=r;if(t<0)if(e<=1)t=0;else{const n=e-1;t+=e*(Math.trunc(-t/n)+1)}else if(t>e-1)if(e<=1)t=0;else{const n=e-1;t-=e*Math.trunc(t/n)}return $c(0,t,e-1)}function Vne(r,e){return r}function Gne(r,e){return $c(0,r,e-1)}function df(r,e,t,n,s,o,a,i,l,u,h){const d=a*n+i*s+l*o+u;return 0<=i&&i<e&&0<=l&&l<t?r[d]:h}function Wne(r,e,t,n,s,o,a,i,l,u,h){const d=Math.round(i),c=Math.round(l);return df(r,e,t,n,s,o,a,d,c,u,h)}function Hne(r,e,t,n,s,o,a,i,l,u,h){const d=Math.floor(i),c=Math.floor(l),f=d+1,p=c+1,m=(p-l)*df(r,e,t,n,s,o,a,d,c,u,h)+(l-c)*df(r,e,t,n,s,o,a,d,p,u,h),g=(p-l)*df(r,e,t,n,s,o,a,f,c,u,h)+(l-c)*df(r,e,t,n,s,o,a,f,p,u,h);return(f-i)*m+(i-d)*g}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qne(r){const{inputs:e,attrs:t,backend:n}=r,{axis:s}=t,{x:o}=e;tn(o,"unique");const a=n.data.get(o.dataId).values,{outputValues:i,outputShape:l,indices:u}=$D(a,s,o.shape,o.dtype);return[n.makeTensorInfo(l,o.dtype,i),n.makeTensorInfo([u.length],"int32",u)]}const Xne={kernelName:Nw,backendName:"cpu",kernelFunc:qne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kne(r){const{inputs:e,backend:t,attrs:n}=r,{value:s}=e;let{axis:o}=n;o<0&&(o+=s.shape.length);const a=s.shape.length,i=s.shape[o],l=new Array(a-1);let u=0;for(let f=0;f<a;f++)f!==o&&(l[u++]=s.shape[f]);const h=new Array(a).fill(0),d=s.shape.slice();d[o]=1;const c=new Array(i);for(let f=0;f<c.length;f++){h[o]=f;const p=Uc({inputs:{x:s},backend:t,attrs:{begin:h,size:d}});c[f]=Rr({inputs:{x:p},backend:t,attrs:{shape:l}}),t.disposeIntermediateTensorInfo(p)}return c}const Yne={kernelName:L0,backendName:"cpu",kernelFunc:Kne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zne(r){const{inputs:e,backend:t,attrs:n}=r,{x:s,segmentIds:o}=e,{numSegments:a}=n;tn(s,"unsortedSegmentSum");const i=s.shape.length,l=o.shape.length,u=[],h=[],d=i-l;let c=o;for(let p=0;p<d;++p){const m=vy({inputs:{input:c},backend:t,attrs:{dim:p+1}});c=m,h.push(m)}for(let p=0;p<a;++p){const m=ku(p,"int32"),g=t.makeTensorInfo([],"int32",m),y=qR({inputs:{a:g,b:c},backend:t}),v=xu({inputs:{x:y},backend:t,attrs:{dtype:"float32"}}),b=d1({inputs:{a:v,b:s},backend:t}),w=cm({inputs:{x:b},backend:t,attrs:{axis:0,keepDims:!1}});u.push(w),h.push(g),h.push(y),h.push(v),h.push(b),h.push(w)}const f=GD({inputs:u,backend:t,attrs:{axis:0}});return h.forEach(p=>t.disposeIntermediateTensorInfo(p)),f}const Qne={kernelName:P0,backendName:"cpu",kernelFunc:Zne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jne=[YZ,FY,QZ,eQ,zY,nQ,sQ,iQ,lQ,cQ,dQ,pQ,gQ,bQ,wQ,TQ,IQ,CQ,NQ,XZ,RQ,OQ,FQ,PQ,BY,GY,BQ,LY,zQ,GQ,WQ,qQ,KQ,ZQ,JQ,tJ,rJ,oJ,aJ,uJ,hJ,fJ,mJ,gJ,vJ,xJ,SJ,_J,TJ,kJ,CJ,UZ,NJ,WY,PJ,HY,jJ,XY,WJ,HJ,XJ,YY,ZJ,JJ,tee,ree,oee,QY,eZ,PY,aee,VQ,uee,hee,fee,zZ,nZ,sZ,mee,iZ,yee,xee,See,kee,Eee,$ee,Nee,lZ,Ree,Oee,Fee,Pee,Bee,zee,Gee,cZ,Hee,Kee,Qee,dZ,pZ,tte,ste,ate,gZ,ute,hte,dte,WD,gte,GZ,bZ,vte,xte,Ste,jY,Yb,Tte,WZ,HZ,qZ,Ite,Cte,Nte,Rte,Ote,Mte,Lte,EZ,jte,Gte,Hte,Yte,$Z,Qte,ene,nne,NZ,Yee,one,ane,une,hne,fne,mne,yne,bne,DZ,xne,MZ,Sne,Tne,Ine,Cne,Nne,jZ,IJ,Rne,One,Fne,Pne,Bne,yZ,Xne,Yne,Qne,cte];for(const r of Jne)PC(r);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gc={},gg={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function ere(r,e){gc[r]=e}function ya(r,e){if(!(r in gc)||e!=null){const n=nre(r,e);if(n!==null)gc[r]=n;else return console.log("Could not get context for WebGL version",r),null}const t=gc[r];return t==null||t.isContextLost()?(delete gc[r],ya(r)):(t.disable(t.DEPTH_TEST),t.disable(t.STENCIL_TEST),t.disable(t.BLEND),t.disable(t.DITHER),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SAMPLE_COVERAGE),t.enable(t.SCISSOR_TEST),t.enable(t.CULL_FACE),t.cullFace(t.BACK),gc[r])}function tre(r){if(typeof OffscreenCanvas!="undefined"&&r===2)return new OffscreenCanvas(300,150);if(typeof document!="undefined")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function nre(r,e){if(r!==1&&r!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const t=e==null?tre(r):e;return t.addEventListener("webglcontextlost",n=>{n.preventDefault(),delete gc[r]},!1),ut().getBool("SOFTWARE_WEBGL_ENABLED")&&(gg.failIfMajorPerformanceCaveat=!1),r===1?t.getContext("webgl",gg)||t.getContext("experimental-webgl",gg):t.getContext("webgl2",gg)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Rf;(function(r){r[r.DENSE=0]="DENSE",r[r.SHARED_BATCH=1]="SHARED_BATCH"})(Rf||(Rf={}));var hi;(function(r){r[r.RENDER=0]="RENDER",r[r.UPLOAD=1]="UPLOAD",r[r.PIXELS=2]="PIXELS",r[r.DOWNLOAD=3]="DOWNLOAD"})(hi||(hi={}));var Ds;(function(r){r[r.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",r[r.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",r[r.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",r[r.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",r[r.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(Ds||(Ds={}));function hm(r,e){return[e,r]}function rre(r,e){return r*e}function yg(r){const e=pt(r),t=Math.ceil(e/4);return pb(t)}function Ed(r,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(r/2))]}function sre(r,e){const[t,n]=Ed(r,e);return t*n*4}function SS(r,e){const t=r;let n,s,o,a,i,l,u,h,d,c;return ut().getNumber("WEBGL_VERSION")===2?(n=t.R32F,s=t.R16F,o=t.RGBA16F,a=t.RGBA32F,i=t.RED,u=4,h=1,d=t.HALF_FLOAT,c=t.FLOAT,l=t.RGBA8):(n=r.RGBA,s=r.RGBA,o=r.RGBA,a=t.RGBA,i=r.RGBA,u=4,h=4,d=e!=null?e.HALF_FLOAT_OES:null,c=r.FLOAT,l=r.RGBA),{internalFormatFloat:n,internalFormatHalfFloat:s,internalFormatPackedHalfFloat:o,internalFormatPackedFloat:a,textureFormatFloat:i,downloadTextureFormat:l,downloadUnpackNumChannels:u,defaultNumChannels:h,textureTypeHalfFloat:d,textureTypeFloat:c}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nn(r,e){const t=e();return ut().getBool("DEBUG")&&ore(r),t}function ore(r){const e=r.getError();if(e!==r.NO_ERROR)throw new Error("WebGL Error: "+ure(r,e))}const ire=596e-10,are=65504;function lre(r){return!!(ut().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||r===0||ire<Math.abs(r)&&Math.abs(r)<are)}function ure(r,e){switch(e){case r.NO_ERROR:return"NO_ERROR";case r.INVALID_ENUM:return"INVALID_ENUM";case r.INVALID_VALUE:return"INVALID_VALUE";case r.INVALID_OPERATION:return"INVALID_OPERATION";case r.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case r.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case r.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${e}`}}function vg(r,e){return Ol(r,()=>r.getExtension(e),'Extension "'+e+'" not supported on this browser.')}function cre(r,e){const t=Ol(r,()=>r.createShader(r.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(nn(r,()=>r.shaderSource(t,e)),nn(r,()=>r.compileShader(t)),r.getShaderParameter(t,r.COMPILE_STATUS)===!1)throw console.log(r.getShaderInfoLog(t)),new Error("Failed to compile vertex shader.");return t}function hre(r,e){const t=Ol(r,()=>r.createShader(r.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(nn(r,()=>r.shaderSource(t,e)),nn(r,()=>r.compileShader(t)),ut().get("ENGINE_COMPILE_ONLY"))return t;if(r.getShaderParameter(t,r.COMPILE_STATUS)===!1)throw HD(e,r.getShaderInfoLog(t)),new Error("Failed to compile fragment shader.");return t}const dre=/ERROR: [0-9]+:([0-9]+):/g;function HD(r,e){const t=dre.exec(e);if(t==null){console.log(`Couldn't parse line number in error: ${e}`),console.log(r);return}const n=+t[1],s=r.split(`
`),o=s.length.toString().length+2,a=s.map((d,c)=>jh((c+1).toString(),o)+d);let i=0;for(let d=0;d<a.length;d++)i=Math.max(a[d].length,i);const l=a.slice(0,n-1),u=a.slice(n-1,n),h=a.slice(n);console.log(l.join(`
`)),console.log(e.split(`
`)[0]),console.log(`%c ${jh(u[0],i)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(h.join(`
`))}function fre(r){return Ol(r,()=>r.createProgram(),"Unable to create WebGLProgram.")}function pre(r,e){if(nn(r,()=>r.linkProgram(e)),!ut().get("ENGINE_COMPILE_ONLY")&&r.getProgramParameter(e,r.LINK_STATUS)===!1)throw console.log(r.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}function Hv(r,e){if(nn(r,()=>r.validateProgram(e)),r.getProgramParameter(e,r.VALIDATE_STATUS)===!1)throw console.log(r.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function mre(r,e){const t=Ol(r,()=>r.createBuffer(),"Unable to create WebGLBuffer");return nn(r,()=>r.bindBuffer(r.ARRAY_BUFFER,t)),nn(r,()=>r.bufferData(r.ARRAY_BUFFER,e,r.STATIC_DRAW)),t}function gre(r,e){const t=Ol(r,()=>r.createBuffer(),"Unable to create WebGLBuffer");return nn(r,()=>r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,t)),nn(r,()=>r.bufferData(r.ELEMENT_ARRAY_BUFFER,e,r.STATIC_DRAW)),t}function yre(r){return Ol(r,()=>r.createTexture(),"Unable to create WebGLTexture.")}function vre(r,e){const t=ut().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(r<=0||e<=0){const n=`[${r}x${e}]`;throw new Error("Requested texture size "+n+" is invalid.")}if(r>t||e>t){const n=`[${r}x${e}]`,s=`[${t}x${t}]`;throw new Error("Requested texture size "+n+" greater than WebGL maximum on this browser / GPU "+s+".")}}function bre(r){return Ol(r,()=>r.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function PI(r,e,t,n,s,o,a){const i=r.getAttribLocation(e,t);return i===-1?!1:(nn(r,()=>r.bindBuffer(r.ARRAY_BUFFER,n)),nn(r,()=>r.vertexAttribPointer(i,s,r.FLOAT,!1,o,a)),nn(r,()=>r.enableVertexAttribArray(i)),!0)}function xre(r,e,t){kre(r,t),nn(r,()=>r.activeTexture(r.TEXTURE0+t)),nn(r,()=>r.bindTexture(r.TEXTURE_2D,e))}function wre(r,e,t){return Ol(r,()=>r.getUniformLocation(e,t),'uniform "'+t+'" not present in program.')}function Sre(r,e,t){return r.getUniformLocation(e,t)}function _re(r,e,t,n){nn(r,()=>xre(r,e,n)),nn(r,()=>r.uniform1i(t,n))}function qv(r,e,t){nn(r,()=>r.bindFramebuffer(r.FRAMEBUFFER,t)),nn(r,()=>r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,e,0))}function jI(r,e){nn(r,()=>r.bindFramebuffer(r.FRAMEBUFFER,e)),nn(r,()=>r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,null,0))}function bg(r){const e=r.checkFramebufferStatus(r.FRAMEBUFFER);if(e!==r.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+Tre(r,e))}function Tre(r,e){switch(e){case r.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case r.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case r.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case r.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${e}`}}function Ol(r,e,t){const n=nn(r,()=>e());if(n==null)throw new Error(t);return n}function kre(r,e){const t=r.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,n=e+r.TEXTURE0;if(n<r.TEXTURE0||n>t){const s=`[gl.TEXTURE0, gl.TEXTURE${t}]`;throw new Error(`textureUnit must be in ${s}.`)}}function id(r,e=2){return pt(r.slice(0,r.length-e))}function ad(r){if(r.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[r.length>1?r[r.length-2]:1,r[r.length-1]]}function Xv(r){let e=[1,1,1];return r.length===0||r.length===1&&r[0]===1||(e=[id(r),...ad(r)]),e}function Ire(r,e=!1){let t=ut().getNumber("WEBGL_MAX_TEXTURE_SIZE"),n=ut().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");n===1/0&&ut().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(n=t/2),e&&(t=t*2,n=n*2,r=r.map((i,l)=>l>=r.length-2?jx(r[l]):r[l]),r.length===1&&(r=[2,r[0]])),r.length!==2&&(r=Tu(r).newShape);let s=pt(r),o=null;r.length<=1&&s<=t?o=[1,s]:r.length===2&&r[0]<=t&&r[1]<=t?o=r:r.length===3&&r[0]*r[1]<=t&&r[2]<=t?o=[r[0]*r[1],r[2]]:r.length===3&&r[0]<=t&&r[1]*r[2]<=t?o=[r[0],r[1]*r[2]]:r.length===4&&r[0]*r[1]*r[2]<=t&&r[3]<=t?o=[r[0]*r[1]*r[2],r[3]]:r.length===4&&r[0]<=t&&r[1]*r[2]*r[3]<=t&&(o=[r[0],r[1]*r[2]*r[3]]);const a=o!=null&&Math.max(...o)>n&&Math.min(...o)<=(e?2:1)&&Math.min(...o)>0;if(o==null||a)if(e){const i=id(r);let l=2,u=2;r.length&&([l,u]=ad(r)),s=i*(l/2)*(u/2),o=pb(s).map(h=>h*2)}else o=pb(s);return o}function xg(r){return r%2===0}function xy(r,e){if(r=r.slice(-2),e=e.slice(-2),ur(r,e)||!r.length||!e.length||r[0]===0||r[1]===0||e[0]===0||e[1]===0)return!0;if(r.length!==e.length){const t=r.slice(-1)[0],n=e.slice(-1)[0];if(t===n||xg(t)&&xg(n)&&(r[0]===1||e[0]===1))return!0}return r[1]===e[1]&&xg(r[0])&&xg(e[0])}let Kv,Yv;function Ere(r){if(Kv==null){const e=ya(r);Kv=e.getParameter(e.MAX_TEXTURE_SIZE)}return Kv}function Cre(r){if(Yv==null){const e=ya(r);Yv=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,Yv)}function $re(r){if(r===0)return 0;let e;const t=ya(r);return Bi(t,"EXT_disjoint_timer_query_webgl2")&&r===2?e=2:Bi(t,"EXT_disjoint_timer_query")?e=1:e=0,e}function Bi(r,e){return r.getExtension(e)!=null}function BI(r){try{if(ya(r)!=null)return!0}catch(e){return console.log("Error when getting WebGL context: ",e),!1}return!1}function Nre(r){if(r===0)return!1;const e=ya(r);if(r===1){if(!Bi(e,"OES_texture_float"))return!1}else if(!Bi(e,"EXT_color_buffer_float"))return!1;return Qb(e)}function Are(r){if(r===0)return!1;const e=ya(r);if(r===1){if(!Bi(e,"OES_texture_float")||!Bi(e,"WEBGL_color_buffer_float"))return!1}else{if(Bi(e,"EXT_color_buffer_float"))return Qb(e);const n="EXT_color_buffer_half_float";if(Bi(e,n)){const s=e.getExtension(n);return Rre(e,s)}return!1}return Qb(e)}function Qb(r){const e=SS(r),t=r.createTexture();r.bindTexture(r.TEXTURE_2D,t);const n=1,s=1;r.texImage2D(r.TEXTURE_2D,0,e.internalFormatFloat,n,s,0,e.textureFormatFloat,e.textureTypeFloat,null);const o=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,o),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,t,0);const a=r.checkFramebufferStatus(r.FRAMEBUFFER)===r.FRAMEBUFFER_COMPLETE;return r.bindTexture(r.TEXTURE_2D,null),r.bindFramebuffer(r.FRAMEBUFFER,null),r.deleteTexture(t),r.deleteFramebuffer(o),a}function Rre(r,e){const t=SS(r,e),n=r.createTexture();r.bindTexture(r.TEXTURE_2D,n);const s=1,o=1;r.texImage2D(r.TEXTURE_2D,0,t.internalFormatHalfFloat,s,o,0,t.textureFormatFloat,t.textureTypeHalfFloat,null);const a=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,a),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,n,0);const i=r.checkFramebufferStatus(r.FRAMEBUFFER)===r.FRAMEBUFFER_COMPLETE;return r.bindTexture(r.TEXTURE_2D,null),r.bindFramebuffer(r.FRAMEBUFFER,null),r.deleteTexture(n),r.deleteFramebuffer(a),i}function Dre(r){return r!==2?!1:ya(r).fenceSync!=null}function dm(r,e){Array.isArray(r)||(r=[r]),r.forEach(t=>{t!=null&&xe(t.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the WebGL backend.`)})}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ln=ut();ln.registerFlag("HAS_WEBGL",()=>ln.getNumber("WEBGL_VERSION")>0);ln.registerFlag("WEBGL_VERSION",()=>BI(2)?2:BI(1)?1:0);ln.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1);ln.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>ln.get("WEBGL_VERSION")===2);ln.registerFlag("WEBGL_CPU_FORWARD",()=>!0);ln.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1);ln.registerFlag("WEBGL_PACK",()=>ln.getBool("HAS_WEBGL"));ln.registerFlag("WEBGL_PACK_NORMALIZATION",()=>ln.getBool("WEBGL_PACK"));ln.registerFlag("WEBGL_PACK_CLIP",()=>ln.getBool("WEBGL_PACK"));ln.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>ln.getBool("WEBGL_PACK"));ln.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>ln.getBool("WEBGL_PACK"));ln.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>ln.getBool("WEBGL_PACK"));ln.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>ln.getBool("WEBGL_PACK"));ln.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>ln.getBool("WEBGL_PACK"));ln.registerFlag("WEBGL_PACK_REDUCE",()=>ln.getBool("WEBGL_PACK"));ln.registerFlag("WEBGL_LAZILY_UNPACK",()=>ln.getBool("WEBGL_PACK"));ln.registerFlag("WEBGL_CONV_IM2COL",()=>ln.getBool("WEBGL_PACK"));ln.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>Ere(ln.getNumber("WEBGL_VERSION")));ln.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>Cre(ln.getNumber("WEBGL_VERSION")));ln.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const r=ln.getNumber("WEBGL_VERSION");return r===0?0:$re(r)});ln.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>ln.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!ZC());ln.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>Nre(ln.getNumber("WEBGL_VERSION")));ln.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>ln.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:ln.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"));ln.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>Are(ln.getNumber("WEBGL_VERSION")));ln.registerFlag("WEBGL_FENCE_API_ENABLED",()=>Dre(ln.getNumber("WEBGL_VERSION")));ln.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>ln.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);ln.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,r=>{if(r<0&&r!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${r}.`)});ln.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>ZC()?1:-1,r=>{if(r<0&&r!==-1)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${r}.`)});ln.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128);ln.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1);ln.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5);ln.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128);ln.registerFlag("WEBGL_EXP_CONV",()=>!1);ln.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>ln.getBool("IS_TEST"));ln.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0);ln.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1);ln.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lo(){let r,e,t,n,s,o,a,i,l,u;return ut().getNumber("WEBGL_VERSION")===2?(r="#version 300 es",e="in",t="out",n="in",s="texture",o="outputColor",a="out vec4 outputColor;",i=ut().getBool("WEBGL2_ISNAN_CUSTOM")?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:"",l="",u=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(r="",e="attribute",t="varying",n="varying",s="texture2D",o="gl_FragColor",a="",i=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,l=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,u=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:r,attribute:e,varyingVs:t,varyingFs:n,texture2D:s,output:o,defineOutput:a,defineSpecialNaN:i,defineSpecialInf:l,defineRound:u}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jc(r,e,t="index"){const n=pn(e);return n.map((s,o)=>{const a=`int ${r[o]} = ${t} / ${s}`,i=o===n.length-1?`int ${r[o+1]} = ${t} - ${r[o]} * ${s}`:`index -= ${r[o]} * ${s}`;return`${a}; ${i};`}).join("")}function f1(r,e,t="index"){const n=pn(e);return n.map((s,o)=>{const a=`int ${r[o]} = ${t} / outShapeStrides[${o}]`,i=o===n.length-1?`int ${r[o+1]} = ${t} - ${r[o]} * outShapeStrides[${o}]`:`index -= ${r[o]} * outShapeStrides[${o}]`;return`${a}; ${i};`}).join("")}function Ore(r,e){const t=r.length,n=r.map(o=>`${e}[${o}]`),s=new Array(t-1);s[t-2]=n[t-1];for(let o=t-3;o>=0;--o)s[o]=`(${s[o+1]} * ${n[o+1]})`;return s}function Mre(r,e,t="index"){const n=r.map((o,a)=>a),s=Ore(n,e);return s.map((o,a)=>{const i=`int ${r[a]} = ${t} / ${s[a]}`,l=a===s.length-1?`int ${r[a+1]} = ${t} - ${r[a]} * ${s[a]}`:`index -= ${r[a]} * ${s[a]}`;return`${i}; ${l};`}).join("")}function _S(r){const e=pn(r).map(t=>t.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${e[0]} + coords.y * ${e[1]} + coords.z;
  }
`}function TS(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}const qD=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{getBroadcastDims:XD}=B9;function Fre(r,e,t){const n=[];if(r.forEach(f=>{const p=pt(f.shapeInfo.logicalShape);if(f.shapeInfo.isUniform?n.push(`uniform float ${f.name}${p>1?`[${p}]`:""};`):(n.push(`uniform sampler2D ${f.name};`),n.push(`uniform int offset${f.name};`)),t.enableShapeUniforms){const{uniformShape:m}=kS(t.packedInputs,f.shapeInfo.logicalShape,f.shapeInfo.texShape);switch(m.length){case 1:n.push(`uniform int ${f.name}Shape;`);break;case 2:n.push(`uniform ivec2 ${f.name}Shape;`);break;case 3:n.push(`uniform ivec3 ${f.name}Shape;`);break;case 4:n.push(`uniform ivec4 ${f.name}Shape;`);break}n.push(`uniform ivec2 ${f.name}TexShape;`)}}),t.enableShapeUniforms){switch(e.logicalShape.length){case 1:n.push("uniform int outShape;");break;case 2:n.push("uniform ivec2 outShape;"),n.push("uniform int outShapeStrides;");break;case 3:n.push("uniform ivec3 outShape;"),n.push("uniform ivec2 outShapeStrides;");break;case 4:n.push("uniform ivec4 outShape;"),n.push("uniform ivec3 outShapeStrides;");break}n.push("uniform ivec2 outTexShape;")}t.customUniforms&&t.customUniforms.forEach(f=>{n.push(`uniform ${f.type} ${f.name}${f.arrayIndex?`[${f.arrayIndex}]`:""};`)});const s=n.join(`
`),o=r.map(f=>Lre(f,e,t.packedInputs,t.enableShapeUniforms)).join(`
`),a=e.texShape,i=lo(),l=Bre(i);let u,h,d=Vre(i);return e.isPacked?(u=Pre(e.logicalShape,a,t.enableShapeUniforms),h=zre(i)):(u=jre(e.logicalShape,a,t.enableShapeUniforms),h=Ure(i)),t.packedInputs&&(d+=qre),[d,l,h,s,u,o,t.userCode].join(`
`)}function Cd(r,e=!1){const t=r.shapeInfo.logicalShape;switch(t.length){case 0:return ose(r,e);case 1:return ase(r,e);case 2:return use(r,e);case 3:return hse(r,e);case 4:return fse(r,e);case 5:return pse(r);case 6:return mse(r);default:throw new Error(`${t.length}-D input sampling is not yet supported`)}}function KD(r,e){switch(r.shapeInfo.logicalShape.length){case 0:return sse(r);case 1:return ise(r,e);case 2:return lse(r,e);case 3:return cse(r,e);default:return dse(r,e)}}function Lre(r,e,t=!1,n){let s="";t?s+=KD(r,n):s+=Cd(r,n);const o=r.shapeInfo.logicalShape,a=e.logicalShape;return o.length<=a.length&&(t?s+=gse(r,e):s+=yse(r,e)),s}function Pre(r,e,t){switch(r.length){case 0:return YD();case 1:return Xre(r,e,t);case 2:return nse(r,e,t);case 3:return Yre(r,e,t);default:return Qre(r,e,t)}}function jre(r,e,t){switch(r.length){case 0:return YD();case 1:return Kre(r,e,t);case 2:return rse(r,e,t);case 3:return Zre(r,e,t);case 4:return Jre(r,e,t);case 5:return ese(r,e);case 6:return tse(r,e);default:throw new Error(`${r.length}-D output sampling is not yet supported`)}}function Bre(r){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${r.texture2D}(textureSampler, uv).r;
    }
  `}function Ure(r){return`
    void setOutput(float val) {
      ${r.output} = vec4(val, 0, 0, 0);
    }
  `}function zre(r){return`
    void setOutput(vec4 val) {
      ${r.output} = val;
    }
  `}function Vre(r){return`${r.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${r.varyingFs} vec2 resultUV;
    ${r.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${r.defineSpecialNaN}
    ${r.defineSpecialInf}
    ${r.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${Gre}
    ${Wre}
    ${Hre}
  `}const Gre=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,Wre=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,Hre=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,qre=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function YD(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function Xre(r,e,t){const n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return n[0]===1?t?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${n[1]}.0);
      }
    `:n[1]===1?t?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${n[0]}.0);
      }
    `:t?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${n[0]}, ${n[1]}));
      return 2 * (resTexRC.x * ${n[1]} + resTexRC.y);
    }
  `}function Kre(r,e,t){return e[0]===1?t?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * ${e[1]}.0);
      }
    `:e[1]===1?t?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * ${e[0]}.0);
      }
    `:t?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      return resTexRC.x * ${e[1]} + resTexRC.y;
    }
  `}function Yre(r,e,t){if(t)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;const n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],s=Math.ceil(r[2]/2),o=s*Math.ceil(r[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${n[0]}, ${n[1]}));
      int index = resTexRC.x * ${n[1]} + resTexRC.y;

      int b = index / ${o};
      index -= b * ${o};

      int r = 2 * (index / ${s});
      int c = imod(index, ${s}) * 2;

      return ivec3(b, r, c);
    }
  `}function Zre(r,e,t){if(t)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    ${f1(["r","c","d"],r)}
    return ivec3(r, c, d);
  }
`;const n=Jc(["r","c","d"],r);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${n}
      return ivec3(r, c, d);
    }
  `}function Qre(r,e,t){if(t)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;const n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],s=Math.ceil(r[r.length-1]/2),o=s*Math.ceil(r[r.length-2]/2);let a=o,i="",l="b, r, c";for(let u=2;u<r.length-1;u++)a*=r[r.length-u-1],i=`
      int b${u} = index / ${a};
      index -= b${u} * ${a};
    `+i,l=`b${u}, `+l;return`
    ivec${r.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${n[0]}, ${n[1]}));
      int index = resTexRC.x * ${n[1]} + resTexRC.y;

      ${i}

      int b = index / ${o};
      index -= b * ${o};

      int r = 2 * (index / ${s});
      int c = imod(index, ${s}) * 2;

      return ivec${r.length}(${l});
    }
  `}function Jre(r,e,t){if(t)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      ${f1(["r","c","d","d2"],r)}
      return ivec4(r, c, d, d2);
    }
  `;const n=Jc(["r","c","d","d2"],r);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${n}
      return ivec4(r, c, d, d2);
    }
  `}function ese(r,e){const t=Jc(["r","c","d","d2","d3"],r);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${e[0]},
                             ${e[1]}));

      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${t}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function tse(r,e){const t=Jc(["r","c","d","d2","d3","d4"],r);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${t}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function nse(r,e,t){const n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(ur(r,e))return t?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${n[0]}, ${n[1]}));
      }
    `;const s=Math.ceil(r[1]/2);return t?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${n[0]}, ${n[1]}));

      int index = resTexRC.x * ${n[1]} + resTexRC.y;
      int r = 2 * (index / ${s});
      int c = imod(index, ${s}) * 2;

      return ivec2(r, c);
    }
  `}function rse(r,e,t){return ur(r,e)?t?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${e[0]}, ${e[1]}));
      }
    `:r[1]===1?t?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:r[0]===1?t?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:t?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      int r = index / ${r[1]};
      int c = index - r * ${r[1]};
      return ivec2(r, c);
    }
  `}function eh(r){return`offset${r}`}function sse(r){const e=r.name,t="get"+e.charAt(0).toUpperCase()+e.slice(1),n=lo();return`
    vec4 ${t}() {
      return ${n.texture2D}(${e}, halfCR);
    }
  `}function ose(r,e){const t=r.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1);if(r.shapeInfo.isUniform)return`float ${n}() {return ${t};}`;const[s,o]=r.shapeInfo.texShape;if(s===1&&o===1)return`
      float ${n}() {
        return sampleTexture(${t}, halfCR);
      }
    `;const a=eh(t);if(e)return`
    float ${n}() {
      vec2 uv = uvFromFlat(${t}TexShape[0], ${t}TexShape[1], ${a});
      return sampleTexture(${t}, uv);
    }
  `;const[i,l]=r.shapeInfo.texShape;return`
    float ${n}() {
      vec2 uv = uvFromFlat(${i}, ${l}, ${a});
      return sampleTexture(${t}, uv);
    }
  `}function ise(r,e){const t=r.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),s=r.shapeInfo.texShape,o=lo();if(e)return`
    vec4 ${n}(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(${t}TexShape[0]) / 2.0), ceil(float(${t}TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return ${o.texture2D}(${t}, uv);
    }
  `;const a=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)];return`
    vec4 ${n}(int index) {
      vec2 uv = packedUVfrom1D(
        ${a[0]}, ${a[1]}, index);
      return ${o.texture2D}(${t}, uv);
    }
  `}function ase(r,e){const t=r.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1);if(r.shapeInfo.isUniform)return`
      float ${n}(int index) {
        ${$d(r)}
      }
    `;const s=r.shapeInfo.texShape,o=s[0],a=s[1];if(a===1&&o===1)return`
      float ${n}(int index) {
        return sampleTexture(${t}, halfCR);
      }
    `;const i=eh(t);return a===1?e?`
      float ${n}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${i}) + 0.5) / float(${t}TexShape[0]));
        return sampleTexture(${t}, uv);
      }
    `:`
      float ${n}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${i}) + 0.5) / ${o}.0);
        return sampleTexture(${t}, uv);
      }
    `:o===1?e?`
      float ${n}(int index) {
        vec2 uv = vec2((float(index + ${i}) + 0.5) / float(${t}TexShape[1]), 0.5);
        return sampleTexture(${t}, uv);
      }
    `:`
      float ${n}(int index) {
        vec2 uv = vec2((float(index + ${i}) + 0.5) / ${a}.0, 0.5);
        return sampleTexture(${t}, uv);
      }
    `:e?`
    float ${n}(int index) {
      vec2 uv = uvFromFlat(${t}TexShape[0], ${t}TexShape[1], index + ${i});
      return sampleTexture(${t}, uv);
    }
  `:`
    float ${n}(int index) {
      vec2 uv = uvFromFlat(${o}, ${a}, index + ${i});
      return sampleTexture(${t}, uv);
    }
  `}function lse(r,e){const t=r.shapeInfo.logicalShape,n=r.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),o=r.shapeInfo.texShape,a=o[0],i=o[1],l=lo();if(o!=null&&ur(t,o))return e?`
      vec4 ${s}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${n}TexShape[1], ${n}TexShape[0]);

        return ${l.texture2D}(${n}, uv);
      }
    `:`
      vec4 ${s}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${i}.0, ${a}.0);

        return ${l.texture2D}(${n}, uv);
      }
    `;if(e)return`
    vec4 ${s}(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${n}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return ${l.texture2D}(${n}, uv);
    }
  `;const u=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)],h=Math.ceil(t[1]/2);return`
    vec4 ${s}(int row, int col) {
      vec2 uv = packedUVfrom2D(${h}, ${u[0]}, ${u[1]}, row, col);
      return ${l.texture2D}(${n}, uv);
    }
  `}function use(r,e){const t=r.shapeInfo.logicalShape,n=r.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),o=r.shapeInfo.texShape;if(o!=null&&ur(t,o)){if(e)return`
      float ${s}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${n}TexShape[1], ${n}TexShape[0]);
        return sampleTexture(${n}, uv);
      }
    `;const c=o[0],f=o[1];return`
    float ${s}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${f}.0, ${c}.0);
      return sampleTexture(${n}, uv);
    }
  `}const{newShape:a,keptDims:i}=Tu(t),l=a;if(l.length<t.length){const c=Nd(r,l),f=["row","col"];return`
      ${Cd(c,e)}
      float ${s}(int row, int col) {
        return ${s}(${Ad(f,i)});
      }
    `}if(r.shapeInfo.isUniform)return`
      float ${s}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${t[1]}, 1)));
        ${$d(r)}
      }
    `;const u=o[0],h=o[1],d=eh(n);return h===1?e?`
      float ${s}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${n}Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(${n}TexShape[0]));
        return sampleTexture(${n}, uv);
      }
    `:`
    float ${s}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${t[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${u}.0);
      return sampleTexture(${n}, uv);
    }
  `:u===1?e?`
      float ${s}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${n}Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(${n}TexShape[1]), 0.5);
        return sampleTexture(${n}, uv);
      }
    `:`
    float ${s}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${t[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${h}.0, 0.5);
      return sampleTexture(${n}, uv);
    }
  `:e?`
      float ${s}(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${n}Shape[1] + col + ${d};
        vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], index);
        return sampleTexture(${n}, uv);
      }
    `:`
  float ${s}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${t[1]} + col + ${d};
    vec2 uv = uvFromFlat(${u}, ${h}, index);
    return sampleTexture(${n}, uv);
  }
`}function cse(r,e){const t=r.shapeInfo.logicalShape,n=r.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),o=r.shapeInfo.texShape,a=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)];if(t[0]===1){const c=t.slice(1),f=[1,2],p=Nd(r,c),m=["b","row","col"];return`
        ${KD(p,e)}
        vec4 ${s}(int b, int row, int col) {
          return ${s}(${Ad(m,f)});
        }
      `}const i=lo();if(e)return`
    vec4 ${s}(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${n}Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${n}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return ${i.texture2D}(${n}, uv);
    }
  `;const l=a[0],u=a[1],h=Math.ceil(t[2]/2),d=h*Math.ceil(t[1]/2);return`
    vec4 ${s}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${l}, ${u}, ${d}, ${h}, b, row, col);
      return ${i.texture2D}(${n}, uv);
    }
  `}function hse(r,e){const t=r.shapeInfo.logicalShape,n=r.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),o=t[1]*t[2],a=t[2],{newShape:i,keptDims:l}=Tu(t),u=i;if(u.length<t.length){const m=Nd(r,u),g=["row","col","depth"];return`
        ${Cd(m,e)}
        float ${s}(int row, int col, int depth) {
          return ${s}(${Ad(g,l)});
        }
      `}if(r.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${o}, ${a}, 1)));
        ${$d(r)}
      }
    `;const h=r.shapeInfo.texShape,d=h[0],c=h[1],f=r.shapeInfo.flatOffset;if(c===o&&f==null)return e?`
      float ${s}(int row, int col, int depth) {
        int stride1 = ${n}Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${n}TexShape[1], ${n}TexShape[0]);
        return sampleTexture(${n}, uv);
      }
    `:`
        float ${s}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${a}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${c}.0, ${d}.0);
          return sampleTexture(${n}, uv);
        }
      `;if(c===a&&f==null)return e?`
      float ${s}(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(${n}Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${n}TexShape[1], ${n}TexShape[0]);
        return sampleTexture(${n}, uv);
      }
    `:`
    float ${s}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${t[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${c}.0, ${d}.0);
      return sampleTexture(${n}, uv);
    }
  `;const p=eh(n);return e?`
    float ${s}(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = ${n}Shape[1] * ${n}Shape[2];
      int stride1 = ${n}Shape[2];
      int index = row * stride0 + col * stride1 + depth + ${p};
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], index);
      return sampleTexture(${n}, uv);
    }
    `:`
      float ${s}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${o} + col * ${a} + depth + ${p};
        vec2 uv = uvFromFlat(${d}, ${c}, index);
        return sampleTexture(${n}, uv);
      }
  `}function dse(r,e){const t=r.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),s=lo();if(e)return`
    vec4 ${n}(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(${t}Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${t}Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= ${t}Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(${t}TexShape[0]) / 2.0), ceil(float(${t}TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${s.texture2D}(${t}, uv);
    }
  `;const o=r.shapeInfo.logicalShape,a=o.length,i=r.shapeInfo.texShape,l=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)],u=l[0],h=l[1],d=Math.ceil(o[a-1]/2);let c=d*Math.ceil(o[a-2]/2),f="int b, int row, int col",p=`b * ${c} + (row / 2) * ${d} + (col / 2)`;for(let m=2;m<a-1;m++)f=`int b${m}, `+f,c*=o[a-m-1],p=`b${m} * ${c} + `+p;return`
    vec4 ${n}(${f}) {
      int index = ${p};
      int texR = index / ${h};
      int texC = index - texR * ${h};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${h}, ${u});
      return ${s.texture2D}(${t}, uv);
    }
  `}function fse(r,e){const t=r.shapeInfo.logicalShape,n=r.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),o=t[3],a=t[2]*o,i=t[1]*a,{newShape:l,keptDims:u}=Tu(t);if(l.length<t.length){const v=Nd(r,l),b=["row","col","depth","depth2"];return`
      ${Cd(v,e)}
      float ${s}(int row, int col, int depth, int depth2) {
        return ${s}(${Ad(b,u)});
      }
    `}if(r.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${i}, ${a}, ${o}, 1)));
        ${$d(r)}
      }
    `;const h=r.shapeInfo.flatOffset,d=r.shapeInfo.texShape,c=d[0],f=d[1],p=`int stride2 = ${n}Shape[3];`,m=`int stride1 = ${n}Shape[2] * stride2;`,g=`int stride0 = ${n}Shape[1] * stride1;`;if(f===i&&h==null)return e?`
      float ${s}(int row, int col, int depth, int depth2) {
        ${p}
        ${m}
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${n}TexShape[1], ${n}TexShape[0]);
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${s}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${a}, ${o}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${f}.0, ${c}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(f===o&&h==null)return e?`
      float ${s}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${n}Shape[1] * ${n}Shape[2], ${n}Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${n}TexShape[1], ${n}TexShape[0]);
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${s}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${t[1]*t[2]}, ${t[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${f}.0, ${c}.0);
        return sampleTexture(${n}, uv);
      }
    `;const y=eh(n);return e?`
    float ${s}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      ${p}
      ${m}
      ${g}
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], index + ${y});
      return sampleTexture(${n}, uv);
    }
  `:`
    float ${s}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${i} + col * ${a} +
          depth * ${o} + depth2;
      vec2 uv = uvFromFlat(${c}, ${f}, index + ${y});
      return sampleTexture(${n}, uv);
    }
  `}function pse(r){const e=r.shapeInfo.logicalShape,t=r.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),s=e[4],o=e[3]*s,a=e[2]*o,i=e[1]*a,{newShape:l,keptDims:u}=Tu(e);if(l.length<e.length){const m=Nd(r,l),g=["row","col","depth","depth2","depth3"];return`
      ${Cd(m)}
      float ${n}(int row, int col, int depth, int depth2, int depth3) {
        return ${n}(${Ad(g,u)});
      }
    `}if(r.shapeInfo.isUniform)return`
      float ${n}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${i}, ${a}, ${o}, ${s})) +
          depth3;
        ${$d(r)}
      }
    `;const h=r.shapeInfo.flatOffset,d=r.shapeInfo.texShape,c=d[0],f=d[1];if(f===i&&h==null)return`
      float ${n}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${a}, ${o}, ${s}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${f}.0, ${c}.0);
        return sampleTexture(${t}, uv);
      }
    `;if(f===s&&h==null)return`
      float ${n}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]},
               ${e[2]*e[3]}, ${e[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${f}.0, ${c}.0);
        return sampleTexture(${t}, uv);
      }
    `;const p=eh(t);return`
    float ${n}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${i} + col * ${a} + depth * ${o} +
          depth2 * ${s} + depth3 + ${p};
      vec2 uv = uvFromFlat(${c}, ${f}, index);
      return sampleTexture(${t}, uv);
    }
  `}function mse(r){const e=r.shapeInfo.logicalShape,t=r.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),{newShape:s,keptDims:o}=Tu(e);if(s.length<e.length){const g=Nd(r,s),y=["row","col","depth","depth2","depth3","depth4"];return`
      ${Cd(g)}
      float ${n}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${n}(${Ad(y,o)});
      }
    `}const a=e[5],i=e[4]*a,l=e[3]*i,u=e[2]*l,h=e[1]*u;if(r.shapeInfo.isUniform)return`
      float ${n}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${h}, ${u}, ${l}, ${i})) +
          dot(
            vec2(depth3, depth4),
            vec2(${a}, 1)));
        ${$d(r)}
      }
    `;const d=r.shapeInfo.flatOffset,c=r.shapeInfo.texShape,f=c[0],p=c[1];if(p===h&&d==null)return`
      float ${n}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${u}, ${l}, ${i}, ${a})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${p}.0, ${f}.0);
        return sampleTexture(${t}, uv);
      }
    `;if(p===a&&d==null)return`
      float ${n}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]*e[4]},
               ${e[2]*e[3]*e[4]},
               ${e[3]*e[4]},
               ${e[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${p}.0, ${f}.0);
        return sampleTexture(${t}, uv);
      }
    `;const m=eh(t);return`
    float ${n}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${h} + col * ${u} + depth * ${l} +
          depth2 * ${i} + depth3 * ${a} + depth4 + ${m};
      vec2 uv = uvFromFlat(${f}, ${p}, index);
      return sampleTexture(${t}, uv);
    }
  `}function $d(r){const e=r.name,t=pt(r.shapeInfo.logicalShape);return t<2?`return ${e};`:`
    for (int i = 0; i < ${t}; i++) {
      if (i == index) {
        return ${e}[i];
      }
    }
  `}function gse(r,e){const t=r.name,n=t.charAt(0).toUpperCase()+t.slice(1),s="get"+n+"AtOutCoords",o=r.shapeInfo.logicalShape.length,a=e.logicalShape.length,i=XD(r.shapeInfo.logicalShape,e.logicalShape),l=Dr(a),u=a-o;let h;const d=["x","y","z","w","u","v"];o===0?h="":a<2&&i.length>=1?h="coords = 0;":h=i.map(v=>`coords.${d[v+u]} = 0;`).join(`
`);let c="";a<2&&o>0?c="coords":c=r.shapeInfo.logicalShape.map((v,b)=>`coords.${d[b+u]}`).join(", ");let f="return outputValue;";const m=pt(r.shapeInfo.logicalShape)===1,y=pt(e.logicalShape)===1;if(o===1&&!m&&!y)f=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(m&&!y)a===1?f=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:f=`
        return vec4(outputValue.x);
      `;else if(i.length){const v=o-2,b=o-1;i.indexOf(v)>-1&&i.indexOf(b)>-1?f="return vec4(outputValue.x);":i.indexOf(v)>-1?f="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":i.indexOf(b)>-1&&(f="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${s}() {
      ${l} coords = getOutputCoords();
      ${h}
      vec4 outputValue = get${n}(${c});
      ${f}
    }
  `}function yse(r,e){const t=r.name,n=t.charAt(0).toUpperCase()+t.slice(1),s="get"+n+"AtOutCoords",o=e.texShape,a=r.shapeInfo.texShape,i=r.shapeInfo.logicalShape.length,l=e.logicalShape.length;if(!r.shapeInfo.isUniform&&i===l&&r.shapeInfo.flatOffset==null&&ur(a,o))return`
      float ${s}() {
        return sampleTexture(${t}, resultUV);
      }
    `;const u=Dr(l),h=XD(r.shapeInfo.logicalShape,e.logicalShape),d=l-i;let c;const f=["x","y","z","w","u","v"];i===0?c="":l<2&&h.length>=1?c="coords = 0;":c=h.map(m=>`coords.${f[m+d]} = 0;`).join(`
`);let p="";return l<2&&i>0?p="coords":p=r.shapeInfo.logicalShape.map((m,g)=>`coords.${f[g+d]}`).join(", "),`
    float ${s}() {
      ${u} coords = getOutputCoords();
      ${c}
      return get${n}(${p});
    }
  `}function Dr(r){if(r<=1)return"int";if(r===2)return"ivec2";if(r===3)return"ivec3";if(r===4)return"ivec4";if(r===5)return"ivec5";if(r===6)return"ivec6";throw Error(`GPU for rank ${r} is not yet supported`)}function kS(r,e,t){const{newShape:n,keptDims:s}=Tu(e),o=e.length,a=r&&o===3&&e[0]===1,i=a?e.slice(1):n,l=!r&&o>1&&!ur(e,t)&&n.length<o||a;return{useSqueezeShape:l,uniformShape:l?i:e,keptDims:s}}function Nd(r,e){const t=JSON.parse(JSON.stringify(r));return t.shapeInfo.logicalShape=e,t}function Ad(r,e){return e.map(t=>r[t]).join(", ")}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vse(r,e,t,n){const s=t.map((h,d)=>{const c={logicalShape:h.shape,texShape:h.isUniform?null:h.texData.texShape,isUniform:h.isUniform,isPacked:h.isUniform?!1:h.texData.isPacked,flatOffset:null};return h.texData!=null&&h.texData.slice!=null&&h.texData.slice.flatOffset>0&&(c.flatOffset=h.texData.slice.flatOffset),{name:e.variableNames[d],shapeInfo:c}}),o=s.map(h=>h.shapeInfo),a={logicalShape:n.shape,texShape:n.texData.texShape,isUniform:!1,isPacked:n.texData.isPacked,flatOffset:null},i=Fre(s,a,e),l=hre(r.gl,i),u=r.createProgram(l);return ut().get("ENGINE_COMPILE_ONLY")?{program:e,fragmentShader:l,source:i,webGLProgram:u,inShapeInfos:o,outShapeInfo:a,uniformLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,inShapesLocations:null,inTexShapesLocations:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:Object.assign({program:e,fragmentShader:l,source:i,webGLProgram:u,inShapeInfos:o,outShapeInfo:a},ZD(r,e,u))}function ZD(r,e,t){const n={},s={},o={},a=[];let i,l,u,h=null,d=null;d=r.getUniformLocation(t,"NAN",!1),ut().getNumber("WEBGL_VERSION")===1&&(h=r.getUniformLocation(t,"INFINITY",!1));const c=!1;for(let f=0;f<e.variableNames.length;f++){const p=e.variableNames[f];n[p]=r.getUniformLocation(t,p,c),n[`offset${p}`]=r.getUniformLocation(t,`offset${p}`,c),e.enableShapeUniforms&&(s[`${p}Shape`]=r.getUniformLocation(t,`${p}Shape`,c),o[`${p}TexShape`]=r.getUniformLocation(t,`${p}TexShape`,c))}return e.enableShapeUniforms&&(i=r.getUniformLocation(t,"outShape",c),u=r.getUniformLocation(t,"outShapeStrides",c),l=r.getUniformLocation(t,"outTexShape",c)),e.customUniforms&&e.customUniforms.forEach((f,p)=>{a[p]=r.getUniformLocation(t,f.name,c)}),{uniformLocations:n,customUniformLocations:a,infLoc:h,nanLoc:d,inShapesLocations:s,inTexShapesLocations:o,outShapeLocation:i,outShapeStridesLocation:u,outTexShapeLocation:l}}function UI(r,e){if(r.length!==e.length)throw Error(`Binary was compiled with ${r.length} inputs, but was executed with ${e.length} inputs`);r.forEach((t,n)=>{const s=t.logicalShape,o=e[n],a=o.shape;if(!ur(s,a))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${s} and ${a} must match`);if(t.isUniform&&o.isUniform)return;const i=t.texShape,l=o.isUniform?null:o.texData.texShape;if(!ur(i,l))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${i} and ${l} must match`)})}function bse(r,e,t,n,s){e.program.enableShapeUniforms||(UI(e.inShapeInfos,t),UI([e.outShapeInfo],[n]));const o=n.texData.texture,a=n.texData.texShape;n.texData.isPacked?r.setOutputPackedMatrixTexture(o.texture,a[0],a[1]):r.setOutputMatrixTexture(o.texture,a[0],a[1]),r.setProgram(e.webGLProgram),ut().getNumber("WEBGL_VERSION")===1&&e.infLoc!==null&&r.gl.uniform1f(e.infLoc,1/0),e.nanLoc!==null&&r.gl.uniform1f(e.nanLoc,NaN),t.forEach((l,u)=>{const h=e.program.variableNames[u],d=e.uniformLocations[h],c=e.uniformLocations[`offset${h}`],f=e.inShapesLocations[`${h}Shape`],p=e.inTexShapesLocations[`${h}TexShape`];if(f){const{uniformShape:m}=kS(e.program.packedInputs,l.shape,l.texData.texShape);switch(m.length){case 1:r.gl.uniform1iv(f,new Int32Array(m));break;case 2:r.gl.uniform2iv(f,new Int32Array(m));break;case 3:r.gl.uniform3iv(f,new Int32Array(m));break;case 4:r.gl.uniform4iv(f,new Int32Array(m));break}}if(p&&r.gl.uniform2i(p,l.texData.texShape[0],l.texData.texShape[1]),d!=null){if(l.isUniform){if(pt(l.shape)<2)r.gl.uniform1f(d,l.uniformValues[0]);else{let m=l.uniformValues;m instanceof Float32Array||(m=new Float32Array(m)),r.gl.uniform1fv(d,m)}return}l.texData.slice!=null&&c!=null&&r.gl.uniform1i(c,l.texData.slice.flatOffset),r.setInputMatrixTexture(l.texData.texture.texture,d,u)}});const i=e.outShapeLocation;if(i)switch(n.shape.length){case 1:r.gl.uniform1iv(i,new Int32Array(n.shape));break;case 2:r.gl.uniform2iv(i,new Int32Array(n.shape));break;case 3:r.gl.uniform3iv(i,new Int32Array(n.shape));break;case 4:r.gl.uniform4iv(i,new Int32Array(n.shape));break}if(e.outShapeStridesLocation){const l=pn(n.shape);switch(n.shape.length){case 2:r.gl.uniform1iv(e.outShapeStridesLocation,new Int32Array(l));break;case 3:r.gl.uniform2iv(e.outShapeStridesLocation,new Int32Array(l));break;case 4:r.gl.uniform3iv(e.outShapeStridesLocation,new Int32Array(l));break}}e.outTexShapeLocation&&r.gl.uniform2i(e.outTexShapeLocation,n.texData.texShape[0],n.texData.texShape[1]),e.program.customUniforms&&s&&e.program.customUniforms.forEach((l,u)=>{const h=e.customUniformLocations[u],d=s[u];if(l.type==="float")r.gl.uniform1fv(h,d);else if(l.type==="vec2")r.gl.uniform2fv(h,d);else if(l.type==="vec3")r.gl.uniform3fv(h,d);else if(l.type==="vec4")r.gl.uniform4fv(h,d);else if(l.type==="int")r.gl.uniform1iv(h,d);else if(l.type==="ivec2")r.gl.uniform2iv(h,d);else if(l.type==="ivec3")r.gl.uniform3iv(h,d);else if(l.type==="ivec4")r.gl.uniform4iv(h,d);else throw Error(`uniform type ${l.type} is not supported yet.`)}),r.executeProgram()}function xse(r,e,t){let n="";e.concat(t).forEach(a=>{const i=a.texData!=null&&a.texData.slice!=null&&a.texData.slice.flatOffset>0;if(r.enableShapeUniforms&&!a.isUniform){const l=a.texData.texShape,{useSqueezeShape:u,uniformShape:h,keptDims:d}=kS(r.packedInputs,a.shape,l);let c="",f="",p="";if(h.length===1&&r.packedInputs){const _=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)];c=`${_[0]>1}_${_[1]>1}`}else if(h.length===2&&!r.packedInputs)f=`${h[0]>1}_${h[1]>1}`;else if(h.length>2&&!r.packedInputs){const _=pn(h);p=`${_[0]===l[1]}_${_[_.length-1]===l[1]}`}const m=a.shape.length,g=h.length===2&&ur(a.shape,l),y=pt(a.shape)===1,v=Jh(a.shape,t.shape),b=!r.packedInputs&&m===t.shape.length&&ur(l,t.texData.texShape),w=r.packedInputs||h.length>2?"":`${l[0]>1}_${l[1]>1}`;n+=`${m}_${b}_${u?d:""}_${h.length}_${y}_${v}_${g}_${c}_${f}_${p}_${w}_${i}`}else{const l=a.isUniform?"uniform":a.texData.texShape;n+=`${a.shape}_${l}_${i}`}});const s=r.userCode;let o=r.constructor.name;return o+="_"+n+"_"+s+`${ut().getNumber("WEBGL_VERSION")}`,o}function uo(r){return ut().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&r<=4}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wse{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Rf.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const t=lo();this.outputShape=e,this.enableShapeUniforms=uo(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?f1(["r","c","d"],e):Jc(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${t.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Sse{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Rf.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const t=lo();this.outputShape=e,this.enableShapeUniforms=uo(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?f1(["r","c","d"],e):Jc(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${t.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _se{constructor(e){this.variableNames=["A"],this.outTexUsage=hi.DOWNLOAD;const t=lo();this.outputShape=e,this.userCode=`
      ${qD}

      void main() {
        float x = getAAtOutCoords();
        ${t.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Tse{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=hi.DOWNLOAD;const t=lo();this.outputShape=e,this.userCode=`
      ${qD}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${t.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kse{constructor(e,t=!1){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=lo();this.outputShape=e,this.enableShapeUniforms=uo(this.outputShape.length);let s="result";t&&(s="floor(result * 255. + 0.5)"),this.userCode=`
      ${this.enableShapeUniforms?TS():_S(e)}

      void main() {
        ivec3 coords = getOutputCoords();

        int flatIndex = getFlatIndex(coords);
        int offset = imod(flatIndex, 4);

        flatIndex = idiv(flatIndex, 4, 1.);

        int r = flatIndex / texShape[1];
        int c = imod(flatIndex, texShape[1]);
        vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
        vec4 values = ${n.texture2D}(A, uv);

        float result;

        if(offset == 0) {
          result = values[0];
        } else if(offset == 1) {
          result = values[1];
        } else if(offset == 2) {
          result = values[2];
        } else {
          result = values[3];
        }

        ${n.output} = vec4(${s}, 0., 0., 0.);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ise{constructor(e,t=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=lo();this.outputShape=e,this.enableShapeUniforms=uo(this.outputShape.length);let s="",o="result";t&&(o="floor(result * 255. + 0.5)");for(let a=0;a<=1;a++)for(let i=0;i<=1;i++){const l=a*2+i;s+=`
          localCoords = coords;
          if(localCoords[2] + ${i} < ${this.enableShapeUniforms?"outShape[2]":`${e[2]}`}) {
          localCoords[2] += ${i};
          if (localCoords[1] + ${a} < ${this.enableShapeUniforms?"outShape[1]":`${e[1]}`}) {
            localCoords[1] += ${a};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${n.texture2D}(A, uv);

            if (offset == 0) {
              result[${l}] = values[0];
            } else if (offset == 1) {
              result[${l}] = values[1];
            } else if (offset == 2) {
              result[${l}] = values[2];
            } else {
              result[${l}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?TS():_S(e)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${s}

          ${n.output} = ${o};
        }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ese(r){const e=lo(),t=`${e.version}
    precision highp float;
    ${e.attribute} vec3 clipSpacePos;
    ${e.attribute} vec2 uv;
    ${e.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return cre(r,t)}function Cse(r){const e=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return mre(r,e)}function $se(r){const e=new Uint16Array([0,1,2,2,1,3]);return gre(r,e)}function fm(r,e,t,n,s,o){vre(e,t);const a=yre(r),i=r.TEXTURE_2D;return nn(r,()=>r.bindTexture(i,a)),nn(r,()=>r.texParameteri(i,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE)),nn(r,()=>r.texParameteri(i,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE)),nn(r,()=>r.texParameteri(i,r.TEXTURE_MIN_FILTER,r.NEAREST)),nn(r,()=>r.texParameteri(i,r.TEXTURE_MAG_FILTER,r.NEAREST)),ut().getNumber("WEBGL_VERSION")===1?nn(r,()=>r.texImage2D(i,0,n,e,t,0,s,o,null)):nn(r,()=>r.texStorage2D(i,1,n,e,t)),nn(r,()=>r.bindTexture(r.TEXTURE_2D,null)),{texture:a,texShape:[t,e]}}function QD(r){return r.internalFormatFloat}function Nse(r,e,t,n){const[s,o]=hm(e,t);return fm(r,s,o,QD(n),n.textureFormatFloat,r.FLOAT)}function JD(r){return r.internalFormatHalfFloat}function Ase(r,e,t,n){const[s,o]=hm(e,t);return fm(r,s,o,JD(n),n.textureFormatFloat,n.textureTypeHalfFloat)}function eO(r){return r.downloadTextureFormat}function Rse(r,e,t,n){const[s,o]=hm(e,t);return fm(r,s,o,eO(n),r.RGBA,r.UNSIGNED_BYTE)}function tO(r){return r.internalFormatPackedFloat}function Dse(r,e,t,n){const[s,o]=Ed(e,t);return fm(r,s,o,tO(n),r.RGBA,r.FLOAT)}function nO(r){return r.internalFormatPackedHalfFloat}function Ose(r,e,t,n){const[s,o]=Ed(e,t);return fm(r,s,o,nO(n),r.RGBA,n.textureTypeHalfFloat)}function Mse(r,e,t){return nn(r,()=>r.bindBuffer(r.ARRAY_BUFFER,t)),PI(r,e,"clipSpacePos",t,3,20,0)&&PI(r,e,"uv",t,2,20,12)}function Fse(r,e,t,n,s,o){nn(r,()=>r.bindTexture(r.TEXTURE_2D,e));let a,i,l;s instanceof Uint8Array?(a=new Uint8Array(t*n*4),i=r.UNSIGNED_BYTE,l=r.RGBA):(a=new Float32Array(t*n*4),i=r.FLOAT,l=o.internalFormatPackedFloat),a.set(s),ut().getNumber("WEBGL_VERSION")===2?nn(r,()=>r.texSubImage2D(r.TEXTURE_2D,0,0,0,t,n,r.RGBA,i,a)):nn(r,()=>r.texImage2D(r.TEXTURE_2D,0,l,t,n,0,r.RGBA,i,a)),nn(r,()=>r.bindTexture(r.TEXTURE_2D,null))}function Lse(r,e,t){nn(r,()=>r.bindTexture(r.TEXTURE_2D,e)),t.data instanceof Uint8Array?ut().getNumber("WEBGL_VERSION")===2?nn(r,()=>r.texSubImage2D(r.TEXTURE_2D,0,0,0,t.width,t.height,r.RGBA,r.UNSIGNED_BYTE,t.data)):nn(r,()=>r.texImage2D(r.TEXTURE_2D,0,r.RGBA,t.width,t.height,0,r.RGBA,r.UNSIGNED_BYTE,t.data)):ut().getNumber("WEBGL_VERSION")===2?nn(r,()=>r.texSubImage2D(r.TEXTURE_2D,0,0,0,r.RGBA,r.UNSIGNED_BYTE,t)):nn(r,()=>r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,t)),nn(r,()=>r.bindTexture(r.TEXTURE_2D,null))}function Pse(r,e,t,n){const s=r.createBuffer();nn(r,()=>r.bindBuffer(r.PIXEL_PACK_BUFFER,s));const i=4*4*e*t;return nn(r,()=>r.bufferData(r.PIXEL_PACK_BUFFER,i,r.STREAM_READ)),nn(r,()=>r.readPixels(0,0,t,e,r.RGBA,r.FLOAT,0)),nn(r,()=>r.bindBuffer(r.PIXEL_PACK_BUFFER,null)),s}function jse(r,e,t){const n=r,s=new Float32Array(t);return n.bindBuffer(n.PIXEL_PACK_BUFFER,e),n.getBufferSubData(n.PIXEL_PACK_BUFFER,0,s),n.bindBuffer(n.PIXEL_PACK_BUFFER,null),s}function Bse(r,e,t,n){const[s,o]=hm(e,t),a=4,i=new Uint8Array(rre(e*t,a));return nn(r,()=>r.readPixels(0,0,s,o,n.downloadTextureFormat,r.UNSIGNED_BYTE,i)),new Float32Array(i.buffer)}function Use(r,e,t,n,s,o,a,i){const l=r,u=new Float32Array(sre(o,a));return l.bindBuffer(l.PIXEL_PACK_BUFFER,e),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,u),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),u}function zse(r,e,t){const n=new Float32Array(e*t*4);return nn(r,()=>r.readPixels(0,0,t,e,r.RGBA,r.FLOAT,n)),n}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Zv{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];const t=ut().getNumber("WEBGL_VERSION");e!=null?(this.gl=e,ere(t,e)):this.gl=ya(t);let n="WEBGL_color_buffer_float";const s="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),ut().getNumber("WEBGL_VERSION")===1){const o="OES_texture_float",a="OES_texture_half_float";if(this.textureFloatExtension=vg(this.gl,o),Bi(this.gl,a))this.textureHalfFloatExtension=vg(this.gl,a);else if(ut().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(n),Bi(this.gl,s))this.colorBufferHalfFloatExtension=vg(this.gl,s);else if(ut().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(n="EXT_color_buffer_float",Bi(this.gl,n))this.colorBufferFloatExtension=this.gl.getExtension(n);else if(Bi(this.gl,s))this.colorBufferHalfFloatExtension=this.gl.getExtension(s);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=Cse(this.gl),this.indexBuffer=$se(this.gl),this.framebuffer=bre(this.gl),this.textureConfig=SS(this.gl,this.textureHalfFloatExtension)}get debug(){return ut().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const e=this.gl;nn(e,()=>e.finish()),nn(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),nn(e,()=>e.deleteFramebuffer(this.framebuffer)),nn(e,()=>e.bindBuffer(e.ARRAY_BUFFER,null)),nn(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)),nn(e,()=>e.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(e,t){return this.throwIfDisposed(),Nse(this.gl,e,t,this.textureConfig)}createFloat16MatrixTexture(e,t){return this.throwIfDisposed(),Ase(this.gl,e,t,this.textureConfig)}createUnsignedBytesMatrixTexture(e,t){return this.throwIfDisposed(),Rse(this.gl,e,t,this.textureConfig)}uploadPixelDataToTexture(e,t){this.throwIfDisposed(),Lse(this.gl,e,t)}uploadDenseMatrixToTexture(e,t,n,s){this.throwIfDisposed(),Fse(this.gl,e,t,n,s,this.textureConfig)}createFloat16PackedMatrixTexture(e,t){return this.throwIfDisposed(),Ose(this.gl,e,t,this.textureConfig)}createPackedMatrixTexture(e,t){return this.throwIfDisposed(),Dse(this.gl,e,t,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(jI(this.gl,this.framebuffer),this.outputTexture=null),nn(this.gl,()=>this.gl.deleteTexture(e))}downloadByteEncodedFloatMatrixFromOutputTexture(e,t,n){return this.downloadMatrixDriver(e,()=>Bse(this.gl,t,n,this.textureConfig))}downloadPackedMatrixFromBuffer(e,t,n,s,o,a){return Use(this.gl,e,t,n,s,o,a,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,t){return jse(this.gl,e,t)}createBufferFromTexture(e,t,n){this.bindTextureToFrameBuffer(e);const s=Pse(this.gl,t,n,this.textureConfig);return this.unbindTextureToFrameBuffer(),s}createAndWaitForFence(){const e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let t,n;if(ut().getBool("WEBGL_FENCE_API_ENABLED")){const s=e,o=s.fenceSync(s.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),n=()=>{const a=s.clientWaitSync(o,0,0);return a===s.ALREADY_SIGNALED||a===s.CONDITION_SATISFIED},t=o}else ut().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(t=this.beginQuery(),this.endQuery(),n=()=>this.isQueryAvailable(t,ut().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):n=()=>!0;return{query:t,isFencePassed:n}}downloadMatrixFromPackedTexture(e,t,n){return this.downloadMatrixDriver(e,()=>zse(this.gl,t,n))}createProgram(e){this.throwIfDisposed();const t=this.gl;this.vertexShader==null&&(this.vertexShader=Ese(t));const n=fre(t);return nn(t,()=>t.attachShader(n,this.vertexShader)),nn(t,()=>t.attachShader(n,e)),pre(t,n),this.debug&&Hv(t,n),this.vertexAttrsAreBound||(this.setProgram(n),this.vertexAttrsAreBound=Mse(t,this.program,this.vertexBuffer)),n}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),e!=null&&nn(this.gl,()=>this.gl.deleteProgram(e))}setProgram(e){this.throwIfDisposed(),this.program=e,this.program!=null&&this.debug&&Hv(this.gl,this.program),nn(this.gl,()=>this.gl.useProgram(e))}getUniformLocation(e,t,n=!0){return this.throwIfDisposed(),n?wre(this.gl,e,t):Sre(this.gl,e,t)}getAttributeLocation(e,t){return this.throwIfDisposed(),nn(this.gl,()=>this.gl.getAttribLocation(e,t))}getUniformLocationNoThrow(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)}setInputMatrixTexture(e,t,n){this.throwIfDisposed(),this.throwIfNoProgram(),_re(this.gl,e,t,n)}setOutputMatrixTexture(e,t,n){this.setOutputMatrixTextureDriver(e,n,t)}setOutputPackedMatrixTexture(e,t,n){this.throwIfDisposed();const[s,o]=Ed(t,n);this.setOutputMatrixTextureDriver(e,s,o)}setOutputMatrixWriteRegion(e,t,n,s){this.setOutputMatrixWriteRegionDriver(n,e,s,t)}setOutputPackedMatrixWriteRegion(e,t,n,s){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&Hv(this.gl,this.program),bg(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const e=this.gl;this.debug&&this.debugValidate(),nn(e,()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),nn(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=vg(this.gl,ut().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(ut().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const n=this.gl,s=this.getQueryTimerExtensionWebGL2(),o=n.createQuery();return n.beginQuery(s.TIME_ELAPSED_EXT,o),o}const e=this.getQueryTimerExtensionWebGL1(),t=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,t),t}endQuery(){if(ut().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const t=this.gl,n=this.getQueryTimerExtensionWebGL2();t.endQuery(n.TIME_ELAPSED_EXT);return}const e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await Nk(()=>this.disposed||this.isQueryAvailable(e,ut().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(e,ut().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,t){if(t===0)return null;if(t===2){const n=this.gl;return n.getQueryParameter(e,n.QUERY_RESULT)/1e6}else{const n=this.getQueryTimerExtensionWebGL1();return n.getQueryObjectEXT(e,n.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,t){if(t===0)return!0;if(t===2){const n=this.gl,s=this.getQueryTimerExtensionWebGL2(),o=n.getQueryParameter(e,n.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(s.GPU_DISJOINT_EXT)),o&&!this.disjoint}else{const n=this.getQueryTimerExtensionWebGL1(),s=n.getQueryObjectEXT(e,n.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(n.GPU_DISJOINT_EXT)),s&&!this.disjoint}}pollFence(e){return new Promise(t=>{this.addItemToPoll(()=>e.isFencePassed(),()=>t())})}pollItems(){const e=Vse(this.itemsToPoll.map(t=>t.isDoneFn));for(let t=0;t<=e;++t){const{resolveFn:n}=this.itemsToPoll[t];n()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,t){if(this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),this.itemsToPoll.length>1)return;let n;"setTimeoutCustom"in ut().platform&&(n=ut().platform.setTimeoutCustom.bind(ut().platform)),Nk(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,n)}bindTextureToFrameBuffer(e){this.throwIfDisposed(),qv(this.gl,e,this.framebuffer),this.debug&&bg(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(qv(this.gl,this.outputTexture,this.framebuffer),this.debug&&bg(this.gl)):jI(this.gl,this.framebuffer)}downloadMatrixDriver(e,t){this.bindTextureToFrameBuffer(e);const n=t();return this.unbindTextureToFrameBuffer(),n}setOutputMatrixTextureDriver(e,t,n){this.throwIfDisposed();const s=this.gl;qv(s,e,this.framebuffer),this.debug&&bg(s),this.outputTexture=e,nn(s,()=>s.viewport(0,0,t,n)),nn(s,()=>s.scissor(0,0,t,n))}setOutputMatrixWriteRegionDriver(e,t,n,s){this.throwIfDisposed(),nn(this.gl,()=>this.gl.scissor(e,t,n,s))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}}function Vse(r){let e=0;for(;e<r.length&&r[e]();++e);return e-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{addImpl:Gse,bincountImpl:rO,bincountReduceImpl:Wse,castImpl:Hse,ceilImpl:qse,concatImpl:Xse,equalImpl:Kse,expImpl:Yse,expm1Impl:Zse,floorImpl:Qse,gatherNdImpl:Jse,gatherV2Impl:eoe,greaterImpl:toe,greaterEqualImpl:noe,lessImpl:roe,lessEqualImpl:soe,linSpaceImpl:ooe,logImpl:ioe,maxImpl:aoe,maximumImpl:loe,minimumImpl:uoe,multiplyImpl:coe,negImpl:hoe,notEqualImpl:doe,prodImpl:foe,raggedGatherImpl:poe,raggedTensorToTensorImpl:moe,rangeImpl:goe,rsqrtImpl:yoe,scatterImpl:voe,sigmoidImpl:boe,simpleAbsImpl:sO,sliceImpl:xoe,sparseFillEmptyRowsImpl:woe,sparseReshapeImpl:Soe,sparseSegmentReductionImpl:oO,sqrtImpl:_oe,stridedSliceImpl:Toe,stringNGramsImpl:koe,stringSplitImpl:Ioe,stringToHashBucketFastImpl:Eoe,subImpl:Coe,tileImpl:$oe,topKImpl:Noe,transposeImpl:IS,uniqueImpl:Aoe}=BZ;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iO(r,e){return["x","y","z","w","u","v"].slice(0,e).map(t=>`${r}.${t}`)}function ro(r,e){return e===1?[r]:iO(r,e)}function Roe(r,e){if(r===1)return"rc";let t="";for(let n=0;n<r;n++)t+=e[n],n<r-1&&(t+=",");return t}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Doe{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=uo(this.outputShape.length),this.rank===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{const t=ro("rc",this.rank),n=Dr(this.rank),s=this.getOutOfBoundsCondition(t),o=this.getSetup(t),a=this.getOutput(t);this.userCode=`
        void main() {
          ${n} rc = getOutputCoords();

          if(${s}) {
            setOutput(vec4(0));
          } else {
            ${o}

            setOutput(vec4(${a}));
          }
        }
      `}}getSourceCoordsArr(e){const t=[];for(let n=0;n<=1;n++)for(let s=0;s<=1;s++){let o=`${n===0?"r":"rp1"}, ${s===0?"c":"cp1"}`;for(let a=2;a<this.rank;a++)o=`${e[e.length-1-a]},`+o;t.push(o)}return t}getOutOfBoundsCondition(e){if(this.rank===1)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let t="";for(let n=this.rank-2;n<this.rank;n++)t+=`${e[n]} >= ${this.enableShapeUniforms?`outShape[${n}]`:this.outputShape[n]}`,n<this.rank-1&&(t+="||");return t}getSetup(e){if(this.rank===1)return"";const t=e.slice(-2),n=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],s=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${t[0]};
      int c = ${t[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${n};
      bool rEdge = rp1 >= ${s};
    `}getOutput(e){const t=this.getSourceCoordsArr(e);return this.rank===1?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${t[0]}),
            cEdge ? 0. : getA(${t[1]}),
            rEdge ? 0. : getA(${t[2]}),
            rEdge || cEdge ? 0. : getA(${t[3]})`}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class aO{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=uo(this.outputShape.length);let n="";for(let s=0;s<4;s++){let o="thisRC = rc;";s%2===1&&(o+="thisRC.z += 1;"),s>1&&(o+="thisRC.y += 1;"),n+=`
        ${o}
        ${s>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${s}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${s>0?"}":""}
      `}this.userCode=`
      ${Ooe(t,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?TS():_S(e)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":e[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":e[2]};

        ${n}

        setOutput(result);
      }
    `}}function Ooe(r,e){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${e?Mre(["r","c","d"],"inputShape"):Jc(["r","c","d"],r)}
      return ivec3(r, c, d);
    }
  `}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Moe{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}acquireTexture(e,t,n){const s=VI(t,n),o=GI(e,s,n);o in this.freeTextures||(this.freeTextures[o]=[]),o in this.usedTextures||(this.usedTextures[o]=[]);const a=zI(e,s,this.gpgpu.gl,this.gpgpu.textureConfig,n);if(this.freeTextures[o].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=a,this.log();const l=this.freeTextures[o].shift();return this.usedTextures[o].push(l),l}let i;return s===Ds.PACKED_2X2_FLOAT32?i=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):s===Ds.PACKED_2X2_FLOAT16?i=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):s===Ds.UNPACKED_FLOAT32?i=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):s===Ds.UNPACKED_FLOAT16?i=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):s===Ds.PACKED_4X1_UNSIGNED_BYTE&&(i=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[o].push(i),this.numUsedTextures++,this._numBytesAllocated+=a,this.log(),i}releaseTexture(e,t,n,s){if(this.freeTextures==null)return;const o=VI(n,s),a=GI(t,o,s);a in this.freeTextures||(this.freeTextures[a]=[]);const i=zI(t,o,this.gpgpu.gl,this.gpgpu.textureConfig,s),l=ut().get("WEBGL_DELETE_TEXTURE_THRESHOLD");l!==-1&&this._numBytesAllocated>l?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=i):(this.freeTextures[a].push(e),this.numFreeTextures++,this._numBytesFree+=i),this.numUsedTextures--;const u=this.usedTextures[a],h=u.indexOf(e);if(h<0)throw new Error("Cannot release a texture that was never provided by this texture manager");u.splice(h,1),this.log()}log(){if(!this.logEnabled)return;const e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${e})`);const t=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*t)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(const e in this.freeTextures)this.freeTextures[e].forEach(t=>{this.gpgpu.deleteMatrixTexture(t.texture)});for(const e in this.usedTextures)this.usedTextures[e].forEach(t=>{this.gpgpu.deleteMatrixTexture(t.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function Foe(r,e){const t=r;if(e===t.R32F)return 4;if(e===t.R16F)return 2;if(e===t.RGBA32F)return 16;if(e===r.RGBA)return 16;if(e===t.RGBA16F)return 8;if(e===t.RGBA8)return 4;throw new Error(`Unknown internal format ${e}`)}function zI(r,e,t,n,s){const o=Loe(e,n);let a;if(s){const[l,u]=Ed(r[0],r[1]);a=l*u}else{const[l,u]=hm(r[0],r[1]);a=l*u}const i=Foe(t,o);return a*i}function Loe(r,e){switch(r){case Ds.PACKED_2X2_FLOAT32:return tO(e);case Ds.PACKED_2X2_FLOAT16:return nO(e);case Ds.UNPACKED_FLOAT32:return QD(e);case Ds.UNPACKED_FLOAT16:return JD(e);case Ds.PACKED_4X1_UNSIGNED_BYTE:return eO(e);default:throw new Error(`Unknown physical texture type ${r}`)}}function Poe(r){return ut().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?r?Ds.PACKED_2X2_FLOAT32:Ds.UNPACKED_FLOAT32:r?Ds.PACKED_2X2_FLOAT16:Ds.UNPACKED_FLOAT16}function VI(r,e){if(r===hi.UPLOAD)return Ds.PACKED_2X2_FLOAT32;if(r===hi.RENDER||r==null)return Poe(e);if(r===hi.DOWNLOAD||r===hi.PIXELS)return Ds.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${r}`)}function GI(r,e,t){return`${r[0]}_${r[1]}_${e}_${t}`}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Tl{constructor(e,t){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=uo(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${t}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}}const Zi="if (isnan(x)) return x;",joe="return x;",WI="return abs(x);",Boe="return (x >= 0.0) ? x : (exp(x) - 1.0);",Uoe=Zi+`
  return (x < 0.0) ? 0.0 : x;
`,zoe=Zi+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,Th="return x;",Voe="return 1.0 / (1.0 + exp(-1.0 * x));";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Goe="return x;",Woe=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,Hoe=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,qoe=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Xoe="return 1.0 / (1.0 + exp(-1.0 * x));";class xc{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=uo(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${t}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Koe{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=uo(this.outputShape.length);const t=e.length,n=ro("rc",t),s=Dr(t),o=Roe(t,n),a=n.slice(-2),i=t<=1?"rc":`vec2(${a.join(",")})`;this.userCode=`
      void main() {
        ${s} rc = getOutputCoords();
        vec4 packedInput = getA(${o});

        setOutput(getChannel(packedInput, ${i}));
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yoe=nN,Zoe=1e-7,Qoe=1e-4,wg={};function Joe(r){return r in wg||(wg[r]={}),wg[r]}const eie=ut().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),tie=600;function nie(){return ut().global.screen==null?1024:ut().global.screen.height*ut().global.screen.width*window.devicePixelRatio*tie/1024/1024}class p1 extends Px{constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!ut().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let t;if(e!=null){if(e instanceof Zv)t=e;else{const n=ya(ut().getNumber("WEBGL_VERSION"),e);t=new Zv(n)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const n=ya(ut().getNumber("WEBGL_VERSION"));t=new Zv(n),this.binaryCache=Joe(ut().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=t,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new Moe(this.gpgpu),this.numMBBeforeWarning=nie(),this.texData=new pC(this,tu())}nextDataId(){return p1.nextDataId++}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}write(e,t,n){if((ut().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||ut().getBool("DEBUG"))&&this.checkNumericalProblems(e),n==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const s={id:this.nextDataId()};return this.texData.set(s,{shape:t,dtype:n,values:e,usage:hi.UPLOAD,refCount:1}),s}refCount(e){return this.texData.has(e)?this.texData.get(e).refCount:0}incRef(e){const t=this.texData.get(e);t.refCount++}decRef(e){if(this.texData.has(e)){const t=this.texData.get(e);t.refCount--}}move(e,t,n,s,o){if(ut().getBool("DEBUG")&&this.checkNumericalProblems(t),s==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:n,dtype:s,values:t,usage:hi.UPLOAD,refCount:o})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){const t=this.texData.get(e),{values:n,dtype:s,complexTensorInfos:o,slice:a,shape:i,isPacked:l}=t;if(a!=null){let c;l?c=new xc(i,Th):c=new Tl(i,Th);const f=this.runWebGLProgram(c,[{dataId:e,shape:i,dtype:s}],s),p=this.readSync(f.dataId);return this.disposeIntermediateTensorInfo(f),p}if(n!=null)return this.convertAndCacheOnCPU(e);if(s==="string")return n;const u=this.activeTimers!=null;let h;u&&(h=yo());let d;if(s==="complex64"){const c=this.readSync(o.real.dataId),f=this.readSync(o.imag.dataId);d=Cl(c,f)}else d=this.getValuesFromTexture(e);return u&&(this.downloadWaitMs+=yo()-h),this.convertAndCacheOnCPU(e,d)}async read(e){if(this.pendingRead.has(e)){const p=this.pendingRead.get(e);return new Promise(m=>p.push(m))}const t=this.texData.get(e),{values:n,shape:s,slice:o,dtype:a,complexTensorInfos:i,isPacked:l}=t;if(o!=null){let p;l?p=new xc(s,Th):p=new Tl(s,Th);const m=this.runWebGLProgram(p,[{dataId:e,shape:s,dtype:a}],a),g=this.read(m.dataId);return this.disposeIntermediateTensorInfo(m),g}if(n!=null)return this.convertAndCacheOnCPU(e);if(ut().getBool("DEBUG")&&!ut().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&ut().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let u=null,h;if(a!=="complex64"&&ut().get("WEBGL_BUFFER_SUPPORTED")){h=this.decode(e);const p=this.texData.get(h.dataId);u=this.gpgpu.createBufferFromTexture(p.texture.texture,...yg(s))}this.pendingRead.set(e,[]),a!=="complex64"&&await this.gpgpu.createAndWaitForFence();let d;if(a==="complex64"){const p=await Promise.all([this.read(i.real.dataId),this.read(i.imag.dataId)]),m=p[0],g=p[1];d=Cl(m,g)}else if(u==null)d=this.getValuesFromTexture(e);else{const p=pt(s);d=this.gpgpu.downloadFloat32MatrixFromBuffer(u,p)}if(h!=null&&this.disposeIntermediateTensorInfo(h),u!=null){const p=this.gpgpu.gl;nn(p,()=>p.deleteBuffer(u))}const c=this.convertAndCacheOnCPU(e,d),f=this.pendingRead.get(e);return this.pendingRead.delete(e),f.forEach(p=>p(c)),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&tu().removeDataId(e,this),this.pendingDeletes--),c}readToGPU(e,t={}){const n=this.texData.get(e),{values:s,shape:o,slice:a,dtype:i,isPacked:l,texture:u}=n;if(i==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(a!=null){let f;l?f=new xc(o,Th):f=new Tl(o,Th);const p=this.runWebGLProgram(f,[{dataId:e,shape:o,dtype:i}],i),m=this.readToGPU(p,t);return this.disposeIntermediateTensorInfo(p),m}if(u==null)throw s!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const h=this.decode(e,t.customTexShape),d=tu().makeTensorFromTensorInfo(h),c=this.texData.get(h.dataId);return Object.assign({tensorRef:d},c.texture)}bufferSync(e){const t=this.readSync(e.dataId);if(e.dtype==="string")try{const n=t.map(s=>mu(s));return Wn(e.shape,e.dtype,n)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Wn(e.shape,e.dtype,t)}checkNumericalProblems(e){if(e!=null)for(let t=0;t<e.length;t++){const n=e[t];if(!lre(n))throw ut().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${n} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${n} cannot be represented on this device.`)}}getValuesFromTexture(e){const{shape:t,dtype:n,isPacked:s}=this.texData.get(e),o=pt(t);if(ut().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const c=this.decode(e),f=this.texData.get(c.dataId),p=this.gpgpu.downloadMatrixFromPackedTexture(f.texture.texture,...yg(t)).subarray(0,o);return this.disposeIntermediateTensorInfo(c),p}const a=ut().getBool("WEBGL_PACK")&&s===!0,i=a?Xv(t):t,l=a?new Tse(i):new _se(i),u=this.runWebGLProgram(l,[{shape:i,dtype:n,dataId:e}],"float32"),h=this.texData.get(u.dataId),d=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(h.texture.texture,h.texShape[0],h.texShape[1]).subarray(0,o);return this.disposeIntermediateTensorInfo(u),d}timerAvailable(){return ut().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){const t=this.activeTimers,n=[];let s=!1;this.programTimersStack==null?(this.programTimersStack=n,s=!0):this.activeTimers.push(n),this.activeTimers=n,e();const o=Xh(this.activeTimers.map(l=>l.query)).filter(l=>l!=null),a=Xh(this.activeTimers.map(l=>l.name)).filter(l=>l!=null);this.activeTimers=t,s&&(this.programTimersStack=null);const i={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(ut().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const l=await Promise.all(o);i.kernelMs=H6(l),i.getExtraProfileInfo=()=>l.map((u,h)=>({name:a[h],ms:u})).map(u=>`${u.name}: ${u.ms}`).join(", ")}else i.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,i})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return ut().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:yo(),endMs:null}}endTimer(e){return ut().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=yo(),e)}async getQueryTime(e){if(ut().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(e);const t=e;return t.endMs-t.startMs}disposeData(e,t=!1){if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(t?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!t&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);const{complexTensorInfos:n}=this.texData.get(e);return n!=null&&(this.disposeData(n.real.dataId,t),this.disposeData(n.imag.dataId,t)),this.texData.delete(e),!0}releaseGPUData(e){const{texture:t,dtype:n,texShape:s,usage:o,isPacked:a,slice:i}=this.texData.get(e),l=i&&i.origDataId||e,u=this.dataRefCount.get(l);u>1?this.dataRefCount.set(l,u-1):(this.dataRefCount.delete(l),t!=null&&(this.numBytesInGPU-=this.computeBytes(s,n),this.textureManager.releaseTexture(t,s,o,a)));const h=this.texData.get(e);h.texture=null,h.texShape=null,h.isPacked=!1,h.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e,t=eie){return ut().getBool("WEBGL_CPU_FORWARD")&&e.every(n=>this.texData.get(n.dataId).texture==null&&pt(n.shape)<t)}getGPGPUContext(){return this.gpgpu}where(e){ci("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const t=e.dataSync();return Yoe(e.shape,t)}packedUnaryOp(e,t,n){const s=new xc(e.shape,t),o=this.compileAndRun(s,[e],n);return tu().makeTensorFromTensorInfo(o)}abs(e){if(this.shouldExecuteOnCPU([e])&&e.dtype!=="complex64"){const s=sO(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,s)}if(ut().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,WI,e.dtype);const t=new Tl(e.shape,WI),n=this.compileAndRun(t,[e]);return tu().makeTensorFromTensorInfo(n)}makeTensorInfo(e,t,n){let s;if(t==="string"&&n!=null&&n.length>0&&Kf(n[0])){const o=n.map(a=>cu(a));s=this.write(o,e,t)}else s=this.write(n,e,t);return this.texData.get(s).usage=null,{dataId:s,shape:e,dtype:t}}makeOutput(e,t,n){return tu().makeTensorFromTensorInfo(this.makeTensorInfo(e,t,n),this)}unpackTensor(e){const t=new Koe(e.shape);return this.runWebGLProgram(t,[e],e.dtype)}packTensor(e){const t=new Doe(e.shape),n=!0;return this.runWebGLProgram(t,[e],e.dtype,null,n)}packedReshape(e,t){const n=[id(e.shape),...ad(e.shape)],s={dtype:e.dtype,shape:n,dataId:e.dataId},o=[id(t),...ad(t)],a=new aO(o,n),i=!0,l=[n],u=this.runWebGLProgram(a,[s],e.dtype,l,i);return{dataId:u.dataId,shape:t,dtype:u.dtype}}decode(e,t){const n=this.texData.get(e),{isPacked:s,shape:o,dtype:a}=n;if(t!=null){const c=pt(o),f=t[0]*t[1]*4;xe(c<=f,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}const i=Xv(o);let l;s?l=new Sse(i):l=new wse(i);const u=!0,h=[t!=null?t:yg(i)],d=this.runWebGLProgram(l,[{shape:i,dtype:a,dataId:e}],a,h,u,t);return{dtype:a,shape:o,dataId:d.dataId}}runWebGLProgram(e,t,n,s,o=!1,a){const i=this.makeTensorInfo(e.outputShape,n),l=this.texData.get(i.dataId);if(e.packedOutput&&(l.isPacked=!0),e.outPackingScheme===Rf.DENSE){const y=a!=null?a:yg(e.outputShape);l.texShape=y.map(v=>v*2)}if(e.outTexUsage!=null&&(l.usage=e.outTexUsage),pt(i.shape)===0)return l.values=Os(i.dtype,0),i;const u=[],h=t.map(y=>{if(y.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let v=this.texData.get(y.dataId);if(v.texture==null){if(!e.packedInputs&&pt(y.shape)<=ut().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:y.shape,texData:null,isUniform:!0,uniformValues:v.values};e.packedInputs&&(v.isPacked=!0,v.shape=y.shape)}if(this.uploadToGPU(y.dataId),!!v.isPacked!=!!e.packedInputs)y=v.isPacked?this.unpackTensor(y):this.packTensor(y),u.push(y),v=this.texData.get(y.dataId);else if(v.isPacked&&!xy(v.shape,y.shape)){const b=y,w=y.shape;y.shape=v.shape,y=this.packedReshape(y,w),u.push(y),v=this.texData.get(y.dataId),b.shape=w}return{shape:y.shape,texData:v,isUniform:!1}});this.uploadToGPU(i.dataId);const d={shape:i.shape,texData:l,isUniform:!1},c=xse(e,h,d),f=this.getAndSaveBinary(c,()=>vse(this.gpgpu,e,h,d)),p=this.activeTimers!=null;let m;p&&(m=this.startTimer()),ut().get("ENGINE_COMPILE_ONLY")||bse(this.gpgpu,f,h,d,s),u.forEach(y=>this.disposeIntermediateTensorInfo(y)),p&&(m=this.endTimer(m),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(m)}));const g=ut().get("WEBGL_FLUSH_THRESHOLD");if(g>0){const y=yo();y-this.lastGlFlushTime>g&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=y)}if(!ut().getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&o===!1){const y=this.unpackTensor(i);return this.disposeIntermediateTensorInfo(i),y}return i}compileAndRun(e,t,n,s,o=!1){return n=n||t[0].dtype,this.runWebGLProgram(e,t,n,s,o)}getAndSaveBinary(e,t){return e in this.binaryCache||(this.binaryCache[e]=t()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(ut().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(t=>{this.gpgpu.deleteProgram(this.binaryCache[t].webGLProgram),delete this.binaryCache[t]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement!="undefined"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=at(()=>{if(!ut().get("WEBGL_RENDER_FLOAT32_ENABLED")){const e=ut().getBool("DEBUG");ut().set("DEBUG",!1);const t=this.abs(An(1e-8)).dataSync()[0];if(ut().set("DEBUG",e),t>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?Zoe:Qoe}uploadToGPU(e){const t=this.texData.get(e),{shape:n,dtype:s,values:o,texture:a,usage:i,isPacked:l}=t;if(a!=null)return;const u=this.activeTimers!=null;let h;u&&(h=yo());let d=t.texShape;if(d==null&&(d=Ire(n,l),t.texShape=d),o!=null){const c=Xv(n);let f,p=d[1],m=d[0];const g=o instanceof Uint8Array||o instanceof Uint8ClampedArray;(l||!g)&&([p,m]=Ed(d[0],d[1])),l?f=new Ise(c,g):f=new kse(c,g);const y=g?[m,p]:d,v=this.makeTensorInfo(y,s),b=this.texData.get(v.dataId);g?b.usage=hi.PIXELS:b.usage=hi.UPLOAD,b.texShape=y,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(v.dataId),p,m,o);const w=[[m,p]],_=!0,I=this.runWebGLProgram(f,[v],s,w,_),C=this.texData.get(I.dataId);t.texShape=C.texShape,t.isPacked=C.isPacked,t.usage=C.usage,ut().get("ENGINE_COMPILE_ONLY")?this.disposeData(I.dataId):(t.texture=C.texture,t.values=null,this.texData.delete(I.dataId)),this.disposeIntermediateTensorInfo(v),u&&(this.uploadWaitMs+=yo()-h)}else{const c=this.acquireTexture(d,i,s,l);t.texture=c}}convertAndCacheOnCPU(e,t){const n=this.texData.get(e),{dtype:s}=n;return this.releaseGPUData(e),t!=null&&(n.values=rie(t,s)),n.values}acquireTexture(e,t,n,s){if(this.numBytesInGPU+=this.computeBytes(e,n),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){const o=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${o} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(e,t,s)}computeBytes(e,t){return e[0]*e[1]*mb(t)}checkCompileCompletion(){for(const[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}async checkCompileCompletionAsync(){const e=[];if(this.gpgpu.parallelCompilationExtension){for(const[,t]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(t));return Promise.all(e)}else{for(const[,t]of Object.entries(this.binaryCache)){const n=new Promise(s=>{try{this.checkCompletion_(t),s(!0)}catch(o){throw o}});e.push(n)}return Promise.all(e)}}async checkCompletionAsync_(e){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(await iN(),this.checkCompletionAsync_(e))}checkCompletion_(e){if(this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(HD(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(const[,e]of Object.entries(this.binaryCache)){const{uniformLocations:t,customUniformLocations:n,infLoc:s,nanLoc:o,inShapesLocations:a,inTexShapesLocations:i,outShapeLocation:l,outShapeStridesLocation:u,outTexShapeLocation:h}=ZD(this.gpgpu,e.program,e.webGLProgram);e.uniformLocations=t,e.customUniformLocations=n,e.infLoc=s,e.nanLoc=o,e.inShapesLocations=a,e.inTexShapesLocations=i,e.outShapeLocation=l,e.outShapeStridesLocation=u,e.outTexShapeLocation=h}}}p1.nextDataId=0;function rie(r,e){if(e==="float32"||e==="complex64")return r;if(e==="int32"||e==="bool"){const t=e==="int32"?new Int32Array(r.length):new Uint8Array(r.length);for(let n=0;n<t.length;++n)t[n]=Math.round(r[n]);return t}else throw new Error(`Unknown dtype ${e}`)}/** @license See the LICENSE file. *//**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */QC()&&h$("webgl",()=>new p1,2);/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ES=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`;class ld{constructor(e,t,n){this.variableNames=["A","B"],this.outputShape=Dn(t,n),this.enableShapeUniforms=uo(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${e}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pm=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`;class mm{constructor(e,t,n,s=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Dn(t,n);const o=this.outputShape.length;this.enableShapeUniforms=uo(o);let a="";if(s)if(o===0||pt(this.outputShape)===1)a=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(a=`
          ${Dr(o)} coords = getOutputCoords();
        `,o===1)this.enableShapeUniforms?a+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:a+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{const l=ro("coords",o);this.enableShapeUniforms?a+=`
            bool nextRowOutOfBounds =
              (${l[o-2]} + 1) >= outShape[${o} - 2];
            bool nextColOutOfBounds =
              (${l[o-1]} + 1) >= outShape[${o} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:a+=`
            bool nextRowOutOfBounds =
              (${l[o-2]} + 1) >= ${this.outputShape[o-2]};
            bool nextColOutOfBounds =
              (${l[o-1]} + 1) >= ${this.outputShape[o-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${e}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${a}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Go(r){const{inputs:e,backend:t}=r,{x:n}=e;return t.incRef(n.dataId),{dataId:n.dataId,shape:n.shape,dtype:n.dtype}}const sie={kernelName:yp,backendName:"webgl",kernelFunc:Go};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ou(r){const{inputs:e,backend:t}=r,{real:n,imag:s}=e,o=t.makeTensorInfo(n.shape,"complex64"),a=t.texData.get(o.dataId),i=Go({inputs:{x:n},backend:t}),l=Go({inputs:{x:s},backend:t});return a.complexTensorInfos={real:i,imag:l},o}const oie={kernelName:Xx,backendName:"webgl",kernelFunc:Ou};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lO="return (a < 0.) ? b * a : a;",uO=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function iie(r){const{inputs:e,backend:t,attrs:n}=r,{x:s}=e,{alpha:o}=n,a=t.makeTensorInfo([],"float32",ku(o,"float32")),i=ut().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new mm(uO,s.shape,a.shape):new ld(lO,s.shape,a.shape),l=t.runWebGLProgram(i,[s,a],"float32");return t.disposeIntermediateTensorInfo(a),l}const aie={kernelName:i0,backendName:"webgl",kernelFunc:iie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cO="return (a < 0.) ? b * a : a;",hO=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function lie(r){const{inputs:e,backend:t}=r,{x:n,alpha:s}=e,o=ut().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new mm(hO,n.shape,s.shape):new ld(cO,n.shape,s.shape);return t.runWebGLProgram(o,[n,s],"float32")}const uie={kernelName:k0,backendName:"webgl",kernelFunc:lie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rd="if (isnan(x)) return x;";function ar({opSnippet:r,packedOpSnippet:e,cpuKernelImpl:t,dtype:n}){return({inputs:s,backend:o})=>{const{x:a}=s,i=o,l=n||a.dtype;if(i.shouldExecuteOnCPU([a])&&t!=null){const d=i.texData.get(a.dataId),c=t(d.values,l);return i.makeTensorInfo(a.shape,l,c)}const u=ut().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&e!=null;let h;return u?h=new xc(a.shape,e):h=new Tl(a.shape,r),i.runWebGLProgram(h,[a],l)}}function Ls({opSnippet:r,packedOpSnippet:e,checkOutOfBounds:t=!1,supportsComplex:n=!1,cpuKernelImpl:s,dtype:o}){return({inputs:a,backend:i})=>{const{a:l,b:u}=a,h=i;if(n&&l.dtype==="complex64"){const p=h.texData.get(l.dataId),m=h.texData.get(u.dataId),[g,y]=[[p.complexTensorInfos.real,m.complexTensorInfos.real],[p.complexTensorInfos.imag,m.complexTensorInfos.imag]].map(b=>{const[w,_]=b,I={dataId:w.dataId,dtype:w.dtype,shape:l.shape},C={dataId:_.dataId,dtype:_.dtype,shape:u.shape},N=new ld(r,l.shape,u.shape);return h.runWebGLProgram(N,[I,C],Bo(w.dtype,_.dtype))}),v=Ou({inputs:{real:g,imag:y},backend:h});return h.disposeIntermediateTensorInfo(g),h.disposeIntermediateTensorInfo(y),v}const d=o||Bo(l.dtype,u.dtype);if((l.dtype==="string"||u.dtype==="string"||h.shouldExecuteOnCPU([l,u]))&&s!=null){const p=h.texData.get(l.dataId).values,m=h.texData.get(u.dataId).values,g=l.dtype==="string"?Pc(p):p,y=l.dtype==="string"?Pc(m):m,[v,b]=s(l.shape,u.shape,g,y,d),w=h.makeTensorInfo(b,d),_=h.texData.get(w.dataId);return _.values=v,w}const c=ut().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&e!=null;let f;return c?f=new mm(e,l.shape,u.shape,t):f=new ld(r,l.shape,u.shape),h.runWebGLProgram(f,[l,u],d)}}function Df(r,e=!1){if(r==="linear")return e?Goe:joe;if(r==="relu")return e?Hoe:Uoe;if(r==="elu")return e?Woe:Boe;if(r==="relu6")return e?qoe:zoe;if(r==="prelu")return e?hO:cO;if(r==="leakyrelu")return e?uO:lO;if(r==="sigmoid")return e?Xoe:Voe;throw new Error(`Activation ${r} has not been implemented for the WebGL backend.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dO{constructor(e,t,n,s=!1,o=!1,a=!1,i=null,l=!1,u=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n,this.enableShapeUniforms=uo(this.outputShape.length);const h=s?e[1]:e[2],d=Math.ceil(h/2),c=s?"i * 2, rc.y":"rc.y, i * 2",f=o?"rc.z, i * 2":"i * 2, rc.z",p=s?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],m=o?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let g="",y="";i&&(l?g=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${i}
        }`:u?g=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${i}
        }`:g=`vec4 activation(vec4 x) {
          ${i}
        }`,y="result = activation(result);");const v=a?"result += getBiasAtOutCoords();":"";a&&this.variableNames.push("bias"),l&&this.variableNames.push("preluActivationWeights"),u&&this.variableNames.push("leakyreluAlpha");let b="rc.x",w="rc.x";e[0]<t[0]?b=`int(min(float(rc.x), ${e[0]-1}.))`:t[0]<e[0]&&(w=`int(min(float(rc.x), ${t[0]-1}.))`),this.userCode=`
      ${g}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${d}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        for (int i = 0; i < ${d}; i++) {
          int batchA = ${b};
          int batchB = ${w};
          vec4 a = getMatrixA(batchA, ${c});
          vec4 b = getMatrixB(batchB, ${f});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${p[0]} * ${m[0]});
          result += (${p[1]} * ${m[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${v}

        ${y}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HI={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class qI{constructor(e,t,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=Dn(t,n),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${e}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XI="return a * b;";function CS(r){const{inputs:e,backend:t}=r,{a:n,b:s}=e,o=Bo(n.dtype,s.dtype);if(n.dtype==="complex64"){const i=t.texData.get(n.dataId),l=t.texData.get(s.dataId),u=new qI(HI.REAL,n.shape,s.shape),h=new qI(HI.IMAG,n.shape,s.shape),d=[{dataId:i.complexTensorInfos.real.dataId,dtype:i.complexTensorInfos.real.dtype,shape:n.shape},{dataId:i.complexTensorInfos.imag.dataId,dtype:i.complexTensorInfos.imag.dtype,shape:n.shape},{dataId:l.complexTensorInfos.real.dataId,dtype:l.complexTensorInfos.real.dtype,shape:s.shape},{dataId:l.complexTensorInfos.imag.dataId,dtype:l.complexTensorInfos.imag.dtype,shape:s.shape}],c=t.runWebGLProgram(u,d,"float32"),f=t.runWebGLProgram(h,d,"float32"),p=Ou({inputs:{real:c,imag:f},backend:t});return t.disposeIntermediateTensorInfo(c),t.disposeIntermediateTensorInfo(f),p}if(t.shouldExecuteOnCPU([n,s])){const i=t.texData.get(n.dataId),l=t.texData.get(s.dataId),[u,h]=coe(n.shape,s.shape,i.values,l.values,o),d=t.makeTensorInfo(h,o),c=t.texData.get(d.dataId);return c.values=u,d}let a;return ut().getBool("WEBGL_PACK_BINARY_OPERATIONS")?a=new mm(XI,n.shape,s.shape):a=new ld(XI,n.shape,s.shape),t.runWebGLProgram(a,[n,s],o)}const cie={kernelName:Ip,backendName:"webgl",kernelFunc:CS};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hie(r,e,t){const n=[id(r.shape),...ad(r.shape)],s={dtype:r.dtype,shape:n,dataId:r.dataId},o=[id(e),...ad(e)],a=new aO(o,n),i=!0,l=[n],u=t.runWebGLProgram(a,[s],r.dtype,l,i);return{dataId:u.dataId,shape:e,dtype:u.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wt(r){const{inputs:e,backend:t,attrs:n}=r,{x:s}=e,{shape:o}=n,a=t,i=pt(s.shape),l=gC(o,i),u=pt(l);xe(i===u,()=>`The new shape (${l}) has ${u} elements and the old shape (${s.shape}) has ${i} elements. The new shape and old shape must have the same number of elements.`);const h=a.texData.get(s.dataId);return h.isPacked&&!xy(s.shape,l)&&!(h.texture!==null&&xy(h.shape,l))?hie(s,l,a):(a.incRef(s.dataId),{dataId:s.dataId,shape:l,dtype:s.dtype})}const die={kernelName:E0,backendName:"webgl",kernelFunc:Wt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class KI{constructor(e,t){this.variableNames=["x"];const{windowSize:n,batchSize:s,inSize:o,outSize:a}=e;this.outputShape=[s,a];const i=Math.floor(n/4)*4,l=n%4;let u="sumValue += dot(values, ones);";if(t!=null){const d=1/t;u=`sumValue += dot(values * ${Kh(d)?d.toPrecision(2):d}, ones);`}let h="";o%n>0&&(h=`
        if (inIdx < 0 || inIdx >= ${o}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${h}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${n};

        float sumValue = 0.0;

        for (int i = 0; i < ${i}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${u}
        }

        int inIdx = inOffset + ${i};
        if (${l===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${u}
        } else if (${l===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${u}
        } else if (${l===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${u}
        }
        setOutput(sumValue);
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fie{constructor(e,t){this.variableNames=["x"];const{windowSize:n,batchSize:s,inSize:o,outSize:a}=e;this.outputShape=[s,a];let i="0.0",l="";t==="prod"?i="1.0":t==="min"?(i="1.0 / 1e-20",l="min"):t==="max"&&(i="-1.0 / 1e-20",l="max");let u=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;t==="sum"?u="sumValue":t==="prod"?u="prodValue":t==="all"?u="allValue":t==="any"&&(u="anyValue");const h=Math.floor(n/4)*4,d=n%4;let c=`
      if (${t==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${t==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${l}(values, minMaxValue);
        if (${t==="min"} || ${t==="max"}) {
          minMaxValue = ${l}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,f="vec4";t==="all"?(i="1.0",c=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,f="bvec4"):t==="any"&&(i="0.0",c=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,f="bvec4");let p="";o%n>0&&(p=`
        if (inIdx < 0 || inIdx >= ${o}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${i};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${p}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${n};

        vec4 minMaxValue = vec4(${i});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${h}; i += 4) {
          int inIdx = inOffset + i;
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${c}
        }

        int inIdx = inOffset + ${h};
        if (${d===1}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${c}
        } else if (${d===2}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${c}
        } else if (${d===3}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${c}
        }
        setOutput(${u});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pie(r){const e=[];for(;e.length===0||e[e.length-1].outSize!==1;){const t=e.length?e[e.length-1].outSize:r[1],n=Q0(t);e.push({inSize:t,windowSize:n,outSize:Math.ceil(t/n)})}return e}function th(r,e,t,n){const s=pie(r.shape);let o=r;for(let a=0;a<s.length;a++){const{inSize:i,windowSize:l,outSize:u}=s[a];let h,d;t==="mean"?h=a===0?new KI({windowSize:l,inSize:i,batchSize:r.shape[0],outSize:u},i):new KI({windowSize:l,inSize:i,batchSize:r.shape[0],outSize:u}):h=new fie({windowSize:l,inSize:i,batchSize:r.shape[0],outSize:u},t),d=o,o=n.runWebGLProgram(h,[o],e),d.dataId!==r.dataId&&n.disposeIntermediateTensorInfo(d)}return o}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mie{constructor(e,t){this.variableNames=["A"];const n=new Array(e.length);for(let a=0;a<n.length;a++)n[a]=e[t[a]];this.outputShape=n,this.rank=n.length;const s=Dr(this.rank),o=gie(t);this.userCode=`
    void main() {
      ${s} resRC = getOutputCoords();
      setOutput(getA(${o}));
    }
    `}}function gie(r){const e=r.length;if(e>6)throw Error(`Transpose for rank ${e} is not yet supported`);const t=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],n=new Array(e);for(let s=0;s<r.length;s++)n[r[s]]=t[s];return n.join()}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yie{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const n=new Array(e.length);for(let h=0;h<n.length;h++)n[h]=e[t[h]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const s=Dr(this.rank),o=iO("rc",this.rank),a=new Array(this.rank);for(let h=0;h<t.length;h++)a[t[h]]=o[h];const i=`vec2(${a.slice(-2).join()})`,l=`++${o[this.rank-1]} < ${n[this.rank-1]}`,u=`getChannel(getA(${a.join()}), ${i})`;this.userCode=`
    void main() {
      ${s} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${u};
      if(${l}) {
        result[1] = ${u};
      }
      --${o[this.rank-1]};
      if(++${o[this.rank-2]} < ${n[this.rank-2]}) {
        result[2] = ${u};
        if(${l}) {
          result[3] = ${u};
        }
      }
      setOutput(result);
    }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m1(r,e,t){const n=ut().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new yie(r.shape,e):new mie(r.shape,e);return t.runWebGLProgram(n,[r],r.dtype)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vie(r,e,t,n){const s=e,o=r.shape.length,a=Hn(s,r.shape);let i=a;const l=qr(i,o),u=l!=null;let h=r;u&&(h=m1(r,l,n),i=ts(i.length,o)),Fs("sum",i,o);const[d,c]=ks(h.shape,i);let f=d;t&&(f=es(d,a));const p=pt(c),g=pt(r.shape)/p,y=Wt({inputs:{x:h},attrs:{shape:[g,p]},backend:n}),v=Dw(r.dtype),b=th(y,v,"sum",n),w=Wt({inputs:{x:b},attrs:{shape:f},backend:n});return n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(b),u&&n.disposeIntermediateTensorInfo(h),w}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g1(r){const{inputs:e,backend:t,attrs:n}=r,{x:s}=e,{axis:o,keepDims:a}=n;return vie(s,o,a,t)}const bie={kernelName:D0,backendName:"webgl",kernelFunc:g1};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ao(r){const{inputs:e,backend:t,attrs:n}=r,{x:s}=e,{perm:o}=n,a=t,i=s.shape.length,l=new Array(i);for(let h=0;h<l.length;h++)l[h]=s.shape[o[h]];let u;if(a.shouldExecuteOnCPU([s])){const d=a.texData.get(s.dataId).values,c=IS(d,s.shape,s.dtype,o,l);u=a.makeTensorInfo(l,s.dtype);const f=a.texData.get(u.dataId);f.values=c}else u=m1(s,o,a);return u}const xie={kernelName:Bh,backendName:"webgl",kernelFunc:ao};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fO=1e3;function wy({a:r,b:e,transposeA:t,transposeB:n,backend:s,bias:o=null,preluActivationWeights:a=null,leakyreluAlpha:i=0,activation:l=null}){const u=r.shape.length,h=e.shape.length,d=t?r.shape[u-2]:r.shape[u-1],c=n?e.shape[h-1]:e.shape[h-2],f=t?r.shape[u-1]:r.shape[u-2],p=n?e.shape[h-2]:e.shape[h-1],m=r.shape.slice(0,-2),g=e.shape.slice(0,-2),y=pt(m),v=pt(g),w=Dn(r.shape.slice(0,-2),e.shape.slice(0,-2)).concat([f,p]);xe(d===c,()=>`Error in matMul: inner shapes (${d}) and (${c}) of Tensors with shapes ${r.shape} and ${e.shape} and transposeA=${t} and transposeB=${n} must match.`);const _=t?[y,d,f]:[y,f,d],I=n?[v,p,c]:[v,c,p],C=Wt({inputs:{x:r},backend:s,attrs:{shape:_}}),N=Wt({inputs:{x:e},backend:s,attrs:{shape:I}}),O=[C,N],D=Math.max(y,v),M=t?C.shape[1]:C.shape[2],P=o!=null,F=a!=null,B=l==="leakyrelu",z=l!=null?Df(l,!0):null,Z=P||F||B||z!=null;let Q;if((f===1||p===1)&&M>fO&&Z===!1){let ne=C,re=N;t&&(ne=ao({inputs:{x:C},backend:s,attrs:{perm:[0,2,1]}}),O.push(ne)),n&&(re=ao({inputs:{x:N},backend:s,attrs:{perm:[0,2,1]}}),O.push(re));const ce=p!==1,be=p===1;let we=ne;ce&&(we=Wt({inputs:{x:ne},backend:s,attrs:{shape:[D,M,1]}}),O.push(we));const ye=p===1?2:1;let Oe=re;be&&(Oe=Wt({inputs:{x:re},backend:s,attrs:{shape:[D,1,M]}}),O.push(Oe));const Se=CS({inputs:{a:we,b:Oe},backend:s});Q=g1({inputs:{x:Se},backend:s,attrs:{axis:ye,keepDims:!0}}),O.push(Se)}else{const ne=Bo(r.dtype,e.dtype),re=new dO(_,I,[D,f,p],t,n,P,z,F,B),ce=[C,N];if(o!=null&&ce.push(o),F&&ce.push(a),B){const be=s.makeTensorInfo([],"float32",ku(i,"float32"));ce.push(be),O.push(be)}Q=s.runWebGLProgram(re,ce,ne)}const K=Wt({inputs:{x:Q},backend:s,attrs:{shape:w}});O.push(Q);for(const ne of O)s.disposeIntermediateTensorInfo(ne);return K}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wie(r){const{inputs:e,backend:t,attrs:n}=r,{a:s,b:o,bias:a,preluActivationWeights:i}=e,{transposeA:l,transposeB:u,activation:h,leakyreluAlpha:d}=n;return wy({a:s,b:o,transposeA:l,transposeB:u,backend:t,bias:a,preluActivationWeights:i,leakyreluAlpha:d,activation:h})}const Sie={kernelName:Yg,backendName:"webgl",kernelFunc:wie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YI="return abs(x);";function _ie(r){const{inputs:e,backend:t}=r,{x:n}=e;if(t.shouldExecuteOnCPU([n])&&n.dtype!=="complex64"){const o=t.texData.get(n.dataId),a=sO(o.values);return t.makeTensorInfo(n.shape,n.dtype,a)}let s;return ut().getBool("WEBGL_PACK_UNARY_OPERATIONS")?s=new xc(n.shape,YI):s=new Tl(n.shape,YI),t.runWebGLProgram(s,[n],n.dtype)}const Tie={kernelName:By,backendName:"webgl",kernelFunc:_ie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kie=Zi+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,Iie=ar({opSnippet:kie}),Eie={kernelName:Zf,backendName:"webgl",kernelFunc:Iie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cie=Zi+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,$ie=ar({opSnippet:Cie}),Nie={kernelName:Qf,backendName:"webgl",kernelFunc:$ie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZI="return a + b;",Aie=Ls({opSnippet:ZI,packedOpSnippet:ZI,supportsComplex:!0,cpuKernelImpl:Gse}),Rie={kernelName:bd,backendName:"webgl",kernelFunc:Aie};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Die{constructor(e,t){this.outputShape=[],this.outputShape=e,this.variableNames=t.map((o,a)=>`T${a}`);const n=[];this.variableNames.forEach(o=>{n.push(`float v${o} = get${o}AtOutCoords();`)});const s=this.variableNames.map(o=>`v${o}`).join(" + ");this.userCode=`
      void main() {
        ${n.join(`
        `)}

        float result = ${s};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Oie{constructor(e,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=t.map((o,a)=>`T${a}`);const n=[];this.variableNames.forEach(o=>{n.push(`vec4 v${o} = get${o}AtOutCoords();`)});const s=this.variableNames.map(o=>`v${o}`).join(" + ");this.userCode=`
      void main() {
        ${n.join(`
        `)}

        vec4 result = ${s};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wg(r){const{inputs:e,backend:t}=r,n=e;if(n.length===1)return Go({inputs:{x:n[0]},backend:t});if(n.length>ut().get("WEBGL_MAX_TEXTURES_IN_SHADER")){const l=Math.floor(n.length/2),u=Wg({inputs:n.slice(0,l),backend:t}),h=Wg({inputs:n.slice(l),backend:t});return Wg({inputs:[u,h],backend:t})}const s=n.map(l=>l.dtype).reduce((l,u)=>Bo(l,u)),o=n.map(l=>l.shape),i=ut().getBool("WEBGL_PACK")?new Oie(n[0].shape,o):new Die(n[0].shape,o);return t.runWebGLProgram(i,n,s)}const Mie={kernelName:zx,backendName:"webgl",kernelFunc:Wg};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fie(r){const{inputs:e,backend:t,attrs:n}=r,{x:s}=e,{axis:o,keepDims:a}=n,i=s.shape.length,l=Hn(o,s.shape);let u=l;const h=qr(u,i);let d=s;h!=null&&(d=ao({inputs:{x:s},backend:t,attrs:{perm:h}}),u=ts(u.length,i)),Fs("all",u,i);const[c,f]=ks(d.shape,u),p=pt(f),m=Wt({inputs:{x:d},backend:t,attrs:{shape:[-1,p]}}),g=th(m,m.dtype,"all",t);let y;if(a){const v=es(c,l);y=Wt({inputs:{x:g},backend:t,attrs:{shape:v}})}else y=Wt({inputs:{x:g},backend:t,attrs:{shape:c}});return t.disposeIntermediateTensorInfo(m),t.disposeIntermediateTensorInfo(g),h!=null&&t.disposeIntermediateTensorInfo(d),y}const Lie={kernelName:Vx,backendName:"webgl",kernelFunc:Fie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pie(r){const{inputs:e,backend:t,attrs:n}=r,{x:s}=e,{axis:o,keepDims:a}=n,i=s.shape.length,l=Hn(o,s.shape);let u=l;const h=qr(u,i);let d=s;h!=null&&(d=ao({inputs:{x:s},backend:t,attrs:{perm:h}}),u=ts(u.length,i)),Fs("any",u,i);const[c,f]=ks(d.shape,u),p=pt(f),m=Wt({inputs:{x:d},backend:t,attrs:{shape:[-1,p]}}),g=th(m,m.dtype,"any",t);let y;if(a){const v=es(c,l);y=Wt({inputs:{x:g},backend:t,attrs:{shape:v}})}else y=Wt({inputs:{x:g},backend:t,attrs:{shape:c}});return t.disposeIntermediateTensorInfo(m),t.disposeIntermediateTensorInfo(g),h!=null&&t.disposeIntermediateTensorInfo(d),y}const jie={kernelName:Gx,backendName:"webgl",kernelFunc:Pie};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Bie{constructor(e,t,n){this.variableNames=["A"];const{windowSize:s,batchSize:o,outSize:a}=e;n||this.variableNames.push("bestIndicesA"),this.outputShape=[o,a];const i=t==="max"?">":"<",l=n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${s}; i++) {
          int inIdx = ${l};
          float candidate = getA(batch, inIdx);
          if (candidate ${i} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Uie{constructor(e,t,n,s){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,xe(e.length>2,()=>`Packed arg${n.charAt(0).toUpperCase()+n.slice(1)} supports only inputs with rank above 2.`);const o=e[e.length-1],a=Math.ceil(o/t);this.outputShape=e.slice(0,-1),a>1&&this.outputShape.push(a),s||this.variableNames.push("bestIndicesA");const i=this.outputShape,l=i.length,u=Dr(l),h=ro("coords",l);let d,c;if(a===1){c=l+1;const N=Dr(c);d=`
        ${N} sourceLocR = ${N}(${h.join()}, 0);
        ++${h[l-1]};
        ${N} sourceLocG = ${N}(${h.join()}, 0);
        ++${h[l-2]};
        ${N} sourceLocA = ${N}(${h.join()}, 0);
        --${h[l-1]};
        ${N} sourceLocB = ${N}(${h.join()}, 0);
        --${h[l-2]};`}else c=l,d=`
        ${u} sourceLocR = coords;
        ++${h[l-1]};
        ${u} sourceLocG = coords;
        ++${h[l-2]};
        ${u} sourceLocA = coords;
        --${h[l-1]};
        ${u} sourceLocB = coords;
        --${h[l-2]};`;const f=["x","y","z","w","u","v"].slice(0,c),p="."+f[c-1],m=f.map(N=>"int "+N),g=ro("sourceLocR",c-1).concat("inIdx.r"),y=ro("sourceLocG",c-1).concat("inIdx.g"),v=ro("sourceLocB",c-1).concat("inIdx.b"),b=ro("sourceLocA",c-1).concat("inIdx.a"),w=n==="max"?"greaterThan":"lessThan",_=s?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${g.join()}),
                             getBestIndicesAChannel(${y.join()}),
                             getBestIndicesAChannel(${v.join()}),
                             getBestIndicesAChannel(${b.join()})));`,I=`vec4(
            getAChannel(${g.join()}),
            hasNextCol ? getAChannel(${y.join()}) : 0.,
            hasNextRow ? getAChannel(${v.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${b.join()}) : 0.)`,C=s?"":`
      float getBestIndicesAChannel(${m.join()}) {
        return getChannel(getBestIndicesA(${f.join()}),
                                          vec2(${f.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${m.join()}) {
        return getChannel(getA(${f.join()}),
                               vec2(${f.slice(-2).join()}));
      }
      ${C}
      void main() {
        ${u} coords = getOutputCoords();
        bool hasNextCol = ${h[l-1]} < ${i[l-1]-1};
        bool hasNextRow = ${h[l-2]} < ${i[l-2]-1};
        ${d}
        ivec4 srcIdx = ivec4(sourceLocR${p}, sourceLocG${p},
          sourceLocB${p}, sourceLocA${p}) * ${t};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${I};

        for (int i = 0; i < ${t}; i++) {
          inIdx = srcIdx;
          ${_}
          vec4 candidate = ${I};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${w}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pO(r,e,t,n=null){let s=e.shape[0],o=e.shape[1];n!=null&&(s=n.shape[0],o=n.shape[1]);const a=Q0(o),i={windowSize:a,inSize:o,batchSize:s,outSize:Math.ceil(o/a)},l=new Bie(i,t,n==null),u=[e];n!=null&&u.push(n);const h=r.runWebGLProgram(l,u,"int32");if(h.shape[1]===1)return h;const d=pO(r,e,t,h);return r.disposeIntermediateTensorInfo(h),d}function mO(r,e,t,n=null){const s=n!=null?n.shape:e.shape,o=s[s.length-1],a=Q0(o),i=new Uie(s,a,t,n==null),l=n==null?[e]:[e,n],u=r.runWebGLProgram(i,l,"int32");if(u.shape.length===e.shape.length){const h=mO(r,e,t,u);return r.disposeIntermediateTensorInfo(u),h}return u}function gO(r,e,t,n){const s=[t];if(Fs("arg"+n.charAt(0).toUpperCase()+n.slice(1),s,e.shape.length),!ut().getBool("WEBGL_PACK_REDUCE")||e.shape.length<=2){const o=[],a=r.texData.get(e.dataId),i=a!==null&&a.isPacked;let l=e;i&&(l=r.unpackTensor(e),o.push(l));const[u,h]=ks(l.shape,s),d=pt(h),c=Wt({inputs:{x:l},backend:r,attrs:{shape:[-1,d]}});o.push(c);const f=pO(r,c,n);o.push(f);const p=Wt({inputs:{x:f},backend:r,attrs:{shape:u}});return o.forEach(m=>r.disposeIntermediateTensorInfo(m)),p}return mO(r,e,n)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zie(r){const{inputs:e,backend:t,attrs:n}=r,{x:s}=e,{axis:o}=n;let a=Hn(o,s.shape);const i=qr(a,s.shape.length);let l=s;const u=[];i!=null&&(l=ao({inputs:{x:s},backend:t,attrs:{perm:i}}),u.push(l),a=ts(a.length,l.shape.length)),Fs("argMax",[a[0]],l.shape.length);const h=gO(t,l,a[0],"max");return u.forEach(d=>t.disposeIntermediateTensorInfo(d)),h}const Vie={kernelName:Uy,backendName:"webgl",kernelFunc:zie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gie(r){const{inputs:e,backend:t,attrs:n}=r,{x:s}=e,{axis:o}=n;let a=Hn(o,s.shape);const i=qr(a,s.shape.length);let l=s;const u=[];i!=null&&(l=ao({inputs:{x:s},backend:t,attrs:{perm:i}}),u.push(l),a=ts(a.length,l.shape.length)),Fs("argMin",[a[0]],l.shape.length);const h=gO(t,l,a[0],"min");return u.forEach(d=>t.disposeIntermediateTensorInfo(d)),h}const Wie={kernelName:zy,backendName:"webgl",kernelFunc:Gie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hie=Zi+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,qie=ar({opSnippet:Hie}),Xie={kernelName:Jf,backendName:"webgl",kernelFunc:qie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kie=Zi+"return log(x + sqrt(x * x + 1.0));",Yie=ar({opSnippet:Kie}),Zie={kernelName:ep,backendName:"webgl",kernelFunc:Yie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qie=Zi+`
  return atan(x);
`,Jie=ar({opSnippet:Qie}),eae={kernelName:tp,backendName:"webgl",kernelFunc:Jie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tae=ES+`
  return atan(a, b);
`,nae=`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+pm+`
  return result;
`,rae=Ls({opSnippet:tae,packedOpSnippet:nae}),sae={kernelName:rp,backendName:"webgl",kernelFunc:rae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oae=Zi+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,iae=ar({opSnippet:oae}),aae={kernelName:np,backendName:"webgl",kernelFunc:iae};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Of{constructor(e,t,n,s=!1,o=!1){if(this.variableNames=["x"],t==="avg"&&n)throw new Error("Cannot compute positions for average pool.");const a=e.filterWidth,i=e.strideHeight,l=e.strideWidth,u=e.dilationHeight,h=e.dilationWidth,d=e.effectiveFilterHeight,c=e.effectiveFilterWidth,f=e.padInfo.top,p=e.padInfo.left;this.outputShape=e.outShape;const m=t==="avg",g=`((batch  * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + d`,y=`(xR * ${e.inWidth} + xC) * ${e.inChannels} + d`;let v="0.0";if(m||(v="-1.0 / 1e-20"),n){const N=">=";this.userCode=`
        const ivec2 strides = ivec2(${i}, ${l});
        const ivec2 pads = ivec2(${f}, ${p});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${d};
              wR += ${u}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${c};
                wC += ${h}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value ${N} currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${s?o?g:y:`wR * ${c} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const b="max";let w=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;t==="avg"&&(w="avgValue / count");const _=Math.floor(a/4)*4,I=a%4,C=`
      if (${m}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${b}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${i}, ${l});
      const ivec2 pads = ivec2(${f}, ${p});
      const float initializationValue = ${v};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${v});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${d};
            wR += ${u}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${_}; wC += 4) {
            int xC = xCCorner + wC * ${h};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${h}, d),
              getValue(batch, xR, xC + 2 * ${h}, d),
              getValue(batch, xR, xC + 3 * ${h}, d)
            );

            ${C}
          }

          int xC = xCCorner + ${_};
          if (${I===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${C}
          } else if (${I===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${h}, d),
              initializationValue,
              initializationValue
            );

            ${C}
          } else if (${I===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${h}, d),
              getValue(batch, xR, xC + 2 * ${h}, d),
              initializationValue
            );

            ${C}
          }
        }
        setOutput(${w});
      }
    `}}class $S{constructor(e,t,n,s=!1,o=!1){if(this.variableNames=["x"],t==="avg"&&n)throw new Error("Cannot compute positions for average pool.");const a=e.filterWidth,i=e.strideDepth,l=e.strideHeight,u=e.strideWidth,h=e.dilationDepth,d=e.dilationHeight,c=e.dilationWidth,f=e.effectiveFilterDepth,p=e.effectiveFilterHeight,m=e.effectiveFilterWidth,g=e.padInfo.front,y=e.padInfo.top,v=e.padInfo.left;this.outputShape=e.outShape;const b=t==="avg";let w="0.0";if(b||(w="-1.0 / 1e-20"),n){const D=">=";this.userCode=`
        const ivec3 strides =
            ivec3(${i}, ${l}, ${u});
        const ivec3 pads = ivec3(${g}, ${y}, ${v});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${f};
              wD += ${h}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${e.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${p};
                wR += ${d}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${m};
                  wC += ${c}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value ${D} currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${s?o?`(((batch * ${e.inDepth} + xD) * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`((xD * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`wD * ${p} * ${m} +
                      wR * ${m} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const _="max";let I=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;t==="avg"&&(I="avgValue / count");const C=Math.floor(a/4)*4,N=a%4,O=`
      if (${b}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${_}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${i}, ${l}, ${u});
      const ivec3 pads = ivec3(${g}, ${y}, ${v});
      const float initializationValue = ${w};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${w});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${f};
            wD += ${h}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${p};
            wR += ${d}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${C}; wC += 4) {
              int xC = xCCorner + wC * ${c};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${c}, ch),
                getValue(batch, xD, xR, xC + 2 * ${c}, ch),
                getValue(batch, xD, xR, xC + 3 * ${c}, ch)
              );

              ${O}
            }

            int xC = xCCorner + ${C};
            if (${N===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${O}
            } else if (${N===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${c}, ch),
                initializationValue,
                initializationValue
              );

              ${O}
            } else if (${N===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${c}, ch),
                getValue(batch, xD, xR, xC + 2 * ${c}, ch),
                initializationValue
              );

              ${O}
            }
          }
          setOutput(${I});
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lae(r){const{inputs:e,backend:t,attrs:n}=r,{x:s}=e;dm(s,"avgPool");const{filterSize:o,strides:a,pad:i,dimRoundingMode:l}=n,u=1;xe(Ks(a,u),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${a} and dilations '${u}'`);const h=Xi(s.shape,o,a,u,i,l);if(h.filterWidth===1&&h.filterHeight===1&&ur(h.inShape,h.outShape))return Go({inputs:{x:s},backend:t});const d=new Of(h,"avg",!1);return t.runWebGLProgram(d,[s],"float32")}const uae={kernelName:Vy,backendName:"webgl",kernelFunc:lae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cae(r){const{inputs:e,backend:t,attrs:n}=r,{x:s}=e,{filterSize:o,strides:a,pad:i,dimRoundingMode:l,dataFormat:u}=n,h=[1,1,1],d=Al(s.shape,o,a,h,i,l,u),c=new $S(d,"avg",!1);return t.runWebGLProgram(c,[s],"float32")}const hae={kernelName:Gy,backendName:"webgl",kernelFunc:cae};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dae{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const t=e.filterHeight,n=e.filterWidth,s=e.strideHeight,o=e.strideWidth,a=e.dilationHeight,i=e.dilationWidth,l=e.effectiveFilterHeight,u=e.effectiveFilterWidth,h=l-1-e.padInfo.top,d=u-1-e.padInfo.left,c=1/(t*n);this.userCode=`
      const ivec2 pads = ivec2(${h}, ${d});
      const float avgMultiplier = float(${c});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${l};
            wR += ${a}) {
          float dyR = float(dyRCorner + wR) / ${s}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${u};
            wC+= ${i}) {
            float dyC = float(dyCCorner + wC) / ${o}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}}class fae{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const t=e.filterDepth,n=e.filterHeight,s=e.filterWidth,o=e.strideDepth,a=e.strideHeight,i=e.strideWidth,l=e.dilationDepth,u=e.dilationHeight,h=e.dilationWidth,d=e.effectiveFilterDepth,c=e.effectiveFilterHeight,f=e.effectiveFilterWidth,p=d-1-e.padInfo.front,m=c-1-e.padInfo.top,g=f-1-e.padInfo.left,y=1/(t*n*s);this.userCode=`
      const ivec3 pads = ivec3(${p}, ${m}, ${g});
      const float avgMultiplier = float(${y});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${d};
            wD += ${l}) {
          float dyD = float(dyDCorner + wD) / ${o}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${c};
              wR += ${u}) {
            float dyR = float(dyRCorner + wR) / ${a}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${f};
                wC += ${h}) {
              float dyC = float(dyCCorner + wC) / ${i}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pae(r){const{inputs:e,backend:t,attrs:n}=r,{dy:s,input:o}=e,a=o,{filterSize:i,strides:l,pad:u,dimRoundingMode:h}=n,d=[1,1,1],c=Al(a.shape,i,l,d,u,h),f=new fae(c);return t.runWebGLProgram(f,[s],a.dtype)}const mae={kernelName:Hx,backendName:"webgl",kernelFunc:pae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gae(r){const{inputs:e,backend:t,attrs:n}=r,{dy:s,input:o}=e,a=o;dm([s,o],"avgPoolGrad");const{filterSize:i,strides:l,pad:u}=n,h=Xi(a.shape,i,l,1,u),d=new dae(h);return t.runWebGLProgram(d,[s],a.dtype)}const yae={kernelName:Wx,backendName:"webgl",kernelFunc:gae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vae(r){const{inputs:e,backend:t,attrs:n}=r,{a:s,b:o}=e,{transposeA:a,transposeB:i}=n;return wy({a:s,b:o,transposeA:a,transposeB:i,backend:t})}const bae={kernelName:Wy,backendName:"webgl",kernelFunc:vae};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xae{constructor(e,t,n,s,o,a){this.outputShape=[],this.variableNames=["x","mean","variance"],Dn(e,t),Dn(e,n);let i="0.0";s!=null&&(Dn(e,s),this.variableNames.push("offset"),i="getOffsetAtOutCoords()");let l="1.0";o!=null&&(Dn(e,o),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${i};
        float scale = ${l};
        float inv = scale * inversesqrt(variance + float(${a}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wae{constructor(e,t,n,s,o,a){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],Dn(e,t),Dn(e,n);let i="vec4(0.0)";s!=null&&(Dn(e,s),this.variableNames.push("offset"),i="getOffsetAtOutCoords()");let l="vec4(1.0)";o!=null&&(Dn(e,o),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = ${i};
        vec4 scale = ${l};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${a}));

        setOutput((x - mean) * inv + offset);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sae=({inputs:r,backend:e,attrs:t})=>{const{x:n,mean:s,variance:o,offset:a,scale:i}=r;xe(s.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),xe(a==null||s.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),xe(i==null||s.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:l}=t;l==null&&(l=.001);const u=[n,s,o];let h=null;a!=null&&(h=a.shape,u.push(a));let d=null;i!=null&&(d=i.shape,u.push(i));const c=ut().getBool("WEBGL_PACK_NORMALIZATION")?new wae(n.shape,s.shape,o.shape,h,d,l):new xae(n.shape,s.shape,o.shape,h,d,l);return e.runWebGLProgram(c,u,u[0].dtype)},_ae={kernelName:r0,backendName:"webgl",kernelFunc:Sae};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Tae{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;const t=Dr(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const n=kae(this.rank);let s;const o=e.map((a,i)=>`sourceLoc.${Jb[i]} = start[${i}] + coords.${Jb[i]};`);s=`
        ${t} sourceLoc;
        ${t} coords = getOutputCoords();
        ${o.join(`
`)}
      `,this.userCode=`
      void main() {
        ${s}
        setOutput(getSource(${n}));
      }
    `}}const Jb=["x","y","z","w","u","v"];function kae(r){if(r===1)return"sourceLoc";if(r<=6)return Jb.slice(0,r).map(e=>"sourceLoc."+e).join(",");throw Error(`Slicing for rank ${r} is not yet supported`)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Iae{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const t=Dr(this.rank),n=ro("coords",this.rank),s=ro("sourceLoc",this.rank),o=this.rank===1?"sourceLoc":`vec2(${s.slice(-2).join()})`,a=`getChannel(getSource(${s.join()}), ${o})`,i=`
      result.x = ${a};
      if (++${n[this.rank-1]} < ${e[this.rank-1]}) {
        ++${s[this.rank-1]};
        result.y = ${a};
        --${s[this.rank-1]};
      }
    `,l=this.rank===1?"":`
      --${n[this.rank-1]};
      if (++${n[this.rank-2]} < ${e[this.rank-2]}) {
        ++${s[this.rank-2]};
        result.z = ${a};
        if (++${n[this.rank-1]} < ${e[this.rank-1]}) {
          ++${s[this.rank-1]};
          result.w = ${a};
        }
      }
    `,u=this.rank<=4?`sourceLoc = coords +
            ${t}(${e.map((h,d)=>`start[${d}]`).join()});`:e.map((h,d)=>`${s[d]} = ${n[d]} + start[${d}];`).join(`
`);this.userCode=`
      void main() {
        ${t} coords = getOutputCoords();
        ${t} sourceLoc;
        ${u}
        vec4 result = vec4(0.);
        ${i}
        ${l}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eae(r,e,t,n){const s=n.texData.get(r.dataId),o=n.makeTensorInfo(t,r.dtype),a=n.texData.get(o.dataId);Object.assign(a,s),a.refCount=1,a.shape=t,a.dtype=r.dtype;let i=Uw(e,pn(r.shape));s.slice&&(i+=s.slice.flatOffset),a.slice={flatOffset:i,origDataId:s.slice&&s.slice.origDataId||r.dataId};const l=n.dataRefCount.get(a.slice.origDataId)||1;return n.dataRefCount.set(a.slice.origDataId,l+1),o}function Dd(r){const{inputs:e,backend:t,attrs:n}=r,{x:s}=e,{begin:o,size:a}=n,[i,l]=G0(s,o,a);if(Pw(s,i,l),pt(l)===0)return t.makeTensorInfo(l,s.dtype,[]);if(t.shouldExecuteOnCPU([s])||s.dtype==="string"){const d=t.texData.get(s.dataId),c=xoe(d.values,i,l,s.shape,s.dtype);return t.makeTensorInfo(l,s.dtype,c)}const{isPacked:u}=t.texData.get(s.dataId),h=Bw(s.shape,i,l);if(u||!h){const d=ut().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Iae(l):new Tae(l),c=[i];return t.runWebGLProgram(d,[s],s.dtype,c)}return t.uploadToGPU(s.dataId),Eae(s,i,l,t)}const Cae={kernelName:R0,backendName:"webgl",kernelFunc:Dd};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $ae=r=>{const{inputs:e,backend:t,attrs:n}=r,{x:s}=e,{blockShape:o,crops:a}=n;xe(s.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const i=o.reduce((v,b)=>v*b),l=Qp(s.shape,o,i),u=Jp(l.length,o.length),h=em(s.shape,o,i),d=C2(a,o.length),c=$2(h,a,o.length),f=[],p=Wt({inputs:{x:s},backend:t,attrs:{shape:l}}),m=ao({inputs:{x:p},backend:t,attrs:{perm:u}}),g=Wt({inputs:{x:m},backend:t,attrs:{shape:h}}),y=Dd({inputs:{x:g},backend:t,attrs:{begin:d,size:c}});return f.push(p),f.push(m),f.push(g),f.forEach(v=>t.disposeIntermediateTensorInfo(v)),y},Nae={kernelName:Hy,backendName:"webgl",kernelFunc:$ae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Aae(r){const{inputs:e,backend:t,attrs:n}=r,{x:s,weights:o}=e,{size:a}=n,i=t.readSync(s.dataId),l=t.readSync(o.dataId),u=rO(i,l,o.dtype,o.shape,a);return t.makeTensorInfo([a],o.dtype,u)}const Rae={kernelName:qx,backendName:"webgl",kernelFunc:Aae};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dae(r){const{inputs:e,backend:t}=r,{s0:n,s1:s}=e,o=t.readSync(n.dataId),a=t.readSync(s.dataId),i=Dn(Array.from(o),Array.from(a));return t.makeTensorInfo([i.length],"int32",Int32Array.from(i))}const Oae={kernelName:TC,backendName:"webgl",kernelFunc:Dae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mae="return float(a != b);",yO=Ls({opSnippet:Mae,cpuKernelImpl:doe,dtype:"bool"}),Fae={kernelName:x0,backendName:"webgl",kernelFunc:yO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gm(r){const{inputs:e,backend:t}=r,{input:n}=e,s=t.texData.get(n.dataId);return Go({inputs:{x:s.complexTensorInfos.real},backend:t})}const Lae={kernelName:gw,backendName:"webgl",kernelFunc:gm};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pae="return float(int(x));";function jae(r,e){const t=new Tl(r.shape,Pae),n=e.runWebGLProgram(t,[r],"int32");return{dataId:n.dataId,shape:n.shape,dtype:n.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ex(r){const{inputs:e,backend:t,attrs:n}=r,{x:s}=e,{dtype:o}=n;if(o==="complex64"){if(s.dtype==="complex64")return Go({inputs:{x:s},backend:t});const a=Ss(s.shape),i=ex({inputs:{x:s},backend:t,attrs:{dtype:"float32"}}),l=Ou({inputs:{real:i,imag:a},backend:t});return a.dispose(),t.disposeIntermediateTensorInfo(i),l}if(s.dtype==="complex64"){const a=gm({inputs:{input:s},backend:t}),i=ex({inputs:{x:a},backend:t,attrs:{dtype:o}});return t.disposeIntermediateTensorInfo(a),i}if(!yC(s.dtype,o)){const a=Go({inputs:{x:s},backend:t});return{dataId:a.dataId,shape:a.shape,dtype:o}}if(t.shouldExecuteOnCPU([s])){const a=t.texData.get(s.dataId).values,[i,l,u]=Hse(a,s.shape,s.dtype,o);return t.makeTensorInfo(i,l,u)}if(o==="int32")return jae(s,t);if(o==="bool"){const a=t.makeTensorInfo([],"bool",Os("bool",1)),l=yO({inputs:{a:s,b:a},backend:t});return t.disposeIntermediateTensorInfo(a),l}throw new Error(`Error in Cast: failed to cast ${s.dtype} to ${o}`)}const Bae={kernelName:sp,backendName:"webgl",kernelFunc:ex};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QI="return ceil(x);",Uae=ar({opSnippet:QI,packedOpSnippet:QI,cpuKernelImpl:qse}),zae={kernelName:op,backendName:"webgl",kernelFunc:Uae};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Vae{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Gae{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wae(r){const{inputs:e,backend:t,attrs:n}=r,{x:s}=e,{clipValueMin:o,clipValueMax:a}=n;let i;ut().getBool("WEBGL_PACK_CLIP")?i=new Gae(s.shape):i=new Vae(s.shape);const l=[[o],[a]];return t.runWebGLProgram(i,[s],s.dtype,l)}const Hae={kernelName:ip,backendName:"webgl",kernelFunc:Wae};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qae{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JI(r,e){return{dataId:e.dataId,dtype:e.dtype,shape:r.shape}}function Xae(r){const{inputs:e,backend:t}=r,{x:n}=e,s=t.texData.get(n.dataId),o=new qae(n.shape),a=[JI(n,s.complexTensorInfos.real),JI(n,s.complexTensorInfos.imag)];return t.runWebGLProgram(o,a,a[0].dtype)}const Kae={kernelName:qy,backendName:"webgl",kernelFunc:Xae};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Yae{constructor(e){this.outputShape=[],this.outputShape=qa(e,1),this.variableNames=e.map((a,i)=>`T${i}`);const t=new Array(e.length-1);t[0]=e[0][1];for(let a=1;a<t.length;a++)t[a]=t[a-1]+e[a][1];const n=[`if (yC < ${t[0]}) setOutput(getT0(yR, yC));`];for(let a=1;a<t.length;a++){const i=t[a-1];n.push(`else if (yC < ${t[a]}) setOutput(getT${a}(yR, yC-${i}));`)}const s=t.length,o=t[t.length-1];n.push(`else setOutput(getT${s}(yR, yC-${o}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${n.join(`
        `)}
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Zae{constructor(e,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=qa(e,t);const n=this.outputShape,s=n.length,o=Dr(s),a=ro("coords",s),i=["x","y","z","w","u","v"].slice(0,s);this.variableNames=e.map((m,g)=>`T${g}`);const l=new Array(e.length-1);l[0]=e[0][t];for(let m=1;m<l.length;m++)l[m]=l[m-1]+e[m][t];const u=i[t],h=i.slice(-2),d=i.join();let c=`if (${u} < ${l[0]}) {
        return getChannel(
            getT0(${d}), vec2(${h.join()}));
        }`;for(let m=1;m<l.length;m++){const g=l[m-1];c+=`
        if (${u} < ${l[m]}  && ${u} >= ${l[m-1]}) {
          return getChannel(
            getT${m}(${Sg(i,u,g)}),
            vec2(${Sg(h,u,g)}));
        }`}const f=l.length,p=l[l.length-1];c+=`
        return getChannel(
          getT${f}(${Sg(i,u,p)}),
          vec2(${Sg(h,u,p)}));`,this.userCode=`
      float getValue(${i.map(m=>"int "+m)}) {
        ${c}
      }

      void main() {
        ${o} coords = getOutputCoords();
        vec4 result = vec4(getValue(${a}), 0., 0., 0.);

        ${a[s-1]} = ${a[s-1]} + 1;
        if (${a[s-1]} < ${n[s-1]}) {
          result.g = getValue(${a});
        }

        ${a[s-2]} = ${a[s-2]} + 1;
        if (${a[s-2]} < ${n[s-2]}) {
          result.a = getValue(${a});
        }

        ${a[s-1]} = ${a[s-1]} - 1;
        if (${a[s-2]} < ${n[s-2]} &&
            ${a[s-1]} < ${n[s-1]}) {
          result.b = getValue(${a});
        }
        setOutput(result);
      }
    `}}function Sg(r,e,t){const n=r.indexOf(e);return r.map((o,a)=>a===n?`${o} - ${t}`:o).join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y1(r){const{inputs:e,backend:t}=r,{input:n}=e,s=t.texData.get(n.dataId);return Go({inputs:{x:s.complexTensorInfos.imag},backend:t})}const Qae={kernelName:lw,backendName:"webgl",kernelFunc:y1};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ff(r,e,t){const n=r[0].dtype;if(n==="complex64"){const d=r.map(g=>gm({inputs:{input:g},backend:t})),c=r.map(g=>y1({inputs:{input:g},backend:t})),f=ff(d,e,t),p=ff(c,e,t),m=Ou({inputs:{real:f,imag:p},backend:t});return d.forEach(g=>t.disposeIntermediateTensorInfo(g)),c.forEach(g=>t.disposeIntermediateTensorInfo(g)),t.disposeIntermediateTensorInfo(f),t.disposeIntermediateTensorInfo(p),m}let s=t.shouldExecuteOnCPU(r);if(n==="string"&&(s=!0),s){const d=r.map(v=>{const b=pt(v.shape.slice(e));return Wt({inputs:{x:v},backend:t,attrs:{shape:[-1,b]}})}),c=d.map(v=>({vals:t.readSync(v.dataId),shape:v.shape})),f=qa(d.map(v=>v.shape),1),p=d[0].shape[0]===1,m=Xse(c,f,n,p),g=qa(r.map(v=>v.shape),e),y=t.makeTensorInfo(g,n,m);return d.forEach(v=>t.disposeIntermediateTensorInfo(v)),y}const o=ut().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(r.length>o){const d=[];for(let f=0;f<r.length;f+=o){const p=r.slice(f,f+o);d.push(ff(p,e,t))}const c=ff(d,e,t);for(const f of d)t.disposeIntermediateTensorInfo(f);return c}if(ut().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&r[0].shape.length>1){const d=new Zae(r.map(c=>c.shape),e);return t.runWebGLProgram(d,r,n)}const{tensors2D:a,outShape:i}=Jae(r,e,t),l=new Yae(a.map(d=>d.shape)),u=t.runWebGLProgram(l,a,n);a.forEach(d=>t.disposeIntermediateTensorInfo(d));const h=Wt({inputs:{x:u},attrs:{shape:i},backend:t});return t.disposeIntermediateTensorInfo(u),h}function Jae(r,e,t){const n=qa(r.map(o=>o.shape),e);return{tensors2D:r.map(o=>Wt({inputs:{x:o},attrs:{shape:[-1,pt(o.shape.slice(e))]},backend:t})),outShape:n}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vO(r){const{inputs:e,backend:t,attrs:n}=r,{axis:s}=n,o=Hn(s,e[0].shape)[0],a=e.map(u=>u.shape);k2(a,o);const i=qa(e.map(u=>u.shape),o);if(pt(i)===0)return t.makeTensorInfo(i,e[0].dtype,[]);const l=e.filter(u=>pt(u.shape)>0);return l.length===1?Go({inputs:{x:l[0]},backend:t}):ff(l,o,t)}const ele={kernelName:Xy,backendName:"webgl",kernelFunc:vO};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bO{constructor(e,t=!1,n=null,s=!1,o=!1){this.variableNames=["x","W"],this.outputShape=e.outShape;const a=e.padInfo.top,i=e.padInfo.left,l=e.strideHeight,u=e.strideWidth,h=e.dilationHeight,d=e.dilationWidth,c=e.filterHeight,f=e.filterWidth,p=Math.floor(e.inChannels/4)*4,m=e.inChannels%4,g=e.dataFormat==="channelsLast",y=g?1:2,v=g?2:3,b=g?3:1;let w="",_="";n&&(s?w=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${n}
        }`:o?w=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${n}
        }`:w=`
          float activation(float x) {
            ${n}
          }
        `,_="result = activation(result);");const I=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${w}

      const ivec2 strides = ivec2(${l}, ${u});
      const ivec2 pads = ivec2(${a}, ${i});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${b}];

        ivec2 xRCCorner =
            ivec2(coords[${y}], coords[${v}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${c}; wR++) {
          int xR = xRCorner + wR * ${h};

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${f}; wC++) {
            int xC = xCCorner + wC * ${d};

            if (xC < 0 || xC >= ${e.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${p}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${g}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${m===1}) {

              if (${g}) {
                dotProd +=
                    getX(batch, xR, xC, ${p}) *
                    getW(wR, wC, ${p}, d2);
              } else {
                dotProd +=
                    getX(batch, ${p}, xR, xC) *
                    getW(wR, wC, ${p}, d2);
              }

            } else if (${m===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${p}, d2),
                getW(wR, wC, ${p} + 1, d2)
              );

              if (${g}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${p}),
                  getX(batch, xR, xC, ${p} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${p}, xR, xC),
                  getX(batch, ${p} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${m===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${p}, d2),
                getW(wR, wC, ${p} + 1, d2),
                getW(wR, wC, ${p} + 2, d2)
              );

              if (${g}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${p}),
                  getX(batch, xR, xC, ${p} + 1),
                  getX(batch, xR, xC, ${p} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${p}, xR, xC),
                  getX(batch, ${p} + 1, xR, xC),
                  getX(batch, ${p} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${I}
        ${_}
        setOutput(result);
      }
    `}}class tle{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const t=e.padInfo.front,n=e.padInfo.top,s=e.padInfo.left,o=e.strideDepth,a=e.strideHeight,i=e.strideWidth,l=e.dilationDepth,u=e.dilationHeight,h=e.dilationWidth,d=e.filterDepth,c=e.filterHeight,f=e.filterWidth,p=Math.floor(e.inChannels/4)*4,m=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${o}, ${a}, ${i});
      const ivec3 pads = ivec3(${t}, ${n}, ${s});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${d}; wF++) {
          int xF = xFCorner + wF * ${l};

          if (xF < 0 || xF >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${c}; wR++) {
            int xR = xRCorner + wR * ${u};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${f}; wC++) {
              int xC = xCCorner + wC * ${h};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${p}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${m===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${p}) *
                  getW(wF, wR, wC, ${p}, d2);
              } else if (${m===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${p}),
                  getX(batch, xF, xR, xC, ${p} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${p}, d2),
                  getW(wF, wR, wC, ${p} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${m===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${p}),
                  getX(batch, xF, xR, xC, ${p} + 1),
                  getX(batch, xF, xR, xC, ${p} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${p}, d2),
                  getW(wF, wR, wC, ${p} + 1, d2),
                  getW(wF, wR, wC, ${p} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xO{constructor(e,t=!1,n=null,s=!1,o=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=uo(this.outputShape.length);const a=e.padInfo.left,i=e.strideWidth,l=e.dilationWidth,u=e.filterHeight,h=e.filterWidth,d=h;let c=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let g=0;g<h;g++)c+=`
           vec4 xTexelC${g*2};
           int xTexelC${g*2}Ready;
           vec4 xTexelC${g*2+1};
           int xTexelC${g*2+1}Ready;
           vec4 xC${g};`;c+=`
     for (int r = 0; r < ${u}; r++) {
      for (int d1 = 0; d1 < ${e.inChannels}; d1 += 2) {
       `;for(let g=0;g<h;g++)c+=`
           xTexelC${g*2} = vec4(0.0);
           xTexelC${g*2}Ready = 0;
           xTexelC${g*2+1} = vec4(0.0);
           xTexelC${g*2+1}Ready = 0;
           xC${g} = vec4(0.0);`;c+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let g=0;g<(d+1)/2;g++){const y=g*2;if(c+=`
           xC = xCCorner + ${y*l};
           `,i===1){if(y<h&&(a%2===1?(c+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y}Ready == 0) {
                   xTexelC${y} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${y}.zw = vec2(0.0);
                   }
                   xTexelC${y}Ready = 1;
                 }
               `,l===1&&y>0?c+=`
                 xC${y} = vec4(xTexelC${y-2}.zw, xTexelC${y}.xy);
                 `:c+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${y} = vec4(previous.zw, xTexelC${y}.xy);
                   } else {
                     xC${y} = vec4(0.0, 0.0, xTexelC${y}.xy);
                   }
                   `):c+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${y}Ready == 0) {
                   xTexelC${y} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${y}.zw = vec2(0.0);
                   }
                   xTexelC${y}Ready = 1;
                 }

                 xC${y} = xTexelC${y};
                 `,y+1<h)){const v=a%2===0?jx(l):l;l%2===0&&a%2===1||l%2!==0&&a%2!==1?(c+=`
                   xCOffset = xC + imod(pads[1], 2) + ${v};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                     xTexelC${y+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${y+1}.zw = vec2(0.0);
                     }
                     xTexelC${y+1}Ready = 1;
                   }
                   `,l>1?c+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${y+1} = vec4(previous.zw, xTexelC${y+1}.xy);
                     } else {
                      xC${y+1} = vec4(0.0, 0.0, xTexelC${y+1}.xy);
                     }
                     `:c+=`
                     xC${y+1} = vec4(xTexelC${y}.zw, xTexelC${y+1}.xy);
                     `):v===1?c+=`
                     xC${y+1} = xTexelC${y};
                     `:c+=`
                     xCOffset = xC + ${v};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                       xTexelC${y+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${y+1}.zw = vec2(0.0);
                       }
                       xTexelC${y+1}Ready = 1;
                     }

                     xC${y+1} = xTexelC${y+1};
                     `}}else y<h&&(a%2===1?(c+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y}Ready == 0) {
                   xTexelC${y} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${y}.zw = vec2(0.0);
                   }
                   xTexelC${y}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${y+1}Ready == 0) {
                   xTexelC${y+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${y+1}.zw = vec2(0.0);
                   }
                   xTexelC${y+1}Ready = 1;
                 }

                 xC${y} = vec4(xTexelC${y}.zw, xTexelC${y+1}.zw);
               `,y+1<h&&(c+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${y+1} = vec4(xTexelC${y+1}.xy, final.xy);
                 `)):(c+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${y}Ready == 0) {
                   xTexelC${y} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${y}.zw = vec2(0.0);
                   }
                   xTexelC${y}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                   xTexelC${y+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${y+1}.zw = vec2(0.);
                   }
                   xTexelC${y+1}Ready = 1;
                 }

                 xC${y} = vec4(
                   xTexelC${y}.xy, xTexelC${y+1}.xy);
               `,y+1<h&&(c+=`
                   xC${y+1} = vec4(xTexelC${y}.zw, xTexelC${y+1}.zw);
                 `)));y<h&&(c+=`
             wTexel = getW(r, ${y}, d1, d2);
             dotProd += xC${y}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${e.inChannels}) {
               dotProd += xC${y}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,y+1<h&&(c+=`
               wTexel = getW(r, ${y+1}, d1, d2);
               dotProd += xC${y+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${e.inChannels}) {
                 dotProd += xC${y+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}c+=`
     }
   `,c+=`
     }
   `,c+=`
     }
   `;let f="",p="";n&&(s?f=`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${n}
         }`:o?f=`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${n}
         }`:f=`vec4 activation(vec4 x) {
           ${n}
         }`,p="result = activation(result);");const m=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       ${f}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${c}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${m}
         ${p}
         setOutput(result);
       }
     `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nle{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=uo(this.outputShape.length);const{dataFormat:n}=t,s=lo(),o=n==="channelsLast",a=o?1:2,i=o?2:3,l=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${e[2]} && pos < ${e[1]}) {`;let u="";for(let h=0;h<=1;h++)for(let d=0;d<=1;d++)u+=`
          blockIndex = rc.z + ${d};
          pos = rc.y + ${h};

          ${l}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${a}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${i}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${o}) {
                  innerDims = vec2(d1, ch);
                  result[${h*2+d}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${h*2+d}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${u}

        ${s.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sy(r,e){const t=r.length;return t>=3?e?[...r.slice(0,-3),r[t-3]*r[t-2],r[t-1]]:[...r.slice(0,-3),r[t-3],r[t-2]*r[t-1]]:!e&&t===1&&r[0]>1?[r[0],1]:null}function wO({x:r,filter:e,convInfo:t,backend:n,bias:s=null,preluActivationWeights:o=null,leakyreluAlpha:a=0,activation:i=null}){const l=r.shape,u=n.texData.get(r.dataId),h=t.inChannels,d=l[0]*l[1]*l[2],c=t.outChannels,f=t.dataFormat==="channelsLast",p=!1,m=!1;let g;const y=[];if(o!=null){const w=Sy(o.shape,f);w!=null&&(o=Wt({inputs:{x:o},backend:n,attrs:{shape:w}}),y.push(o))}if(s!=null){const w=Sy(s.shape,f);w!=null&&(s=Wt({inputs:{x:s},backend:n,attrs:{shape:w}}),y.push(s))}if(!((d===1||c===1)&&h>fO)&&u.isPacked&&f&&u.texture!=null&&l[2]%2!==0&&ur(u.shape.slice(-3),l.slice(-3))){const w=l[0]*l[1]*(l[2]+1),_={dataId:r.dataId,shape:[1,w,t.inChannels],dtype:r.dtype},I=u.shape;u.shape=u.shape.slice(),u.shape[u.shape.length-2]++,xe(xy(u.shape,_.shape),()=>`packed reshape ${u.shape} to ${_.shape} isn't free`);const C=Wt({inputs:{x:e},backend:n,attrs:{shape:[1,t.inChannels,t.outChannels]}});y.push(C);const N=wy({a:_,b:C,backend:n,transposeA:p,transposeB:m,bias:s,activation:i,preluActivationWeights:o,leakyreluAlpha:a}),O=n.texData.get(N.dataId);xe(O.isPacked,()=>"batchMatMul result is expected to be packed"),u.shape=I,O.shape=t.outShape,g=Go({inputs:{x:N},backend:n}),g.shape=t.outShape,y.push(N)}else{const w=t.outHeight*t.outWidth,_=Wt({inputs:{x:r},backend:n,attrs:{shape:f?[t.batchSize,w,t.inChannels]:[t.batchSize,t.inChannels,w]}}),I=Wt({inputs:{x:e},backend:n,attrs:{shape:[1,t.inChannels,t.outChannels]}}),C=wy({a:f?_:I,b:f?I:_,transposeA:!f,transposeB:m,backend:n,bias:s,activation:i,preluActivationWeights:o,leakyreluAlpha:a});g=Wt({inputs:{x:C},backend:n,attrs:{shape:t.outShape}}),y.push(_),y.push(I),y.push(C)}for(const w of y)n.disposeIntermediateTensorInfo(w);return g}function SO({x:r,filter:e,convInfo:t,backend:n,bias:s=null,preluActivationWeights:o=null,leakyreluAlpha:a=0,activation:i=null}){const{filterWidth:l,filterHeight:u,inChannels:h,outWidth:d,outHeight:c,dataFormat:f}=t,p=f==="channelsLast",m=l*u*h,g=c*d,y=[t.batchSize,m,g],v=!0,b=!1,w=[];if(o!=null){const K=Sy(o.shape,p);K!=null&&(o=Wt({inputs:{x:o},backend:n,attrs:{shape:K}}),w.push(o))}if(s!=null){const K=Sy(s.shape,p);K!=null&&(s=Wt({inputs:{x:s},backend:n,attrs:{shape:K}}),w.push(s))}const _=Wt({inputs:{x:e},backend:n,attrs:{shape:[1,m,pt(e.shape)/m]}});w.push(_);const I=new nle(y,t),C=[r.shape,[t.padInfo.top,t.padInfo.left],[t.strideHeight,t.strideWidth],[t.dilationHeight,t.dilationWidth],[t.inChannels],[t.filterWidth*t.inChannels],[t.outWidth]],N=n.runWebGLProgram(I,[r],"float32",C),O=Wt({inputs:{x:N},backend:n,attrs:{shape:y}});w.push(N),w.push(O);const D=s!=null,M=o!=null,P=i==="leakyrelu",F=i?Df(i,!0):null,B=new dO(p?O.shape:_.shape,p?_.shape:O.shape,p?[t.batchSize,g,t.outChannels]:[t.batchSize,t.outChannels,g],v,b,D,F,M,P),z=p?[O,_]:[_,O];if(s&&z.push(s),M&&z.push(o),P){const K=n.makeTensorInfo([],"float32",ku(a,"float32"));z.push(K),w.push(K)}const Z=n.runWebGLProgram(B,z,"float32"),Q=Wt({inputs:{x:Z},backend:n,attrs:{shape:t.outShape}});w.push(Z);for(const K of w)n.disposeIntermediateTensorInfo(K);return Q}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rle(r){const{inputs:e,backend:t,attrs:n}=r,{x:s,filter:o}=e,{strides:a,pad:i,dataFormat:l,dilations:u,dimRoundingMode:h}=n,d=Rl(l),c=Ms(s.shape,o.shape,a,u,i,h,!1,d);let f;if(c.filterHeight===1&&c.filterWidth===1&&c.dilationHeight===1&&c.dilationWidth===1&&c.strideHeight===1&&c.strideWidth===1&&(c.padInfo.type==="SAME"||c.padInfo.type==="VALID"))f=wO({x:s,filter:o,convInfo:c,backend:t});else if(c.strideWidth<=2&&d==="channelsLast"&&ut().getBool("WEBGL_EXP_CONV")){const m=new xO(c),g=[[c.padInfo.top,c.padInfo.left],[c.strideHeight,c.strideWidth],[c.dilationHeight,c.dilationWidth],[c.inHeight,c.inWidth]];f=t.runWebGLProgram(m,[s,o],"float32",g)}else if(ut().getBool("WEBGL_CONV_IM2COL"))f=SO({x:s,filter:o,convInfo:c,backend:t});else{const m=new bO(c);f=t.runWebGLProgram(m,[s,o],"float32")}const p=Wt({inputs:{x:f},backend:t,attrs:{shape:c.outShape}});return t.disposeIntermediateTensorInfo(f),p}const sle={kernelName:Ky,backendName:"webgl",kernelFunc:rle};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ole{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideHeight,n=e.strideWidth,s=e.padInfo.top,o=e.padInfo.left,a=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${t} - ${s};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${n} - ${o};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              if (${a}) {
                float dyValue = getDy(b, yR, yC, d2);
                float xValue = getX(b, xR, xC, d1);
                dotProd += (xValue * dyValue);
              } else {
                float dyValue = getDy(b, d2, yR, yC);
                float xValue = getX(b, d1, xR, xC);
                dotProd += (xValue * dyValue);
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class ile{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterHeight,n=e.filterWidth,s=e.strideHeight,o=e.strideWidth,a=e.dataFormat==="channelsLast",i=t-1-e.padInfo.top,l=n-1-e.padInfo.left,u=a?1:2,h=a?2:3,d=a?3:1;this.userCode=`
      const ivec2 pads = ivec2(${i}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${d}];

        ivec2 dyCorner = ivec2(coords[${u}], coords[${h}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${t}; wR++) {
          float dyR = float(dyRCorner + wR) / ${s}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${t} - 1 - wR;

          for (int wC = 0; wC < ${n}; wC++) {
            float dyC = float(dyCCorner + wC) / ${o}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${n} - 1 - wC;

            for (int d2 = 0; d2 < ${e.outChannels}; d2++) {

              if (${a}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class ale{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideDepth,n=e.strideHeight,s=e.strideWidth,o=e.padInfo.front,a=e.padInfo.top,i=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yF = 0; yF < ${e.outDepth}; yF++) {
            int xF = wF + yF * ${t} - ${o};

            if (xF < 0 || xF >= ${e.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${e.outHeight}; yR++) {
              int xR = wR + yR * ${n} - ${a};

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${e.outWidth}; yC++) {
                int xC = wC + yC * ${s} - ${i};

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class lle{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterDepth,n=e.filterHeight,s=e.filterWidth,o=e.strideDepth,a=e.strideHeight,i=e.strideWidth,l=t-1-e.padInfo.front,u=n-1-e.padInfo.top,h=s-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${l}, ${u}, ${h});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${t}; wF++) {
          float dyF = float(dyFCorner + wF) / ${o}.0;

          if (dyF < 0.0 || dyF >= ${e.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${t} - 1 - wF;

          for (int wR = 0; wR < ${n}; wR++) {
            float dyR = float(dyRCorner + wR) / ${a}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${n} - 1 - wR;

            for (int wC = 0; wC < ${s}; wC++) {
              float dyC = float(dyCCorner + wC) / ${i}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${s} - 1 - wC;

              for (int d2 = 0; d2 < ${e.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ule(r){const{inputs:e,backend:t,attrs:n}=r,{x:s,dy:o}=e,{strides:a,pad:i,dataFormat:l,dimRoundingMode:u,filterShape:h}=n,d=Rl(l),c=Ms(s.shape,h,a,1,i,u,!1,d),f=new ole(c);return t.runWebGLProgram(f,[s,o],"float32")}const cle={kernelName:Kx,backendName:"webgl",kernelFunc:ule};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hle(r){const{inputs:e,backend:t,attrs:n}=r,{dy:s,filter:o}=e,{inputShape:a,strides:i,pad:l,dataFormat:u,dimRoundingMode:h}=n,d=Rl(u),c=Ms(a,o.shape,i,1,l,h,!1,d),f=new ile(c);return t.runWebGLProgram(f,[s,o],"float32")}const dle={kernelName:Yy,backendName:"webgl",kernelFunc:hle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fle(r){const{inputs:e,backend:t,attrs:n}=r,{x:s,filter:o}=e,{strides:a,pad:i,dilations:l}=n,u=Iu(s.shape,o.shape,a,l,i),h=new tle(u);return t.runWebGLProgram(h,[s,o],"float32")}const ple={kernelName:Zy,backendName:"webgl",kernelFunc:fle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mle(r){const{inputs:e,backend:t,attrs:n}=r,{x:s,dy:o}=e,{strides:a,pad:i,filterShape:l}=n,u=Iu(s.shape,l,a,1,i),h=new ale(u);return t.runWebGLProgram(h,[s,o],"float32")}const gle={kernelName:Yx,backendName:"webgl",kernelFunc:mle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yle(r){const{inputs:e,backend:t,attrs:n}=r,{dy:s,filter:o}=e,{pad:a,strides:i,inputShape:l}=n,u=Iu(l,o.shape,i,1,a),h=new lle(u);return t.runWebGLProgram(h,[s,o],"float32")}const vle={kernelName:Zx,backendName:"webgl",kernelFunc:yle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ble=Rd+`
  return cos(x);
`,xle=ar({opSnippet:ble}),wle={kernelName:ap,backendName:"webgl",kernelFunc:xle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sle=`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`,_le=ar({opSnippet:Sle}),Tle={kernelName:lp,backendName:"webgl",kernelFunc:_le};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kle{constructor(e,t,n,s,o){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[a,i,l,u]=e,[h]=t,[d,c]=n;this.outputShape=[h,d,c,u];const f=s==="bilinear"?1:0,[p,m]=[`${i-1}.0`,`${l-1}.0`],[g,y,v]=d>1?[`${(i-1)/(d-1)}`,"(y2-y1) * height_ratio",`y1*${p} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${p}`],[b,w,_]=c>1?[`${(l-1)/(c-1)}`,"(x2-x1) * width_ratio",`x1*${m} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${m}`];this.userCode=`
      const float height_ratio = float(${g});
      const float width_ratio = float(${b});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${a}) {
          return;
        }

        float height_scale = ${y};
        float width_scale = ${w};

        float in_y = ${v};
        if( in_y < 0.0 || in_y > ${p} ) {
          setOutput(float(${o}));
          return;
        }
        float in_x = ${_};
        if( in_x < 0.0 || in_x > ${m} ) {
          setOutput(float(${o}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${f} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ile=r=>{const{inputs:e,backend:t,attrs:n}=r,{image:s,boxes:o,boxInd:a}=e,{cropSize:i,method:l,extrapolationValue:u}=n,h=new kle(s.shape,o.shape,i,l,u);return t.runWebGLProgram(h,[s,o,a],"float32")},Ele={kernelName:Jx,backendName:"webgl",kernelFunc:Ile};var Mf;(function(r){r.Prod="*",r.Sum="+"})(Mf||(Mf={}));class eE{constructor(e,t,n,s){this.op=e,this.outputShape=t,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const o=this.outputShape.length,a=this.op===Mf.Prod?"1.0":"0.0",i=n?a:`getX(${tE(o,"coords",this.op)})`,l=this.outputShape[this.outputShape.length-1];let u="",h="";n?(u=s?`end != ${l-1}`:"end != 0",h=s?"end + 1":"end - 1"):(u=s?`end + pow2 < ${l}`:"end >= pow2",h=s?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${Dr(o)} coords = getOutputCoords();
        int end = ${nE(o,"coords",this.op)};
        float val = ${i};
        int pow2 = int(pow(2.0, index));
        if (${u}) {
          int idx = ${h};
          ${nE(o,"coords",this.op)} = idx;
          val ${this.op}= getX(${tE(o,"coords",this.op)});
        }
        setOutput(val);
      }
    `}}function tE(r,e,t){if(r===1)return`${e}`;if(r===2)return`${e}.x, ${e}.y`;if(r===3)return`${e}.x, ${e}.y, ${e}.z`;if(r===4)return`${e}.x, ${e}.y, ${e}.z, ${e}.w`;throw new Error(`Cumulative ${t} for rank ${r} is not yet supported`)}function nE(r,e,t){if(r===1)return`${e}`;if(r===2)return`${e}.y`;if(r===3)return`${e}.z`;if(r===4)return`${e}.w`;throw new Error(`Cumulative ${t} for rank ${r} is not yet supported`)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _O(r,e,t,n,s,o){const a=e.shape.length,i=qr([n],a);let l=e;i!=null&&(l=ao({inputs:{x:e},backend:t,attrs:{perm:i}}));const u=ts(1,a)[0];if(u!==a-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${e.shape.length-1} but got axis=${n}`);const h=l.shape[u];let d=Go({inputs:{x:l},backend:t});for(let c=0;c<=Math.ceil(Math.log2(h))-1;c++){const f=new eE(r,l.shape,!1,o),p=[[c]],m=d;d=t.runWebGLProgram(f,[d],d.dtype,p),t.disposeIntermediateTensorInfo(m)}if(s){const c=new eE(r,l.shape,s,o),f=d;d=t.runWebGLProgram(c,[d],d.dtype),t.disposeIntermediateTensorInfo(f)}if(i!=null){const c=Eu(i),f=ao({inputs:{x:d},backend:t,attrs:{perm:c}});return t.disposeIntermediateTensorInfo(d),t.disposeIntermediateTensorInfo(l),f}return d}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cle(r){const{inputs:e,backend:t,attrs:n}=r,{x:s}=e,{axis:o,exclusive:a,reverse:i}=n;return _O(Mf.Prod,s,t,o,a,i)}const $le={kernelName:Qx,backendName:"webgl",kernelFunc:Cle};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nle(r){const{inputs:e,backend:t,attrs:n}=r,{x:s}=e,{axis:o,exclusive:a,reverse:i}=n;return _O(Mf.Sum,s,t,o,a,i)}const Ale={kernelName:Qy,backendName:"webgl",kernelFunc:Nle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rle(r){const{inputs:e,backend:t,attrs:n}=r,{x:s,weights:o}=e,{size:a,binaryOutput:i}=n;if(s.shape.length===1){const l=t.readSync(s.dataId),u=t.readSync(o.dataId),h=rO(l,u,o.dtype,o.shape,a);return t.makeTensorInfo([a],o.dtype,h)}else if(s.shape.length===2){const l=t.bufferSync(s),u=t.bufferSync(o),h=Wse(l,u,a,i);return t.makeTensorInfo(h.shape,o.dtype,h.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${s.shape.length}.`)}const Dle={kernelName:kC,backendName:"webgl",kernelFunc:Rle};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ole{constructor(e,t,n){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=t,this.dataFormat=n,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${t};
      int offset_h = imod(h, ${t});
      int in_w = w / ${t};
      int offset_w = imod(w, ${t});
      int offset_d = (offset_h * ${t} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mle(r){const{inputs:e,backend:t,attrs:n}=r,{x:s}=e,{blockSize:o,dataFormat:a}=n,i=s.shape[0],l=a==="NHWC"?s.shape[1]:s.shape[2],u=a==="NHWC"?s.shape[2]:s.shape[3],h=a==="NHWC"?s.shape[3]:s.shape[1],d=l*o,c=u*o,f=h/(o*o),p=a==="NHWC"?[i,d,c,f]:[i,f,d,c],m=new Ole(p,o,a);return t.runWebGLProgram(m,[s],s.dtype)}const Fle={kernelName:ew,backendName:"webgl",kernelFunc:Mle};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class TO{constructor(e,t=!1,n=null,s=!1,o=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=uo(this.outputShape.length);const a=e.filterHeight,i=e.filterWidth,l=e.outChannels/e.inChannels;let u="",h="";n&&(s?u=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${n}
        }`:o?u=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${n}
        }`:u=`
          float activation(float x) {
            ${n}
          }
        `,h="result = activation(result);");const d=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${u}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${l};
        int q = d2 - d1 * ${l};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${a}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${i}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${d}
        ${h}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kO{constructor(e,t=!1,n=null,s=!1,o=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=uo(this.outputShape.length);const a=e.outChannels/e.inChannels,i=e.padInfo.left,l=e.strideWidth,u=e.dilationWidth,h=e.filterHeight,d=e.filterWidth,c=d;let f=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let y=0;y<d;y++)f+=`
          vec4 xTexelC${y*2};
          int xTexelC${y*2}Ready;
          vec4 xTexelC${y*2+1};
          int xTexelC${y*2+1}Ready;
          vec4 xC${y};`;f+=`
    for (int r = 0; r < ${h}; r++) {
      `;for(let y=0;y<d;y++)f+=`
          xTexelC${y*2} = vec4(0.0);
          xTexelC${y*2}Ready = 0;
          xTexelC${y*2+1} = vec4(0.0);
          xTexelC${y*2+1}Ready = 0;
          xC${y} = vec4(0.0);`;f+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let y=0;y<(c+1)/2;y++){const v=y*2;if(f+=`
          xC = xCCorner + ${v*u};
          `,l===1){if(v<d&&(i%2===1?(f+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v}Ready == 0) {
                  xTexelC${v} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${v}.zw = vec2(0.0);
                  }
                  xTexelC${v}Ready = 1;
                }
              `,u===1&&v>0?f+=`
                xC${v} = vec4(xTexelC${v-2}.zw, xTexelC${v}.xy);
                `:f+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${v} = vec4(previous.zw, xTexelC${v}.xy);
                  } else {
                    xC${v} = vec4(0.0, 0.0, xTexelC${v}.xy);
                  }
                  `):f+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${v}Ready == 0) {
                  xTexelC${v} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${v}.zw = vec2(0.0);
                  }
                  xTexelC${v}Ready = 1;
                }

                xC${v} = xTexelC${v};
                `,v+1<d)){const b=i%2===0?jx(u):u;u%2===0&&i%2===1||u%2!==0&&i%2!==1?(f+=`
                  xCOffset = xC + imod(pads[1], 2) + ${b};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v+1}Ready == 0) {
                    xTexelC${v+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${v+1}.zw = vec2(0.0);
                    }
                    xTexelC${v+1}Ready = 1;
                  }
                  `,u>1?f+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${v+1} = vec4(previous.zw, xTexelC${v+1}.xy);
                    } else {
                     xC${v+1} = vec4(0.0, 0.0, xTexelC${v+1}.xy);
                    }
                    `:f+=`
                    xC${v+1} = vec4(xTexelC${v}.zw, xTexelC${v+1}.xy);
                    `):b===1?f+=`
                    xC${v+1} = xTexelC${v};
                    `:f+=`
                    xCOffset = xC + ${b};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v+1}Ready == 0) {
                      xTexelC${v+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${v+1}.zw = vec2(0.0);
                      }
                      xTexelC${v+1}Ready = 1;
                    }

                    xC${v+1} = xTexelC${v+1};
                    `}}else v<d&&(i%2===1?(f+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v}Ready == 0) {
                  xTexelC${v} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${v}.zw = vec2(0.0);
                  }
                  xTexelC${v}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${v+1}Ready == 0) {
                  xTexelC${v+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${v+1}.zw = vec2(0.0);
                  }
                  xTexelC${v+1}Ready = 1;
                }

                xC${v} = vec4(xTexelC${v}.zw, xTexelC${v+1}.zw);
              `,v+1<d&&(f+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${v+1} = vec4(xTexelC${v+1}.xy, final.xy);
                `)):(f+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${v}Ready == 0) {
                  xTexelC${v} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${v}.zw = vec2(0.0);
                  }
                  xTexelC${v}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v+1}Ready == 0) {
                  xTexelC${v+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${v+1}.zw = vec2(0.);
                  }
                  xTexelC${v+1}Ready = 1;
                }

                xC${v} = vec4(
                  xTexelC${v}.xy, xTexelC${v+1}.xy);
              `,v+1<d&&(f+=`
                  xC${v+1} = vec4(xTexelC${v}.zw, xTexelC${v+1}.zw);
                `)));v<d&&(f+=`
            wTexel = getW(r, ${v}, d1, q);
            dotProd += xC${v} * vec4(wTexel.xz, wTexel.xz);
          `,v+1<d&&(f+=`
              wTexel = getW(r, ${v+1}, d1, q);
              dotProd += xC${v+1} * vec4(wTexel.xz, wTexel.xz);
            `))}f+=`
    }
  `,f+=`
      }
    `;let p="",m="";n&&(s?p=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${n}
        }`:o?p=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${n}
        }`:p=`vec4 activation(vec4 x) {
          ${n}
        }`,m="result = activation(result);");const g=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${p}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${a};
        int q = d2 - d1 * ${a};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${f}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${g}
        ${m}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lle(r){const{inputs:e,backend:t,attrs:n}=r,{x:s,filter:o}=e,{strides:a,pad:i,dilations:l,dimRoundingMode:u}=n;let h=l;h==null&&(h=[1,1]),xe(Ks(a,h),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${a} and dilations '${h}'`);const d=Ms(s.shape,o.shape,a,h,i,u,!0);let c;ut().getBool("WEBGL_PACK_DEPTHWISECONV")&&d.strideWidth<=2&&d.outChannels/d.inChannels===1?c=new kO(d):c=new TO(d);const f=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];return t.runWebGLProgram(c,[s,o],"float32",f)}const Ple={kernelName:Jy,backendName:"webgl",kernelFunc:Lle};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jle{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideHeight,n=e.strideWidth,s=e.padInfo.top,o=e.padInfo.left,a=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${a} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${t} - ${s};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${n} - ${o};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class Ble{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterHeight,n=e.filterWidth,s=e.strideHeight,o=e.strideWidth,a=t-1-e.padInfo.top,i=n-1-e.padInfo.left,l=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${i});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${t}; wR++) {
          float dyR = float(dyRCorner + wR) / ${s}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${t} - 1 - wR;

          for (int wC = 0; wC < ${n}; wC++) {
            float dyC = float(dyCCorner + wC) / ${o}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${n} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${l}; dm++) {
              int d2 = d1 * ${l} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ule(r){const{inputs:e,backend:t,attrs:n}=r,{x:s,dy:o}=e,{strides:a,dilations:i,pad:l,dimRoundingMode:u,filterShape:h}=n,d=Ms(s.shape,h,a,i,l,u,!0),c=new jle(d);return t.runWebGLProgram(c,[s,o],"float32")}const zle={kernelName:tw,backendName:"webgl",kernelFunc:Ule};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vle(r){const{inputs:e,backend:t,attrs:n}=r,{dy:s,filter:o}=e,{strides:a,dilations:i,pad:l,dimRoundingMode:u,inputShape:h}=n,d=Ms(h,o.shape,a,i,l,u,!0),c=new Ble(d);return t.runWebGLProgram(c,[s,o],"float32")}const Gle={kernelName:nw,backendName:"webgl",kernelFunc:Vle};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Wle{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hle(r){const{inputs:e,backend:t}=r,{x:n}=e,s=[...n.shape,...n.shape],o=pt(n.shape),a=Wt({inputs:{x:n},backend:t,attrs:{shape:[o]}}),i=new Wle(o),l=t.runWebGLProgram(i,[a],a.dtype),u=Wt({inputs:{x:l},backend:t,attrs:{shape:s}});return t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(l),u}const qle={kernelName:IC,backendName:"webgl",kernelFunc:Hle};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Xle{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const{inHeight:t,inWidth:n,padInfo:s,strideHeight:o,strideWidth:a,filterHeight:i,filterWidth:l,dilationHeight:u,dilationWidth:h}=e,{top:d,left:c}=s;this.userCode=`
      const ivec2 strides = ivec2(${o}, ${a});
      const ivec2 pads = ivec2(${d}, ${c});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${i}; h++) {
          int hIn = hBeg + h * ${u};

          if (hIn >= 0 && hIn < ${t}) {
            for (int w = 0; w < ${l}; w++) {
              int wIn = wBeg + w * ${h};

              if (wIn >= 0 && wIn < ${n}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kle(r){const{inputs:e,backend:t,attrs:n}=r,{x:s,filter:o}=e,{strides:a,pad:i,dilations:l}=n,u=qp(s.shape,o.shape,a,i,"NHWC",l);let h;const d=new Xle(u);h=t.runWebGLProgram(d,[s,o],"float32");const c=Wt({inputs:{x:h},backend:t,attrs:{shape:u.outShape}});return t.disposeIntermediateTensorInfo(h),c}const Yle={kernelName:e0,backendName:"webgl",kernelFunc:Kle};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zle(r){const{inputs:e,backend:t,attrs:n}=r,{equation:s}=n,o=e,{allDims:a,summedDims:i,idDims:l}=L2(s,o.length);j2(a.length,l,o);const{path:u,steps:h}=B2(i,l),d=h.length;let c=null,f=a.length;const p=[];for(let m=0;m<d;++m){for(const g of h[m]){const{permutationIndices:y,expandDims:v}=P2(f,l[g]);let b;U2(y)?b=o[g]:(b=ao({inputs:{x:o[g]},backend:t,attrs:{perm:y}}),p.push(b));const w=b.shape.slice();for(let _=0;_<v.length;++_)w.splice(v[_],0,1);ur(b.shape,w)||(b=Wt({inputs:{x:b},backend:t,attrs:{shape:w}}),p.push(b)),c===null?c=b:(c=CS({inputs:{a:b,b:c},backend:t}),p.push(c))}m<d-1&&(u[m]>=0&&(c=g1({inputs:{x:c},backend:t,attrs:{axis:u[m]-(a.length-f),keepDims:!1}}),p.push(c)),f--)}for(const m of p)m!==c&&t.disposeIntermediateTensorInfo(m);return c}const Qle={kernelName:EC,backendName:"webgl",kernelFunc:Zle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jle="return (x >= 0.0) ? x : (exp(x) - 1.0);",eue=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,tue=ar({opSnippet:Jle,packedOpSnippet:eue}),nue={kernelName:cp,backendName:"webgl",kernelFunc:tue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rue="return (b >= 1.0) ? a : a * (b + 1.0);",sue=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,oue=r=>{const{inputs:e,backend:t}=r,{dy:n,y:s}=e,o=ut().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new mm(sue,n.shape,s.shape):new ld(rue,n.shape,s.shape);return t.runWebGLProgram(o,[n,s],n.dtype)},iue={kernelName:rw,backendName:"webgl",kernelFunc:oue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aue=`
  return vec4(equal(a, b));
`,lue="return float(a == b);",uue=Ls({opSnippet:lue,packedOpSnippet:aue,dtype:"bool",cpuKernelImpl:Kse}),cue={kernelName:t0,backendName:"webgl",kernelFunc:uue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hue=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${N2};
  float a1 = ${A2};
  float a2 = ${R2};
  float a3 = ${D2};
  float a4 = ${O2};
  float a5 = ${M2};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,due=ar({opSnippet:hue}),fue={kernelName:hp,backendName:"webgl",kernelFunc:due};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pue=Rd+`
  return exp(x);
`,mue=`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,IO=ar({opSnippet:pue,packedOpSnippet:mue,cpuKernelImpl:Yse,dtype:"float32"}),gue={kernelName:dp,backendName:"webgl",kernelFunc:IO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tx(r){const{inputs:e,attrs:t,backend:n}=r,{dim:s}=t,{input:o}=e,a=o.shape.length,i=o.shape.slice();let l=s;return s<0&&(xe(-(a+1)<=s,()=>`Axis must be in the interval [${-(a+1)}, ${a}]`),l=a+s+1),i.splice(l,0,1),Wt({inputs:{x:o},backend:n,attrs:{shape:i}})}const yue={kernelName:n0,backendName:"webgl",kernelFunc:tx};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rE="return exp(x) - 1.0;",vue=ar({opSnippet:rE,packedOpSnippet:rE,cpuKernelImpl:Zse}),bue={kernelName:fp,backendName:"webgl",kernelFunc:vue};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sE{constructor(e,t,n){this.variableNames=["real","imag"];const s=t[1];this.outputShape=t;const o=n?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,a=n?`${s}.0`:"1.0";let i;if(e==="real")i="return real * expR - imag * expI;";else if(e==="imag")i="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${e}.`);this.userCode=`
      const float exponentMultiplier = ${o};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${i}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${s});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${s}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${a};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EO(r,e,t){const n=t.texData.get(r.dataId),s=pt(r.shape),o=r.shape[r.shape.length-1],a=s/o,i=Wt({inputs:{x:r},backend:t,attrs:{shape:[a,o]}}),l=i.shape,u=new sE("real",l,e),h=new sE("imag",l,e),d=[{dataId:n.complexTensorInfos.real.dataId,dtype:n.complexTensorInfos.real.dtype,shape:l},{dataId:n.complexTensorInfos.imag.dataId,dtype:n.complexTensorInfos.imag.dtype,shape:l}],c=t.runWebGLProgram(u,d,"float32"),f=t.runWebGLProgram(h,d,"float32"),p=Ou({inputs:{real:c,imag:f},backend:t});t.disposeIntermediateTensorInfo(c),t.disposeIntermediateTensorInfo(f);const m=Wt({inputs:{x:p},backend:t,attrs:{shape:r.shape}});return t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(p),m}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xue(r){const{inputs:e,backend:t}=r,{input:n}=e;return EO(n,!1,t)}const wue={kernelName:sw,backendName:"webgl",kernelFunc:xue};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Sue{constructor(e,t){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ym(r){const{backend:e,attrs:t}=r,{shape:n,value:s}=t;let{dtype:o}=t;if(o=o||Yf(s),o==="string"){const a=_s(o,pt(n));return a.fill(s),e.makeTensorInfo(n,o,a)}else{const a=new Sue(n,s),i=[[s]];return e.runWebGLProgram(a,[],o,i)}}const _ue={kernelName:ow,backendName:"webgl",kernelFunc:ym};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Tue{constructor(e){this.variableNames=["Image"],this.outputShape=[];const t=e[2];this.outputShape=e,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${t} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${t}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kue={kernelName:iw,backendName:"webgl",kernelFunc:({inputs:r,backend:e})=>{const{image:t}=r,n=e,s=new Tue(t.shape);return n.runWebGLProgram(s,[t],t.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oE="return floor(x);",Iue=ar({opSnippet:oE,packedOpSnippet:oE,cpuKernelImpl:Qse}),Eue={kernelName:pp,backendName:"webgl",kernelFunc:Iue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cue=`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,$ue=`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,Nue=Ls({opSnippet:Cue,packedOpSnippet:$ue,dtype:"int32"}),Aue={kernelName:mp,backendName:"webgl",kernelFunc:Nue};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Rue{constructor(e){this.variableNames=["A"];const t=lo(),[n,s]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${s}.0, ${n}.0);

        vec4 values = ${t.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Due{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const t=lo(),[n,s]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${s}.0, ${n}.0);
            vec4 values = ${t.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${t.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oue={kernelName:oV,backendName:"webgl",kernelFunc:Mue};let kh,Qv=ut().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function Mue(r){const{inputs:e,backend:t,attrs:n}=r;let{pixels:s}=e;const{numChannels:o}=n,a=typeof HTMLVideoElement!="undefined"&&s instanceof HTMLVideoElement,i=typeof HTMLImageElement!="undefined"&&s instanceof HTMLImageElement,[l,u]=a?[s.videoWidth,s.videoHeight]:[s.width,s.height],h=[u,l],d=[u,l,o];if(i||a){const m=ut().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(kh==null||m!==Qv)&&(Qv=m,kh=document.createElement("canvas").getContext("2d",{willReadFrequently:Qv})),kh.canvas.width=l,kh.canvas.height=u,kh.drawImage(s,0,0,l,u),s=kh.canvas}const c=t.makeTensorInfo(h,"int32");t.texData.get(c.dataId).usage=hi.PIXELS,t.gpgpu.uploadPixelDataToTexture(t.getTexture(c.dataId),s);const f=ut().getBool("WEBGL_PACK")?new Due(d):new Rue(d),p=t.runWebGLProgram(f,[c],"int32");return t.disposeData(c.dataId),p}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fue(r){const{inputs:e,backend:t,attrs:n}=r,{x:s,filter:o,bias:a,preluActivationWeights:i}=e,{strides:l,pad:u,dataFormat:h,dilations:d,dimRoundingMode:c,activation:f,leakyreluAlpha:p}=n,m=Rl(h),g=Ms(s.shape,o.shape,l,d,u,c,!1,m);let y;const v=[],b=a!=null,w=i!=null,_=f==="leakyrelu",I=()=>{const N=[s,o],O=(D,M)=>{if(M==="NCHW"&&D.shape.length===1&&D.shape[0]!==1){const P=Wt({inputs:{x:D},backend:t,attrs:{shape:[D.shape[0],1,1]}});return v.push(P),P}return D};if(b&&N.push(O(a,h)),w&&N.push(O(i,h)),_){const D=t.makeTensorInfo([],"float32",ku(p,"float32"));N.push(D),v.push(D)}return N};if(g.filterHeight===1&&g.filterWidth===1&&g.dilationHeight===1&&g.dilationWidth===1&&g.strideHeight===1&&g.strideWidth===1&&(g.padInfo.type==="SAME"||g.padInfo.type==="VALID"))y=wO({x:s,filter:o,convInfo:g,backend:t,bias:a,activation:f,preluActivationWeights:i,leakyreluAlpha:p});else if(g.strideWidth<=2&&m==="channelsLast"&&ut().getBool("WEBGL_EXP_CONV")){const N=f?Df(f,!0):null,O=new xO(g,b,N,w,_),D=[[g.padInfo.top,g.padInfo.left],[g.strideHeight,g.strideWidth],[g.dilationHeight,g.dilationWidth],[g.inHeight,g.inWidth]],M=I();y=t.runWebGLProgram(O,M,"float32",D)}else if(ut().getBool("WEBGL_CONV_IM2COL"))y=SO({x:s,filter:o,convInfo:g,backend:t,bias:a,activation:f,preluActivationWeights:i,leakyreluAlpha:p});else{const N=f?Df(f,!1):null,O=new bO(g,b,N,w,_),D=I();y=t.runWebGLProgram(O,D,"float32")}const C=Wt({inputs:{x:y},backend:t,attrs:{shape:g.outShape}});return v.push(y),v.forEach(N=>t.disposeIntermediateTensorInfo(N)),C}const Lue={kernelName:Zg,backendName:"webgl",kernelFunc:Fue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pue(r){const{inputs:e,backend:t,attrs:n}=r,{x:s,filter:o,bias:a,preluActivationWeights:i}=e,{strides:l,pad:u,dilations:h,dimRoundingMode:d,activation:c,leakyreluAlpha:f}=n,p=[];let m=h;m==null&&(m=[1,1]),xe(Ks(l,m),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${l} and dilations '${m}'`);const g=Ms(s.shape,o.shape,l,m,u,d,!0),y=ut().getBool("WEBGL_PACK_DEPTHWISECONV")&&g.strideWidth<=2&&g.outChannels/g.inChannels===1,v=c?Df(c,y):null,b=[s,o],w=a!=null,_=i!=null,I=c==="leakyrelu";if(w&&b.push(a),_&&b.push(i),I){const D=t.makeTensorInfo([],"float32",ku(f,"float32"));b.push(D),p.push(D)}let C;y?C=new kO(g,w,v,_,I):C=new TO(g,w,v,_,I);const N=[[g.padInfo.top,g.padInfo.left],[g.strideHeight,g.strideWidth],[g.dilationHeight,g.dilationWidth],[g.inHeight,g.inWidth]],O=t.runWebGLProgram(C,b,"float32",N);return p.forEach(D=>t.disposeIntermediateTensorInfo(D)),O}const jue={kernelName:LC,backendName:"webgl",kernelFunc:Pue};class Bue{constructor(e,t,n,s){this.sliceDim=e,this.strides=t,this.paramsShape=s,this.variableNames=["x","indices"],this.outputShape=n;const o=Dr(n.length);let a=`
    int index;`;for(let i=0;i<this.sliceDim;i++)a+=`
          index = round(getIndices(coords[0], ${i}));
          out_of_bounds = out_of_bounds || index < 0;
          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[i]};
          flattenIndex += index * ${this.strides[i]};`;this.userCode=`
         void main() {
          ${o} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;

          ${a}

          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uue(r){const{inputs:e,backend:t}=r,{params:n,indices:s}=e,o=s.shape,a=o[o.length-1],i=pt(n.shape),[l,u,h,d]=Lw(n,s),c=Wt({inputs:{x:s},backend:t,attrs:{shape:[u,a]}}),f=Wt({inputs:{x:n},backend:t,attrs:{shape:[pt(n.shape)/h,h]}});if(t.shouldExecuteOnCPU([n,s])||n.dtype==="string"){const y=t.readSync(s.dataId),v=t.bufferSync(n),b=Jse(y,v,n.dtype,u,a,h,d,n.shape,i);return t.makeTensorInfo(l,n.dtype,b.values)}const p=new Bue(a,d,[u,h],n.shape),m=t.runWebGLProgram(p,[f,c],f.dtype),g=Wt({inputs:{x:m},backend:t,attrs:{shape:l}});return t.disposeIntermediateTensorInfo(c),t.disposeIntermediateTensorInfo(f),t.disposeIntermediateTensorInfo(m),g}const zue={kernelName:CC,backendName:"webgl",kernelFunc:Uue};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Vue{constructor(e,t){this.variableNames=["A","indices"],this.outputShape=t,this.rank=t.length;const n=Dr(this.rank),s=Gue(e);this.userCode=`
      void main() {
        ${n} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${e[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${s}));
      }
    `}}function Gue(r,e){const t=["resRC.x","resRC.y","resRC.z","resRC.w"],n=[];for(let s=0;s<r.length;s++)s===2?n.push("index"):n.push(`${t[s]}`);return n.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CO(r){const{inputs:e,backend:t,attrs:n}=r,{x:s,indices:o}=e,{axis:a,batchDims:i}=n,l=Hn(a,s.shape)[0];if(ut().get("DEBUG")){const v=t.readSync(o.dataId),b=s.shape[l];for(let w=0;w<v.length;++w){const _=v[w];xe(_<=b-1&&_>=0,()=>`GatherV2: the index value ${_} is not in [0, ${b-1}]`)}}const u=V2(s,o,l,i),h=pt(o.shape),d=[],c=Wt({inputs:{x:s},backend:t,attrs:{shape:[u.batchSize,u.outerSize,u.dimSize,u.sliceSize]}}),f=Wt({inputs:{x:o},backend:t,attrs:{shape:[u.batchSize,h/u.batchSize]}});d.push(c),d.push(f);const p=[u.batchSize,u.outerSize,h/u.batchSize,u.sliceSize];if(t.shouldExecuteOnCPU([s,o])||s.dtype==="string"){const v=t.bufferSync(f),b=t.bufferSync(c),w=eoe(b,v,p);return d.forEach(_=>t.disposeIntermediateTensorInfo(_)),t.makeTensorInfo(u.outputShape,w.dtype,w.values)}const m=new Vue(c.shape,p),g=t.runWebGLProgram(m,[c,f],c.dtype);d.push(g);const y=Wt({inputs:{x:g},backend:t,attrs:{shape:u.outputShape}});return d.forEach(v=>t.disposeIntermediateTensorInfo(v)),y}const Wue={kernelName:s0,backendName:"webgl",kernelFunc:CO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hue="return float(a > b);",que=`
  return vec4(greaterThan(a, b));
`,Xue=Ls({opSnippet:Hue,packedOpSnippet:que,cpuKernelImpl:toe,dtype:"bool"}),Kue={kernelName:o0,backendName:"webgl",kernelFunc:Xue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yue="return float(a >= b);",Zue=`
  return vec4(greaterThanEqual(a, b));
`,Que=Ls({opSnippet:Yue,packedOpSnippet:Zue,dtype:"bool",cpuKernelImpl:noe}),Jue={kernelName:gp,backendName:"webgl",kernelFunc:Que};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ece(r){const{inputs:e,backend:t}=r,{input:n}=e;return EO(n,!0,t)}const tce={kernelName:aw,backendName:"webgl",kernelFunc:ece};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nce="return float(!isnan(x) && !isinf(x));",rce=ar({opSnippet:nce,dtype:"bool"}),sce={kernelName:vp,backendName:"webgl",kernelFunc:rce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oce="return float(isinf(x));",ice=ar({opSnippet:oce,dtype:"bool"}),ace={kernelName:bp,backendName:"webgl",kernelFunc:ice};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lce="return float(isnan(x));",uce=ar({opSnippet:lce,dtype:"bool"}),cce={kernelName:xp,backendName:"webgl",kernelFunc:uce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hce="return float(a < b);",dce=`
  return vec4(lessThan(a, b));
`,fce=Ls({opSnippet:hce,packedOpSnippet:dce,cpuKernelImpl:roe,dtype:"bool"}),pce={kernelName:a0,backendName:"webgl",kernelFunc:fce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mce="return float(a <= b);",gce=`
  return vec4(lessThanEqual(a, b));
`,yce=Ls({opSnippet:mce,packedOpSnippet:gce,cpuKernelImpl:soe,dtype:"bool"}),vce={kernelName:l0,backendName:"webgl",kernelFunc:yce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bce(r){const{backend:e,attrs:t}=r,{start:n,stop:s,num:o}=t,a=ooe(n,s,o);return e.makeTensorInfo([a.length],"float32",a)}const xce={kernelName:$C,backendName:"webgl",kernelFunc:bce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wce=Rd+`
  return x < 0.0 ? 0./0. : log(x);
`,Sce=`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,_ce=ar({opSnippet:wce,packedOpSnippet:Sce,cpuKernelImpl:ioe}),Tce={kernelName:wp,backendName:"webgl",kernelFunc:_ce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kce=Rd+`
  return log(1.0 + x);
`,Ice=ar({opSnippet:kce}),Ece={kernelName:Sp,backendName:"webgl",kernelFunc:Ice};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cce="return float(a >= 1.0 && b >= 1.0);",$ce=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,Nce=Ls({opSnippet:Cce,packedOpSnippet:$ce,dtype:"bool"}),Ace={kernelName:u0,backendName:"webgl",kernelFunc:Nce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rce="return float(!(x >= 1.0));",Dce=ar({opSnippet:Rce}),Oce={kernelName:c0,backendName:"webgl",kernelFunc:Dce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mce="return float(a >= 1.0 || b >= 1.0);",Fce=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,Lce=Ls({opSnippet:Mce,packedOpSnippet:Fce,dtype:"bool"}),Pce={kernelName:h0,backendName:"webgl",kernelFunc:Lce};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jce{constructor(e,t,n,s,o){this.variableNames=["x"],this.outputShape=[];const a=t,i=e[3]-1;this.outputShape=e;let l;const u=`float(${n}) + float(${s}) * sum`;o===.5?l=`inversesqrt(${u})`:o===1?l=`1.0/(${u})`:l=`exp(log(${u}) * float(-${o}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${a}; j <= ${a}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${i}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${l};
        setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Bce{constructor(e,t,n,s,o){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const a=t,i=e[3]-1;this.outputShape=e;let l;const u=`float(${n}) + float(${s}) * sum`;o===.5?l=`inversesqrt(${u})`:o===1?l=`1.0/(${u})`:l=`exp(log(${u}) * float(-${o}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${a};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${a}; j <= ${a}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${i}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${l};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uce=r=>{const{inputs:e,backend:t,attrs:n}=r,{x:s}=e,{depthRadius:o,bias:a,alpha:i,beta:l}=n,u=ut().getBool("WEBGL_PACK_NORMALIZATION")?new Bce(s.shape,o,a,i,l):new jce(s.shape,o,a,i,l);return t.runWebGLProgram(u,[s],s.dtype)},zce={kernelName:d0,backendName:"webgl",kernelFunc:Uce};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Vce{constructor(e,t,n,s,o){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=t,this.bias=n,this.alpha=s,this.beta=o,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${t})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${t} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${s}) * norm + float(${n});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${s})
                * float(${o})
                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${o});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gce=r=>{const{inputs:e,backend:t,attrs:n}=r,{x:s,y:o,dy:a}=e,{depthRadius:i,bias:l,alpha:u,beta:h}=n,d=new Vce(s.shape,i,l,u,h);return t.runWebGLProgram(d,[s,o,a],s.dtype)},Wce={kernelName:uw,backendName:"webgl",kernelFunc:Gce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hce(r,e,t,n){const s=pt(e),a=pt(r.shape)/s,i=Wt({inputs:{x:r},attrs:{shape:[a,s]},backend:n}),l=th(i,r.dtype,"max",n),u=Wt({inputs:{x:l},attrs:{shape:t},backend:n});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(l),u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $O(r){const{inputs:e,backend:t,attrs:n}=r,{x:s}=e,{reductionIndices:o,keepDims:a}=n,i=s.shape.length,l=Hn(o,s.shape);let u=l;const h=qr(u,i),d=h!=null,c=t.shouldExecuteOnCPU([s]);let f=s;if(d){if(c){const b=t.texData.get(f.dataId).values,w=new Array(i);for(let C=0;C<w.length;C++)w[C]=s.shape[h[C]];const _=IS(b,s.shape,s.dtype,h,w);f=t.makeTensorInfo(w,s.dtype);const I=t.texData.get(f.dataId);I.values=_}else f=m1(s,h,t);u=ts(u.length,i)}Fs("max",u,i);const[p,m]=ks(f.shape,u);let g=p;a&&(g=es(p,l));let y;if(c){const b=t.texData.get(f.dataId).values,w=aoe(b,pt(m),g,s.dtype);y=t.makeTensorInfo(g,s.dtype);const _=t.texData.get(y.dataId);_.values=w}else y=Hce(f,m,g,t);return d&&t.disposeIntermediateTensorInfo(f),y}const qce={kernelName:f0,backendName:"webgl",kernelFunc:$O};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xce=ES+`
  return max(a, b);
`,Kce=`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+pm+`
  return result;
`,Yce=Ls({opSnippet:Xce,packedOpSnippet:Kce,cpuKernelImpl:loe}),Zce={kernelName:_p,backendName:"webgl",kernelFunc:Yce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qce(r){const{inputs:e,backend:t,attrs:n}=r,{x:s}=e;dm(s,"maxPool");const{filterSize:o,strides:a,pad:i,dimRoundingMode:l}=n,u=1;xe(Ks(a,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${a} and dilations '${u}'`);const h=Xi(s.shape,o,a,u,i,l);if(h.filterWidth===1&&h.filterHeight===1&&ur(h.inShape,h.outShape))return Go({inputs:{x:s},backend:t});const d=new Of(h,"max",!1);return t.runWebGLProgram(d,[s],s.dtype)}const Jce={kernelName:p0,backendName:"webgl",kernelFunc:Qce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ehe(r){const{inputs:e,backend:t,attrs:n}=r,{x:s}=e,{filterSize:o,strides:a,pad:i,dataFormat:l,dimRoundingMode:u}=n,h=[1,1,1],d=Al(s.shape,o,a,h,i,u,l),c=new $S(d,"max",!1);return t.runWebGLProgram(c,[s],s.dtype)}const the={kernelName:m0,backendName:"webgl",kernelFunc:ehe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nhe{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const t=e.strideHeight,n=e.strideWidth,s=e.dilationHeight,o=e.effectiveFilterHeight,a=e.effectiveFilterWidth,i=o-1-e.padInfo.top,l=a-1-e.padInfo.left,u=o*a-1;this.userCode=`
      const ivec2 pads = ivec2(${i}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${o};
          wR += ${s}) {
          float dyR = float(dyRCorner + wR) / ${t}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${a}; wC++) {
            float dyC = float(dyCCorner + wC) / ${n}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${u} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${a} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}}class rhe{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const t=e.strideDepth,n=e.strideHeight,s=e.strideWidth,o=e.dilationDepth,a=e.dilationHeight,i=e.dilationWidth,l=e.effectiveFilterDepth,u=e.effectiveFilterHeight,h=e.effectiveFilterWidth,d=l-1-e.padInfo.front,c=u-1-e.padInfo.top,f=h-1-e.padInfo.left,p=l*u*h-1;this.userCode=`
      const ivec3 pads = ivec3(${d}, ${c}, ${f});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${l};
           wD += ${o}) {
          float dyD = float(dyDCorner + wD) / ${t}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${u};
              wR += ${a}) {
            float dyR = float(dyRCorner + wR) / ${n}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${h};
                wC += ${i}) {
              float dyC = float(dyCCorner + wC) / ${s}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${p} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${u} * ${h} +
                  wR * ${h} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function she(r){const{inputs:e,backend:t,attrs:n}=r,{dy:s,input:o}=e,a=o,{filterSize:i,strides:l,pad:u,dimRoundingMode:h}=n,d=[1,1,1],c=Al(a.shape,i,l,d,u,h),f=new $S(c,"max",!0),p=t.runWebGLProgram(f,[a],a.dtype),m=new rhe(c),g=t.runWebGLProgram(m,[s,p],a.dtype);return t.disposeIntermediateTensorInfo(p),g}const ohe={kernelName:hw,backendName:"webgl",kernelFunc:she};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ihe(r){const{inputs:e,backend:t,attrs:n}=r,{dy:s,input:o,output:a}=e,i=o;dm([o,a],"maxPoolGrad");const{filterSize:l,strides:u,pad:h,dimRoundingMode:d}=n,c=Xi(i.shape,l,u,1,h,d),f=!0,p=new Of(c,"max",f),m=t.runWebGLProgram(p,[i],i.dtype),g=new nhe(c),y=t.runWebGLProgram(g,[s,m],i.dtype);return t.disposeIntermediateTensorInfo(m),y}const ahe={kernelName:cw,backendName:"webgl",kernelFunc:ihe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lhe(r,e,t,n){let s=new Of(t,"max",!1);const o=n.runWebGLProgram(s,[r],"float32");s=new Of(t,"max",!0,!0,e);const a=n.runWebGLProgram(s,[r],"float32");return[o,a]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uhe={kernelName:NC,backendName:"webgl",kernelFunc:({inputs:r,attrs:e,backend:t})=>{const{x:n}=r,{filterSize:s,strides:o,pad:a,includeBatchInIndex:i}=e,l=t;xe(n.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${n.shape.length}.`);const u=[1,1];xe(Ks(o,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${u}'`);const h=Xi(n.shape,s,o,u,a),[d,c]=lhe(n,i,h,l);return[d,c]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function che(r,e,t,n){const s=pt(e),a=pt(r.shape)/s,i=Wt({inputs:{x:r},attrs:{shape:[a,s]},backend:n}),l=th(i,"float32","mean",n),u=Wt({inputs:{x:l},attrs:{shape:t},backend:n});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(l),u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hhe={kernelName:g0,backendName:"webgl",kernelFunc:({inputs:r,attrs:e,backend:t})=>{const{x:n}=r,{keepDims:s,axis:o}=e,a=t,i=n.shape.length,l=Hn(o,n.shape);let u=l;const h=qr(u,i),d=h!=null,c=a.shouldExecuteOnCPU([n]),f=[];let p=n;if(d){if(c){const w=a.texData.get(p.dataId).values,_=new Array(i);for(let N=0;N<_.length;N++)_[N]=n.shape[h[N]];const I=IS(w,n.shape,n.dtype,h,_);p=a.makeTensorInfo(_,n.dtype);const C=a.texData.get(p.dataId);C.values=I}else p=m1(n,h,a);f.push(p),u=ts(u.length,i)}Fs("sum",u,i);const[m,g]=ks(p.shape,u);let y=m;s&&(y=es(m,l));const v=che(p,g,y,a);for(const b of f)a.disposeIntermediateTensorInfo(b);return v}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dhe(r){const{inputs:e,backend:t,attrs:n}=r,{x:s}=e,{axis:o,keepDims:a}=n,i=s.shape.length,l=Hn(o,s.shape);let u=l;const h=qr(u,i);let d=s;h!=null&&(d=ao({inputs:{x:s},backend:t,attrs:{perm:h}}),u=ts(u.length,s.shape.length)),Fs("min",u,i);const[c,f]=ks(d.shape,u),p=pt(f),m=Wt({inputs:{x:d},backend:t,attrs:{shape:[-1,p]}}),g=th(m,m.dtype,"min",t);let y;if(a){const v=es(c,l);y=Wt({inputs:{x:g},backend:t,attrs:{shape:v}})}else y=Wt({inputs:{x:g},backend:t,attrs:{shape:c}});return t.disposeIntermediateTensorInfo(m),t.disposeIntermediateTensorInfo(g),h!=null&&t.disposeIntermediateTensorInfo(d),y}const fhe={kernelName:y0,backendName:"webgl",kernelFunc:dhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const phe=ES+`
  return min(a, b);
`,mhe=`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+pm+`
  return result;
`,ghe=Ls({opSnippet:phe,packedOpSnippet:mhe,cpuKernelImpl:uoe}),yhe={kernelName:Tp,backendName:"webgl",kernelFunc:ghe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vhe{constructor(e,t,n){this.variableNames=["x"],this.outputShape=t.map((h,d)=>h[0]+e[d]+h[1]);const s=e.length,o=Dr(s),a=t.map(h=>h[0]).join(","),i=t.map((h,d)=>h[0]+e[d]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,s),u=n==="reflect"?0:1;if(s===1){this.userCode=`
        int start = ${a};
        int end = ${i};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${u};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${u};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${o} start = ${o}(${a});
      ${o} end = ${o}(${i});

      void main() {
        ${o} outC = getOutputCoords();
        for (int i = 0; i < ${s}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${u};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${u};
          }
        }
        ${o} coords = outC - start;
        setOutput(getX(${l}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bhe{constructor(e,t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map((p,m)=>p[0]+e[m]+p[1]);const s=e.length,o=Dr(s),a=t.map(p=>p[0]).join(","),i=t.map((p,m)=>p[0]+e[m]).join(","),l=ro("rc",s),u=ro("source",s),h=`${l[s-1]} < ${this.outputShape[s-1]}`,d=s===1?"source":`vec2(${u.slice(-2).join()})`,c=n==="reflect"?0:1;let f="";if(s===1){const p=`
        ${o} source = rc;
        if (source < start) {
          source = start * 2 - source - ${c};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${c};
        }
        source -= start;
      `;f=`
        ${o} rc = outputLoc;
        ${p}
        result[0] = getChannel(getX(${u.join()}), ${d});
        ${l[s-1]} += 1;
        if(${h}) {
          ${p}
          result[1] = getChannel(getX(${u.join()}), ${d});
        }
      `}else{const p=`
        ${o} source = rc;
        ${o} lt = ${o}(lessThan(source, start));
        ${o} gte = ${o}(greaterThanEqual(source, end));
        ${o} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${c}) +
                gte * ((end - 1) * 2 - source + ${c});
        source -= start;
      `;f=`
        ${o} rc = outputLoc;
        ${p}
        result[0] = getChannel(getX(${u.join()}), ${d});
        ${l[s-1]} += 1;
        if(${h}) {
          ${p}
          result[1] = getChannel(getX(${u.join()}), ${d});
        }
        rc = outputLoc;
        ${l[s-2]} += 1;
        if(${l[s-2]} < ${this.outputShape[s-2]}) {
          ${p}
          result[2] = getChannel(getX(${u.join()}), ${d});
          ${l[s-1]} += 1;
          if(${h}) {
            ${p}
            result[3] = getChannel(getX(${u.join()}), ${d});
          }
        }
      `}this.userCode=`
      const ${o} start = ${o}(${a});
      const ${o} end = ${o}(${i});

      void main() {
        ${o} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${f}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xhe=({inputs:r,backend:e,attrs:t})=>{const{x:n}=r,{paddings:s,mode:o}=t,a=ut().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new bhe(n.shape,s,o):new vhe(n.shape,s,o);return e.runWebGLProgram(a,[n],n.dtype)},whe={kernelName:v0,backendName:"webgl",kernelFunc:xhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const She=`if (b == 0.0) return NAN;
  return mod(a, b);`,_he=`
  vec4 result = mod(a, b);
  bvec4 isNaN = equal(b, vec4(0.0));
  `+pm+`
  return result;
`,The=Ls({opSnippet:She,packedOpSnippet:_he}),khe={kernelName:kp,backendName:"webgl",kernelFunc:The};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ihe{constructor(e,t,n){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,n],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${t-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${t-1}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ehe=`
if (a == b) {
  return 1.0;
};
return a / b;`,Che=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,NO=Ls({opSnippet:Ehe,packedOpSnippet:Che,checkOutOfBounds:!0}),$he={kernelName:up,backendName:"webgl",kernelFunc:NO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iE="return a - b;",AO=Ls({opSnippet:iE,packedOpSnippet:iE,supportsComplex:!0,cpuKernelImpl:Coe}),Nhe={kernelName:Up,backendName:"webgl",kernelFunc:AO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RO(r){const{inputs:e,backend:t,attrs:n}=r,{logits:s}=e,{dim:o}=n,a=Hn([o],s.shape),i=$O({inputs:{x:s},backend:t,attrs:{reductionIndices:a,keepDims:!1}}),l=es(i.shape,a),u=Wt({inputs:{x:i},backend:t,attrs:{shape:l}}),h=AO({inputs:{a:s,b:u},backend:t}),d=IO({inputs:{x:h},backend:t}),c=g1({inputs:{x:d},backend:t,attrs:{axis:a,keepDims:!1}}),f=Wt({inputs:{x:c},backend:t,attrs:{shape:l}}),p=NO({inputs:{a:d,b:f},backend:t});return t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(u),t.disposeIntermediateTensorInfo(h),t.disposeIntermediateTensorInfo(d),t.disposeIntermediateTensorInfo(c),t.disposeIntermediateTensorInfo(f),p}const Ahe={kernelName:F0,backendName:"webgl",kernelFunc:RO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rhe(r){const{inputs:e,backend:t,attrs:n}=r,{logits:s}=e,{numSamples:o,seed:a,normalized:i}=n,l=i?s:RO({inputs:{logits:s},backend:t,attrs:{dim:s.shape.length-1}}),u=l.shape[0],h=l.shape[1],d=new Ihe(u,h,o),c=[[a]],f=t.runWebGLProgram(d,[l],"int32",c);return i||t.disposeIntermediateTensorInfo(l),f}const Dhe={kernelName:AC,backendName:"webgl",kernelFunc:Rhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ohe=Zi+`
  return -x;
`,Mhe=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;function Fhe(r){const{inputs:e,backend:t}=r,{x:n}=e;if(t.shouldExecuteOnCPU([n])){const o=t.texData.get(n.dataId),[a,i]=hoe(o.values,n.shape,n.dtype);return t.makeTensorInfo(i,n.dtype,a)}let s;return ut().getBool("WEBGL_PACK_UNARY_OPERATIONS")?s=new xc(n.shape,Mhe):s=new Tl(n.shape,Ohe),t.runWebGLProgram(s,[n],n.dtype)}const Lhe={kernelName:b0,backendName:"webgl",kernelFunc:Fhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Phe=m2;function jhe(r){ci("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:t,attrs:n}=r,{boxes:s,scores:o}=e,{maxOutputSize:a,iouThreshold:i,scoreThreshold:l}=n,u=t.readSync(s.dataId),h=t.readSync(o.dataId),{selectedIndices:d}=Phe(u,h,a,i,l);return t.makeTensorInfo([d.length],"int32",new Int32Array(d))}const Bhe={kernelName:dw,backendName:"webgl",kernelFunc:jhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uhe=g2;function zhe(r){ci("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:t,attrs:n}=r,{boxes:s,scores:o}=e,{maxOutputSize:a,iouThreshold:i,scoreThreshold:l,padToMaxOutputSize:u}=n,h=t.readSync(s.dataId),d=t.readSync(o.dataId),{selectedIndices:c,validOutputs:f}=Uhe(h,d,a,i,l,u);return[t.makeTensorInfo([c.length],"int32",new Int32Array(c)),t.makeTensorInfo([],"int32",new Int32Array([f]))]}const Vhe={kernelName:fw,backendName:"webgl",kernelFunc:zhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ghe=y2;function Whe(r){ci("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:t,attrs:n}=r,{boxes:s,scores:o}=e,{maxOutputSize:a,iouThreshold:i,scoreThreshold:l,softNmsSigma:u}=n,h=t.readSync(s.dataId),d=t.readSync(o.dataId),c=a,f=i,p=l,m=u,{selectedIndices:g,selectedScores:y}=Ghe(h,d,c,f,p,m);return[t.makeTensorInfo([g.length],"int32",new Int32Array(g)),t.makeTensorInfo([y.length],"float32",new Float32Array(y))]}const Hhe={kernelName:pw,backendName:"webgl",kernelFunc:Whe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qhe{constructor(e,t,n,s){this.variableNames=["indices"],this.outputShape=[e,t],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${s}), float(${n}),
                      float(index == coords.y)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xhe=r=>{const{inputs:e,backend:t,attrs:n}=r,{indices:s}=e,{dtype:o,depth:a,onValue:i,offValue:l}=n,u=pt(s.shape),h=new qhe(u,a,i,l),d=Wt({inputs:{x:s},backend:t,attrs:{shape:[u]}}),c=t.runWebGLProgram(h,[d],o);t.disposeIntermediateTensorInfo(d);const f=[...s.shape,a],p=Wt({inputs:{x:c},backend:t,attrs:{shape:f}});return t.disposeIntermediateTensorInfo(c),p},Khe={kernelName:S0,backendName:"webgl",kernelFunc:Xhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _y(r){const{inputs:e,backend:t}=r,{x:n}=e;if(n.dtype==="complex64"){const s=gm({inputs:{input:n},backend:t}),o=_y({inputs:{x:s},backend:t}),a=y1({inputs:{input:n},backend:t}),i=_y({inputs:{x:a},backend:t}),l=Ou({inputs:{real:o,imag:i},backend:t});return t.disposeIntermediateTensorInfo(s),t.disposeIntermediateTensorInfo(o),t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(i),l}else return ym({attrs:{shape:n.shape,dtype:n.dtype,value:n.dtype==="string"?"":0},backend:t})}const Yhe={kernelName:j0,backendName:"webgl",kernelFunc:_y};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DO(r){const{inputs:e,backend:t}=r,{x:n}=e;if(n.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(n.dtype==="complex64"){const s=gm({inputs:{input:n},backend:t}),o=DO({inputs:{x:s},backend:t}),a=y1({inputs:{input:n},backend:t}),i=_y({inputs:{x:a},backend:t}),l=Ou({inputs:{real:o,imag:i},backend:t});return t.disposeIntermediateTensorInfo(s),t.disposeIntermediateTensorInfo(o),t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(i),l}else return ym({attrs:{shape:n.shape,dtype:n.dtype,value:1},backend:t})}const Zhe={kernelName:w0,backendName:"webgl",kernelFunc:DO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qhe(r){const{inputs:e,backend:t,attrs:n}=r,{axis:s}=n;if(e.length===1)return tx({inputs:{input:e[0]},backend:t,attrs:{dim:s}});const o=e[0].shape,a=e[0].dtype;e.forEach(h=>{qi(o,h.shape,"All tensors passed to stack must have matching shapes"),xe(a===h.dtype,()=>"All tensors passed to stack must have matching dtypes")});const i=[],l=e.map(h=>{const d=tx({inputs:{input:h},backend:t,attrs:{dim:s}});return i.push(d),d}),u=vO({inputs:l,backend:t,attrs:{axis:s}});return i.forEach(h=>t.disposeIntermediateTensorInfo(h)),u}const Jhe={kernelName:_0,backendName:"webgl",kernelFunc:Qhe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ede{constructor(e,t,n){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map((u,h)=>u[0]+e[h]+u[1]);const s=e.length,o=Dr(s),a=t.map(u=>u[0]).join(","),i=t.map((u,h)=>u[0]+e[h]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,s);if(s===1){this.userCode=`
        int start = ${a};
        int end = ${i};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${o} start = ${o}(${a});
      ${o} end = ${o}(${i});

      void main() {
        ${o} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${o} coords = outC - start;
          setOutput(getX(${l}));
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tde{constructor(e,t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map((m,g)=>m[0]+e[g]+m[1]);const s=e.length,o=Dr(s),a=t.map(m=>m[0]).join(","),i=t.map((m,g)=>m[0]+e[g]).join(","),l=ro("rc",s),u=ro("source",s),h=`${l[s-1]} < ${this.outputShape[s-1]}`,d=s===1?"source":`vec2(${u.slice(-2).join()})`,c=[`${o} rc = outputLoc;`,`${l[s-1]} += 1;
       if(${h}) {
      `,s===1?"":`}
       rc = outputLoc;
       ${l[s-2]} += 1;
       if(${l[s-2]} < ${this.outputShape[s-2]}) {`,s===1?"":`  ${l[s-1]} += 1;
         if(${h}) {`],f=s===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let p="";for(let m=0,g=s===1?2:4;m<g;m++)p+=`
        ${c[m]}
        if (${f}) {
          result[${m}] = float(value);
        } else {
          ${o} source = rc - start;
          result[${m}] = getChannel(getX(${u.join()}), ${d});
        }
      `;p+=s===1?"} ":"}}",this.userCode=`
      const ${o} start = ${o}(${a});
      const ${o} end = ${o}(${i});

      void main() {
        ${o} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${p}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OO=r=>{const{inputs:e,backend:t,attrs:n}=r,{x:s}=e,{paddings:o,constantValue:a}=n;if(pt(s.shape)===0){const u=o.map((h,d)=>h[0]+s.shape[d]+h[1]);return ym({backend:t,attrs:{shape:u,value:a,dtype:s.dtype}})}const i=ut().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new tde(s.shape,o,a):new ede(s.shape,o,a),l=[[a]];return t.runWebGLProgram(i,[s],s.dtype,l)},nde={kernelName:T0,backendName:"webgl",kernelFunc:OO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rde=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,sde=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+pm+`
  return result;
`,ode=Ls({opSnippet:rde,packedOpSnippet:sde}),ide={kernelName:Ep,backendName:"webgl",kernelFunc:ode};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ade(r){const{inputs:e,backend:t,attrs:n}=r,{x:s}=e,{axis:o,keepDims:a}=n,i=s.shape.length,l=[],u=Hn(o,s.shape);let h=u;const d=qr(h,i);let c=s;d!=null&&(c=ao({inputs:{x:s},backend:t,attrs:{perm:d}}),h=ts(h.length,i),l.push(c)),Fs("prod",h,i);let f;if(t.shouldExecuteOnCPU([c])){const p=t.texData.get(c.dataId).values,{outVals:m,outShape:g,outDtype:y}=foe(c.shape,c.dtype,p,h);f=t.makeTensorInfo(g,y,m)}else{const[p,m]=ks(c.shape,h),g=pt(m),y=Wt({inputs:{x:c},backend:t,attrs:{shape:[-1,g]}}),v=Dw(s.dtype),b=th(y,v,"prod",t);f=Wt({inputs:{x:b},backend:t,attrs:{shape:p}}),l.push(y),l.push(b)}if(a){l.push(f);const p=es(f.shape,u);f=Wt({inputs:{x:f},backend:t,attrs:{shape:p}})}return l.forEach(p=>t.disposeIntermediateTensorInfo(p)),f}const lde={kernelName:I0,backendName:"webgl",kernelFunc:ade};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ude(r){const{inputs:e,backend:t,attrs:n}=r,{paramsNestedSplits:s,paramsDenseValues:o,indices:a}=e,{outputRaggedRank:i}=n,l=s.map(y=>t.readSync(y.dataId)),u=s.map(y=>y.shape),h=t.readSync(o.dataId),d=t.readSync(a.dataId),[c,f,p]=poe(l,u,h,o.shape,o.dtype,d,a.shape,i),m=c.map(y=>t.makeTensorInfo([y.length],"int32",y)),g=t.makeTensorInfo(p,o.dtype,f);return m.concat([g])}const cde={kernelName:RC,backendName:"webgl",kernelFunc:ude};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hde(r){const{inputs:e,backend:t,attrs:n}=r,{shape:s,values:o,defaultValue:a,rowPartitionTensors:i}=e,{rowPartitionTypes:l}=n,u=t.readSync(s.dataId),h=t.readSync(o.dataId),d=t.readSync(a.dataId),c=i.map(g=>t.readSync(g.dataId)),f=i.map(g=>g.shape),[p,m]=moe(u,s.shape,h,o.shape,o.dtype,d,a.shape,c,f,l);return t.makeTensorInfo(p,o.dtype,m)}const dde={kernelName:DC,backendName:"webgl",kernelFunc:hde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MO=r=>{const{backend:e,attrs:t}=r,{start:n,stop:s,step:o,dtype:a}=t,i=goe(n,s,o,a);return e.makeTensorInfo([i.length],a,i)},fde={kernelName:mw,backendName:"webgl",kernelFunc:MO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pde="return 1.0 / x;",mde=ar({opSnippet:pde}),gde={kernelName:Cp,backendName:"webgl",kernelFunc:mde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yde=Zi+`
  return (x < 0.0) ? 0.0 : x;
`,vde=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,bde=ar({opSnippet:yde,packedOpSnippet:vde}),xde={kernelName:$p,backendName:"webgl",kernelFunc:bde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wde=Zi+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,Sde=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,_de=ar({opSnippet:wde,packedOpSnippet:Sde}),Tde={kernelName:Np,backendName:"webgl",kernelFunc:_de};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kde{constructor(e,t,n,s,o){this.variableNames=["A"],this.outputShape=[];const[a,i,l,u]=e;this.outputShape=[a,t,n,u];const h=[s&&t>1?i-1:i,s&&n>1?l-1:l],d=[s&&t>1?t-1:t,s&&n>1?n-1:n];let c;o?c="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":c="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${h[0]/d[0]},
          ${h[1]/d[1]});
      const vec2 inputShapeRC = vec2(${i}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${c};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ide{constructor(e,t,n,s,o){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[a,i,l,u]=e;this.outputShape=[a,t,n,u];const h=[s&&t>1?i-1:i,s&&n>1?l-1:l],d=[s&&t>1?t-1:t,s&&n>1?n-1:n];let c;o?c="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":c="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${h[0]/d[0]},
          ${h[1]/d[1]},
          ${h[1]/d[1]});
      const vec3 inputShapeRC = vec3(${i}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${c};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${u-1};
        bool hasNextRow = coords.z < ${n-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ede(r){const{inputs:e,backend:t,attrs:n}=r,{images:s}=e,{alignCorners:o,halfPixelCenters:a,size:i}=n,[l,u]=i,h=ut().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new Ide(s.shape,l,u,o,a):new kde(s.shape,l,u,o,a);return t.runWebGLProgram(h,[s],"float32")}const Cde={kernelName:$0,backendName:"webgl",kernelFunc:Ede};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $de{constructor(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;const[,s,o]=t,[,a,i]=e,l=[n&&a>1?s-1:s,n&&i>1?o-1:o],u=[n&&a>1?a-1:a,n&&i>1?i-1:i],h=l[0]/u[0],d=l[1]/u[1],c=1/h,f=1/d,p=Math.ceil(c)*2+2,m=Math.ceil(f)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${h});
        const float widthScale = float(${d});

        const float invHeightScale = float(${c});
        const float invWidthScale = float(${f});

        const int winHeight = int(${p});
        const int winWidth = int(${m});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${a}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${i}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${s-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${o-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nde(r){const{inputs:e,backend:t,attrs:n}=r,{images:s,dy:o}=e,{alignCorners:a}=n,i=new $de(o.shape,s.shape,a);return t.runWebGLProgram(i,[o],o.dtype)}const Ade={kernelName:vw,backendName:"webgl",kernelFunc:Nde};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Rde{constructor(e,t,n,s,o){this.variableNames=["A"],this.outputShape=[];const[a,i,l,u]=e;this.outputShape=[a,t,n,u];const h=[s&&t>1?i-1:i,s&&n>1?l-1:l],d=[s&&t>1?t-1:t,s&&n>1?n-1:n],c=s?"0.5":"0.0";let f;o?f="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":f="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${h[0]/d[0]},
          ${h[1]/d[1]});
      const vec2 inputShapeRC = vec2(${i}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${f};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${c})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Dde{constructor(e,t,n,s,o){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[a,i,l,u]=e;this.outputShape=[a,t,n,u];const h=[s&&t>1?i-1:i,s&&n>1?l-1:l],d=[s&&t>1?t-1:t,s&&n>1?n-1:n],c=s?"0.5":"0.0";let f;o?f="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":f="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${h[0]/d[0]},
          ${h[1]/d[1]},
          ${h[1]/d[1]});
      const vec3 inputShapeRC = vec3(${i}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${f};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${c})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${u-1};
        bool hasNextRow = coords.z < ${n-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ode(r){const{inputs:e,backend:t,attrs:n}=r,{images:s}=e,{alignCorners:o,halfPixelCenters:a,size:i}=n,[l,u]=i,h=ut().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new Dde(s.shape,l,u,o,a):new Rde(s.shape,l,u,o,a);return t.runWebGLProgram(h,[s],s.dtype)}const Mde={kernelName:C0,backendName:"webgl",kernelFunc:Ode};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Fde{constructor(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;const[,s,o]=t,[,a,i]=e,l=[n&&a>1?s-1:s,n&&i>1?o-1:o],u=[n&&a>1?a-1:a,n&&i>1?i-1:i],h=l[0]/u[0],d=l[1]/u[1],c=1/h,f=1/d,p=Math.ceil(c)*2+2,m=Math.ceil(f)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${h});
        const float widthScale = float(${d});

        const float invHeightScale = float(${c});
        const float invWidthScale = float(${f});

        const int winHeight = int(${p});
        const int winWidth = int(${m});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${a}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${i}) {
              continue;
            }

            float sourceFracRow =
              float(${l[0]}) *
                (float(dyR) / float(${u[0]}));

            float sourceFracCol =
                float(${l[1]}) *
                  (float(dyC) / float(${u[1]}));

            int sourceNearestRow = int(min(
                float(int(${s}) - 1),
                ${n} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${o}) - 1),
                ${n} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lde(r){const{inputs:e,backend:t,attrs:n}=r,{images:s,dy:o}=e,{alignCorners:a}=n,i=new Fde(o.shape,s.shape,a);return t.runWebGLProgram(i,[o],o.dtype)}const Pde={kernelName:yw,backendName:"webgl",kernelFunc:Lde};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jde{constructor(e,t){this.variableNames=["x"];const n=e.length;if(n>4)throw new Error(`WebGL backend: Reverse of rank-${n} tensor is not yet supported`);if(this.outputShape=e,n===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${e[0]} - coord - 1));
        }
      `;return}const s=i=>t.indexOf(i)!==-1&&e[i]!==1?`${e[i]} - coords[${i}] - 1`:`coords[${i}]`,o=e.map((i,l)=>s(l)).join(","),a=Dr(n);this.userCode=`
      void main() {
        ${a} coords = getOutputCoords();
        setOutput(getX(${o}));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Bde{constructor(e,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const n=e.length;if(n>4)throw new Error(`WebGL backend: Reverse of rank-${n} tensor is not yet supported`);this.outputShape=e;const s=ro("rc",n),o=`${s[n-1]} + 1 < ${this.outputShape[n-1]}`,a=`${s[n-2]} + 1 < ${this.outputShape[n-2]}`,i=Dr(n);n===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${e[0]} - rc - 1),
            ${e[0]} - rc - 1);
          if(${o}){
              result.g = getChannel(getX(${e[0]} - (rc  + 1) - 1),
                ${e[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${i} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${l(s.slice())};
          if(${o}){
            result.g = ${u(s.slice())};
          }
          if(${a}) {
            result.b = ${h(s.slice())};
            if(${o}) {
              result.a = ${d(s.slice())};
            }
          }
          setOutput(result);
        }
    `;function l(p){return c(p)}function u(p){return p[n-1]="("+p[n-1]+" + 1)",c(p)}function h(p){return p[n-2]="("+p[n-2]+" + 1)",c(p)}function d(p){return p[n-1]="("+p[n-1]+" + 1)",p[n-2]="("+p[n-2]+" + 1)",c(p)}function c(p){const m=e.map((v,b)=>f(b,p)),g=m.join(","),y=m.slice(-2).join(",");return`getChannel(getX(${g}), vec2(${y}))`}function f(p,m){return t.indexOf(p)!==-1&&e[p]!==1?`${e[p]} - ${m[p]} - 1`:`${m[p]}`}}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ude(r){const{inputs:e,backend:t,attrs:n}=r,{x:s}=e,{dims:o}=n,a=s.shape.length,i=Hn(o,s.shape);if(a===0)return Go({inputs:{x:s},backend:t});const l=ut().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Bde(s.shape,i):new jde(s.shape,i);return t.runWebGLProgram(l,[s],s.dtype)}const zde={kernelName:N0,backendName:"webgl",kernelFunc:Ude};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Vde{constructor(e,t){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const n=e[1],s=e[2];this.outputShape=e;let o="";typeof t=="number"?o=`float outputValue = ${t.toFixed(2)};`:o=`
        vec3 fill = vec3(${t.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${o}
          if(coordX >= 0 && coordX < ${s} && coordY >= 0 && coordY < ${n}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gde={kernelName:Aw,backendName:"webgl",kernelFunc:({inputs:r,attrs:e,backend:t})=>{const{image:n}=r,{radians:s,fillValue:o,center:a}=e,i=t,l=new Vde(n.shape,o),[u,h]=E2(a,n.shape[1],n.shape[2]),d=[[u,h,Math.sin(s),Math.cos(s)]];return i.runWebGLProgram(l,[n],n.dtype,d)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wde=`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`,Hde=ar({opSnippet:Wde}),qde={kernelName:Ap,backendName:"webgl",kernelFunc:Hde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xde="return inversesqrt(x);",Kde=ar({opSnippet:Xde,cpuKernelImpl:yoe}),Yde={kernelName:Rp,backendName:"webgl",kernelFunc:Kde};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class FO{constructor(e,t,n,s,o,a,i=!0){this.variableNames=["updates","indices","defaultValue"],this.outputShape=a;const l=Dr(o.length),u=Dr(a.length);let h="";n===1?h="i":n===2&&(h="i, j");const d=`getIndices(${h})`;let c="";s===1?c="i":s===2&&(c="i, coords[1]");const f=`getUpdates(${c})`,p=t>1?"strides[j]":"strides";this.userCode=`
        ${l} strides = ${l}(${o});

        void main() {
          ${u} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${e}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${t}; j++) {
              int index = round(${d});
              flattenedIndex += index * ${p};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${f};
              found = true;
            }
          }
          setOutput(mix(getDefaultValue(), sum, float(found)));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zde(r){const{inputs:e,backend:t,attrs:n}=r,{indices:s,updates:o}=e,{shape:a}=n,{sliceRank:i,numUpdates:l,sliceSize:u,strides:h,outputSize:d}=Hp(o,s,a),c=[d/u,u];if(d===0)return t.makeTensorInfo(a,s.dtype);const f=Wt({inputs:{x:s},backend:t,attrs:{shape:[l,i]}}),p=Wt({inputs:{x:o},backend:t,attrs:{shape:[l,u]}}),m=t.makeTensorInfo([],"float32",new Float32Array([0])),g=new FO(l,i,f.shape.length,p.shape.length,h,c),y=t.runWebGLProgram(g,[p,f,m],p.dtype),v=Wt({inputs:{x:y},backend:t,attrs:{shape:a}});return t.disposeIntermediateTensorInfo(f),t.disposeIntermediateTensorInfo(p),t.disposeIntermediateTensorInfo(y),t.disposeIntermediateTensorInfo(m),v}const Qde={kernelName:OC,backendName:"webgl",kernelFunc:Zde};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Jde{constructor(e,t,n,s){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,n];const o="while (left < right) {",a=`for (int i = 0; i < ${Math.ceil(Math.log2(t+1))}; ++i) { if (left >= right) break;`,i=ut().getNumber("WEBGL_VERSION")===2?o:a,l=s==="left"?"<":"<=";this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${i}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${l} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function efe(r){const{inputs:e,backend:t,attrs:n}=r,{sortedSequence:s,values:o}=e,{side:a}=n,i=new Jde(s.shape[0],s.shape[1],o.shape[1],a),l=[[s.shape[1]]];return t.runWebGLProgram(i,[s,o],"int32",l)}const tfe={kernelName:MC,backendName:"webgl",kernelFunc:efe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nfe{constructor(e,t,n){this.variableNames=["c","a","b"],this.outputShape=t;let s,o;if(n>4)throw Error(`Where for rank ${n} is not yet supported`);if(n===1)o="resRC",s="resRC";else{const i=["resRC.x","resRC.y","resRC.z","resRC.w"],l=[],u=[];for(let h=0;h<t.length;h++)u.push(`${i[h]}`),h<e&&l.push(`${i[h]}`);s=l.join(),o=u.join()}const a=Dr(n);this.userCode=`
      void main() {
        ${a} resRC = getOutputCoords();
        float cVal = getC(${s});
        if (cVal >= 1.0) {
          setOutput(getA(${o}));
        } else {
          setOutput(getB(${o}));
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rfe(r){const{inputs:e,backend:t}=r,{condition:n,t:s,e:o}=e,a=new nfe(n.shape.length,s.shape,s.shape.length);return t.runWebGLProgram(a,[n,s,o],Bo(s.dtype,o.dtype))}const sfe={kernelName:A0,backendName:"webgl",kernelFunc:rfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ofe=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${J0};
  float scale = ${e1};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,ife=ar({opSnippet:ofe}),afe={kernelName:Dp,backendName:"webgl",kernelFunc:ife};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lfe=Rd+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,ufe=`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,cfe=ar({opSnippet:lfe,packedOpSnippet:ufe,cpuKernelImpl:boe}),hfe={kernelName:Lp,backendName:"webgl",kernelFunc:cfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dfe=`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`,ffe=ar({opSnippet:dfe}),pfe={kernelName:Fp,backendName:"webgl",kernelFunc:ffe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mfe=Rd+`
  return sin(x);
`,gfe=ar({opSnippet:mfe}),yfe={kernelName:Op,backendName:"webgl",kernelFunc:gfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vfe=`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`,bfe=ar({opSnippet:vfe}),xfe={kernelName:Mp,backendName:"webgl",kernelFunc:bfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wfe=`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`,Sfe=ar({opSnippet:wfe}),_fe={kernelName:Pp,backendName:"webgl",kernelFunc:Sfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tfe=r=>{const{inputs:e,backend:t,attrs:n}=r,{x:s}=e,{blockShape:o,paddings:a}=n;xe(s.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const i=o.reduce((y,v)=>y*v),l=[[0,0]];l.push(...a);for(let y=1+o.length;y<s.shape.length;++y)l.push([0,0]);const u=[],h=OO({inputs:{x:s},backend:t,attrs:{paddings:l,constantValue:0}}),d=Qp(h.shape,o,i,!1),c=Jp(d.length,o.length,!1),f=em(h.shape,o,i,!1),p=Wt({inputs:{x:h},backend:t,attrs:{shape:d}}),m=ao({inputs:{x:p},backend:t,attrs:{perm:c}}),g=Wt({inputs:{x:m},backend:t,attrs:{shape:f}});return u.push(h),u.push(p),u.push(m),u.forEach(y=>t.disposeIntermediateTensorInfo(y)),g},kfe={kernelName:O0,backendName:"webgl",kernelFunc:Tfe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ife(r){const{inputs:e,backend:t}=r,{indices:n,values:s,denseShape:o,defaultValue:a}=e;if(o.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
         ${o.shape}`);if(n.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
         ${n.shape}`);if(s.shape.length!==1)throw new Error(`Values must be a vector, saw:
         ${s.shape}`);if(a.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${a.shape}`);const i=t.readSync(n.dataId),l=t.readSync(s.dataId),u=t.readSync(o.dataId),h=t.readSync(a.dataId)[0],[d,c,f,p,m]=woe(i,n.shape,n.dtype,l,s.dtype,u,h);return[t.makeTensorInfo(c,n.dtype,d),t.makeTensorInfo([c[0]],s.dtype,f),t.makeTensorInfo([p.length],"bool",new Uint8Array(p.map(g=>Number(g)))),t.makeTensorInfo([m.length],n.dtype,new Int32Array(m))]}const Efe={kernelName:bw,backendName:"webgl",kernelFunc:Ife};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cfe(r){const{inputs:e,backend:t}=r,{inputIndices:n,inputShape:s,newShape:o}=e;if(n.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape ${n.shape}`);if(s.shape.length!==1)throw new Error(`Input shape should be a vector but received shape ${s.shape}`);if(o.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${o.shape}`);const a=Array.from(t.readSync(s.dataId)),i=t.readSync(n.dataId),l=Array.from(t.readSync(o.dataId)),[u,h,d]=Soe(i,n.shape,n.dtype,a,l);return[t.makeTensorInfo(h,n.dtype,u),t.makeTensorInfo([d.length],o.dtype,new Int32Array(d))]}const $fe={kernelName:xw,backendName:"webgl",kernelFunc:Cfe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nfe(r){const{inputs:e,backend:t}=r,{data:n,indices:s,segmentIds:o}=e;if(n.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.shape.length!==1)throw new Error(`Indices should be a vector but received shape
              ${s.shape}`);if(o.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
              ${o.shape}`);const a=t.readSync(n.dataId),i=t.readSync(s.dataId),l=t.readSync(o.dataId),[u,h]=oO(a,n.shape,n.dtype,i,l,!0);return t.makeTensorInfo(h,n.dtype,u)}const Afe={kernelName:ww,backendName:"webgl",kernelFunc:Nfe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rfe(r){const{inputs:e,backend:t}=r,{data:n,indices:s,segmentIds:o}=e;if(n.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.shape.length!==1)throw new Error(`Indices should be a vector but received shape
             ${s.shape}`);if(o.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
             ${o.shape}`);const a=t.readSync(n.dataId),i=t.readSync(s.dataId),l=t.readSync(o.dataId),[u,h]=oO(a,n.shape,n.dtype,i,l);return t.makeTensorInfo(h,n.dtype,u)}const Dfe={kernelName:Sw,backendName:"webgl",kernelFunc:Rfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ofe(r){const{inputs:e,backend:t,attrs:n}=r,{sparseIndices:s,sparseValues:o,defaultValue:a}=e,{outputShape:i}=n,{sliceRank:l,numUpdates:u,sliceSize:h,strides:d,outputSize:c}=Hp(o,s,i),f=!1;if(o.dtype==="string"){const y=t.bufferSync(s),v=t.bufferSync(o),b=mu(t.readSync(a.dataId)[0]),w=voe(y,v,i,c,h,u,l,d,b,f);return t.makeTensorInfo(i,w.dtype,w.values)}const p=new FO(u,l,s.shape.length,o.shape.length,d,[c,1],f),m=t.runWebGLProgram(p,[o,s,a],o.dtype),g=Wt({inputs:{x:m},backend:t,attrs:{shape:i}});return t.disposeIntermediateTensorInfo(m),g}const Mfe={kernelName:FC,backendName:"webgl",kernelFunc:Ofe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ffe(r){const{inputs:e,backend:t,attrs:n}=r,{x:s}=e,{numOrSizeSplits:o,axis:a}=n,i=Hn(a,s.shape)[0],l=z2(s,o,i),u=s.shape.length,h=new Array(u).fill(0),d=s.shape.slice();return l.map(c=>{const f=[...d];f[i]=c;const p=Dd({inputs:{x:s},backend:t,attrs:{begin:h,size:f}});return h[i]+=c,p})}const Lfe={kernelName:M0,backendName:"webgl",kernelFunc:Ffe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aE="return sqrt(x);",Pfe=ar({opSnippet:aE,packedOpSnippet:aE,cpuKernelImpl:_oe}),jfe={kernelName:jp,backendName:"webgl",kernelFunc:Pfe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bfe="return x * x;",Ufe=ar({opSnippet:Bfe}),zfe={kernelName:_w,backendName:"webgl",kernelFunc:Ufe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lE="return (a - b) * (a - b);",Vfe=Ls({opSnippet:lE,packedOpSnippet:lE}),Gfe={kernelName:Bp,backendName:"webgl",kernelFunc:Vfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wfe({inputs:r,attrs:e,backend:t}){const{x:n}=r,s=Zi+`
    return x > 0.0 ? 1.0 : float(${e.alpha});
  `,o=new Tl(n.shape,s);return t.runWebGLProgram(o,[n],n.dtype)}const Hfe={kernelName:Wp,backendName:"webgl",kernelFunc:Wfe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qfe{constructor(e,t,n){this.variableNames=["x"],this.outputShape=n;const s=n.length,o=Dr(n.length),a=Dr(n.length);let i="";if(s===1)i="coords * strides + begin";else{let l=0;i=n.map((u,h)=>(l++,n.length===1?`coords * strides[${h}] + begin[${h}]`:`coords[${l-1}] * strides[${h}] + begin[${h}]`)).join(",")}this.userCode=`
      ${o} begin = ${o}(${e});
      ${o} strides = ${o}(${t});

      void main() {
        ${a} coords = getOutputCoords();
        setOutput(getX(${i}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xfe(r){const{inputs:e,backend:t,attrs:n}=r,{x:s}=e,{begin:o,end:a,strides:i,beginMask:l,endMask:u,ellipsisMask:h,newAxisMask:d,shrinkAxisMask:c}=n,{finalShapeSparse:f,finalShape:p,isIdentity:m,sliceDim0:g,isSimpleSlice:y,begin:v,end:b,strides:w}=zw(s.shape,o,a,i,l,u,h,d,c);let _;if(m)_=Wt({inputs:{x:s},backend:t,attrs:{shape:p}});else if(g||y){xe(s.shape.length>=1,()=>`Input must have rank at least 1, got: ${s.shape.length}`);const C=jw(v,b,w),N=Dd({inputs:{x:s},backend:t,attrs:{begin:v,size:C}});_=Wt({inputs:{x:N},backend:t,attrs:{shape:p}}),t.disposeIntermediateTensorInfo(N)}else if(t.shouldExecuteOnCPU([s])){const N=t.readSync(s.dataId),O=Wn(s.shape,s.dtype,N),D=Toe(f,O,w,v);_=t.makeTensorInfo(p,s.dtype,D.values)}else{const N=new qfe(v,w,f);_=t.runWebGLProgram(N,[s],s.dtype)}const I=Wt({inputs:{x:_},backend:t,attrs:{shape:p}});return t.disposeIntermediateTensorInfo(_),I}const Kfe={kernelName:Tw,backendName:"webgl",kernelFunc:Xfe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yfe(r){const{inputs:e,backend:t,attrs:n}=r,{separator:s,nGramWidths:o,leftPad:a,rightPad:i,padWidth:l,preserveShortSequences:u}=n,{data:h,dataSplits:d}=e,c=t.readSync(h.dataId),f=t.readSync(d.dataId),[p,m]=koe(c,f,s,o,a,i,l,u);return[t.makeTensorInfo([p.length],"string",p),t.makeTensorInfo(d.shape,"int32",m)]}const Zfe={kernelName:kw,backendName:"webgl",kernelFunc:Yfe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qfe(r){const{inputs:e,backend:t,attrs:n}=r,{skipEmpty:s}=n,{input:o,delimiter:a}=e;if(o.dtype!=="string")throw new Error("Input must be of datatype string");if(o.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${o.shape}`);if(a.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${a.shape}`);const i=t.readSync(o.dataId),l=t.readSync(a.dataId)[0],[u,h,d]=Ioe(i,l,s),c=h.length;return[t.makeTensorInfo([c,2],"int32",u),t.makeTensorInfo([c],"string",h),t.makeTensorInfo([2],"int32",new Int32Array(d))]}const Jfe={kernelName:Iw,backendName:"webgl",kernelFunc:Qfe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function epe(r){const{inputs:e,backend:t,attrs:n}=r,{numBuckets:s}=n,{input:o}=e;if(o.dtype!=="string")throw new Error("Input must be of datatype string");if(s<=0)throw new Error("Number of buckets must be at least 1");const a=t.readSync(o.dataId),i=Eoe(a,s);return t.makeTensorInfo(o.shape,"int32",i)}const tpe={kernelName:Ew,backendName:"webgl",kernelFunc:epe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const npe="return tan(x);",rpe=ar({opSnippet:npe}),spe={kernelName:zp,backendName:"webgl",kernelFunc:rpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ope=`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`,ipe=ar({opSnippet:ope}),ape={kernelName:Vp,backendName:"webgl",kernelFunc:ipe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lpe{constructor(e,t){this.variableNames=["A"];const n=new Array(e.length);for(let a=0;a<n.length;a++)n[a]=e[a]*t[a];this.outputShape=n,this.rank=n.length;const s=Dr(this.rank),o=upe(e);this.userCode=`
      void main() {
        ${s} resRC = getOutputCoords();
        setOutput(getA(${o}));
      }
    `}}function upe(r){const e=r.length;if(e>5)throw Error(`Tile for rank ${e} is not yet supported`);if(e===1)return`imod(resRC, ${r[0]})`;const t=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],n=[];for(let s=0;s<r.length;s++)n.push(`imod(${t[s]}, ${r[s]})`);return n.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LO(r){const{inputs:e,backend:t,attrs:n}=r,{x:s}=e,{reps:o}=n;if(s.dtype==="string"||s.shape.length>5){const l=t.readSync(s.dataId),u=s.dtype==="string"?l.map(c=>mu(c)):l,h=Wn(s.shape,s.dtype,u),d=$oe(h,o);return t.makeTensorInfo(d.shape,d.dtype,d.values)}const a=new lpe(s.shape,o);return t.runWebGLProgram(a,[s],s.dtype)}const cpe={kernelName:Gp,backendName:"webgl",kernelFunc:LO};class hpe{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}}class dpe{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cc(r,e){e!==null&&r.disposeIntermediateTensorInfo(e)}function uE(r){let e=1;for(;e<r;)e*=2;return e}function fpe(r){const{inputs:e,backend:t,attrs:n}=r,{x:s}=e,{k:o,sorted:a}=n,i=ut().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),l=ut().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),u=s.shape,h=u[u.length-1];if(t.shouldExecuteOnCPU([s])||h<i||o>l){const D=t.readSync(s.dataId),[M,P]=Noe(D,u,s.dtype,o,a);return[t.makeTensorInfo(M.shape,M.dtype,M.values),t.makeTensorInfo(P.shape,P.dtype,P.values)]}if(o===0)return u[u.length-1]=0,[t.makeTensorInfo(u,s.dtype,[]),t.makeTensorInfo(u,"int32",[])];if(h===1)return[s,ym({attrs:{shape:u,dtype:"int32",value:0},backend:t})];const d=t.texData.get(s.dataId),c=d!==null&&d.isPacked,f=c?t.unpackTensor(s):s,m=pt(u)/h,g=Wt({inputs:{x:f},attrs:{shape:[m,h]},backend:t});c&&cc(t,f);const y=uE(o),v=uE(h);let b=null;const w=()=>b===null?[g,g]:[g,b],_=(D,M,P)=>{const F=w(),B=new hpe(P),Z=[[h],[b===null?1:0],[Number.NEGATIVE_INFINITY],[D],[M]],Q=b;b=t.runWebGLProgram(B,F,"int32",Z),cc(t,Q)};for(let D=1;D<y;D*=2){const M=D*2;for(let P=D;P>=1;P/=2)_(M,P,[m,v])}for(let D=v;D>y;D/=2){const M=w(),P=new dpe([m,D/2]),B=[[h],[b===null?1:0],[y]],z=b;b=t.runWebGLProgram(P,M,"int32",B),cc(t,z);const Z=y/2,Q=Z*2;for(let K=Z;K>=1;K/=2)_(Q,K,b.shape)}let I=b;b=Dd({inputs:{x:b},backend:t,attrs:{begin:0,size:[m,o]}}),cc(t,I);let C=CO({inputs:{x:g,indices:b},backend:t,attrs:{axis:1,batchDims:1}});cc(t,g);const N=u.slice(0,-1);N.push(o),I=b,b=Wt({inputs:{x:b},attrs:{shape:N},backend:t}),cc(t,I);const O=C;return C=Wt({inputs:{x:C},attrs:{shape:N},backend:t}),cc(t,O),[C,b]}const ppe={kernelName:Cw,backendName:"webgl",kernelFunc:fpe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mpe{constructor(e,t,n,s,o,a){this.variableNames=["Image","Transforms"],this.outputShape=a;const i=n==="nearest"?1:2;let l;switch(s){case"constant":l=1;break;case"reflect":l=2;break;case"wrap":l=3;break;case"nearest":l=4;break;default:l=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${l} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${e} && 0 <= coordX && coordX < ${t}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${o});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${o});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${t}));
                float mapY = mapCoord(inY, float(${e}));

                if (${i} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gpe(r){const{inputs:e,backend:t,attrs:n}=r,{image:s,transforms:o}=e,{interpolation:a,fillMode:i,fillValue:l,outputShape:u}=n,[h,d,c,f]=s.shape,[p,m]=u!=null?u:[d,c],g=[h,p,m,f],y=new mpe(d,c,a,i,l,g);return t.runWebGLProgram(y,[s,o],"float32")}const ype={kernelName:$w,backendName:"webgl",kernelFunc:gpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vpe(r){const{inputs:e,attrs:t,backend:n}=r,{axis:s}=t,{x:o}=e;dm(o,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const a=n.readSync(o.dataId),{outputValues:i,outputShape:l,indices:u}=Aoe(a,s,o.shape,o.dtype);return[n.makeTensorInfo(l,o.dtype,i),n.makeTensorInfo([u.length],"int32",u)]}const bpe={kernelName:Nw,backendName:"webgl",kernelFunc:vpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xpe(r){const{inputs:e,backend:t,attrs:n}=r,{value:s}=e;let{axis:o}=n;o<0&&(o+=s.shape.length);const a=s,i=a.shape.length,l=s.shape[o],u=new Array(i-1);let h=0;for(let m=0;m<i;m++)m!==o&&(u[h++]=a.shape[m]);const d=[],c=new Array(i).fill(0),f=a.shape.slice();f[o]=1;const p=new Array(l);for(let m=0;m<p.length;m++){c[o]=m;const g=Dd({inputs:{x:a},backend:t,attrs:{begin:c,size:f}}),y=Wt({inputs:{x:g},backend:t,attrs:{shape:u}});p[m]=y,d.push(g)}return d.forEach(m=>t.disposeIntermediateTensorInfo(m)),p}const wpe={kernelName:L0,backendName:"webgl",kernelFunc:xpe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Spe{constructor(e,t){this.variableNames=["x","segmentIds"];const n=e.windowSize,s=e.batchSize,o=e.inSize,a=e.numSegments,i=a*Math.ceil(o/n);this.outputShape=[s,i];const l="0.0",u="sumValue",h=Math.floor(n/4)*4,d=n%4,c=`
        sumValue += dot(values, segFilter);
    `;let f="";o%n>0&&(f=`
        if (inIdx < 0 || inIdx >= ${o}) {
          return initializationValue;
        }
      `);let p="";o%n>0&&(p=`
        if (inIdx < 0 || inIdx >= ${o}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${l};

      float getValue(int batch, int inIdx) {
        ${f}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${p}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${a})) * float(${n}));
        int currentSeg = int(mod(float(outIdx), float(${a})));

        float sumValue = 0.0;

        for (int i = 0; i < ${h}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${c}
        }

        int inIdx = inOffset + ${h};
        if (${d===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${c}
        } else if (${d===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${c}
        } else if (${d===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${c}
        }
        setOutput(${u});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _pe(r){const{inputs:e,backend:t,attrs:n}=r,{x:s,segmentIds:o}=e,{numSegments:a}=n,i=s.shape.length,l=[];let u=0;const h=qr([u],i);let d=s;h!=null&&(d=ao({inputs:{x:s},backend:t,attrs:{perm:h}}),l.push(d),u=ts(1,i)[0]);const c=$N(d.shape,u,a),f=pt([d.shape[u]]),p=Wt({inputs:{x:d},backend:t,attrs:{shape:[-1,f]}});l.push(p);const m=Dw(s.dtype),g=(w,_,I,C,N)=>{const O=w.shape[0],D=w.shape[1],M=CN(D,N),P={windowSize:M,inSize:D,batchSize:O,numSegments:N},F=new Spe(P,_),B=t.compileAndRun(F,[w,I],C);if(l.push(B),B.shape[1]===N)return B;const z=MO({backend:t,attrs:{start:0,stop:N,step:1,dtype:"float32"}}),Z=LO({inputs:{x:z},backend:t,attrs:{reps:[D/M]}});return l.push(z),l.push(Z),g(B,_,Z,C,N)},y=g(p,"unsortedSegmentSum",o,m,a),v=Wt({inputs:{x:y},backend:t,attrs:{shape:c}});let b=v;if(h!=null){l.push(v);const w=Eu(h);b=ao({inputs:{x:b},backend:t,attrs:{perm:w}})}return l.forEach(w=>t.disposeIntermediateTensorInfo(w)),b}const Tpe={kernelName:P0,backendName:"webgl",kernelFunc:_pe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kpe=[Sie,Tie,Eie,Nie,Rie,Mie,Lie,jie,Vie,Wie,Xie,Zie,eae,sae,aae,uae,hae,mae,yae,bae,_ae,Nae,Rae,Oae,Bae,zae,Hae,oie,Kae,ele,sle,cle,dle,ple,gle,vle,wle,Tle,Ele,$le,Ale,Dle,Fle,Ple,zle,Gle,qle,Yle,Qle,nue,iue,cue,fue,gue,yue,bue,wue,_ue,kue,Eue,Aue,Oue,Lue,jue,zue,Wue,Kue,Jue,sie,tce,Qae,sce,ace,cce,aie,pce,vce,xce,Tce,Ece,Ace,Oce,Pce,zce,Wce,qce,Zce,Jce,the,ohe,ahe,uhe,hhe,fhe,yhe,whe,khe,Dhe,cie,Lhe,Bhe,Vhe,Hhe,Fae,Khe,Zhe,Jhe,nde,ide,uie,lde,cde,dde,fde,Lae,$he,gde,xde,Tde,die,Cde,Ade,Mde,Pde,zde,Gde,qde,Yde,Qde,tfe,sfe,afe,hfe,pfe,yfe,xfe,Cae,Ahe,_fe,kfe,Efe,$fe,Afe,Dfe,Mfe,Lfe,jfe,zfe,Gfe,Hfe,Kfe,Zfe,Jfe,tpe,Nhe,bie,spe,ape,cpe,ppe,ype,xie,bpe,wpe,Tpe,Yhe];for(const r of kpe)PC(r);/** @license See the LICENSE file. *//**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 *//**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ipe=1e-7,Epe=1e-4;class Cpe{constructor(e,t){this.backend=e,this.dataMover=t,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,t){this.dataIdsCount++,this.data.set(e,t)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}}class PO{refCount(e){return ui("refCount")}incRef(e){return ui("incRef")}timerAvailable(){return!0}time(e){return ui("time")}read(e){return ui("read")}readSync(e){return ui("readSync")}readToGPU(e,t){return ui("readToGPU")}numDataIds(){return ui("numDataIds")}disposeData(e,t){return ui("disposeData")}write(e,t,n){return ui("write")}move(e,t,n,s,o){return ui("move")}memory(){return ui("memory")}floatPrecision(){return ui("floatPrecision")}epsilon(){return this.floatPrecision()===32?Ipe:Epe}dispose(){return ui("dispose")}}function ui(r){throw new Error(`'${r}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jO(r){let e=r.length,t=0;for(;e>0;)t=Math.random()*e|0,e--,Ty(r,e,t)}function $pe(r,e){if(r.length!==e.length)throw new Error(`Array sizes must match to be shuffled together First array length was ${r.length}Second array length was ${e.length}`);let t=r.length,n=0;for(;t>0;)n=Math.random()*t|0,t--,Ty(r,t,n),Ty(e,t,n)}function Ff(r,e,t){return Math.max(r,Math.min(e,t))}function Npe(r){return r%2===0?r:r+1}function Ty(r,e,t){const n=r[e];r[e]=r[t],r[t]=n}function Ape(r){let e=0;for(let t=0;t<r.length;t++)e+=r[t];return e}function Rpe(r,e){const t=Math.random();return e*t+(1-t)*r}function Dpe(r,e){let t=0;for(let n=0;n<r.length;n++){const s=Number(r[n])-Number(e[n]);t+=s*s}return t}function Te(r,e){if(!r)throw new Error(typeof e=="string"?e:e())}function co(r,e,t=""){Te(Ja(r,e),()=>t+` Shapes ${r} and ${e} must match`)}function nh(r){Te(r!=null,()=>"The input to the tensor constructor must be a non-null value.")}function zc(r,e=[],t=!1){if(e==null&&(e=[]),Array.isArray(r)||Gs(r)&&!t)for(let n=0;n<r.length;++n)zc(r[n],e,t);else e.push(r);return e}function Ur(r){if(r.length===0)return 1;let e=r[0];for(let t=1;t<r.length;t++)e*=r[t];return e}function Ope(r){return r.length===0}function Ja(r,e){if(r===e)return!0;if(r==null||e==null||r.length!==e.length)return!1;for(let t=0;t<r.length;t++)if(r[t]!==e[t])return!1;return!0}function ud(r){return r%1===0}function Mpe(r){if(Math.tanh!=null)return Math.tanh(r);if(r===1/0)return 1;if(r===-1/0)return-1;{const e=Math.exp(2*r);return(e-1)/(e+1)}}function Fpe(r){const e=Math.ceil(Math.sqrt(r));return[e,Math.ceil(r/e)]}function Lpe(r){const e=new Uint32Array(r);for(let t=0;t<r;++t)e[t]=t;return jO(e),e}function Tf(r,e){return e<=r.length?r:r+" ".repeat(e-r.length)}function Ppe(r,e=n=>0,t){return new Promise((n,s)=>{let o=0;const a=()=>{if(r()){n();return}o++;const i=e(o);if(t!=null&&o>=t){s();return}setTimeout(a,i)};a()})}function jpe(r,e){let t=1,n=-1;for(let o=0;o<r.length;++o)if(r[o]>=0)t*=r[o];else if(r[o]===-1){if(n!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${n} and dim ${o}`);n=o}else if(r[o]<0)throw Error(`Shapes can not be < 0. Found ${r[o]} at dim ${o}`);if(n===-1){if(e>0&&e!==t)throw Error(`Size(${e}) must match the product of shape ${r}`);return r}if(t===0)throw Error(`Cannot infer the missing size in [${r}] when there are 0 elements`);if(e%t!==0)throw Error(`The implicit shape can't be a fractional number. Got ${e} / ${t}`);const s=r.slice();return s[n]=e/t,s}function vm(r,e){const t=e.length;return r=r==null?e.map((n,s)=>s):[].concat(r),Te(r.every(n=>n>=-t&&n<t),()=>`All values in axis param must be in range [-${t}, ${t}) but got axis ${r}`),Te(r.every(n=>ud(n)),()=>`All values in axis param must be integers but got axis ${r}`),r.map(n=>n<0?t+n:n)}function BO(r,e){const t=[],n=[],s=e!=null&&Array.isArray(e)&&e.length===0,o=e==null||s?null:vm(e,r).sort();let a=0;for(let i=0;i<r.length;++i){if(o!=null){if(o[a]===i&&r[i]!==1)throw new Error(`Can't squeeze axis ${i} since its dim '${r[i]}' is not 1`);(o[a]==null||o[a]>i)&&r[i]===1&&(t.push(r[i]),n.push(i)),o[a]<=i&&a++}r[i]!==1&&(t.push(r[i]),n.push(i))}return{newShape:t,keptDims:n}}function UO(r,e){let t=null;if(r==null||r==="float32")t=new Float32Array(e);else if(r==="int32")t=new Int32Array(e);else if(r==="bool")t=new Uint8Array(e);else throw new Error(`Unknown data type ${r}`);return t}function zO(r,e){let t=null;if(r==null||r==="float32")t=new Float32Array(e);else if(r==="int32")t=new Int32Array(e);else if(r==="bool")t=new Uint8Array(e);else if(r==="string")t=new Array(e);else throw new Error(`Unknown data type ${r}`);return t}function VO(r,e){for(let t=0;t<r.length;t++){const n=r[t];if(isNaN(n)||!isFinite(n))throw Error(`A tensor of type ${e} being uploaded contains ${n}.`)}}function GO(r){return r==="bool"||r==="complex64"||r==="float32"||r==="int32"||r==="string"}function Bpe(r,e){return!(e==="complex64"||e==="float32"&&r!=="complex64"||e==="int32"&&r!=="float32"&&r!=="complex64"||e==="bool"&&r==="bool")}function Gs(r){return r instanceof Float32Array||r instanceof Int32Array||r instanceof Uint8Array||r instanceof Uint8ClampedArray}function nx(r){if(r==="float32"||r==="int32")return 4;if(r==="complex64")return 8;if(r==="bool")return 1;throw new Error(`Unknown dtype ${r}`)}function WO(r){if(r==null)return 0;let e=0;return r.forEach(t=>e+=t.length),e}function iu(r){return typeof r=="string"||r instanceof String}function HO(r){return typeof r=="boolean"}function qO(r){return typeof r=="number"}function v1(r){return Array.isArray(r)?v1(r[0]):r instanceof Float32Array?"float32":r instanceof Int32Array||r instanceof Uint8Array||r instanceof Uint8ClampedArray?"int32":qO(r)?"float32":iu(r)?"string":HO(r)?"bool":"float32"}function wu(r){return!!(r&&r.constructor&&r.call&&r.apply)}function ky(r,e){for(let t=e;t<r;++t)if(r%t===0)return t;return r}function Od(r){const e=r.length;if(e<2)return[];const t=new Array(e-1);t[e-2]=r[e-1];for(let n=e-3;n>=0;--n)t[n]=t[n+1]*r[n+1];return t}function XO(r,e,t,n=!1){const s=new Array;if(e.length===1){const o=e[0]*(n?2:1);for(let a=0;a<o;a++)s[a]=t[r+a]}else{const o=e[0],a=e.slice(1),i=a.reduce((l,u)=>l*u)*(n?2:1);for(let l=0;l<o;l++)s[l]=XO(r+l*i,a,t,n)}return s}function Ic(r,e,t=!1){if(r.length===0)return e[0];const n=r.reduce((s,o)=>s*o)*(t?2:1);if(n===0)return[];if(n!==e.length)throw new Error(`[${r}] does not match the input size ${e.length}${t?" for a complex tensor":""}.`);return XO(0,r,e,t)}function NS(r,e){const t=b1(r,e);for(let n=0;n<t.length;n++)t[n]=1;return t}function b1(r,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(r);if(e==="int32")return new Int32Array(r);if(e==="bool")return new Uint8Array(r);throw new Error(`Unknown data type ${e}`)}function Upe(r,e){const t=r.reduce((n,s)=>n*s,1);if(e==null||e==="float32")return Ic(r,new Float32Array(t));if(e==="int32")return Ic(r,new Int32Array(t));if(e==="bool")return Ic(r,new Uint8Array(t));throw new Error(`Unknown data type ${e}`)}function AS(r){r.forEach(e=>{Te(Number.isInteger(e)&&e>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${r}].`)})}function zpe(r,e,t){if(e===0)return 0;if(e===1)return r[0];let n=r[r.length-1];for(let s=0;s<r.length-1;++s)n+=t[s]*r[s];return n}function Vpe(r,e,t){if(e===0)return[];if(e===1)return[r];const n=new Array(e);for(let s=0;s<n.length-1;++s)n[s]=Math.floor(r/t[s]),r-=n[s]*t[s];return n[n.length-1]=r,n}function cd(r){return r&&r.then&&typeof r.then=="function"}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cE="tfjsflags";class KO{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=Gpe,this.populateURLFlags()}setPlatform(e,t){this.platform!=null&&(Pn().getBool("IS_TEST")||Pn().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${t}.`)),this.platformName=e,this.platform=t}registerFlag(e,t,n){if(this.flagRegistry[e]={evaluationFn:t,setHook:n},this.urlFlags[e]!=null){const s=this.urlFlags[e];Pn().getBool("IS_TEST")||Pn().getBool("PROD")||console.warn(`Setting feature override from URL ${e}: ${s}.`),this.set(e,s)}}async getAsync(e){return e in this.flags?this.flags[e]:(this.flags[e]=await this.evaluateFlag(e),this.flags[e])}get(e){if(e in this.flags)return this.flags[e];const t=this.evaluateFlag(e);if(cd(t))throw new Error(`Flag ${e} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[e]=t,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,t){if(this.flagRegistry[e]==null)throw new Error(`Cannot set flag ${e} as it has not been registered.`);this.flags[e]=t,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(t)}evaluateFlag(e){if(this.flagRegistry[e]==null)throw new Error(`Cannot evaluate flag '${e}': no evaluation function found.`);return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global=="undefined"||typeof this.global.location=="undefined"||typeof this.global.location.search=="undefined")return;const e=this.getQueryParams(this.global.location.search);cE in e&&e[cE].split(",").forEach(n=>{const[s,o]=n.split(":");this.urlFlags[s]=Hpe(s,o)})}}function Gpe(r){const e={};return r.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(t,...n)=>(Wpe(e,n[0],n[1]),n.join("="))),e}function Wpe(r,e,t){r[decodeURIComponent(e)]=decodeURIComponent(t||"")}function Hpe(r,e){if(e=e.toLowerCase(),e==="true"||e==="false")return e==="true";if(`${+e}`===e)return+e;throw new Error(`Could not parse value flag value ${e} for flag ${r}.`)}function Pn(){return RS}let RS=null;function qpe(r){RS=r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Jv;function YO(){if(Jv==null){let r;if(typeof window!="undefined")r=window;else if(typeof global!="undefined")r=global;else if(typeof process!="undefined")r=process;else if(typeof self!="undefined")r=self;else throw new Error("Could not find a global object");Jv=r}return Jv}function Xpe(){const r=YO();return r._tfGlobals==null&&(r._tfGlobals=new Map),r._tfGlobals}function DS(r,e){const t=Xpe();if(t.has(r))return t.get(r);{const n=e();return t.set(r,n),t.get(r)}}const ZO="Abs",QO="Acos",JO="Acosh",OS="Add",e3="AddN",t3="All",n3="Any",r3="ArgMax",s3="ArgMin",o3="Asin",i3="Asinh",a3="Atan",l3="Atanh",u3="Atan2",c3="AvgPool",Kpe="AvgPoolGrad",h3="AvgPool3D",Ype="AvgPool3DGrad",d3="BatchMatMul",f3="BatchToSpaceND",p3="Bincount",Zpe="BroadcastTo",m3="BroadcastArgs",MS="Cast",g3="Ceil",y3="ClipByValue",v3="Complex",b3="ComplexAbs",x3="Concat",w3="Conv2D",S3="Conv2DBackpropFilter",_3="Conv2DBackpropInput",T3="Conv3D",Qpe="Conv3DBackpropFilterV2",k3="Conv3DBackpropInputV2",I3="Cos",E3="Cosh",C3="Cumsum",$3="CropAndResize",N3="DenseBincount",A3="DepthToSpace",R3="DepthwiseConv2dNative",D3="DepthwiseConv2dNativeBackpropFilter",O3="DepthwiseConv2dNativeBackpropInput",M3="Diag",F3="Dilation2D",Jpe="Dilation2DBackpropInput",eme="Dilation2DBackpropFilter",L3="RealDiv",P3="Einsum",j3="Elu",tme="EluGrad",B3="Erf",U3="Equal",z3="Exp",V3="ExpandDims",G3="Expm1",W3="FFT",H3="Fill",q3="FlipLeftRight",X3="Floor",K3="FloorDiv",Y3="FusedBatchNorm",Z3="GatherV2",Q3="GatherNd",J3="Greater",eM="GreaterEqual",FS="Identity",tM="IFFT",nM="Imag",rM="IsFinite",sM="IsInf",oM="IsNan",iM="LeakyRelu",aM="Less",lM="LessEqual",uM="LinSpace",cM="Log",hM="Log1p",dM="LogicalAnd",fM="LogicalNot",pM="LogicalOr",nme="LogSoftmax",mM="LRN",rme="LRNGrad",gM="Max",yM="Maximum",vM="MaxPool",sme="MaxPoolGrad",bM="MaxPool3D",ome="MaxPool3DGrad",xM="MaxPoolWithArgmax",wM="Mean",SM="Min",_M="Minimum",TM="MirrorPad",kM="Mod",IM="Multinomial",EM="Multiply",CM="Neg",$M="NotEqual",NM="NonMaxSuppressionV3",AM="NonMaxSuppressionV4",RM="NonMaxSuppressionV5",DM="OnesLike",OM="OneHot",MM="Pack",FM="PadV2",ime="Pool",LM="Pow",PM="Prelu",jM="Prod",BM="Range",UM="Real",zM="Reciprocal",VM="Relu",GM="Reshape",WM="ResizeNearestNeighbor",ame="ResizeNearestNeighborGrad",HM="ResizeBilinear",lme="ResizeBilinearGrad",qM="Relu6",XM="Reverse",KM="Round",YM="Rsqrt",ZM="ScatterNd",QM="Select",JM="Selu",eF="Slice",tF="Sin",nF="Sinh",rF="Sign",sF="Sigmoid",oF="Softplus",iF="Sqrt",aF="Sum",lF="SpaceToBatchND",uF="SplitV",cF="Softmax",hF="SparseFillEmptyRows",dF="SparseReshape",fF="SparseSegmentMean",pF="SparseSegmentSum",mF="SparseToDense",gF="SquaredDifference",ume="Square",yF="StridedSlice",vF="StringNGrams",bF="StringSplit",xF="StringToHashBucketFast",wF="Sub",SF="Tan",_F="Tanh",LS="Tile",TF="TopK",kF="Transform",IF="Transpose",EF="Unique",CF="Unpack",$F="UnsortedSegmentSum",NF="ZerosLike",AF="Step",rx="FromPixels",RF="RotateWithOffset",sx="_FusedMatMul",ox="FusedConv2D",ix="FusedDepthwiseConv2D";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nu(...r){Pn().getBool("IS_TEST")||Pn().getBool("PROD")||console.warn(...r)}function cme(...r){Pn().getBool("IS_TEST")||Pn().getBool("PROD")||console.log(...r)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hd=DS("kernelRegistry",()=>new Map),Lf=DS("gradRegistry",()=>new Map);function Iy(r,e){const t=PS(r,e);return hd.get(t)}function ax(r){return Lf.get(r)}function Ey(r){const e=hd.entries(),t=[];for(;;){const{done:n,value:s}=e.next();if(n)break;const[o,a]=s,[i]=o.split("_");i===r&&t.push(a)}return t}function DF(r){const{kernelName:e,backendName:t}=r,n=PS(e,t);hd.has(n)&&nu(`The kernel '${e}' for backend '${t}' is already registered`),hd.set(n,r)}function hme(r){const{kernelName:e}=r;Lf.has(e)&&Pn().getBool("DEBUG")&&nu(`Overriding the gradient for '${e}'`),Lf.set(e,r)}function dme(r,e){const t=PS(r,e);if(!hd.has(t))throw new Error(`The kernel '${r}' for backend '${e}' is not registered`);hd.delete(t)}function fme(r){if(!Lf.has(r))throw new Error(`The gradient '${r}' for backend is not registered`);Lf.delete(r)}function pme(r,e){Ey(r).forEach(n=>{const s=Object.assign({},n,{backendName:e});DF(s)})}function PS(r,e){return`${e}_${r}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yc=Jg||GC;function bm(r){return yc.fromString(r,!0,16)}const OF=bm("c3a5c85c97cb3127"),fc=bm("b492b66fbe98f273"),no=bm("9ae16a3b2f90404f");function lx(r){return r.xor(r.shru(47))}function MF(r,e,t){const n=r.slice(e,e+t);return yc.fromBytes(Array.from(n),!0,!0)}function $r(r,e){return MF(r,e,8)}function hE(r,e){return MF(r,e,4)}function ws(r,e){return e===0?r:r.shru(e).or(r.shl(64-e))}function fu(r,e,t=bm("9ddfea08eb382d69")){let n=r.xor(e).mul(t);n=n.xor(n.shru(47));let s=e.xor(n).mul(t);return s=s.xor(s.shru(47)),s=s.mul(t),s}function mme(r,e,t,n,s,o){s=s.add(r),o=ws(o.add(s).add(n),21);const a=s;return s=s.add(e),s=s.add(t),o=o.add(ws(s,44)),[s.add(n),o.add(a)]}function _g(r,e,t,n){return mme($r(r,e),$r(r,e+8),$r(r,e+16),$r(r,e+24),t,n)}function gme(r,e=r.length){if(e>=8){const t=no.add(e*2),n=$r(r,0).add(no),s=$r(r,e-8),o=ws(s,37).mul(t).add(n),a=ws(n,25).add(s).mul(t);return fu(o,a,t)}if(e>=4){const t=no.add(e*2),n=hE(r,0);return fu(n.shl(3).add(e),hE(r,e-4),t)}if(e>0){const t=r[0],n=r[e>>1],s=r[e-1],o=t+(n<<8),a=e+(s<<2);return lx(no.mul(o).xor(OF.mul(a))).mul(no)}return no}function yme(r,e=r.length){const t=no.add(e*2),n=$r(r,0).mul(fc),s=$r(r,8),o=$r(r,e-8).mul(t),a=$r(r,e-16).mul(no);return fu(ws(n.add(s),43).add(ws(o,30)).add(a),n.add(ws(s.add(no),18)).add(o),t)}function vme(r,e=r.length){const t=no.add(e*2),n=$r(r,0).mul(no),s=$r(r,8),o=$r(r,e-8).mul(t),a=$r(r,e-16).mul(no),i=ws(n.add(s),43).add(ws(o,30)).add(a),l=fu(i,n.add(ws(s.add(no),18)).add(o),t),u=$r(r,16).mul(t),h=$r(r,24),d=i.add($r(r,e-32)).mul(t),c=l.add($r(r,e-24)).mul(t);return fu(ws(u.add(h),43).add(ws(d,30)).add(c),u.add(ws(h.add(n),18)).add(d),t)}function bme(r,e=r.length){const t=yc.fromNumber(81,!0);if(e<=32)return e<=16?gme(r,e):yme(r,e);if(e<=64)return vme(r,e);let n=t,s=t.mul(fc).add(113),o=lx(s.mul(no).add(113)).mul(no),a=[yc.UZERO,yc.UZERO],i=[yc.UZERO,yc.UZERO];n=n.mul(no).add($r(r,0));let l=0;const u=(e-1>>6)*64,h=u+(e-1&63)-63;do n=ws(n.add(s).add(a[0]).add($r(r,l+8)),37).mul(fc),s=ws(s.add(a[1]).add($r(r,l+48)),42).mul(fc),n=n.xor(i[1]),s=s.add(a[0]).add($r(r,l+40)),o=ws(o.add(i[0]),33).mul(fc),a=_g(r,l,a[1].mul(fc),n.add(i[0])),i=_g(r,l+32,o.add(i[1]),s.add($r(r,l+16))),[o,n]=[n,o],l+=64;while(l!==u);const d=fc.add(o.and(255).shl(1));return l=h,i[0]=i[0].add(e-1&63),a[0]=a[0].add(i[0]),i[0]=i[0].add(a[0]),n=ws(n.add(s).add(a[0]).add($r(r,l+8)),37).mul(d),s=ws(s.add(a[1]).add($r(r,l+48)),42).mul(d),n=n.xor(i[1].mul(9)),s=s.add(a[0].mul(9).add($r(r,l+40))),o=ws(o.add(i[0]),33).mul(d),a=_g(r,l,a[1].mul(d),n.add(i[0])),i=_g(r,l+32,o.add(i[1]),s.add($r(r,l+16))),[o,n]=[n,o],fu(fu(a[0],i[0],d).add(lx(s).mul(OF)).add(o),fu(a[1],i[1],d).add(n),d)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xme(r,e){return e==="string"?xm(r):x1([r],e)}function wme(r,e){return r instanceof Float32Array&&e==="float32"||r instanceof Int32Array&&e==="int32"||r instanceof Uint8Array&&e==="bool"}function x1(r,e){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(r)&&(r=zc(r)),Pn().getBool("DEBUG")&&VO(r,e),wme(r,e))return r;if(e==null||e==="float32"||e==="complex64")return new Float32Array(r);if(e==="int32")return new Int32Array(r);if(e==="bool"){const t=new Uint8Array(r.length);for(let n=0;n<t.length;++n)Math.round(r[n])!==0&&(t[n]=1);return t}else throw new Error(`Unknown data type ${e}`)}function Pf(){return Pn().platform.now()}function Sme(r,e){return Pn().platform.fetch(r,e)}function xm(r,e="utf-8"){return e=e||"utf-8",Pn().platform.encode(r,e)}function Cy(r,e="utf-8"){return e=e||"utf-8",Pn().platform.decode(r,e)}var _me=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",createScalarValue:xme,toTypedArray:x1,now:Pf,fetch:Sme,encodeString:xm,decodeString:Cy,shuffle:jO,shuffleCombo:$pe,clamp:Ff,nearestLargerEven:Npe,swap:Ty,sum:Ape,randUniform:Rpe,distSquared:Dpe,assert:Te,assertShapesMatch:co,assertNonNull:nh,flatten:zc,sizeFromShape:Ur,isScalarShape:Ope,arraysEqual:Ja,isInt:ud,tanh:Mpe,sizeToSquarishShape:Fpe,createShuffledIndices:Lpe,rightPad:Tf,repeatedTry:Ppe,inferFromImplicitShape:jpe,parseAxisParam:vm,squeezeShape:BO,getTypedArrayFromDType:UO,getArrayFromDType:zO,checkConversionForErrors:VO,isValidDtype:GO,hasEncodingLoss:Bpe,isTypedArray:Gs,bytesPerElement:nx,bytesFromStringArray:WO,isString:iu,isBoolean:HO,isNumber:qO,inferDtype:v1,isFunction:wu,nearestDivisor:ky,computeStrides:Od,toNestedArray:Ic,makeOnesTypedArray:NS,makeZerosTypedArray:b1,makeZerosNestedTypedArray:Upe,assertNonNegativeIntegerDimensions:AS,locToIndex:zpe,indexToLoc:Vpe,isPromise:cd,hexToLong:bm,fingerPrint64:bme});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Tme{constructor(e,t){this.backendTimer=e,this.logger=t,t==null&&(this.logger=new Ime)}profileKernel(e,t,n){let s;const o=()=>{s=n()};let a;const i=Pf();if(this.backendTimer.timerAvailable())a=this.backendTimer.time(o);else{o();for(const u of s)u.dataSync();a=Promise.resolve({kernelMs:Pf()-i})}if(Pn().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let u=0;u<s.length;u++){const h=s[u];h.data().then(d=>{kme(d,h.dtype,e)})}return{kernelName:e,outputs:s,inputs:t,timeMs:a.then(u=>u.kernelMs),extraInfo:a.then(u=>u.getExtraProfileInfo!=null?u.getExtraProfileInfo():"")}}logKernelProfile(e){const{kernelName:t,outputs:n,timeMs:s,inputs:o,extraInfo:a}=e;n.forEach(i=>{Promise.all([i.data(),s,a]).then(l=>{this.logger.logKernelProfile(t,i,l[0],l[1],o,l[2])})})}}function kme(r,e,t){if(e!=="float32")return!1;for(let n=0;n<r.length;n++){const s=r[n];if(isNaN(s)||!isFinite(s))return console.warn(`Found ${s} in the result of '${t}'`),!0}return!1}class Ime{logKernelProfile(e,t,n,s,o,a){const i=typeof s=="number"?Tf(`${s}ms`,9):s.error,l=Tf(e,25),u=t.rank,h=t.size,d=Tf(t.shape.toString(),14);let c="";for(const f in o){const p=o[f];if(p!=null){const m=p.shape||t.shape,g=m.length;c+=`${f}: ${g}D ${g>0?m:""} `}}console.log(`%c${l}	%c${i}	%c${u}D ${d}	%c${h}	%c${c}	%c${a}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eme(r,e,t){const n={},s={};for(let l=0;l<e.length;l++)n[e[l].id]=!0;for(let l=0;l<r.length;l++){const u=r[l],h=u.inputs;for(const d in h){const c=h[d];let f=!1;for(let p=0;p<e.length;p++)if(n[c.id]){u.outputs.forEach(m=>n[m.id]=!0),f=!0,s[u.id]=!0;break}if(f)break}}const o={};o[t.id]=!0;const a={};for(let l=r.length-1;l>=0;l--){const u=r[l],h=u.inputs;for(let d=0;d<u.outputs.length;d++)if(o[u.outputs[d].id]){for(const c in h)o[h[c].id]=!0,a[u.id]=!0;break}}const i=[];for(let l=0;l<r.length;l++){const u=r[l];if(s[u.id]&&a[u.id]){const h={};for(const c in u.inputs){const f=u.inputs[c];n[f.id]&&(h[c]=f)}const d=Object.assign({},u);d.inputs=h,d.outputs=u.outputs,i.push(d)}}return i}function Cme(r,e,t,n){for(let s=e.length-1;s>=0;s--){const o=e[s],a=[];if(o.outputs.forEach(l=>{const u=r[l.id];u!=null?a.push(u):a.push(null)}),o.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${o.kernelName}.`);const i=o.gradient(a);for(const l in o.inputs){if(!(l in i))throw new Error(`Cannot backprop through input ${l}. Available gradients found: ${Object.keys(i)}.`);const u=t(()=>i[l]());if(u.dtype!=="float32")throw new Error(`Error in gradient for op ${o.kernelName}. The gradient of input ${l} must have 'float32' dtype, but has '${u.dtype}'`);const h=o.inputs[l];if(!Ja(u.shape,h.shape))throw new Error(`Error in gradient for op ${o.kernelName}. The gradient of input '${l}' has shape '${u.shape}', which does not match the shape of the input '${h.shape}'`);if(r[h.id]==null)r[h.id]=u;else{const d=r[h.id];r[h.id]=n(d,u),d.dispose()}}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dE=20,nf=3,eb=7;function $me(r,e,t,n){const s=Od(e),o=Nme(r,e,t,s),a=e.length,i=Hg(r,e,t,s,o),l=["Tensor"];return n&&(l.push(`  dtype: ${t}`),l.push(`  rank: ${a}`),l.push(`  shape: [${e}]`),l.push("  values:")),l.push(i.map(u=>"    "+u).join(`
`)),l.join(`
`)}function Nme(r,e,t,n){const s=Ur(e),o=n[n.length-1],a=new Array(o).fill(0),i=e.length,l=t==="complex64"?mf(r):r;if(i>1)for(let u=0;u<s/o;u++){const h=u*o;for(let d=0;d<o;d++)a[d]=Math.max(a[d],pf(l[h+d],0,t).length)}return a}function pf(r,e,t){let n;return Array.isArray(r)?n=`${parseFloat(r[0].toFixed(eb))} + ${parseFloat(r[1].toFixed(eb))}j`:iu(r)?n=`'${r}'`:t==="bool"?n=FF(r):n=parseFloat(r.toFixed(eb)).toString(),Tf(n,e)}function FF(r){return r===0?"false":"true"}function Hg(r,e,t,n,s,o=!0){const a=t==="complex64"?2:1,i=e[0],l=e.length;if(l===0){if(t==="complex64"){const m=mf(r);return[pf(m[0],0,t)]}return t==="bool"?[FF(r[0])]:[r[0].toString()]}if(l===1){if(i>dE){const g=nf*a;let y=Array.from(r.slice(0,g)),v=Array.from(r.slice((i-nf)*a,i*a));return t==="complex64"&&(y=mf(y),v=mf(v)),["["+y.map((b,w)=>pf(b,s[w],t)).join(", ")+", ..., "+v.map((b,w)=>pf(b,s[i-nf+w],t)).join(", ")+"]"]}const m=t==="complex64"?mf(r):Array.from(r);return["["+m.map((g,y)=>pf(g,s[y],t)).join(", ")+"]"]}const u=e.slice(1),h=n.slice(1),d=n[0]*a,c=[];if(i>dE){for(let m=0;m<nf;m++){const g=m*d,y=g+d;c.push(...Hg(r.slice(g,y),u,t,h,s,!1))}c.push("...");for(let m=i-nf;m<i;m++){const g=m*d,y=g+d;c.push(...Hg(r.slice(g,y),u,t,h,s,m===i-1))}}else for(let m=0;m<i;m++){const g=m*d,y=g+d;c.push(...Hg(r.slice(g,y),u,t,h,s,m===i-1))}const f=l===2?",":"";c[0]="["+c[0]+f;for(let m=1;m<c.length-1;m++)c[m]=" "+c[m]+f;let p=`,
`;for(let m=2;m<l;m++)p+=`
`;return c[c.length-1]=" "+c[c.length-1]+"]"+(o?"":p),c}function mf(r){const e=[];for(let t=0;t<r.length;t+=2)e.push([r[t],r[t+1]]);return e}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $y{constructor(e,t,n){if(this.dtype=t,this.shape=e.slice(),this.size=Ur(e),n!=null){const s=n.length;Te(s===this.size,()=>`Length of values '${s}' does not match the size inferred by the shape '${this.size}'.`)}if(t==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||zO(t,this.size),this.strides=Od(e)}set(e,...t){t.length===0&&(t=[0]),Te(t.length===this.rank,()=>`The number of provided coordinates (${t.length}) must match the rank (${this.rank})`);const n=this.locToIndex(t);this.values[n]=e}get(...e){e.length===0&&(e=[0]);let t=0;for(const s of e){if(s<0||s>=this.shape[t]){const o=`Requested out of range element at ${e}.   Buffer shape=${this.shape}`;throw new Error(o)}t++}let n=e[e.length-1];for(let s=0;s<e.length-1;++s)n+=this.strides[s]*e[s];return this.values[n]}locToIndex(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];let t=e[e.length-1];for(let n=0;n<e.length-1;++n)t+=this.strides[n]*e[n];return t}indexToLoc(e){if(this.rank===0)return[];if(this.rank===1)return[e];const t=new Array(this.shape.length);for(let n=0;n<t.length-1;++n)t[n]=Math.floor(e/this.strides[n]),e-=t[n]*this.strides[n];return t[t.length-1]=e,t}get rank(){return this.shape.length}toTensor(){return ua().makeTensor(this.values,this.shape,this.dtype)}}let ua=null,Oh=null;function Ame(r){ua=r}function Rme(r){Oh=r}class pr{constructor(e,t,n,s){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=t||"float32",this.size=Ur(e),this.strides=Od(e),this.dataId=n,this.id=s,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const e=await this.data();return Oh.buffer(this.shape,this.dtype,e)}bufferSync(){return Oh.buffer(this.shape,this.dtype,this.dataSync())}async array(){const e=await this.data();return Ic(this.shape,e,this.dtype==="complex64")}arraySync(){return Ic(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const e=ua().read(this.dataId);if(this.dtype==="string"){const t=await e;try{return t.map(n=>Cy(n))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),ua().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();const e=ua().readSync(this.dataId);if(this.dtype==="string")try{return e.map(t=>Cy(t))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();const e=await ua().read(this.dataId);return this.dtype==="string"?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(ua().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(e=!1){return Oh.print(this,e)}clone(){return this.throwIfDisposed(),Oh.clone(this)}toString(e=!1){const t=this.dataSync();return $me(t,this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),Oh.cast(this,e)}variable(e=!0,t,n){return this.throwIfDisposed(),ua().makeVariable(this,e,t,n)}}Object.defineProperty(pr,Symbol.hasInstance,{value:r=>!!r&&r.data!=null&&r.dataSync!=null&&r.throwIfDisposed!=null});function Dme(){return DS("Tensor",()=>pr)}Dme();class jf extends pr{constructor(e,t,n,s){super(e.shape,e.dtype,e.dataId,s),this.trainable=t,this.name=n}assign(e){if(e.dtype!==this.dtype)throw new Error(`dtype of the new value (${e.dtype}) and previous value (${this.dtype}) must match`);if(!Ja(e.shape,this.shape))throw new Error(`shape of the new value (${e.shape}) and previous value (${this.shape}) must match`);ua().disposeTensor(this),this.dataId=e.dataId,ua().incRef(this,null)}dispose(){ua().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(jf,Symbol.hasInstance,{value:r=>r instanceof pr&&r.assign!=null&&r.assign instanceof Function});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var ux;(function(r){r.R0="R0",r.R1="R1",r.R2="R2",r.R3="R3",r.R4="R4",r.R5="R5",r.R6="R6"})(ux||(ux={}));var cx;(function(r){r.float32="float32",r.int32="int32",r.bool="int32",r.complex64="complex64"})(cx||(cx={}));var hx;(function(r){r.float32="float32",r.int32="int32",r.bool="bool",r.complex64="complex64"})(hx||(hx={}));var dx;(function(r){r.float32="float32",r.int32="float32",r.bool="float32",r.complex64="complex64"})(dx||(dx={}));var fx;(function(r){r.float32="complex64",r.int32="complex64",r.bool="complex64",r.complex64="complex64"})(fx||(fx={}));const Ome={float32:dx,int32:cx,bool:hx,complex64:fx};function w1(r,e){if(r==="string"||e==="string"){if(r==="string"&&e==="string")return"string";throw new Error(`Can not upcast ${r} with ${e}`)}return Ome[r][e]}function Mme(r){return w1(r,"int32")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hr(r,e){if(r.dtype===e.dtype)return[r,e];const t=w1(r.dtype,e.dtype);return[r.cast(t),e.cast(t)]}function LF(r,e){Te(r.dtype===e.dtype,()=>`The dtypes of the first(${r.dtype}) and second(${e.dtype}) input must match`)}function Fme(r,e){return e.some(t=>t.id===r.id)}function jS(r){const e=[];return PF(r,e,new Set),e}function PF(r,e,t){if(r==null)return;if(r instanceof pr){e.push(r);return}if(!Lme(r))return;const n=r;for(const s in n){const o=n[s];t.has(o)||(t.add(o),PF(o,e,t))}}function Lme(r){return Array.isArray(r)||typeof r=="object"}var Pme=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",makeTypesMatch:Hr,assertTypesMatch:LF,isTensorInList:Fme,getTensorsInContainer:jS});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tb(r){return r.kernelName!=null}class fE{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(const e in this.registeredVariables)this.registeredVariables[e].dispose()}}class dd{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new fE}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const e=this.getSortedBackends();for(let t=0;t<e.length;t++){const n=e[t];if(await this.initializeBackend(n).success){await this.setBackend(n);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:e,asyncInit:t}=this.initializeBackendsAndReturnBest();if(t)throw new Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry))if(e in this.registryFactory){const{asyncInit:t}=this.initializeBackend(e);if(t)return null}else return null;return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,t,n=1){return e in this.registryFactory?(nu(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:t,priority:n},!0)}async setBackend(e){if(this.registryFactory[e]==null)throw new Error(`Backend name '${e}' not found in registry`);if(this.backendName=e,this.registry[e]==null){this.backendInstance=null;const{success:t,asyncInit:n}=this.initializeBackend(e);if(!(n?await t:t))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new Tme(this.backendInstance),!0}setupRegisteredKernels(){Ey(this.backendName).forEach(t=>{t.setupFunc!=null&&t.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){Ey(e).forEach(n=>{n.disposeFunc!=null&&n.disposeFunc(this.registry[e])})}initializeBackend(e){const t=this.registryFactory[e];if(t==null)throw new Error(`Cannot initialize backend ${e}, no registration found.`);try{const n=t.factory();if(n&&!(n instanceof PO)&&typeof n.then=="function"){const s=++this.pendingBackendInitId,o=n.then(a=>s<this.pendingBackendInitId?!1:(this.registry[e]=a,this.pendingBackendInit=null,!0)).catch(a=>(s<this.pendingBackendInitId||(this.pendingBackendInit=null,nu(`Initialization of backend ${e} failed`),nu(a.stack||a.message)),!1));return this.pendingBackendInit=o,{success:o,asyncInit:!0}}else return this.registry[e]=n,{success:!0,asyncInit:!1}}catch(n){return nu(`Initialization of backend ${e} failed`),nu(n.stack||n.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error(`${e} backend not found in registry`);this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,t)=>this.registryFactory[t].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let t=0;t<e.length;t++){const n=e[t],{success:s,asyncInit:o}=this.initializeBackend(n);if(o||s)return{name:n,asyncInit:o}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,t){const n=this.state.tensorInfo.get(t),s=n.backend,o=this.readSync(t),a=s.refCount(t);s.disposeData(t,!0),n.backend=e,e.move(t,o,n.shape,n.dtype,a),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,t){let n=null;if(t==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");t=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof t!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");n=e}let s;return this.scopedRun(()=>this.startScope(n),()=>this.endScope(s),()=>(s=t(),s instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),s))}scopedRun(e,t,n){e();try{const s=n();return t(),s}catch(s){throw t(),s}}nextTensorId(){return dd.nextTensorId++}nextVariableId(){return dd.nextVariableId++}clone(e){const t=ze.runKernel(FS,{x:e}),n={x:e},s=a=>({x:()=>{const i="float32",l={x:a},u={dtype:i};return ze.runKernel(MS,l,u)}}),o=[];return this.addTapeNode(this.state.activeScope.name,n,[t],s,o,{}),t}runKernel(e,t,n){if(this.backendName==null&&this.backend,!(Iy(e,this.backendName)!=null))throw new Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:t,attrs:n})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,t,n){const s=this.backend.numDataIds();let o=0;n.forEach(l=>{o+=l.dtype==="complex64"?3:1});const a=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],i=s-t-o-a;if(i>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${i} data ids) after running '${e}'`)}runKernelFunc(e){let t,n=[];const s=this.isTapeOn(),o=this.state.numBytes,a=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let i;this.backendName==null&&this.backend;let l;const u=tb(e)?e.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(tb(e)){const{kernelName:p,inputs:m,attrs:g}=e;this.backendName==null&&this.backend;const y=Iy(p,this.backendName);Te(y!=null,()=>`Cannot find registered kernel '${p}' for backend '${this.backendName}'`),i=()=>{const v=this.backend.numDataIds();l=y.kernelFunc({inputs:m,attrs:g,backend:this.backend});const b=Array.isArray(l)?l:[l];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(p,v,b);const w=b.map(_=>{if(_.rank!=null)return _;const{dataId:I,shape:C,dtype:N}=_;return this.makeTensorFromDataId(I,C,N)});if(s){const _=this.getTensorsForGradient(p,m,w);n=this.saveTensorsForBackwardMode(_)}return w}}else{const{forwardFunc:p}=e,m=g=>{!s||(n=g.map(y=>this.keep(this.clone(y))))};i=()=>{const g=this.backend.numDataIds();l=this.tidy(()=>p(this.backend,m));const y=Array.isArray(l)?l:[l];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(u,g,y),y}}const{inputs:h,attrs:d}=e,c=tb(e)?null:e.backwardsFunc;let f;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?t=i():(f=this.profiler.profileKernel(u,h,()=>i()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(f),t=f.outputs)}),s&&this.addTapeNode(u,h,t,c,n,d),this.state.profiling&&this.state.activeProfile.kernels.push({name:u,bytesAdded:this.state.numBytes-o,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-a,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(h).map(p=>h[p]!=null?h[p].shape:null),outputShapes:t.map(p=>p.shape),kernelTimeMs:f.timeMs,extraInfo:f.extraInfo}),Array.isArray(l)?t:t[0]}saveTensorsForBackwardMode(e){return e.map(n=>this.keep(this.clone(n)))}getTensorsForGradient(e,t,n){const s=ax(e);if(s!=null){const o=s.inputsToSave||[],a=s.outputsToSave||[];let i;s.saveAllInputs?(Te(Array.isArray(t),()=>"saveAllInputs is true, expected inputs to be an array."),i=Object.keys(t).map(u=>t[u])):i=o.map(u=>t[u]);const l=n.filter((u,h)=>a[h]);return i.concat(l)}return[]}makeTensor(e,t,n,s){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",s=s||this.backend;let o=e;n==="string"&&iu(e[0])&&(o=e.map(l=>xm(l)));const a=s.write(o,t,n),i=new pr(t,n,a,this.nextTensorId());if(this.trackTensor(i,s),n==="string"){const l=this.state.tensorInfo.get(a),u=WO(o);this.state.numBytes+=u-l.bytes,l.bytes=u}return i}makeTensorFromDataId(e,t,n,s){n=n||"float32";const o=new pr(t,n,e,this.nextTensorId());return this.trackTensor(o,s),o}makeVariable(e,t=!0,n,s){n=n||this.nextVariableId().toString(),s!=null&&s!==e.dtype&&(e=e.cast(s));const o=new jf(e,t,n,this.nextTensorId());if(this.state.registeredVariables[o.name]!=null)throw new Error(`Variable with name ${o.name} was already registered`);return this.state.registeredVariables[o.name]=o,this.incRef(o,this.backend),o}trackTensor(e,t){this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++;let n=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(n=e.size*nx(e.dtype)),this.state.numBytes+=n,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:n})),e instanceof jf||this.track(e)}incRef(e,t){this.trackTensor(e,t),this.backend.incRef(e.dataId)}removeDataId(e,t){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===t&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const t=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,e.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=t.bytes),e.dtype!=="complex64"&&e.dtype!=="string"){const n=e.size*nx(e.dtype);this.state.numBytes-=n}t.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,t.backend)}disposeVariables(){for(const e in this.state.registeredVariables){const t=this.state.registeredVariables[e];this.disposeVariable(t)}}disposeVariable(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;const t=this.state.numBytes,n=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(s=>s.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-t,this.state.activeProfile.newTensors=this.state.numTensors-n;for(const s of this.state.activeProfile.kernels)s.kernelTimeMs=await s.kernelTimeMs,s.extraInfo=await s.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(e,t,n,s,o,a){const i={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:n,saved:o},l=ax(e);l!=null&&(s=l.gradFunc),s!=null&&(i.gradient=u=>(u=u.map((h,d)=>{if(h==null){const c=n[d],f=b1(c.size,c.dtype);return this.makeTensor(f,c.shape,c.dtype)}return h}),s(u.length>1?u:u[0],o,a))),this.state.activeTape.push(i)}keep(e){return e.kept=!0,e}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t}endScope(e){const t=jS(e),n=new Set(t.map(o=>o.id));for(let o=0;o<this.state.activeScope.track.length;o++){const a=this.state.activeScope.track[o];!a.kept&&!n.has(a.id)&&a.dispose()}const s=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],t.forEach(o=>{!o.kept&&o.scopeId===s.id&&this.track(o)})}gradients(e,t,n,s=!1){if(Te(t.length>0,()=>"gradients() received an empty list of xs."),n!=null&&n.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${n.dtype}'`);const o=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));Te(o instanceof pr,()=>"The result y returned by f() must be a tensor.");const a=Eme(this.state.activeTape,t,o);if(!s&&a.length===0&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const i={};i[o.id]=n==null?jme(o.shape):n,Cme(i,a,u=>this.tidy(u),Bme);const l=t.map(u=>i[u.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(u=>{for(const h of u.saved)h.dispose()}),this.state.activeTape=null),{value:o,grads:l}})}customGrad(e){return Te(wu(e),()=>"The f passed in customGrad(f) must be a function."),(...t)=>{Te(t.every(i=>i instanceof pr),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let n;const s={};t.forEach((i,l)=>{s[l]=i});const o=(i,l)=>(n=e(...t,l),Te(n.value instanceof pr,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),Te(wu(n.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),n.value),a=(i,l)=>{const u=n.gradFunc(i,l),h=Array.isArray(u)?u:[u];Te(h.length===t.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),Te(h.every(c=>c instanceof pr),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const d={};return h.forEach((c,f)=>{d[f]=()=>c}),d};return this.runKernelFunc({forwardFunc:o,backwardsFunc:a,inputs:s})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,t){return this.state.tensorInfo.get(e).backend.readToGPU(e,t)}async time(e){const t=Pf(),n=await this.backend.time(e);return n.wallMs=Pf()-t,n}track(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new fE;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}dd.nextTensorId=0;dd.nextVariableId=0;function jme(r){const e=NS(Ur(r),"float32");return ze.makeTensor(e,r,"float32")}function jF(){const r=YO();if(r._tfengine==null){const e=new KO(r);r._tfengine=new dd(e)}return qpe(r._tfengine.ENV),Ame(()=>r._tfengine),r._tfengine}const ze=jF();function Bme(r,e){const t={a:r,b:e};return ze.runKernel(OS,t)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ume(){return typeof navigator!="undefined"&&navigator!=null}let px;function zme(r){px=r}function Vme(r){if(px!==void 0)return px;if(r||Ume()){if(r||(r=navigator),r.product==="ReactNative")return!0;const e=r.userAgent||r.vendor||(typeof window!="undefined"?window.opera:"");if(!e){const t=r;return t.userAgentData&&t.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function BF(){return typeof window!="undefined"&&window.document!=null||typeof WorkerGlobalScope!="undefined"}var Gme=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",mockIsMobile:zme,isMobile:Vme,isBrowser:BF});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const va=Pn();va.registerFlag("DEBUG",()=>!1,r=>{r&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});va.registerFlag("IS_BROWSER",()=>BF());va.registerFlag("IS_NODE",()=>typeof process!="undefined"&&typeof process.versions!="undefined"&&typeof process.versions.node!="undefined");va.registerFlag("IS_CHROME",()=>typeof navigator!="undefined"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));va.registerFlag("PROD",()=>!1);va.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>va.getBool("DEBUG"));va.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);va.registerFlag("IS_TEST",()=>!1);va.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>!0);va.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function el(r,e){let t=r;if(Gs(r))return e==="string"?[]:[r.length];if(!Array.isArray(r))return[];const n=[];for(;Array.isArray(t)||Gs(t)&&e!=="string";)n.push(t.length),t=t[0];return Array.isArray(r)&&Pn().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&UF(r,n,[]),n}function UF(r,e,t){if(t=t||[],!Array.isArray(r)&&!Gs(r)){Te(e.length===0,()=>`Element arr[${t.join("][")}] is a primitive, but should be an array/TypedArray of ${e[0]} elements`);return}Te(e.length>0,()=>`Element arr[${t.join("][")}] should be a primitive, but is an array of ${r.length} elements`),Te(r.length===e[0],()=>`Element arr[${t.join("][")}] should have ${e[0]} elements, but has ${r.length} elements`);const n=e.slice(1);for(let s=0;s<r.length;++s)UF(r[s],n,t.concat(s))}function pE(r,e,t,n){if(r!=="string_or_numeric"){if(r==null)throw new Error("Expected dtype cannot be null.");if(r!=="numeric"&&r!==e||r==="numeric"&&e==="string")throw new Error(`Argument '${t}' passed to '${n}' must be ${r} tensor, but got ${e} tensor`)}}function fe(r,e,t,n="numeric"){if(r instanceof pr)return pE(n,r.dtype,e,t),r;let s=v1(r);if(s!=="string"&&["bool","int32","float32"].indexOf(n)>=0&&(s=n),pE(n,s,e,t),r==null||!Gs(r)&&!Array.isArray(r)&&typeof r!="number"&&typeof r!="boolean"&&typeof r!="string"){const l=r==null?"null":r.constructor.name;throw new Error(`Argument '${e}' passed to '${t}' must be a Tensor or TensorLike, but got '${l}'`)}const o=el(r,s);!Gs(r)&&!Array.isArray(r)&&(r=[r]);const i=s!=="string"?x1(r,s):zc(r,[],!0);return ze.makeTensor(i,o,s)}function Bf(r,e,t,n="numeric"){if(!Array.isArray(r))throw new Error(`Argument ${e} passed to ${t} must be a \`Tensor[]\` or \`TensorLike[]\``);return r.map((o,a)=>fe(o,`${e}[${a}]`,t,n))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zF="__op";function Ue(r){const e=Object.keys(r);if(e.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${e.length} keys.`);let t=e[0];const n=r[t];t.endsWith("_")&&(t=t.substring(0,t.length-1)),t=t+zF;const s=(...o)=>{ze.startScope(t);try{const a=n(...o);return cd(a)&&console.error("Cannot return a Promise inside of tidy."),ze.endScope(a),a}catch(a){throw ze.endScope(null),a}};return Object.defineProperty(s,"name",{value:t,configurable:!0}),s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wme(r,e){const t=fe(r,"real","complex"),n=fe(e,"imag","complex");co(t.shape,n.shape,`real and imag shapes, ${t.shape} and ${n.shape}, must match in call to tf.complex().`);const s={real:t,imag:n};return ze.runKernel(v3,s)}const Su=Ue({complex_:Wme});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mu(r,e,t,n){if(n==null&&(n=v1(r)),n==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!Gs(r)&&!Array.isArray(r)&&typeof r!="number"&&typeof r!="boolean"&&typeof r!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){AS(e);const s=Ur(e),o=Ur(t);Te(s===o,()=>`Based on the provided shape, [${e}], the tensor should have ${s} values but has ${o}`);for(let a=0;a<t.length;++a){const i=t[a],l=a===t.length-1?i!==Ur(e.slice(a)):!0;Te(t[a]===e[a]||!l,()=>`Error creating a new Tensor. Inferred shape (${t}) does not match the provided shape (${e}). `)}}return!Gs(r)&&!Array.isArray(r)&&(r=[r]),e=e||t,r=n!=="string"?x1(r,n):zc(r,[],!0),ze.makeTensor(r,e,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ui(r,e,t){const n=el(r,t);return Mu(r,e,n,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mx={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ny=4;async function Hme(r,e){const t=[],n=[],s=Array.isArray(r)?r.map(a=>a.name):Object.keys(r);for(let a=0;a<s.length;++a){const i=s[a],l=Array.isArray(r)?r[a].tensor:r[i];if(l.dtype!=="float32"&&l.dtype!=="int32"&&l.dtype!=="bool"&&l.dtype!=="string"&&l.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${i}': ${l.dtype}`);const u={name:i,shape:l.shape,dtype:l.dtype};if(l.dtype==="string"){const h=new Promise(async d=>{const c=await l.bytes(),f=c.reduce((g,y)=>g+y.length,0)+Ny*c.length,p=new Uint8Array(f);let m=0;for(let g=0;g<c.length;g++){const y=c[g],v=new Uint8Array(new Uint32Array([y.length]).buffer);p.set(v,m),m+=Ny,p.set(y,m),m+=y.length}d(p)});n.push(h)}else n.push(l.data());e!=null&&(u.group=e),t.push(u)}const o=await Promise.all(n);return{data:qme(o),specs:t}}function BS(r,e){const t={};let n,s=0;for(const o of e){const a=o.name,i=o.dtype,l=o.shape,u=Ur(l);let h;if("quantization"in o){const d=o.quantization;if(d.dtype==="uint8"||d.dtype==="uint16"){if(!("min"in d&&"scale"in d))throw new Error(`Weight ${o.name} with quantization ${d.dtype} doesn't have corresponding metadata min and scale.`)}else if(d.dtype==="float16"){if(i!=="float32")throw new Error(`Weight ${o.name} is quantized with ${d.dtype} which only supports weights of type float32 not ${i}.`)}else throw new Error(`Weight ${o.name} has unknown quantization dtype ${d.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);const c=mx[d.dtype],f=r.slice(s,s+u*c),p=d.dtype==="uint8"?new Uint8Array(f):new Uint16Array(f);if(i==="float32")if(d.dtype==="uint8"||d.dtype==="uint16"){h=new Float32Array(p.length);for(let m=0;m<p.length;m++){const g=p[m];h[m]=g*d.scale+d.min}}else if(d.dtype==="float16")n===void 0&&(n=Jme()),h=n(p);else throw new Error(`Unsupported quantization type ${d.dtype} for weight type float32.`);else if(i==="int32"){if(d.dtype!=="uint8"&&d.dtype!=="uint16")throw new Error(`Unsupported quantization type ${d.dtype} for weight type int32.`);h=new Int32Array(p.length);for(let m=0;m<p.length;m++){const g=p[m];h[m]=Math.round(g*d.scale+d.min)}}else throw new Error(`Unsupported dtype in weight '${a}': ${i}`);s+=u*c}else if(i==="string"){const d=Ur(o.shape);h=[];for(let c=0;c<d;c++){const f=new Uint32Array(r.slice(s,s+Ny))[0];s+=Ny;const p=new Uint8Array(r.slice(s,s+f));h.push(p),s+=f}}else{const d=mx[i],c=r.slice(s,s+u*d);if(i==="float32")h=new Float32Array(c);else if(i==="int32")h=new Int32Array(c);else if(i==="bool")h=new Uint8Array(c);else if(i==="complex64"){h=new Float32Array(c);const f=new Float32Array(h.length/2),p=new Float32Array(h.length/2);for(let y=0;y<f.length;y++)f[y]=h[y*2],p[y]=h[y*2+1];const m=Ui(f,l,"float32"),g=Ui(p,l,"float32");t[a]=Su(m,g),m.dispose(),g.dispose()}else throw new Error(`Unsupported dtype in weight '${a}': ${i}`);s+=u*d}i!=="complex64"&&(t[a]=Ui(h,l,i))}return t}function qme(r){if(r===null)throw new Error(`Invalid input value: ${JSON.stringify(r)}`);let e=0;const t=[];r.forEach(o=>{if(e+=o.byteLength,t.push(o.byteLength===o.buffer.byteLength?o:new o.constructor(o)),!(o instanceof Float32Array||o instanceof Int32Array||o instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${o.constructor.name}`)});const n=new Uint8Array(e);let s=0;return t.forEach(o=>{n.set(new Uint8Array(o.buffer),s),s+=o.byteLength}),n.buffer}const US=typeof Buffer!="undefined"&&(typeof Blob=="undefined"||typeof atob=="undefined"||typeof btoa=="undefined");function mE(r){return US?Buffer.byteLength(r):new Blob([r]).size}function Xme(r){if(US)return Buffer.from(r).toString("base64");const e=new Uint8Array(r);let t="";for(let n=0,s=e.length;n<s;n++)t+=String.fromCharCode(e[n]);return btoa(t)}function Kme(r){if(US){const n=Buffer.from(r,"base64");return n.buffer.slice(n.byteOffset,n.byteOffset+n.byteLength)}const e=atob(r),t=new Uint8Array(e.length);for(let n=0;n<e.length;++n)t.set([e.charCodeAt(n)],n);return t.buffer}function zS(r){if(r.length===1)return r[0];let e=0;r.forEach(s=>{e+=s.byteLength});const t=new Uint8Array(e);let n=0;return r.forEach(s=>{t.set(new Uint8Array(s),n),n+=s.byteLength}),t.buffer}function gE(r){const e="/";for(r=r.trim();r.endsWith(e);)r=r.slice(0,r.length-1);const t=r.split(e);return t[t.length-1]}function VF(r,e){const t={modelTopology:r.modelTopology,format:r.format,generatedBy:r.generatedBy,convertedBy:r.convertedBy,weightsManifest:e};return r.signature!=null&&(t.signature=r.signature),r.userDefinedMetadata!=null&&(t.userDefinedMetadata=r.userDefinedMetadata),r.modelInitializer!=null&&(t.modelInitializer=r.modelInitializer),r.trainingConfig!=null&&(t.trainingConfig=r.trainingConfig),t}async function VS(r,e){const t={modelTopology:r.modelTopology,format:r.format,generatedBy:r.generatedBy,convertedBy:r.convertedBy};if(r.trainingConfig!=null&&(t.trainingConfig=r.trainingConfig),r.weightsManifest!=null){const[n,s]=await e(r.weightsManifest);t.weightSpecs=n,t.weightData=s}return r.signature!=null&&(t.signature=r.signature),r.userDefinedMetadata!=null&&(t.userDefinedMetadata=r.userDefinedMetadata),r.modelInitializer!=null&&(t.modelInitializer=r.modelInitializer),t}function wm(r){if(r.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:r.modelTopology==null?0:mE(JSON.stringify(r.modelTopology)),weightSpecsBytes:r.weightSpecs==null?0:mE(JSON.stringify(r.weightSpecs)),weightDataBytes:r.weightData==null?0:r.weightData.byteLength}}function Yme(){const r=t=>{let n=t<<13,s=0;for(;(n&8388608)===0;)s-=8388608,n<<=1;return n&=-8388609,s+=947912704,n|s},e=new Uint32Array(2048);e[0]=0;for(let t=1;t<1024;t++)e[t]=r(t);for(let t=1024;t<2048;t++)e[t]=939524096+(t-1024<<13);return e}function Zme(){const r=new Uint32Array(64);r[0]=0,r[31]=1199570944,r[32]=2147483648,r[63]=3347054592;for(let e=1;e<31;e++)r[e]=e<<23;for(let e=33;e<63;e++)r[e]=2147483648+(e-32<<23);return r}function Qme(){const r=new Uint32Array(64);for(let e=0;e<64;e++)r[e]=1024;return r[0]=r[32]=0,r}function Jme(){const r=Yme(),e=Zme(),t=Qme();return n=>{const s=new ArrayBuffer(4*n.length),o=new Uint32Array(s);for(let a=0;a<n.length;a++){const i=n[a],l=r[t[i>>10]+(i&1023)]+e[i>>10];o[a]=l}return new Float32Array(s)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Vr{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return Vr.instance==null&&(Vr.instance=new Vr),Vr.instance}static registerSaveRouter(e){Vr.getInstance().saveRouters.push(e)}static registerLoadRouter(e){Vr.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return Vr.getHandlers(e,"save")}static getLoadHandlers(e,t){return Vr.getHandlers(e,"load",t)}static getHandlers(e,t,n){const s=[];return(t==="load"?Vr.getInstance().loadRouters:Vr.getInstance().saveRouters).forEach(a=>{const i=a(e,n);i!==null&&s.push(i)}),s}}const ege=r=>Vr.registerSaveRouter(r),tge=r=>Vr.registerLoadRouter(r),GF=r=>Vr.getSaveHandlers(r),WF=(r,e)=>Vr.getLoadHandlers(r,e);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gx="tensorflowjs",yx=1,wc="models_store",au="model_info_store";function HF(){if(!Pn().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const r=typeof window=="undefined"?self:window,e=r.indexedDB||r.mozIndexedDB||r.webkitIndexedDB||r.msIndexedDB||r.shimIndexedDB;if(e==null)throw new Error("The current browser does not appear to support IndexedDB.");return e}function vx(r){const e=r.result;e.createObjectStore(wc,{keyPath:"modelPath"}),e.createObjectStore(au,{keyPath:"modelPath"})}class Vc{constructor(e){if(this.indexedDB=HF(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,t){return new Promise((n,s)=>{const o=this.indexedDB.open(gx,yx);o.onupgradeneeded=()=>vx(o),o.onsuccess=()=>{const a=o.result;if(t==null){const i=a.transaction(wc,"readonly"),u=i.objectStore(wc).get(this.modelPath);u.onsuccess=()=>{if(u.result==null)return a.close(),s(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));n(u.result.modelArtifacts)},u.onerror=h=>(a.close(),s(u.error)),i.oncomplete=()=>a.close()}else{const i=wm(t),l=a.transaction(au,"readwrite");let u=l.objectStore(au);const h=u.put({modelPath:this.modelPath,modelArtifactsInfo:i});let d;h.onsuccess=()=>{d=a.transaction(wc,"readwrite");const f=d.objectStore(wc).put({modelPath:this.modelPath,modelArtifacts:t,modelArtifactsInfo:i});f.onsuccess=()=>n({modelArtifactsInfo:i}),f.onerror=p=>{u=l.objectStore(au);const m=u.delete(this.modelPath);m.onsuccess=()=>(a.close(),s(f.error)),m.onerror=g=>(a.close(),s(f.error))}},h.onerror=c=>(a.close(),s(h.error)),l.oncomplete=()=>{d==null?a.close():d.oncomplete=()=>a.close()}}},o.onerror=a=>s(o.error)})}}Vc.URL_SCHEME="indexeddb://";const qF=r=>Pn().getBool("IS_BROWSER")&&!Array.isArray(r)&&r.startsWith(Vc.URL_SCHEME)?nge(r.slice(Vc.URL_SCHEME.length)):null;Vr.registerSaveRouter(qF);Vr.registerLoadRouter(qF);function nge(r){return new Vc(r)}function rge(r){return r.startsWith(Vc.URL_SCHEME)?r.slice(Vc.URL_SCHEME.length):r}class sge{constructor(){this.indexedDB=HF()}async listModels(){return new Promise((e,t)=>{const n=this.indexedDB.open(gx,yx);n.onupgradeneeded=()=>vx(n),n.onsuccess=()=>{const s=n.result,o=s.transaction(au,"readonly"),i=o.objectStore(au).getAll();i.onsuccess=()=>{const l={};for(const u of i.result)l[u.modelPath]=u.modelArtifactsInfo;e(l)},i.onerror=l=>(s.close(),t(i.error)),o.oncomplete=()=>s.close()},n.onerror=s=>t(n.error)})}async removeModel(e){return e=rge(e),new Promise((t,n)=>{const s=this.indexedDB.open(gx,yx);s.onupgradeneeded=()=>vx(s),s.onsuccess=()=>{const o=s.result,a=o.transaction(au,"readwrite"),i=a.objectStore(au),l=i.get(e);let u;l.onsuccess=()=>{if(l.result==null)return o.close(),n(new Error(`Cannot find model with path '${e}' in IndexedDB.`));{const h=i.delete(e),d=()=>{u=o.transaction(wc,"readwrite");const f=u.objectStore(wc).delete(e);f.onsuccess=()=>t(l.result.modelArtifactsInfo),f.onerror=p=>n(l.error)};h.onsuccess=d,h.onerror=c=>(d(),o.close(),n(l.error))}},l.onerror=h=>(o.close(),n(l.error)),a.oncomplete=()=>{u==null?o.close():u.oncomplete=()=>o.close()}},s.onerror=o=>n(s.error)})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _l="/",Mh="tensorflowjs_models",XF="info",oge="model_topology",ige="weight_specs",age="weight_data",lge="model_metadata";function KF(r){return{info:[Mh,r,XF].join(_l),topology:[Mh,r,oge].join(_l),weightSpecs:[Mh,r,ige].join(_l),weightData:[Mh,r,age].join(_l),modelMetadata:[Mh,r,lge].join(_l)}}function YF(r){for(const e of Object.values(r))window.localStorage.removeItem(e)}function uge(r){const e=r.split(_l);if(e.length<3)throw new Error(`Invalid key format: ${r}`);return e.slice(1,e.length-1).join(_l)}function cge(r){return r.startsWith(Gc.URL_SCHEME)?r.slice(Gc.URL_SCHEME.length):r}class Gc{constructor(e){if(!Pn().getBool("IS_BROWSER")||typeof window=="undefined"||typeof window.localStorage=="undefined")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=KF(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const t=JSON.stringify(e.modelTopology),n=JSON.stringify(e.weightSpecs),s=wm(e);try{this.LS.setItem(this.keys.info,JSON.stringify(s)),this.LS.setItem(this.keys.topology,t),this.LS.setItem(this.keys.weightSpecs,n),this.LS.setItem(this.keys.weightData,Xme(e.weightData));const o={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:e.signature!=null?e.signature:void 0,userDefinedMetadata:e.userDefinedMetadata!=null?e.userDefinedMetadata:void 0,modelInitializer:e.modelInitializer!=null?e.modelInitializer:void 0,trainingConfig:e.trainingConfig!=null?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(o)),{modelArtifactsInfo:s}}catch{throw YF(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${s.modelTopologyBytes}, weightSpecsBytes=${s.weightSpecsBytes}, weightDataBytes=${s.weightDataBytes}.`)}}}async load(){const e=JSON.parse(this.LS.getItem(this.keys.info));if(e==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const t={},n=JSON.parse(this.LS.getItem(this.keys.topology));if(n==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);t.modelTopology=n;const s=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(s==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);t.weightSpecs=s;const o=this.LS.getItem(this.keys.modelMetadata);if(o!=null){const i=JSON.parse(o);t.format=i.format,t.generatedBy=i.generatedBy,t.convertedBy=i.convertedBy,i.signature!=null&&(t.signature=i.signature),i.userDefinedMetadata!=null&&(t.userDefinedMetadata=i.userDefinedMetadata),i.modelInitializer!=null&&(t.modelInitializer=i.modelInitializer),i.trainingConfig!=null&&(t.trainingConfig=i.trainingConfig)}const a=this.LS.getItem(this.keys.weightData);if(a==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return t.weightData=Kme(a),t}}Gc.URL_SCHEME="localstorage://";const ZF=r=>Pn().getBool("IS_BROWSER")&&!Array.isArray(r)&&r.startsWith(Gc.URL_SCHEME)?hge(r.slice(Gc.URL_SCHEME.length)):null;Vr.registerSaveRouter(ZF);Vr.registerLoadRouter(ZF);function hge(r){return new Gc(r)}class dge{constructor(){Te(Pn().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),Te(typeof window=="undefined"||typeof window.localStorage!="undefined",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const e={},t=Mh+_l,n=_l+XF;for(let s=0;s<this.LS.length;++s){const o=this.LS.key(s);if(o.startsWith(t)&&o.endsWith(n)){const a=uge(o);e[a]=JSON.parse(this.LS.getItem(o))}}return e}async removeModel(e){e=cge(e);const t=KF(e);if(this.LS.getItem(t.info)==null)throw new Error(`Cannot find model at path '${e}'`);const n=JSON.parse(this.LS.getItem(t.info));return YF(t),n}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gh="://";class Fo{constructor(){this.managers={}}static getInstance(){return Fo.instance==null&&(Fo.instance=new Fo),Fo.instance}static registerManager(e,t){Te(e!=null,()=>"scheme must not be undefined or null."),e.endsWith(Gh)&&(e=e.slice(0,e.indexOf(Gh))),Te(e.length>0,()=>"scheme must not be an empty string.");const n=Fo.getInstance();Te(n.managers[e]==null,()=>`A model store manager is already registered for scheme '${e}'.`),n.managers[e]=t}static getManager(e){const t=this.getInstance().managers[e];if(t==null)throw new Error(`Cannot find model manager for scheme '${e}'`);return t}static getSchemes(){return Object.keys(this.getInstance().managers)}}function qg(r){if(r.indexOf(Gh)===-1)throw new Error(`The url string provided does not contain a scheme. Supported schemes are: ${Fo.getSchemes().join(",")}`);return{scheme:r.split(Gh)[0],path:r.split(Gh)[1]}}async function QF(r,e,t=!1){Te(r!==e,()=>`Old path and new path are the same: '${r}'`);const n=Vr.getLoadHandlers(r);Te(n.length>0,()=>`Copying failed because no load handler is found for source URL ${r}.`),Te(n.length<2,()=>`Copying failed because more than one (${n.length}) load handlers for source URL ${r}.`);const s=n[0],o=Vr.getSaveHandlers(e);Te(o.length>0,()=>`Copying failed because no save handler is found for destination URL ${e}.`),Te(o.length<2,()=>`Copying failed because more than one (${n.length}) save handlers for destination URL ${e}.`);const a=o[0],i=qg(r).scheme,l=qg(r).path,u=i===qg(r).scheme,h=await s.load();t&&u&&await Fo.getManager(i).removeModel(l);const d=await a.save(h);return t&&!u&&await Fo.getManager(i).removeModel(l),d.modelArtifactsInfo}async function fge(){const r=Fo.getSchemes(),e={};for(const t of r){const n=await Fo.getManager(t).listModels();for(const s in n){const o=t+Gh+s;e[o]=n[s]}}return e}async function pge(r){const e=qg(r);return Fo.getManager(e.scheme).removeModel(e.path)}async function mge(r,e){return QF(r,e,!1)}async function gge(r,e){return QF(r,e,!0)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yge{fetch(e,t){return fetch(e,t)}now(){return performance.now()}encode(e,t){if(t!=="utf-8"&&t!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${t}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,t){return new TextDecoder(t).decode(e)}}if(Pn().get("IS_BROWSER")){Pn().setPlatform("browser",new yge);try{Fo.registerManager(Gc.URL_SCHEME,new dge)}catch{}try{Fo.registerManager(Vc.URL_SCHEME,new sge)}catch{}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vge={importFetch:()=>require("node-fetch")};let nb;class bge{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(e,t){return Pn().global.fetch!=null?Pn().global.fetch(e,t):(nb==null&&(nb=vge.importFetch()),nb(e,t))}now(){const e=process.hrtime();return e[0]*1e3+e[1]/1e6}encode(e,t){if(t!=="utf-8"&&t!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${t}`);return this.textEncoder.encode(e)}decode(e,t){return e.length===0?"":new this.util.TextDecoder(t).decode(e)}}Pn().get("IS_NODE")&&Pn().setPlatform("node",new bge);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $l(r,e="float32",t){return e=e||"float32",AS(r),new $y(r,e,t)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xge(r,e){const t=fe(r,"x","cast");if(!GO(e))throw new Error(`Failed to cast to unknown dtype ${e}`);if(e==="string"&&t.dtype!=="string"||e!=="string"&&t.dtype==="string")throw new Error("Only strings can be casted to strings");const n={x:t},s={dtype:e};return ze.runKernel(MS,n,s)}const zn=Ue({cast_:xge});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wge(r){const t={x:fe(r,"x","clone","string_or_numeric")};return ze.runKernel(FS,t)}const pu=Ue({clone_:wge});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JF(r,e=!1){console.log(r.toString(e))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */jF();const Sge={buffer:$l,cast:zn,clone:pu,print:JF};Rme(Sge);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _ge="model",Tge=".json",kge=".weights.bin";function yE(r){return new Promise(e=>setTimeout(e)).then(r)}class Wc{constructor(e){if(!Pn().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(Wc.URL_SCHEME)&&(e=e.slice(Wc.URL_SCHEME.length)),(e==null||e.length===0)&&(e=_ge),this.modelJsonFileName=e+Tge,this.weightDataFileName=e+kge}async save(e){if(typeof document=="undefined")throw new Error("Browser downloads are not supported in this environment since `document` is not present");const t=window.URL.createObjectURL(new Blob([e.weightData],{type:"application/octet-stream"}));if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const n=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],s=VF(e,n),o=window.URL.createObjectURL(new Blob([JSON.stringify(s)],{type:"application/json"})),a=this.modelJsonAnchor==null?document.createElement("a"):this.modelJsonAnchor;if(a.download=this.modelJsonFileName,a.href=o,await yE(()=>a.dispatchEvent(new MouseEvent("click"))),e.weightData!=null){const i=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor;i.download=this.weightDataFileName,i.href=t,await yE(()=>i.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:wm(e)}}}}Wc.URL_SCHEME="downloads://";class Ige{constructor(e){if(e==null||e.length<1)throw new Error(`When calling browserFiles, at least 1 file is required, but received ${e}`);this.jsonFile=e[0],this.weightsFiles=e.slice(1)}async load(){return new Promise((e,t)=>{const n=new FileReader;n.onload=s=>{const o=JSON.parse(s.target.result),a=o.modelTopology;if(a==null){t(new Error(`modelTopology field is missing from file ${this.jsonFile.name}`));return}if(o.weightsManifest==null){t(new Error(`weightManifest field is missing from file ${this.jsonFile.name}`));return}if(this.weightsFiles.length===0){e({modelTopology:a});return}const l=VS(o,u=>this.loadWeights(u));e(l)},n.onerror=s=>t(`Failed to read model topology and weights manifest JSON from file '${this.jsonFile.name}'. BrowserFiles supports loading Keras-style tf.Model artifacts only.`),n.readAsText(this.jsonFile)})}loadWeights(e){const t=[],n=[];for(const a of e)t.push(...a.weights),n.push(...a.paths);const s=this.checkManifestAndWeightFiles(e),o=n.map(a=>this.loadWeightsFile(a,s[a]));return Promise.all(o).then(a=>[t,zS(a)])}loadWeightsFile(e,t){return new Promise((n,s)=>{const o=new FileReader;o.onload=a=>{const i=a.target.result;n(i)},o.onerror=a=>s(`Failed to weights data from file of path '${e}'.`),o.readAsArrayBuffer(t)})}checkManifestAndWeightFiles(e){const t=[],n=this.weightsFiles.map(o=>gE(o.name)),s={};for(const o of e)o.paths.forEach(a=>{const i=gE(a);if(t.indexOf(i)!==-1)throw new Error(`Duplicate file basename found in weights manifest: '${i}'`);if(t.push(i),n.indexOf(i)===-1)throw new Error(`Weight file with basename '${i}' is not provided.`);s[a]=this.weightsFiles[n.indexOf(i)]});if(t.length!==this.weightsFiles.length)throw new Error(`Mismatch in the number of files in weights manifest (${t.length}) and the number of weight files provided (${this.weightsFiles.length}).`);return s}}const Ege=r=>Pn().getBool("IS_BROWSER")&&!Array.isArray(r)&&r.startsWith(Wc.URL_SCHEME)?Cge(r.slice(Wc.URL_SCHEME.length)):null;Vr.registerSaveRouter(Ege);function Cge(r="model"){return new Wc(r)}function $ge(r){return new Ige(r)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vE(r,e,t,n){a(r),t=t==null?0:t,n=n==null?1:n,i(t,n);let s=0;const o=l=>(l.then(u=>{const h=t+ ++s/r.length*(n-t);return e(h),u}),l);function a(l){Te(l!=null&&Array.isArray(l)&&l.length>0,()=>"promises must be a none empty array")}function i(l,u){Te(l>=0&&l<=1,()=>`Progress fraction must be in range [0, 1], but got startFraction ${l}`),Te(u>=0&&u<=1,()=>`Progress fraction must be in range [0, 1], but got endFraction ${u}`),Te(u>=l,()=>`startFraction must be no more than endFraction, but got startFraction ${l} and endFraction ${u}`)}return Promise.all(r.map(o))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function eL(r,e){e==null&&(e={});const t=e.fetchFunc==null?Pn().platform.fetch:e.fetchFunc,n=r.map(d=>t(d,e.requestInit,{isBinary:!0})),s=0,o=.5,i=(e.onProgress==null?await Promise.all(n):await vE(n,e.onProgress,s,o)).map(d=>d.arrayBuffer()),l=.5,u=1;return e.onProgress==null?await Promise.all(i):await vE(i,e.onProgress,l,u)}async function Nge(r,e="",t,n){return tL(a=>eL(a,{requestInit:n}))(r,e,t)}function tL(r){return async(e,t="",n)=>{const s=e.map(()=>!1),o={},a=n!=null?n.map(()=>!1):[],i=[];if(e.forEach((f,p)=>{let m=0;f.weights.forEach(g=>{const y="quantization"in g?g.quantization.dtype:g.dtype,v=mx[y]*Ur(g.shape),b=()=>{s[p]=!0,o[p]==null&&(o[p]=[]),o[p].push({manifestEntry:g,groupOffset:m,sizeBytes:v})};n!=null?n.forEach((w,_)=>{w===g.name&&(b(),a[_]=!0)}):b(),i.push(g.name),m+=v})}),!a.every(f=>f)){const f=n.filter((p,m)=>!a[m]);throw new Error(`Could not find weights in manifest with names: ${f.join(", ")}. 
Manifest JSON has weights with names: ${i.join(", ")}.`)}const l=s.reduce((f,p,m)=>(p&&f.push(m),f),[]),u=[];l.forEach(f=>{e[f].paths.forEach(p=>{const m=t+(t.endsWith("/")?"":"/")+p;u.push(m)})});const h=await r(u),d={};let c=0;return l.forEach(f=>{const p=e[f].paths.length;let m=0;for(let w=0;w<p;w++)m+=h[c+w].byteLength;const g=new ArrayBuffer(m),y=new Uint8Array(g);let v=0;for(let w=0;w<p;w++){const _=new Uint8Array(h[c+w]);y.set(_,v),v+=_.byteLength}o[f].forEach(w=>{const _=g.slice(w.groupOffset,w.groupOffset+w.sizeBytes),I=BS(_,[w.manifestEntry]);for(const C in I)d[C]=I[C]}),c+=p}),d}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Age="application/octet-stream",Rge="application/json";class GS{constructor(e,t){if(this.DEFAULT_METHOD="POST",t==null&&(t={}),this.weightPathPrefix=t.weightPathPrefix,this.onProgress=t.onProgress,this.weightUrlConverter=t.weightUrlConverter,t.fetchFunc!=null?(Te(typeof t.fetchFunc=="function",()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=t.fetchFunc):this.fetch=Pn().platform.fetch,Te(e!=null&&e.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(e)&&Te(e.length===2,()=>`URL paths for http must have a length of 2, (actual length is ${e.length}).`),this.path=e,t.requestInit!=null&&t.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=t.requestInit||{}}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const t=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);t.body=new FormData;const n=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],s=VF(e,n);t.body.append("model.json",new Blob([JSON.stringify(s)],{type:Rge}),"model.json"),e.weightData!=null&&t.body.append("model.weights.bin",new Blob([e.weightData],{type:Age}),"model.weights.bin");const o=await this.fetch(this.path,t);if(o.ok)return{modelArtifactsInfo:wm(e),responses:[o]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${o.status}.`)}async load(){const e=await this.fetch(this.path,this.requestInit);if(!e.ok)throw new Error(`Request to ${this.path} failed with status code ${e.status}. Please verify this URL points to the model JSON of the model to load.`);let t;try{t=await e.json()}catch{let a=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?a+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":a+=" Please make sure the server is serving valid JSON for this request.",new Error(a)}const n=t.modelTopology,s=t.weightsManifest;if(n==null&&s==null)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return VS(t,o=>this.loadWeights(o))}async loadWeights(e){const t=Array.isArray(this.path)?this.path[1]:this.path,[n,s]=Dge(t),o=this.weightPathPrefix||n,a=[];for(const h of e)a.push(...h.weights);const i=[],l=[];for(const h of e)for(const d of h.paths)this.weightUrlConverter!=null?l.push(this.weightUrlConverter(d)):i.push(o+d+s);this.weightUrlConverter&&i.push(...await Promise.all(l));const u=await eL(i,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress});return[a,zS(u)]}}GS.URL_SCHEME_REGEX=/^https?:\/\//;function Dge(r){const e=r.lastIndexOf("/"),t=r.lastIndexOf("?"),n=r.substring(0,e),s=t>e?r.substring(t):"";return[n+"/",s]}function bx(r){return r.match(GS.URL_SCHEME_REGEX)!=null}const nL=(r,e)=>{if(typeof fetch=="undefined"&&(e==null||e.fetchFunc==null))return null;{let t=!0;if(Array.isArray(r)?t=r.every(n=>bx(n)):t=bx(r),t)return WS(r,e)}return null};Vr.registerSaveRouter(nL);Vr.registerLoadRouter(nL);function WS(r,e){return new GS(r,e)}function xx(r,e){return WS(r,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rb{constructor(e){this.modelArtifacts=e}async load(){return this.modelArtifacts}}class Oge{constructor(e){this.saveHandler=e}async save(e){return this.saveHandler(e)}}function Mge(r,e,t,n){return arguments.length===1?r.modelTopology!=null||r.weightSpecs!=null?new rb(r):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new rb({modelTopology:r})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new rb({modelTopology:r,weightSpecs:e,weightData:t,trainingConfig:n}))}function Fge(r){return new Oge(r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Lge=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",browserFiles:$ge,browserHTTPRequest:xx,concatenateArrayBuffers:zS,decodeWeights:BS,encodeWeights:Hme,fromMemory:Mge,getLoadHandlers:WF,getModelArtifactsForJSON:VS,getModelArtifactsInfoForJSON:wm,getSaveHandlers:GF,http:WS,isHTTPScheme:bx,loadWeights:Nge,registerLoadRouter:tge,registerSaveRouter:ege,weightsLoaderFactory:tL,withSaveHandler:Fge,copyModel:mge,listModels:fge,moveModel:gge,removeModel:pge});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pge(r,e,t=!1,n=!1){let s=fe(r,"a","matMul"),o=fe(e,"b","matMul");[s,o]=Hr(s,o);const a={a:s,b:o},i={transposeA:t,transposeB:n};return ze.runKernel(d3,a,i)}const or=Ue({matMul_:Pge});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jge(r,e,t=1,n=0){if(e<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${e}`);const o={indices:fe(r,"indices","oneHot","int32")},a={depth:e,onValue:t,offValue:n};return ze.runKernel(OM,o,a)}const fd=Ue({oneHot_:jge});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bge(r,e){const t=fe(r,"x","transpose");if(e==null&&(e=t.shape.map((o,a)=>a).reverse()),Te(t.rank===e.length,()=>`Error in transpose: rank of input ${t.rank} must match length of perm ${e}.`),e.forEach(o=>{Te(o>=0&&o<t.rank,()=>`All entries in 'perm' must be between 0 and ${t.rank-1} but got ${e}`)}),t.rank<=1)return t.clone();const n={x:t},s={perm:e};return ze.runKernel(IF,n,s)}const Uf=Ue({transpose_:Bge});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uge(r,e,t){const n=fe(r,"labels","confusionMatrix"),s=fe(e,"predictions","confusionMatrix");Te(t==null||t>0&&Number.isInteger(t),()=>`If provided, numClasses must be a positive integer, but got ${t}`),Te(n.rank===1,()=>`Expected the rank of labels to be 1, but got ${n.rank}`),Te(s.rank===1,()=>`Expected the rank of predictions to be 1, but got ${s.rank}`),Te(n.shape[0]===s.shape[0],()=>`Mismatch in the number of examples: ${n.shape[0]} vs. ${s.shape[0]}. Labels and predictions should have the same number of elements.`),Te(t>0&&Number.isInteger(t),()=>`numClasses is required to be a positive integer, but got ${t}`);const o=fd(zn(n,"int32"),t),a=fd(zn(s,"int32"),t),i=Uf(o),l=or(i,a);return zn(l,"int32")}const zge=Ue({confusionMatrix_:Uge});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Vge=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",confusionMatrix:zge});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rL(r,e){const t=r.length,n=[];for(let s=0;s<t;s++){const o=t-1-s,a=r[o]||1;(e[e.length-1-s]||1)>1&&a===1&&n.unshift(o)}return n}function HS(r,e){const t=[];for(let n=0;n<e.length;n++){const s=r[r.length-n-1],o=e.length-n-1,a=e[o];(s==null||s===1&&a>1)&&t.unshift(o)}return t}function ps(r,e){const t=[],n=Math.max(r.length,e.length);for(let s=0;s<n;s++){let o=r[r.length-s-1];o==null&&(o=1);let a=e[e.length-s-1];if(a==null&&(a=1),o===1)t.unshift(a);else if(a===1)t.unshift(o);else if(o!==a){const i=`Operands could not be broadcast together with shapes ${r} and ${e}.`;throw Error(i)}else t.unshift(o)}return t}var Gge=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",getBroadcastDims:rL,getReductionAxes:HS,assertAndGetBroadcastShape:ps});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sL(r,e,t){if(nh(r),e!=null&&e.length!==3)throw new Error("tensor3d() requires shape to have three numbers");const n=el(r,t);if(n.length!==3&&n.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(n.length===1&&e==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return Mu(r,e,n,t)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let hc;function oL(r,e=3){if(e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(r==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let t=!1,n=!1,s=!1,o=!1,a=!1,i=!1;if(r.data instanceof Uint8Array)t=!0;else if(typeof ImageData!="undefined"&&r instanceof ImageData)n=!0;else if(typeof HTMLVideoElement!="undefined"&&r instanceof HTMLVideoElement)s=!0;else if(typeof HTMLImageElement!="undefined"&&r instanceof HTMLImageElement)o=!0;else if(r.getContext!=null)a=!0;else if(typeof ImageBitmap!="undefined"&&r instanceof ImageBitmap)i=!0;else throw new Error(`pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was ${r.constructor.name}`);if(s&&s&&r.readyState<2)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.");if(Iy(rx,ze.backendName)!=null){const p={pixels:r},m={numChannels:e};return ze.runKernel(rx,p,m)}const[u,h]=s?[r.videoWidth,r.videoHeight]:[r.width,r.height];let d;if(a)d=r.getContext("2d").getImageData(0,0,u,h).data;else if(n||t)d=r.data;else if(o||s||i){if(hc==null)if(typeof document=="undefined")if(typeof OffscreenCanvas!="undefined"&&typeof OffscreenCanvasRenderingContext2D!="undefined")hc=new OffscreenCanvas(1,1).getContext("2d");else throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");else hc=document.createElement("canvas").getContext("2d");hc.canvas.width=u,hc.canvas.height=h,hc.drawImage(r,0,0,u,h),d=hc.getImageData(0,0,u,h).data}let c;if(e===4)c=new Int32Array(d);else{const p=u*h;c=new Int32Array(p*e);for(let m=0;m<p;m++)for(let g=0;g<e;++g)c[m*e+g]=d[m*4+g]}return sL(c,[h,u,e],"int32")}function Wge(r){return r!=null&&r.data instanceof Uint8Array}function Hge(){return typeof window!="undefined"&&typeof ImageBitmap!="undefined"&&window.hasOwnProperty("createImageBitmap")}function qge(r){return r!=null&&r.width!==0&&r.height!==0}function Xge(r){return Hge()&&!(r instanceof ImageBitmap)&&qge(r)&&!Wge(r)}async function Kge(r,e=3){let t=null;if(Pn().getBool("WRAP_TO_IMAGEBITMAP")&&Xge(r)){let n;try{n=await createImageBitmap(r,{premultiplyAlpha:"none"})}catch{n=null}n!=null&&n.width===r.width&&n.height===r.height?t=n:t=r}else t=r;return oL(t,e)}async function S1(r,e){let t=fe(r,"img","toPixels");if(!(r instanceof pr)){const u=t;t=zn(u,"int32"),u.dispose()}if(t.rank!==2&&t.rank!==3)throw new Error(`toPixels only supports rank 2 or 3 tensors, got rank ${t.rank}.`);const[n,s]=t.shape.slice(0,2),o=t.rank===2?1:t.shape[2];if(o>4||o===2)throw new Error(`toPixels only supports depth of size 1, 3 or 4 but got ${o}`);if(t.dtype!=="float32"&&t.dtype!=="int32")throw new Error(`Unsupported type for toPixels: ${t.dtype}. Please use float32 or int32 tensors.`);const a=await t.data(),i=t.dtype==="float32"?255:1,l=new Uint8ClampedArray(s*n*4);for(let u=0;u<n*s;++u){const h=[0,0,0,255];for(let c=0;c<o;c++){const f=a[u*o+c];if(t.dtype==="float32"){if(f<0||f>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${f}.`)}else if(t.dtype==="int32"&&(f<0||f>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${f}.`);o===1?(h[0]=f*i,h[1]=f*i,h[2]=f*i):h[c]=f*i}const d=u*4;l[d+0]=Math.round(h[0]),l[d+1]=Math.round(h[1]),l[d+2]=Math.round(h[2]),l[d+3]=Math.round(h[3])}if(e!=null){e.width=s,e.height=n;const u=e.getContext("2d"),h=new ImageData(l,s,n);u.putImageData(h,0,0)}return t!==r&&t.dispose(),l}const Sm=Ue({fromPixels_:oL});var Yge=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",fromPixelsAsync:Kge,toPixels:S1,fromPixels:Sm});function iL(r,e){const t=r.shape.length,n=e.shape.length;if(t<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${t}.`);if(n<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${n}.`);if(e.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.shape[n-1]>t)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${e.shape[n-1]} vs. ${t}`);if(Ur(r.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${r.shape}.`);const s=e.shape,o=s[s.length-1];let a=1;for(let d=0;d<s.length-1;++d)a*=s[d];const i=r.shape,l=s.slice();l.pop();let u=1;for(let d=o;d<t;++d)u*=i[d],l.push(i[d]);const h=[...Od(r.shape).map(d=>d/u),1].slice(0,o);return[l,a,u,h]}var Zge=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",prepareAndValidate:iL});function qS(r,e,t){const n=e.rank>1?e.shape[e.rank-1]:1,s=e.rank>1?e.rank-1:1,o=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${t.shape}, indices.shape: ${e.shape}, shape: ${r}, sliceDim: ${n}, and batchDim: ${s}.`;if(t.rank<s)throw new Error(o+` update.rank < ${s}. `);if(r.length<n+(t.rank-s))throw new Error(o+` Output shape length < ${n+(t.rank-s)}`);if(t.rank!==s+r.length-n)throw new Error(o+` update.rank != ${s+r.length-n}`);for(let a=0;a<s;++a)if(t.shape[a]!==e.shape[a])throw new Error(o+` updates.shape[${a}] (${t.shape[a]}) != indices.shape[${a}] (${e.shape[a]}).`);for(let a=0;a<t.rank-s;++a)if(t.shape[a+s]!==r[a+n])throw new Error(o+` updates.shape[${a+s}] (${t.shape[a+s]}) != shape[${a+s}] (${r[a+s]})`)}function XS(r,e,t){if(e.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${e.rank}.`);if(r.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${r.rank}.`);if(e.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${e.dtype}`);if(t.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${t}`);if(t.length===0){if(e.size===0)throw new Error(`Indices specified for empty output. indices shape: ${e.shape}`);if(r.size===0)throw new Error(`Updates specified for empty output. updates shape: ${r.shape}`)}qS(t,e,r)}function aL(r,e,t){const n=e.shape.length,s=n>1?e.shape[n-1]:1,o=t.length;let a=1;for(let d=s;d<o;++d)a*=t[d];const i=s<1?1:s,l=Ur(e.shape)/i,u=[...Od(t.slice(0,s)),1],h=Ur(t);return{sliceRank:s,numUpdates:l,sliceSize:a,strides:u,outputSize:h}}var Qge=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",validateUpdateShape:qS,validateInput:XS,calculateShapes:aL});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wx=-2,Jge=-1;function eye(r,e,t){const n=r.shape.length;Te(n===e.length,()=>`Error in slice${n}D: Length of begin ${e} must match the rank of the array (${n}).`),Te(n===t.length,()=>`Error in slice${n}D: Length of size ${t} must match the rank of the array (${n}).`);for(let s=0;s<n;++s)Te(e[s]+t[s]<=r.shape[s],()=>`Error in slice${n}D: begin[${s}] + size[${s}] (${e[s]+t[s]}) would overflow input.shape[${s}] (${r.shape[s]})`)}function tye(r){const e=[];let t=0;for(;r>0;)r&1&&e.push(t),r/=2,t++;return e}function nye(r,e,t){const n=[];for(let s=0;s<r.length;s++)n[s]=Math.ceil((e[s]-r[s])/t[s]);return n}function lL(r,e,t,n){const s=[...r];for(let o=s.length;o<n.length;o++)s.push(1);for(let o=0;o<t;o++)o===0?s[e]=1:(s.splice(e,0,1),s.pop());return s}function uL(r,e,t){return t<=r?t:t-(e-1)}function cL(r,e){const t=[];for(let n=0;n<r;n++)t.push(e+n);return t}function rye(r,e,t,n,s,o,a,i,l){const u=r.length;let h=new Array(u),d=new Array(u),c=new Array(u);if(e.length&&t>0){const f=e[0],p=t+1;h=hL(a,f,p,n,r),d=dL(i,f,p,s,r),c=lL(o,f,p,r)}else for(let f=0;f<u;f++)h[f]=pL(a,n,o,r,f,l),d[f]=mL(i,s,o,r,f,l),c[f]=fL(o,f,l);return{begin:h,end:d,strides:c}}function hL(r,e,t,n,s){const o=[...s],a=cL(t,e);for(let i=0;i<o.length;i++)if(a.indexOf(i)>-1)o[i]=0;else{const l=uL(e,t,i);let u=n[l];r&1<<l&&(u=0),o[i]=u}return o}function dL(r,e,t,n,s){const o=[...s],a=cL(t,e);for(let i=0;i<o.length;i++)if(a.indexOf(i)>-1)o[i]=Number.MAX_SAFE_INTEGER;else{const l=uL(e,t,i);let u=n[l];r&1<<l&&(u=Number.MAX_SAFE_INTEGER),o[i]=u}for(let i=0;i<o.length;i++){const l=s[i];o[i]<0&&(o[i]+=l),o[i]=Ff(0,o[i],s[i])}return o}function fL(r,e,t){let n=r[e];return(t&1<<e||n==null)&&(n=1),n}function pL(r,e,t,n,s,o){let a=e[s];const i=t[s]||1;(r&1<<s||o&1<<s||a==null)&&(i>0?a=Number.MIN_SAFE_INTEGER:a=Number.MAX_SAFE_INTEGER);const l=n[s];return a<0&&(a+=l),a=Ff(0,a,l-1),a}function mL(r,e,t,n,s,o){let a=e[s];const i=t[s]||1;(r&1<<s||o&1<<s||a==null)&&(i>0?a=Number.MAX_SAFE_INTEGER:a=Number.MIN_SAFE_INTEGER);const l=n[s];return a<0&&(a+=l),i>0?a=Ff(0,a,l):a=Ff(-1,a,l-1),a}function sye(r,e,t){let n=t.length;for(let s=0;s<t.length;s++)if(t[s]>1){n=s;break}for(let s=n+1;s<t.length;s++)if(e[s]>0||t[s]!==r[s])return!1;return!0}function oye(r,e){let t=r.length>0?r[r.length-1]:1;for(let n=0;n<r.length-1;n++)t+=r[n]*e[n];return t}function iye(r,e,t){let n;const s=r.shape.length;typeof e=="number"?n=[e,...new Array(s-1).fill(0)]:e.length<s?n=e.concat(new Array(s-e.length).fill(0)):n=e.slice(),n.forEach(a=>{Te(a!==-1,()=>"slice() does not support negative begin indexing.")});let o;return t==null?o=new Array(s).fill(-1):typeof t=="number"?o=[t,...new Array(s-1).fill(-1)]:t.length<s?o=t.concat(new Array(s-t.length).fill(-1)):o=t,o=o.map((a,i)=>a>=0?a:(Te(a===-1,()=>`Negative size values should be exactly -1 but got ${a} for the slice() size at index ${i}.`),r.shape[i]-n[i])),[n,o]}function aye(r,e,t,n,s,o,a,i,l){let u;if(n==null?(u=new Array(e.length),u.fill(1)):u=n,a!=null&&(a&a-1)!==0)throw new Error("Multiple ellipses in slice is not allowed.");let h=!1;const d={dims:u.length,numAddAxisAfterEllipsis:0,begin:e.slice(),end:t.slice(),strides:u.slice(),beginMask:s,endMask:o,ellipsisMask:a,newAxisMask:i,shrinkAxisMask:l};for(let b=0;b<d.dims;b++)h&&(1<<b&i)!==0&&d.numAddAxisAfterEllipsis++,1<<b&a&&(h=!0);h||(d.ellipsisMask|=1<<d.dims,d.dims++);const c={dims:r.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};lye(d,c);let f=!0,p=!0,m=!0;const g=[],y=[];for(let b=0;b<r.length;++b){if(c.strides[b]===0)throw Error(`strides[${b}] must be non-zero`);const w=!!(c.shrinkAxisMask&1<<b),_=r[b];if(_===-1){g.push(w?1:-1);continue}const I=[c.beginMask&1<<b,c.endMask&1<<b],C=[c.strides[b]>0?0:-1,c.strides[b]>0?_:_-1];if(w&&c.strides[b]<=0)throw Error("only stride 1 allowed on non-range indexing.");m=m&&c.strides[b]===1;const N=!!(c.beginMask&1<<b&&c.endMask&1<<b);if(c.beginValid&&c.endValid){if(w){const P=c.begin[b]<0?_+c.begin[b]:c.begin[b];if(c.begin[b]=P,c.end[b]=c.begin[b]+1,P<0||P>=_)throw Error(`slice index ${c.begin[b]} of dimension ${b} out of bounds.`)}else c.begin[b]=bE(c.begin[b],0,c.strides[b],_,I,C),c.end[b]=bE(c.end[b],1,c.strides[b],_,I,C);const M=c.strides[b]===1&&c.begin[b]===0&&c.end[b]===_;f=f&&M,p=p&&(b===0&&c.strides[b]===1||M)}else f=f&&c.strides[b]===1&&N,p=p&&(b===0&&c.strides[b]===1||N);let O,D=!1;if(c.beginValid&&c.endValid?(O=c.end[b]-c.begin[b],D=!0):w?(O=1,D=!0):N&&_>=0&&(c.strides[b]<0?O=-_:O=_,D=!0),D){let M;O===0||O<0!=c.strides[b]<0?M=0:M=Math.trunc(O/c.strides[b])+(O%c.strides[b]!==0?1:0),g.push(M)}else g.push(-1)}for(let b=0;b<c.finalShapeGatherIndices.length;++b){const w=c.finalShapeGatherIndices[b];w>=0?y.push(g[w]):w===wx&&y.push(1)}return{finalShapeSparse:y.filter((b,w)=>c.finalShapeGatherIndices[w]!==wx),finalShape:y,isIdentity:f,sliceDim0:p,isSimpleSlice:m,begin:c.begin,end:c.end,strides:c.strides}}function lye(r,e){e.beginMask=0,e.endMask=0,e.shrinkAxisMask=0;let t=0;e.beginValid=r.begin!=null,e.endValid=r.end!=null,e.begin=new Array(e.dims),e.end=new Array(e.dims),e.strides=new Array(e.dims),e.finalShapeGatherIndices=[],e.finalShapeGatherIndicesSparse=[],e.inputShapeGatherIndicesSparse=new Array(e.dims);for(let n=0;n<r.dims;n++)if(1<<n&r.ellipsisMask){const s=Math.min(e.dims-(r.dims-n)+1+r.numAddAxisAfterEllipsis,e.dims);for(;t<s;t++)e.begin[t]=0,e.end[t]=0,e.strides[t]=1,e.beginMask|=1<<t,e.endMask|=1<<t,e.finalShapeGatherIndices.push(t),e.finalShapeGatherIndicesSparse.push(-1),e.inputShapeGatherIndicesSparse[t]=n}else if(1<<n&r.newAxisMask)e.finalShapeGatherIndices.push(wx),e.finalShapeGatherIndicesSparse.push(-1);else{if(t===e.begin.length)throw Error(`Index out of range using input dim ${t}; input has only ${e.dims} dims, ${e.begin.length}.`);r.begin!=null&&(e.begin[t]=r.begin[n]),r.end!=null&&(e.end[t]=r.end[n]),e.strides[t]=r.strides[n],r.beginMask&1<<n&&(e.beginMask|=1<<t),r.endMask&1<<n&&(e.endMask|=1<<t),r.shrinkAxisMask&1<<n?(e.finalShapeGatherIndices.push(Jge),e.finalShapeGatherIndicesSparse.push(-1),e.shrinkAxisMask|=1<<t):(e.finalShapeGatherIndices.push(t),e.finalShapeGatherIndicesSparse.push(n)),e.inputShapeGatherIndicesSparse[t]=n,t++}}function bE(r,e,t,n,s,o){if(s[e])return t>0?o[e]:o[e+1&1];{const a=r<0?n+r:r;return a<o[0]?o[0]:a>o[1]?o[1]:a}}var gL=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",assertParamsValid:eye,maskToAxes:tye,computeOutShape:nye,stridesWithElidedDims:lL,getNormalizedAxes:rye,startIndicesWithElidedDims:hL,stopIndicesWithElidedDims:dL,stridesForAxis:fL,startForAxis:pL,stopForAxis:mL,isSliceContinous:sye,computeFlatOffset:oye,parseSliceParams:iye,sliceInfo:aye});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yL{getClassName(){return this.constructor.className}static fromConfig(e,t){return new e(t)}}class ru{constructor(){this.classNameMap={}}static getMap(){return ru.instance==null&&(ru.instance=new ru),ru.instance}static register(e){ru.getMap().classNameMap[e.className]=[e,e.fromConfig]}}function Fu(r){Te(r.className!=null,()=>"Class being registered does not have the static className property defined."),Te(typeof r.className=="string",()=>"className is required to be a string, but got type "+typeof r.className),Te(r.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),ru.register(r)}var uye=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",Serializable:yL,SerializationMap:ru,registerClass:Fu});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cye=.001,vL=.1;function hye(r,e,t){return t==null&&(t=KS()),Sx(r,e,(n,s)=>YS(n,s,t))}function KS(){return ze.backend.floatPrecision()===32?cye:vL}function Sx(r,e,t){let n=!0;if((Gs(r)||Gs(e))&&(n=!1),Gs(r)&&Gs(e)&&(n=!0),n){const a=r.constructor.name,i=e.constructor.name;if(a!==i)throw new Error(`Arrays are of different type. Actual: ${a}. Expected: ${i}`)}if(Array.isArray(r)&&Array.isArray(e)){const a=el(r),i=el(e);if(!Ja(a,i))throw new Error(`Arrays have different shapes. Actual: [${a}]. Expected: [${i}]`)}const s=Gs(r)?r:zc(r),o=Gs(e)?e:zc(e);if(s.length!==o.length)throw new Error(`Arrays have different lengths actual: ${s.length} vs expected: ${o.length}.
Actual:   ${s}.
Expected: ${o}.`);for(let a=0;a<o.length;++a){const i=s[a],l=o[a];if(!t(i,l))throw new Error(`Arrays differ: actual[${a}] = ${i}, expected[${a}] = ${l}.
Actual:   ${s}.
Expected: ${o}.`)}}function dye(r,e){r().then(()=>e.fail(),()=>e())}function fye(r,e){const t=typeof e=="string"||typeof e=="number"||typeof e=="boolean"?[e]:e;return iu(r)||iu(r[0])||iu(e)||iu(e[0])?Sx(r,t,(n,s)=>n==s):Sx(r,e,(n,s)=>YS(n,s,0))}function pye(r,e,t){if(t==null&&(t=KS()),!YS(r,e,t))throw new Error(`Numbers differ: actual === ${r}, expected === ${e}`)}function YS(r,e,t){return!isFinite(r)&&!isFinite(e)?!0:!(isNaN(r)||isNaN(e)||Math.abs(r-e)>t)}function mye(r,e,t){for(let n=0;n<r.length;n++)if(r[n]<e||r[n]>t)throw new Error(`Value out of range:${r[n]} low: ${e}, high: ${t}`)}function gye(r,e){const t=new Float32Array(r),n=new Float32Array(e);if(t.length!==n.length)throw new Error(`Expected ArrayBuffer to be of length ${n.length}, but it was ${t.length}`);for(let s=0;s<n.length;s++)if(t[s]!==n[s])throw new Error(`Expected ArrayBuffer value at ${s} to be ${n[s]} but got ${t[s]} instead`)}function bL(r){for(let e=0;e<r.length;e++){const t=r[e];Array.isArray(t)?bL(t):r[e]=xm(t)}return r}var yye=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",TEST_EPSILON_FLOAT16:vL,expectArraysClose:hye,testEpsilon:KS,expectPromiseToFail:dye,expectArraysEqual:fye,expectNumbersClose:pye,expectValuesInRange:mye,expectArrayBuffersEqual:gye,encodeStrings:bL});/** @license See the LICENSE file. */const vye="3.13.0";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bye(){Pn().set("PROD",!0)}function xye(){Pn().set("DEBUG",!0)}function wye(){Pn().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function Sye(r){Pn().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(r+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function _ye(){ze.disposeVariables()}function _m(){return ze}function Tye(){return ze.memory()}function kye(r){return ze.profile(r)}function Vt(r,e){return ze.tidy(r,e)}function xo(r){jS(r).forEach(t=>t.dispose())}function za(r){return ze.keep(r)}function Iye(r){return ze.time(r)}function Eye(r){return ze.setBackend(r)}function Cye(){return ze.ready()}function ZS(){return ze.backendName}function $ye(r){ze.removeBackend(r)}function Nye(r){return ze.findBackend(r)}function Aye(r){return ze.findBackendFactory(r)}function Rye(r,e,t=1){return ze.registerBackend(r,e,t)}function QS(){return ze.backend}function Dye(r,e){Pn().setPlatform(r,e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oye(r,e){let t=fe(r,"a","add"),n=fe(e,"b","add");[t,n]=Hr(t,n);const s={a:t,b:n};return ze.runKernel(OS,s)}const xn=Ue({add_:Oye});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mye(r,e){let t=fe(r,"a","floorDiv"),n=fe(e,"b","floorDiv");[t,n]=Hr(t,n);const s={a:t,b:n};return ze.runKernel(K3,s)}const JS=Ue({floorDiv_:Mye});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fye(r,e){let t=fe(r,"a","div"),n=fe(e,"b","div");if([t,n]=Hr(t,n),t.dtype==="int32"&&n.dtype==="int32")return JS(t,n);const s={a:t,b:n},o={};return ze.runKernel(L3,s,o)}const kr=Ue({div_:Fye});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lye(r,e){let t=fe(r,"a","mul"),n=fe(e,"b","mul");[t,n]=Hr(t,n);const s={a:t,b:n};return ze.runKernel(EM,s)}const Ut=Ue({mul_:Lye});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pye(r){const e=fe(r,"x","abs");if(e.dtype==="complex64"){const t={x:e};return ze.runKernel(b3,t)}else{const t={x:e};return ze.runKernel(ZO,t)}}const Oo=Ue({abs_:Pye});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jye(r){const t={x:fe(r,"x","acos")};return ze.runKernel(QO,t)}const xL=Ue({acos_:jye});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bye(r){const t={x:fe(r,"x","acosh")};return ze.runKernel(JO,t)}const wL=Ue({acosh_:Bye});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uye(r){Te(Array.isArray(r),()=>"The argument passed to tf.addN() must be a list of tensors"),Te(r.length>=1,()=>`Must pass at least one tensor to tf.addN(), but got ${r.length}`);const e=r.map((s,o)=>fe(s,`tensors${o}`,"addN")),t=e[0];e.forEach(s=>{if(s.dtype!==t.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),e.forEach(s=>{if(!Ja(s.shape,t.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});const n=e;return ze.runKernel(e3,n)}const SL=Ue({addN_:Uye});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zye(r,e=null,t=!1){const s={x:fe(r,"x","all","bool")},o={axis:e,keepDims:t};return ze.runKernel(t3,s,o)}const _L=Ue({all_:zye});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vye(r,e=null,t=!1){const s={x:fe(r,"x","any","bool")},o={axis:e,keepDims:t};return ze.runKernel(n3,s,o)}const TL=Ue({any_:Vye});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gye(r,e=0){const n={x:fe(r,"x","argMax")},s={axis:e};return ze.runKernel(r3,n,s)}const _1=Ue({argMax_:Gye});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wye(r,e=0){const n={x:fe(r,"x","argMin")},s={axis:e};return ze.runKernel(s3,n,s)}const kL=Ue({argMin_:Wye});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hye(r){const t={x:fe(r,"x","asin")};return ze.runKernel(o3,t)}const IL=Ue({asin_:Hye});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qye(r){const t={x:fe(r,"x","asinh")};return ze.runKernel(i3,t)}const EL=Ue({asinh_:qye});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xye(r){const t={x:fe(r,"x","atan")};return ze.runKernel(a3,t)}const CL=Ue({atan_:Xye});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kye(r,e){let t=fe(r,"a","atan2"),n=fe(e,"b","atan2");[t,n]=Hr(t,n);const s={a:t,b:n};return ze.runKernel(u3,s)}const $L=Ue({atan2_:Kye});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yye(r){const t={x:fe(r,"x","atanh")};return ze.runKernel(l3,t)}const NL=Ue({atanh_:Yye});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zye(r,e,t,n,s="NHWC",o){const a=r[3],i=[...e,a],l=DL(s);return Tm(r,i,t,o,n,null,null,l)}function AL(r,e,t,n,s,o,a="channelsLast"){const[i,l]=Ay(e);let u;if(a==="channelsLast")u=[i,l,r[3],r[3]];else if(a==="channelsFirst")u=[i,l,r[1],r[1]];else throw new Error(`Unknown dataFormat ${a}`);return Tm(r,u,t,n,s,o,!1,a)}function Qye(r,e,t,n,s,o,a="NDHWC"){const[i,l,u]=_x(e);let h,d;if(a==="NDHWC")d="channelsLast",h=[i,l,u,r[4],r[4]];else if(a==="NCDHW")d="channelsFirst",h=[i,l,u,r[1],r[1]];else throw new Error(`Unknown dataFormat ${a}`);return RL(r,h,t,n,s,!1,d,o)}function Tm(r,e,t,n,s,o,a=!1,i="channelsLast"){let[l,u,h,d]=[-1,-1,-1,-1];if(i==="channelsLast")[l,u,h,d]=r;else if(i==="channelsFirst")[l,d,u,h]=r;else throw new Error(`Unknown dataFormat ${i}`);const[c,f,,p]=e,[m,g]=Ay(t),[y,v]=Ay(n),b=Wh(c,y),w=Wh(f,v),{padInfo:_,outHeight:I,outWidth:C}=t0e(s,u,h,m,g,b,w,o,i),N=a?p*d:p;let O;return i==="channelsFirst"?O=[l,N,I,C]:i==="channelsLast"&&(O=[l,I,C,N]),{batchSize:l,dataFormat:i,inHeight:u,inWidth:h,inChannels:d,outHeight:I,outWidth:C,outChannels:N,padInfo:_,strideHeight:m,strideWidth:g,filterHeight:c,filterWidth:f,effectiveFilterHeight:b,effectiveFilterWidth:w,dilationHeight:y,dilationWidth:v,inShape:r,outShape:O,filterShape:e}}function RL(r,e,t,n,s,o=!1,a="channelsLast",i){let[l,u,h,d,c]=[-1,-1,-1,-1,-1];if(a==="channelsLast")[l,u,h,d,c]=r;else if(a==="channelsFirst")[l,c,u,h,d]=r;else throw new Error(`Unknown dataFormat ${a}`);const[f,p,m,,g]=e,[y,v,b]=_x(t),[w,_,I]=_x(n),C=Wh(f,w),N=Wh(p,_),O=Wh(m,I),{padInfo:D,outDepth:M,outHeight:P,outWidth:F}=n0e(s,u,h,d,y,v,b,C,N,O,i),B=o?g*c:g;let z;return a==="channelsFirst"?z=[l,B,M,P,F]:a==="channelsLast"&&(z=[l,M,P,F,B]),{batchSize:l,dataFormat:a,inDepth:u,inHeight:h,inWidth:d,inChannels:c,outDepth:M,outHeight:P,outWidth:F,outChannels:B,padInfo:D,strideDepth:y,strideHeight:v,strideWidth:b,filterDepth:f,filterHeight:p,filterWidth:m,effectiveFilterDepth:C,effectiveFilterHeight:N,effectiveFilterWidth:O,dilationDepth:w,dilationHeight:_,dilationWidth:I,inShape:r,outShape:z,filterShape:e}}function Jye(r,e,t,n,s){n==null&&(n=e_(r,e,t));const o=r[0],a=r[1],i=Ec((o-e+2*n)/t+1,s),l=Ec((a-e+2*n)/t+1,s);return[i,l]}function e0e(r,e,t,n,s,o){s==null&&(s=e_(r,e,n));const a=r[0],i=r[1],l=r[2],u=Ec((a-e+2*s)/n+1,o),h=Ec((i-e+2*s)/n+1,o),d=Ec((l-e+2*s)/n+1,o);return[u,h,d,t]}function e_(r,e,t,n=1){const s=Wh(e,n);return Math.floor((r[0]*(t-1)-t+s)/2)}function Ay(r){return typeof r=="number"?[r,r,r]:r.length===2?[r[0],r[1],1]:r}function _x(r){return typeof r=="number"?[r,r,r]:r}function Wh(r,e){return e<=1?r:r+(r-1)*(e-1)}function t0e(r,e,t,n,s,o,a,i,l){let u,h,d;if(typeof r=="number"){u={top:r,bottom:r,left:r,right:r,type:r===0?"VALID":"NUMBER"};const f=Jye([e,t],o,n,r,i);h=f[0],d=f[1]}else if(r==="same"){h=Math.ceil(e/n),d=Math.ceil(t/s);const c=Math.max(0,(h-1)*n+o-e),f=Math.max(0,(d-1)*s+a-t),p=Math.floor(c/2),m=c-p,g=Math.floor(f/2),y=f-g;u={top:p,bottom:m,left:g,right:y,type:"SAME"}}else if(r==="valid")u={top:0,bottom:0,left:0,right:0,type:"VALID"},h=Math.ceil((e-o+1)/n),d=Math.ceil((t-a+1)/s);else if(typeof r=="object"){const c=l==="channelsLast"?r[1][0]:r[2][0],f=l==="channelsLast"?r[1][1]:r[2][1],p=l==="channelsLast"?r[2][0]:r[3][0],m=l==="channelsLast"?r[2][1]:r[3][1];u={top:c,bottom:f,left:p,right:m,type:c===0&&f===0&&p===0&&m===0?"VALID":"EXPLICIT"},h=Ec((e-o+c+f)/n+1,i),d=Ec((t-a+p+m)/s+1,i)}else throw Error(`Unknown padding parameter: ${r}`);return{padInfo:u,outHeight:h,outWidth:d}}function n0e(r,e,t,n,s,o,a,i,l,u,h){let d,c,f,p;if(typeof r=="number"){d={top:r,bottom:r,left:r,right:r,front:r,back:r,type:r===0?"VALID":"NUMBER"};const g=e0e([e,t,n,1],i,1,s,r,h);c=g[0],f=g[1],p=g[2]}else if(r==="same"){c=Math.ceil(e/s),f=Math.ceil(t/o),p=Math.ceil(n/a);const m=(c-1)*s+i-e,g=(f-1)*o+l-t,y=(p-1)*a+u-n,v=Math.floor(m/2),b=m-v,w=Math.floor(g/2),_=g-w,I=Math.floor(y/2),C=y-I;d={top:w,bottom:_,left:I,right:C,front:v,back:b,type:"SAME"}}else if(r==="valid")d={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},c=Math.ceil((e-i+1)/s),f=Math.ceil((t-l+1)/o),p=Math.ceil((n-u+1)/a);else throw Error(`Unknown padding parameter: ${r}`);return{padInfo:d,outDepth:c,outHeight:f,outWidth:p}}function Ec(r,e){if(!e)return Math.trunc(r);switch(e){case"round":return Math.round(r);case"ceil":return Math.ceil(r);case"floor":return Math.floor(r);default:throw new Error(`Unknown roundingMode ${e}`)}}function zf(r){const[e,t,n]=Ay(r);return e===1&&t===1&&n===1}function Ml(r,e){return zf(r)||zf(e)}function DL(r){if(r==="NHWC")return"channelsLast";if(r==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${r}`)}function Qi(r,e,t){if(t!=null){if(typeof e=="string")throw Error(`Error in ${r}: pad must be an integer when using dimRoundingMode ${t} but got pad ${e}.`);if(typeof e=="number")Te(ud(e),()=>`Error in ${r}: pad must be an integer when using dimRoundingMode ${t} but got pad ${e}.`);else if(typeof e=="object")e.forEach(n=>{n.forEach(s=>{Te(ud(s),()=>`Error in ${r}: pad must be an integer when using dimRoundingMode ${t} but got pad ${s}.`)})});else throw Error(`Error in ${r}: Unknown padding parameter: ${e}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r0e(r,e){const n={x:fe(r,"x","reshape","string_or_numeric")},s={shape:e};return ze.runKernel(GM,n,s)}const bt=Ue({reshape_:r0e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s0e(r,e,t,n,s){const o=fe(r,"x","avgPool","float32"),a=1;Te(Ml(t,a),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${t} and dilations '${a}'`);let i=o,l=!1;o.rank===3&&(l=!0,i=bt(o,[1,o.shape[0],o.shape[1],o.shape[2]])),Te(i.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${i.rank}.`),Qi("avgPool",n,s);const u={x:i},h={filterSize:e,strides:t,pad:n,dimRoundingMode:s};let d=ze.runKernel(c3,u,h);return d=zn(d,o.dtype),l?bt(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const t_=Ue({avgPool_:s0e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o0e(r,e,t,n,s,o="NDHWC"){const a=fe(r,"x","avgPool3d","float32");let i=a,l=!1;a.rank===4&&(l=!0,i=bt(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),Te(i.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${i.rank}.`),Te(o==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${o}`),Qi("avgPool3d",n,s);const u={x:i},h={filterSize:e,strides:t,pad:n,dimRoundingMode:s,dataFormat:o};let d=ze.runKernel(h3,u,h);return d=zn(d,i.dtype),l?bt(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const OL=Ue({avgPool3d_:o0e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i0e(r,e=0){Te(r.length>=1,()=>"Pass at least one tensor to concat");const t=Bf(r,"tensors","concat","string_or_numeric");if(t[0].dtype==="complex64"&&t.forEach(o=>{if(o.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${o.dtype}. `)}),t.length===1)return pu(t[0]);const n=t,s={axis:e};return ze.runKernel(x3,n,s)}const qs=Ue({concat_:i0e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a0e(r){const t={x:fe(r,"x","sigmoid","float32")};return ze.runKernel(sF,t)}const zi=Ue({sigmoid_:a0e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l0e(r,e,t){const n=fe(r,"x","slice","string_or_numeric");if(n.rank===0)throw new Error("Slicing scalar is not possible");const s={x:n},o={begin:e,size:t};return ze.runKernel(eF,s,o)}const Tr=Ue({slice_:l0e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u0e(r){const t={x:fe(r,"x","tanh","float32")};return ze.runKernel(_F,t)}const Ry=Ue({tanh_:u0e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c0e(r,e,t,n,s,o){const a=fe(r,"forgetBias","basicLSTMCell"),i=fe(e,"lstmKernel","basicLSTMCell"),l=fe(t,"lstmBias","basicLSTMCell"),u=fe(n,"data","basicLSTMCell"),h=fe(s,"c","basicLSTMCell"),d=fe(o,"h","basicLSTMCell"),c=qs([u,d],1),f=or(c,i),p=xn(f,l),m=p.shape[0],g=p.shape[1]/4,y=[m,g],v=Tr(p,[0,0],y),b=Tr(p,[0,g],y),w=Tr(p,[0,g*2],y),_=Tr(p,[0,g*3],y),I=xn(Ut(zi(v),Ry(b)),Ut(h,zi(xn(a,w)))),C=Ut(Ry(I),zi(_));return[I,C]}const h0e=Ue({basicLSTMCell_:c0e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d0e(r,e,t){const n=fe(r,"x","batchToSpaceND"),s=e.reduce((i,l)=>i*l);Te(n.rank>=1+e.length,()=>`input rank is ${n.rank} but should be > than blockShape.length ${e.length}`),Te(t.length===e.length,()=>`crops.length is ${t.length} but should be equal to blockShape.length  ${e.length}`),Te(n.shape[0]%s===0,()=>`input tensor batch is ${n.shape[0]} but is not divisible by the product of the elements of blockShape ${e.join(" * ")} === ${s}`);const o={x:n},a={blockShape:e,crops:t};return ze.runKernel(f3,o,a)}const n_=Ue({batchToSpaceND_:d0e});function f0e(r){let e;return r.rank===0||r.rank===1?e=bt(r,[1,1,1,r.size]):r.rank===2?e=bt(r,[1,1,r.shape[0],r.shape[1]]):r.rank===3?e=bt(r,[1,r.shape[0],r.shape[1],r.shape[2]]):e=r,e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p0e(r,e,t,n,s,o){o==null&&(o=.001);const a=fe(r,"x","batchNorm"),i=fe(e,"mean","batchNorm"),l=fe(t,"variance","batchNorm");let u;s!=null&&(u=fe(s,"scale","batchNorm"));let h;n!=null&&(h=fe(n,"offset","batchNorm")),Te(i.rank===l.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),Te(h==null||i.rank===h.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),Te(u==null||i.rank===u.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const c={x:f0e(a),scale:u,offset:h,mean:i,variance:l},f={varianceEpsilon:o},p=ze.runKernel(Y3,c,f);return bt(p,a.shape)}const pd=Ue({batchNorm_:p0e});function m0e(r,e,t,n,s,o){const a=fe(r,"x","batchNorm"),i=fe(e,"mean","batchNorm"),l=fe(t,"variance","batchNorm");let u;s!=null&&(u=fe(s,"scale","batchNorm"));let h;return n!=null&&(h=fe(n,"offset","batchNorm")),Te(a.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${a.rank}.`),Te(i.rank===2||i.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${i.rank}.`),Te(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${l.rank}.`),u!=null&&Te(u.rank===2||u.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${u.rank}.`),h!=null&&Te(h.rank===2||h.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${h.rank}.`),pd(a,i,l,h,u,o)}const g0e=Ue({batchNorm2d_:m0e});function y0e(r,e,t,n,s,o){const a=fe(r,"x","batchNorm"),i=fe(e,"mean","batchNorm"),l=fe(t,"variance","batchNorm");let u;s!=null&&(u=fe(s,"scale","batchNorm"));let h;return n!=null&&(h=fe(n,"offset","batchNorm")),Te(a.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${a.rank}.`),Te(i.rank===3||i.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${i.rank}.`),Te(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${l.rank}.`),u!=null&&Te(u.rank===3||u.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${u.rank}.`),h!=null&&Te(h.rank===3||h.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${h.rank}.`),pd(a,i,l,h,u,o)}const v0e=Ue({batchNorm3d_:y0e});function b0e(r,e,t,n,s,o){const a=fe(r,"x","batchNorm"),i=fe(e,"mean","batchNorm"),l=fe(t,"variance","batchNorm");let u;s!=null&&(u=fe(s,"scale","batchNorm"));let h;return n!=null&&(h=fe(n,"offset","batchNorm")),Te(a.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${a.rank}.`),Te(i.rank===4||i.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${i.rank}.`),Te(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${l.rank}.`),u!=null&&Te(u.rank===4||u.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${u.rank}.`),h!=null&&Te(h.rank===4||h.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${h.rank}.`),pd(a,i,l,h,u,o)}const x0e=Ue({batchNorm4d_:b0e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w0e(r,e,t){const n=fe(r,"x","bincount"),s=fe(e,"weights","bincount");Te(n.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${n.dtype}`),Te(t>=0,()=>`size must be non-negative, but got ${t}.`),Te(s.size===n.size||s.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${n.shape}, weights shape: ${s.shape}.`);const o={x:n,weights:s},a={size:t};return ze.runKernel(p3,o,a)}const r_=Ue({bincount_:w0e});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S0e(r,e){const t=fe(r,"s0","broadcastArgs","int32"),n=fe(e,"s1","broadcastArgs","int32");if(t.rank!==1)throw new Error(`broadcastArgs(): first input must be a vector (rank=1). Has rank ${t.rank}`);if(n.rank!==1)throw new Error(`broadcastArgs(): second input must be a vector (rank=1). Has rank ${n.rank}`);const s={s0:t,s1:n};return ze.runKernel(m3,s)}const ML=Ue({broadcastArgs_:S0e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _0e(r,e){let t=fe(r,"broadcastTo","x");const n=t.shape;if(e.some(u=>!(u>0)||u%1!==0))throw new Error(`broadcastTo(): Invalid broadcast shape [${e}].`);if(e.length<t.rank)throw new Error(`broadcastTo(): shape.length=${e.length} < input.rank=${t.rank}.`);if(e.length>t.rank){const u=t.shape.slice();for(;u.length<e.length;)u.unshift(1);t=bt(t,u)}const s=t.shape,o=Array.from(e);for(let u=e.length-1;u>=0;u--)if(s[u]===e[u])o[u]=1;else if(t.shape[u]!==1)throw new Error(`broadcastTo(): [${n}] cannot be broadcast to [${e}].`);if(o.map((u,h)=>u>1?h:-1).filter(u=>u>=0).length===0)return pu(t);const i={x:t},l={reps:o};return ze.runKernel(LS,i,l)}const kf=Ue({broadcastTo_:_0e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T0e(r){const t={x:fe(r,"x","ceil","float32")};return ze.runKernel(g3,t)}const FL=Ue({ceil_:T0e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k0e(r,e,t){const n=fe(r,"x","clipByValue");Te(e<=t,()=>`Error in clip: min (${e}) must be less than or equal to max (${t}).`);const s={x:n},o={clipValueMin:e,clipValueMax:t};return ze.runKernel(y3,s,o)}const LL=Ue({clipByValue_:k0e});function I0e(r){return qs(r,0)}const E0e=Ue({concat1d_:I0e});function C0e(r,e){return qs(r,e)}const $0e=Ue({concat2d_:C0e});function N0e(r,e){return qs(r,e)}const A0e=Ue({concat3d_:N0e});function R0e(r,e){return qs(r,e)}const D0e=Ue({concat4d_:R0e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O0e(r,e,t,n,s="NHWC",o=[1,1],a){const i=fe(r,"x","conv2d","float32"),l=fe(e,"filter","conv2d","float32");let u=i,h=!1;i.rank===3&&(h=!0,u=bt(i,[1,i.shape[0],i.shape[1],i.shape[2]])),Te(u.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${u.rank}.`),Te(l.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${l.rank}.`),Qi("conv2d",n,a);const d=s==="NHWC"?u.shape[3]:u.shape[1];Te(d===l.shape[2],()=>`Error in conv2d: depth of input (${d}) must match input depth for filter ${l.shape[2]}.`),Te(Ml(t,o),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${t} and dilations '${o}'`);const c={x:u,filter:l},f={strides:t,pad:n,dataFormat:s,dilations:o,dimRoundingMode:a},p=ze.runKernel(w3,c,f);return h?bt(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const km=Ue({conv2d_:O0e});function M0e(r,e,t,n,s="NWC",o=1,a){const i=fe(r,"x","conv1d"),l=fe(e,"filter","conv1d");let u=i,h=!1;i.rank===2&&(h=!0,u=bt(i,[1,i.shape[0],i.shape[1]])),Te(u.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${u.rank}.`),Te(l.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${l.rank}.`),Qi("conv1d",n,a),Te(u.shape[2]===l.shape[1],()=>`Error in conv1d: depth of input (${u.shape[2]}) must match input depth for filter ${l.shape[1]}.`),Te(Ml(t,o),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${t} and dilation '${o}'`),Te(s==="NWC",()=>`Error in conv1d: got dataFormat of ${s} but only NWC is currently supported.`);const d=bt(l,[1,l.shape[0],l.shape[1],l.shape[2]]),c=bt(u,[u.shape[0],1,u.shape[1],u.shape[2]]),g=km(c,d,[1,t],n,"NHWC",[1,o],a);return h?bt(g,[g.shape[2],g.shape[3]]):bt(g,[g.shape[0],g.shape[2],g.shape[3]])}const PL=Ue({conv1d_:M0e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F0e(r,e,t,n,s,o="NHWC",a){Te(r.length===e.rank,()=>`Length of inShape (${r.length}) and rank of dy (${e.rank}) must match`);let i=r,l=e,u=!1;e.rank===3&&(u=!0,l=bt(e,[1,e.shape[0],e.shape[1],e.shape[2]]),i=[1,r[0],r[1],r[2]]),Te(i.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${i.length}.`),Te(l.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${l.rank}`),Te(t.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${t.rank}`);const h=o==="NHWC"?i[3]:i[1],d=o==="NHWC"?l.shape[3]:l.shape[1];Te(h===t.shape[2],()=>`Error in conv2dDerInput: depth of input (${h}) must match input depth for filter ${t.shape[2]}.`),Te(d===t.shape[3],()=>`Error in conv2dDerInput: depth of output (${d}) must match output depth for filter ${t.shape[3]}.`),Qi("conv2dDerInput",s,a);const c={dy:l,filter:t},f={strides:n,pad:s,dataFormat:o,dimRoundingMode:a,inputShape:i},p=ze.runKernel(_3,c,f);return u?bt(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const jL=Ue({conv2DBackpropInput_:F0e});function L0e(r,e,t,n,s,o){const a=fe(r,"x","conv2dTranspose"),i=fe(e,"filter","conv2dTranspose");return jL(t,a,i,n,s,"NHWC",o)}const BL=Ue({conv2dTranspose_:L0e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P0e(r,e,t,n,s="NDHWC",o=[1,1,1]){const a=fe(r,"x","conv3d"),i=fe(e,"filter","conv3d");let l=a,u=!1;a.rank===4&&(u=!0,l=bt(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),Te(l.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${l.rank}.`),Te(i.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${i.rank}.`),Te(l.shape[4]===i.shape[3],()=>`Error in conv3d: depth of input (${l.shape[4]}) must match input depth for filter ${i.shape[3]}.`),Te(Ml(t,o),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${t} and dilations '${o}'`),Te(s==="NDHWC",()=>`Error in conv3d: got dataFormat of ${s} but only NDHWC is currently supported.`);const h={x:l,filter:i},d={strides:t,pad:n,dataFormat:s,dilations:o},c=ze.runKernel(T3,h,d);return u?bt(c,[c.shape[1],c.shape[2],c.shape[3],c.shape[4]]):c}const UL=Ue({conv3d_:P0e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j0e(r,e,t,n,s){Te(r.length===e.rank,()=>`Length of inShape (${r.length}) and rank of dy (${e.rank}) must match`);let o=r,a=e,i=!1;e.rank===4&&(i=!0,a=bt(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),o=[1,r[0],r[1],r[2],r[3]]);const l=o[4],u=a.shape[4];Te(o.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${o.length}.`),Te(a.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${a.rank}`),Te(t.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${t.rank}`),Te(l===t.shape[3],()=>`Error in conv3dDerInput: depth of input (${l}) must match input depth for filter ${t.shape[3]}.`),Te(u===t.shape[4],()=>`Error in conv3dDerInput: depth of output (${u}) must match output depth for filter ${t.shape[4]}.`);const h={dy:a,filter:t},d={pad:s,strides:n,inputShape:o},c=ze.runKernel(k3,h,d);return i?bt(c,[c.shape[1],c.shape[2],c.shape[3],c.shape[4]]):c}const B0e=Ue({conv3DBackpropInput_:j0e});function U0e(r,e,t,n,s){const o=fe(r,"x","conv3dTranspose"),a=fe(e,"filter","conv3dTranspose");return B0e(t,o,a,n,s)}const z0e=Ue({conv3dTranspose_:U0e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V0e(r){const t={x:fe(r,"x","cos","float32")};return ze.runKernel(I3,t)}const zL=Ue({cos_:V0e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G0e(r){const t={x:fe(r,"x","cosh","float32")};return ze.runKernel(E3,t)}const VL=Ue({cosh_:G0e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W0e(r,e=0,t=!1,n=!1){const o={x:fe(r,"x","cumsum")},a={axis:e,exclusive:t,reverse:n};return ze.runKernel(C3,o,a)}const GL=Ue({cumsum_:W0e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H0e(r,e,t,n=!1){const s=fe(r,"x","denseBincount"),o=fe(e,"weights","denseBincount");Te(s.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${s.dtype}`),Te(s.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${s.rank}.`),Te(t>=0,()=>`size must be non-negative, but got ${t}.`),Te(o.size===s.size||o.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${s.shape}, weights shape: ${o.shape}.`);const a={x:s,weights:o},i={size:t,binaryOutput:n};return ze.runKernel(N3,a,i)}const WL=Ue({denseBincount_:H0e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q0e(r,e,t="NHWC"){const n=fe(r,"x","depthToSpace","float32"),s=t==="NHWC"?n.shape[1]:n.shape[2],o=t==="NHWC"?n.shape[2]:n.shape[3],a=t==="NHWC"?n.shape[3]:n.shape[1];Te(e>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${e}`),Te(s*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${s} and ${e}  for depthToSpace with input shape
    ${n.shape}`),Te(o*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${o} and ${e} for depthToSpace with input shape
        ${n.shape}`),Te(a%(e*e)===0,()=>`Dimension size must be evenly divisible by ${e*e} but is ${a} for depthToSpace with input shape ${n.shape}`);const i={x:n},l={blockSize:e,dataFormat:t};return ze.runKernel(A3,i,l)}const HL=Ue({depthToSpace_:q0e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X0e(r,e,t,n,s="NHWC",o=[1,1],a){const i=fe(r,"x","depthwiseConv2d","float32"),l=fe(e,"filter","depthwiseConv2d","float32");let u=i,h=!1;i.rank===3&&(h=!0,u=bt(i,[1,i.shape[0],i.shape[1],i.shape[2]])),Te(u.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${u.rank}.`),Te(l.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${l.rank}.`),Te(u.shape[3]===l.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${u.shape[3]}) must match the inChannels dimension in filter ${l.shape[2]}.`),Qi("depthwiseConv2d",n,a);const d={x:u,filter:l},c={strides:t,pad:n,dataFormat:s,dilations:o,dimRoundingMode:a},f=ze.runKernel(R3,d,c);return h?bt(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const T1=Ue({depthwiseConv2d_:X0e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K0e(r){const t={x:fe(r,"x","diag")};return ze.runKernel(M3,t)}const Y0e=Ue({diag_:K0e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z0e(r,e,t,n,s=[1,1],o="NHWC"){const a=fe(r,"x","dilation2d"),i=fe(e,"filter","dilation2d");Te(a.rank===3||a.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${a.rank}.`),Te(i.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${i.rank}.`),Te(o==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${o}`);let l=a,u=!1;a.rank===3&&(l=bt(a,[1,a.shape[0],a.shape[1],a.shape[2]]),u=!0);const h={x:l,filter:i},d={strides:t,pad:n,dilations:s},c=ze.runKernel(F3,h,d);return u?bt(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const qL=Ue({dilation2d_:Z0e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q0e(r,e){let t=fe(r,"a","equal","string_or_numeric"),n=fe(e,"b","equal","string_or_numeric");[t,n]=Hr(t,n),ps(t.shape,n.shape);const s={a:t,b:n};return ze.runKernel(U3,s)}const rh=Ue({equal_:Q0e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J0e(r,e,t){const n=fe(e,"a","where"),s=fe(t,"b","where"),o=fe(r,"condition","where","bool"),a=ps(ps(o.shape,n.shape),s.shape),i=kf(o,a),l=kf(n,a),u=kf(s,a),h={condition:i,t:l,e:u};return ze.runKernel(QM,h)}const Hc=Ue({where_:J0e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e1e(r){const t={x:fe(r,"x","zerosLike")};return ze.runKernel(NF,t)}const jo=Ue({zerosLike_:e1e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t1e(r,e){let t=fe(r,"a","div"),n=fe(e,"b","div");[t,n]=Hr(t,n);const s=kr(t,n),o=jo(s),a=rh(n,o);return Hc(a,o,s)}const XL=Ue({divNoNan_:t1e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n1e(r,e){const t=fe(r,"t1","dot"),n=fe(e,"t2","dot");Te((t.rank===1||t.rank===2)&&(n.rank===1||n.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${t.rank} and ${n.rank}.`);const s=t.rank===1?t.size:t.shape[1],o=n.rank===1?n.size:n.shape[0];if(Te(s===o,()=>`Error in dot: inner dimensions of inputs must match, but got ${s} and ${o}.`),t.rank===1&&n.rank===1){const a=bt(t,[1,-1]),i=bt(n,[-1,1]),l=or(a,i);return bt(l,[])}else if(t.rank===1&&n.rank===2){const a=bt(t,[1,-1]),i=bt(n,[n.shape[0],n.shape[1]]),l=or(a,i);return bt(l,[l.size])}else if(t.rank===2&&n.rank===1){const a=bt(n,[-1,1]),i=or(t,a);return bt(i,[i.size])}else{const a=bt(n,[n.shape[0],n.shape[1]]);return or(t,a)}}const r1e=Ue({dot_:n1e});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s1e(r,...e){const t=e.map((s,o)=>fe(s,`tensors${o}`,"einsum")),n={equation:r};return ze.runKernel(P3,t,n)}const KL=Ue({einsum_:s1e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o1e(r){const t={x:fe(r,"x","elu","float32")};return ze.runKernel(j3,t)}const s_=Ue({elu_:o1e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i1e(r){let e=fe(r,"x","erf");Te(e.dtype==="int32"||e.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),e.dtype==="int32"&&(e=zn(e,"float32"));const t={x:e};return ze.runKernel(B3,t)}const YL=Ue({erf_:i1e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a1e(r){const t={x:fe(r,"x","exp")};return ze.runKernel(z3,t)}const _u=Ue({exp_:a1e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l1e(r,e=0){const t=fe(r,"x","expandDims","string_or_numeric");Te(e<=t.rank,()=>"Axis must be <= rank of the tensor");const n={input:t},s={dim:e};return ze.runKernel(V3,n,s)}const Rs=Ue({expandDims_:l1e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u1e(r){const t={x:fe(r,"x","expm1")};return ze.runKernel(G3,t)}const ZL=Ue({expm1_:u1e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c1e(r,e){const t=fe(r,"x","tile","string_or_numeric");Te(t.rank===e.length,()=>`Error in transpose: rank of input ${t.rank} must match length of reps ${e}.`);const n={x:t},s={reps:e};return ze.runKernel(LS,n,s)}const Hh=Ue({tile_:c1e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h1e(r,e,t,n="float32"){e==null&&(e=r);const s=$l([r,e],n),o=r<=e?r:e;for(let i=0;i<o;++i)s.set(1,i,i);const a=bt(s.toTensor(),[r,e]);if(t==null)return a;if(t.length===1)return Hh(Rs(a,0),[t[0],1,1]);if(t.length===2)return Hh(Rs(Rs(a,0),0),[t[0],t[1],1,1]);if(t.length===3)return Hh(Rs(Rs(Rs(a,0),0),0),[t[0],t[1],t[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${t.length}D.`)}const QL=Ue({eye_:h1e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Im(r,e,t){const n={shape:r,value:e,dtype:t};return ze.runKernel(H3,{},n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d1e(r){const t={x:fe(r,"x","floor","float32")};return ze.runKernel(X3,t)}const o_=Ue({floor_:d1e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f1e(r,e,t=0,n=0){const s=fe(r,"x","gather"),o=fe(e,"indices","gather","int32"),a={x:s,indices:o},i={axis:t,batchDims:n};return ze.runKernel(Z3,a,i)}const Dy=Ue({gather_:f1e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p1e(r,e){let t=fe(r,"a","greater","string_or_numeric"),n=fe(e,"b","greater","string_or_numeric");[t,n]=Hr(t,n),ps(t.shape,n.shape);const s={a:t,b:n};return ze.runKernel(J3,s)}const sh=Ue({greater_:p1e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m1e(r,e){let t=fe(r,"a","greaterEqual","string_or_numeric"),n=fe(e,"b","greaterEqual","string_or_numeric");[t,n]=Hr(t,n),ps(t.shape,n.shape);const s={a:t,b:n};return ze.runKernel(eM,s)}const i_=Ue({greaterEqual_:m1e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g1e(r){const t={input:fe(r,"input","imag")};return ze.runKernel(nM,t)}const k1=Ue({imag_:g1e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y1e(r){const t={x:fe(r,"x","isFinite")};return ze.runKernel(rM,t)}const v1e=Ue({isFinite_:y1e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b1e(r){const t={x:fe(r,"x","isInf")};return ze.runKernel(sM,t)}const x1e=Ue({isInf_:b1e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w1e(r){const t={x:fe(r,"x","isNaN")};return ze.runKernel(oM,t)}const JL=Ue({isNaN_:w1e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S1e(r,e=.2){const n={x:fe(r,"x","leakyRelu")},s={alpha:e};return ze.runKernel(iM,n,s)}const a_=Ue({leakyRelu_:S1e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _1e(r,e){let t=fe(r,"a","less","string_or_numeric"),n=fe(e,"b","less","string_or_numeric");[t,n]=Hr(t,n),ps(t.shape,n.shape);const s={a:t,b:n};return ze.runKernel(aM,s)}const eP=Ue({less_:_1e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T1e(r,e){let t=fe(r,"a","lessEqual","string_or_numeric"),n=fe(e,"b","lessEqual","string_or_numeric");[t,n]=Hr(t,n),ps(t.shape,n.shape);const s={a:t,b:n};return ze.runKernel(lM,s)}const I1=Ue({lessEqual_:T1e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tP(r,e,t){if(t<=0)throw new Error("The number of values should be positive.");const n={start:r,stop:e,num:t};return ze.runKernel(uM,{},n)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k1e(r,e=5,t=1,n=1,s=.5){const o=fe(r,"x","localResponseNormalization");Te(o.rank===4||o.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${o.rank}.`),Te(ud(e),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${e}.`);let a=o,i=!1;o.rank===3&&(i=!0,a=bt(o,[1,o.shape[0],o.shape[1],o.shape[2]]));const l={x:a},u={depthRadius:e,bias:t,alpha:n,beta:s},h=ze.runKernel(mM,l,u);return i?bt(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const nP=Ue({localResponseNormalization_:k1e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I1e(r){const t={x:fe(r,"x","log","float32")};return ze.runKernel(cM,t)}const md=Ue({log_:I1e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E1e(r){const t={x:fe(r,"x","log1p")};return ze.runKernel(hM,t)}const l_=Ue({log1p_:E1e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C1e(r){return Te(wu(r),()=>"The f passed in grad(f) must be a function"),(e,t)=>{const n=fe(e,"x","tf.grad","string_or_numeric"),s=t!=null?fe(t,"dy","tf.grad"):null;return ze.tidy(()=>{const{value:o,grads:a}=ze.gradients(()=>r(n),[n],s);return s!=null&&co(o.shape,s.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),E1(a),a[0]})}}function $1e(r){return Te(wu(r),()=>"The f passed in grads(f) must be a function"),(e,t)=>{Te(Array.isArray(e),()=>"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s");const n=Bf(e,"args","tf.grads","string_or_numeric"),s=t!=null?fe(t,"dy","tf.grads"):null;return ze.tidy(()=>{const{value:o,grads:a}=ze.gradients(()=>r(...n),n,s);return s!=null&&co(o.shape,s.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),E1(a),a})}}function N1e(r){return Te(wu(r),()=>"The f passed in valueAndGrad(f) must be a function"),(e,t)=>{Te(e instanceof pr,()=>"The x passed in valueAndGrad(f)(x) must be a tensor"),Te(t==null||t instanceof pr,()=>"The dy passed in valueAndGrad(f)(x, dy) must be a tensor");const{grads:n,value:s}=ze.gradients(()=>r(e),[e],t);return E1(n),{grad:n[0],value:s}}}function A1e(r){return Te(wu(r),()=>"The f passed in valueAndGrads(f) must be a function"),(e,t)=>{Te(Array.isArray(e)&&e.every(s=>s instanceof pr),()=>"The args passed in valueAndGrads(f)(args) must be array of tensors"),Te(t==null||t instanceof pr,()=>"The dy passed in valueAndGrads(f)(args, dy) must be a tensor");const n=ze.gradients(()=>r(...e),e,t);return t!=null&&co(n.value.shape,t.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),E1(n.grads),n}}function rP(r,e){Te(wu(r),()=>"The f passed in variableGrads(f) must be a function"),Te(e==null||Array.isArray(e)&&e.every(u=>u instanceof jf),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const t=e!=null;if(!t){e=[];for(const u in ze.registeredVariables)e.push(ze.registeredVariables[u])}const n=t?e.filter(u=>!u.trainable):null,s=e.length;e=e.filter(u=>u.trainable),Te(e.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${s} variables is trainable.`);const o=!0,{value:a,grads:i}=ze.gradients(r,e,null,o);Te(i.some(u=>u!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),Te(a.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${a.rank} tensor`);const l={};return e.forEach((u,h)=>{i[h]!=null&&(l[u.name]=i[h])}),n!=null&&n.forEach(u=>l[u.name]=null),{value:a,grads:l}}function tl(r){return ze.customGrad(r)}function E1(r){if(r.filter(t=>t==null).length>0)throw new Error(`Cannot compute gradient of y=f(x) with respect to x. Make sure that
    the f you passed encloses all operations that lead from x to y.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R1e(r){const t={x:fe(r,"x","neg")};return ze.runKernel(CM,t)}const Il=Ue({neg_:R1e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D1e(r){const t={x:fe(r,"x","softplus")};return ze.runKernel(oF,t)}const u_=Ue({softplus_:D1e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O1e(r){const e=fe(r,"x","logSigmoid");return tl(n=>({value:Il(u_(Il(n))),gradFunc:a=>Ut(a,zi(Il(n)))}))(e)}const M1e=Ue({logSigmoid_:O1e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F1e(r,e=null,t=!1){const s={x:fe(r,"x","max")},o={reductionIndices:e,keepDims:t};return ze.runKernel(gM,s,o)}const Cc=Ue({max_:F1e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L1e(r,e){let t=fe(r,"a","sub"),n=fe(e,"b","sub");[t,n]=Hr(t,n);const s={a:t,b:n};return ze.runKernel(wF,s)}const Rn=Ue({sub_:L1e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P1e(r,e=null,t=!1){let n=fe(r,"x","sum");n.dtype==="bool"&&(n=zn(n,"int32"));const s={x:n},o={axis:e,keepDims:t};return ze.runKernel(aF,s,o)}const Nr=Ue({sum_:P1e});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j1e(r,e=-1){const t=fe(r,"logits","logSoftmax");if(e===-1&&(e=t.rank-1),e!==t.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${t.rank} and axis was ${e}`);return tl((s,o)=>{const i=Cc(s,e,!0),l=Rn(s,i),u=Rn(zn(l,"float32"),md(Nr(_u(l),e,!0)));return o([u]),{value:u,gradFunc:(d,c)=>{const[f]=c,p=!0,m=_u(f);return Rn(d,Ut(Nr(d,e,p),m))}}})(t)}const sP=Ue({logSoftmax_:j1e});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c_(r,e){for(let t=0;t<r.length;++t)if(r[r.length-t-1]!==e-1-t)return!1;return!0}function oP(r,e,t){const n=r.length+e.length,s=[];let o=0,a=0;for(let i=0;i<n;i++)t.indexOf(i)===-1?s.push(r[o++]):s.push(e[a++]);return s}function B1e(r,e){const t=[],n=r.length;for(let o=0;o<n;o++)e.indexOf(o)===-1&&t.push(r[o]);const s=e.map(o=>r[o]);return[t,s]}function Em(r,e){const t=e.map(n=>1);return oP(r,t,e)}function U1e(r,e,t){Te(c_(e,t),()=>`${r} supports only inner-most axes for now. Got axes ${e} and rank-${t} input.`)}function z1e(r,e){if(c_(r,e))return null;const t=[];for(let n=0;n<e;++n)r.indexOf(n)===-1&&t.push(n);return r.forEach(n=>t.push(n)),t}function V1e(r){return r.map((e,t)=>[t,e]).sort((e,t)=>e[1]-t[1]).map(e=>e[0])}function G1e(r,e){const t=[];for(let n=e-r;n<e;++n)t.push(n);return t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W1e(r,e=null,t=!1){const n=fe(r,"x","logSumExp"),s=vm(e,n.shape),o=Cc(n,s,!0),a=Rn(n,o),i=_u(a),l=Nr(i,s),u=md(l),h=xn(bt(o,u.shape),u);if(t){const d=Em(h.shape,s);return bt(h,d)}return h}const iP=Ue({logSumExp_:W1e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H1e(r,e){const t=fe(r,"a","logicalAnd","bool"),n=fe(e,"b","logicalAnd","bool");ps(t.shape,n.shape);const s={a:t,b:n};return ze.runKernel(dM,s)}const Vf=Ue({logicalAnd_:H1e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q1e(r){const t={x:fe(r,"x","logicalNot","bool")};return ze.runKernel(fM,t)}const h_=Ue({logicalNot_:q1e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X1e(r,e){const t=fe(r,"a","logicalOr","bool"),n=fe(e,"b","logicalOr","bool");ps(t.shape,n.shape);const s={a:t,b:n};return ze.runKernel(pM,s)}const d_=Ue({logicalOr_:X1e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K1e(r,e){const t=fe(r,"a","logicalXor","bool"),n=fe(e,"b","logicalXor","bool");return ps(t.shape,n.shape),Vf(d_(r,e),h_(Vf(r,e)))}const Y1e=Ue({logicalXor_:K1e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z1e(r,e,t,n,s){const o=fe(r,"x","maxPool"),a=1;let i=o,l=!1;o.rank===3&&(l=!0,i=bt(o,[1,o.shape[0],o.shape[1],o.shape[2]])),Te(i.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${i.rank}.`),Te(Ml(t,a),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${t} and dilations '${a}'`),Qi("maxPool",n,s);const u={x:i},h={filterSize:e,strides:t,pad:n,dimRoundingMode:s},d=ze.runKernel(vM,u,h);return l?bt(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const f_=Ue({maxPool_:Z1e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q1e(r,e=[1,1,1],t,n,s,o="NDHWC"){const a=fe(r,"x","maxPool3d");let i=a,l=!1;a.rank===4&&(l=!0,i=bt(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),Te(i.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${i.rank}.`),Te(o==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${o}`),Qi("maxPool3d",n,s);const u={x:i},h={filterSize:e,strides:t,pad:n,dimRoundingMode:s,dataFormat:o},d=ze.runKernel(bM,u,h);return l?bt(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const aP=Ue({maxPool3d_:Q1e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J1e(r,e,t,n,s=!1){const a={x:fe(r,"x","maxPoolWithArgmax")},i={filterSize:e,strides:t,pad:n,includeBatchInIndex:s},l=ze.runKernel(xM,a,i);return{result:l[0],indexes:l[1]}}const lP=Ue({maxPoolWithArgmax_:J1e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eve(r,e){let t=fe(r,"a","maximum"),n=fe(e,"b","maximum");[t,n]=Hr(t,n),t.dtype==="bool"&&(t=zn(t,"int32"),n=zn(n,"int32")),ps(t.shape,n.shape);const s={a:t,b:n};return ze.runKernel(yM,s)}const p_=Ue({maximum_:eve});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tve(r,e=null,t=!1){const s={x:fe(r,"x","mean")},o={axis:e,keepDims:t};return ze.runKernel(wM,s,o)}const Gf=Ue({mean_:tve});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qc(r,e="float32"){if(e==="complex64"){const n=qc(r,"float32"),s=qc(r,"float32");return Su(n,s)}const t=b1(Ur(r),e);return ze.makeTensor(t,r,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lu(r,e="float32"){if(e==="complex64"){const n=lu(r,"float32"),s=qc(r,"float32");return Su(n,s)}const t=NS(Ur(r),e);return ze.makeTensor(t,r,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nve(r,e,{indexing:t="xy"}={}){if(t!=="xy"&&t!=="ij")throw new TypeError(`${t} is not a valid third argument to meshgrid`);if(r===void 0)return[];let n=fe(r,"x","meshgrid",r instanceof pr?r.dtype:"float32");if(e===void 0)return[n];let s=fe(e,"y","meshgrid",e instanceof pr?e.dtype:"float32");const o=Ur(n.shape),a=Ur(s.shape);return t==="xy"?(n=bt(n,[1,-1]),s=bt(s,[-1,1]),[or(lu([a,1],n.dtype),n),or(s,lu([1,o],s.dtype))]):(n=bt(n,[-1,1]),s=bt(s,[1,-1]),[or(n,lu([1,a],n.dtype)),or(lu([o,1],s.dtype),s)])}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rve(r,e=null,t=!1){const s={x:fe(r,"x","min")},o={axis:e,keepDims:t};return ze.runKernel(SM,s,o)}const Oy=Ue({min_:rve});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sve(r,e){let t=fe(r,"a","minimum"),n=fe(e,"b","minimum");[t,n]=Hr(t,n),t.dtype==="bool"&&(t=zn(t,"int32"),n=zn(n,"int32")),ps(t.shape,n.shape);const s={a:t,b:n};return ze.runKernel(_M,s)}const m_=Ue({minimum_:sve});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ove(r,e,t){Te(t==="reflect"||t==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${t}.`);const n=fe(r,"x","mirrorPad");if(n.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");Te(e.length===n.rank,()=>`Padding doesn't match input. Must be ${n.rank}. Got ${e.length}.`);const s=t==="reflect"?1:0;for(let i=0;i<n.rank;i++)Te(e[i].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Te(e[i][0]>=0&&e[i][0]<=n.shape[i]-s&&e[i][1]>=0&&e[i][1]<=n.shape[i]-s,()=>`Padding in dimension ${i} cannot be greater than or equal to ${n.shape[i]-s} or less than 0 for input of shape ${n.shape}`);const o={paddings:e,mode:t},a={x:n};return ze.runKernel(TM,a,o)}const g_=Ue({mirrorPad_:ove});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ive(r,e){let t=fe(r,"a","mod"),n=fe(e,"b","mod");[t,n]=Hr(t,n);const s={a:t,b:n};return ze.runKernel(kM,s)}const uP=Ue({mod_:ive});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ave(r){const e=fe(r,"x","square"),t={};return ze.runKernel("Square",{x:e},t)}const Vi=Ue({square_:ave});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lve(r,e=null,t=!1){r=fe(r,"x","moments");const n=vm(e,r.shape),s=Gf(r,n,t);let o=s.shape;t||(o=Em(s.shape,n));const a=Vi(Rn(zn(r,"float32"),bt(s,o))),i=Gf(a,n,t);return{mean:s,variance:i}}const uve=Ue({moments_:lve});function cve(r,e,t,n){const s=fe(e,"data","multiRNNCell"),o=Bf(t,"c","multiRNNCell"),a=Bf(n,"h","multiRNNCell");let i=s;const l=[];for(let d=0;d<r.length;d++){const c=r[d](i,o[d],a[d]);l.push(c[0]),l.push(c[1]),i=c[1]}const u=[],h=[];for(let d=0;d<l.length;d+=2)u.push(l[d]),h.push(l[d+1]);return[u,h]}const hve=Ue({multiRNNCell_:cve});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dve(r,e,t,n=!1){const s=fe(r,"logits","multinomial"),o=s.size,a=s.rank;if(o<2)throw new Error(`Error in multinomial: you need at least 2 outcomes, but got ${o}.`);if(a>2)throw new Error(`Rank of probabilities must be 1 or 2, but is ${a}`);t=t||Math.random();const l={logits:a===1?bt(s,[1,-1]):s},u={numSamples:e,seed:t,normalized:n},h=ze.runKernel(IM,l,u);return a===1?bt(h,[h.size]):h}const cP=Ue({multinomial_:dve});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fve(r,e){let t=fe(r,"a","notEqual","string_or_numeric"),n=fe(e,"b","notEqual","string_or_numeric");[t,n]=Hr(t,n),ps(t.shape,n.shape);const s={a:t,b:n};return ze.runKernel($M,s)}const y_=Ue({notEqual_:fve});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pve(r){const t={x:fe(r,"x","onesLike")};return ze.runKernel(DM,t)}const hP=Ue({onesLike_:pve});function mve(r,e){const t=fe(r,"v1","outerProduct"),n=fe(e,"v2","outerProduct");Te(t.rank===1&&n.rank===1,()=>`Error in outerProduct: inputs must be rank 1, but got ranks ${t.rank} and ${n.rank}.`);const s=bt(t,[-1,1]),o=bt(n,[1,-1]);return or(s,o)}const gve=Ue({outerProduct_:mve});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yve(r,e,t=0){const n=fe(r,"x","pad");if(n.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const s={paddings:e,constantValue:t},o={x:n};return ze.runKernel(FM,o,s)}const oh=Ue({pad_:yve});function vve(r,e,t=0){return Te(e.length===2,()=>"Invalid number of paddings. Must be length of 2."),oh(r,[e],t)}const bve=Ue({pad1d_:vve});function xve(r,e,t=0){return Te(e.length===2&&e[0].length===2&&e[1].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),oh(r,e,t)}const wve=Ue({pad2d_:xve});function Sve(r,e,t=0){return Te(e.length===3&&e[0].length===2&&e[1].length===2&&e[2].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),oh(r,e,t)}const v_=Ue({pad3d_:Sve});function _ve(r,e,t=0){return Te(e.length===4&&e[0].length===2&&e[1].length===2&&e[2].length===2&&e[3].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),oh(r,e,t)}const Tve=Ue({pad4d_:_ve});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kve(r,e,t){const n=fe(r,"x","spaceToBatchND");Te(n.rank>=1+e.length,()=>`input rank ${n.rank} should be > than [blockShape] ${e.length}`),Te(t.length===e.length,()=>`paddings.shape[0] ${t.length} must be equal to [blockShape] ${e.length}`),Te(n.shape.reduce((a,i,l)=>l>0&&l<=e.length?a&&(i+t[l-1][0]+t[l-1][1])%e[l-1]===0:a,!0),()=>`input spatial dimensions ${n.shape.slice(1)} with paddings ${t.toString()} must be divisible by blockShapes ${e.toString()}`);const s={x:n},o={blockShape:e,paddings:t};return ze.runKernel(lF,s,o)}const b_=Ue({spaceToBatchND_:kve});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ive(r,e,t,n,s,o,a){s==null&&(s=[1,1]),o==null&&(o=1),n===0&&(n="valid");const i=fe(r,"x","maxPool");let l=i,u=!1;i.rank===3&&(u=!0,l=bt(i,[1,i.shape[0],i.shape[1],i.shape[2]])),Te(Ml(o,s),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${o} and dilations '${s}'`);const h=AL(l.shape,e,o,s,n),d=[h.dilationHeight,h.dilationWidth];let c;n==="same"?c=Cve([h.filterHeight,h.filterWidth],d):c=[[0,0],[0,0]];const f=d[0]===1&&d[1]===1,[p,m]=Eve([h.inHeight,h.inWidth],d,c),g=f?n:"valid",y=f?l:b_(l,d,p),b=(t==="avg"?()=>t_(y,e,o,g,a):()=>f_(y,e,o,g,a))(),w=f?b:n_(b,d,m);return u?bt(w,[w.shape[1],w.shape[2],w.shape[3]]):w}function Eve(r,e,t){const n=t.map(h=>h[0]),s=t.map(h=>h[1]),o=r.concat(n,s),a=e.map((h,d)=>(h-o[d]%h)%h),i=s.map((h,d)=>h+a[d]),l=e.map((h,d)=>[n[d],i[d]]),u=e.map((h,d)=>[0,a[d]]);return[l,u]}function Cve(r,e){const n=r.map((a,i)=>a+(a-1)*(e[i]-1)).map(a=>a-1),s=n.map(a=>Math.floor(a/2)),o=n.map((a,i)=>a-s[i]);return n.map((a,i)=>[s[i],o[i]])}const $ve=Ue({pool_:Ive});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nve(r,e){let t=fe(r,"base","pow"),n=fe(e,"exp","pow");[t,n]=Hr(t,n);const s={a:t,b:n};return ze.runKernel(LM,s)}const gd=Ue({pow_:Nve});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ave(r,e){const t=fe(r,"x","prelu"),n=fe(e,"alpha","prelu"),s={x:t,alpha:n};return ze.runKernel(PM,s)}const x_=Ue({prelu_:Ave});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rve(r,e=null,t=!1){let n=fe(r,"x","prod");n.dtype==="bool"&&(n=zn(n,"int32"));const s={x:n},o={axis:e,keepDims:t};return ze.runKernel(jM,s,o)}const w_=Ue({prod_:Rve});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dve(r,e,t){const n=Ur(r);let s=null;if(t==null||t==="float32")s=new Float32Array(n);else if(t==="int32")s=new Int32Array(n);else if(t==="bool")s=new Uint8Array(n);else throw new Error(`Unknown data type ${t}`);for(let o=0;o<n;o++)s[o]=e();return ze.makeTensor(s,r,t)}const Ove=Ue({rand_:Dve});var dP={exports:{}};(function(r){(function(e,t,n){function s(l){var u=this,h=i();u.next=function(){var d=2091639*u.s0+u.c*23283064365386963e-26;return u.s0=u.s1,u.s1=u.s2,u.s2=d-(u.c=d|0)},u.c=1,u.s0=h(" "),u.s1=h(" "),u.s2=h(" "),u.s0-=h(l),u.s0<0&&(u.s0+=1),u.s1-=h(l),u.s1<0&&(u.s1+=1),u.s2-=h(l),u.s2<0&&(u.s2+=1),h=null}function o(l,u){return u.c=l.c,u.s0=l.s0,u.s1=l.s1,u.s2=l.s2,u}function a(l,u){var h=new s(l),d=u&&u.state,c=h.next;return c.int32=function(){return h.next()*4294967296|0},c.double=function(){return c()+(c()*2097152|0)*11102230246251565e-32},c.quick=c,d&&(typeof d=="object"&&o(d,h),c.state=function(){return o(h,{})}),c}function i(){var l=4022871197,u=function(h){h=h.toString();for(var d=0;d<h.length;d++){l+=h.charCodeAt(d);var c=.02519603282416938*l;l=c>>>0,c-=l,c*=l,l=c>>>0,c-=l,l+=c*4294967296}return(l>>>0)*23283064365386963e-26};return u}t&&t.exports?t.exports=a:n&&n.amd?n(function(){return a}):this.alea=a})(Pr,r,!1)})(dP);var fP={exports:{}};(function(r){(function(e,t,n){function s(i){var l=this,u="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var d=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^d^d>>>8},i===(i|0)?l.x=i:u+=i;for(var h=0;h<u.length+64;h++)l.x^=u.charCodeAt(h)|0,l.next()}function o(i,l){return l.x=i.x,l.y=i.y,l.z=i.z,l.w=i.w,l}function a(i,l){var u=new s(i),h=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var c=u.next()>>>11,f=(u.next()>>>0)/4294967296,p=(c+f)/(1<<21);while(p===0);return p},d.int32=u.next,d.quick=d,h&&(typeof h=="object"&&o(h,u),d.state=function(){return o(u,{})}),d}t&&t.exports?t.exports=a:n&&n.amd?n(function(){return a}):this.xor128=a})(Pr,r,!1)})(fP);var pP={exports:{}};(function(r){(function(e,t,n){function s(i){var l=this,u="";l.next=function(){var d=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^(d^d<<1))|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,i===(i|0)?l.x=i:u+=i;for(var h=0;h<u.length+64;h++)l.x^=u.charCodeAt(h)|0,h==u.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function o(i,l){return l.x=i.x,l.y=i.y,l.z=i.z,l.w=i.w,l.v=i.v,l.d=i.d,l}function a(i,l){var u=new s(i),h=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var c=u.next()>>>11,f=(u.next()>>>0)/4294967296,p=(c+f)/(1<<21);while(p===0);return p},d.int32=u.next,d.quick=d,h&&(typeof h=="object"&&o(h,u),d.state=function(){return o(u,{})}),d}t&&t.exports?t.exports=a:n&&n.amd?n(function(){return a}):this.xorwow=a})(Pr,r,!1)})(pP);var mP={exports:{}};(function(r){(function(e,t,n){function s(i){var l=this;l.next=function(){var h=l.x,d=l.i,c,f;return c=h[d],c^=c>>>7,f=c^c<<24,c=h[d+1&7],f^=c^c>>>10,c=h[d+3&7],f^=c^c>>>3,c=h[d+4&7],f^=c^c<<7,c=h[d+7&7],c=c^c<<13,f^=c^c<<9,h[d]=f,l.i=d+1&7,f};function u(h,d){var c,f=[];if(d===(d|0))f[0]=d;else for(d=""+d,c=0;c<d.length;++c)f[c&7]=f[c&7]<<15^d.charCodeAt(c)+f[c+1&7]<<13;for(;f.length<8;)f.push(0);for(c=0;c<8&&f[c]===0;++c);for(c==8&&(f[7]=-1),h.x=f,h.i=0,c=256;c>0;--c)h.next()}u(l,i)}function o(i,l){return l.x=i.x.slice(),l.i=i.i,l}function a(i,l){i==null&&(i=+new Date);var u=new s(i),h=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var c=u.next()>>>11,f=(u.next()>>>0)/4294967296,p=(c+f)/(1<<21);while(p===0);return p},d.int32=u.next,d.quick=d,h&&(h.x&&o(h,u),d.state=function(){return o(u,{})}),d}t&&t.exports?t.exports=a:n&&n.amd?n(function(){return a}):this.xorshift7=a})(Pr,r,!1)})(mP);var gP={exports:{}};(function(r){(function(e,t,n){function s(i){var l=this;l.next=function(){var h=l.w,d=l.X,c=l.i,f,p;return l.w=h=h+1640531527|0,p=d[c+34&127],f=d[c=c+1&127],p^=p<<13,f^=f<<17,p^=p>>>15,f^=f>>>12,p=d[c]=p^f,l.i=c,p+(h^h>>>16)|0};function u(h,d){var c,f,p,m,g,y=[],v=128;for(d===(d|0)?(f=d,d=null):(d=d+"\0",f=0,v=Math.max(v,d.length)),p=0,m=-32;m<v;++m)d&&(f^=d.charCodeAt((m+32)%d.length)),m===0&&(g=f),f^=f<<10,f^=f>>>15,f^=f<<4,f^=f>>>13,m>=0&&(g=g+1640531527|0,c=y[m&127]^=f+g,p=c==0?p+1:0);for(p>=128&&(y[(d&&d.length||0)&127]=-1),p=127,m=4*128;m>0;--m)f=y[p+34&127],c=y[p=p+1&127],f^=f<<13,c^=c<<17,f^=f>>>15,c^=c>>>12,y[p]=f^c;h.w=g,h.X=y,h.i=p}u(l,i)}function o(i,l){return l.i=i.i,l.w=i.w,l.X=i.X.slice(),l}function a(i,l){i==null&&(i=+new Date);var u=new s(i),h=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var c=u.next()>>>11,f=(u.next()>>>0)/4294967296,p=(c+f)/(1<<21);while(p===0);return p},d.int32=u.next,d.quick=d,h&&(h.X&&o(h,u),d.state=function(){return o(u,{})}),d}t&&t.exports?t.exports=a:n&&n.amd?n(function(){return a}):this.xor4096=a})(Pr,r,!1)})(gP);var yP={exports:{}};(function(r){(function(e,t,n){function s(i){var l=this,u="";l.next=function(){var d=l.b,c=l.c,f=l.d,p=l.a;return d=d<<25^d>>>7^c,c=c-f|0,f=f<<24^f>>>8^p,p=p-d|0,l.b=d=d<<20^d>>>12^c,l.c=c=c-f|0,l.d=f<<16^c>>>16^p,l.a=p-d|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,i===Math.floor(i)?(l.a=i/4294967296|0,l.b=i|0):u+=i;for(var h=0;h<u.length+20;h++)l.b^=u.charCodeAt(h)|0,l.next()}function o(i,l){return l.a=i.a,l.b=i.b,l.c=i.c,l.d=i.d,l}function a(i,l){var u=new s(i),h=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var c=u.next()>>>11,f=(u.next()>>>0)/4294967296,p=(c+f)/(1<<21);while(p===0);return p},d.int32=u.next,d.quick=d,h&&(typeof h=="object"&&o(h,u),d.state=function(){return o(u,{})}),d}t&&t.exports?t.exports=a:n&&n.amd?n(function(){return a}):this.tychei=a})(Pr,r,!1)})(yP);var vP={exports:{}};(function(r){(function(e,t){var n=this,s=256,o=6,a=52,i="random",l=t.pow(s,o),u=t.pow(2,a),h=u*2,d=s-1,c;function f(w,_,I){var C=[];_=_==!0?{entropy:!0}:_||{};var N=y(g(_.entropy?[w,b(e)]:w==null?v():w,3),C),O=new p(C),D=function(){for(var M=O.g(o),P=l,F=0;M<u;)M=(M+F)*s,P*=s,F=O.g(1);for(;M>=h;)M/=2,P/=2,F>>>=1;return(M+F)/P};return D.int32=function(){return O.g(4)|0},D.quick=function(){return O.g(4)/4294967296},D.double=D,y(b(O.S),e),(_.pass||I||function(M,P,F,B){return B&&(B.S&&m(B,O),M.state=function(){return m(O,{})}),F?(t[i]=M,P):M})(D,N,"global"in _?_.global:this==t,_.state)}t["seed"+i]=f;function p(w){var _,I=w.length,C=this,N=0,O=C.i=C.j=0,D=C.S=[];for(I||(w=[I++]);N<s;)D[N]=N++;for(N=0;N<s;N++)D[N]=D[O=d&O+w[N%I]+(_=D[N])],D[O]=_;(C.g=function(M){for(var P,F=0,B=C.i,z=C.j,Z=C.S;M--;)P=Z[B=d&B+1],F=F*s+Z[d&(Z[B]=Z[z=d&z+P])+(Z[z]=P)];return C.i=B,C.j=z,F})(s)}function m(w,_){return _.i=w.i,_.j=w.j,_.S=w.S.slice(),_}function g(w,_){var I=[],C=typeof w,N;if(_&&C=="object")for(N in w)try{I.push(g(w[N],_-1))}catch{}return I.length?I:C=="string"?w:w+"\0"}function y(w,_){for(var I=w+"",C,N=0;N<I.length;)_[d&N]=d&(C^=_[d&N]*19)+I.charCodeAt(N++);return b(_)}function v(){try{var w;return c&&(w=c.randomBytes)?w=w(s):(w=new Uint8Array(s),(n.crypto||n.msCrypto).getRandomValues(w)),b(w)}catch{var _=n.navigator,I=_&&_.plugins;return[+new Date,n,I,n.screen,b(e)]}}function b(w){return String.fromCharCode.apply(0,w)}if(y(t.random(),e),r.exports){r.exports=f;try{c=require("crypto")}catch{}}})([],Math)})(vP);var Mve=dP.exports,Fve=fP.exports,Lve=pP.exports,Pve=mP.exports,jve=gP.exports,Bve=yP.exports,ih=vP.exports;ih.alea=Mve;ih.xor128=Fve;ih.xorwow=Lve;ih.xorshift7=Pve;ih.xor4096=jve;ih.tychei=Bve;var S_=ih;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class __{constructor(e,t,n,s,o){this.mean=e,this.stdDev=t,this.dtype=n,this.nextVal=NaN,this.truncated=s,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const a=o||Math.random();this.random=S_.alea(a.toString())}nextValue(){if(!isNaN(this.nextVal)){const s=this.nextVal;return this.nextVal=NaN,s}let e,t,n=!1;for(;!n;){let s,o,a;do s=2*this.random()-1,o=2*this.random()-1,a=s*s+o*o;while(a>=1||a===0);const i=Math.sqrt(-2*Math.log(a)/a);e=this.mean+this.stdDev*s*i,t=this.mean+this.stdDev*o*i,(!this.truncated||this.isValidTruncated(e))&&(n=!0)}return(!this.truncated||this.isValidTruncated(t))&&(this.nextVal=this.convertValue(t)),this.convertValue(e)}convertValue(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}}class Uve{constructor(e,t,n,s){this.alpha=e,this.beta=1/t,this.dtype=n;const o=s||Math.random();this.randu=S_.alea(o.toString()),this.randn=new __(0,1,n,!1,this.randu()),e<1?this.d=e+2/3:this.d=e-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let e,t,n,s,o,a;for(;;){do s=this.randn.nextValue(),a=1+this.c*s;while(a<=0);if(a*=a*a,e=s*s,t=1-.331*e*e,n=.5*e+this.d*(1-a+Math.log(a)),o=this.randu(),o<t||Math.log(o)<n)break}return a=1/this.beta*this.d*a,this.alpha<1&&(a*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(a)}convertValue(e){return this.dtype==="float32"?e:Math.round(e)}}class zve{constructor(e=0,t=1,n,s){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=e,this.range=t-e,this.dtype=n,s==null&&(s=Math.random()),typeof s=="number"&&(s=s.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${e} - ${t} <= 1 and dtype is not float`);this.random=S_.alea(s)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vve(r,e,t=1,n="float32",s){if(t==null&&(t=1),n==null&&(n="float32"),n!=="float32"&&n!=="int32")throw new Error(`Unsupported data type ${n}`);const o=new Uve(e,t,n,s),a=$l(r,n);for(let i=0;i<a.values.length;i++)a.values[i]=o.nextValue();return a.toTensor()}const Gve=Ue({randomGamma_:Vve});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wve(r,e=0,t=1,n,s){if(n!=null&&n==="bool")throw new Error(`Unsupported data type ${n}`);const o=new __(e,t,n,!1,s),a=$l(r,n);for(let i=0;i<a.values.length;i++)a.values[i]=o.nextValue();return a.toTensor()}const Hve=Ue({randomNormal_:Wve});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qve(r,e=0,t=1,n="float32",s){const o=$l(r,n),a=new zve(e,t,null,s);for(let i=0;i<o.values.length;i++)o.values[i]=a.nextValue();return o.toTensor()}const T_=Ue({randomUniform_:qve});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nl(r,e,t=1,n="float32"){if(t===0)throw new Error("Cannot have a step of zero");const s={start:r,stop:e,step:t,dtype:n};return ze.runKernel(BM,{},s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xve(r){const t={input:fe(r,"input","real")};return ze.runKernel(UM,t)}const Wf=Ue({real_:Xve});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kve(r){const t={x:fe(r,"x","reciprocal")};return ze.runKernel(zM,t)}const bP=Ue({reciprocal_:Kve});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yve(r){const t={x:fe(r,"x","relu")};return ze.runKernel(VM,t)}const Cm=Ue({relu_:Yve});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zve(r){const t={x:fe(r,"x","relu6")};return ze.runKernel(qM,t)}const k_=Ue({relu6_:Zve});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qve(r,e){const n={x:fe(r,"x","reverse")},s={dims:e};return ze.runKernel(XM,n,s)}const Nl=Ue({reverse_:Qve});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jve(r){const e=fe(r,"x","reverse");return Te(e.rank===1,()=>`Error in reverse1D: x must be rank 1 but got rank ${e.rank}.`),Nl(e,0)}const ebe=Ue({reverse1d_:Jve});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tbe(r,e){const t=fe(r,"x","reverse");return Te(t.rank===2,()=>`Error in reverse2D: x must be rank 2 but got rank ${t.rank}.`),Nl(t,e)}const nbe=Ue({reverse2d_:tbe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rbe(r,e){const t=fe(r,"x","reverse");return Te(t.rank===3,()=>`Error in reverse3D: x must be rank 3 but got rank ${t.rank}.`),Nl(t,e)}const sbe=Ue({reverse3d_:rbe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function obe(r,e){const t=fe(r,"x","reverse");return Te(t.rank===4,()=>`Error in reverse4D: x must be rank 4 but got rank ${t.rank}.`),Nl(t,e)}const ibe=Ue({reverse4d_:obe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function abe(r){const t={x:fe(r,"x","round")};return ze.runKernel(KM,t)}const I_=Ue({round_:abe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lbe(r){const t={x:fe(r,"x","rsqrt","float32")};return ze.runKernel(YM,t)}const xP=Ue({rsqrt_:lbe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nn(r,e){if((Gs(r)&&e!=="string"||Array.isArray(r))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&Gs(r)&&!(r instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Mu(r,[],[],e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ube(r){const t={x:fe(r,"x","selu")};return ze.runKernel(JM,t)}const wP=Ue({selu_:ube});function cbe(r,e,t,n,s,o=[1,1],a="NHWC"){const i=fe(r,"x","separableConv2d"),l=fe(e,"depthwiseFilter","separableConv2d"),u=fe(t,"pointwiseFilter","separableConv2d");let h=i,d=!1;if(i.rank===3&&(d=!0,h=bt(i,[1,i.shape[0],i.shape[1],i.shape[2]])),a==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");Te(h.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${h.rank}.`),Te(l.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${l.rank}.`),Te(u.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${l.rank}.`),Te(u.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${u.shape[0]}.`),Te(u.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${u.shape[1]}.`);const c=l.shape[2],f=l.shape[3];Te(u.shape[2]===c*f,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${c*f}, but got ${u.shape[2]}.`);const p=T1(h,l,n,s,a,o),g=km(p,u,1,"valid",a);return d?bt(g,[g.shape[1],g.shape[2],g.shape[3]]):g}const hbe=Ue({separableConv2d_:cbe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function dbe(r,e){const t=fe(r,"x","setdiff1d"),n=fe(e,"y","setdiff1d");Te(t.dtype===n.dtype,()=>`x and y should have the same dtype, but got x (${t.dtype}) and y (${n.dtype}).`),Te(t.rank===1,()=>`x should be 1D tensor, but got x (${t.shape}).`),Te(n.rank===1,()=>`y should be 1D tensor, but got y (${n.shape}).`);const s=await t.data(),o=await n.data(),a=new Set(o);let i=0;for(let h=0;h<s.length;h++)a.has(s[h])||i++;const l=new $y([i],t.dtype),u=new $y([i],"int32");for(let h=0,d=0;h<s.length;h++)a.has(s[h])||(l.values[d]=s[h],u.values[d]=h,d++);return[l.toTensor(),u.toTensor()]}const SP=dbe;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fbe(r){const t={x:fe(r,"x","sign")};return ze.runKernel(rF,t)}const _P=Ue({sign_:fbe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pbe(r){const t={x:fe(r,"x","sin","float32")};return ze.runKernel(tF,t)}const TP=Ue({sin_:pbe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mbe(r){const t={x:fe(r,"x","sinh")};return ze.runKernel(nF,t)}const kP=Ue({sinh_:mbe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gbe(r,e,t){const n=fe(r,"x","slice1d");return Te(n.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${n.rank} tensor`),Tr(n,[e],[t])}const ybe=Ue({slice1d_:gbe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vbe(r,e,t){const n=fe(r,"x","slice2d");return Te(n.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${n.rank} tensor`),Tr(n,e,t)}const bbe=Ue({slice2d_:vbe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xbe(r,e,t){const n=fe(r,"x","slice3d");return Te(n.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${n.rank} tensor`),Tr(n,e,t)}const wbe=Ue({slice3d_:xbe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sbe(r,e,t){const n=fe(r,"x","slice4d");return Te(n.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${n.rank} tensor`),Tr(n,e,t)}const _be=Ue({slice4d_:Sbe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tbe(r,e=-1){const t=fe(r,"logits","softmax","float32");if(e===-1&&(e=t.rank-1),e!==t.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${t.rank} and dim was ${e}`);const n={logits:t},s={dim:e};return ze.runKernel(cF,n,s)}const IP=Ue({softmax_:Tbe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kbe(r){Te(r.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${r.dtype}.`);const e={input:r};return ze.runKernel(W3,e)}const C1=Ue({fft_:kbe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ibe(r){Te(r.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${r.dtype}.`);const e={input:r};return ze.runKernel(tM,e)}const Hf=Ue({ifft_:Ibe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ebe(r){const e=r.shape[r.shape.length-1],t=r.size/e;let n;if(e<=2){const s=bt(r,[t,e]);n=Hf(s)}else{const s=[t,2*(e-1)],o=bt(Wf(r),[t,e]),a=bt(k1(r),[t,e]),i=Nl(Tr(o,[0,1],[t,e-2]),1),l=Ut(Nl(Tr(a,[0,1],[t,e-2]),1),Nn(-1)),u=qs([o,i],1),h=qs([a,l],1),d=bt(Su(u,h),[s[0],s[1]]);n=Hf(d)}if(n=Wf(n),r.rank===3&&r.shape[0]!==0){const s=n,o=r.shape[0];n=bt(n,[o,n.shape[0]/o,n.shape[1]]),s.dispose()}return n}const E_=Ue({irfft_:Ebe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cbe(r,e,t=0){const s={x:fe(r,"x","split")},o={numOrSizeSplits:e,axis:t};return ze.runKernel(uF,s,o)}const yd=Ue({split_:Cbe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $be(r,e){Te(r.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${r.dtype}`);let t=r.shape[r.shape.length-1];const n=r.size/t;let s;if(e!=null&&e<t){const p=r.shape.map(g=>0),m=r.shape.map(g=>g);m[r.shape.length-1]=e,s=Tr(r,p,m),t=e}else if(e!=null&&e>t){const p=r.shape.map(m=>m);p[r.shape.length-1]=e-t,s=qs([r,qc(p)],r.shape.length-1),t=e}else s=r;const o=jo(s),a=bt(Su(s,o),[n,t]),i=C1(a),l=Math.floor(t/2)+1,u=Wf(i),h=k1(i),d=yd(u,[l,t-l],u.shape.length-1),c=yd(h,[l,t-l],h.shape.length-1),f=s.shape.slice();return f[s.shape.length-1]=l,bt(Su(d[0],c[0]),f)}const $1=Ue({rfft_:$be});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nbe(r){const t={x:fe(r,"x","sqrt","float32")};return ze.runKernel(iF,t)}const rl=Ue({sqrt_:Nbe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Abe(r,e){let t=fe(r,"a","squaredDifference"),n=fe(e,"b","squaredDifference");[t,n]=Hr(t,n),ps(t.shape,n.shape);const s={a:t,b:n},o={};return ze.runKernel(gF,s,o)}const C_=Ue({squaredDifference_:Abe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rbe(r,e){const t=fe(r,"x","squeeze");return bt(t,BO(t.shape,e).newShape)}const cs=Ue({squeeze_:Rbe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dbe(r,e=0){const t=Bf(r,"tensors","stack","string_or_numeric");Te(t.length>=1,()=>"Pass at least one tensor to tf.stack"),t.length>0&&Te(e<=t[0].rank,()=>"Axis must be <= rank of the tensor");const n=t,s={axis:e};return ze.runKernel(MM,n,s)}const sl=Ue({stack_:Dbe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Obe(r,e=0){const n={x:fe(r,"x","step")},s={alpha:e};return ze.runKernel(AF,n,s)}const EP=Ue({step_:Obe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mbe(r,e,t,n,s=0,o=0,a=0,i=0,l=0){const h={x:fe(r,"x","stridedSlice","string_or_numeric")},d={begin:e,end:t,strides:n,beginMask:s,endMask:o,ellipsisMask:a,newAxisMask:i,shrinkAxisMask:l};return ze.runKernel(yF,h,d)}const CP=Ue({stridedSlice_:Mbe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fbe(r){const t={x:fe(r,"x","tan","float32")};return ze.runKernel(SF,t)}const $P=Ue({tan_:Fbe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function di(r,e){nh(r);const t=el(r,e);if(t.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Mu(r,null,t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qh(r,e,t){if(nh(r),e!=null&&e.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const n=el(r,t);if(n.length!==2&&n.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(n.length===1&&e==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Mu(r,e,n,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lbe(r,e,t){if(nh(r),e!=null&&e.length!==4)throw new Error("tensor4d() requires shape to have four numbers");const n=el(r,t);if(n.length!==4&&n.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(n.length===1&&e==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return Mu(r,e,n,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pbe(r,e,t){if(nh(r),e!=null&&e.length!==5)throw new Error("tensor5d() requires shape to have five numbers");const n=el(r,t);if(n.length!==5&&n.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(n.length===1&&e==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return Mu(r,e,n,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jbe(r,e,t){if(nh(r),e!=null&&e.length!==6)throw new Error("tensor6d() requires shape to have six numbers");const n=el(r,t);if(n.length!==6&&n.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(n.length===1&&e==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return e=e||n,Mu(r,e,n,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bbe(r,e=1,t=!0){const n=fe(r,"x","topk");if(n.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const s=n.shape[n.shape.length-1];if(e<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${e}`);if(e>s)throw new Error(`'k' passed to topk() must be <= the last dimension (${s}) but got ${e}`);const o={x:n},a={k:e,sorted:t},[i,l]=ze.runKernel(TF,o,a);return{values:i,indices:l}}const NP=Ue({topk_:Bbe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ube(r,e=0,t=1,n,s){if(n!=null&&n==="bool")throw new Error("Unsupported data type $ { dtype }");const o=new __(e,t,n,!0,s),a=$l(r,n);for(let i=0;i<a.values.length;i++)a.values[i]=o.nextValue();return a.toTensor()}const AP=Ue({truncatedNormal_:Ube});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zbe(r,e=0){const t=fe(r,"x","unique","string_or_numeric");Te(t.rank>0,()=>"The input tensor must be at least 1D");const n={x:t},s={axis:e},[o,a]=ze.runKernel(EF,n,s);return{values:o,indices:a}}const Tx=Ue({unique_:zbe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vbe(r,e,t){const n=fe(r,"x","unsortedSegmentSum"),s=fe(e,"segmentIds","unsortedSegmentSum","int32");Te(ud(t),()=>"numSegments must be of dtype int");const o={x:n,segmentIds:s},a={numSegments:t};return ze.runKernel($F,o,a)}const Gbe=Ue({unsortedSegmentSum_:Vbe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wbe(r,e=0){const t=fe(r,"x","unstack","string_or_numeric");Te(e>=-t.shape.length&&e<t.shape.length,()=>`Axis = ${e} is not in [-${t.shape.length}, ${t.shape.length})`);const n={value:t},s={axis:e};return ze.runKernel(CF,n,s)}const Lu=Ue({unstack_:Wbe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hbe(r,e=!0,t,n){return ze.makeVariable(r,e,t,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RP(r,e){const t=[];for(let o=0;o<e.length;o++)e[o]&&t.push(o);const n=$l(r,"int32"),s=$l([t.length,r.length],"int32");for(let o=0;o<t.length;o++){const a=n.indexToLoc(t[o]),i=o*r.length;s.values.set(a,i)}return s.toTensor()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function qbe(r){const e=fe(r,"condition","whereAsync","bool"),t=await e.data(),n=RP(e.shape,t);return r!==e&&e.dispose(),n}const $_=qbe;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Xbe(r,e,t){const n=fe(r,"tensor","boolMask"),s=fe(e,"mask","boolMask","bool"),o=t==null?0:t,a=s.rank,i=n.shape;Te(a>0,()=>"mask cannot be scalar"),co(i.slice(o,o+a),s.shape,"mask's shape must match the first K dimensions of tensor's shape,");let l=1;for(let m=o;m<o+a;m++)l*=i[m];const u=i.slice(0,o).concat([l],i.slice(o+a)),h=bt(n,u),d=bt(s,[-1]),c=await $_(d),f=cs(c,[1]),p=Dy(h,f,o);return r!==n&&n.dispose(),e!==s&&s.dispose(),f.dispose(),h.dispose(),d.dispose(),c.dispose(),p}const Kbe=Xbe;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ybe(r,e="euclidean",t=null,n=!1){r=fe(r,"x","norm");const s=DP(r,e,t);let o=s.shape;if(n){const a=vm(t,r.shape);o=Em(s.shape,a)}return bt(s,o)}function DP(r,e,t=null){if(r.rank===0)return Oo(r);if(r.rank!==1&&t===null)return DP(bt(r,[-1]),e,t);if(r.rank===1||typeof t=="number"||Array.isArray(t)&&t.length===1){if(e===1)return Nr(Oo(r),t);if(e===1/0)return Cc(Oo(r),t);if(e===-1/0)return Oy(Oo(r),t);if(e==="euclidean"||e===2)return rl(Nr(gd(Oo(r),Nn(2,"int32")),t));throw new Error(`Error in norm: invalid ord value: ${e}`)}if(Array.isArray(t)&&t.length===2){if(e===1)return Cc(Nr(Oo(r),t[0]),t[1]-1);if(e===1/0)return Cc(Nr(Oo(r),t[1]),t[0]);if(e===-1/0)return Oy(Nr(Oo(r),t[1]),t[0]);if(e==="fro"||e==="euclidean")return rl(Nr(Vi(r),t));throw new Error(`Error in norm: invalid ord value: ${e}`)}throw new Error(`Error in norm: invalid axis: ${t}`)}const N_=Ue({norm_:Ybe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zbe(r,e,t,n,s=!0){const o=fe(r,"v","movingAverage"),a=fe(e,"x","movingAverage"),i=fe(t,"decay","movingAverage");LF(o,a),Te(Ja(o.shape,a.shape),()=>"Shape mismatch in v and x");const l=Nn(1),u=Rn(l,i);let h=Ut(Rn(a,o),u);if(s){Te(n!=null,()=>"When using zeroDebias: true, step is required.");const d=fe(n,"step","movingAverage");h=kr(h,Rn(l,gd(i,d)))}return xn(o,h)}const Qbe=Ue({movingAverage_:Zbe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jbe(r,e,t){const n=fe(r,"indices","scatterND","int32"),s=fe(e,"updates","scatterND");XS(s,n,t);const o={indices:n,updates:s},a={shape:t};return ze.runKernel(ZM,o,a)}const OP=Ue({scatterND_:Jbe});function exe(r,e,t,n){if(r.dtype!=="int32")throw new Error(`tf.sparseToDense() expects the indices to be int32 type, but the dtype was ${r.dtype}.`);if(r.rank>2)throw new Error(`sparseIndices should be a scalar, vector, or matrix, but got shape ${r.shape}.`);const s=r.rank>0?r.shape[0]:1,o=r.rank>1?r.shape[1]:1;if(t.length!==o)throw new Error(`outputShape has incorrect number of elements:, ${t.length}, should be: ${o}.`);const a=e.size;if(!(e.rank===0||e.rank===1&&a===s))throw new Error(`sparseValues has incorrect shape ${e.shape}, should be [] or [${s}]`);if(e.dtype!==n.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function txe(r,e,t,n=0){const s=fe(r,"sparseIndices","sparseToDense","int32"),o=fe(e,"sparseValues","sparseToDense"),a=fe(n,"defaultValue","sparseToDense",o.dtype);exe(s,o,t,a);const i={sparseIndices:s,sparseValues:o,defaultValue:a},l={outputShape:t};return ze.runKernel(mF,i,l)}const A_=Ue({sparseToDense_:txe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nxe(r,e){const t=fe(e,"indices","gatherND","int32"),s={params:fe(r,"x","gatherND","string_or_numeric"),indices:t};return ze.runKernel(Q3,s)}const MP=Ue({gatherND_:nxe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rxe(r,e){if(e==null)return r.shape.slice();if(Ja(r.shape,e))return e;if(r.shape.length===e.length){const t=[];for(let n=0;n<r.shape.length;n++)e[n]==null&&r.shape[n]!=null?t.push(r.shape[n]):t.push(e[n]);return t}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sxe(r,e,t,n){const s=fe(r,"x","dropout");if(Te(s.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${s.dtype} tensor instead.`),Te(e>=0&&e<1,()=>`rate must be a float in the range [0, 1), but got ${e}.`),e===0)return r instanceof pr?s.clone():s;const o=rxe(s,t),a=1-e,i=kr(o_(xn(T_(o,0,1,"float32",n),a)),a);return Ut(s,i)}const oxe=Ue({dropout_:sxe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FP(r){return Math.floor(Math.pow(2,Math.ceil(Math.log(r)/Math.log(2))))}function R_(r,e,t){const n=1-r%2,s=new Float32Array(r);for(let o=0;o<r;++o){const a=2*Math.PI*o/(r+n-1);s[o]=e-t*Math.cos(a)}return di(s,"float32")}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function ixe(r,e,t=1){const n=fe(r,"predictions","inTopK"),s=fe(e,"targets","inTopK");Te(n.rank>1,()=>`inTopK() expects the predictions to be of rank 2 or higher, but got ${n.rank}`),Te(n.rank-1===s.rank,()=>`predictions rank should be 1 larger than targets rank, but got predictions rank ${n.rank} and targets rank ${s.rank}`),co(n.shape.slice(0,n.shape.length-1),s.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");const o=n.shape[n.shape.length-1];Te(t>0&&t<=o,()=>`'k' passed to inTopK() must be > 0 && <= the predictions last dimension (${o}), but got ${t}`);const a=await n.data(),i=await s.data(),[l,u]=[a.length/o,o],h=UO("bool",l);for(let d=0;d<l;d++){const c=d*u,f=a.subarray(c,c+u),p=[];for(let m=0;m<f.length;m++)p.push({value:f[m],index:m});p.sort((m,g)=>g.value-m.value),h[d]=0;for(let m=0;m<t;m++)if(p[m].index===i[d]){h[d]=1;break}}return r!==n&&n.dispose(),e!==s&&s.dispose(),Ui(h,s.shape,"bool")}const axe=ixe;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lxe(r,e,t,n,s,o="NHWC",a){let i=r;r.rank===3&&(i=bt(r,[1,r.shape[0],r.shape[1],r.shape[2]]));let l=e;l.rank===3&&(l=bt(e,[1,e.shape[0],e.shape[1],e.shape[2]])),Te(i.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${i.shape}.`),Te(l.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${l.shape}.`),Te(t.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${t}.`);const u=o==="NHWC"?i.shape[3]:i.shape[1],h=o==="NHWC"?l.shape[3]:l.shape[1];Te(u===t[2],()=>`Error in conv2dDerFilter: depth of input ${u}) must match input depth in filter (${t[2]}.`),Te(h===t[3],()=>`Error in conv2dDerFilter: depth of dy (${h}) must match output depth for filter (${t[3]}).`),Qi("conv2dDerFilter",s,a);const d={x:i,dy:l},c={strides:n,pad:s,dataFormat:o,dimRoundingMode:a,filterShape:t};return ze.runKernel(S3,d,c)}const uxe=Ue({conv2DBackpropFilter_:lxe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N1(r,e,t){if(t==null||t==="linear")return r;if(t==="relu")return Ut(r,EP(e));throw new Error(`Cannot compute gradient for fused activation ${t}.`)}function A1(r,e){let t=e;const n=HS(r.shape,e.shape);return n.length>0&&(t=Nr(t,n)),bt(t,r.shape)}function R1(r,e,t,n){if(e==="linear")return r;if(e==="relu")return Cm(r);if(e==="elu")return s_(r);if(e==="relu6")return k_(r);if(e==="prelu")return x_(r,t);if(e==="leakyrelu")return a_(r,n);if(e==="sigmoid")return zi(r);throw new Error(`Unknown fused activation ${e}.`)}const D1=(r,e)=>!(r>0)||e==="linear";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cxe({x:r,filter:e,strides:t,pad:n,dataFormat:s="NHWC",dilations:o=[1,1],dimRoundingMode:a,bias:i,activation:l="linear",preluActivationWeights:u,leakyreluAlpha:h}){if(l=l||"linear",D1(ze.state.gradientDepth,l)===!1){let _=km(r,e,t,n,s,o,a);return i!=null&&(_=xn(_,i)),R1(_,l,u,h)}const d=fe(r,"x","conv2d","float32"),c=fe(e,"filter","conv2d","float32");let f=d,p=!1;d.rank===3&&(p=!0,f=bt(d,[1,d.shape[0],d.shape[1],d.shape[2]])),Te(f.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${f.rank}.`),Te(c.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${c.rank}.`),Qi("fused conv2d",n,a),Te(f.shape[3]===c.shape[2],()=>`Error in conv2d: depth of input (${f.shape[3]}) must match input depth for filter ${c.shape[2]}.`),Te(Ml(t,o),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${t} and dilations '${o}'`),Te(s==="NHWC",()=>`Error in conv2d: got dataFormat of ${s} but only NHWC is currently supported.`);const m=Tm(f.shape,c.shape,t,o,n,a);let g;i!=null&&(g=fe(i,"bias","fused conv2d"),[g]=Hr(g,d),ps(m.outShape,g.shape));let y;u!=null&&(y=fe(u,"prelu weights","fused conv2d"));const v=(_,I)=>{const[C,N,O,D]=I,M=N1(_,O,l);Te(zf(o),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${o}'`);const P=jL(N.shape,M,C,t,n),F=uxe(N,M,C.shape,t,n),B=[P,F];if(D!=null){const z=A1(D,M);B.push(z)}return B},b={x:f,filter:c,bias:g,preluActivationWeights:y},w={strides:t,pad:n,dataFormat:s,dilations:o,dimRoundingMode:a,activation:l,leakyreluAlpha:h};return i==null?tl((I,C,N)=>{let O=ze.runKernel(ox,b,w);return N([C,I,O]),p&&(O=bt(O,[O.shape[1],O.shape[2],O.shape[3]])),{value:O,gradFunc:v}})(f,c):tl((I,C,N,O)=>{let D=ze.runKernel(ox,b,w);return O([C,I,D,N]),p&&(D=bt(D,[D.shape[1],D.shape[2],D.shape[3]])),{value:D,gradFunc:v}})(f,c,g)}const LP=Ue({fusedConv2d_:cxe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hxe(r,e,t,n,s,o=[1,1],a){let i=r;r.rank===3&&(i=bt(r,[1,r.shape[0],r.shape[1],r.shape[2]]));let l=e;l.rank===3&&(l=bt(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const u={x:i,dy:l},h={strides:n,pad:s,dimRoundingMode:a,dilations:o,filterShape:t};return ze.runKernel(D3,u,h)}const dxe=Ue({depthwiseConv2dNativeBackpropFilter_:hxe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fxe(r,e,t,n,s,o=[1,1],a){let i=e,l=!1;e.rank===3&&(l=!0,i=bt(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const u={dy:i,filter:t},h={strides:n,pad:s,dimRoundingMode:a,dilations:o,inputShape:r},d=ze.runKernel(O3,u,h);return l?bt(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const pxe=Ue({depthwiseConv2dNativeBackpropInput_:fxe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mxe({x:r,filter:e,strides:t,pad:n,dataFormat:s="NHWC",dilations:o=[1,1],dimRoundingMode:a,bias:i,activation:l="linear",preluActivationWeights:u,leakyreluAlpha:h}){if(D1(ze.state.gradientDepth,l)===!1){let _=T1(r,e,t,n,s,o,a);return i!=null&&(_=xn(_,i)),R1(_,l,u,h)}const d=fe(r,"x","depthwiseConv2d","float32"),c=fe(e,"filter","depthwiseConv2d","float32");let f=d,p=!1;d.rank===3&&(p=!0,f=bt(d,[1,d.shape[0],d.shape[1],d.shape[2]])),Te(f.rank===4,()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${f.rank}.`),Te(c.rank===4,()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${c.rank}.`),Te(f.shape[3]===c.shape[2],()=>`Error in fused depthwiseConv2d: number of input channels (${f.shape[3]}) must match the inChannels dimension in filter ${c.shape[2]}.`),o==null&&(o=[1,1]),Te(Ml(t,o),()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${t} and dilations '${o}'`),Qi("fused depthwiseConv2d",n,a);const m=Tm(f.shape,c.shape,t,o,n,a,!0);let g;i!=null&&(g=fe(i,"bias","fused conv2d"),[g]=Hr(g,d),ps(m.outShape,g.shape));let y;u!=null&&(y=fe(u,"prelu weights","fused depthwiseConv2d"));const v=(_,I)=>{Te(zf(o),()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${o}'`);const[C,N,O,D]=I,M=N1(_,O,l),P=pxe(N.shape,M,C,t,n,o,a),F=dxe(N,M,C.shape,t,n,o,a);if(D!=null){const B=A1(g,M);return[P,F,B]}return[P,F]},b={x:f,filter:c,bias:g,preluActivationWeights:y},w={strides:t,pad:n,dataFormat:s,dilations:o,dimRoundingMode:a,activation:l,leakyreluAlpha:h};return i==null?tl((I,C,N)=>{let O=ze.runKernel(ix,b,w);return N([C,I,O]),p&&(O=bt(O,[O.shape[1],O.shape[2],O.shape[3]])),{value:O,gradFunc:v}})(f,c):tl((I,C,N,O)=>{let D=ze.runKernel(ix,b,w);return O([C,I,D,N]),p&&(D=bt(D,[D.shape[1],D.shape[2],D.shape[3]])),{value:D,gradFunc:v}})(f,c,g)}const PP=Ue({fusedDepthwiseConv2d_:mxe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gxe({a:r,b:e,transposeA:t=!1,transposeB:n=!1,bias:s,activation:o="linear",preluActivationWeights:a,leakyreluAlpha:i}){if(D1(ze.state.gradientDepth,o)===!1){let M=or(r,e,t,n);return s!=null&&(M=xn(M,s)),R1(M,o,a,i)}let l=fe(r,"a","fused matMul"),u=fe(e,"b","fused matMul");[l,u]=Hr(l,u);const h=t?l.shape[l.rank-2]:l.shape[l.rank-1],d=n?u.shape[u.rank-1]:u.shape[u.rank-2],c=t?l.shape[l.rank-1]:l.shape[l.rank-2],f=n?u.shape[u.rank-2]:u.shape[u.rank-1],p=l.shape.slice(0,-2),m=u.shape.slice(0,-2),g=Ur(p),y=Ur(m);Te(h===d,()=>`Error in fused matMul: inner shapes (${h}) and (${d}) of Tensors with shapes ${l.shape} and ${u.shape} and transposeA=${t} and transposeB=${n} must match.`);const b=ps(l.shape.slice(0,-2),u.shape.slice(0,-2)).concat([c,f]),w=t?bt(l,[g,h,c]):bt(l,[g,c,h]),_=n?bt(u,[y,f,d]):bt(u,[y,d,f]);let I;s!=null&&(I=fe(s,"bias","fused matMul"),[I]=Hr(I,l),ps(b,I.shape));let C;a!=null&&(C=fe(a,"prelu weights","fused matMul"));const N=(M,P)=>{const[F,B,z,Z]=P,Q=N1(bt(M,z.shape),z,o);let K,ne;if(!t&&!n?(K=or(Q,B,!1,!0),ne=or(F,Q,!0,!1)):!t&&n?(K=or(Q,B,!1,!1),ne=or(Q,F,!0,!1)):t&&!n?(K=or(B,Q,!1,!0),ne=or(F,Q,!1,!1)):(K=or(B,Q,!0,!0),ne=or(Q,F,!0,!0)),s!=null){const re=A1(Z,Q);return[K,ne,re]}else return[K,ne]},O={a:w,b:_,bias:I,preluActivationWeights:C},D={transposeA:t,transposeB:n,activation:o,leakyreluAlpha:i};return s==null?tl((P,F,B)=>{const z=ze.runKernel(sx,O,D);return B([P,F,z]),{value:bt(z,b),gradFunc:N}})(w,_):tl((P,F,B,z)=>{const Z=ze.runKernel(sx,O,D);return z([P,F,Z,B]),{value:bt(Z,b),gradFunc:N}})(w,_,I)}const jP=Ue({fusedMatMul_:gxe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var yxe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",conv2d:LP,depthwiseConv2d:PP,matMul:jP});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vxe(r){return R_(r,.54,.46)}const bxe=Ue({hammingWindow_:vxe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xxe(r){return R_(r,.5,.5)}const BP=Ue({hannWindow_:xxe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wxe(r,e,t,n=!1,s=0){let o=0;const a=[];for(;o+e<=r.size;)a.push(Tr(r,o,e)),o+=t;if(n)for(;o<r.size;){const i=o+e-r.size,l=qs([Tr(r,o,e-i),Im([i],s)]);a.push(l),o+=t}return a.length===0?qh([],[0,e]):bt(qs(a),[a.length,e])}const UP=Ue({frame_:wxe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sxe(r,e,t,n,s=BP){n==null&&(n=FP(e));const o=UP(r,e,t),a=Ut(o,s(e));return $1(a,n)}const _xe=Ue({stft_:Sxe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Txe(r,e,t,n,s="bilinear",o=0){const a=fe(r,"image","cropAndResize"),i=fe(e,"boxes","cropAndResize","float32"),l=fe(t,"boxInd","cropAndResize","int32"),u=i.shape[0];Te(a.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${a.rank}.`),Te(i.rank===2&&i.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${u},4] but had shape ${i.shape}.`),Te(l.rank===1&&l.shape[0]===u,()=>`Error in cropAndResize: boxInd must be have size [${u}] but had shape ${i.shape}.`),Te(n.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${n.length}.`),Te(n[0]>=1&&n[1]>=1,()=>`cropSize must be atleast [1,1], but was ${n}`),Te(s==="bilinear"||s==="nearest",()=>`method must be bilinear or nearest, but was ${s}`);const h={image:a,boxes:i,boxInd:l},d={method:s,extrapolationValue:o,cropSize:n};return ze.runKernel($3,h,d)}const kxe=Ue({cropAndResize_:Txe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ixe(r){const e=fe(r,"image","flipLeftRight","float32");Te(e.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${e.rank}.`);const t={image:e};return ze.runKernel(q3,t,{})}const Exe=Ue({flipLeftRight_:Ixe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cxe(r){const e=fe(r,"image","grayscaleToRGB"),t=e.rank-1,n=e.shape[t];Te(e.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${e.rank}.`),Te(n===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${n}.`);const s=new Array(e.rank);return s.fill(1,0,t),s[t]=3,Hh(e,s)}const $xe=Ue({grayscaleToRGB_:Cxe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nxe(r,e,t=0,n=.5){const s=fe(r,"image","rotateWithOffset","float32");Te(s.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${s.rank}.`);const o={image:s},a={radians:e,fillValue:t,center:n};return ze.runKernel(RF,o,a)}const Axe=Ue({rotateWithOffset_:Nxe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Md(r,e,t,n,s,o){n==null&&(n=.5),s==null&&(s=Number.NEGATIVE_INFINITY),o==null&&(o=0);const a=r.shape[0];return t=Math.min(t,a),Te(0<=n&&n<=1,()=>`iouThreshold must be in [0, 1], but was '${n}'`),Te(r.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${r.rank}'`),Te(r.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${r.shape[1]}`),Te(e.rank===1,()=>"scores must be a 1D tensor"),Te(e.shape[0]===a,()=>`scores has incompatible shape with boxes. Expected ${a}, but was ${e.shape[0]}`),Te(0<=o&&o<=1,()=>`softNmsSigma must be in [0, 1], but was '${o}'`),{maxOutputSize:t,iouThreshold:n,scoreThreshold:s,softNmsSigma:o}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rxe(r,e,t,n=.5,s=Number.NEGATIVE_INFINITY){const o=fe(r,"boxes","nonMaxSuppression","float32"),a=fe(e,"scores","nonMaxSuppression","float32"),i=Md(o,a,t,n,s);t=i.maxOutputSize,n=i.iouThreshold,s=i.scoreThreshold;const l={maxOutputSize:t,iouThreshold:n,scoreThreshold:s};return ze.runKernel(NM,{boxes:o,scores:a},l)}const Dxe=Ue({nonMaxSuppression_:Rxe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oxe(r,e,t){const n=Mxe(r,e,t),s=n<0?-(n+1):n;r.splice(s,0,e)}function Mxe(r,e,t){return Lxe(r,e,t||Fxe)}function Fxe(r,e){return r>e?1:r<e?-1:0}function Lxe(r,e,t){let n=0,s=r.length,o=0,a=!1;for(;n<s;){o=n+(s-n>>>1);const i=t(e,r[o]);i>0?n=o+1:(s=o,a=!i)}return a?n:-n-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zP(r,e,t,n,s){return D_(r,e,t,n,s,0)}function VP(r,e,t,n,s,o){return D_(r,e,t,n,s,0,!1,o,!0)}function GP(r,e,t,n,s,o){return D_(r,e,t,n,s,o,!0)}function D_(r,e,t,n,s,o,a=!1,i=!1,l=!1){const u=[];for(let g=0;g<e.length;g++)e[g]>s&&u.push({score:e[g],boxIndex:g,suppressBeginIndex:0});u.sort(xE);const h=o>0?-.5/o:0,d=[],c=[];for(;d.length<t&&u.length>0;){const g=u.pop(),{score:y,boxIndex:v,suppressBeginIndex:b}=g;if(y<s)break;let w=!1;for(let _=d.length-1;_>=b;--_){const I=Pxe(r,v,d[_]);if(I>=n){w=!0;break}if(g.score=g.score*jxe(n,h,I),g.score<=s)break}g.suppressBeginIndex=d.length,w||(g.score===y?(d.push(v),c.push(g.score)):g.score>s&&Oxe(u,g,xE))}const f=d.length,p=t-f;i&&p>0&&(d.push(...new Array(p).fill(0)),c.push(...new Array(p).fill(0)));const m={selectedIndices:d};return a&&(m.selectedScores=c),l&&(m.validOutputs=f),m}function Pxe(r,e,t){const n=r.subarray(e*4,e*4+4),s=r.subarray(t*4,t*4+4),o=Math.min(n[0],n[2]),a=Math.min(n[1],n[3]),i=Math.max(n[0],n[2]),l=Math.max(n[1],n[3]),u=Math.min(s[0],s[2]),h=Math.min(s[1],s[3]),d=Math.max(s[0],s[2]),c=Math.max(s[1],s[3]),f=(i-o)*(l-a),p=(d-u)*(c-h);if(f<=0||p<=0)return 0;const m=Math.max(o,u),g=Math.max(a,h),y=Math.min(i,d),v=Math.min(l,c),b=Math.max(y-m,0)*Math.max(v-g,0);return b/(f+p-b)}function jxe(r,e,t){const n=Math.exp(e*t*t);return t<=r?n:0}function xE(r,e){return r.score-e.score||r.score===e.score&&e.boxIndex-r.boxIndex}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Bxe(r,e,t,n=.5,s=Number.NEGATIVE_INFINITY){const o=fe(r,"boxes","nonMaxSuppressionAsync"),a=fe(e,"scores","nonMaxSuppressionAsync"),i=Md(o,a,t,n,s);t=i.maxOutputSize,n=i.iouThreshold,s=i.scoreThreshold;const l=await Promise.all([o.data(),a.data()]),u=l[0],h=l[1],{selectedIndices:d}=zP(u,h,t,n,s);return o!==r&&o.dispose(),a!==e&&a.dispose(),di(d,"int32")}const Uxe=Bxe;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zxe(r,e,t,n=.5,s=Number.NEGATIVE_INFINITY,o=0){const a=fe(r,"boxes","nonMaxSuppression"),i=fe(e,"scores","nonMaxSuppression"),l=Md(a,i,t,n,s,o);t=l.maxOutputSize,n=l.iouThreshold,s=l.scoreThreshold,o=l.softNmsSigma;const u={boxes:a,scores:i},h={maxOutputSize:t,iouThreshold:n,scoreThreshold:s,softNmsSigma:o},d=ze.runKernel(RM,u,h);return{selectedIndices:d[0],selectedScores:d[1]}}const Vxe=Ue({nonMaxSuppressionWithScore_:zxe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Gxe(r,e,t,n=.5,s=Number.NEGATIVE_INFINITY,o=0){const a=fe(r,"boxes","nonMaxSuppressionAsync"),i=fe(e,"scores","nonMaxSuppressionAsync"),l=Md(a,i,t,n,s,o);t=l.maxOutputSize,n=l.iouThreshold,s=l.scoreThreshold,o=l.softNmsSigma;const u=await Promise.all([a.data(),i.data()]),h=u[0],d=u[1],{selectedIndices:c,selectedScores:f}=GP(h,d,t,n,s,o);return a!==r&&a.dispose(),i!==e&&i.dispose(),{selectedIndices:di(c,"int32"),selectedScores:di(f)}}const Wxe=Gxe;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hxe(r,e,t,n=.5,s=Number.NEGATIVE_INFINITY,o=!1){const a=fe(r,"boxes","nonMaxSuppression"),i=fe(e,"scores","nonMaxSuppression"),l=Md(a,i,t,n,s,null),u=l.maxOutputSize,h=l.iouThreshold,d=l.scoreThreshold,c={boxes:a,scores:i},f={maxOutputSize:u,iouThreshold:h,scoreThreshold:d,padToMaxOutputSize:o},p=ze.runKernel(AM,c,f);return{selectedIndices:p[0],validOutputs:p[1]}}const qxe=Ue({nonMaxSuppressionPadded_:Hxe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Xxe(r,e,t,n=.5,s=Number.NEGATIVE_INFINITY,o=!1){const a=fe(r,"boxes","nonMaxSuppressionAsync"),i=fe(e,"scores","nonMaxSuppressionAsync"),l=Md(a,i,t,n,s,null),u=l.maxOutputSize,h=l.iouThreshold,d=l.scoreThreshold,[c,f]=await Promise.all([a.data(),i.data()]),{selectedIndices:p,validOutputs:m}=VP(c,f,u,h,d,o);return a!==r&&a.dispose(),i!==e&&i.dispose(),{selectedIndices:di(p,"int32"),validOutputs:Nn(m,"int32")}}const Kxe=Xxe;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yxe(r,e,t=!1,n=!1){const s=fe(r,"images","resizeBilinear");Te(s.rank===3||s.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${s.rank}.`),Te(e.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${e}.`),Te(n===!1||t===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let o=s,a=!1;s.rank===3&&(a=!0,o=bt(s,[1,s.shape[0],s.shape[1],s.shape[2]]));const i={images:o},l={alignCorners:t,halfPixelCenters:n,size:e},u=ze.runKernel(HM,i,l);return a?bt(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const Zxe=Ue({resizeBilinear_:Yxe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qxe(r,e,t=!1,n=!1){const s=fe(r,"images","resizeNearestNeighbor");Te(s.rank===3||s.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${s.rank}.`),Te(e.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${e}.`),Te(s.dtype==="float32"||s.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),Te(n===!1||t===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let o=s,a=!1;s.rank===3&&(a=!0,o=bt(s,[1,s.shape[0],s.shape[1],s.shape[2]]));const i={images:o},l={alignCorners:t,halfPixelCenters:n,size:e},u=ze.runKernel(WM,i,l);return a?bt(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const Jxe=Ue({resizeNearestNeighbor_:Qxe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ewe(r,e="binary",t=!1,n=.5){const s=fe(r,"image","threshold"),o=.2989,a=.587,i=.114,l=s.shape[0]*s.shape[1];let u=Ut(di([n]),255),h,d,c,f;if(Te(s.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${s.rank}.`),Te(s.shape[2]===3||s.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${s.shape[2]}.`),Te(s.dtype==="int32"||s.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${s.dtype}.`),Te(e==="otsu"||e==="binary",()=>`Method must be binary or otsu, but was ${e}`),s.shape[2]===3){[h,d,c]=yd(s,[1,1,1],-1);const g=Ut(h,o),y=Ut(d,a),v=Ut(c,i);f=xn(xn(g,y),v)}else f=r;if(e==="otsu"){const g=r_(zn(I_(f),"int32"),Ui([]),256);u=twe(g,l)}const p=t?I1(f,u):sh(f,u);return zn(Ut(p,255),"int32")}function twe(r,e){let t=di([-1]),n=di([0]),s=di([0]),o,a,i,l,u,h;for(let d=0;d<r.size-1;d++){o=Tr(r,0,d+1),a=Tr(r,d+1),u=kr(Nr(o),e),h=kr(Nr(a),e);const c=Nr(Ut(o,nl(0,o.size)));i=kr(c,Nr(o));const f=Im(a.shape,o.size),p=xn(nl(0,a.size),f),m=Ut(a,p);l=kr(Nr(m),Nr(a));const g=Rn(i,l),y=Rn(i,l),v=Ut(u,h);s=Ut(Ut(v,g),y);const b=sh(s,n);n=Hc(b,s,n),t=Hc(b,di([d]),t)}return t}const nwe=Ue({threshold_:ewe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rwe(r,e,t="nearest",n="constant",s=0,o){const a=fe(r,"image","transform","float32"),i=fe(e,"transforms","transform","float32");Te(a.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${a.rank}.`),Te(i.rank===2&&(i.shape[0]===a.shape[0]||i.shape[0]===1)&&i.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),Te(o==null||o.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${o}.`);const l={image:a,transforms:i},u={interpolation:t,fillMode:n,fillValue:s,outputShape:o};return ze.runKernel(kF,l,u)}const swe=Ue({transform_:rwe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function owe(r,e,t){Te(e%1===0,()=>`bandPart(): numLower must be an integer, got ${e}.`),Te(t%1===0,()=>`bandPart(): numUpper must be an integer, got ${t}.`);const n=fe(r,"a","bandPart");Te(n.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${n.rank}.`);const s=n.shape,[o,a]=n.shape.slice(-2);if(!(e<=o))throw new Error(`bandPart(): numLower (${e}) must not be greater than the number of rows (${o}).`);if(!(t<=a))throw new Error(`bandPart(): numUpper (${t}) must not be greater than the number of columns (${a}).`);e<0&&(e=o),t<0&&(t=a);const i=bt(nl(0,o,1,"int32"),[-1,1]),l=nl(0,a,1,"int32"),u=Rn(i,l),h=Vf(I1(u,Nn(+e,"int32")),i_(u,Nn(-t,"int32"))),d=qc([o,a],n.dtype);return bt(sl(Lu(bt(n,[-1,o,a])).map(c=>Hc(h,c,d))),s)}const iwe=Ue({bandPart_:owe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function awe(r){let e;if(Array.isArray(r)){e=!1,Te(r!=null&&r.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const s=r[0].shape[0];for(let o=1;o<r.length;++o)Te(r[o].shape[0]===s,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${r[o].shape[0]} vs. ${s})`)}else e=!0,r=yd(r,r.shape[0],0).map(s=>cs(s,[0]));Te(r.length<=r[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${r.length}) exceeds number of dimensions (${r[0].shape[0]}).`);const t=[],n=r;for(let s=0;s<r.length;++s)t.push(ze.tidy(()=>{let o=n[s];if(s>0)for(let a=0;a<s;++a){const i=Ut(Nr(Ut(t[a],o)),t[a]);o=Rn(o,i)}return kr(o,N_(o,"euclidean"))}));return e?sl(t,0):t}const lwe=Ue({gramSchmidt_:awe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uwe(r,e=!1){if(Te(r.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${r.rank}`),r.rank===2)return wE(r,e);{const t=r.shape.slice(0,r.shape.length-2).reduce((l,u)=>l*u),n=Lu(bt(r,[t,r.shape[r.shape.length-2],r.shape[r.shape.length-1]]),0),s=[],o=[];n.forEach(l=>{const[u,h]=wE(l,e);s.push(u),o.push(h)});const a=bt(sl(s,0),r.shape),i=bt(sl(o,0),r.shape);return[a,i]}}function wE(r,e=!1){return ze.tidy(()=>{Te(r.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${r.shape.length}D Tensor.`);const t=r.shape[0],n=r.shape[1];let s=QL(t),o=pu(r);const a=qh([[1]],[1,1]);let i=pu(a);const l=t>=n?n:t;for(let u=0;u<l;++u){const h=o,d=i,c=s;[i,o,s]=ze.tidy(()=>{const f=Tr(o,[u,u],[t-u,1]),p=N_(f),m=Tr(o,[u,u],[1,1]),g=Hc(sh(m,0),qh([[-1]]),qh([[1]])),y=Rn(m,Ut(g,p)),v=kr(f,y);v.shape[0]===1?i=pu(a):i=qs([a,Tr(v,[1,0],[v.shape[0]-1,v.shape[1]])],0);const b=Il(kr(or(g,y),p)),w=Tr(o,[u,0],[t-u,n]),_=Ut(b,i),I=Uf(i);if(u===0)o=Rn(w,or(_,or(I,w)));else{const O=Rn(w,or(_,or(I,w)));o=qs([Tr(o,[0,0],[u,n]),O],0)}const C=Uf(_),N=Tr(s,[0,u],[t,s.shape[1]-u]);if(u===0)s=Rn(N,or(or(N,i),C));else{const O=Rn(N,or(or(N,i),C));s=qs([Tr(s,[0,0],[t,u]),O],1)}return[i,o,s]}),xo([h,d,c])}return!e&&t>n&&(s=Tr(s,[0,0],[t,n]),o=Tr(o,[0,0],[n,n])),[s,o]})}const cwe=Ue({qr_:uwe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var so;(function(r){r[r.NONE=0]="NONE",r[r.MEAN=1]="MEAN",r[r.SUM=2]="SUM",r[r.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(so||(so={}));function hwe(r,e,t=so.SUM_BY_NONZERO_WEIGHTS){const n=fe(r,"losses","computeWeightedLoss");let s=null;e!=null&&(s=fe(e,"weights","computeWeightedLoss"));const o=s==null?n:Ut(n,s);if(t===so.NONE)return o;if(t===so.SUM)return Nr(o);if(t===so.MEAN){if(s==null)return Gf(o);{const a=n.size/s.size,i=kr(Nr(o),Nr(s));return a>1?kr(i,Nn(a)):i}}if(t===so.SUM_BY_NONZERO_WEIGHTS){if(s==null)return kr(Nr(o),Nn(n.size));{const a=Ut(s,lu(n.shape)),i=zn(Nr(y_(a,Nn(0))),"float32");return kr(Nr(o),i)}}throw Error(`Unknown reduction: ${t}`)}const Fl=Ue({computeWeightedLoss_:hwe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dwe(r,e,t,n=so.SUM_BY_NONZERO_WEIGHTS){const s=fe(r,"labels","absoluteDifference"),o=fe(e,"predictions","absoluteDifference");let a=null;t!=null&&(a=fe(t,"weights","absoluteDifference")),co(s.shape,o.shape,"Error in absoluteDifference: ");const i=Oo(Rn(s,o));return Fl(i,a,n)}const fwe=Ue({absoluteDifference_:dwe});function pwe(r,e,t,n,s=so.SUM_BY_NONZERO_WEIGHTS){const o=fe(r,"labels","cosineDistance"),a=fe(e,"predictions","cosineDistance");let i=null;n!=null&&(i=fe(n,"weights","cosineDistance")),co(o.shape,a.shape,"Error in cosineDistance: ");const l=Nn(1),u=Rn(l,Nr(Ut(o,a),t,!0));return Fl(u,i,s)}const mwe=Ue({cosineDistance_:pwe});function gwe(r,e,t,n=so.SUM_BY_NONZERO_WEIGHTS){let s=fe(r,"labels","hingeLoss");const o=fe(e,"predictions","hingeLoss");let a=null;t!=null&&(a=fe(t,"weights","hingeLoss")),co(s.shape,o.shape,"Error in hingeLoss: ");const i=Nn(1);s=Rn(Ut(Nn(2),s),i);const l=Cm(Rn(i,Ut(s,o)));return Fl(l,a,n)}const ywe=Ue({hingeLoss_:gwe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vwe(r,e,t,n=1,s=so.SUM_BY_NONZERO_WEIGHTS){const o=fe(r,"labels","huberLoss"),a=fe(e,"predictions","huberLoss");let i=null;t!=null&&(i=fe(t,"weights","huberLoss")),co(o.shape,a.shape,"Error in huberLoss: ");const l=Nn(n),u=Oo(Rn(a,o)),h=m_(u,l),d=Rn(u,h),c=xn(Ut(Nn(.5),Vi(h)),Ut(l,d));return Fl(c,i,s)}const bwe=Ue({huberLoss_:vwe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xwe(r,e,t,n=1e-7,s=so.SUM_BY_NONZERO_WEIGHTS){const o=fe(r,"labels","logLoss"),a=fe(e,"predictions","logLoss");let i=null;t!=null&&(i=fe(t,"weights","logLoss")),co(o.shape,a.shape,"Error in logLoss: ");const l=Nn(1),u=Nn(n),h=Il(Ut(o,md(xn(a,u)))),d=Ut(Rn(l,o),md(xn(Rn(l,a),u))),c=Rn(h,d);return Fl(c,i,s)}const wwe=Ue({logLoss_:xwe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Swe(r,e,t,n=so.SUM_BY_NONZERO_WEIGHTS){const s=fe(r,"labels","meanSquaredError"),o=fe(e,"predictions","meanSquaredError");let a=null;t!=null&&(a=fe(t,"weights","meanSquaredError")),co(s.shape,o.shape,"Error in meanSquaredError: ");const i=C_(s,o);return Fl(i,a,n)}const _we=Ue({meanSquaredError_:Swe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Twe(r,e){const t=fe(r,"labels","sigmoidCrossEntropyWithLogits"),n=fe(e,"logits","sigmoidCrossEntropyWithLogits");co(t.shape,n.shape,"Error in sigmoidCrossEntropyWithLogits: ");const s=Cm(n),o=Ut(n,t),a=l_(_u(Il(Oo(n))));return xn(Rn(s,o),a)}function kwe(r,e,t,n=0,s=so.SUM_BY_NONZERO_WEIGHTS){let o=fe(r,"multiClassLabels","sigmoidCrossEntropy");const a=fe(e,"logits","sigmoidCrossEntropy");let i=null;if(t!=null&&(i=fe(t,"weights","sigmoidCrossEntropy")),co(o.shape,a.shape,"Error in sigmoidCrossEntropy: "),n>0){const u=Nn(n),h=Nn(1),d=Nn(.5);o=xn(Ut(o,Rn(h,u)),Ut(d,u))}const l=Twe(o,a);return Fl(l,i,s)}const Iwe=Ue({sigmoidCrossEntropy_:kwe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ewe(r,e,t=-1){if(t===-1&&(t=e.rank-1),t!==e.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${e.rank} and dim was ${t}`);return tl((s,o,a)=>{const l=iP(o,[t],!0),u=Rn(zn(o,"float32"),l);a([s,u]);const h=Il(Ut(u,s));return{value:Nr(h,[t]),gradFunc:(f,p)=>{const[m,g]=p,y=Em(f.shape,[t]);return[Ut(bt(f,y),Rn(zn(m,"float32"),_u(g))),Ut(bt(f,y),Rn(_u(g),zn(m,"float32")))]}}})(r,e)}function Cwe(r,e,t,n=0,s=so.SUM_BY_NONZERO_WEIGHTS){let o=fe(r,"onehotLabels","softmaxCrossEntropy");const a=fe(e,"logits","softmaxCrossEntropy");let i=null;if(t!=null&&(i=fe(t,"weights","softmaxCrossEntropy")),co(o.shape,a.shape,"Error in softmaxCrossEntropy: "),n>0){const u=Nn(n),h=Nn(1),d=Nn(o.shape[1]);o=xn(Ut(o,Rn(h,u)),kr(u,d))}const l=Ewe(o,a);return Fl(l,i,s)}const $we=Ue({softmaxCrossEntropy_:Cwe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nwe(r,e,t,n){const s=fe(r,"indices","sparseFillEmptyRows","int32"),o=fe(e,"values","sparseFillEmptyRows"),a=fe(t,"denseShape","sparseFillEmptyRows","int32"),i=fe(n,"defaultValue","sparseFillEmptyRows",o.dtype);if(s.rank!==2)throw new Error(`Indices should be Tensor2D but received shape
        ${s.shape}`);if(o.rank!==1)throw new Error(`Values should be Tensor1D but received shape ${o.shape}`);if(a.rank!==1)throw new Error(`Dense shape should be Tensor1D but received shape ${a.shape}`);if(i.rank!==0)throw new Error(`Default value should be a scalar but received shape ${i.shape}`);const l={indices:s,values:o,denseShape:a,defaultValue:i},u=ze.runKernel(hF,l);return{outputIndices:u[0],outputValues:u[1],emptyRowIndicator:u[2],reverseIndexMap:u[3]}}const Awe=Ue({sparseFillEmptyRows_:Nwe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rwe(r,e,t){const n=fe(r,"inputIndices","sparseReshape","int32"),s=fe(e,"inputShape","sparseReshape","int32"),o=fe(t,"newShape","sparseReshape","int32");if(n.rank!==2)throw new Error(`Input indices should be Tensor2D but received shape
        ${n.shape}`);if(s.rank!==1)throw new Error(`Input shape should be Tensor1D but received shape ${s.shape}`);if(o.rank!==1)throw new Error(`New shape should be Tensor1D but received shape ${o.shape}`);const a={inputIndices:n,inputShape:s,newShape:o},i=ze.runKernel(dF,a);return{outputIndices:i[0],outputShape:i[1]}}const Dwe=Ue({sparseReshape_:Rwe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Owe(r,e,t){const n=fe(r,"data","sparseSegmentMean"),s=fe(e,"indices","sparseSegmentMean","int32"),o=fe(t,"segmentIds","sparseSegmentMean","int32");if(n.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
          ${s.shape}`);if(o.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
          ${o.shape}`);const a={data:n,indices:s,segmentIds:o};return ze.runKernel(fF,a)}const Mwe=Ue({sparseSegmentMean_:Owe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fwe(r,e,t){const n=fe(r,"data","sparseSegmentSum"),s=fe(e,"indices","sparseSegmentSum","int32"),o=fe(t,"segmentIds","sparseSegmentSum","int32");if(n.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
         ${s.shape}`);if(o.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
         ${o.shape}`);const a={data:n,indices:s,segmentIds:o};return ze.runKernel(pF,a)}const Lwe=Ue({sparseSegmentSum_:Fwe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pwe(r,e,t,n,s,o,a,i){const l=fe(r,"data","stringNGrams","string");if(l.dtype!=="string")throw new Error("Data must be of datatype string");if(l.shape.length!==1)throw new Error(`Data must be a vector, saw: ${l.shape}`);const u=fe(e,"dataSplits","stringNGrams");if(u.dtype!=="int32")throw new Error("Data splits must be of datatype int32");const h={separator:t,nGramWidths:n,leftPad:s,rightPad:o,padWidth:a,preserveShortSequences:i},d={data:l,dataSplits:u},c=ze.runKernel(vF,d,h);return{nGrams:c[0],nGramsSplits:c[1]}}const jwe=Ue({stringNGrams_:Pwe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bwe(r,e,t=!0){const n=fe(r,"input","stringSplit","string"),s=fe(e,"delimiter","stringSplit","string");if(n.rank!==1)throw new Error(`Input should be Tensor1D but received shape ${n.shape}`);if(s.rank!==0)throw new Error(`Delimiter should be a scalar but received shape ${s.shape}`);const o={skipEmpty:t},a={input:n,delimiter:s},i=ze.runKernel(bF,a,o);return{indices:i[0],values:i[1],shape:i[2]}}const Uwe=Ue({stringSplit_:Bwe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zwe(r,e){const t=fe(r,"input","stringToHashBucketFast","string"),n={numBuckets:e};if(e<=0)throw new Error("Number of buckets must be at least 1");const s={input:t};return ze.runKernel(xF,s,n)}const Vwe=Ue({stringToHashBucketFast_:zwe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gwe={fft:C1,ifft:Hf,rfft:$1,irfft:E_},Wwe={hammingWindow:bxe,hannWindow:BP,frame:UP,stft:_xe},wo={flipLeftRight:Exe,grayscaleToRGB:$xe,resizeNearestNeighbor:Jxe,resizeBilinear:Zxe,rotateWithOffset:Axe,cropAndResize:kxe,nonMaxSuppression:Dxe,nonMaxSuppressionAsync:Uxe,nonMaxSuppressionWithScore:Vxe,nonMaxSuppressionWithScoreAsync:Wxe,nonMaxSuppressionPadded:qxe,nonMaxSuppressionPaddedAsync:Kxe,threshold:nwe,transform:swe},Hwe={bandPart:iwe,gramSchmidt:lwe,qr:cwe},qwe={absoluteDifference:fwe,computeWeightedLoss:Fl,cosineDistance:mwe,hingeLoss:ywe,huberLoss:bwe,logLoss:wwe,meanSquaredError:_we,sigmoidCrossEntropy:Iwe,softmaxCrossEntropy:$we},gf={sparseFillEmptyRows:Awe,sparseReshape:Dwe,sparseSegmentMean:Mwe,sparseSegmentSum:Lwe},Xg={stringNGrams:jwe,stringSplit:Uwe,stringToHashBucketFast:Vwe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Pu extends yL{minimize(e,t=!1,n){const{value:s,grads:o}=this.computeGradients(e,n);if(n!=null){const a=n.map(i=>({name:i.name,tensor:o[i.name]}));this.applyGradients(a)}else this.applyGradients(o);return xo(o),t?s:(s.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,t){return rP(e,t)}dispose(){this.iterations_!=null&&xo(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:Nn(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}}Object.defineProperty(Pu,Symbol.hasInstance,{value:r=>r.minimize!=null&&r.computeGradients!=null&&r.applyGradients!=null});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class O1 extends Pu{constructor(e,t,n=null){super(),this.learningRate=e,this.rho=t,this.epsilon=n,this.accumulatedGrads=[],this.accumulatedUpdates=[],n==null&&(this.epsilon=ze.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map(n=>n.name):Object.keys(e)).forEach((n,s)=>{const o=ze.registeredVariables[n],a=!1;this.accumulatedGrads[s]==null&&(this.accumulatedGrads[s]={originalName:`${n}/accum_grad`,variable:Vt(()=>jo(o).variable(a))}),this.accumulatedUpdates[s]==null&&(this.accumulatedUpdates[s]={originalName:`${n}/accum_var`,variable:Vt(()=>jo(o).variable(a))});const i=Array.isArray(e)?e[s].tensor:e[n];if(i==null)return;const l=this.accumulatedGrads[s].variable,u=this.accumulatedUpdates[s].variable;Vt(()=>{const h=xn(Ut(l,this.rho),Ut(Vi(i),1-this.rho)),d=Ut(kr(rl(xn(u,this.epsilon)),rl(xn(l,this.epsilon))),i),c=xn(Ut(u,this.rho),Ut(Vi(d),1-this.rho));l.assign(h),u.assign(c);const f=xn(Ut(d,-this.learningRate),o);o.assign(f)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(xo(this.accumulatedGrads.map(e=>e.variable)),xo(this.accumulatedUpdates.map(e=>e.variable)))}async getWeights(){const e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=e.length/2,n=!1;this.accumulatedGrads=e.slice(0,t).map(s=>({originalName:s.name,variable:s.tensor.variable(n)})),this.accumulatedUpdates=e.slice(t,t*2).map(s=>({originalName:s.name,variable:s.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.rho,t.epsilon)}}O1.className="Adadelta";Fu(O1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class M1 extends Pu{constructor(e,t=.1){super(),this.learningRate=e,this.initialAccumulatorValue=t,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map(n=>n.name):Object.keys(e)).forEach((n,s)=>{const o=ze.registeredVariables[n];this.accumulatedGrads[s]==null&&(this.accumulatedGrads[s]={originalName:`${n}/accumulator`,variable:Vt(()=>Im(o.shape,this.initialAccumulatorValue).variable(!1))});const a=Array.isArray(e)?e[s].tensor:e[n];if(a==null)return;const i=this.accumulatedGrads[s].variable;Vt(()=>{const l=xn(i,Vi(a));i.assign(l);const u=xn(Ut(kr(a,rl(xn(l,ze.backend.epsilon()))),-this.learningRate),o);o.assign(u)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&xo(this.accumulatedGrads.map(e=>e.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=!1;this.accumulatedGrads=e.map(n=>({originalName:n.name,variable:n.tensor.variable(t)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,t){return new e(t.learningRate,t.initialAccumulatorValue)}}M1.className="Adagrad";Fu(M1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class F1 extends Pu{constructor(e,t,n,s=null){super(),this.learningRate=e,this.beta1=t,this.beta2=n,this.epsilon=s,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],Vt(()=>{this.accBeta1=Nn(t).variable(),this.accBeta2=Nn(n).variable()}),s==null&&(this.epsilon=ze.backend.epsilon())}applyGradients(e){const t=Array.isArray(e)?e.map(n=>n.name):Object.keys(e);Vt(()=>{const n=Rn(1,this.accBeta1),s=Rn(1,this.accBeta2);t.forEach((o,a)=>{const i=ze.registeredVariables[o],l=!1;this.accumulatedFirstMoment[a]==null&&(this.accumulatedFirstMoment[a]={originalName:`${o}/m`,variable:Vt(()=>jo(i).variable(l))}),this.accumulatedSecondMoment[a]==null&&(this.accumulatedSecondMoment[a]={originalName:`${o}/v`,variable:Vt(()=>jo(i).variable(l))});const u=Array.isArray(e)?e[a].tensor:e[o];if(u==null)return;const h=this.accumulatedFirstMoment[a].variable,d=this.accumulatedSecondMoment[a].variable,c=xn(Ut(h,this.beta1),Ut(u,1-this.beta1)),f=xn(Ut(d,this.beta2),Ut(Vi(u),1-this.beta2)),p=kr(c,n),m=kr(f,s);h.assign(c),d.assign(f);const g=xn(Ut(kr(p,xn(rl(m),this.epsilon)),-this.learningRate),i);i.assign(g)}),this.accBeta1.assign(Ut(this.accBeta1,this.beta1)),this.accBeta2.assign(Ut(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&xo(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedSecondMoment!=null&&xo(this.accumulatedSecondMoment.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e),Vt(()=>{this.accBeta1.assign(gd(this.beta1,this.iterations_+1)),this.accBeta2.assign(gd(this.beta2,this.iterations_+1))});const t=e.length/2,n=!1;this.accumulatedFirstMoment=e.slice(0,t).map(s=>({originalName:s.name,variable:s.tensor.variable(n)})),this.accumulatedSecondMoment=e.slice(t,t*2).map(s=>({originalName:s.name,variable:s.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon)}}F1.className="Adam";Fu(F1);/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class L1 extends Pu{constructor(e,t,n,s=null,o=0){super(),this.learningRate=e,this.beta1=t,this.beta2=n,this.epsilon=s,this.decay=o,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],Vt(()=>{this.iteration=Nn(0).variable(),this.accBeta1=Nn(t).variable()}),s==null&&(this.epsilon=ze.backend.epsilon())}applyGradients(e){const t=Array.isArray(e)?e.map(n=>n.name):Object.keys(e);Vt(()=>{const n=Rn(1,this.accBeta1),s=kr(-this.learningRate,xn(Ut(this.iteration,this.decay),1));t.forEach((o,a)=>{const i=ze.registeredVariables[o],l=!1;this.accumulatedFirstMoment[a]==null&&(this.accumulatedFirstMoment[a]={originalName:`${o}/m`,variable:jo(i).variable(l)}),this.accumulatedWeightedInfNorm[a]==null&&(this.accumulatedWeightedInfNorm[a]={originalName:`${o}/v`,variable:jo(i).variable(l)});const u=Array.isArray(e)?e[a].tensor:e[o];if(u==null)return;const h=this.accumulatedFirstMoment[a].variable,d=this.accumulatedWeightedInfNorm[a].variable,c=xn(Ut(h,this.beta1),Ut(u,1-this.beta1)),f=Ut(d,this.beta2),p=Oo(u),m=p_(f,p);h.assign(c),d.assign(m);const g=xn(Ut(kr(s,n),kr(c,xn(m,this.epsilon))),i);i.assign(g)}),this.iteration.assign(xn(this.iteration,1)),this.accBeta1.assign(Ut(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&xo(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedWeightedInfNorm!=null&&xo(this.accumulatedWeightedInfNorm.map(e=>e.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon,t.decay)}}L1.className="Adamax";Fu(L1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $m extends Pu{constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map(n=>n.name):Object.keys(e)).forEach((n,s)=>{const o=Array.isArray(e)?e[s].tensor:e[n];if(o==null)return;const a=ze.registeredVariables[n];Vt(()=>{const i=xn(Ut(this.c,o),a);a.assign(i)})}),this.incrementIterations()}setLearningRate(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=za(Nn(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(e=await this.extractIterations(e),e.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,t){return new e(t.learningRate)}}$m.className="SGD";Fu($m);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class P1 extends $m{constructor(e,t,n=!1){super(e),this.learningRate=e,this.momentum=t,this.useNesterov=n,this.accumulations=[],this.m=Nn(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map(n=>n.name):Object.keys(e)).forEach((n,s)=>{const o=ze.registeredVariables[n];this.accumulations[s]==null&&(this.accumulations[s]={originalName:`${n}/momentum`,variable:Vt(()=>jo(o).variable(!1))});const a=this.accumulations[s].variable,i=Array.isArray(e)?e[s].tensor:e[n];i!=null&&Vt(()=>{let l;const u=xn(Ut(this.m,a),i);this.useNesterov?l=xn(Ut(this.c,xn(i,Ut(u,this.m))),o):l=xn(Ut(this.c,u),o),a.assign(u),o.assign(l)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&xo(this.accumulations.map(e=>e.variable))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=!1;this.accumulations=e.map(n=>({originalName:n.name,variable:n.tensor.variable(t)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,t){return new e(t.learningRate,t.momentum,t.useNesterov)}}P1.className="Momentum";Fu(P1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class j1 extends Pu{constructor(e,t=.9,n=0,s=null,o=!1){if(super(),this.learningRate=e,this.decay=t,this.momentum=n,this.epsilon=s,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=o,s==null&&(this.epsilon=ze.backend.epsilon()),e==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map(n=>n.name):Object.keys(e)).forEach((n,s)=>{const o=ze.registeredVariables[n],a=!1;this.accumulatedMeanSquares[s]==null&&(this.accumulatedMeanSquares[s]={originalName:`${n}/rms`,variable:Vt(()=>jo(o).variable(a))}),this.accumulatedMoments[s]==null&&(this.accumulatedMoments[s]={originalName:`${n}/momentum`,variable:Vt(()=>jo(o).variable(a))}),this.accumulatedMeanGrads[s]==null&&this.centered&&(this.accumulatedMeanGrads[s]={originalName:`${n}/mg`,variable:Vt(()=>jo(o).variable(a))});const i=Array.isArray(e)?e[s].tensor:e[n];if(i==null)return;const l=this.accumulatedMeanSquares[s].variable,u=this.accumulatedMoments[s].variable;Vt(()=>{const h=xn(Ut(l,this.decay),Ut(Vi(i),1-this.decay));if(this.centered){const d=this.accumulatedMeanGrads[s].variable,c=xn(Ut(d,this.decay),Ut(i,1-this.decay)),f=kr(Ut(i,this.learningRate),rl(Rn(h,xn(Vi(c),this.epsilon)))),p=xn(Ut(u,this.momentum),f);l.assign(h),d.assign(c),u.assign(p);const m=Rn(o,p);o.assign(m)}else{const d=xn(Ut(l,this.decay),Ut(Vi(i),1-this.decay)),c=xn(Ut(u,this.momentum),kr(Ut(i,this.learningRate),rl(xn(d,this.epsilon))));l.assign(d),u.assign(c);const f=Rn(o,c);o.assign(f)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&xo(this.accumulatedMeanSquares.map(e=>e.variable)),this.accumulatedMeanGrads!=null&&this.centered&&xo(this.accumulatedMeanGrads.map(e=>e.variable)),this.accumulatedMoments!=null&&xo(this.accumulatedMoments.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=this.centered?e.length/3:e.length/2,n=!1;this.accumulatedMeanSquares=e.slice(0,t).map(s=>({originalName:s.name,variable:s.tensor.variable(n)})),this.accumulatedMoments=e.slice(t,t*2).map(s=>({originalName:s.name,variable:s.tensor.variable(n)})),this.centered&&(this.accumulatedMeanGrads=e.slice(t*2,t*3).map(s=>({originalName:s.name,variable:s.tensor.variable(n)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,t){return new e(t.learningRate,t.decay,t.momentum,t.epsilon,t.centered)}}j1.className="RMSProp";Fu(j1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eu{static sgd(e){return new $m(e)}static momentum(e,t,n=!1){return new P1(e,t,n)}static rmsprop(e,t=.9,n=0,s=null,o=!1){return new j1(e,t,n,s,o)}static adam(e=.001,t=.9,n=.999,s=null){return new F1(e,t,n,s)}static adadelta(e=.001,t=.95,n=null){return new O1(e,t,n)}static adamax(e=.002,t=.9,n=.999,s=null,o=0){return new L1(e,t,n,s,o)}static adagrad(e,t=.1){return new M1(e,t)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xwe={sgd:eu.sgd,momentum:eu.momentum,adadelta:eu.adadelta,adagrad:eu.adagrad,rmsprop:eu.rmsprop,adamax:eu.adamax,adam:eu.adam};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kwe=(()=>typeof requestAnimationFrame!="undefined"?requestAnimationFrame:typeof setImmediate!="undefined"?setImmediate:r=>r())();function Ywe(){return new Promise(r=>Kwe(()=>r()))}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zwe(r,e){const t=r[0].length;r.forEach((s,o)=>{Te(s.length===t,()=>`Error in concat${t}D: rank of tensors[${o}] must be the same as the rank of the rest (${t})`)}),Te(e>=0&&e<t,()=>`Error in concat${t}D: axis must be between 0 and ${t-1}.`);const n=r[0];r.forEach((s,o)=>{for(let a=0;a<t;a++)Te(a===e||s[a]===n[a],()=>`Error in concat${t}D: Shape of tensors[${o}] (${s}) does not match the shape of the rest (${n}) along the non-concatenated axis ${o}.`)})}function Qwe(r,e){const t=r[0].slice();for(let n=1;n<r.length;n++)t[e]+=r[n][e];return t}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O_=30;function Jwe(r){return r<=O_?r:ky(r,Math.floor(Math.sqrt(r)))}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e2e(r,e,t){const n=t*(typeof r=="number"?r:r[0]),s=e*(typeof r=="number"?r:r[1]);return[n,s]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t2e(r,e,t,n=!0){let s=[];if(n)s=s.concat(e.slice(0)),s.push(r[0]/t),s=s.concat(r.slice(1));else{s=s.concat(r[0]);const o=e.length;for(let a=0;a<o;++a)s=s.concat([r[a+1]/e[a],e[a]]);s=s.concat(r.slice(o+1))}return s}function n2e(r,e,t=!0){const n=[];if(t){n.push(e);for(let s=e+1;s<r;++s)s<=2*e?(n.push(s),n.push(s-(e+1))):n.push(s)}else{const s=[],o=[];for(let a=1;a<r;++a)a>=e*2+1||a%2===1?o.push(a):s.push(a);n.push(...s),n.push(0),n.push(...o)}return n}function r2e(r,e,t,n=!0){const s=[];n?s.push(r[0]/t):s.push(r[0]*t);for(let o=1;o<r.length;++o)o<=e.length?n?s.push(e[o-1]*r[o]):s.push(r[o]/e[o-1]):s.push(r[o]);return s}function s2e(r,e){const t=[0];for(let n=0;n<e;++n)t.push(r[n][0]);return t}function o2e(r,e,t){const n=r.slice(0,1);for(let s=0;s<t;++s)n.push(r[s+1]-e[s][0]-e[s][1]);return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i2e=1.7580993408473768,a2e=1.0507009873554805;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const l2e=.3275911,u2e=.254829592,c2e=-.284496736,h2e=1.421413741,d2e=-1.453152027,f2e=1.061405429;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p2e(r,e){if(r.length!==e.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${r.length}, imag: ${e.length}.`);const t=new Float32Array(r.length*2);for(let n=0;n<t.length;n+=2)t[n]=r[n/2],t[n+1]=e[n/2];return t}function m2e(r){const e=new Float32Array(r.length/2),t=new Float32Array(r.length/2);for(let n=0;n<r.length;n+=2)e[n/2]=r[n],t[n/2]=r[n+1];return{real:e,imag:t}}function g2e(r){const e=Math.ceil(r.length/4),t=new Float32Array(e),n=new Float32Array(e);for(let s=0;s<r.length;s+=4)t[Math.floor(s/4)]=r[s],n[Math.floor(s/4)]=r[s+1];return{real:t,imag:n}}function y2e(r){const e=Math.floor(r.length/4),t=new Float32Array(e),n=new Float32Array(e);for(let s=2;s<r.length;s+=4)t[Math.floor(s/4)]=r[s],n[Math.floor(s/4)]=r[s+1];return{real:t,imag:n}}function v2e(r,e){const t=r[e*2],n=r[e*2+1];return{real:t,imag:n}}function b2e(r,e,t,n){r[n*2]=e,r[n*2+1]=t}function x2e(r,e){const t=new Float32Array(r/2),n=new Float32Array(r/2);for(let s=0;s<Math.ceil(r/2);s++){const o=(e?2:-2)*Math.PI*(s/r);t[s]=Math.cos(o),n[s]=Math.sin(o)}return{real:t,imag:n}}function w2e(r,e,t){const n=(t?2:-2)*Math.PI*(r/e),s=Math.cos(n),o=Math.sin(n);return{real:s,imag:o}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sb="->",S2e=/->/g,SE=",",_E="...";function _2e(r,e){r=r.replace(/\s/g,"");const t=(r.length-r.replace(S2e,"").length)/sb.length;if(t<1)throw new Error("Equations without an arrow are not supported.");if(t>1)throw new Error(`Equation must contain exactly one arrow ("${sb}").`);const[n,s]=r.split(sb);Te(n.indexOf(_E)===-1,()=>`The ellipsis notation ("${_E}") is not supported yet.`);const o=n.split(SE),a=o.length;if(e!==a)throw new Error(`Expected ${a} input tensors, received ${e}`);if(a>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const i=[];for(let c=0;c<s.length;++c){const f=s[c];if(!o.some(p=>p.indexOf(f)!==-1))throw new Error(`Output subscripts contain the label ${f} not present in the input subscripts.`);i.indexOf(f)===-1&&i.push(f)}for(let c=0;c<n.length;++c){const f=n[c];i.indexOf(f)===-1&&f!==SE&&i.push(f)}const l=new Array(o.length);for(let c=0;c<a;++c){if(new Set(o[c].split("")).size!==o[c].length)throw new Error(`Found duplicate axes in input component ${o[c]}. Support for duplicate axes in input is not implemented yet.`);l[c]=[];for(let f=0;f<o[c].length;++f)l[c].push(i.indexOf(o[c][f]))}const u=i.length,h=s.length,d=[];for(let c=h;c<u;++c)d.push(c);return{allDims:i,summedDims:d,idDims:l}}function T2e(r,e){let t=new Array(r);t.fill(-1);for(let s=0;s<e.length;++s)t[e[s]]=s;const n=[];for(let s=0;s<r;++s)t[s]===-1&&n.push(s);return t=t.filter(s=>s!==-1),{permutationIndices:t,expandDims:n}}function k2e(r,e,t){const n=new Array(r);for(let s=0;s<t.length;++s){const o=t[s].shape;for(let a=0;a<e[s].length;++a)n[e[s][a]]===void 0?n[e[s][a]]=o[a]:Te(n[e[s][a]]===o[a],()=>`Expected dimension ${n[e[s][a]]} at axis ${a} of input shaped ${JSON.stringify(o)}, but got dimension ${o[a]}`)}}function I2e(r,e){const t=r,n=[];let s=0;r.length===0&&t.push(-1),s=r.length+1;for(let a=0;a<s;++a)n.push([]);const o=[];for(let a=0;a<t.length;++a){const i=t[a],l=C2e(e,i);for(const u of l)o.indexOf(u)===-1&&(n[a].push(u),o.push(u))}return{path:t,steps:n}}function E2e(r){return r.every((e,t)=>e===t)}function C2e(r,e){const t=[];for(let n=0;n<r.length;++n)(r[n].length===0||r[n].indexOf(e)!==-1||e===-1)&&t.push(n);return t}function $2e(r,e,t=0){let n=[];if(typeof e=="number")Te(r.shape[t]%e===0,()=>"Number of splits must evenly divide the axis."),n=new Array(e).fill(r.shape[t]/e);else{const s=e.reduce((a,i)=>(i===-1&&(a+=1),a),0);Te(s<=1,()=>"There should be only one negative value in split array.");const o=e.indexOf(-1);if(o!==-1){const a=e.reduce((i,l)=>l>0?i+l:i);e[o]=r.shape[t]-a}Te(r.shape[t]===e.reduce((a,i)=>a+i),()=>"The sum of sizes must match the size of the axis dimension."),n=e}return n}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N2e(r){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${r}`}function A2e(r,e){return`indices(${r}, 0) is invalid: ${e} < 0`}function R2e(r,e,t){return`indices(${r}, 0) is invalid: ${e} >= ${t}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D2e(r,e){return`only one output dimension may be -1, not both ${r} and ${e}`}function O2e(r,e){return`size ${r} must be non-negative, not ${e}`}function M2e(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function F2e(r,e){const t=Ur(r),n=Ur(e);return`Input to reshape is a SparseTensor with ${t}
  dense values, but the requested shape requires a multiple of ${n}. inputShape=${r} outputShape= ${e}`}function L2e(r,e){const t=Ur(r),n=Ur(e);return`Input to reshape is a tensor with ${t} dense values, but the requested shape has ${n}. inputShape=${r} outputShape=${e}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P2e(){return"segment ids must be >= 0"}function j2e(){return"segment ids are not increasing"}function B2e(r,e){return`Segment id ${r} out of range [0, ${e}), possibly because segmentIds input is not sorted.`}function U2e(r,e,t){return`Bad: indices[${r}] == ${e} out of range [0, ${t})`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z2e(r,e){let t=!1,n;for(r<=O_?(n=r,t=!0):n=ky(r,Math.floor(Math.sqrt(r)));!t;)n>e||n===r?t=!0:n=ky(r,n+1);return n}function V2e(r,e,t){const n=[],s=r.length;for(let o=0;o<s;o++)o!==e?n.push(r[o]):n.push(t);return n}function G2e(r,e,t,n){const s=e.shape.length,o=r.shape.length;if(n!==0&&(n<-s||n>s))throw new Error(`Expect batchDims in the range of [-${s}, ${s}], but got ${n}`);if(n<0&&(n+=s),n>o)throw new Error(`batchDims (${n}) must be less than rank(x) (
    ${o}).`);if(t<n)throw new Error(`batchDims (${n}) must be less than or equal to axis (${t}).`);for(let d=0;d<n;++d)if(r.shape[d]!==e.shape[d])throw new Error(`x.shape[${d}]: ${r.shape[d]} should be equal to indices.shape[${d}]: ${e.shape[d]}.`);const a=r.shape[t],i=[];let l=1,u=1,h=1;for(let d=0;d<n;++d)i.push(r.shape[d]),l*=r.shape[d];for(let d=n;d<t;d++)i.push(r.shape[d]),u*=r.shape[d];for(let d=n;d<s;d++)i.push(e.shape[d]);for(let d=t+1;d<o;d++)i.push(r.shape[d]),h*=r.shape[d];return{batchSize:l,sliceSize:h,outerSize:u,dimSize:a,outputShape:i}}var W2e=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",segOpComputeOptimalWindowSize:z2e,computeOutShape:V2e,collectGatherOpShapeInfo:G2e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H2e(r){try{return r.map(e=>Cy(e))}catch(e){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${e}`)}}function q2e(r){return r.map(e=>xm(e))}var X2e=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",slice_util:gL,segment_util:W2e,fromUint8ToStringArray:H2e,fromStringArrayToUint8:q2e,upcastType:w1,axesAreInnerMostDims:c_,combineLocations:oP,computeOutAndReduceShapes:B1e,expandShapeToKeepDim:Em,assertAxesAreInnerMostDims:U1e,getAxesPermutation:z1e,getUndoAxesPermutation:V1e,getInnerMostAxes:G1e,getBroadcastDims:rL,getReductionAxes:HS,assertAndGetBroadcastShape:ps,assertParamsConsistent:Zwe,computeOutShape:Qwe,computeDilation2DInfo:Zye,computePool2DInfo:AL,computePool3DInfo:Qye,computeConv2DInfo:Tm,computeConv3DInfo:RL,computeDefaultPad:e_,tupleValuesAreOne:zf,eitherStridesOrDilationsAreOne:Ml,convertConv2DDataFormat:DL,checkPadOnDimRoundingMode:Qi,getFusedDyActivation:N1,getFusedBiasGradient:A1,applyActivation:R1,shouldFuse:D1,PARALLELIZE_THRESHOLD:O_,computeOptimalWindowSize:Jwe,getImageCenter:e2e,getReshaped:t2e,getPermuted:n2e,getReshapedPermuted:r2e,getSliceBeginCoords:s2e,getSliceSize:o2e,prepareAndValidate:iL,validateUpdateShape:qS,validateInput:XS,calculateShapes:aL,SELU_SCALEALPHA:i2e,SELU_SCALE:a2e,ERF_P:l2e,ERF_A1:u2e,ERF_A2:c2e,ERF_A3:h2e,ERF_A4:d2e,ERF_A5:f2e,warn:nu,log:cme,mergeRealAndImagArrays:p2e,splitRealAndImagArrays:m2e,complexWithEvenIndex:g2e,complexWithOddIndex:y2e,getComplexWithIndex:v2e,assignToTypedArray:b2e,exponents:x2e,exponent:w2e,decodeEinsumEquation:_2e,getEinsumPermutation:T2e,checkEinsumDimSizes:k2e,getEinsumComputePath:I2e,isIdentityPermutation:E2e,prepareSplitSize:$2e,getSparseFillEmptyRowsIndicesDenseShapeMismatch:N2e,getSparseFillEmptyRowsNegativeIndexErrorMessage:A2e,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:R2e,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:D2e,getSparseReshapeNegativeOutputDimErrorMessage:O2e,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:M2e,getSparseReshapeInputOutputMultipleErrorMessage:F2e,getSparseReshapeInputOutputMismatchErrorMessage:L2e,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:P2e,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:j2e,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:B2e,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:U2e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var K2e=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",nonMaxSuppressionV3Impl:zP,nonMaxSuppressionV4Impl:VP,nonMaxSuppressionV5Impl:GP,whereImpl:RP});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var B1=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",AdadeltaOptimizer:O1,AdagradOptimizer:M1,AdamOptimizer:F1,AdamaxOptimizer:L1,MomentumOptimizer:P1,Optimizer:Pu,OptimizerConstructors:eu,RMSPropOptimizer:j1,SGDOptimizer:$m,Tensor:pr,TensorBuffer:$y,Variable:jf,get Rank(){return ux},sumOutType:Mme,upcastType:w1,get Reduction(){return so},customGrad:tl,grad:C1e,grads:$1e,valueAndGrad:N1e,valueAndGrads:A1e,variableGrads:rP,Environment:KO,env:Pn,get ENV(){return RS},nextFrame:Ywe,KernelBackend:PO,DataStorage:Cpe,abs:Oo,acos:xL,acosh:wL,add:xn,addN:SL,all:_L,any:TL,argMax:_1,argMin:kL,asin:IL,asinh:EL,atan:CL,atan2:$L,atanh:NL,avgPool:t_,avgPool3d:OL,basicLSTMCell:h0e,batchToSpaceND:n_,batchNorm:pd,batchNorm2d:g0e,batchNorm3d:v0e,batchNorm4d:x0e,bincount:r_,broadcastArgs:ML,broadcastTo:kf,buffer:$l,cast:zn,ceil:FL,clipByValue:LL,clone:pu,complex:Su,concat:qs,concat1d:E0e,concat2d:$0e,concat3d:A0e,concat4d:D0e,conv1d:PL,conv2d:km,conv2dTranspose:BL,conv3d:UL,conv3dTranspose:z0e,cos:zL,cosh:VL,cumsum:GL,denseBincount:WL,depthToSpace:HL,depthwiseConv2d:T1,diag:Y0e,dilation2d:qL,div:kr,divNoNan:XL,dot:r1e,einsum:KL,elu:s_,equal:rh,erf:YL,exp:_u,expandDims:Rs,expm1:ZL,eye:QL,fill:Im,floor:o_,floorDiv:JS,gather:Dy,greater:sh,greaterEqual:i_,imag:k1,isFinite:v1e,isInf:x1e,isNaN:JL,leakyRelu:a_,less:eP,lessEqual:I1,linspace:tP,localResponseNormalization:nP,log:md,log1p:l_,logSigmoid:M1e,logSoftmax:sP,logSumExp:iP,logicalAnd:Vf,logicalNot:h_,logicalOr:d_,logicalXor:Y1e,matMul:or,max:Cc,maxPool:f_,maxPool3d:aP,maxPoolWithArgmax:lP,maximum:p_,mean:Gf,meshgrid:nve,min:Oy,minimum:m_,mirrorPad:g_,mod:uP,moments:uve,mul:Ut,multiRNNCell:hve,multinomial:cP,neg:Il,notEqual:y_,oneHot:fd,ones:lu,onesLike:hP,outerProduct:gve,pad:oh,pad1d:bve,pad2d:wve,pad3d:v_,pad4d:Tve,pool:$ve,pow:gd,prelu:x_,print:JF,prod:w_,rand:Ove,randomGamma:Gve,randomNormal:Hve,randomUniform:T_,range:nl,real:Wf,reciprocal:bP,relu:Cm,relu6:k_,reshape:bt,reverse:Nl,reverse1d:ebe,reverse2d:nbe,reverse3d:sbe,reverse4d:ibe,round:I_,rsqrt:xP,scalar:Nn,selu:wP,separableConv2d:hbe,setdiff1dAsync:SP,sigmoid:zi,sign:_P,sin:TP,sinh:kP,slice:Tr,slice1d:ybe,slice2d:bbe,slice3d:wbe,slice4d:_be,softmax:IP,softplus:u_,spaceToBatchND:b_,fft:C1,ifft:Hf,irfft:E_,rfft:$1,split:yd,sqrt:rl,square:Vi,squaredDifference:C_,squeeze:cs,stack:sl,step:EP,stridedSlice:CP,sub:Rn,sum:Nr,tan:$P,tanh:Ry,tensor:Ui,tensor1d:di,tensor2d:qh,tensor3d:sL,tensor4d:Lbe,tensor5d:Pbe,tensor6d:jbe,tile:Hh,topk:NP,truncatedNormal:AP,unique:Tx,unsortedSegmentSum:Gbe,unstack:Lu,variable:Hbe,where:Hc,whereAsync:$_,zeros:qc,zerosLike:jo,op:Ue,OP_SCOPE_SUFFIX:zF,booleanMaskAsync:Kbe,transpose:Uf,norm:N_,movingAverage:Qbe,scatterND:OP,sparseToDense:A_,gatherND:MP,dropout:oxe,enclosingPowerOfTwo:FP,cosineWindow:R_,inTopKAsync:axe,image:wo,linalg:Hwe,losses:qwe,spectral:Gwe,fused:yxe,signal:Wwe,sparse:gf,string:Xg,train:Xwe,enableProdMode:bye,enableDebugMode:xye,disableDeprecationWarnings:wye,deprecationWarn:Sye,disposeVariables:_ye,engine:_m,memory:Tye,profile:kye,tidy:Vt,dispose:xo,keep:za,time:Iye,setBackend:Eye,ready:Cye,getBackend:ZS,removeBackend:$ye,findBackend:Nye,findBackendFactory:Aye,registerBackend:Rye,backend:QS,setPlatform:Dye,getKernel:Iy,getGradient:ax,getKernelsForBackend:Ey,registerKernel:DF,registerGradient:hme,unregisterKernel:dme,unregisterGradient:fme,copyRegisteredKernels:pme,Abs:ZO,Acos:QO,Acosh:JO,Add:OS,AddN:e3,All:t3,Any:n3,ArgMax:r3,ArgMin:s3,Asin:o3,Asinh:i3,Atan:a3,Atanh:l3,Atan2:u3,AvgPool:c3,AvgPoolGrad:Kpe,AvgPool3D:h3,AvgPool3DGrad:Ype,BatchMatMul:d3,BatchToSpaceND:f3,Bincount:p3,BroadcastTo:Zpe,BroadcastArgs:m3,Cast:MS,Ceil:g3,ClipByValue:y3,Complex:v3,ComplexAbs:b3,Concat:x3,Conv2D:w3,Conv2DBackpropFilter:S3,Conv2DBackpropInput:_3,Conv3D:T3,Conv3DBackpropFilterV2:Qpe,Conv3DBackpropInputV2:k3,Cos:I3,Cosh:E3,Cumsum:C3,CropAndResize:$3,DenseBincount:N3,DepthToSpace:A3,DepthwiseConv2dNative:R3,DepthwiseConv2dNativeBackpropFilter:D3,DepthwiseConv2dNativeBackpropInput:O3,Diag:M3,Dilation2D:F3,Dilation2DBackpropInput:Jpe,Dilation2DBackpropFilter:eme,RealDiv:L3,Einsum:P3,Elu:j3,EluGrad:tme,Erf:B3,Equal:U3,Exp:z3,ExpandDims:V3,Expm1:G3,FFT:W3,Fill:H3,FlipLeftRight:q3,Floor:X3,FloorDiv:K3,FusedBatchNorm:Y3,GatherV2:Z3,GatherNd:Q3,Greater:J3,GreaterEqual:eM,Identity:FS,IFFT:tM,Imag:nM,IsFinite:rM,IsInf:sM,IsNan:oM,LeakyRelu:iM,Less:aM,LessEqual:lM,LinSpace:uM,Log:cM,Log1p:hM,LogicalAnd:dM,LogicalNot:fM,LogicalOr:pM,LogSoftmax:nme,LRN:mM,LRNGrad:rme,Max:gM,Maximum:yM,MaxPool:vM,MaxPoolGrad:sme,MaxPool3D:bM,MaxPool3DGrad:ome,MaxPoolWithArgmax:xM,Mean:wM,Min:SM,Minimum:_M,MirrorPad:TM,Mod:kM,Multinomial:IM,Multiply:EM,Neg:CM,NotEqual:$M,NonMaxSuppressionV3:NM,NonMaxSuppressionV4:AM,NonMaxSuppressionV5:RM,OnesLike:DM,OneHot:OM,Pack:MM,PadV2:FM,Pool:ime,Pow:LM,Prelu:PM,Prod:jM,Range:BM,Real:UM,Reciprocal:zM,Relu:VM,Reshape:GM,ResizeNearestNeighbor:WM,ResizeNearestNeighborGrad:ame,ResizeBilinear:HM,ResizeBilinearGrad:lme,Relu6:qM,Reverse:XM,Round:KM,Rsqrt:YM,ScatterNd:ZM,Select:QM,Selu:JM,Slice:eF,Sin:tF,Sinh:nF,Sign:rF,Sigmoid:sF,Softplus:oF,Sqrt:iF,Sum:aF,SpaceToBatchND:lF,SplitV:uF,Softmax:cF,SparseFillEmptyRows:hF,SparseReshape:dF,SparseSegmentMean:fF,SparseSegmentSum:pF,SparseToDense:mF,SquaredDifference:gF,Square:ume,StridedSlice:yF,StringNGrams:vF,StringSplit:bF,StringToHashBucketFast:xF,Sub:wF,Tan:SF,Tanh:_F,Tile:LS,TopK:TF,Transform:kF,Transpose:IF,Unique:EF,Unpack:CF,UnsortedSegmentSum:$F,ZerosLike:NF,Step:AF,FromPixels:rx,RotateWithOffset:RF,_FusedMatMul:sx,FusedConv2D:ox,FusedDepthwiseConv2D:ix,version_core:vye,browser:Yge,io:Lge,math:Vge,serialization:uye,test_util:yye,util:_me,backend_util:X2e,broadcast_util:Gge,tensor_util:Pme,slice_util:gL,gather_util:Zge,scatter_util:Qge,device_util:Gme,kernel_impls:K2e});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Y2e=Pn();Y2e.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,r=>{r&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var Ai;(function(r){r[r.DT_INVALID=0]="DT_INVALID",r[r.DT_FLOAT=1]="DT_FLOAT",r[r.DT_DOUBLE=2]="DT_DOUBLE",r[r.DT_INT32=3]="DT_INT32",r[r.DT_UINT8=4]="DT_UINT8",r[r.DT_INT16=5]="DT_INT16",r[r.DT_INT8=6]="DT_INT8",r[r.DT_STRING=7]="DT_STRING",r[r.DT_COMPLEX64=8]="DT_COMPLEX64",r[r.DT_INT64=9]="DT_INT64",r[r.DT_BOOL=10]="DT_BOOL",r[r.DT_QINT8=11]="DT_QINT8",r[r.DT_QUINT8=12]="DT_QUINT8",r[r.DT_QINT32=13]="DT_QINT32",r[r.DT_BFLOAT16=14]="DT_BFLOAT16",r[r.DT_QINT16=15]="DT_QINT16",r[r.DT_QUINT16=16]="DT_QUINT16",r[r.DT_UINT16=17]="DT_UINT16",r[r.DT_COMPLEX128=18]="DT_COMPLEX128",r[r.DT_HALF=19]="DT_HALF",r[r.DT_RESOURCE=20]="DT_RESOURCE",r[r.DT_VARIANT=21]="DT_VARIANT",r[r.DT_UINT32=22]="DT_UINT32",r[r.DT_UINT64=23]="DT_UINT64",r[r.DT_FLOAT_REF=101]="DT_FLOAT_REF",r[r.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",r[r.DT_INT32_REF=103]="DT_INT32_REF",r[r.DT_UINT8_REF=104]="DT_UINT8_REF",r[r.DT_INT16_REF=105]="DT_INT16_REF",r[r.DT_INT8_REF=106]="DT_INT8_REF",r[r.DT_STRING_REF=107]="DT_STRING_REF",r[r.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",r[r.DT_INT64_REF=109]="DT_INT64_REF",r[r.DT_BOOL_REF=110]="DT_BOOL_REF",r[r.DT_QINT8_REF=111]="DT_QINT8_REF",r[r.DT_QUINT8_REF=112]="DT_QUINT8_REF",r[r.DT_QINT32_REF=113]="DT_QINT32_REF",r[r.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",r[r.DT_QINT16_REF=115]="DT_QINT16_REF",r[r.DT_QUINT16_REF=116]="DT_QUINT16_REF",r[r.DT_UINT16_REF=117]="DT_UINT16_REF",r[r.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",r[r.DT_HALF_REF=119]="DT_HALF_REF",r[r.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",r[r.DT_VARIANT_REF=121]="DT_VARIANT_REF",r[r.DT_UINT32_REF=122]="DT_UINT32_REF",r[r.DT_UINT64_REF=123]="DT_UINT64_REF"})(Ai||(Ai={}));var TE;(function(r){(function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"})(r.CheckpointFormatVersion||(r.CheckpointFormatVersion={}))})(TE||(TE={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Z2e={};function WP(r){return Z2e[r]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X(r,e,t,n,s){const o=e.inputParams[r];if(o&&o.inputIndexStart!==void 0){const i=o.inputIndexStart,l=o.inputIndexEnd===0?void 0:o.inputIndexEnd===void 0?i+1:o.inputIndexEnd;if(o.type==="tensor")return oo(e.inputNames[o.inputIndexStart],t,n,s);if(o.type==="tensors")return e.inputNames.slice(i,l).map(c=>oo(c,t,n,s));const u=oo(e.inputNames.slice(i)[0],t,n,s),h=u.dataSync();return o.type==="number"?h[0]:Ic(u.shape,h)}const a=e.attrParams[r];return a&&a.value}function oo(r,e,t,n){const[s,o]=Do(r);if(n!=null){const i=n.getHashTableHandleByName(s);if(i!=null)return i}const a=t.currentContextIds.find(i=>!!e[My(s,i)]);return a!==void 0?e[My(s,a)][o]:void 0}function Q2e(r,e,t){return e[My(r,t.currentContextId)]}function Ba(r,e){const[t,n,s]=Do(r);return[My(t,e&&e.currentContextId),n,s]}function My(r,e){return e?`${r}-${e}`:r}function Do(r){const e=r.split(":");if(e.length===1)return[r,0,void 0];const t=e[0],n=e.length===3?e[1]:void 0,s=Number(e[e.length-1]);return[t,s,n]}function Kg(r,e,t){let n=X("pad",r,e,t);if(n==="explicit"){n=X("explicitPaddings",r,e,t);const s=[[0,0],[0,0],[0,0],[0,0]];for(let o=0;o<4;o++)s[o][0]=n[o*2],s[o][1]=n[o*2+1];return s}return n}function wl(r){return r.kept?r:pu(r)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const J2e=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}];var eSe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",json:J2e});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tSe=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Prod",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axes",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}];var nSe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",json:tSe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rSe=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]}];var sSe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",json:rSe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oSe=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number"}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}];var iSe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",json:oSe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aSe=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}];var lSe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",json:aSe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uSe=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}];var cSe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",json:uSe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hSe=[{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}];var dSe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",json:hSe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fSe=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}];var pSe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",json:fSe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mSe=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]}];var gSe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",json:mSe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ySe=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]}];var vSe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",json:ySe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bSe=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}];var xSe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",json:bSe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wSe=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]}];var SSe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",json:wSe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _Se=[{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"SparseToDense",category:"normalization",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!0,notSupported:!0}]}];var TSe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",json:_Se});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kSe=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}];var ISe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",json:kSe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ESe=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]}];var CSe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",json:ESe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $Se=[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}];var NSe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",json:$Se});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ASe=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}];var RSe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",json:ASe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DSe=[{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}];var OSe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",json:DSe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MSe=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]},{tfOpName:"BroadcastArgs",category:"transformation",inputs:[{start:0,name:"s0",type:"tensor"},{start:1,name:"s1",type:"tensor"}],attrs:[]}];var FSe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",json:MSe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kE{static get Instance(){return this._instance||(this._instance=new this)}constructor(){const e=[eSe,nSe,sSe,iSe,lSe,cSe,dSe,pSe,gSe,vSe,xSe,SSe,TSe,ISe,CSe,NSe,RSe,OSe,FSe],t=[].concat(...e.map(n=>n.json));this.opMappers=t.reduce((n,s)=>(n[s.tfOpName]=s,n),{})}transformGraph(e,t={}){const n=e.node,s=[],o=[],a=[],i=n.reduce((m,g)=>(m[g.name]=this.mapNode(g),g.op.startsWith("Placeholder")?s.push(m[g.name]):g.op==="Const"?o.push(m[g.name]):(g.input==null||g.input.length===0)&&a.push(m[g.name]),m),{});let l=[];const u=[];let h={},d={};t!=null&&(h=this.mapSignatureEntries(t.inputs),d=this.mapSignatureEntries(t.outputs));const c=Object.keys(i);c.forEach(m=>{const g=i[m];g.inputNames.forEach((y,v)=>{const[b,,w]=Ba(y),_=i[b];if(_.outputs!=null){const I=_.outputs.indexOf(w);if(I!==-1){const C=`${b}:${I}`;g.inputNames[v]=C}}g.inputs.push(_),_.children.push(g)})}),Object.keys(d).length===0?c.forEach(m=>{const g=i[m];g.children.length===0&&u.push(g)}):Object.keys(d).forEach(m=>{const[g]=Ba(m),y=i[g];y!=null&&(y.signatureKey=d[m],u.push(y))}),Object.keys(h).length>0?Object.keys(h).forEach(m=>{const[g]=Ba(m),y=i[g];y&&(y.signatureKey=h[m],l.push(y))}):l=s;let f={};e.library!=null&&e.library.function!=null&&(f=e.library.function.reduce((m,g)=>(m[g.signature.name]=this.mapFunction(g),m),{}));const p={nodes:i,inputs:l,outputs:u,weights:o,placeholders:s,signature:t,functions:f};return a.length>0&&(p.initNodes=a),p}mapSignatureEntries(e){return Object.keys(e||{}).reduce((t,n)=>(t[e[n].name]=n,t),{})}mapNode(e){const t=WP(e.op)||this.opMappers[e.op]||{};e.attr==null&&(e.attr={});const n={name:e.name,op:e.op,category:t.category,inputNames:(e.input||[]).map(s=>s.startsWith("^")?s.substr(1):s),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:e.attr,outputs:t.outputs};return t.inputs!=null&&(n.inputParams=t.inputs.reduce((s,o)=>(s[o.name]={type:o.type,inputIndexStart:o.start,inputIndexEnd:o.end},s),{})),t.attrs!=null&&(n.attrParams=t.attrs.reduce((s,o)=>{const a=o.type;let i;switch(o.type){case"string":i=kx(e.attr,o.tfName,o.defaultValue),i===void 0&&!!o.tfDeprecatedName&&(i=kx(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"string[]":i=Rx(e.attr,o.tfName,o.defaultValue),i===void 0&&!!o.tfDeprecatedName&&(i=Rx(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"number":i=Ex(e.attr,o.tfName,o.defaultValue||0),i===void 0&&!!o.tfDeprecatedName&&(i=Ex(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"number[]":i=Ax(e.attr,o.tfName,o.defaultValue),i===void 0&&!!o.tfDeprecatedName&&(i=Ax(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"bool":i=Ix(e.attr,o.tfName,o.defaultValue),i===void 0&&!!o.tfDeprecatedName&&(i=Ix(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"bool[]":i=Ox(e.attr,o.tfName,o.defaultValue),i===void 0&&!!o.tfDeprecatedName&&(i=Ox(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"shape":i=Nx(e.attr,o.tfName,o.defaultValue),i===void 0&&!!o.tfDeprecatedName&&(i=Nx(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"shape[]":i=Dx(e.attr,o.tfName,o.defaultValue),i===void 0&&!!o.tfDeprecatedName&&(i=Dx(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"dtype":i=Cx(e.attr,o.tfName,o.defaultValue),i===void 0&&!!o.tfDeprecatedName&&(i=Cx(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"dtype[]":i=$x(e.attr,o.tfName,o.defaultValue),i===void 0&&!!o.tfDeprecatedName&&(i=$x(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"func":i=IE(e.attr,o.tfName,o.defaultValue),i===void 0&&!!o.tfDeprecatedName&&(i=IE(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error(`Unsupported param type: ${o.type} for op: ${e.op}`)}return s[o.name]={value:i,type:a},s},{})),n}mapFunction(e){const t=e.nodeDef,n=[],s=[];let o={};t!=null&&(o=t.reduce((d,c)=>(d[c.name]=this.mapNode(c),c.op==="Const"&&s.push(d[c.name]),d),{}));const a=[],i=[];e.signature.inputArg.forEach(d=>{const[c]=Ba(d.name),f={name:c,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:M_(d.type),type:"dtype"}},children:[]};f.signatureKey=d.name,a.push(f),o[c]=f}),Object.keys(o).forEach(d=>{const c=o[d];c.inputNames.forEach((f,p)=>{const[m,,g]=Ba(f),y=o[m];if(y.outputs!=null){const v=y.outputs.indexOf(g);if(v!==-1){const b=`${m}:${v}`;c.inputNames[p]=b}}c.inputs.push(y),y.children.push(c)})});const u=e.ret;e.signature.outputArg.forEach(d=>{const[c,f]=Ba(u[d.name]),p=o[c];p!=null&&(p.defaultOutput=f,i.push(p))});const h=this.mapArgsToSignature(e);return{nodes:o,inputs:a,outputs:i,weights:s,placeholders:n,signature:h}}mapArgsToSignature(e){return{methodName:e.signature.name,inputs:e.signature.inputArg.reduce((t,n)=>(t[n.name]=this.mapArgToTensorInfo(n),t),{}),outputs:e.signature.outputArg.reduce((t,n)=>(t[n.name]=this.mapArgToTensorInfo(n,e.ret),t),{})}}mapArgToTensorInfo(e,t){let n=e.name;return t!=null&&(n=t[n]),{name:n,dtype:e.type}}}function LSe(r){const e=Pn().global;if(typeof e.atob!="undefined")return e.atob(r);if(typeof Buffer!="undefined")return new Buffer(r,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}function HP(r,e){const t=Array.isArray(r)?String.fromCharCode.apply(null,r):LSe(r);return e?t:t.toLowerCase()}function kx(r,e,t,n=!1){const s=r[e];return s!=null?HP(s.s,n):t}function Ix(r,e,t){const n=r[e];return n?n.b:t}function Ex(r,e,t){const n=r[e]||{},s=n.i!=null?n.i:n.f!=null?n.f:t;return typeof s=="number"?s:parseInt(s,10)}function M_(r){switch(typeof r=="string"&&(r=Ai[r]),r){case Ai.DT_FLOAT:case Ai.DT_HALF:return"float32";case Ai.DT_INT32:case Ai.DT_INT64:case Ai.DT_INT8:case Ai.DT_UINT8:return"int32";case Ai.DT_BOOL:return"bool";case Ai.DT_DOUBLE:return"float32";case Ai.DT_STRING:return"string";default:return null}}function IE(r,e,t){const n=r[e];return n&&n.func?n.func.name:t}function Cx(r,e,t){const n=r[e];return n&&n.type?M_(n.type):t}function $x(r,e,t){const n=r[e];return n&&n.list&&n.list.type?n.list.type.map(s=>M_(s)):t}function qP(r){if(!r.unknownRank)return r.dim!=null?r.dim.map(e=>typeof e.size=="number"?e.size:parseInt(e.size,10)):[]}function Nx(r,e,t){const n=r[e];return n&&n.shape?qP(n.shape):t}function Ax(r,e,t){const n=r[e];return n?((n.list.f&&n.list.f.length?n.list.f:n.list.i)||[]).map(s=>typeof s=="number"?s:parseInt(s,10)):t}function Rx(r,e,t,n=!1){const s=r[e];return s&&s.list&&s.list.s?s.list.s.map(o=>HP(o,n)):t}function Dx(r,e,t){const n=r[e];return n&&n.list&&n.list.shape?n.list.shape.map(s=>qP(s)):t}function Ox(r,e,t){const n=r[e];return n&&n.list&&n.list.b?n.list.b:t}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class PSe{constructor(e,t,n){this.node=e,this.tensorMap=t,this.context=n,this.inputs=[],this.attrs={},this.inputs=e.inputNames.map(s=>this.getInput(s)),e.rawAttrs!=null&&(this.attrs=Object.keys(e.rawAttrs).reduce((s,o)=>(s[o]=this.getAttr(o),s),{}))}getInput(e){return oo(e,this.tensorMap,this.context)}getAttr(e,t){const n=this.node.rawAttrs[e];if(n.tensor!=null)return oo(e,this.tensorMap,this.context);if(n.i!=null||n.f!=null)return Ex(this.node.rawAttrs,e,t);if(n.s!=null)return kx(this.node.rawAttrs,e,t);if(n.b!=null)return Ix(this.node.rawAttrs,e,t);if(n.shape!=null)return Nx(this.node.rawAttrs,e,t);if(n.type!=null)return Cx(this.node.rawAttrs,e,t);if(n.list!=null){if(n.list.i!=null||n.list.f!=null)return Ax(this.node.rawAttrs,e,t);if(n.list.s!=null)return Rx(this.node.rawAttrs,e,t);if(n.list.shape!=null)return Dx(this.node.rawAttrs,e,t);if(n.list.b!=null)return Ox(this.node.rawAttrs,e,t);if(n.list.type!=null)return $x(this.node.rawAttrs,e,t)}return t}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jSe=(r,e,t)=>{switch(r.op){case"BiasAdd":case"AddV2":case"Add":return[xn(X("a",r,e,t),X("b",r,e,t))];case"AddN":return[SL(X("tensors",r,e,t))];case"FloorMod":case"Mod":return[uP(X("a",r,e,t),X("b",r,e,t))];case"Mul":return[Ut(X("a",r,e,t),X("b",r,e,t))];case"RealDiv":case"Div":return[kr(X("a",r,e,t),X("b",r,e,t))];case"DivNoNan":return[XL(X("a",r,e,t),X("b",r,e,t))];case"FloorDiv":return[JS(X("a",r,e,t),X("b",r,e,t))];case"Sub":return[Rn(X("a",r,e,t),X("b",r,e,t))];case"Minimum":return[m_(X("a",r,e,t),X("b",r,e,t))];case"Maximum":return[p_(X("a",r,e,t),X("b",r,e,t))];case"Pow":return[gd(X("a",r,e,t),X("b",r,e,t))];case"SquaredDifference":return[C_(X("a",r,e,t),X("b",r,e,t))];default:throw TypeError(`Node type ${r.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BSe=(r,e,t)=>{switch(r.op){case"Abs":case"ComplexAbs":return[Oo(X("x",r,e,t))];case"Acos":return[xL(X("x",r,e,t))];case"Acosh":return[wL(X("x",r,e,t))];case"Asin":return[IL(X("x",r,e,t))];case"Asinh":return[EL(X("x",r,e,t))];case"Atan":return[CL(X("x",r,e,t))];case"Atan2":return[$L(X("x",r,e,t),X("y",r,e,t))];case"Atanh":return[NL(X("x",r,e,t))];case"Ceil":return[FL(X("x",r,e,t))];case"Complex":return[Su(X("real",r,e,t),X("imag",r,e,t))];case"Cos":return[zL(X("x",r,e,t))];case"Cosh":return[VL(X("x",r,e,t))];case"Elu":return[s_(X("x",r,e,t))];case"Erf":return[YL(X("x",r,e,t))];case"Exp":return[_u(X("x",r,e,t))];case"Expm1":return[ZL(X("x",r,e,t))];case"Floor":return[o_(X("x",r,e,t))];case"Log":return[md(X("x",r,e,t))];case"Log1p":return[l_(X("x",r,e,t))];case"Imag":return[k1(X("x",r,e,t))];case"Neg":return[Il(X("x",r,e,t))];case"Reciprocal":return[bP(X("x",r,e,t))];case"Real":return[Wf(X("x",r,e,t))];case"Relu":return[Cm(X("x",r,e,t))];case"Round":return[I_(X("x",r,e,t))];case"Selu":return[wP(X("x",r,e,t))];case"Sigmoid":return[zi(X("x",r,e,t))];case"Sin":return[TP(X("x",r,e,t))];case"Sign":return[_P(X("x",r,e,t))];case"Sinh":return[kP(X("x",r,e,t))];case"Softplus":return[u_(X("x",r,e,t))];case"Sqrt":return[rl(X("x",r,e,t))];case"Square":return[Vi(X("x",r,e,t))];case"Tanh":return[Ry(X("x",r,e,t))];case"Tan":return[$P(X("x",r,e,t))];case"ClipByValue":return[LL(X("x",r,e,t),X("clipValueMin",r,e,t),X("clipValueMax",r,e,t))];case"Relu6":return[k_(X("x",r,e,t))];case"Rsqrt":return[xP(oo(r.inputNames[0],e,t))];case"Prod":return[w_(X("x",r,e,t),X("axes",r,e,t))];case"LeakyRelu":return[a_(X("x",r,e,t),X("alpha",r,e,t))];case"Prelu":return[x_(X("x",r,e,t),X("alpha",r,e,t))];case"IsNan":return[JL(oo(r.inputNames[0],e,t))];default:throw TypeError(`Node type ${r.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Di(r,e,t=""){if(!(typeof r=="number"||typeof e=="number")){Te(r.length===e.length,()=>t+` Shapes ${r} and ${e} must match`);for(let n=0;n<r.length;n++){const s=r[n],o=e[n];Te(s<0||o<0||s===o,()=>t+` Shapes ${r} and ${e} must match`)}}}function EE(r){return!(typeof r=="number"||r.some(e=>e<0))}function rf(r,e,t){let n=Mx(r,t);const s=!EE(n);if(s&&e.length===0)throw new Error(`Tried to calculate elements of an empty list with non-fully-defined elementShape: ${n}`);if(s&&e.forEach(o=>{n=Mx(o.shape,n)}),!EE(n))throw new Error(`Non-fully-defined elementShape: ${n}`);return n}function Mx(r,e){if(typeof r=="number")return e;if(typeof e=="number")return r;if(r.length!==e.length)throw new Error(`Incompatible ranks during merge: ${r} vs. ${e}`);const t=[];for(let n=0;n<r.length;++n){const s=r[n],o=e[n];if(s>=0&&o>=0&&s!==o)throw new Error(`Incompatible shape during merge: ${r} vs. ${e}`);t[n]=s>=0?s:o}return t}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class USe{constructor(e,t,n,s,o,a,i){this.name=e,this.dtype=t,this.maxSize=n,this.elementShape=s,this.identicalElementShapes=o,this.dynamicSize=a,this.clearAfterRead=i,this.tensors=[],this.closed_=!1,this.idTensor=Nn(0),za(this.idTensor)}get id(){return this.idTensor.id}get closed(){return this.closed_}clearAndClose(e){this.tensors.forEach(t=>{(e==null||!e.has(t.tensor.id))&&t.tensor.dispose()}),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}size(){return this.tensors.length}read(e){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||e>=this.size())throw new Error(`Tried to read from index ${e}, but array size is: ${this.size()}`);const t=this.tensors[e];if(t.cleared)throw new Error(`TensorArray ${this.name}: Could not read index ${e} twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).`);return this.clearAfterRead&&(t.cleared=!0),t.read=!0,t.tensor}readMany(e){return e.map(t=>this.read(t))}write(e,t){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||!this.dynamicSize&&e>=this.maxSize)throw new Error(`Tried to write to index ${e}, but array is not resizeable and size is: ${this.maxSize}`);const n=this.tensors[e]||{};if(t.dtype!==this.dtype)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e},
          because the value dtype is ${t.dtype}, but TensorArray dtype is ${this.dtype}.`);if(this.size()===0&&(this.elementShape==null||this.elementShape.length===0)&&(this.elementShape=t.shape),Di(this.elementShape,t.shape,`TensorArray ${this.name}: Could not write to TensorArray index ${e}.`),n.read)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been read.`);if(n.written)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been written.`);n.tensor=t,za(t),n.written=!0,this.tensors[e]=n}writeMany(e,t){if(e.length!==t.length)throw new Error(`TensorArray ${this.name}: could not write multiple tensors,because the index size: ${e.length} is not the same as tensors size: ${t.length}.`);e.forEach((n,s)=>this.write(n,t[s]))}gather(e,t){if(!!t&&t!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but gather requested dtype ${t}`);if(e)e=e.slice(0,this.size());else{e=[];for(let s=0;s<this.size();s++)e.push(s)}if(e.length===0)return Ui([],[0].concat(this.elementShape));const n=this.readMany(e);return Di(this.elementShape,n[0].shape,"TensorArray shape mismatch: "),sl(n,0)}concat(e){if(!!e&&e!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but concat requested dtype ${e}`);if(this.size()===0)return Ui([],[0].concat(this.elementShape));const t=[];for(let s=0;s<this.size();s++)t.push(s);const n=this.readMany(t);return Di(this.elementShape,n[0].shape,`TensorArray shape mismatch: tensor array shape (${this.elementShape}) vs first tensor shape (${n[0].shape})`),qs(n,0)}scatter(e,t){if(t.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${t.dtype}`);if(e.length!==t.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${t.shape[0]}`);const n=Math.max(...e);if(!this.dynamicSize&&n>=this.maxSize)throw new Error(`Max index must be < array size (${n}  vs. ${this.maxSize})`);this.writeMany(e,Lu(t,0))}split(e,t){if(t.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${t.dtype}`);let n=0;const s=e.map(l=>(n+=l,n));if(n!==t.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${n}, and tensor's shape is: ${t.shape}`);if(!this.dynamicSize&&e.length!==this.maxSize)throw new Error(`TensorArray's size is not equal to the size of lengths (${this.maxSize} vs. ${e.length}), and the TensorArray is not marked as dynamically resizeable`);const o=n===0?0:t.size/n,a=[];Vt(()=>{t=bt(t,[1,n,o]);for(let l=0;l<e.length;++l){const u=l===0?0:s[l-1],h=[0,u,0],d=[1,e[l],o];a[l]=bt(Tr(t,h,d),this.elementShape)}return a});const i=[];for(let l=0;l<e.length;l++)i[l]=l;this.writeMany(i,a)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Fd{constructor(e,t,n,s=-1){this.tensors=e,this.elementShape=t,this.elementDtype=n,e!=null&&e.forEach(o=>{if(n!==o.dtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${o.dtype}`);Di(t,o.shape,"TensorList shape mismatch: "),za(o)}),this.idTensor=Nn(0),this.maxNumElements=s,za(this.idTensor)}get id(){return this.idTensor.id}copy(){return new Fd([...this.tensors],this.elementShape,this.elementDtype)}clearAndClose(e){this.tensors.forEach(t=>{(e==null||!e.has(t.id))&&t.dispose()}),this.tensors.length=0,this.idTensor.dispose()}size(){return this.tensors.length}stack(e,t,n=-1){if(t!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t}, but list elements ${this.elementDtype}`);if(n!==-1&&this.tensors.length!==n)throw new Error(`Operation expected a list with ${n} elements but got a list with ${this.tensors.length} elements.`);Di(e,this.elementShape,"TensorList shape mismatch: ");const s=rf(this.elementShape,this.tensors,e);return Vt(()=>{const o=this.tensors.map(a=>bt(a,s));return sl(o,0)})}popBack(e,t){if(t!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t}, but list elements ${this.elementDtype}`);if(this.size()===0)throw new Error("Trying to pop from an empty list.");const n=rf(this.elementShape,this.tensors,e),s=this.tensors.pop();return Di(s.shape,e,"TensorList shape mismatch: "),bt(s,n)}pushBack(e){if(e.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e.dtype}, but list elements ${this.elementDtype}`);if(Di(e.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");za(e),this.tensors.push(e)}resize(e){if(e<0)throw new Error(`TensorListResize expects size to be non-negative. Got: ${e}`);if(this.maxNumElements!==-1&&e>this.maxNumElements)throw new Error(`TensorListResize input size ${e} is greater maxNumElement ${this.maxNumElements}.`);this.tensors.length=e}getItem(e,t,n){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);if(e<0||e>this.tensors.length)throw new Error(`Trying to access element ${e} in a list with ${this.tensors.length} elements.`);if(this.tensors[e]==null)throw new Error(`element at index ${e} is null.`);Di(this.tensors[e].shape,t,"TensorList shape mismatch: ");const s=rf(this.elementShape,this.tensors,t);return bt(this.tensors[e],s)}setItem(e,t){if(t.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t.dtype}, but list elements ${this.elementDtype}`);if(e<0||this.maxNumElements!==-1&&e>=this.maxNumElements)throw new Error(`Trying to set element ${e} in a list with max ${this.maxNumElements} elements.`);Di(this.elementShape,t.shape,"TensorList shape mismatch: "),za(t),this.tensors[e]=t}gather(e,t,n){if(t!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t}, but list elements ${this.elementDtype}`);Di(this.elementShape,n,"TensorList shape mismatch: "),e=e.slice(0,this.size());const s=rf(this.elementShape,this.tensors,n);return e.length===0?Ui([],[0].concat(s)):Vt(()=>{const o=e.map(a=>bt(this.tensors[a],s));return sl(o,0)})}concat(e,t){if(!!e&&e!==this.elementDtype)throw new Error(`TensorList dtype is ${this.elementDtype} but concat requested dtype ${e}`);Di(this.elementShape,t,"TensorList shape mismatch: ");const n=rf(this.elementShape,this.tensors,t);return this.size()===0?Ui([],[0].concat(n)):Vt(()=>{const s=this.tensors.map(o=>bt(o,n));return qs(s,0)})}}function zSe(r,e,t){const n=r.dtype;if(r.shape.length<1)throw new Error(`Tensor must be at least a vector, but saw shape: ${r.shape}`);if(r.dtype!==t)throw new Error(`Invalid data types; op elements ${r.dtype}, but list elements ${t}`);const s=r.shape.slice(1);Di(s,e,"TensorList shape mismatch: ");const o=Lu(r);return new Fd(o,e,n)}function VSe(r,e,t){return new Fd([],r,e,t)}function GSe(r,e,t,n){if(e.length!==r.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${r.shape[0]}`);const s=Math.max(...e);if(n!=null&&n!==-1&&s>=n)throw new Error(`Max index must be < array size (${s}  vs. ${n})`);const o=new Fd([],t,r.dtype,n),a=Lu(r,0);return e.forEach((i,l)=>{o.setItem(i,a[l])}),o}function WSe(r,e,t){let n=0;const s=e.map(h=>(n+=h,n));if(n!==r.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${n}, and tensor's shape is: ${r.shape}`);const o=r.shape.slice(1),a=Mx(o,t),i=n===0?0:r.size/n,l=Vt(()=>{const h=[];r=bt(r,[1,n,i]);for(let d=0;d<e.length;++d){const c=d===0?0:s[d-1],f=[0,c,0],p=[1,e[d],i];h[d]=bt(Tr(r,f,p),a)}return r.dispose(),h}),u=new Fd([],t,r.dtype,e.length);for(let h=0;h<l.length;h++)u.setItem(h,l[h]);return u}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HSe=async(r,e,t)=>{switch(r.op){case"If":case"StatelessIf":{const n=X("thenBranch",r,e,t),s=X("elseBranch",r,e,t),o=X("cond",r,e,t),a=X("args",r,e,t);return(await o.data())[0]?t.functionMap[n].executeFunctionAsync(a,t.tensorArrayMap,t.tensorListMap):t.functionMap[s].executeFunctionAsync(a,t.tensorArrayMap,t.tensorListMap)}case"While":case"StatelessWhile":{const n=X("body",r,e,t),s=X("cond",r,e,t),o=X("args",r,e,t),a=await t.functionMap[s].executeFunctionAsync(o,t.tensorArrayMap,t.tensorListMap),i=o.map(h=>h.id);let l=await a[0].data();a.forEach(h=>{!h.kept&&i.indexOf(h.id)===-1&&h.dispose()});let u=o;for(;l[0];){const h=u;u=await t.functionMap[n].executeFunctionAsync(u,t.tensorArrayMap,t.tensorListMap);const d=u.map(f=>f.id);h.forEach(f=>{!f.kept&&i.indexOf(f.id)===-1&&d.indexOf(f.id)===-1&&f.dispose()});const c=await t.functionMap[s].executeFunctionAsync(u,t.tensorArrayMap,t.tensorListMap);l=await c[0].data(),c.forEach(f=>{!f.kept&&i.indexOf(f.id)===-1&&d.indexOf(f.id)===-1&&f.dispose()})}return u}case"LoopCond":{const n=X("pred",r,e,t);return[wl(n)]}case"Switch":{const n=X("pred",r,e,t);let s=X("data",r,e,t);return s.kept||(s=wl(s)),(await n.data())[0]?[void 0,s]:[s,void 0]}case"Merge":{const n=r.inputNames.find(s=>oo(s,e,t)!==void 0);if(n){const s=oo(n,e,t);return[wl(s)]}return}case"Enter":{const n=X("frameName",r,e,t),s=X("tensor",r,e,t);return t.enterFrame(n),[wl(s)]}case"Exit":{const n=X("tensor",r,e,t);return t.exitFrame(),[wl(n)]}case"NextIteration":{const n=X("tensor",r,e,t);return t.nextIteration(),[wl(n)]}case"TensorArrayV3":{const n=X("size",r,e,t),s=X("dtype",r,e,t),o=X("elementShape",r,e,t),a=X("dynamicSize",r,e,t),i=X("clearAfterRead",r,e,t),l=X("identicalElementShapes",r,e,t),u=X("name",r,e,t),h=new USe(u,s,n,o,l,a,i);return t.addTensorArray(h),[h.idTensor,Nn(1)]}case"TensorArrayWriteV3":{const n=X("tensorArrayId",r,e,t),s=X("index",r,e,t),o=X("tensor",r,e,t),a=t.getTensorArray(n.id);return a.write(s,o),[a.idTensor]}case"TensorArrayReadV3":{const n=X("tensorArrayId",r,e,t),s=X("index",r,e,t);return[t.getTensorArray(n.id).read(s)]}case"TensorArrayGatherV3":{const n=X("tensorArrayId",r,e,t),s=X("indices",r,e,t),o=X("dtype",r,e,t);return[t.getTensorArray(n.id).gather(s,o)]}case"TensorArrayScatterV3":{const n=X("tensorArrayId",r,e,t),s=X("indices",r,e,t),o=X("tensor",r,e,t),a=t.getTensorArray(n.id);return a.scatter(s,o),[a.idTensor]}case"TensorArrayConcatV3":{const n=X("tensorArrayId",r,e,t),s=t.getTensorArray(n.id),o=X("dtype",r,e,t);return[s.concat(o)]}case"TensorArraySplitV3":{const n=X("tensorArrayId",r,e,t),s=X("tensor",r,e,t),o=X("lengths",r,e,t),a=t.getTensorArray(n.id);return a.split(o,s),[a.idTensor]}case"TensorArraySizeV3":{const n=X("tensorArrayId",r,e,t),s=t.getTensorArray(n.id);return[Nn(s.size(),"int32")]}case"TensorArrayCloseV3":{const n=X("tensorArrayId",r,e,t),s=t.getTensorArray(n.id);return s.clearAndClose(),[s.idTensor]}case"TensorListSetItem":{const n=X("tensorListId",r,e,t),s=X("index",r,e,t),o=X("tensor",r,e,t),a=t.getTensorList(n.id);return a.setItem(s,o),[a.idTensor]}case"TensorListGetItem":{const n=X("tensorListId",r,e,t),s=X("index",r,e,t),o=X("elementShape",r,e,t),a=X("elementDType",r,e,t);return[t.getTensorList(n.id).getItem(s,o,a)]}case"TensorListScatterV2":case"TensorListScatter":{const n=X("indices",r,e,t),s=X("tensor",r,e,t),o=X("elementShape",r,e,t),a=X("numElements",r,e,t),i=GSe(s,n,o,a);return t.addTensorList(i),[i.idTensor]}case"TensorListReserve":case"EmptyTensorList":{const n=X("elementShape",r,e,t),s=X("elementDType",r,e,t);let o;r.op==="TensorListReserve"?o="numElements":o="maxNumElements";const a=X(o,r,e,t),i=VSe(n,s,a);return t.addTensorList(i),[i.idTensor]}case"TensorListGather":{const n=X("tensorListId",r,e,t),s=X("indices",r,e,t),o=X("elementShape",r,e,t),a=X("elementDType",r,e,t);return[t.getTensorList(n.id).gather(s,a,o)]}case"TensorListStack":{const n=X("tensorListId",r,e,t),s=X("elementShape",r,e,t),o=X("elementDType",r,e,t),a=X("numElements",r,e,t);return[t.getTensorList(n.id).stack(s,o,a)]}case"TensorListFromTensor":{const n=X("tensor",r,e,t),s=X("elementShape",r,e,t),o=X("elementDType",r,e,t),a=zSe(n,s,o);return t.addTensorList(a),[a.idTensor]}case"TensorListConcat":{const n=X("tensorListId",r,e,t),s=t.getTensorList(n.id),o=X("dtype",r,e,t),a=X("elementShape",r,e,t);return[s.concat(o,a)]}case"TensorListPushBack":{const n=X("tensorListId",r,e,t),s=X("tensor",r,e,t),o=t.getTensorList(n.id);return o.pushBack(s),[o.idTensor]}case"TensorListPopBack":{const n=X("tensorListId",r,e,t),s=X("elementShape",r,e,t),o=X("elementDType",r,e,t);return[t.getTensorList(n.id).popBack(s,o)]}case"TensorListSplit":{const n=X("tensor",r,e,t),s=X("elementShape",r,e,t),o=X("lengths",r,e,t),a=WSe(n,o,s);return t.addTensorList(a),[a.idTensor]}default:throw TypeError(`Node type ${r.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CE(r,e,t){const[n,s]=X("fusedOps",r,e,t),o=n==="biasadd",a=!o,i=s==="prelu",l=n==="fusedbatchnorm",u=X("numArgs",r,e,t);if(o){if(i&&u!==2)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!i&&o&&u!==1)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(l)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");const h=X("strides",r,e,t),d=Kg(r,e,t),c=X("dataFormat",r,e,t).toUpperCase(),f=X("dilations",r,e,t);let[p,m]=X("args",r,e,t);a&&(m=p,p=void 0);const g=X("leakyreluAlpha",r,e,t);return{stride:h,pad:d,dataFormat:c,dilations:f,biasArg:p,preluArg:m,activationFunc:s,leakyreluAlpha:g}}const qSe=(r,e,t)=>{switch(r.op){case"Conv1D":{const n=X("stride",r,e,t),s=X("pad",r,e,t),o=X("dataFormat",r,e,t).toUpperCase(),a=X("dilation",r,e,t);return[PL(X("x",r,e,t),X("filter",r,e,t),n,s,o,a)]}case"Conv2D":{const n=X("strides",r,e,t),s=Kg(r,e,t),o=X("dataFormat",r,e,t).toUpperCase(),a=X("dilations",r,e,t);return[km(X("x",r,e,t),X("filter",r,e,t),[n[1],n[2]],s,o,[a[1],a[2]])]}case"_FusedConv2D":{const{stride:n,pad:s,dataFormat:o,dilations:a,biasArg:i,preluArg:l,activationFunc:u,leakyreluAlpha:h}=CE(r,e,t);return[LP({x:X("x",r,e,t),filter:X("filter",r,e,t),strides:[n[1],n[2]],pad:s,dataFormat:o,dilations:[a[1],a[2]],bias:i,activation:u,preluActivationWeights:l,leakyreluAlpha:h})]}case"FusedDepthwiseConv2dNative":{const{stride:n,pad:s,dataFormat:o,dilations:a,biasArg:i,preluArg:l,activationFunc:u,leakyreluAlpha:h}=CE(r,e,t);return[PP({x:X("x",r,e,t),filter:X("filter",r,e,t),strides:[n[1],n[2]],pad:s,dataFormat:o,dilations:[a[1],a[2]],bias:i,activation:u,preluActivationWeights:l,leakyreluAlpha:h})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{const n=X("outputShape",r,e,t),s=X("strides",r,e,t),o=Kg(r,e,t);return[BL(X("x",r,e,t),X("filter",r,e,t),n,[s[1],s[2]],o)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{const n=X("strides",r,e,t),s=Kg(r,e,t),o=X("dilations",r,e,t),a=X("dataFormat",r,e,t).toUpperCase();return[T1(X("input",r,e,t),X("filter",r,e,t),[n[1],n[2]],s,a,[o[1],o[2]])]}case"Conv3D":{const n=X("strides",r,e,t),s=X("pad",r,e,t),o=X("dataFormat",r,e,t).toUpperCase(),a=X("dilations",r,e,t);return[UL(X("x",r,e,t),X("filter",r,e,t),[n[1],n[2],n[3]],s,o,[a[1],a[2],a[3]])]}case"AvgPool":{const n=X("strides",r,e,t),s=X("pad",r,e,t),o=X("kernelSize",r,e,t);return[t_(X("x",r,e,t),[o[1],o[2]],[n[1],n[2]],s)]}case"MaxPool":{const n=X("strides",r,e,t),s=X("pad",r,e,t),o=X("kernelSize",r,e,t);return[f_(X("x",r,e,t),[o[1],o[2]],[n[1],n[2]],s)]}case"MaxPoolWithArgmax":{const n=X("strides",r,e,t),s=X("pad",r,e,t),o=X("kernelSize",r,e,t),a=X("includeBatchInIndex",r,e,t),{result:i,indexes:l}=lP(X("x",r,e,t),[o[1],o[2]],[n[1],n[2]],s,a);return[i,l]}case"AvgPool3D":{const n=X("strides",r,e,t),s=X("pad",r,e,t),o=X("kernelSize",r,e,t);return[OL(X("x",r,e,t),[o[1],o[2],o[3]],[n[1],n[2],n[3]],s)]}case"MaxPool3D":{const n=X("strides",r,e,t),s=X("pad",r,e,t),o=X("kernelSize",r,e,t);return[aP(X("x",r,e,t),[o[1],o[2],o[3]],[n[1],n[2],n[3]],s)]}case"Dilation2D":{const n=X("strides",r,e,t),s=X("pad",r,e,t),o=X("dilations",r,e,t),a=n[1],i=n[2],l=o[1],u=o[2];return[qL(X("x",r,e,t),X("filter",r,e,t),[a,i],s,[l,u],"NHWC")]}default:throw TypeError(`Node type ${r.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XSe=(r,e,t)=>{switch(r.op){case"Fill":{const n=X("shape",r,e,t),s=X("dtype",r,e,t),o=X("value",r,e,t);return[Im(n,o,s)]}case"LinSpace":{const n=X("start",r,e,t),s=X("stop",r,e,t),o=X("num",r,e,t);return[tP(n,s,o)]}case"Multinomial":{const n=X("logits",r,e,t),s=X("numSamples",r,e,t),o=X("seed",r,e,t);return[cP(n,s,o)]}case"OneHot":{const n=X("indices",r,e,t),s=X("depth",r,e,t),o=X("onValue",r,e,t),a=X("offValue",r,e,t);return[fd(n,s,o,a)]}case"Ones":return[lu(X("shape",r,e,t),X("dtype",r,e,t))];case"OnesLike":return[hP(X("x",r,e,t))];case"RandomUniform":return[T_(X("shape",r,e,t),X("minval",r,e,t),X("maxval",r,e,t),X("dtype",r,e,t))];case"Range":{const n=X("start",r,e,t),s=X("stop",r,e,t),o=X("step",r,e,t);return[nl(n,s,o,X("dtype",r,e,t))]}case"TruncatedNormal":{const n=X("shape",r,e,t),s=X("mean",r,e,t),o=X("stdDev",r,e,t),a=X("seed",r,e,t);return[AP(n,s,o,X("dtype",r,e,t),a)]}case"Zeros":return[qc(X("shape",r,e,t),X("dtype",r,e,t))];case"ZerosLike":return[jo(X("x",r,e,t))];default:throw TypeError(`Node type ${r.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ob(r,e,t){const n=X("boxes",r,e,t),s=X("scores",r,e,t),o=X("maxOutputSize",r,e,t),a=X("iouThreshold",r,e,t),i=X("scoreThreshold",r,e,t),l=X("softNmsSigma",r,e,t);return{boxes:n,scores:s,maxOutputSize:o,iouThreshold:a,scoreThreshold:i,softNmsSigma:l}}const KSe=async(r,e,t)=>{switch(r.op){case"NonMaxSuppressionV5":{const{boxes:n,scores:s,maxOutputSize:o,iouThreshold:a,scoreThreshold:i,softNmsSigma:l}=ob(r,e,t),u=await wo.nonMaxSuppressionWithScoreAsync(n,s,o,a,i,l);return[u.selectedIndices,u.selectedScores]}case"NonMaxSuppressionV4":{const{boxes:n,scores:s,maxOutputSize:o,iouThreshold:a,scoreThreshold:i}=ob(r,e,t),l=X("padToMaxOutputSize",r,e,t),u=await wo.nonMaxSuppressionPaddedAsync(n,s,o,a,i,l);return[u.selectedIndices,u.validOutputs]}case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{const{boxes:n,scores:s,maxOutputSize:o,iouThreshold:a,scoreThreshold:i}=ob(r,e,t);return[await wo.nonMaxSuppressionAsync(n,s,o,a,i)]}case"Where":{const n=zn(X("condition",r,e,t),"bool"),s=[await $_(n)];return n.dispose(),s}case"ListDiff":return SP(X("x",r,e,t),X("y",r,e,t));default:throw TypeError(`Node type ${r.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YSe=(r,e,t)=>{switch(r.op){case"TopKV2":{const n=X("x",r,e,t),s=X("k",r,e,t),o=X("sorted",r,e,t),a=NP(n,s,o);return[a.values,a.indices]}case"Unique":{const n=X("x",r,e,t),s=Tx(n);return[s.values,s.indices]}case"UniqueV2":{const n=X("x",r,e,t),s=X("axis",r,e,t),o=Tx(n,s);return[o.values,o.indices]}default:throw TypeError(`Node type ${r.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZSe=(r,e,t)=>{switch(r.op){case"Const":return e[r.name];case"PlaceholderWithDefault":const n=X("default",r,e,t);return[oo(r.name,e,t)||n];case"Placeholder":return[oo(r.name,e,t)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":{const u=X("x",r,e,t);return[wl(u)]}case"IdentityN":return X("x",r,e,t).map(u=>wl(u));case"Snapshot":const s=X("x",r,e,t);return[wl(s)];case"Shape":return[di(X("x",r,e,t).shape,"int32")];case"ShapeN":return X("x",r,e,t).map(u=>di(u.shape));case"Size":return[Nn(X("x",r,e,t).size,"int32")];case"Rank":return[Nn(X("x",r,e,t).rank,"int32")];case"NoOp":return[Nn(1)];case"Print":const o=X("x",r,e,t),a=X("data",r,e,t),i=X("message",r,e,t),l=X("summarize",r,e,t);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(i);for(let u=0;u<a.length;u++)console.log(Array.prototype.slice.call(a[u].dataSync()).slice(0,l));return[o];default:throw TypeError(`Node type ${r.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class QSe{constructor(e,t){this.keyDType=e,this.valueDType=t,this.handle=Nn(0),this.tensorMap=new Map,za(this.handle)}get id(){return this.handle.id}clearAndClose(){this.tensorMap.forEach(e=>e.dispose()),this.tensorMap.clear(),this.handle.dispose()}size(){return this.tensorMap.size}tensorSize(){return Nn(this.size(),"int32")}async import(e,t){this.checkKeyAndValueTensor(e,t);const n=await e.data();return this.tensorMap.forEach(s=>s.dispose()),this.tensorMap.clear(),Vt(()=>{const s=Lu(t),o=n.length,a=s.length;Te(o===a,()=>`The number of elements doesn't match, keys has ${o} elements, the values has ${a} elements.`);for(let i=0;i<o;i++){const l=n[i],u=s[i];za(u),this.tensorMap.set(l,u)}return this.handle})}async find(e,t){this.checkKeyAndValueTensor(e,t);const n=await e.data();return Vt(()=>{const s=[];for(let o=0;o<n.length;o++){const a=n[o],i=this.findWithDefault(a,t);s.push(i)}return sl(s)})}findWithDefault(e,t){const n=this.tensorMap.get(e);return n!=null?n:t}checkKeyAndValueTensor(e,t){if(e.dtype!==this.keyDType)throw new Error(`Expect key dtype ${this.keyDType}, but got ${e.dtype}`);if(t.dtype!==this.valueDType)throw new Error(`Expect value dtype ${this.valueDType}, but got ${t.dtype}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JSe=async(r,e,t,n)=>{switch(r.op){case"HashTable":case"HashTableV2":{const s=X("keyDType",r,e,t),o=X("valueDType",r,e,t),a=new QSe(s,o);return n.addHashTable(r.name,a),[a.handle]}case"LookupTableImport":case"LookupTableImportV2":{const s=X("tableHandle",r,e,t,n),o=X("keys",r,e,t),a=X("values",r,e,t);return[await n.getHashTableById(s.id).import(o,a)]}case"LookupTableFind":case"LookupTableFindV2":{const s=X("tableHandle",r,e,t,n),o=X("keys",r,e,t),a=X("defaultValue",r,e,t);return[await n.getHashTableById(s.id).find(o,a)]}case"LookupTableSize":case"LookupTableSizeV2":{const s=X("tableHandle",r,e,t,n);return[n.getHashTableById(s.id).tensorSize()]}default:throw TypeError(`Node type ${r.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const e_e=(r,e,t)=>{switch(r.op){case"ResizeBilinear":{const n=X("images",r,e,t),s=X("size",r,e,t),o=X("alignCorners",r,e,t),a=X("halfPixelCenters",r,e,t);return[wo.resizeBilinear(n,[s[0],s[1]],o,a)]}case"ResizeNearestNeighbor":{const n=X("images",r,e,t),s=X("size",r,e,t),o=X("alignCorners",r,e,t),a=X("halfPixelCenters",r,e,t);return[wo.resizeNearestNeighbor(n,[s[0],s[1]],o,a)]}case"CropAndResize":{const n=X("image",r,e,t),s=X("boxes",r,e,t),o=X("boxInd",r,e,t),a=X("cropSize",r,e,t),i=X("method",r,e,t),l=X("extrapolationValue",r,e,t);return[wo.cropAndResize(n,s,o,a,i,l)]}default:throw TypeError(`Node type ${r.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const t_e=(r,e,t)=>{switch(r.op){case"Equal":return[rh(X("a",r,e,t),X("b",r,e,t))];case"NotEqual":return[y_(X("a",r,e,t),X("b",r,e,t))];case"Greater":return[sh(X("a",r,e,t),X("b",r,e,t))];case"GreaterEqual":return[i_(X("a",r,e,t),X("b",r,e,t))];case"Less":return[eP(X("a",r,e,t),X("b",r,e,t))];case"LessEqual":return[I1(X("a",r,e,t),X("b",r,e,t))];case"LogicalAnd":return[Vf(X("a",r,e,t),X("b",r,e,t))];case"LogicalNot":return[h_(X("a",r,e,t))];case"LogicalOr":return[d_(X("a",r,e,t),X("b",r,e,t))];case"Select":case"SelectV2":return[Hc(X("condition",r,e,t),X("a",r,e,t),X("b",r,e,t))];default:throw TypeError(`Node type ${r.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n_e=(r,e,t)=>{switch(r.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[or(X("a",r,e,t),X("b",r,e,t),X("transposeA",r,e,t),X("transposeB",r,e,t))];case"Einsum":return[KL(X("equation",r,e,t),...X("tensors",r,e,t))];case"Transpose":return[Uf(X("x",r,e,t),X("perm",r,e,t))];case"_FusedMatMul":const[n,s]=X("fusedOps",r,e,t),o=n==="biasadd",a=s==="prelu",i=X("numArgs",r,e,t),l=X("leakyreluAlpha",r,e,t);if(o){if(a&&i!==2)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!a&&i!==1)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}const[u,h]=X("args",r,e,t);return[jP({a:X("a",r,e,t),b:X("b",r,e,t),transposeA:X("transposeA",r,e,t),transposeB:X("transposeB",r,e,t),bias:u,activation:s,preluActivationWeights:h,leakyreluAlpha:l})];default:throw TypeError(`Node type ${r.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const r_e=(r,e,t)=>{switch(r.op){case"FusedBatchNorm":case"FusedBatchNormV2":return[pd(X("x",r,e,t),X("mean",r,e,t),X("variance",r,e,t),X("offset",r,e,t),X("scale",r,e,t),X("epsilon",r,e,t))];case"FusedBatchNormV3":return[pd(X("x",r,e,t),X("mean",r,e,t),X("variance",r,e,t),X("offset",r,e,t),X("scale",r,e,t),X("epsilon",r,e,t))];case"LRN":return[nP(X("x",r,e,t),X("radius",r,e,t),X("bias",r,e,t),X("alpha",r,e,t),X("beta",r,e,t))];case"Softmax":return[IP(X("x",r,e,t))];case"LogSoftmax":return[sP(X("x",r,e,t))];case"SparseToDense":return[A_(X("sparseIndices",r,e,t),X("outputShape",r,e,t),X("sparseValues",r,e,t),X("defaultValue",r,e,t))];default:throw TypeError(`Node type ${r.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s_e=(r,e,t)=>{switch(r.op){case"Max":{const a=X("axis",r,e,t),i=X("keepDims",r,e,t);return[Cc(X("x",r,e,t),a,i)]}case"Mean":{const a=X("axis",r,e,t),i=X("keepDims",r,e,t);return[Gf(X("x",r,e,t),a,i)]}case"Min":{const a=X("axis",r,e,t),i=X("keepDims",r,e,t);return[Oy(X("x",r,e,t),a,i)]}case"Sum":{const a=X("axis",r,e,t),i=X("keepDims",r,e,t);return[Nr(X("x",r,e,t),a,i)]}case"All":{const a=X("axis",r,e,t),i=X("keepDims",r,e,t);return[_L(X("x",r,e,t),a,i)]}case"Any":{const a=X("axis",r,e,t),i=X("keepDims",r,e,t);return[TL(X("x",r,e,t),a,i)]}case"ArgMax":{const a=X("axis",r,e,t);return[_1(X("x",r,e,t),a)]}case"ArgMin":{const a=X("axis",r,e,t);return[kL(X("x",r,e,t),a)]}case"Prod":{const a=X("axis",r,e,t),i=X("keepDims",r,e,t);return[w_(X("x",r,e,t),a,i)]}case"Cumsum":{const a=X("axis",r,e,t),i=X("exclusive",r,e,t),l=X("reverse",r,e,t);return[GL(X("x",r,e,t),a,i,l)]}case"Bincount":const n=X("x",r,e,t),s=X("weights",r,e,t),o=X("size",r,e,t);return[r_(n,s,o)];case"DenseBincount":{const a=X("x",r,e,t),i=X("weights",r,e,t),l=X("size",r,e,t),u=X("binaryOutput",r,e,t);return[WL(a,i,l,u)]}default:throw TypeError(`Node type ${r.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const o_e=(r,e,t)=>{switch(r.op){case"ConcatV2":case"Concat":{const n=X("n",r,e,t),s=X("axis",r,e,t);let o=X("tensors",r,e,t);return o=o.slice(0,n),[qs(o,s)]}case"Gather":{const n=X("x",r,e,t),s=X("indices",r,e,t);return[Dy(n,zn(s,"int32"),0)]}case"GatherV2":{const n=X("axis",r,e,t),s=X("batchDims",r,e,t),o=X("x",r,e,t),a=X("indices",r,e,t);return[Dy(o,zn(a,"int32"),n,s)]}case"Reverse":{const n=X("dims",r,e,t),s=[];for(let a=0;a<n.length;a++)n[a]&&s.push(a);const o=X("x",r,e,t);return[Nl(o,s)]}case"ReverseV2":{const n=X("axis",r,e,t),s=X("x",r,e,t);return[Nl(s,n)]}case"Slice":{const n=X("begin",r,e,t),s=X("size",r,e,t);return[Tr(X("x",r,e,t),n,s)]}case"StridedSlice":{const n=X("begin",r,e,t),s=X("end",r,e,t),o=X("strides",r,e,t),a=X("beginMask",r,e,t),i=X("endMask",r,e,t),l=X("ellipsisMask",r,e,t),u=X("newAxisMask",r,e,t),h=X("shrinkAxisMask",r,e,t),d=X("x",r,e,t);return[CP(d,n,s,o,a,i,l,u,h)]}case"Pack":return Vt(()=>{const n=X("axis",r,e,t),s=X("tensors",r,e,t),o=s[0].shape,a=cs(s[0]).shape,i=s.map(l=>{const u=Ja(l.shape,o);if(!u&&!Ja(cs(l).shape,a))throw new Error("the input tensors shape does not match");return u?l:bt(l,o)});return[sl(i,n)]});case"Unpack":{const n=X("axis",r,e,t),s=X("tensor",r,e,t);return Lu(s,n)}case"Tile":{const n=X("reps",r,e,t);return[Hh(X("x",r,e,t),n)]}case"Split":case"SplitV":{const n=X("axis",r,e,t),s=X("numOrSizeSplits",r,e,t),o=X("x",r,e,t);return yd(o,s,n)}case"ScatterNd":{const n=X("indices",r,e,t),s=X("values",r,e,t),o=X("shape",r,e,t);return[OP(n,s,o)]}case"GatherNd":{const n=X("x",r,e,t),s=X("indices",r,e,t);return[MP(n,s)]}case"SparseToDense":{const n=X("sparseIndices",r,e,t),s=X("outputShape",r,e,t),o=X("sparseValues",r,e,t),a=X("defaultValue",r,e,t);return[A_(n,o,s,o.dtype===a.dtype?a:zn(a,o.dtype))]}default:throw TypeError(`Node type ${r.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i_e=(r,e,t)=>{switch(r.op){case"SparseFillEmptyRows":{const{outputIndices:n,outputValues:s,emptyRowIndicator:o,reverseIndexMap:a}=gf.sparseFillEmptyRows(X("indices",r,e,t),X("values",r,e,t),X("denseShape",r,e,t),X("defaultValue",r,e,t));return[n,s,o,a]}case"SparseReshape":{const{outputIndices:n,outputShape:s}=gf.sparseReshape(X("inputIndices",r,e,t),X("inputShape",r,e,t),X("newShape",r,e,t));return[n,s]}case"SparseSegmentMean":return[gf.sparseSegmentMean(X("data",r,e,t),X("indices",r,e,t),X("segmentIds",r,e,t))];case"SparseSegmentSum":return[gf.sparseSegmentSum(X("data",r,e,t),X("indices",r,e,t),X("segmentIds",r,e,t))];default:throw TypeError(`Node type ${r.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a_e=(r,e,t)=>{switch(r.op){case"FFT":return[C1(X("x",r,e,t))];case"IFFT":return[Hf(X("x",r,e,t))];case"RFFT":return[$1(X("x",r,e,t))];case"IRFFT":return[E_(X("x",r,e,t))];default:throw TypeError(`Node type ${r.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const l_e=(r,e,t)=>{switch(r.op){case"StringNGrams":{const{nGrams:n,nGramsSplits:s}=Xg.stringNGrams(X("data",r,e,t),X("dataSplits",r,e,t),X("separator",r,e,t),X("nGramWidths",r,e,t),X("leftPad",r,e,t),X("rightPad",r,e,t),X("padWidth",r,e,t),X("preserveShortSequences",r,e,t));return[n,s]}case"StringSplit":{const{indices:n,values:s,shape:o}=Xg.stringSplit(X("input",r,e,t),X("delimiter",r,e,t),X("skipEmpty",r,e,t));return[n,s,o]}case"StringToHashBucketFast":return[Xg.stringToHashBucketFast(X("input",r,e,t),X("numBuckets",r,e,t))];default:throw TypeError(`Node type ${r.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const u_e=(r,e,t)=>{switch(r.op){case"Cast":return[zn(X("x",r,e,t),X("dtype",r,e,t))];case"ExpandDims":{const n=X("axis",r,e,t);return[Rs(X("x",r,e,t),n)]}case"Squeeze":{const n=X("axis",r,e,t);return[cs(X("x",r,e,t),n)]}case"Reshape":return[bt(X("x",r,e,t),X("shape",r,e,t))];case"MirrorPad":return[g_(X("x",r,e,t),X("padding",r,e,t),X("mode",r,e,t))];case"PadV2":case"Pad":return[oh(X("x",r,e,t),X("padding",r,e,t),X("constantValue",r,e,t))];case"SpaceToBatchND":{const n=X("blockShape",r,e,t),s=X("paddings",r,e,t);return[b_(X("x",r,e,t),n,s)]}case"BatchToSpaceND":{const n=X("blockShape",r,e,t),s=X("crops",r,e,t);return[n_(X("x",r,e,t),n,s)]}case"DepthToSpace":{const n=X("blockSize",r,e,t),s=X("dataFormat",r,e,t).toUpperCase();return[HL(X("x",r,e,t),n,s)]}case"BroadcastTo":return[kf(X("x",r,e,t),X("shape",r,e,t))];case"BroadcastArgs":return[ML(X("s0",r,e,t),X("s1",r,e,t))];default:throw TypeError(`Node type ${r.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $E(r,e,t,n){const s=((o,a,i)=>{switch(o.category){case"arithmetic":return Vt(()=>jSe(o,a,i));case"basic_math":return Vt(()=>BSe(o,a,i));case"control":return HSe(o,a,i);case"convolution":return Vt(()=>qSe(o,a,i));case"creation":return Vt(()=>XSe(o,a,i));case"dynamic":return KSe(o,a,i);case"evaluation":return Vt(()=>YSe(o,a,i));case"image":return Vt(()=>e_e(o,a,i));case"graph":return Vt(()=>ZSe(o,a,i));case"logical":return Vt(()=>t_e(o,a,i));case"matrices":return Vt(()=>n_e(o,a,i));case"normalization":return Vt(()=>r_e(o,a,i));case"reduction":return Vt(()=>s_e(o,a,i));case"slice_join":return Vt(()=>o_e(o,a,i));case"sparse":return Vt(()=>i_e(o,a,i));case"spectral":return Vt(()=>a_e(o,a,i));case"string":return Vt(()=>l_e(o,a,i));case"transformation":return Vt(()=>u_e(o,a,i));case"hash_table":return JSe(o,a,i,n);case"custom":const l=WP(o.op);if(l&&l.customExecutor)return l.customExecutor(new PSe(o,a,i));throw TypeError(`Custom op ${o.op} is not registered.`);default:throw TypeError(`Unknown op '${o.op}'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()`)}})(r,e,t);return cd(s)?s.then(o=>[].concat(o)):[].concat(s)}class NE{constructor(e={},t={},n={},s={}){this.weightMap=e,this.tensorArrayMap=t,this.tensorListMap=n,this.functionMap=s,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(e,t){return{id:e,frameName:t,iterationId:0}}set currentContext(e){this.contexts!==e&&(this.contexts=e,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){const e=[];for(let t=0;t<this.contexts.length-1;t++){const n=this.contexts.slice(0,this.contexts.length-t);e.push(this.contextIdforContexts(n))}e.push(""),this._currentContextIds=e}contextIdforContexts(e){return e?e.map(t=>t.id===0&&t.iterationId===0?"":`${t.frameName}-${t.iterationId}`).join("/"):""}enterFrame(e){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,e)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(this.contexts&&this.contexts.length>1)this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift();else throw new Error("Cannot exit frame, the context is empty")}nextIteration(){if(this.contexts&&this.contexts.length>0){this.contexts=this.contexts.slice(),this.lastId++;const e=Object.assign({},this.contexts[this.contexts.length-1]);e.iterationId+=1,e.id=this.lastId,this.contexts.splice(-1,1,e),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}else throw new Error("Cannot increase frame iteration, the context is empty")}getWeight(e){return this.weightMap[e]}addTensorArray(e){this.tensorArrayMap[e.id]=e}getTensorArray(e){return this.tensorArrayMap[e]}addTensorList(e){this.tensorListMap[e.id]=e}getTensorList(e){return this.tensorListMap[e]}dispose(e){for(const t in this.tensorArrayMap)this.tensorArrayMap[t].clearAndClose(e);for(const t in this.tensorListMap)this.tensorListMap[t].clearAndClose(e)}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AE(r,e,t,n){const s=new Set,o=[];let a=null,i=null;const l=new Set,u=Object.keys(r).map(c=>Do(c)[0]);let h=[];n!=null&&(h=n.map(c=>Do(c.name)[0]));const d=[...e];for(;d.length>0;){const c=d.pop();if((XP(c)||p_e(c)||m_e(c))&&a==null&&(a=c,i=a.children.map(f=>f.name).filter(f=>s.has(f))),s.add(c.name),t[c.name]==null&&u.indexOf(c.name)===-1&&h.indexOf(c.name)===-1){if(c.inputs.length===0){o.push(c.name);continue}c.inputs.forEach(f=>{l.has(f.name)||(l.add(f.name),d.push(f))})}}return{inputs:r,outputs:e,usedNodes:s,missingInputs:o,dynamicNode:a,syncInputs:i}}function c_e(r,e,t){const{usedNodes:n,inputs:s}=t,o=[],a=Object.keys(s).map(h=>Do(h)[0]).map(h=>r.nodes[h]),i=r.initNodes;a.forEach(h=>{n.has(h.name)&&o.push(h)}),r.weights.forEach(h=>{n.has(h.name)&&o.push(h)}),i!=null&&i.forEach(h=>{n.has(h.name)&&o.push(h)});const l=new Set,u=[];for(;o.length>0;){const h=o.pop();l.add(h.name),e[h.name]||u.push(h),h.children.forEach(d=>{!l.has(d.name)&&n.has(d.name)&&d.inputs.every(c=>l.has(c.name))&&o.push(d)})}return u}const h_e=["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"],d_e=["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"],f_e=["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"];function XP(r){return h_e.indexOf(r.op)>=0}function p_e(r){return d_e.indexOf(r.op)>=0}function m_e(r){return f_e.indexOf(r.op)>=0}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Fy{constructor(e,t){this.graph=e,this.parent=t,this.compiledMap=new Map,this._weightMap={},this.SEPERATOR=",",this._functions={},this._functionExecutorMap={},this.intermediateTensors={},this.keepTensorForDebug=!1,this._outputs=e.outputs,this._inputs=e.inputs,this._initNodes=e.initNodes,this._signature=e.signature,this._functions=e.functions,e.functions!=null&&Object.keys(e.functions).forEach(n=>{this._functionExecutorMap[n]=new Fy(e.functions[n],this)})}get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(e){const t=Object.keys(e).map(n=>e[n].map(s=>s.id));this._weightIds=[].concat(...t),this._weightMap=e}set resourceManager(e){this._resourceManager=e}get inputs(){return this._inputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get outputs(){return this._outputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get inputNodes(){return this._inputs.map(e=>e.signatureKey||e.name)}get outputNodes(){return this._outputs.map(e=>{const t=e.signatureKey||e.name;return e.defaultOutput?`${t}:${e.defaultOutput}`:t})}get functions(){return Object.keys(this._functions).reduce((e,t)=>(e[t]=this._functions[t].signature,e),{})}getCompilationKey(e,t){const n=e.map(o=>o.name).sort(),s=t.map(o=>o.name).sort();return n.join(this.SEPERATOR)+"--"+s.join(this.SEPERATOR)}compile(e,t){const n=AE(e,t,this.weightMap,this._initNodes),{missingInputs:s,dynamicNode:o,syncInputs:a}=n;if(o!=null)throw new Error(`This execution contains the node '${o.name}', which has the dynamic op '${o.op}'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs [${a}]`);if(s.length>0){const i=t.map(u=>u.name),l=Object.keys(e);throw new Error(`Cannot compute the outputs [${i}] from the provided inputs [${l}]. Missing the following inputs: [${s}]`)}return c_e(this.graph,this.weightMap,n)}execute(e,t){e=this.mapInputs(e);const n=Object.keys(e).sort();this.checkInputs(e),this.checkInputShapeAndType(e),t=this.mapOutputs(t),this.checkOutputs(t);const s=n.map(d=>this.graph.nodes[Do(d)[0]]),o=t.map(d=>Do(d)[0]);let a=o.map(d=>this.graph.nodes[d]);this.resetIntermediateTensors(),a.length===0&&(a=this._outputs);const i=this.getCompilationKey(s,a);let l=this.compiledMap.get(i);l==null&&(l=this.compile(e,a),this.compiledMap.set(i,l));const u={},h={};return Vt(()=>{const d=new NE(this.weightMap,u,h,this.functionExecutorMap),c=Object.assign({},this.weightMap);Object.keys(e).forEach(m=>{const[g,y]=Do(m),v=[];v[y]=e[m],c[g]=v});const f=this.getFrozenTensorIds(c),p={};for(let m=0;m<l.length;m++){const g=l[m];if(!c[g.name]){const y=$E(g,c,d,this._resourceManager);if(cd(y))throw new Error(`The execution of the op '${g.op}' returned a promise. Please use model.executeAsync() instead.`);c[g.name]=y,this.checkTensorForDisposal(g.name,g,c,d,f,o,p)}}return this.parent==null&&d.dispose(f),t.map(m=>oo(m,c,d))})}getFrozenTensorIds(e){const t=[].concat.apply([],Object.keys(e).map(n=>e[n]).map(n=>n.map(s=>s.id)));return new Set(t)}checkTensorForDisposal(e,t,n,s,o,a,i){t.category==="control"||a.indexOf(e)!==-1||(n[e].forEach(l=>{l!=null&&(i[l.id]=(i[l.id]||0)+t.children.length)}),t.inputs.forEach(l=>{if(l.category!=="control"){const u=Q2e(l.name,n,s);u!=null&&u.forEach(h=>{if(h&&!h.kept&&!o.has(h.id)){const d=i[h.id];if(d===1){if(!this.keepTensorForDebug)h.dispose();else{const[c,f]=Ba(t.name,s);this.intermediateTensors[c]?this.intermediateTensors[c][f]=h:(this.intermediateTensors[c]=[],this.intermediateTensors[c][f]=h)}delete i[h.id]}else d!=null&&i[h.id]--}})}}))}async executeAsync(e,t){return this._executeAsync(e,t)}disposeIntermediateTensors(){!this.intermediateTensors||(Object.keys(this.intermediateTensors).forEach(e=>this.intermediateTensors[e].forEach(t=>t.dispose())),this.disposeTensorsMap())}disposeTensorsMap(){!this.tensorsMap||Object.keys(this.tensorsMap).forEach(e=>{this.tensorsMap[e].forEach(n=>{n&&!n.kept&&!n.isDisposed&&!this.keepIds.has(n.id)&&n.dispose()})})}getIntermediateTensors(){return this.tensorsMap}resetIntermediateTensors(){for(const e in this.intermediateTensors)this.intermediateTensors[e].forEach(t=>t.dispose()),delete this.intermediateTensors[e]}async _executeAsync(e,t,n=!1,s={},o={}){n||(e=this.mapInputs(e),this.checkInputs(e),this.checkInputShapeAndType(e),t=this.mapOutputs(t),this.checkOutputs(t));try{this.keepTensorForDebug=Pn().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(h){console.warn(h.message)}this.resetIntermediateTensors();const a=new NE(this.weightMap,s,o,this.functionExecutorMap);this.tensorsMap=await this.executeWithControlFlow(e,a,t,n);const i=t.map(h=>oo(h,this.tensorsMap,a)),l=i.map(h=>h.id),u=Object.keys(e).map(h=>e[h].id);return this.keepIds=new Set([...l,...u,...this.weightIds]),this.keepTensorForDebug||this.disposeTensorsMap(),this.parent==null&&a.dispose(this.keepIds),i}async executeFunctionAsync(e,t,n){const s=e.reduce((o,a,i)=>(o[this.inputs[i].name]=a,o),{});return this._executeAsync(s,this.outputNodes,!0,t,n)}async executeWithControlFlow(e,t,n,s){const o=Object.keys(e),a=o.map(b=>this.graph.nodes[Do(b)[0]]),i=n.map(b=>Do(b)[0]);let l=i.map(b=>this.graph.nodes[b]);l.length===0&&(l=this._outputs);const{usedNodes:u,missingInputs:h,dynamicNode:d,syncInputs:c}=AE(e,l,this.weightMap,this._initNodes),f=[...a,...this.graph.weights,...this._initNodes||[]].map(b=>({node:b,contexts:t.currentContext})),p=Object.assign({},this.weightMap);Object.keys(e).forEach(b=>{const[w,_]=Do(b),I=[];I[_]=e[b],p[w]=I});const m={},g=this.getFrozenTensorIds(p),y={};for(;f.length>0;){const b=this.processStack(a,f,t,p,y,g,i,m,u);await Promise.all(b)}d==null&&!s&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");const v=l.filter(b=>!XP(b)&&!oo(b.name,p,t)).map(b=>b.name);if(v.length>0){let b="";throw d!=null&&(b=`Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs [${c}]`),new Error(`Cannot compute the outputs [${v}] from the provided inputs [${o}]. Consider providing the following inputs: [${h}]. ${b}`)}return p}processStack(e,t,n,s,o,a,i,l,u){const h=[];for(;t.length>0;){const d=t.pop();n.currentContext=d.contexts;let c="";if(d.node.op==="Enter"&&X("isConstant",d.node,s,n)&&([c]=Ba(d.node.name,n)),s[d.node.name]==null){const f=$E(d.node,s,n,this._resourceManager);c||([c]=Ba(d.node.name,n));const p=n.currentContext;cd(f)?h.push(f.then(m=>(s[c]=m,n.currentContext=p,this.checkTensorForDisposal(c,d.node,s,n,a,i,l),this.processChildNodes(d.node,t,n,s,o,u),m))):(s[c]=f,this.checkTensorForDisposal(c,d.node,s,n,a,i,l),this.processChildNodes(d.node,t,n,s,o,u))}else this.processChildNodes(d.node,t,n,s,o,u)}return h}processChildNodes(e,t,n,s,o,a){e.children.forEach(i=>{const[l]=Ba(i.name,n);o[l]||!a.has(i.name)||(i.op==="Merge"?i.inputNames.some(u=>!!oo(u,s,n))&&(o[l]=!0,t.push({contexts:n.currentContext,node:i})):i.inputNames.every(u=>!!oo(u,s,n))&&(o[l]=!0,t.push({contexts:n.currentContext,node:i})))})}dispose(){Object.keys(this.weightMap).forEach(e=>this.weightMap[e].forEach(t=>t.dispose()))}checkInputShapeAndType(e){Object.keys(e).forEach(t=>{const n=e[t],[s]=Do(t),o=this.graph.nodes[s];if(o.attrParams.shape&&o.attrParams.shape.value){const a=o.attrParams.shape.value,i=a.length===n.shape.length&&n.shape.every((l,u)=>a[u]===-1||a[u]===l);Te(i,()=>`The shape of dict['${o.name}'] provided in model.execute(dict) must be [${a}], but was [${n.shape}]`)}o.attrParams.dtype&&o.attrParams.dtype.value&&Te(n.dtype===o.attrParams.dtype.value,()=>`The dtype of dict['${o.name}'] provided in model.execute(dict) must be ${o.attrParams.dtype.value}, but was ${n.dtype}`)})}mapInputs(e){const t={};for(const n in e)if(this._signature!=null&&this._signature.inputs!=null&&this._signature.inputs[n]!=null){const s=this._signature.inputs[n];t[s.name]=e[n]}else t[n]=e[n];return t}checkInputs(e){const t=Object.keys(e).filter(n=>{const[s]=Do(n);return this.graph.nodes[s]==null});if(t.length>0)throw new Error(`The dict provided in model.execute(dict) has keys: [${t}] that are not part of graph`)}mapOutputs(e){return e.map(t=>this._signature!=null&&this._signature.outputs!=null&&this._signature.outputs[t]!=null?this._signature.outputs[t].name:t,{})}checkOutputs(e){e.forEach(t=>{const[n]=Do(t);if(!this.graph.nodes[n])throw new Error(`The output '${t}' is not found in the graph`)})}}class g_e{constructor(e={},t={}){this.hashTableNameToHandle=e,this.hashTableMap=t}addHashTable(e,t){this.hashTableNameToHandle[e]=t.handle,this.hashTableMap[t.id]=t}getHashTableHandleByName(e){return this.hashTableNameToHandle[e]}getHashTableById(e){return this.hashTableMap[e]}dispose(){for(const e in this.hashTableMap)this.hashTableMap[e].clearAndClose(),delete this.hashTableMap[e];for(const e in this.hashTableNameToHandle)this.hashTableNameToHandle[e].dispose(),delete this.hashTableNameToHandle[e]}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const y_e="?tfjs-format=file",v_e="model.json";class b_e{constructor(e,t={}){this.modelUrl=e,this.loadOptions=t,this.version="n/a",t==null&&(this.loadOptions={}),this.resourceManager=new g_e}get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}get metadata(){return this.artifacts.userDefinedMetadata}get modelSignature(){return this.signature}findIOHandler(){const e=this.modelUrl;if(e.load!=null)this.handler=e;else if(this.loadOptions.requestInit!=null)this.handler=xx(e,this.loadOptions);else{const t=WF(e,this.loadOptions);if(t.length===0)t.push(xx(e,this.loadOptions));else if(t.length>1)throw new Error(`Found more than one (${t.length}) load handlers for URL '${[e]}'`);this.handler=t[0]}}async load(){if(this.findIOHandler(),this.handler.load==null)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const e=await this.handler.load();return this.loadSync(e)}loadSync(e){this.artifacts=e;const t=this.artifacts.modelTopology;let n;this.artifacts.userDefinedMetadata!=null&&this.artifacts.userDefinedMetadata.signature!=null?n=this.artifacts.userDefinedMetadata.signature:n=this.artifacts.signature,this.signature=n,this.version=`${t.versions.producer}.${t.versions.minConsumer}`;const s=BS(this.artifacts.weightData,this.artifacts.weightSpecs);if(this.executor=new Fy(kE.Instance.transformGraph(t,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(s),this.executor.resourceManager=this.resourceManager,e.modelInitializer!=null&&e.modelInitializer.node!=null){const o=kE.Instance.transformGraph(e.modelInitializer);this.initializer=new Fy(o),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializer.executeAsync({},[])}return!0}async save(e,t){if(typeof e=="string"){const n=GF(e);if(n.length===0)throw new Error(`Cannot find any save handlers for URL '${e}'`);if(n.length>1)throw new Error(`Found more than one (${n.length}) save handlers for URL '${e}'`);e=n[0]}if(e.save==null)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return e.save(this.artifacts)}predict(e,t){return this.execute(e,this.outputNodes)}normalizeInputs(e){if(!(e instanceof pr)&&!Array.isArray(e))return e;if(e=Array.isArray(e)?e:[e],e.length!==this.inputNodes.length)throw new Error(`Input tensor count mismatch,the graph model has ${this.inputNodes.length} placeholders, while there are ${e.length} input tensors.`);return this.inputNodes.reduce((t,n,s)=>(t[n]=e[s],t),{})}normalizeOutputs(e){return e=e||this.outputNodes,Array.isArray(e)?e:[e]}execute(e,t){e=this.normalizeInputs(e),t=this.normalizeOutputs(t);const n=this.executor.execute(e,t);return n.length>1?n:n[0]}async executeAsync(e,t){e=this.normalizeInputs(e),t=this.normalizeOutputs(t);const n=await this.executor.executeAsync(e,t);return n.length>1?n:n[0]}getIntermediateTensors(){return this.executor.getIntermediateTensors()}disposeIntermediateTensors(){this.executor.disposeIntermediateTensors()}convertTensorMapToTensorsMap(e){return Object.keys(e).reduce((t,n)=>(t[n]=[e[n]],t),{})}dispose(){this.executor.dispose(),this.initializer&&this.initializer.dispose(),this.resourceManager.dispose()}}async function Nm(r,e={}){if(r==null)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");e==null&&(e={}),e.fromTFHub&&r.load==null&&(r.endsWith("/")||(r=r+"/"),r=`${r}${v_e}${y_e}`);const t=new b_e(r,e);return await t.load(),t}/**
    * @license
    * Copyright 2021 Google LLC. All Rights Reserved.
    * Licensed under the Apache License, Version 2.0 (the "License");
    * you may not use this file except in compliance with the License.
    * You may obtain a copy of the License at
    *
    * http://www.apache.org/licenses/LICENSE-2.0
    *
    * Unless required by applicable law or agreed to in writing, software
    * distributed under the License is distributed on an "AS IS" BASIS,
    * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    * See the License for the specific language governing permissions and
    * limitations under the License.
    * =============================================================================
    */var KP=function(r,e){return(KP=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var s in n)n.hasOwnProperty(s)&&(t[s]=n[s])})(r,e)};function YP(r,e){function t(){this.constructor=r}KP(r,e),r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var bl=function(){return(bl=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++)for(var s in e=arguments[t])Object.prototype.hasOwnProperty.call(e,s)&&(r[s]=e[s]);return r}).apply(this,arguments)};function Va(r,e,t,n){return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(h){o(h)}}function i(u){try{l(n.throw(u))}catch(h){o(h)}}function l(u){var h;u.done?s(u.value):(h=u.value,h instanceof t?h:new t(function(d){d(h)})).then(a,i)}l((n=n.apply(r,e||[])).next())})}function Ga(r,e){var t,n,s,o,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function i(l){return function(u){return function(h){if(t)throw new TypeError("Generator is already executing.");for(;a;)try{if(t=1,n&&(s=2&h[0]?n.return:h[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,h[1])).done)return s;switch(n=0,s&&(h=[2&h[0],s.value]),h[0]){case 0:case 1:s=h;break;case 4:return a.label++,{value:h[1],done:!1};case 5:a.label++,n=h[1],h=[0];continue;case 7:h=a.ops.pop(),a.trys.pop();continue;default:if(!(s=(s=a.trys).length>0&&s[s.length-1])&&(h[0]===6||h[0]===2)){a=0;continue}if(h[0]===3&&(!s||h[1]>s[0]&&h[1]<s[3])){a.label=h[1];break}if(h[0]===6&&a.label<s[1]){a.label=s[1],s=h;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(h);break}s[2]&&a.ops.pop(),a.trys.pop();continue}h=e.call(r,a)}catch(d){h=[6,d],n=0}finally{t=s=0}if(5&h[0])throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}([l,u])}}}function ZP(r){var e=r.shape[2],t=_1(r,2),n=bt(t,[-1]);return fd(n,e)}function x_e(r,e){return Ut(r,e)}function Tg(r,e){return Vt(function(){return zn(sh(r,Nn(e)),"int32")})}function w_e(r,e){var t=e.shape,n=t[0],s=t[1],o=t[2];return Vt(function(){var a=ZP(e),i=Rs(nl(0,o,1,"int32"),1),l=zn(or(a,i),"int32"),u=bt(l,[n,s]),h=xn(u,Nn(1,"int32"));return Rn(x_e(h,r),Nn(1,"int32"))})}function S_e(r){var e=r.shape,t=e[0],n=e[1],s=e[2];return Vt(function(){var o=ZP(r),a=Rs(nl(0,s,1,"int32"),1),i=zn(or(o,a),"int32");return bt(i,[t,n])})}var QP=function(){function r(e,t){this.model=e,this.outputStride=t;var n=this.model.inputs[0].shape;Te(n[1]===-1&&n[2]===-1,function(){return"Input shape ["+n[1]+", "+n[2]+"] must both be equal to or -1"})}return r.prototype.predict=function(e){var t=this;return Vt(function(){var n=t.preprocessInput(zn(e,"float32")),s=Rs(n,0),o=t.model.predict(s).map(function(i){return cs(i,[0])}),a=t.nameOutputResults(o);return{heatmapScores:zi(a.heatmap),offsets:a.offsets,displacementFwd:a.displacementFwd,displacementBwd:a.displacementBwd,segmentation:a.segmentation,partHeatmaps:a.partHeatmaps,longOffsets:a.longOffsets,partOffsets:a.partOffsets}})},r.prototype.dispose=function(){this.model.dispose()},r}(),__e=function(r){function e(){return r!==null&&r.apply(this,arguments)||this}return YP(e,r),e.prototype.preprocessInput=function(t){return Vt(function(){return Rn(kr(t,127.5),1)})},e.prototype.nameOutputResults=function(t){return{offsets:t[0],segmentation:t[1],partHeatmaps:t[2],longOffsets:t[3],heatmap:t[4],displacementFwd:t[5],displacementBwd:t[6],partOffsets:t[7]}},e}(QP),U1=["nose","leftEye","rightEye","leftEar","rightEar","leftShoulder","rightShoulder","leftElbow","rightElbow","leftWrist","rightWrist","leftHip","rightHip","leftKnee","rightKnee","leftAnkle","rightAnkle"],ca=U1.length,Ly=U1.reduce(function(r,e,t){return r[e]=t,r},{}),T_e=[["leftHip","leftShoulder"],["leftElbow","leftShoulder"],["leftElbow","leftWrist"],["leftHip","leftKnee"],["leftKnee","leftAnkle"],["rightHip","rightShoulder"],["rightElbow","rightShoulder"],["rightElbow","rightWrist"],["rightHip","rightKnee"],["rightKnee","rightAnkle"],["leftShoulder","rightShoulder"],["leftHip","rightHip"]],k_e=[["nose","leftEye"],["leftEye","leftEar"],["nose","rightEye"],["rightEye","rightEar"],["nose","leftShoulder"],["leftShoulder","leftElbow"],["leftElbow","leftWrist"],["leftShoulder","leftHip"],["leftHip","leftKnee"],["leftKnee","leftAnkle"],["nose","rightShoulder"],["rightShoulder","rightElbow"],["rightElbow","rightWrist"],["rightShoulder","rightHip"],["rightHip","rightKnee"],["rightKnee","rightAnkle"]];T_e.map(function(r){var e=r[0],t=r[1];return[Ly[e],Ly[t]]});function F_(r,e,t){var n=r[0],s=r[1],o=e[0],a=e[1],i=t.top,l=t.bottom;return[a/(t.left+t.right+s),o/(i+l+n)]}function JP(r,e,t,n){return{y:n.get(r,e,t),x:n.get(r,e,t+ca)}}function e4(r,e,t){var n=JP(r.heatmapY,r.heatmapX,r.id,t),s=n.y,o=n.x;return{x:r.heatmapX*e+o,y:r.heatmapY*e+s}}function RE(r,e,t){return r<e?e:r>t?t:r}function I_e(r,e,t,n){var s=t-r,o=n-e;return s*s+o*o}function DE(r,e){return{x:r.x+e.x,y:r.y+e.y}}function E_e(r,e,t){t===void 0&&(t=.3);for(var n=0,s=0,o=0;o<r.length;o++)e.keypoints[o].score>t&&(s+=1,n+=Math.pow(r[o].x-e.keypoints[o].position.x,2)+Math.pow(r[o].y-e.keypoints[o].position.y,2));return s===0?n=1/0:n/=s,n}function C_e(r,e,t,n){var s=e[0],o=e[1],a=t[0],i=t[1],l=Math.round(((s+r.y+1)*i-1)/n);return{x:Math.round(((o+r.x+1)*a-1)/n),y:l}}function $_e(r,e,t,n,s,o,a){for(var i=a[0],l=a[1],u=t(r),h=u.y*n+u.x,d=s[ca*(2*h)+e],c=s[ca*(2*h+1)+e],f=r.y+d,p=r.x+c,m=0;m<o;m++){f=Math.min(f,i-1);var g=t({x:p=Math.min(p,l-1),y:f}),y=g.y*n+g.x;f+=d=s[ca*(2*y)+e],p+=c=s[ca*(2*y+1)+e]}return{x:p,y:f}}function t4(r,e,t,n,s,o,a,i,l,u){for(var h=s[0],d=s[1],c=o[0],f=o[1],p=i[0],m=i[1],g=[],y=function(N){return C_e(N,[h,d],[c,f],l)},v=0;v<n;v++){var b=$_e(r,v,y,a,e,u,[p,m]);g.push(b)}for(var w=-1,_=1/0,I=0;I<t.length;I++){var C=E_e(g,t[I]);C<_&&(w=I,_=C)}return w}function n4(r,e){var t=r[0],n=r[1];return[Math.round((n-1)/e+1),Math.round((t-1)/e+1)]}function N_e(r,e,t,n,s,o,a,i,l,u){var h=a[0],d=a[1];u===void 0&&(u=5);for(var c=t.map(function(C){return new Uint8Array(n*s).fill(0)}),f=i.top,p=i.left,m=F_([n,s],[h,d],i),g=m[0],y=m[1],v=n4([h,d],o)[0],b=0;b<n;b+=1)for(var w=0;w<s;w+=1){var _=b*s+w;if(r[_]===1){var I=t4({x:w,y:b},e,t,u,[f,p],[g,y],v,[n,s],o,l);I>=0&&(c[I][_]=1)}}return c}function A_e(r,e,t,n,s,o,a,i,l,u,h){var d=i[0],c=i[1];h===void 0&&(h=5);for(var f=n.map(function(N){return new Int32Array(s*o).fill(-1)}),p=l.top,m=l.left,g=F_([s,o],[d,c],l),y=g[0],v=g[1],b=n4([d,c],a)[0],w=0;w<s;w+=1)for(var _=0;_<o;_+=1){var I=w*o+_;if(r[I]===1){var C=t4({x:_,y:w},e,n,h,[p,m],[y,v],b,[s,o],a,u);C>=0&&(f[C][I]=t[I])}}return f}function r4(r,e,t,n,s,o,a,i,l,u,h){for(var d=a[0],c=a[1],f=r.shape,p=f[0],m=f[1],g=e.shape.slice(0,2),y=g[0],v=g[1],b=bt(e,[y,v,2,ca]),w=new Float32Array(h*ca*3).fill(0),_=0;_<t.length;_++)for(var I=_*ca*3,C=t[_],N=0;N<ca;N++){var O=C.keypoints[N],D=I+3*N;w[D]=O.score,w[D+1]=O.position.y,w[D+2]=O.position.x}var M=F_([n,s],[d,c],i),P=M[0],F=M[1],B=Ui(w,[h,ca,3]),z=i.top,Z=i.left,Q={variableNames:["segmentation","longOffsets","poses"],outputShape:[p,m],userCode:`
    int convertToPositionInOutput(int pos, int pad, float scale, int stride) {
      return round(((float(pos + pad) + 1.0) * scale - 1.0) / float(stride));
    }

    float convertToPositionInOutputFloat(
        int pos, int pad, float scale, int stride) {
      return ((float(pos + pad) + 1.0) * scale - 1.0) / float(stride);
    }

    float dist(float x1, float y1, float x2, float y2) {
      return pow(x1 - x2, 2.0) + pow(y1 - y2, 2.0);
    }

    float sampleLongOffsets(float h, float w, int d, int k) {
      float fh = fract(h);
      float fw = fract(w);
      int clH = int(ceil(h));
      int clW = int(ceil(w));
      int flH = int(floor(h));
      int flW = int(floor(w));
      float o11 = getLongOffsets(flH, flW, d, k);
      float o12 = getLongOffsets(flH, clW, d, k);
      float o21 = getLongOffsets(clH, flW, d, k);
      float o22 = getLongOffsets(clH, clW, d, k);
      float o1 = mix(o11, o12, fw);
      float o2 = mix(o21, o22, fw);
      return mix(o1, o2, fh);
    }

    int findNearestPose(int h, int w) {
      float prob = getSegmentation(h, w);
      if (prob < 1.0) {
        return -1;
      }

      // Done(Tyler): convert from output space h/w to strided space.
      float stridedH = convertToPositionInOutputFloat(
        h, `+z+", "+F+", "+o+`);
      float stridedW = convertToPositionInOutputFloat(
        w, `+Z+", "+P+", "+o+`);

      float minDist = 1000000.0;
      int iMin = -1;
      for (int i = 0; i < `+h+`; i++) {
        float curDistSum = 0.0;
        int numKpt = 0;
        for (int k = 0; k < `+ca+`; k++) {
          float dy = sampleLongOffsets(stridedH, stridedW, 0, k);
          float dx = sampleLongOffsets(stridedH, stridedW, 1, k);

          float y = float(h) + dy;
          float x = float(w) + dx;

          for (int s = 0; s < `+l+`; s++) {
            int yRounded = round(min(y, float(`+(n-1)+`)));
            int xRounded = round(min(x, float(`+(s-1)+`)));

            float yStrided = convertToPositionInOutputFloat(
              yRounded, `+z+", "+F+", "+o+`);
            float xStrided = convertToPositionInOutputFloat(
              xRounded, `+Z+", "+P+", "+o+`);

            float dy = sampleLongOffsets(yStrided, xStrided, 0, k);
            float dx = sampleLongOffsets(yStrided, xStrided, 1, k);

            y = y + dy;
            x = x + dx;
          }

          float poseScore = getPoses(i, k, 0);
          float poseY = getPoses(i, k, 1);
          float poseX = getPoses(i, k, 2);
          if (poseScore > `+u+`) {
            numKpt = numKpt + 1;
            curDistSum = curDistSum + dist(x, y, poseX, poseY);
          }
        }
        if (numKpt > 0 && curDistSum / float(numKpt) < minDist) {
          minDist = curDistSum / float(numKpt);
          iMin = i;
        }
      }
      return iMin;
    }

    void main() {
        ivec2 coords = getOutputCoords();
        int nearestPose = findNearestPose(coords[0], coords[1]);
        setOutput(float(nearestPose));
      }
  `};return QS().compileAndRun(Q,[r,b,B])}function R_e(r,e){return Vt(function(){return zn(rh(r,Nn(e)),"int32")})}function D_e(r,e,t){return Vt(function(){return Rn(Ut(zn(rh(r,Nn(t)),"int32"),xn(e,1)),1)})}function s4(){return ZS()==="webgl"}function O_e(r,e,t,n,s,o,a,i,l,u,h,d){var c=a[0],f=a[1];return l===void 0&&(l=.2),u===void 0&&(u=8),h===void 0&&(h=.3),d===void 0&&(d=10),Va(this,void 0,void 0,function(){var p,m,g,y,v;return Ga(this,function(b){switch(b.label){case 0:return p=t.filter(function(w){return w.score>=l}),s4()?(g=Vt(function(){var w=r4(r,e,p,n,s,o,[c,f],i,u,h,d),_=_m().makeTensorFromDataId(w.dataId,w.shape,w.dtype);return p.map(function(I,C){return R_e(_,C)})}),[4,Promise.all(g.map(function(w){return w.data()}))]):[3,2];case 1:return m=b.sent(),g.forEach(function(w){return w.dispose()}),[3,5];case 2:return[4,r.data()];case 3:return y=b.sent(),[4,e.data()];case 4:v=b.sent(),m=N_e(y,v,p,n,s,o,[c,f],i,u),b.label=5;case 5:return[2,m.map(function(w,_){return{data:w,pose:p[_],width:s,height:n}})]}})})}function M_e(r,e,t,n,s,o,a,i,l,u,h,d,c){var f=i[0],p=i[1];return u===void 0&&(u=.2),h===void 0&&(h=8),d===void 0&&(d=.3),c===void 0&&(c=10),Va(this,void 0,void 0,function(){var m,g,y,v,b,w;return Ga(this,function(_){switch(_.label){case 0:return m=n.filter(function(I){return I.score>=u}),s4()?(y=Vt(function(){var I=r4(r,e,m,s,o,a,[f,p],l,h,d,c),C=_m().makeTensorFromDataId(I.dataId,I.shape,I.dtype);return m.map(function(N,O){return D_e(C,t,O)})}),[4,Promise.all(y.map(function(I){return I.data()}))]):[3,2];case 1:return g=_.sent(),y.forEach(function(I){return I.dispose()}),[3,6];case 2:return[4,r.data()];case 3:return v=_.sent(),[4,e.data()];case 4:return b=_.sent(),[4,t.data()];case 5:w=_.sent(),g=A_e(v,b,w,m,s,o,a,[f,p],l,h),_.label=6;case 6:return[2,g.map(function(I,C){return{pose:m[C],data:I,height:s,width:o}})]}})})}function ib(r){return Math.floor(r/2)}var F_e=function(){function r(e,t){this.priorityQueue=new Array(e),this.numberOfElements=-1,this.getElementValue=t}return r.prototype.enqueue=function(e){this.priorityQueue[++this.numberOfElements]=e,this.swim(this.numberOfElements)},r.prototype.dequeue=function(){var e=this.priorityQueue[0];return this.exchange(0,this.numberOfElements--),this.sink(0),this.priorityQueue[this.numberOfElements+1]=null,e},r.prototype.empty=function(){return this.numberOfElements===-1},r.prototype.size=function(){return this.numberOfElements+1},r.prototype.all=function(){return this.priorityQueue.slice(0,this.numberOfElements+1)},r.prototype.max=function(){return this.priorityQueue[0]},r.prototype.swim=function(e){for(;e>0&&this.less(ib(e),e);)this.exchange(e,ib(e)),e=ib(e)},r.prototype.sink=function(e){for(;2*e<=this.numberOfElements;){var t=2*e;if(t<this.numberOfElements&&this.less(t,t+1)&&t++,!this.less(e,t))break;this.exchange(e,t),e=t}},r.prototype.getValueAt=function(e){return this.getElementValue(this.priorityQueue[e])},r.prototype.less=function(e,t){return this.getValueAt(e)<this.getValueAt(t)},r.prototype.exchange=function(e,t){var n=this.priorityQueue[e];this.priorityQueue[e]=this.priorityQueue[t],this.priorityQueue[t]=n},r}();function L_e(r,e,t,n,s,o){for(var a=o.shape,i=a[0],l=a[1],u=!0,h=Math.max(t-s,0),d=Math.min(t+s+1,i),c=h;c<d;++c){for(var f=Math.max(n-s,0),p=Math.min(n+s+1,l),m=f;m<p;++m)if(o.get(c,m,r)>e){u=!1;break}if(!u)break}return u}function P_e(r,e,t){for(var n=t.shape,s=n[0],o=n[1],a=n[2],i=new F_e(s*o*a,function(c){return c.score}),l=0;l<s;++l)for(var u=0;u<o;++u)for(var h=0;h<a;++h){var d=t.get(l,u,h);d<r||L_e(h,d,l,u,e,t)&&i.enqueue({score:d,part:{heatmapY:l,heatmapX:u,id:h}})}return i}var o4=k_e.map(function(r){var e=r[0],t=r[1];return[Ly[e],Ly[t]]}),ab=o4.map(function(r){return r[1]}),OE=o4.map(function(r){return r[0]});function j_e(r,e,t){var n=t.shape[2]/2;return{y:t.get(e.y,e.x,r),x:t.get(e.y,e.x,n+r)}}function lb(r,e,t,n){return{y:RE(Math.round(r.y/e),0,t-1),x:RE(Math.round(r.x/e),0,n-1)}}function ME(r,e,t,n,s,o,a,i){i===void 0&&(i=2);for(var l=n.shape,u=l[0],h=l[1],d=j_e(r,lb(e.position,o,u,h),a),c=DE(e.position,d),f=0;f<i;f++){var p=lb(c,o,u,h),m=JP(p.y,p.x,t,s);c=DE({x:p.x*o,y:p.y*o},{x:m.x,y:m.y})}var g=lb(c,o,u,h),y=n.get(g.y,g.x,t);return{position:c,part:U1[t],score:y}}function B_e(r,e,t,n,s,o){var a=e.shape[2],i=ab.length,l=new Array(a),u=r.part,h=r.score,d=e4(u,n,t);l[u.id]={score:h,part:U1[u.id],position:d};for(var c=i-1;c>=0;--c){var f=ab[c],p=OE[c];l[f]&&!l[p]&&(l[p]=ME(c,l[f],p,e,t,n,o))}for(c=0;c<i;++c)f=OE[c],p=ab[c],l[f]&&!l[p]&&(l[p]=ME(c,l[f],p,e,t,n,s));return l}function i4(r,e,t,n){var s=t.x,o=t.y;return r.some(function(a){var i=a.keypoints[n].position;return I_e(o,s,i.y,i.x)<=e})}function U_e(r,e,t){return t.reduce(function(n,s,o){var a=s.position,i=s.score;return i4(r,e,a,o)||(n+=i),n},0)/t.length}var z_e=1;function kg(r,e,t,n,s,o,a,i){a===void 0&&(a=.5),i===void 0&&(i=20);for(var l=[],u=P_e(a,z_e,r),h=i*i;l.length<o&&!u.empty();){var d=u.dequeue();if(!i4(l,h,e4(d.part,s,e),d.part.id)){var c=B_e(d,r,e,s,t,n),f=U_e(l,h,c);l.push({keypoints:c,score:f})}}return l}var sf,V_e=[-123.15,-115.9,-103.06],G_e=function(r){function e(){return r!==null&&r.apply(this,arguments)||this}return YP(e,r),e.prototype.preprocessInput=function(t){return xn(t,V_e)},e.prototype.nameOutputResults=function(t){var n=t[0],s=t[1],o=t[2],a=t[3],i=t[4],l=t[5];return{offsets:i,segmentation:t[6],partHeatmaps:l,longOffsets:a,heatmap:o,displacementFwd:s,displacementBwd:n,partOffsets:t[7]}},e}(QP),FE="https://storage.googleapis.com/tfjs-models/savedmodel/bodypix/resnet50/",LE="https://storage.googleapis.com/tfjs-models/savedmodel/bodypix/mobilenet/";function W_e(r,e){var t="model-stride"+r+".json";return e===4?FE+"float/"+t:FE+"quant"+e+"/"+t}function H_e(r,e,t){var n={1:"100",.75:"075",.5:"050"},s="model-stride"+r+".json";return t===4?LE+"float/"+n[e]+"/"+s:LE+"quant"+t+"/"+n[e]+"/"+s}function q_e(r){if("offsetHeight"in r&&r.offsetHeight!==0&&"offsetWidth"in r&&r.offsetWidth!==0)return[r.offsetHeight,r.offsetWidth];if(r.height!=null&&r.width!=null)return[r.height,r.width];throw new Error("HTMLImageElement must have height and width attributes set.")}function X_e(r){return r.hasAttribute("height")&&r.hasAttribute("width")?[r.height,r.width]:[r.videoHeight,r.videoWidth]}function yf(r){if(typeof HTMLCanvasElement!="undefined"&&r instanceof HTMLCanvasElement||typeof OffscreenCanvas!="undefined"&&r instanceof OffscreenCanvas||typeof HTMLImageElement!="undefined"&&r instanceof HTMLImageElement)return q_e(r);if(typeof ImageData!="undefined"&&r instanceof ImageData)return[r.height,r.width];if(typeof HTMLVideoElement!="undefined"&&r instanceof HTMLVideoElement)return X_e(r);if(r instanceof pr)return[r.shape[0],r.shape[1]];throw new Error("error: Unknown input type: "+r+".")}function K_e(r,e){return(r-1)%e==0}function PE(r,e){return K_e(r,e)?r:Math.floor(r/e)*e+1}var vf={low:"low",medium:"medium",high:"high",full:"full"},Y_e=((sf={})[vf.low]=.25,sf[vf.medium]=.5,sf[vf.high]=.75,sf[vf.full]=1,sf),jE=.1,BE=2;function Z_e(r){if(typeof r=="string"){var e=Y_e[r];return Te(typeof e=="number",function(){return"string value of inputResolution must be one of "+Object.values(vf).join(",")+" but was "+r+"."}),e}return Te(typeof r=="number"&&r<=BE&&r>=jE,function(){return"inputResolution must be a string or number between "+jE+" and "+BE+", but was "+r}),r}function Ig(r,e,t){var n=t[0],s=t[1],o=Z_e(r);return[PE(n*o,e),PE(s*o,e)]}function Q_e(r){return r instanceof pr?r:Sm(r)}function Ih(r,e,t,n,s){var o=e[0],a=e[1],i=t[0],l=t[1],u=n[0],h=u[0],d=u[1],c=n[1],f=c[0],p=c[1];return s===void 0&&(s=!1),Vt(function(){var m=wo.resizeBilinear(r,[i,l],!0);return s&&(m=zi(m)),J_e(m,[o,a],[[h,d],[f,p]])})}function J_e(r,e,t){var n=e[0],s=e[1],o=t[0],a=o[0],i=o[1],l=t[1],u=l[0],h=l[1];return Vt(function(){var d=Rs(r);return cs(wo.cropAndResize(d,[[a/(n+a+i-1),u/(s+u+h-1),(a+n-1)/(n+a+i-1),(u+s-1)/(s+u+h-1)]],[0],[n,s]),[0])})}function Eg(r,e){var t=e[0],n=e[1],s=yf(r),o=s[0],a=s[1],i=n/t,l=[0,0,0,0],u=l[0],h=l[1],d=l[2],c=l[3];return a/o<i?(u=0,h=0,d=Math.round(.5*(i*o-a)),c=Math.round(.5*(i*o-a))):(u=Math.round(.5*(1/i*a-o)),h=Math.round(.5*(1/i*a-o)),d=0,c=0),{resized:Vt(function(){var f=Q_e(r);return f=v_(f,[[u,h],[d,c],[0,0]]),wo.resizeBilinear(f,[t,n])}),padding:{top:u,left:d,right:c,bottom:h}}}function Cg(r){return Va(this,void 0,void 0,function(){return Ga(this,function(e){return[2,Promise.all(r.map(function(t){return t.buffer()}))]})})}function eTe(r,e,t,n,s){return n===void 0&&(n=0),s===void 0&&(s=0),{score:r.score,keypoints:r.keypoints.map(function(o){var a=o.score,i=o.part,l=o.position;return{score:a,part:i,position:{x:l.x*t+s,y:l.y*e+n}}})}}function tTe(r,e,t,n,s){return n===void 0&&(n=0),s===void 0&&(s=0),t===1&&e===1&&n===0&&s===0?r:r.map(function(o){return eTe(o,e,t,n,s)})}function nTe(r,e){return{score:r.score,keypoints:r.keypoints.map(function(t){var n=t.score,s=t.part,o=t.position;return{score:n,part:s,position:{x:e-1-o.x,y:o.y}}})}}function rTe(r,e){return e<=0?r:r.map(function(t){return nTe(t,e)})}function $g(r,e,t,n,s){var o=e[0],a=e[1],i=t[0],l=t[1],u=tTe(r,(o+n.top+n.bottom)/i,(a+n.left+n.right)/l,-n.top,-n.left);return s?rTe(u,a):u}var Eh=!0,Ng=!1,a4={architecture:"MobileNetV1",outputStride:16,quantBytes:4,multiplier:.75},UE=["MobileNetV1","ResNet50"],zE={MobileNetV1:[8,16,32],ResNet50:[32,16]},VE={MobileNetV1:[.5,.75,1],ResNet50:[1]},GE=[1,2,4];function sTe(r){if((r=r||a4).architecture==null&&(r.architecture="MobileNetV1"),UE.indexOf(r.architecture)<0)throw new Error("Invalid architecture "+r.architecture+". Should be one of "+UE);if(r.outputStride==null&&(r.outputStride=16),zE[r.architecture].indexOf(r.outputStride)<0)throw new Error("Invalid outputStride "+r.outputStride+". Should be one of "+zE[r.architecture]+" for architecture "+r.architecture+".");if(r.multiplier==null&&(r.multiplier=1),VE[r.architecture].indexOf(r.multiplier)<0)throw new Error("Invalid multiplier "+r.multiplier+". Should be one of "+VE[r.architecture]+" for architecture "+r.architecture+".");if(r.quantBytes==null&&(r.quantBytes=4),GE.indexOf(r.quantBytes)<0)throw new Error("Invalid quantBytes "+r.quantBytes+". Should be one of "+GE+" for architecture "+r.architecture+".");return r}var Ag={flipHorizontal:!1,internalResolution:"medium",segmentationThreshold:.7,maxDetections:10,scoreThreshold:.4,nmsRadius:20},Rg={flipHorizontal:!1,internalResolution:"medium",segmentationThreshold:.7,maxDetections:10,scoreThreshold:.4,nmsRadius:20,minKeypointScore:.3,refineSteps:10};function WE(r){var e=r.segmentationThreshold,t=r.maxDetections,n=r.scoreThreshold,s=r.nmsRadius;if(e<0||e>1)throw new Error("segmentationThreshold "+e+". Should be in range [0.0, 1.0]");if(t<=0)throw new Error("Invalid maxDetections "+t+". Should be > 0");if(n<0||n>1)throw new Error("Invalid scoreThreshold "+n+". Should be in range [0.0, 1.0]");if(s<=0)throw new Error("Invalid nmsRadius "+s+".")}function HE(r){var e=r.segmentationThreshold,t=r.maxDetections,n=r.scoreThreshold,s=r.nmsRadius,o=r.minKeypointScore,a=r.refineSteps;if(e<0||e>1)throw new Error("segmentationThreshold "+e+". Should be in range [0.0, 1.0]");if(t<=0)throw new Error("Invalid maxDetections "+t+". Should be > 0");if(n<0||n>1)throw new Error("Invalid scoreThreshold "+n+". Should be in range [0.0, 1.0]");if(s<=0)throw new Error("Invalid nmsRadius "+s+".");if(o<0||o>1)throw new Error("Invalid minKeypointScore "+o+".Should be in range [0.0, 1.0]");if(a<=0||a>20)throw new Error("Invalid refineSteps "+a+".Should be in range [1, 20]")}var l4=function(){function r(e){this.baseModel=e}return r.prototype.predictForPersonSegmentation=function(e){var t=this.baseModel.predict(e);return{segmentLogits:t.segmentation,heatmapScores:t.heatmapScores,offsets:t.offsets,displacementFwd:t.displacementFwd,displacementBwd:t.displacementBwd}},r.prototype.predictForPersonSegmentationAndPart=function(e){var t=this.baseModel.predict(e);return{segmentLogits:t.segmentation,partHeatmapLogits:t.partHeatmaps,heatmapScores:t.heatmapScores,offsets:t.offsets,displacementFwd:t.displacementFwd,displacementBwd:t.displacementBwd}},r.prototype.predictForMultiPersonInstanceSegmentationAndPart=function(e){var t=this.baseModel.predict(e);return{segmentLogits:t.segmentation,longOffsets:t.longOffsets,heatmapScores:t.heatmapScores,offsets:t.offsets,displacementFwd:t.displacementFwd,displacementBwd:t.displacementBwd,partHeatmaps:t.partHeatmaps}},r.prototype.segmentPersonActivation=function(e,t,n){var s=this;n===void 0&&(n=.5);var o=yf(e),a=o[0],i=o[1],l=Ig(t,this.baseModel.outputStride,[a,i]),u=Eg(e,l),h=u.resized,d=u.padding,c=Vt(function(){var v=s.predictForPersonSegmentation(h),b=v.segmentLogits,w=v.heatmapScores,_=v.offsets,I=v.displacementFwd,C=v.displacementBwd,N=h.shape,O=N[0],D=N[1],M=Ih(b,[a,i],[O,D],[[d.top,d.bottom],[d.left,d.right]],Eh);return{segmentation:Tg(cs(M),n),heatmapScores:w,offsets:_,displacementFwd:I,displacementBwd:C}}),f=c.segmentation,p=c.heatmapScores,m=c.offsets,g=c.displacementFwd,y=c.displacementBwd;return h.dispose(),{segmentation:f,heatmapScores:p,offsets:m,displacementFwd:g,displacementBwd:y,padding:d,internalResolutionHeightAndWidth:l}},r.prototype.segmentPerson=function(e,t){return t===void 0&&(t=Ag),Va(this,void 0,void 0,function(){var n,s,o,a,i,l,u,h,d,c,f,p,m,g,y,v,b,w;return Ga(this,function(_){switch(_.label){case 0:return WE(t=bl(bl({},Ag),t)),n=this.segmentPersonActivation(e,t.internalResolution,t.segmentationThreshold),s=n.segmentation,o=n.heatmapScores,a=n.offsets,i=n.displacementFwd,l=n.displacementBwd,u=n.padding,h=n.internalResolutionHeightAndWidth,d=s.shape,c=d[0],f=d[1],[4,s.data()];case 1:return p=_.sent(),s.dispose(),[4,Cg([o,a,i,l])];case 2:return m=_.sent(),g=m[0],y=m[1],v=m[2],b=m[3],w=$g(w=kg(g,y,v,b,this.baseModel.outputStride,t.maxDetections,t.scoreThreshold,t.nmsRadius),[c,f],h,u,Ng),o.dispose(),a.dispose(),i.dispose(),l.dispose(),[2,{height:c,width:f,data:p,allPoses:w}]}})})},r.prototype.segmentMultiPerson=function(e,t){return t===void 0&&(t=Rg),Va(this,void 0,void 0,function(){var n,s,o,a,i,l,u,h,d,c,f,p,m,g,y,v,b,w,_,I,C,N=this;return Ga(this,function(O){switch(O.label){case 0:return HE(t=bl(bl({},Rg),t)),n=yf(e),s=n[0],o=n[1],a=Ig(t.internalResolution,this.baseModel.outputStride,[s,o]),i=Eg(e,a),l=i.resized,u=i.padding,h=Vt(function(){var D,M=N.predictForMultiPersonInstanceSegmentationAndPart(l),P=M.segmentLogits,F=M.longOffsets,B=M.heatmapScores,z=M.offsets,Z=M.displacementFwd,Q=M.displacementBwd,K=Ih(P,[s,o],a,[[u.top,u.bottom],[u.left,u.right]],Eh);return D=F,{segmentation:Tg(cs(K),t.segmentationThreshold),longOffsets:D,heatmapScoresRaw:B,offsetsRaw:z,displacementFwdRaw:Z,displacementBwdRaw:Q}}),d=h.segmentation,c=h.longOffsets,f=h.heatmapScoresRaw,p=h.offsetsRaw,m=h.displacementFwdRaw,g=h.displacementBwdRaw,[4,Cg([f,p,m,g])];case 1:return y=O.sent(),v=y[0],b=y[1],w=y[2],_=y[3],I=$g(I=kg(v,b,w,_,this.baseModel.outputStride,t.maxDetections,t.scoreThreshold,t.nmsRadius),[s,o],a,u,Ng),[4,O_e(d,c,I,s,o,this.baseModel.outputStride,a,u,t.scoreThreshold,t.refineSteps,t.minKeypointScore,t.maxDetections)];case 2:return C=O.sent(),l.dispose(),d.dispose(),c.dispose(),f.dispose(),p.dispose(),m.dispose(),g.dispose(),[2,C]}})})},r.prototype.segmentPersonPartsActivation=function(e,t,n){var s=this;n===void 0&&(n=.5);var o=yf(e),a=o[0],i=o[1],l=Ig(t,this.baseModel.outputStride,[a,i]),u=Eg(e,l),h=u.resized,d=u.padding,c=Vt(function(){var v=s.predictForPersonSegmentationAndPart(h),b=v.segmentLogits,w=v.partHeatmapLogits,_=v.heatmapScores,I=v.offsets,C=v.displacementFwd,N=v.displacementBwd,O=h.shape,D=O[0],M=O[1],P=Ih(b,[a,i],[D,M],[[d.top,d.bottom],[d.left,d.right]],Eh),F=Ih(w,[a,i],[D,M],[[d.top,d.bottom],[d.left,d.right]],Eh);return{partSegmentation:w_e(Tg(cs(P),n),F),heatmapScores:_,offsets:I,displacementFwd:C,displacementBwd:N}}),f=c.partSegmentation,p=c.heatmapScores,m=c.offsets,g=c.displacementFwd,y=c.displacementBwd;return h.dispose(),{partSegmentation:f,heatmapScores:p,offsets:m,displacementFwd:g,displacementBwd:y,padding:d,internalResolutionHeightAndWidth:l}},r.prototype.segmentPersonParts=function(e,t){return t===void 0&&(t=Ag),Va(this,void 0,void 0,function(){var n,s,o,a,i,l,u,h,d,c,f,p,m,g,y,v,b,w;return Ga(this,function(_){switch(_.label){case 0:return WE(t=bl(bl({},Ag),t)),n=this.segmentPersonPartsActivation(e,t.internalResolution,t.segmentationThreshold),s=n.partSegmentation,o=n.heatmapScores,a=n.offsets,i=n.displacementFwd,l=n.displacementBwd,u=n.padding,h=n.internalResolutionHeightAndWidth,d=s.shape,c=d[0],f=d[1],[4,s.data()];case 1:return p=_.sent(),s.dispose(),[4,Cg([o,a,i,l])];case 2:return m=_.sent(),g=m[0],y=m[1],v=m[2],b=m[3],w=$g(w=kg(g,y,v,b,this.baseModel.outputStride,t.maxDetections,t.scoreThreshold,t.nmsRadius),[c,f],h,u,Ng),o.dispose(),a.dispose(),i.dispose(),l.dispose(),[2,{height:c,width:f,data:p,allPoses:w}]}})})},r.prototype.segmentMultiPersonParts=function(e,t){return t===void 0&&(t=Rg),Va(this,void 0,void 0,function(){var n,s,o,a,i,l,u,h,d,c,f,p,m,g,y,v,b,w,_,I,C,N,O=this;return Ga(this,function(D){switch(D.label){case 0:return HE(t=bl(bl({},Rg),t)),n=yf(e),s=n[0],o=n[1],a=Ig(t.internalResolution,this.baseModel.outputStride,[s,o]),i=Eg(e,a),l=i.resized,u=i.padding,h=Vt(function(){var M=O.predictForMultiPersonInstanceSegmentationAndPart(l),P=M.segmentLogits,F=M.longOffsets,B=M.heatmapScores,z=M.offsets,Z=M.displacementFwd,Q=M.displacementBwd,K=M.partHeatmaps,ne=Ih(P,[s,o],a,[[u.top,u.bottom],[u.left,u.right]],Eh),re=Ih(K,[s,o],a,[[u.top,u.bottom],[u.left,u.right]],Eh),ce=F;return{segmentation:Tg(cs(ne),t.segmentationThreshold),longOffsets:ce,heatmapScoresRaw:B,offsetsRaw:z,displacementFwdRaw:Z,displacementBwdRaw:Q,partSegmentation:S_e(re)}}),d=h.segmentation,c=h.longOffsets,f=h.heatmapScoresRaw,p=h.offsetsRaw,m=h.displacementFwdRaw,g=h.displacementBwdRaw,y=h.partSegmentation,[4,Cg([f,p,m,g])];case 1:return v=D.sent(),b=v[0],w=v[1],_=v[2],I=v[3],C=$g(C=kg(b,w,_,I,this.baseModel.outputStride,t.maxDetections,t.scoreThreshold,t.nmsRadius),[s,o],a,u,Ng),[4,M_e(d,c,y,C,s,o,this.baseModel.outputStride,a,u,t.scoreThreshold,t.refineSteps,t.minKeypointScore,t.maxDetections)];case 2:return N=D.sent(),l.dispose(),d.dispose(),c.dispose(),f.dispose(),p.dispose(),m.dispose(),g.dispose(),y.dispose(),[2,N]}})})},r.prototype.dispose=function(){this.baseModel.dispose()},r}();function oTe(r){return Va(this,void 0,void 0,function(){var e,t,n,s,o,a;return Ga(this,function(i){switch(i.label){case 0:if(e=r.outputStride,t=r.quantBytes,n=r.multiplier,B1==null)throw new Error(`Cannot find TensorFlow.js. If you are using a <script> tag, please also include @tensorflow/tfjs on the page before using this
        model.`);return s=H_e(e,n,t),[4,Nm(r.modelUrl||s)];case 1:return o=i.sent(),a=new __e(o,e),[2,new l4(a)]}})})}function iTe(r){return Va(this,void 0,void 0,function(){var e,t,n,s,o;return Ga(this,function(a){switch(a.label){case 0:if(e=r.outputStride,t=r.quantBytes,B1==null)throw new Error(`Cannot find TensorFlow.js. If you are using a <script> tag, please also include @tensorflow/tfjs on the page before using this
        model.`);return n=W_e(e,t),[4,Nm(r.modelUrl||n)];case 1:return s=a.sent(),o=new G_e(s,e),[2,new l4(o)]}})})}function aTe(r){return r===void 0&&(r=a4),Va(this,void 0,void 0,function(){return Ga(this,function(e){return(r=sTe(r)).architecture==="ResNet50"?[2,iTe(r)]:r.architecture==="MobileNetV1"?[2,oTe(r)]:[2,null]})})}function lTe(r,e,t,n,s){if(e===void 0&&(e={r:0,g:0,b:0,a:0}),t===void 0&&(t={r:0,g:0,b:0,a:255}),n===void 0&&(n=!1),s===void 0&&(s=[1]),Array.isArray(r)&&r.length===0)return null;var o,a=(o=Array.isArray(r)?r:[r])[0],i=a.width,l=a.height,u=new Uint8ClampedArray(i*l*4);function h(m,g,y,v,b,w){w===void 0&&(w={r:0,g:255,b:255,a:255});for(var _=-b;_<=b;_++)for(var I=-b;I<=b;I++)if(_!==0&&I!==0){var C=(g+_)*v+(y+I);m[4*C+0]=w.r,m[4*C+1]=w.g,m[4*C+2]=w.b,m[4*C+3]=w.a}}function d(m,g,y,v,b,w){b===void 0&&(b=[1]),w===void 0&&(w=1);for(var _=0,I=-w;I<=w;I++)for(var C=function(O){if(I!==0&&O!==0){var D=(g+I)*v+(y+O);b.some(function(M){return M===m[D]})||(_+=1)}},N=-w;N<=w;N++)C(N);return _>0}for(var c=0;c<l;c+=1)for(var f=function(m){var g=c*i+m;u[4*g+0]=t.r,u[4*g+1]=t.g,u[4*g+2]=t.b,u[4*g+3]=t.a;for(var y=function(b){if(s.some(function(_){return _===o[b].data[g]})){u[4*g]=e.r,u[4*g+1]=e.g,u[4*g+2]=e.b,u[4*g+3]=e.a;var w=d(o[b].data,c,m,i,s);n&&c-1>=0&&c+1<l&&m-1>=0&&m+1<i&&w&&h(u,c,m,i,1)}},v=0;v<o.length;v++)y(v)},p=0;p<i;p+=1)f(p);return new ImageData(u,i,l)}const Ph={architecture:"MobileNetV1",outputStride:16,multiplier:.5,quantBytes:4,internalResolution:"medium",segmentationThreshold:.7};function uTe(){mG("webgl");let r={architecture:Ph.architecture,outputStride:Ph.outputStride,multiplier:Ph.multiplier,quantBytes:Ph.quantBytes};return aTe(r)}function qE(r,e){let t={internalResolution:Ph.internalResolution,segmentationThreshold:Ph.segmentationThreshold};return r.segmentPerson(e,t).then(n=>lTe(n))}var u4={};(function(){var r;function e($){var U=0;return function(){return U<$.length?{done:!1,value:$[U++]}:{done:!0}}}var t=typeof Object.defineProperties=="function"?Object.defineProperty:function($,U,H){return $==Array.prototype||$==Object.prototype||($[U]=H.value),$};function n($){$=[typeof globalThis=="object"&&globalThis,$,typeof window=="object"&&window,typeof self=="object"&&self,typeof Pr=="object"&&Pr];for(var U=0;U<$.length;++U){var H=$[U];if(H&&H.Math==Math)return H}throw Error("Cannot find global object")}var s=n(this);function o($,U){if(U)e:{var H=s;$=$.split(".");for(var oe=0;oe<$.length-1;oe++){var Ie=$[oe];if(!(Ie in H))break e;H=H[Ie]}$=$[$.length-1],oe=H[$],U=U(oe),U!=oe&&U!=null&&t(H,$,{configurable:!0,writable:!0,value:U})}}o("Symbol",function($){function U(Ce){if(this instanceof U)throw new TypeError("Symbol is not a constructor");return new H(oe+(Ce||"")+"_"+Ie++,Ce)}function H(Ce,$e){this.h=Ce,t(this,"description",{configurable:!0,writable:!0,value:$e})}if($)return $;H.prototype.toString=function(){return this.h};var oe="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",Ie=0;return U}),o("Symbol.iterator",function($){if($)return $;$=Symbol("Symbol.iterator");for(var U="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),H=0;H<U.length;H++){var oe=s[U[H]];typeof oe=="function"&&typeof oe.prototype[$]!="function"&&t(oe.prototype,$,{configurable:!0,writable:!0,value:function(){return a(e(this))}})}return $});function a($){return $={next:$},$[Symbol.iterator]=function(){return this},$}function i($){var U=typeof Symbol!="undefined"&&Symbol.iterator&&$[Symbol.iterator];return U?U.call($):{next:e($)}}function l($){if(!($ instanceof Array)){$=i($);for(var U,H=[];!(U=$.next()).done;)H.push(U.value);$=H}return $}var u=typeof Object.assign=="function"?Object.assign:function($,U){for(var H=1;H<arguments.length;H++){var oe=arguments[H];if(oe)for(var Ie in oe)Object.prototype.hasOwnProperty.call(oe,Ie)&&($[Ie]=oe[Ie])}return $};o("Object.assign",function($){return $||u});var h=typeof Object.create=="function"?Object.create:function($){function U(){}return U.prototype=$,new U},d;if(typeof Object.setPrototypeOf=="function")d=Object.setPrototypeOf;else{var c;e:{var f={a:!0},p={};try{p.__proto__=f,c=p.a;break e}catch{}c=!1}d=c?function($,U){if($.__proto__=U,$.__proto__!==U)throw new TypeError($+" is not extensible");return $}:null}var m=d;function g($,U){if($.prototype=h(U.prototype),$.prototype.constructor=$,m)m($,U);else for(var H in U)if(H!="prototype")if(Object.defineProperties){var oe=Object.getOwnPropertyDescriptor(U,H);oe&&Object.defineProperty($,H,oe)}else $[H]=U[H];$.za=U.prototype}function y(){this.m=!1,this.j=null,this.i=void 0,this.h=1,this.v=this.s=0,this.l=null}function v($){if($.m)throw new TypeError("Generator is already running");$.m=!0}y.prototype.u=function($){this.i=$};function b($,U){$.l={ma:U,na:!0},$.h=$.s||$.v}y.prototype.return=function($){this.l={return:$},this.h=this.v};function w($,U,H){return $.h=H,{value:U}}function _($){this.h=new y,this.i=$}function I($,U){v($.h);var H=$.h.j;return H?C($,"return"in H?H.return:function(oe){return{value:oe,done:!0}},U,$.h.return):($.h.return(U),N($))}function C($,U,H,oe){try{var Ie=U.call($.h.j,H);if(!(Ie instanceof Object))throw new TypeError("Iterator result "+Ie+" is not an object");if(!Ie.done)return $.h.m=!1,Ie;var Ce=Ie.value}catch($e){return $.h.j=null,b($.h,$e),N($)}return $.h.j=null,oe.call($.h,Ce),N($)}function N($){for(;$.h.h;)try{var U=$.i($.h);if(U)return $.h.m=!1,{value:U.value,done:!1}}catch(H){$.h.i=void 0,b($.h,H)}if($.h.m=!1,$.h.l){if(U=$.h.l,$.h.l=null,U.na)throw U.ma;return{value:U.return,done:!0}}return{value:void 0,done:!0}}function O($){this.next=function(U){return v($.h),$.h.j?U=C($,$.h.j.next,U,$.h.u):($.h.u(U),U=N($)),U},this.throw=function(U){return v($.h),$.h.j?U=C($,$.h.j.throw,U,$.h.u):(b($.h,U),U=N($)),U},this.return=function(U){return I($,U)},this[Symbol.iterator]=function(){return this}}function D($){function U(oe){return $.next(oe)}function H(oe){return $.throw(oe)}return new Promise(function(oe,Ie){function Ce($e){$e.done?oe($e.value):Promise.resolve($e.value).then(U,H).then(Ce,Ie)}Ce($.next())})}function M($){return D(new O(new _($)))}o("Promise",function($){function U($e){this.i=0,this.j=void 0,this.h=[],this.u=!1;var He=this.l();try{$e(He.resolve,He.reject)}catch(lt){He.reject(lt)}}function H(){this.h=null}function oe($e){return $e instanceof U?$e:new U(function(He){He($e)})}if($)return $;H.prototype.i=function($e){if(this.h==null){this.h=[];var He=this;this.j(function(){He.m()})}this.h.push($e)};var Ie=s.setTimeout;H.prototype.j=function($e){Ie($e,0)},H.prototype.m=function(){for(;this.h&&this.h.length;){var $e=this.h;this.h=[];for(var He=0;He<$e.length;++He){var lt=$e[He];$e[He]=null;try{lt()}catch(Ct){this.l(Ct)}}}this.h=null},H.prototype.l=function($e){this.j(function(){throw $e})},U.prototype.l=function(){function $e(Ct){return function(jt){lt||(lt=!0,Ct.call(He,jt))}}var He=this,lt=!1;return{resolve:$e(this.I),reject:$e(this.m)}},U.prototype.I=function($e){if($e===this)this.m(new TypeError("A Promise cannot resolve to itself"));else if($e instanceof U)this.L($e);else{e:switch(typeof $e){case"object":var He=$e!=null;break e;case"function":He=!0;break e;default:He=!1}He?this.F($e):this.s($e)}},U.prototype.F=function($e){var He=void 0;try{He=$e.then}catch(lt){this.m(lt);return}typeof He=="function"?this.M(He,$e):this.s($e)},U.prototype.m=function($e){this.v(2,$e)},U.prototype.s=function($e){this.v(1,$e)},U.prototype.v=function($e,He){if(this.i!=0)throw Error("Cannot settle("+$e+", "+He+"): Promise already settled in state"+this.i);this.i=$e,this.j=He,this.i===2&&this.K(),this.H()},U.prototype.K=function(){var $e=this;Ie(function(){if($e.D()){var He=s.console;typeof He!="undefined"&&He.error($e.j)}},1)},U.prototype.D=function(){if(this.u)return!1;var $e=s.CustomEvent,He=s.Event,lt=s.dispatchEvent;return typeof lt=="undefined"?!0:(typeof $e=="function"?$e=new $e("unhandledrejection",{cancelable:!0}):typeof He=="function"?$e=new He("unhandledrejection",{cancelable:!0}):($e=s.document.createEvent("CustomEvent"),$e.initCustomEvent("unhandledrejection",!1,!0,$e)),$e.promise=this,$e.reason=this.j,lt($e))},U.prototype.H=function(){if(this.h!=null){for(var $e=0;$e<this.h.length;++$e)Ce.i(this.h[$e]);this.h=null}};var Ce=new H;return U.prototype.L=function($e){var He=this.l();$e.T(He.resolve,He.reject)},U.prototype.M=function($e,He){var lt=this.l();try{$e.call(He,lt.resolve,lt.reject)}catch(Ct){lt.reject(Ct)}},U.prototype.then=function($e,He){function lt(on,It){return typeof on=="function"?function(bn){try{Ct(on(bn))}catch(S){jt(S)}}:It}var Ct,jt,wn=new U(function(on,It){Ct=on,jt=It});return this.T(lt($e,Ct),lt(He,jt)),wn},U.prototype.catch=function($e){return this.then(void 0,$e)},U.prototype.T=function($e,He){function lt(){switch(Ct.i){case 1:$e(Ct.j);break;case 2:He(Ct.j);break;default:throw Error("Unexpected state: "+Ct.i)}}var Ct=this;this.h==null?Ce.i(lt):this.h.push(lt),this.u=!0},U.resolve=oe,U.reject=function($e){return new U(function(He,lt){lt($e)})},U.race=function($e){return new U(function(He,lt){for(var Ct=i($e),jt=Ct.next();!jt.done;jt=Ct.next())oe(jt.value).T(He,lt)})},U.all=function($e){var He=i($e),lt=He.next();return lt.done?oe([]):new U(function(Ct,jt){function wn(bn){return function(S){on[bn]=S,It--,It==0&&Ct(on)}}var on=[],It=0;do on.push(void 0),It++,oe(lt.value).T(wn(on.length-1),jt),lt=He.next();while(!lt.done)})},U});function P($,U){$ instanceof String&&($+="");var H=0,oe=!1,Ie={next:function(){if(!oe&&H<$.length){var Ce=H++;return{value:U(Ce,$[Ce]),done:!1}}return oe=!0,{done:!0,value:void 0}}};return Ie[Symbol.iterator]=function(){return Ie},Ie}o("Array.prototype.keys",function($){return $||function(){return P(this,function(U){return U})}}),o("Array.prototype.fill",function($){return $||function(U,H,oe){var Ie=this.length||0;for(0>H&&(H=Math.max(0,Ie+H)),(oe==null||oe>Ie)&&(oe=Ie),oe=Number(oe),0>oe&&(oe=Math.max(0,Ie+oe)),H=Number(H||0);H<oe;H++)this[H]=U;return this}});function F($){return $||Array.prototype.fill}o("Int8Array.prototype.fill",F),o("Uint8Array.prototype.fill",F),o("Uint8ClampedArray.prototype.fill",F),o("Int16Array.prototype.fill",F),o("Uint16Array.prototype.fill",F),o("Int32Array.prototype.fill",F),o("Uint32Array.prototype.fill",F),o("Float32Array.prototype.fill",F),o("Float64Array.prototype.fill",F),o("Object.is",function($){return $||function(U,H){return U===H?U!==0||1/U===1/H:U!==U&&H!==H}}),o("Array.prototype.includes",function($){return $||function(U,H){var oe=this;oe instanceof String&&(oe=String(oe));var Ie=oe.length;for(H=H||0,0>H&&(H=Math.max(H+Ie,0));H<Ie;H++){var Ce=oe[H];if(Ce===U||Object.is(Ce,U))return!0}return!1}}),o("String.prototype.includes",function($){return $||function(U,H){if(this==null)throw new TypeError("The 'this' value for String.prototype.includes must not be null or undefined");if(U instanceof RegExp)throw new TypeError("First argument to String.prototype.includes must not be a regular expression");return this.indexOf(U,H||0)!==-1}});var B=this||self;function z($,U){$=$.split(".");var H=B;$[0]in H||typeof H.execScript=="undefined"||H.execScript("var "+$[0]);for(var oe;$.length&&(oe=$.shift());)$.length||U===void 0?H[oe]&&H[oe]!==Object.prototype[oe]?H=H[oe]:H=H[oe]={}:H[oe]=U}function Z($){var U;e:{if((U=B.navigator)&&(U=U.userAgent))break e;U=""}return U.indexOf($)!=-1}var Q=Array.prototype.map?function($,U){return Array.prototype.map.call($,U,void 0)}:function($,U){for(var H=$.length,oe=Array(H),Ie=typeof $=="string"?$.split(""):$,Ce=0;Ce<H;Ce++)Ce in Ie&&(oe[Ce]=U.call(void 0,Ie[Ce],Ce,$));return oe},K={},ne=null;function re($){var U=$.length,H=3*U/4;H%3?H=Math.floor(H):"=.".indexOf($[U-1])!=-1&&(H="=.".indexOf($[U-2])!=-1?H-2:H-1);var oe=new Uint8Array(H),Ie=0;return ce($,function(Ce){oe[Ie++]=Ce}),Ie!==H?oe.subarray(0,Ie):oe}function ce($,U){function H(lt){for(;oe<$.length;){var Ct=$.charAt(oe++),jt=ne[Ct];if(jt!=null)return jt;if(!/^[\s\xa0]*$/.test(Ct))throw Error("Unknown base64 encoding at char: "+Ct)}return lt}be();for(var oe=0;;){var Ie=H(-1),Ce=H(0),$e=H(64),He=H(64);if(He===64&&Ie===-1)break;U(Ie<<2|Ce>>4),$e!=64&&(U(Ce<<4&240|$e>>2),He!=64&&U($e<<6&192|He))}}function be(){if(!ne){ne={};for(var $="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),U=["+/=","+/","-_=","-_.","-_"],H=0;5>H;H++){var oe=$.concat(U[H].split(""));K[H]=oe;for(var Ie=0;Ie<oe.length;Ie++){var Ce=oe[Ie];ne[Ce]===void 0&&(ne[Ce]=Ie)}}}}var we=typeof Uint8Array!="undefined",ye=!(Z("Trident")||Z("MSIE"))&&typeof B.btoa=="function";function Oe($){if(!ye){var U;U===void 0&&(U=0),be(),U=K[U];for(var H=Array(Math.floor($.length/3)),oe=U[64]||"",Ie=0,Ce=0;Ie<$.length-2;Ie+=3){var $e=$[Ie],He=$[Ie+1],lt=$[Ie+2],Ct=U[$e>>2];$e=U[($e&3)<<4|He>>4],He=U[(He&15)<<2|lt>>6],lt=U[lt&63],H[Ce++]=Ct+$e+He+lt}switch(Ct=0,lt=oe,$.length-Ie){case 2:Ct=$[Ie+1],lt=U[(Ct&15)<<2]||oe;case 1:$=$[Ie],H[Ce]=U[$>>2]+U[($&3)<<4|Ct>>4]+lt+oe}return H.join("")}for(U="";10240<$.length;)U+=String.fromCharCode.apply(null,$.subarray(0,10240)),$=$.subarray(10240);return U+=String.fromCharCode.apply(null,$),btoa(U)}var Se=RegExp("[-_.]","g");function Ee($){switch($){case"-":return"+";case"_":return"/";case".":return"=";default:return""}}function j($){if(!ye)return re($);Se.test($)&&($=$.replace(Se,Ee)),$=atob($);for(var U=new Uint8Array($.length),H=0;H<$.length;H++)U[H]=$.charCodeAt(H);return U}var W;function J(){return W||(W=new Uint8Array(0))}var ie={},ve=typeof Uint8Array.prototype.slice=="function",he=0,Fe=0;function me($){var U=0>$;$=Math.abs($);var H=$>>>0;$=Math.floor(($-H)/4294967296),U&&(H=i(De(H,$)),U=H.next().value,$=H.next().value,H=U),he=H>>>0,Fe=$>>>0}var Le=typeof BigInt=="function";function De($,U){return U=~U,$?$=~$+1:U+=1,[$,U]}function Ne($,U){this.i=$>>>0,this.h=U>>>0}function rt($){if(!$)return tt||(tt=new Ne(0,0));if(!/^-?\d+$/.test($))return null;if(16>$.length)me(Number($));else if(Le)$=BigInt($),he=Number($&BigInt(4294967295))>>>0,Fe=Number($>>BigInt(32)&BigInt(4294967295));else{var U=+($[0]==="-");Fe=he=0;for(var H=$.length,oe=U,Ie=(H-U)%6+U;Ie<=H;oe=Ie,Ie+=6)oe=Number($.slice(oe,Ie)),Fe*=1e6,he=1e6*he+oe,4294967296<=he&&(Fe+=he/4294967296|0,he%=4294967296);U&&(U=i(De(he,Fe)),$=U.next().value,U=U.next().value,he=$,Fe=U)}return new Ne(he,Fe)}var tt;function Je($,U){return Error("Invalid wire type: "+$+" (at position "+U+")")}function xt(){return Error("Failed to read varint, encoding is invalid.")}function Pt($,U){return Error("Tried to read past the end of the data "+U+" > "+$)}function Dt(){throw Error("Invalid UTF8")}function St($,U){return U=String.fromCharCode.apply(null,U),$==null?U:$+U}var Jt=void 0,ht,ct=typeof TextDecoder!="undefined",At,Ft=typeof TextEncoder!="undefined",Be;function qt($){if($!==ie)throw Error("illegal external caller")}function Y($,U){if(qt(U),this.V=$,$!=null&&$.length===0)throw Error("ByteString should be constructed with non-empty values")}function le(){return Be||(Be=new Y(null,ie))}function ee($){qt(ie);var U=$.V;return U=U==null||we&&U!=null&&U instanceof Uint8Array?U:typeof U=="string"?j(U):null,U==null?U:$.V=U}function ue($){if(typeof $=="string")return{buffer:j($),C:!1};if(Array.isArray($))return{buffer:new Uint8Array($),C:!1};if($.constructor===Uint8Array)return{buffer:$,C:!1};if($.constructor===ArrayBuffer)return{buffer:new Uint8Array($),C:!1};if($.constructor===Y)return{buffer:ee($)||J(),C:!0};if($ instanceof Uint8Array)return{buffer:new Uint8Array($.buffer,$.byteOffset,$.byteLength),C:!1};throw Error("Type not convertible to a Uint8Array, expected a Uint8Array, an ArrayBuffer, a base64 encoded string, a ByteString or an Array of numbers")}function Ae($,U){this.i=null,this.m=!1,this.h=this.j=this.l=0,Ke(this,$,U)}function Ke($,U,H){H=H===void 0?{}:H,$.S=H.S===void 0?!1:H.S,U&&(U=ue(U),$.i=U.buffer,$.m=U.C,$.l=0,$.j=$.i.length,$.h=$.l)}Ae.prototype.reset=function(){this.h=this.l};function ot($,U){if($.h=U,U>$.j)throw Pt($.j,U)}function vt($){var U=$.i,H=$.h,oe=U[H++],Ie=oe&127;if(oe&128&&(oe=U[H++],Ie|=(oe&127)<<7,oe&128&&(oe=U[H++],Ie|=(oe&127)<<14,oe&128&&(oe=U[H++],Ie|=(oe&127)<<21,oe&128&&(oe=U[H++],Ie|=oe<<28,oe&128&&U[H++]&128&&U[H++]&128&&U[H++]&128&&U[H++]&128&&U[H++]&128)))))throw xt();return ot($,H),Ie}function Pe($,U){if(0>U)throw Error("Tried to read a negative byte length: "+U);var H=$.h,oe=H+U;if(oe>$.j)throw Pt(U,$.j-H);return $.h=oe,H}var Mt=[];function en(){this.h=[]}en.prototype.length=function(){return this.h.length},en.prototype.end=function(){var $=this.h;return this.h=[],$};function dn($,U,H){for(;0<H||127<U;)$.h.push(U&127|128),U=(U>>>7|H<<25)>>>0,H>>>=7;$.h.push(U)}function mn($,U){for(;127<U;)$.h.push(U&127|128),U>>>=7;$.h.push(U)}function hn($,U){if(Mt.length){var H=Mt.pop();Ke(H,$,U),$=H}else $=new Ae($,U);this.h=$,this.j=this.h.h,this.i=this.l=-1,this.setOptions(U)}hn.prototype.setOptions=function($){$=$===void 0?{}:$,this.ca=$.ca===void 0?!1:$.ca},hn.prototype.reset=function(){this.h.reset(),this.j=this.h.h,this.i=this.l=-1};function gn($){var U=$.h;if(U.h==U.j)return!1;$.j=$.h.h;var H=vt($.h)>>>0;if(U=H>>>3,H&=7,!(0<=H&&5>=H))throw Je(H,$.j);if(1>U)throw Error("Invalid field number: "+U+" (at position "+$.j+")");return $.l=U,$.i=H,!0}function jn($){switch($.i){case 0:if($.i!=0)jn($);else e:{$=$.h;for(var U=$.h,H=U+10,oe=$.i;U<H;)if((oe[U++]&128)===0){ot($,U);break e}throw xt()}break;case 1:$=$.h,ot($,$.h+8);break;case 2:$.i!=2?jn($):(U=vt($.h)>>>0,$=$.h,ot($,$.h+U));break;case 5:$=$.h,ot($,$.h+4);break;case 3:U=$.l;do{if(!gn($))throw Error("Unmatched start-group tag: stream EOF");if($.i==4){if($.l!=U)throw Error("Unmatched end-group tag");break}jn($)}while(1);break;default:throw Je($.i,$.j)}}var Ps=[];function ms(){this.j=[],this.i=0,this.h=new en}function Es($,U){U.length!==0&&($.j.push(U),$.i+=U.length)}function Ho($,U){if(U=U.R){Es($,$.h.end());for(var H=0;H<U.length;H++)Es($,ee(U[H])||J())}}var zr=typeof Symbol=="function"&&typeof Symbol()=="symbol"?Symbol():void 0;function js($,U){return zr?$[zr]|=U:$.A!==void 0?$.A|=U:(Object.defineProperties($,{A:{value:U,configurable:!0,writable:!0,enumerable:!1}}),U)}function gi($,U){zr?$[zr]&&($[zr]&=~U):$.A!==void 0&&($.A&=~U)}function cr($){var U;return zr?U=$[zr]:U=$.A,U==null?0:U}function as($,U){zr?$[zr]=U:$.A!==void 0?$.A=U:Object.defineProperties($,{A:{value:U,configurable:!0,writable:!0,enumerable:!1}})}function qo($){return js($,1),$}function wa($,U){as(U,($|0)&-51)}function ho($,U){as(U,($|18)&-41)}var ko={};function Re($){return $!==null&&typeof $=="object"&&!Array.isArray($)&&$.constructor===Object}var gt,Lt=[];as(Lt,23),gt=Object.freeze(Lt);function kt($){if(cr($.o)&2)throw Error("Cannot mutate an immutable Message")}function Xt($){var U=$.length;(U=U?$[U-1]:void 0)&&Re(U)?U.g=1:(U={},$.push((U.g=1,U)))}function yt($){var U=$.i+$.G;return $.B||($.B=$.o[U]={})}function _n($,U){return U===-1?null:U>=$.i?$.B?$.B[U]:void 0:$.o[U+$.G]}function En($,U,H,oe){kt($),Yn($,U,H,oe)}function Yn($,U,H,oe){$.j&&($.j=void 0),U>=$.i||oe?yt($)[U]=H:($.o[U+$.G]=H,($=$.B)&&U in $&&delete $[U])}function Cn($,U,H,oe){var Ie=_n($,U);Array.isArray(Ie)||(Ie=gt);var Ce=cr(Ie);if(Ce&1||qo(Ie),oe)Ce&2||js(Ie,2),H&1||Object.freeze(Ie);else{oe=!(H&2);var $e=Ce&2;H&1||!$e?oe&&Ce&16&&!$e&&gi(Ie,16):(Ie=qo(Array.prototype.slice.call(Ie)),Yn($,U,Ie))}return Ie}function Bt($,U){var H=_n($,U),oe=H==null?H:typeof H=="number"||H==="NaN"||H==="Infinity"||H==="-Infinity"?Number(H):void 0;return oe!=null&&oe!==H&&Yn($,U,oe),oe}function mr($,U,H,oe,Ie){$.h||($.h={});var Ce=$.h[H],$e=Cn($,H,3,Ie);if(!Ce){var He=$e;Ce=[];var lt=!!(cr($.o)&16);$e=!!(cr(He)&2);var Ct=He;!Ie&&$e&&(He=Array.prototype.slice.call(He));for(var jt=$e,wn=0;wn<He.length;wn++){var on=He[wn],It=U,bn=!1;if(bn=bn===void 0?!1:bn,on=Array.isArray(on)?new It(on):bn?new It:void 0,on!==void 0){It=on.o;var S=bn=cr(It);$e&&(S|=2),lt&&(S|=16),S!=bn&&as(It,S),It=S,jt=jt||!!(2&It),Ce.push(on)}}return $.h[H]=Ce,lt=cr(He),U=lt|33,U=jt?U&-9:U|8,lt!=U&&(jt=He,Object.isFrozen(jt)&&(jt=Array.prototype.slice.call(jt)),as(jt,U),He=jt),Ct!==He&&Yn($,H,He),(Ie||oe&&$e)&&js(Ce,2),oe&&Object.freeze(Ce),Ce}return Ie||(Ie=Object.isFrozen(Ce),oe&&!Ie?Object.freeze(Ce):!oe&&Ie&&(Ce=Array.prototype.slice.call(Ce),$.h[H]=Ce)),Ce}function an($,U,H){var oe=!!(cr($.o)&2);if(U=mr($,U,H,oe,oe),$=Cn($,H,3,oe),!(oe||cr($)&8)){for(oe=0;oe<U.length;oe++){if(H=U[oe],cr(H.o)&2){var Ie=Io(H,!1);Ie.j=H}else Ie=H;H!==Ie&&(U[oe]=Ie,$[oe]=Ie.o)}js($,8)}return U}function gs($,U,H){if(H!=null&&typeof H!="number")throw Error("Value of float/double field must be a number|null|undefined, found "+typeof H+": "+H);En($,U,H)}function Xo($,U,H,oe,Ie){kt($);var Ce=mr($,H,U,!1,!1);return H=oe!=null?oe:new H,$=Cn($,U,2,!1),Ie!=null?(Ce.splice(Ie,0,H),$.splice(Ie,0,H.o)):(Ce.push(H),$.push(H.o)),H.C()&&gi($,8),H}function Ko($,U){return $==null?U:$}function Cs($,U,H){return H=H===void 0?0:H,Ko(Bt($,U),H)}var yi;function Sa($){switch(typeof $){case"number":return isFinite($)?$:String($);case"object":if($)if(Array.isArray($)){if((cr($)&128)!==0)return $=Array.prototype.slice.call($),Xt($),$}else{if(we&&$!=null&&$ instanceof Uint8Array)return Oe($);if($ instanceof Y){var U=$.V;return U==null?"":typeof U=="string"?U:$.V=Oe(U)}}}return $}function Ji($,U,H,oe){if($!=null){if(Array.isArray($))$=ol($,U,H,oe!==void 0);else if(Re($)){var Ie={},Ce;for(Ce in $)Ie[Ce]=Ji($[Ce],U,H,oe);$=Ie}else $=U($,oe);return $}}function ol($,U,H,oe){var Ie=cr($);oe=oe?!!(Ie&16):void 0,$=Array.prototype.slice.call($);for(var Ce=0;Ce<$.length;Ce++)$[Ce]=Ji($[Ce],U,H,oe);return H(Ie,$),$}function ju($){return $.ja===ko?$.toJSON():Sa($)}function Ll($,U){$&128&&Xt(U)}function _a($,U,H){if(H=H===void 0?ho:H,$!=null){if(we&&$ instanceof Uint8Array)return $.length?new Y(new Uint8Array($),ie):le();if(Array.isArray($)){var oe=cr($);return oe&2?$:U&&!(oe&32)&&(oe&16||oe===0)?(as($,oe|2),$):($=ol($,_a,oe&4?ho:H,!0),U=cr($),U&4&&U&2&&Object.freeze($),$)}return $.ja===ko?Bs($):$}}function Bu($,U,H,oe,Ie,Ce,$e){if($=$.h&&$.h[H]){if(oe=cr($),oe&2?oe=$:(Ce=Q($,Bs),ho(oe,Ce),Object.freeze(Ce),oe=Ce),kt(U),$e=oe==null?gt:qo([]),oe!=null){for(Ce=!!oe.length,$=0;$<oe.length;$++){var He=oe[$];Ce=Ce&&!(cr(He.o)&2),$e[$]=He.o}Ce=(Ce?8:0)|1,$=cr($e),($&Ce)!==Ce&&(Object.isFrozen($e)&&($e=Array.prototype.slice.call($e)),as($e,$|Ce)),U.h||(U.h={}),U.h[H]=oe}else U.h&&(U.h[H]=void 0);Yn(U,H,$e,Ie)}else En(U,H,_a(oe,Ce,$e),Ie)}function Bs($){return cr($.o)&2||($=Io($,!0),js($.o,2)),$}function Io($,U){var H=$.o,oe=[];js(oe,16);var Ie=$.constructor.h;if(Ie&&oe.push(Ie),Ie=$.B,Ie){oe.length=H.length,oe.fill(void 0,oe.length,H.length);var Ce={};oe[oe.length-1]=Ce}(cr(H)&128)!==0&&Xt(oe),U=U||$.C()?ho:wa,Ce=$.constructor,yi=oe,oe=new Ce(oe),yi=void 0,$.R&&(oe.R=$.R.slice()),Ce=!!(cr(H)&16);for(var $e=Ie?H.length-1:H.length,He=0;He<$e;He++)Bu($,oe,He-$.G,H[He],!1,Ce,U);if(Ie)for(var lt in Ie)Bu($,oe,+lt,Ie[lt],!0,Ce,U);return oe}function Yr($,U,H){$==null&&($=yi),yi=void 0;var oe=this.constructor.i||0,Ie=0<oe,Ce=this.constructor.h,$e=!1;if($==null){$=Ce?[Ce]:[];var He=48,lt=!0;Ie&&(oe=0,He|=128),as($,He)}else{if(!Array.isArray($)||Ce&&Ce!==$[0])throw Error();var Ct=He=js($,0);if((lt=(16&Ct)!==0)&&(($e=(32&Ct)!==0)||(Ct|=32)),Ie){if(128&Ct)oe=0;else if(0<$.length){var jt=$[$.length-1];if(Re(jt)&&"g"in jt){oe=0,Ct|=128,delete jt.g;var wn=!0,on;for(on in jt){wn=!1;break}wn&&$.pop()}}}else if(128&Ct)throw Error();He!==Ct&&as($,Ct)}this.G=(Ce?0:-1)-oe,this.h=void 0,this.o=$;e:{if(Ce=this.o.length,oe=Ce-1,Ce&&(Ce=this.o[oe],Re(Ce))){this.B=Ce,this.i=oe-this.G;break e}U!==void 0&&-1<U?(this.i=Math.max(U,oe+1-this.G),this.B=void 0):this.i=Number.MAX_VALUE}if(!Ie&&this.B&&"g"in this.B)throw Error('Unexpected "g" flag in sparse object of message that is not a group type.');if(H){U=lt&&!$e&&!0,Ie=this.i;var It;for(lt=0;lt<H.length;lt++)$e=H[lt],$e<Ie?($e+=this.G,(oe=$[$e])?Uu(oe,U):$[$e]=gt):(It||(It=yt(this)),(oe=It[$e])?Uu(oe,U):It[$e]=gt)}}Yr.prototype.toJSON=function(){return ol(this.o,ju,Ll)},Yr.prototype.C=function(){return!!(cr(this.o)&2)};function Uu($,U){if(Array.isArray($)){var H=cr($),oe=1;!U||H&2||(oe|=16),(H&oe)!==oe&&as($,H|oe)}}Yr.prototype.ja=ko,Yr.prototype.toString=function(){return this.o.toString()};function Pl($,U,H){if(H){var oe={},Ie;for(Ie in H){var Ce=H[Ie],$e=Ce.ra;$e||(oe.J=Ce.xa||Ce.oa.W,Ce.ia?(oe.aa=Ul(Ce.ia),$e=function(He){return function(lt,Ct,jt){return He.J(lt,Ct,jt,He.aa)}}(oe)):Ce.ka?(oe.Z=il(Ce.da.P,Ce.ka),$e=function(He){return function(lt,Ct,jt){return He.J(lt,Ct,jt,He.Z)}}(oe)):$e=oe.J,Ce.ra=$e),$e(U,$,Ce.da),oe={J:oe.J,aa:oe.aa,Z:oe.Z}}}Ho(U,$)}var Ta=Symbol();function ka($,U,H){return $[Ta]||($[Ta]=function(oe,Ie){return U(oe,Ie,H)})}function zu($){var U=$[Ta];if(!U){var H=zl($);U=function(oe,Ie){return Eo(oe,Ie,H)},$[Ta]=U}return U}function Vu($){var U=$.ia;if(U)return zu(U);if(U=$.wa)return ka($.da.P,U,$.ka)}function jl($){var U=Vu($),H=$.da,oe=$.oa.U;return U?function(Ie,Ce){return oe(Ie,Ce,H,U)}:function(Ie,Ce){return oe(Ie,Ce,H)}}function Bl($,U){var H=$[U];return typeof H=="function"&&H.length===0&&(H=H(),$[U]=H),Array.isArray(H)&&(Ea in H||Zo in H||0<H.length&&typeof H[0]=="function")?H:void 0}function Yo($,U,H,oe,Ie,Ce){U.P=$[0];var $e=1;if($.length>$e&&typeof $[$e]!="number"){var He=$[$e++];H(U,He)}for(;$e<$.length;){H=$[$e++];for(var lt=$e+1;lt<$.length&&typeof $[lt]!="number";)lt++;switch(He=$[$e++],lt-=$e,lt){case 0:oe(U,H,He);break;case 1:(lt=Bl($,$e))?($e++,Ie(U,H,He,lt)):oe(U,H,He,$[$e++]);break;case 2:lt=$e++,lt=Bl($,lt),Ie(U,H,He,lt,$[$e++]);break;case 3:Ce(U,H,He,$[$e++],$[$e++],$[$e++]);break;case 4:Ce(U,H,He,$[$e++],$[$e++],$[$e++],$[$e++]);break;default:throw Error("unexpected number of binary field arguments: "+lt)}}return U}var Ia=Symbol();function Ul($){var U=$[Ia];if(!U){var H=vi($);U=function(oe,Ie){return Hu(oe,Ie,H)},$[Ia]=U}return U}function il($,U){var H=$[Ia];return H||(H=function(oe,Ie){return Pl(oe,Ie,U)},$[Ia]=H),H}var Zo=Symbol();function fo($,U){$.push(U)}function ah($,U,H){$.push(U,H.W)}function Gu($,U,H,oe){var Ie=Ul(oe),Ce=vi(oe).P,$e=H.W;$.push(U,function(He,lt,Ct){return $e(He,lt,Ct,Ce,Ie)})}function lh($,U,H,oe,Ie,Ce){var $e=il(oe,Ce),He=H.W;$.push(U,function(lt,Ct,jt){return He(lt,Ct,jt,oe,$e)})}function vi($){var U=$[Zo];return U||(U=Yo($,$[Zo]=[],fo,ah,Gu,lh),Ea in $&&Zo in $&&($.length=0),U)}var Ea=Symbol();function uh($,U){$[0]=U}function Wu($,U,H,oe){var Ie=H.U;$[U]=oe?function(Ce,$e,He){return Ie(Ce,$e,He,oe)}:Ie}function ch($,U,H,oe,Ie){var Ce=H.U,$e=zu(oe),He=zl(oe).P;$[U]=function(lt,Ct,jt){return Ce(lt,Ct,jt,He,$e,Ie)}}function Ld($,U,H,oe,Ie,Ce,$e){var He=H.U,lt=ka(oe,Ie,Ce);$[U]=function(Ct,jt,wn){return He(Ct,jt,wn,oe,lt,$e)}}function zl($){var U=$[Ea];return U||(U=Yo($,$[Ea]={},uh,Wu,ch,Ld),Ea in $&&Zo in $&&($.length=0),U)}function Eo($,U,H){for(;gn(U)&&U.i!=4;){var oe=U.l,Ie=H[oe];if(!Ie){var Ce=H[0];Ce&&(Ce=Ce[oe])&&(Ie=H[oe]=jl(Ce))}if(!Ie||!Ie(U,$,oe)){Ie=U,oe=$,Ce=Ie.j,jn(Ie);var $e=Ie;if(!$e.ca){if(Ie=$e.h.h-Ce,$e.h.h=Ce,$e=$e.h,Ie==0)Ie=le();else{if(Ce=Pe($e,Ie),$e.S&&$e.m)Ie=$e.i.subarray(Ce,Ce+Ie);else{$e=$e.i;var He=Ce;Ie=Ce+Ie,Ie=He===Ie?J():ve?$e.slice(He,Ie):new Uint8Array($e.subarray(He,Ie))}Ie=Ie.length==0?le():new Y(Ie,ie)}(Ce=oe.R)?Ce.push(Ie):oe.R=[Ie]}}}return $}function Hu($,U,H){for(var oe=H.length,Ie=oe%2==1,Ce=Ie?1:0;Ce<oe;Ce+=2)(0,H[Ce+1])(U,$,H[Ce]);Pl($,U,Ie?H[0]:void 0)}function ea($,U){return{U:$,W:U}}var Ys=ea(function($,U,H){if($.i!==5)return!1;$=$.h;var oe=$.i,Ie=$.h,Ce=oe[Ie],$e=oe[Ie+1],He=oe[Ie+2];return oe=oe[Ie+3],ot($,$.h+4),$e=(Ce<<0|$e<<8|He<<16|oe<<24)>>>0,$=2*($e>>31)+1,Ce=$e>>>23&255,$e&=8388607,En(U,H,Ce==255?$e?NaN:1/0*$:Ce==0?$*Math.pow(2,-149)*$e:$*Math.pow(2,Ce-150)*($e+Math.pow(2,23))),!0},function($,U,H){if(U=Bt(U,H),U!=null){mn($.h,8*H+5),$=$.h;var oe=+U;oe===0?0<1/oe?he=Fe=0:(Fe=0,he=2147483648):isNaN(oe)?(Fe=0,he=2147483647):(oe=(H=0>oe?-2147483648:0)?-oe:oe,34028234663852886e22<oe?(Fe=0,he=(H|2139095040)>>>0):11754943508222875e-54>oe?(oe=Math.round(oe/Math.pow(2,-149)),Fe=0,he=(H|oe)>>>0):(U=Math.floor(Math.log(oe)/Math.LN2),oe*=Math.pow(2,-U),oe=Math.round(8388608*oe),16777216<=oe&&++U,Fe=0,he=(H|U+127<<23|oe&8388607)>>>0)),H=he,$.h.push(H>>>0&255),$.h.push(H>>>8&255),$.h.push(H>>>16&255),$.h.push(H>>>24&255)}}),hh=ea(function($,U,H){if($.i!==0)return!1;var oe=$.h,Ie=0,Ce=$=0,$e=oe.i,He=oe.h;do{var lt=$e[He++];Ie|=(lt&127)<<Ce,Ce+=7}while(32>Ce&&lt&128);for(32<Ce&&($|=(lt&127)>>4),Ce=3;32>Ce&&lt&128;Ce+=7)lt=$e[He++],$|=(lt&127)<<Ce;if(ot(oe,He),128>lt)oe=Ie>>>0,lt=$>>>0,($=lt&2147483648)&&(oe=~oe+1>>>0,lt=~lt>>>0,oe==0&&(lt=lt+1>>>0)),oe=4294967296*lt+(oe>>>0);else throw xt();return En(U,H,$?-oe:oe),!0},function($,U,H){U=_n(U,H),U!=null&&(typeof U=="string"&&rt(U),U!=null&&(mn($.h,8*H),typeof U=="number"?($=$.h,me(U),dn($,he,Fe)):(H=rt(U),dn($.h,H.i,H.h))))}),Pd=ea(function($,U,H){return $.i!==0?!1:(En(U,H,vt($.h)),!0)},function($,U,H){if(U=_n(U,H),U!=null&&U!=null)if(mn($.h,8*H),$=$.h,H=U,0<=H)mn($,H);else{for(U=0;9>U;U++)$.h.push(H&127|128),H>>=7;$.h.push(1)}}),hr=ea(function($,U,H){if($.i!==2)return!1;var oe=vt($.h)>>>0;$=$.h;var Ie=Pe($,oe);if($=$.i,ct){var Ce=$,$e;($e=ht)||($e=ht=new TextDecoder("utf-8",{fatal:!0})),$=Ie+oe,Ce=Ie===0&&$===Ce.length?Ce:Ce.subarray(Ie,$);try{var He=$e.decode(Ce)}catch(wn){if(Jt===void 0){try{$e.decode(new Uint8Array([128]))}catch{}try{$e.decode(new Uint8Array([97])),Jt=!0}catch{Jt=!1}}throw!Jt&&(ht=void 0),wn}}else{He=Ie,oe=He+oe,Ie=[];for(var lt=null,Ct,jt;He<oe;)Ct=$[He++],128>Ct?Ie.push(Ct):224>Ct?He>=oe?Dt():(jt=$[He++],194>Ct||(jt&192)!==128?(He--,Dt()):Ie.push((Ct&31)<<6|jt&63)):240>Ct?He>=oe-1?Dt():(jt=$[He++],(jt&192)!==128||Ct===224&&160>jt||Ct===237&&160<=jt||((Ce=$[He++])&192)!==128?(He--,Dt()):Ie.push((Ct&15)<<12|(jt&63)<<6|Ce&63)):244>=Ct?He>=oe-2?Dt():(jt=$[He++],(jt&192)!==128||(Ct<<28)+(jt-144)>>30!==0||((Ce=$[He++])&192)!==128||(($e=$[He++])&192)!==128?(He--,Dt()):(Ct=(Ct&7)<<18|(jt&63)<<12|(Ce&63)<<6|$e&63,Ct-=65536,Ie.push((Ct>>10&1023)+55296,(Ct&1023)+56320))):Dt(),8192<=Ie.length&&(lt=St(lt,Ie),Ie.length=0);He=St(lt,Ie)}return En(U,H,He),!0},function($,U,H){if(U=_n(U,H),U!=null){var oe=!1;if(oe=oe===void 0?!1:oe,Ft){if(oe&&/(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])/.test(U))throw Error("Found an unpaired surrogate");U=(At||(At=new TextEncoder)).encode(U)}else{for(var Ie=0,Ce=new Uint8Array(3*U.length),$e=0;$e<U.length;$e++){var He=U.charCodeAt($e);if(128>He)Ce[Ie++]=He;else{if(2048>He)Ce[Ie++]=He>>6|192;else{if(55296<=He&&57343>=He){if(56319>=He&&$e<U.length){var lt=U.charCodeAt(++$e);if(56320<=lt&&57343>=lt){He=1024*(He-55296)+lt-56320+65536,Ce[Ie++]=He>>18|240,Ce[Ie++]=He>>12&63|128,Ce[Ie++]=He>>6&63|128,Ce[Ie++]=He&63|128;continue}else $e--}if(oe)throw Error("Found an unpaired surrogate");He=65533}Ce[Ie++]=He>>12|224,Ce[Ie++]=He>>6&63|128}Ce[Ie++]=He&63|128}}U=Ie===Ce.length?Ce:Ce.subarray(0,Ie)}mn($.h,8*H+2),mn($.h,U.length),Es($,$.h.end()),Es($,U)}}),dr=ea(function($,U,H,oe,Ie){if($.i!==2)return!1;U=Xo(U,H,oe),H=$.h.j,oe=vt($.h)>>>0;var Ce=$.h.h+oe,$e=Ce-H;if(0>=$e&&($.h.j=Ce,Ie(U,$,void 0,void 0,void 0),$e=Ce-$.h.h),$e)throw Error("Message parsing ended unexpectedly. Expected to read "+(oe+" bytes, instead read "+(oe-$e)+" bytes, either the data ended unexpectedly or the message misreported its own length"));return $.h.h=Ce,$.h.j=H,!0},function($,U,H,oe,Ie){if(U=an(U,oe,H),U!=null)for(oe=0;oe<U.length;oe++){var Ce=$;mn(Ce.h,8*H+2);var $e=Ce.h.end();Es(Ce,$e),$e.push(Ce.i),Ce=$e,Ie(U[oe],$),$e=$;var He=Ce.pop();for(He=$e.i+$e.h.length()-He;127<He;)Ce.push(He&127|128),He>>>=7,$e.i++;Ce.push(He),$e.i++}});function qu($){return function(U,H){e:{if(Ps.length){var oe=Ps.pop();oe.setOptions(H),Ke(oe.h,U,H),U=oe}else U=new hn(U,H);try{var Ie=zl($),Ce=Eo(new Ie.P,U,Ie);break e}finally{Ie=U.h,Ie.i=null,Ie.m=!1,Ie.l=0,Ie.j=0,Ie.h=0,Ie.S=!1,U.l=-1,U.i=-1,100>Ps.length&&Ps.push(U)}Ce=void 0}return Ce}}function Xu($){return function(){var U=new ms;Hu(this,U,vi($)),Es(U,U.h.end());for(var H=new Uint8Array(U.i),oe=U.j,Ie=oe.length,Ce=0,$e=0;$e<Ie;$e++){var He=oe[$e];H.set(He,Ce),Ce+=He.length}return U.j=[H],H}}function Ca($){Yr.call(this,$)}g(Ca,Yr);var Ku=[Ca,1,Pd,2,Ys,3,hr,4,hr];Ca.prototype.l=Xu(Ku);function Zs($){Yr.call(this,$,-1,Qo)}g(Zs,Yr),Zs.prototype.addClassification=function($,U){return Xo(this,1,Ca,$,U),this};var Qo=[1],$a=qu([Zs,1,dr,Ku]);function Jo($){Yr.call(this,$)}g(Jo,Yr);var gr=[Jo,1,Ys,2,Ys,3,Ys,4,Ys,5,Ys];Jo.prototype.l=Xu(gr);function bi($){Yr.call(this,$,-1,ta)}g(bi,Yr);var ta=[1],ei=qu([bi,1,dr,gr]);function ti($){Yr.call(this,$)}g(ti,Yr);var $s=[ti,1,Ys,2,Ys,3,Ys,4,Ys,5,Ys,6,hh],Yu=qu($s);ti.prototype.l=Xu($s);function Vl($,U,H){if(H=$.createShader(H===0?$.VERTEX_SHADER:$.FRAGMENT_SHADER),$.shaderSource(H,U),$.compileShader(H),!$.getShaderParameter(H,$.COMPILE_STATUS))throw Error(`Could not compile WebGL shader.

`+$.getShaderInfoLog(H));return H}function Zu($){return an($,Ca,1).map(function(U){var H=_n(U,1);return{index:H==null?0:H,qa:Cs(U,2),label:_n(U,3)!=null?Ko(_n(U,3),""):void 0,displayName:_n(U,4)!=null?Ko(_n(U,4),""):void 0}})}function Qu($){return{x:Cs($,1),y:Cs($,2),z:Cs($,3),visibility:Bt($,4)!=null?Cs($,4):void 0}}function al($,U){this.i=$,this.h=U,this.m=0}function ll($,U,H){return Ns($,U),typeof $.h.canvas.transferToImageBitmap=="function"?Promise.resolve($.h.canvas.transferToImageBitmap()):H?Promise.resolve($.h.canvas):typeof createImageBitmap=="function"?createImageBitmap($.h.canvas):($.j===void 0&&($.j=document.createElement("canvas")),new Promise(function(oe){$.j.height=$.h.canvas.height,$.j.width=$.h.canvas.width,$.j.getContext("2d",{}).drawImage($.h.canvas,0,0,$.h.canvas.width,$.h.canvas.height),oe($.j)}))}function Ns($,U){var H=$.h;if($.s===void 0){var oe=Vl(H,`
  attribute vec2 aVertex;
  attribute vec2 aTex;
  varying vec2 vTex;
  void main(void) {
    gl_Position = vec4(aVertex, 0.0, 1.0);
    vTex = aTex;
  }`,0),Ie=Vl(H,`
  precision mediump float;
  varying vec2 vTex;
  uniform sampler2D sampler0;
  void main(){
    gl_FragColor = texture2D(sampler0, vTex);
  }`,1),Ce=H.createProgram();if(H.attachShader(Ce,oe),H.attachShader(Ce,Ie),H.linkProgram(Ce),!H.getProgramParameter(Ce,H.LINK_STATUS))throw Error(`Could not compile WebGL program.

`+H.getProgramInfoLog(Ce));oe=$.s=Ce,H.useProgram(oe),Ie=H.getUniformLocation(oe,"sampler0"),$.l={O:H.getAttribLocation(oe,"aVertex"),N:H.getAttribLocation(oe,"aTex"),ya:Ie},$.v=H.createBuffer(),H.bindBuffer(H.ARRAY_BUFFER,$.v),H.enableVertexAttribArray($.l.O),H.vertexAttribPointer($.l.O,2,H.FLOAT,!1,0,0),H.bufferData(H.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),H.STATIC_DRAW),H.bindBuffer(H.ARRAY_BUFFER,null),$.u=H.createBuffer(),H.bindBuffer(H.ARRAY_BUFFER,$.u),H.enableVertexAttribArray($.l.N),H.vertexAttribPointer($.l.N,2,H.FLOAT,!1,0,0),H.bufferData(H.ARRAY_BUFFER,new Float32Array([0,1,0,0,1,0,1,1]),H.STATIC_DRAW),H.bindBuffer(H.ARRAY_BUFFER,null),H.uniform1i(Ie,0)}oe=$.l,H.useProgram($.s),H.canvas.width=U.width,H.canvas.height=U.height,H.viewport(0,0,U.width,U.height),H.activeTexture(H.TEXTURE0),$.i.bindTexture2d(U.glName),H.enableVertexAttribArray(oe.O),H.bindBuffer(H.ARRAY_BUFFER,$.v),H.vertexAttribPointer(oe.O,2,H.FLOAT,!1,0,0),H.enableVertexAttribArray(oe.N),H.bindBuffer(H.ARRAY_BUFFER,$.u),H.vertexAttribPointer(oe.N,2,H.FLOAT,!1,0,0),H.bindFramebuffer(H.DRAW_FRAMEBUFFER?H.DRAW_FRAMEBUFFER:H.FRAMEBUFFER,null),H.clearColor(0,0,0,0),H.clear(H.COLOR_BUFFER_BIT),H.colorMask(!0,!0,!0,!0),H.drawArrays(H.TRIANGLE_FAN,0,4),H.disableVertexAttribArray(oe.O),H.disableVertexAttribArray(oe.N),H.bindBuffer(H.ARRAY_BUFFER,null),$.i.bindTexture2d(0)}function dh($){this.h=$}var Us=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11]);function fh($,U){return U+$}function Gl($,U){window[$]=U}function ni($){var U=document.createElement("script");return U.setAttribute("src",$),U.setAttribute("crossorigin","anonymous"),new Promise(function(H){U.addEventListener("load",function(){H()},!1),U.addEventListener("error",function(){H()},!1),document.body.appendChild(U)})}function ul(){return M(function($){switch($.h){case 1:return $.s=2,w($,WebAssembly.instantiate(Us),4);case 4:$.h=3,$.s=0;break;case 2:return $.s=0,$.l=null,$.return(!1);case 3:return $.return(!0)}})}function Na($){if(this.h=$,this.listeners={},this.l={},this.L={},this.s={},this.v={},this.M=this.u=this.ga=!0,this.I=Promise.resolve(),this.fa="",this.D={},this.locateFile=$&&$.locateFile||fh,typeof window=="object")var U=window.location.pathname.toString().substring(0,window.location.pathname.toString().lastIndexOf("/"))+"/";else if(typeof location!="undefined")U=location.pathname.toString().substring(0,location.pathname.toString().lastIndexOf("/"))+"/";else throw Error("solutions can only be loaded on a web page or in a web worker");if(this.ha=U,$.options){U=i(Object.keys($.options));for(var H=U.next();!H.done;H=U.next()){H=H.value;var oe=$.options[H].default;oe!==void 0&&(this.l[H]=typeof oe=="function"?oe():oe)}}}r=Na.prototype,r.close=function(){return this.j&&this.j.delete(),Promise.resolve()};function Sr($){var U,H,oe,Ie,Ce,$e,He,lt,Ct,jt,wn;return M(function(on){switch(on.h){case 1:return $.ga?(U=$.h.files===void 0?[]:typeof $.h.files=="function"?$.h.files($.l):$.h.files,w(on,ul(),2)):on.return();case 2:if(H=on.i,typeof window=="object")return Gl("createMediapipeSolutionsWasm",{locateFile:$.locateFile}),Gl("createMediapipeSolutionsPackedAssets",{locateFile:$.locateFile}),$e=U.filter(function(It){return It.data!==void 0}),He=U.filter(function(It){return It.data===void 0}),lt=Promise.all($e.map(function(It){var bn=Ra($,It.url);if(It.path!==void 0){var S=It.path;bn=bn.then(function(k){return $.overrideFile(S,k),Promise.resolve(k)})}return bn})),Ct=Promise.all(He.map(function(It){return It.simd===void 0||It.simd&&H||!It.simd&&!H?ni($.locateFile(It.url,$.ha)):Promise.resolve()})).then(function(){var It,bn,S;return M(function(k){if(k.h==1)return It=window.createMediapipeSolutionsWasm,bn=window.createMediapipeSolutionsPackedAssets,S=$,w(k,It(bn),2);S.i=k.i,k.h=0})}),jt=function(){return M(function(It){return $.h.graph&&$.h.graph.url?It=w(It,Ra($,$.h.graph.url),0):(It.h=0,It=void 0),It})}(),w(on,Promise.all([Ct,lt,jt]),7);if(typeof importScripts!="function")throw Error("solutions can only be loaded on a web page or in a web worker");return oe=U.filter(function(It){return It.simd===void 0||It.simd&&H||!It.simd&&!H}).map(function(It){return $.locateFile(It.url,$.ha)}),importScripts.apply(null,l(oe)),Ie=$,w(on,createMediapipeSolutionsWasm(Module),6);case 6:Ie.i=on.i,$.m=new OffscreenCanvas(1,1),$.i.canvas=$.m,Ce=$.i.GL.createContext($.m,{antialias:!1,alpha:!1,va:typeof WebGL2RenderingContext!="undefined"?2:1}),$.i.GL.makeContextCurrent(Ce),on.h=4;break;case 7:if($.m=document.createElement("canvas"),wn=$.m.getContext("webgl2",{}),!wn&&(wn=$.m.getContext("webgl",{}),!wn))return alert("Failed to create WebGL canvas context when passing video frame."),on.return();$.K=wn,$.i.canvas=$.m,$.i.createContext($.m,!0,!0,{});case 4:$.j=new $.i.SolutionWasm,$.ga=!1,on.h=0}})}function Co($){var U,H,oe,Ie,Ce,$e,He,lt;return M(function(Ct){if(Ct.h==1){if($.h.graph&&$.h.graph.url&&$.fa===$.h.graph.url)return Ct.return();if($.u=!0,!$.h.graph||!$.h.graph.url){Ct.h=2;return}return $.fa=$.h.graph.url,w(Ct,Ra($,$.h.graph.url),3)}for(Ct.h!=2&&(U=Ct.i,$.j.loadGraph(U)),H=i(Object.keys($.D)),oe=H.next();!oe.done;oe=H.next())Ie=oe.value,$.j.overrideFile(Ie,$.D[Ie]);if($.D={},$.h.listeners)for(Ce=i($.h.listeners),$e=Ce.next();!$e.done;$e=Ce.next())He=$e.value,wi($,He);lt=$.l,$.l={},$.setOptions(lt),Ct.h=0})}r.reset=function(){var $=this;return M(function(U){$.j&&($.j.reset(),$.s={},$.v={}),U.h=0})},r.setOptions=function($,U){var H=this;if(U=U||this.h.options){for(var oe=[],Ie=[],Ce={},$e=i(Object.keys($)),He=$e.next();!He.done;Ce={X:Ce.X,Y:Ce.Y},He=$e.next())if(He=He.value,!(He in this.l&&this.l[He]===$[He])){this.l[He]=$[He];var lt=U[He];lt!==void 0&&(lt.onChange&&(Ce.X=lt.onChange,Ce.Y=$[He],oe.push(function(Ct){return function(){var jt;return M(function(wn){if(wn.h==1)return w(wn,Ct.X(Ct.Y),2);jt=wn.i,jt===!0&&(H.u=!0),wn.h=0})}}(Ce))),lt.graphOptionXref&&(He=Object.assign({},{calculatorName:"",calculatorIndex:0},lt.graphOptionXref,{valueNumber:lt.type===1?$[He]:0,valueBoolean:lt.type===0?$[He]:!1,valueString:lt.type===2?$[He]:""}),Ie.push(He)))}(oe.length!==0||Ie.length!==0)&&(this.u=!0,this.H=(this.H===void 0?[]:this.H).concat(Ie),this.F=(this.F===void 0?[]:this.F).concat(oe))}};function Aa($){var U,H,oe,Ie,Ce,$e,He;return M(function(lt){switch(lt.h){case 1:if(!$.u)return lt.return();if(!$.F){lt.h=2;break}U=i($.F),H=U.next();case 3:if(H.done){lt.h=5;break}return oe=H.value,w(lt,oe(),4);case 4:H=U.next(),lt.h=3;break;case 5:$.F=void 0;case 2:if($.H){for(Ie=new $.i.GraphOptionChangeRequestList,Ce=i($.H),$e=Ce.next();!$e.done;$e=Ce.next())He=$e.value,Ie.push_back(He);$.j.changeOptions(Ie),Ie.delete(),$.H=void 0}$.u=!1,lt.h=0}})}r.initialize=function(){var $=this;return M(function(U){return U.h==1?w(U,Sr($),2):U.h!=3?w(U,Co($),3):w(U,Aa($),0)})};function Ra($,U){var H,oe;return M(function(Ie){return U in $.L?Ie.return($.L[U]):(H=$.locateFile(U,""),oe=fetch(H).then(function(Ce){return Ce.arrayBuffer()}),$.L[U]=oe,Ie.return(oe))})}r.overrideFile=function($,U){this.j?this.j.overrideFile($,U):this.D[$]=U},r.clearOverriddenFiles=function(){this.D={},this.j&&this.j.clearOverriddenFiles()},r.send=function($,U){var H=this,oe,Ie,Ce,$e,He,lt,Ct,jt,wn;return M(function(on){switch(on.h){case 1:return H.h.inputs?(oe=1e3*(U==null?performance.now():U),w(on,H.I,2)):on.return();case 2:return w(on,H.initialize(),3);case 3:for(Ie=new H.i.PacketDataList,Ce=i(Object.keys($)),$e=Ce.next();!$e.done;$e=Ce.next())if(He=$e.value,lt=H.h.inputs[He]){e:{var It=$[He];switch(lt.type){case"video":var bn=H.s[lt.stream];if(bn||(bn=new al(H.i,H.K),H.s[lt.stream]=bn),bn.m===0&&(bn.m=bn.i.createTexture()),typeof HTMLVideoElement!="undefined"&&It instanceof HTMLVideoElement)var S=It.videoWidth,k=It.videoHeight;else typeof HTMLImageElement!="undefined"&&It instanceof HTMLImageElement?(S=It.naturalWidth,k=It.naturalHeight):(S=It.width,k=It.height);k={glName:bn.m,width:S,height:k},S=bn.h,S.canvas.width=k.width,S.canvas.height=k.height,S.activeTexture(S.TEXTURE0),bn.i.bindTexture2d(bn.m),S.texImage2D(S.TEXTURE_2D,0,S.RGBA,S.RGBA,S.UNSIGNED_BYTE,It),bn.i.bindTexture2d(0),bn=k;break e;case"detections":for(bn=H.s[lt.stream],bn||(bn=new dh(H.i),H.s[lt.stream]=bn),bn.data||(bn.data=new bn.h.DetectionListData),bn.data.reset(It.length),k=0;k<It.length;++k){S=It[k];var E=bn.data,A=E.setBoundingBox,L=k,V=S.la,q=new ti;if(gs(q,1,V.sa),gs(q,2,V.ta),gs(q,3,V.height),gs(q,4,V.width),gs(q,5,V.rotation),En(q,6,V.pa),V=q.l(),A.call(E,L,V),S.ea)for(E=0;E<S.ea.length;++E){q=S.ea[E],A=bn.data,L=A.addNormalizedLandmark,V=k,q=Object.assign({},q,{visibility:q.visibility?q.visibility:0});var se=new Jo;gs(se,1,q.x),gs(se,2,q.y),gs(se,3,q.z),q.visibility&&gs(se,4,q.visibility),q=se.l(),L.call(A,V,q)}if(S.ba)for(E=0;E<S.ba.length;++E)A=bn.data,L=A.addClassification,V=k,q=S.ba[E],se=new Ca,gs(se,2,q.qa),q.index&&En(se,1,q.index),q.label&&En(se,3,q.label),q.displayName&&En(se,4,q.displayName),q=se.l(),L.call(A,V,q)}bn=bn.data;break e;default:bn={}}}switch(Ct=bn,jt=lt.stream,lt.type){case"video":Ie.pushTexture2d(Object.assign({},Ct,{stream:jt,timestamp:oe}));break;case"detections":wn=Ct,wn.stream=jt,wn.timestamp=oe,Ie.pushDetectionList(wn);break;default:throw Error("Unknown input config type: '"+lt.type+"'")}}return H.j.send(Ie),w(on,H.I,4);case 4:Ie.delete(),on.h=0}})};function Wl($,U,H){var oe,Ie,Ce,$e,He,lt,Ct,jt,wn,on,It,bn,S,k;return M(function(E){switch(E.h){case 1:if(!H)return E.return(U);for(oe={},Ie=0,Ce=i(Object.keys(H)),$e=Ce.next();!$e.done;$e=Ce.next())He=$e.value,lt=H[He],typeof lt!="string"&&lt.type==="texture"&&U[lt.stream]!==void 0&&++Ie;1<Ie&&($.M=!1),Ct=i(Object.keys(H)),$e=Ct.next();case 2:if($e.done){E.h=4;break}if(jt=$e.value,wn=H[jt],typeof wn=="string")return S=oe,k=jt,w(E,xi($,jt,U[wn]),14);if(on=U[wn.stream],wn.type==="detection_list"){if(on){for(var A=on.getRectList(),L=on.getLandmarksList(),V=on.getClassificationsList(),q=[],se=0;se<A.size();++se){var ae=Yu(A.get(se)),_e=Cs(ae,1),je=Cs(ae,2),qe=Cs(ae,3),ge=Cs(ae,4),$t=Cs(ae,5,0),wt=void 0;wt=wt===void 0?0:wt,ae={la:{sa:_e,ta:je,height:qe,width:ge,rotation:$t,pa:Ko(_n(ae,6),wt)},ea:an(ei(L.get(se)),Jo,1).map(Qu),ba:Zu($a(V.get(se)))},q.push(ae)}A=q}else A=[];oe[jt]=A,E.h=7;break}if(wn.type==="proto_list"){if(on){for(A=Array(on.size()),L=0;L<on.size();L++)A[L]=on.get(L);on.delete()}else A=[];oe[jt]=A,E.h=7;break}if(on===void 0){E.h=3;break}if(wn.type==="float_list"){oe[jt]=on,E.h=7;break}if(wn.type==="proto"){oe[jt]=on,E.h=7;break}if(wn.type!=="texture")throw Error("Unknown output config type: '"+wn.type+"'");return It=$.v[jt],It||(It=new al($.i,$.K),$.v[jt]=It),w(E,ll(It,on,$.M),13);case 13:bn=E.i,oe[jt]=bn;case 7:wn.transform&&oe[jt]&&(oe[jt]=wn.transform(oe[jt])),E.h=3;break;case 14:S[k]=E.i;case 3:$e=Ct.next(),E.h=2;break;case 4:return E.return(oe)}})}function xi($,U,H){var oe;return M(function(Ie){return typeof H=="number"||H instanceof Uint8Array||H instanceof $.i.Uint8BlobList?Ie.return(H):H instanceof $.i.Texture2dDataOut?(oe=$.v[U],oe||(oe=new al($.i,$.K),$.v[U]=oe),Ie.return(ll(oe,H,$.M))):Ie.return(void 0)})}function wi($,U){for(var H=U.name||"$",oe=[].concat(l(U.wants)),Ie=new $.i.StringList,Ce=i(U.wants),$e=Ce.next();!$e.done;$e=Ce.next())Ie.push_back($e.value);Ce=$.i.PacketListener.implement({onResults:function(He){for(var lt={},Ct=0;Ct<U.wants.length;++Ct)lt[oe[Ct]]=He.get(Ct);var jt=$.listeners[H];jt&&($.I=Wl($,lt,U.outs).then(function(wn){wn=jt(wn);for(var on=0;on<U.wants.length;++on){var It=lt[oe[on]];typeof It=="object"&&It.hasOwnProperty&&It.hasOwnProperty("delete")&&It.delete()}wn&&($.I=wn)}))}}),$.j.attachMultiListener(Ie,Ce),Ie.delete()}r.onResults=function($,U){this.listeners[U||"$"]=$},z("Solution",Na),z("OptionType",{BOOL:0,NUMBER:1,ua:2,0:"BOOL",1:"NUMBER",2:"STRING"});function Qt($){switch($===void 0&&($=0),$){case 1:return"selfie_segmentation_landscape.tflite";default:return"selfie_segmentation.tflite"}}function Ju($){var U=this;$=$||{},this.h=new Na({locateFile:$.locateFile,files:function(H){return[{simd:!0,url:"selfie_segmentation_solution_simd_wasm_bin.js"},{simd:!1,url:"selfie_segmentation_solution_wasm_bin.js"},{data:!0,url:Qt(H.modelSelection)}]},graph:{url:"selfie_segmentation.binarypb"},listeners:[{wants:["segmentation_mask","image_transformed"],outs:{image:{type:"texture",stream:"image_transformed"},segmentationMask:{type:"texture",stream:"segmentation_mask"}}}],inputs:{image:{type:"video",stream:"input_frames_gpu"}},options:{useCpuInference:{type:0,graphOptionXref:{calculatorType:"InferenceCalculator",fieldName:"use_cpu_inference"},default:typeof window!="object"||window.navigator===void 0?!1:"iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";").includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document},selfieMode:{type:0,graphOptionXref:{calculatorType:"GlScalerCalculator",calculatorIndex:1,fieldName:"flip_horizontal"}},modelSelection:{type:1,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorModelSelection",fieldName:"int_value"},onChange:function(H){var oe,Ie,Ce;return M(function($e){return $e.h==1?(oe=Qt(H),Ie="third_party/mediapipe/modules/selfie_segmentation/"+oe,w($e,Ra(U.h,oe),2)):(Ce=$e.i,U.h.overrideFile(Ie,Ce),$e.return(!0))})}}}})}r=Ju.prototype,r.close=function(){return this.h.close(),Promise.resolve()},r.onResults=function($){this.h.onResults($)},r.initialize=function(){var $=this;return M(function(U){return w(U,$.h.initialize(),0)})},r.reset=function(){this.h.reset()},r.send=function($){var U=this;return M(function(H){return w(H,U.h.send($),0)})},r.setOptions=function($){this.h.setOptions($)},z("SelfieSegmentation",Ju),z("VERSION","0.1.1675465747")}).call(Pr);/**
    * @license
    * Copyright 2022 Google LLC. All Rights Reserved.
    * Licensed under the Apache License, Version 2.0 (the "License");
    * you may not use this file except in compliance with the License.
    * You may obtain a copy of the License at
    *
    * http://www.apache.org/licenses/LICENSE-2.0
    *
    * Unless required by applicable law or agreed to in writing, software
    * distributed under the License is distributed on an "AS IS" BASIS,
    * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    * See the License for the specific language governing permissions and
    * limitations under the License.
    * =============================================================================
    */var Fx=function(r,e){return Fx=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var s in n)n.hasOwnProperty(s)&&(t[s]=n[s])},Fx(r,e)};function c4(r,e){function t(){this.constructor=r}Fx(r,e),r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var eo=function(){return eo=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++)for(var s in e=arguments[t])Object.prototype.hasOwnProperty.call(e,s)&&(r[s]=e[s]);return r},eo.apply(this,arguments)};function vr(r,e,t,n){return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(h){o(h)}}function i(u){try{l(n.throw(u))}catch(h){o(h)}}function l(u){var h;u.done?s(u.value):(h=u.value,h instanceof t?h:new t(function(d){d(h)})).then(a,i)}l((n=n.apply(r,e||[])).next())})}function br(r,e){var t,n,s,o,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function i(l){return function(u){return function(h){if(t)throw new TypeError("Generator is already executing.");for(;a;)try{if(t=1,n&&(s=2&h[0]?n.return:h[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,h[1])).done)return s;switch(n=0,s&&(h=[2&h[0],s.value]),h[0]){case 0:case 1:s=h;break;case 4:return a.label++,{value:h[1],done:!1};case 5:a.label++,n=h[1],h=[0];continue;case 7:h=a.ops.pop(),a.trys.pop();continue;default:if(s=a.trys,!((s=s.length>0&&s[s.length-1])||h[0]!==6&&h[0]!==2)){a=0;continue}if(h[0]===3&&(!s||h[1]>s[0]&&h[1]<s[3])){a.label=h[1];break}if(h[0]===6&&a.label<s[1]){a.label=s[1],s=h;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(h);break}s[2]&&a.ops.pop(),a.trys.pop();continue}h=e.call(r,a)}catch(d){h=[6,d],n=0}finally{t=s=0}if(5&h[0])throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}([l,u])}}}function Py(r){return r instanceof SVGAnimatedLength?r.baseVal.value:r}function L_(r){return vr(this,void 0,void 0,function(){var e,t;return br(this,function(n){switch(n.label){case 0:return e=document.createElement("canvas"),r instanceof pr?[4,S1(r,e)]:[3,2];case 1:return n.sent(),[3,3];case 2:e.width=Py(r.width),e.height=Py(r.height),t=e.getContext("2d"),r instanceof ImageData?t.putImageData(r,0,0):t.drawImage(r,0,0),n.label=3;case 3:return[2,e]}})})}function h4(r){return vr(this,void 0,void 0,function(){var e,t,n,s,o,a;return br(this,function(i){switch(i.label){case 0:return r instanceof pr?(e=r.shape.slice(0,2),t=e[0],n=e[1],s=ImageData.bind,[4,S1(r)]):[3,2];case 1:return[2,new(s.apply(ImageData,[void 0,i.sent(),n,t]))];case 2:return o=document.createElement("canvas"),a=o.getContext("2d"),o.width=Py(r.width),o.height=Py(r.height),a.drawImage(r,0,0),[2,a.getImageData(0,0,o.width,o.height)]}})})}function d4(r){return vr(this,void 0,void 0,function(){var e,t;return br(this,function(n){switch(n.label){case 0:return r instanceof SVGImageElement||r instanceof OffscreenCanvas?[4,L_(r)]:[3,2];case 1:return t=n.sent(),[3,3];case 2:t=r,n.label=3;case 3:return e=t,[2,Sm(e,4)]}})})}function z1(r){if(r<0||r>=256)throw new Error("Mask value must be in range [0, 255] but got "+r);if(!Number.isInteger(r))throw new Error("Mask value must be an integer but got "+r)}function f4(r){var e=r.shape[2],t=_1(r,2),n=bt(t,[-1]);return fd(n,e)}function Dg(r,e){return Vt(function(){return zn(sh(r,Nn(e)),"int32")})}function cTe(r,e){var t=e.shape,n=t[0],s=t[1],o=t[2];return Vt(function(){var a=f4(e),i=Rs(nl(0,o,1,"int32"),1),l=zn(or(a,i),"int32"),u=bt(l,[n,s]),h=xn(u,Nn(1,"int32"));return Rn(function(d,c){return Ut(d,c)}(h,r),Nn(1,"int32"))})}var p4=function(){function r(e,t){this.model=e,this.outputStride=t;var n=this.model.inputs[0].shape;Te(n[1]===-1&&n[2]===-1,function(){return"Input shape ["+n[1]+", "+n[2]+"] must both be equal to or -1"})}return r.prototype.predict=function(e){var t=this;return Vt(function(){var n=t.preprocessInput(zn(e,"float32")),s=Rs(n,0),o=t.model.predict(s).map(function(i){return cs(i,[0])}),a=t.nameOutputResults(o);return{heatmapScores:zi(a.heatmap),offsets:a.offsets,displacementFwd:a.displacementFwd,displacementBwd:a.displacementBwd,segmentation:a.segmentation,partHeatmaps:a.partHeatmaps,longOffsets:a.longOffsets,partOffsets:a.partOffsets}})},r.prototype.dispose=function(){this.model.dispose()},r}(),hTe=function(r){function e(){return r!==null&&r.apply(this,arguments)||this}return c4(e,r),e.prototype.preprocessInput=function(t){return Vt(function(){return Rn(kr(t,127.5),1)})},e.prototype.nameOutputResults=function(t){return{offsets:t[0],segmentation:t[1],partHeatmaps:t[2],longOffsets:t[3],heatmap:t[4],displacementFwd:t[5],displacementBwd:t[6],partOffsets:t[7]}},e}(p4),V1=["nose","leftEye","rightEye","leftEar","rightEar","leftShoulder","rightShoulder","leftElbow","rightElbow","leftWrist","rightWrist","leftHip","rightHip","leftKnee","rightKnee","leftAnkle","rightAnkle"],ha=V1.length,jy=V1.reduce(function(r,e,t){return r[e]=t,r},{});[["leftHip","leftShoulder"],["leftElbow","leftShoulder"],["leftElbow","leftWrist"],["leftHip","leftKnee"],["leftKnee","leftAnkle"],["rightHip","rightShoulder"],["rightElbow","rightShoulder"],["rightElbow","rightWrist"],["rightHip","rightKnee"],["rightKnee","rightAnkle"],["leftShoulder","rightShoulder"],["leftHip","rightHip"]].map(function(r){var e=r[0],t=r[1];return[jy[e],jy[t]]});function P_(r,e,t){var n=r[0],s=r[1],o=e[0],a=e[1],i=t.top,l=t.bottom;return[a/(t.left+t.right+s),o/(i+l+n)]}function m4(r,e,t,n){return{y:n.get(r,e,t),x:n.get(r,e,t+ha)}}function g4(r,e,t){var n=m4(r.heatmapY,r.heatmapX,r.id,t),s=n.y,o=n.x;return{x:r.heatmapX*e+o,y:r.heatmapY*e+s}}function XE(r,e,t){return r<e?e:r>t?t:r}function KE(r,e){return{x:r.x+e.x,y:r.y+e.y}}function dTe(r,e,t){t===void 0&&(t=.3);for(var n=0,s=0,o=0;o<r.length;o++)e.keypoints[o].score>t&&(s+=1,n+=Math.pow(r[o].x-e.keypoints[o].position.x,2)+Math.pow(r[o].y-e.keypoints[o].position.y,2));return s===0?n=1/0:n/=s,n}function fTe(r,e,t,n,s,o,a){for(var i=a[0],l=a[1],u=t(r),h=u.y*n+u.x,d=s[ha*(2*h)+e],c=s[ha*(2*h+1)+e],f=r.y+d,p=r.x+c,m=0;m<o;m++){f=Math.min(f,i-1);var g=t({x:p=Math.min(p,l-1),y:f}),y=g.y*n+g.x;f+=d=s[ha*(2*y)+e],p+=c=s[ha*(2*y+1)+e]}return{x:p,y:f}}function y4(r,e,t,n,s,o,a,i,l,u){for(var h=s[0],d=s[1],c=o[0],f=o[1],p=i[0],m=i[1],g=[],y=function(N){return function(O,D,M,P){var F=D[0],B=D[1],z=M[0],Z=M[1],Q=Math.round(((F+O.y+1)*Z-1)/P);return{x:Math.round(((B+O.x+1)*z-1)/P),y:Q}}(N,[h,d],[c,f],l)},v=0;v<n;v++){var b=fTe(r,v,y,a,e,u,[p,m]);g.push(b)}for(var w=-1,_=1/0,I=0;I<t.length;I++){var C=dTe(g,t[I]);C<_&&(w=I,_=C)}return w}function v4(r,e){var t=r[0],n=r[1];return[Math.round((n-1)/e+1),Math.round((t-1)/e+1)]}function b4(r,e,t,n,s,o,a,i,l,u,h){for(var d=a[0],c=a[1],f=r.shape,p=f[0],m=f[1],g=e.shape.slice(0,2),y=g[0],v=g[1],b=bt(e,[y,v,2,ha]),w=new Float32Array(h*ha*3).fill(0),_=0;_<t.length;_++)for(var I=_*ha*3,C=t[_],N=0;N<ha;N++){var O=C.keypoints[N],D=I+3*N;w[D]=O.score,w[D+1]=O.position.y,w[D+2]=O.position.x}var M=P_([n,s],[d,c],i),P=M[0],F=M[1],B=Ui(w,[h,ha,3]),z=i.top,Z=i.left,Q={variableNames:["segmentation","longOffsets","poses"],outputShape:[p,m],userCode:`
    int convertToPositionInOutput(int pos, int pad, float scale, int stride) {
      return round(((float(pos + pad) + 1.0) * scale - 1.0) / float(stride));
    }

    float convertToPositionInOutputFloat(
        int pos, int pad, float scale, int stride) {
      return ((float(pos + pad) + 1.0) * scale - 1.0) / float(stride);
    }

    float dist(float x1, float y1, float x2, float y2) {
      return pow(x1 - x2, 2.0) + pow(y1 - y2, 2.0);
    }

    float sampleLongOffsets(float h, float w, int d, int k) {
      float fh = fract(h);
      float fw = fract(w);
      int clH = int(ceil(h));
      int clW = int(ceil(w));
      int flH = int(floor(h));
      int flW = int(floor(w));
      float o11 = getLongOffsets(flH, flW, d, k);
      float o12 = getLongOffsets(flH, clW, d, k);
      float o21 = getLongOffsets(clH, flW, d, k);
      float o22 = getLongOffsets(clH, clW, d, k);
      float o1 = mix(o11, o12, fw);
      float o2 = mix(o21, o22, fw);
      return mix(o1, o2, fh);
    }

    int findNearestPose(int h, int w) {
      float prob = getSegmentation(h, w);
      if (prob < 1.0) {
        return -1;
      }

      // Done(Tyler): convert from output space h/w to strided space.
      float stridedH = convertToPositionInOutputFloat(
        h, `+z+", "+F+", "+o+`);
      float stridedW = convertToPositionInOutputFloat(
        w, `+Z+", "+P+", "+o+`);

      float minDist = 1000000.0;
      int iMin = -1;
      for (int i = 0; i < `+h+`; i++) {
        float curDistSum = 0.0;
        int numKpt = 0;
        for (int k = 0; k < `+ha+`; k++) {
          float dy = sampleLongOffsets(stridedH, stridedW, 0, k);
          float dx = sampleLongOffsets(stridedH, stridedW, 1, k);

          float y = float(h) + dy;
          float x = float(w) + dx;

          for (int s = 0; s < `+l+`; s++) {
            int yRounded = round(min(y, float(`+(n-1)+`)));
            int xRounded = round(min(x, float(`+(s-1)+`)));

            float yStrided = convertToPositionInOutputFloat(
              yRounded, `+z+", "+F+", "+o+`);
            float xStrided = convertToPositionInOutputFloat(
              xRounded, `+Z+", "+P+", "+o+`);

            float dy = sampleLongOffsets(yStrided, xStrided, 0, k);
            float dx = sampleLongOffsets(yStrided, xStrided, 1, k);

            y = y + dy;
            x = x + dx;
          }

          float poseScore = getPoses(i, k, 0);
          float poseY = getPoses(i, k, 1);
          float poseX = getPoses(i, k, 2);
          if (poseScore > `+u+`) {
            numKpt = numKpt + 1;
            curDistSum = curDistSum + dist(x, y, poseX, poseY);
          }
        }
        if (numKpt > 0 && curDistSum / float(numKpt) < minDist) {
          minDist = curDistSum / float(numKpt);
          iMin = i;
        }
      }
      return iMin;
    }

    void main() {
        ivec2 coords = getOutputCoords();
        int nearestPose = findNearestPose(coords[0], coords[1]);
        setOutput(float(nearestPose));
      }
  `};return QS().compileAndRun(Q,[r,b,B])}function x4(){return ZS()==="webgl"}function pTe(r,e,t,n,s,o,a,i,l,u,h,d){var c=a[0],f=a[1];return l===void 0&&(l=.2),u===void 0&&(u=8),h===void 0&&(h=.3),d===void 0&&(d=10),vr(this,void 0,void 0,function(){var p,m,g,y,v;return br(this,function(b){switch(b.label){case 0:return p=t.filter(function(w){return w.score>=l}),x4()?(g=Vt(function(){var w=b4(r,e,p,n,s,o,[c,f],i,u,h,d),_=_m().makeTensorFromDataId(w.dataId,w.shape,w.dtype);return p.map(function(I,C){return function(N,O){return Vt(function(){return zn(rh(N,Nn(O)),"int32")})}(_,C)})}),[4,Promise.all(g.map(function(w){return w.data()}))]):[3,2];case 1:return m=b.sent(),g.forEach(function(w){return w.dispose()}),[3,5];case 2:return[4,r.data()];case 3:return y=b.sent(),[4,e.data()];case 4:v=b.sent(),m=function(w,_,I,C,N,O,D,M,P,F){var B=D[0],z=D[1];F===void 0&&(F=5);for(var Z=I.map(function(Ee){return new Uint8Array(C*N).fill(0)}),Q=M.top,K=M.left,ne=P_([C,N],[B,z],M),re=ne[0],ce=ne[1],be=v4([B,z],O)[0],we=0;we<C;we+=1)for(var ye=0;ye<N;ye+=1){var Oe=we*N+ye;if(w[Oe]===1){var Se=y4({x:ye,y:we},_,I,F,[Q,K],[re,ce],be,[C,N],O,P);Se>=0&&(Z[Se][Oe]=1)}}return Z}(y,v,p,n,s,o,[c,f],i,u),b.label=5;case 5:return[2,m.map(function(w,_){return{data:w,pose:p[_],width:s,height:n}})]}})})}function mTe(r,e,t,n,s,o,a,i,l,u,h,d,c){var f=i[0],p=i[1];return u===void 0&&(u=.2),h===void 0&&(h=8),d===void 0&&(d=.3),c===void 0&&(c=10),vr(this,void 0,void 0,function(){var m,g,y,v,b,w;return br(this,function(_){switch(_.label){case 0:return m=n.filter(function(I){return I.score>=u}),x4()?(y=Vt(function(){var I=b4(r,e,m,s,o,a,[f,p],l,h,d,c),C=_m().makeTensorFromDataId(I.dataId,I.shape,I.dtype);return m.map(function(N,O){return function(D,M,P){return Vt(function(){return Rn(Ut(zn(rh(D,Nn(P)),"int32"),xn(M,1)),1)})}(C,t,O)})}),[4,Promise.all(y.map(function(I){return I.data()}))]):[3,2];case 1:return g=_.sent(),y.forEach(function(I){return I.dispose()}),[3,6];case 2:return[4,r.data()];case 3:return v=_.sent(),[4,e.data()];case 4:return b=_.sent(),[4,t.data()];case 5:w=_.sent(),g=function(I,C,N,O,D,M,P,F,B,z,Z){var Q=F[0],K=F[1];Z===void 0&&(Z=5);for(var ne=O.map(function(J){return new Int32Array(D*M).fill(-1)}),re=B.top,ce=B.left,be=P_([D,M],[Q,K],B),we=be[0],ye=be[1],Oe=v4([Q,K],P)[0],Se=0;Se<D;Se+=1)for(var Ee=0;Ee<M;Ee+=1){var j=Se*M+Ee;if(I[j]===1){var W=y4({x:Ee,y:Se},C,O,Z,[re,ce],[we,ye],Oe,[D,M],P,z);W>=0&&(ne[W][j]=N[j])}}return ne}(v,b,w,m,s,o,a,[f,p],l,h),_.label=6;case 6:return[2,g.map(function(I,C){return{pose:m[C],data:I,height:s,width:o}})]}})})}function ub(r){return Math.floor(r/2)}var gTe=function(){function r(e,t){this.priorityQueue=new Array(e),this.numberOfElements=-1,this.getElementValue=t}return r.prototype.enqueue=function(e){this.priorityQueue[++this.numberOfElements]=e,this.swim(this.numberOfElements)},r.prototype.dequeue=function(){var e=this.priorityQueue[0];return this.exchange(0,this.numberOfElements--),this.sink(0),this.priorityQueue[this.numberOfElements+1]=null,e},r.prototype.empty=function(){return this.numberOfElements===-1},r.prototype.size=function(){return this.numberOfElements+1},r.prototype.all=function(){return this.priorityQueue.slice(0,this.numberOfElements+1)},r.prototype.max=function(){return this.priorityQueue[0]},r.prototype.swim=function(e){for(;e>0&&this.less(ub(e),e);)this.exchange(e,ub(e)),e=ub(e)},r.prototype.sink=function(e){for(;2*e<=this.numberOfElements;){var t=2*e;if(t<this.numberOfElements&&this.less(t,t+1)&&t++,!this.less(e,t))break;this.exchange(e,t),e=t}},r.prototype.getValueAt=function(e){return this.getElementValue(this.priorityQueue[e])},r.prototype.less=function(e,t){return this.getValueAt(e)<this.getValueAt(t)},r.prototype.exchange=function(e,t){var n=this.priorityQueue[e];this.priorityQueue[e]=this.priorityQueue[t],this.priorityQueue[t]=n},r}();function yTe(r,e,t,n,s,o){for(var a=o.shape,i=a[0],l=a[1],u=!0,h=Math.max(t-s,0),d=Math.min(t+s+1,i),c=h;c<d;++c){for(var f=Math.max(n-s,0),p=Math.min(n+s+1,l),m=f;m<p;++m)if(o.get(c,m,r)>e){u=!1;break}if(!u)break}return u}var w4=[["nose","leftEye"],["leftEye","leftEar"],["nose","rightEye"],["rightEye","rightEar"],["nose","leftShoulder"],["leftShoulder","leftElbow"],["leftElbow","leftWrist"],["leftShoulder","leftHip"],["leftHip","leftKnee"],["leftKnee","leftAnkle"],["nose","rightShoulder"],["rightShoulder","rightElbow"],["rightElbow","rightWrist"],["rightShoulder","rightHip"],["rightHip","rightKnee"],["rightKnee","rightAnkle"]].map(function(r){var e=r[0],t=r[1];return[jy[e],jy[t]]}),cb=w4.map(function(r){return r[1]}),YE=w4.map(function(r){return r[0]});function hb(r,e,t,n){return{y:XE(Math.round(r.y/e),0,t-1),x:XE(Math.round(r.x/e),0,n-1)}}function ZE(r,e,t,n,s,o,a,i){i===void 0&&(i=2);for(var l=n.shape,u=l[0],h=l[1],d=function(v,b,w){var _=w.shape[2]/2;return{y:w.get(b.y,b.x,v),x:w.get(b.y,b.x,_+v)}}(r,hb(e.position,o,u,h),a),c=KE(e.position,d),f=0;f<i;f++){var p=hb(c,o,u,h),m=m4(p.y,p.x,t,s);c=KE({x:p.x*o,y:p.y*o},{x:m.x,y:m.y})}var g=hb(c,o,u,h),y=n.get(g.y,g.x,t);return{position:c,part:V1[t],score:y}}function vTe(r,e,t,n,s,o){var a=e.shape[2],i=cb.length,l=new Array(a),u=r.part,h=r.score,d=g4(u,n,t);l[u.id]={score:h,part:V1[u.id],position:d};for(var c=i-1;c>=0;--c){var f=cb[c],p=YE[c];l[f]&&!l[p]&&(l[p]=ZE(c,l[f],p,e,t,n,o))}for(c=0;c<i;++c)f=YE[c],p=cb[c],l[f]&&!l[p]&&(l[p]=ZE(c,l[f],p,e,t,n,s));return l}function S4(r,e,t,n){var s=t.x,o=t.y;return r.some(function(a){var i,l,u,h,d,c,f=a.keypoints[n].position;return i=o,l=s,u=f.y,h=f.x,(d=u-i)*d+(c=h-l)*c<=e})}function bTe(r,e,t){var n=t.reduce(function(s,o,a){var i=o.position,l=o.score;return S4(r,e,i,a)||(s+=l),s},0);return n/t.length}function Og(r,e,t,n,s,o,a,i){a===void 0&&(a=.5),i===void 0&&(i=20);for(var l=[],u=function(p,m,g){for(var y=g.shape,v=y[0],b=y[1],w=y[2],_=new gTe(v*b*w,function(D){return D.score}),I=0;I<v;++I)for(var C=0;C<b;++C)for(var N=0;N<w;++N){var O=g.get(I,C,N);O<p||yTe(N,O,I,C,m,g)&&_.enqueue({score:O,part:{heatmapY:I,heatmapX:C,id:N}})}return _}(a,1,r),h=i*i;l.length<o&&!u.empty();){var d=u.dequeue();if(!S4(l,h,g4(d.part,s,e),d.part.id)){var c=vTe(d,r,e,s,t,n),f=bTe(l,h,c);l.push({keypoints:c,score:f})}}return l}var of,xTe=[-123.15,-115.9,-103.06],wTe=function(r){function e(){return r!==null&&r.apply(this,arguments)||this}return c4(e,r),e.prototype.preprocessInput=function(t){return xn(t,xTe)},e.prototype.nameOutputResults=function(t){var n=t[0],s=t[1],o=t[2],a=t[3],i=t[4],l=t[5];return{offsets:i,segmentation:t[6],partHeatmaps:l,longOffsets:a,heatmap:o,displacementFwd:s,displacementBwd:n,partOffsets:t[7]}},e}(p4),QE="https://storage.googleapis.com/tfjs-models/savedmodel/bodypix/resnet50/",JE="https://storage.googleapis.com/tfjs-models/savedmodel/bodypix/mobilenet/";function bf(r){if(typeof HTMLCanvasElement!="undefined"&&r instanceof HTMLCanvasElement||typeof OffscreenCanvas!="undefined"&&r instanceof OffscreenCanvas||typeof HTMLImageElement!="undefined"&&r instanceof HTMLImageElement)return function(e){if("offsetHeight"in e&&e.offsetHeight!==0&&"offsetWidth"in e&&e.offsetWidth!==0)return[e.offsetHeight,e.offsetWidth];if(e.height!=null&&e.width!=null)return[e.height,e.width];throw new Error("HTMLImageElement must have height and width attributes set.")}(r);if(typeof ImageData!="undefined"&&r instanceof ImageData)return[r.height,r.width];if(typeof HTMLVideoElement!="undefined"&&r instanceof HTMLVideoElement)return function(e){return e.hasAttribute("height")&&e.hasAttribute("width")?[e.height,e.width]:[e.videoHeight,e.videoWidth]}(r);if(r instanceof pr)return[r.shape[0],r.shape[1]];throw new Error("error: Unknown input type: "+r+".")}function eC(r,e){return function(t,n){return(t-1)%n==0}(r,e)?r:Math.floor(r/e)*e+1}var xf={low:"low",medium:"medium",high:"high",full:"full"},STe=((of={})[xf.low]=.25,of[xf.medium]=.5,of[xf.high]=.75,of[xf.full]=1,of);function Mg(r,e,t){var n=t[0],s=t[1],o=function(a){if(typeof a=="string"){var i=STe[a];return Te(typeof i=="number",function(){return"string value of inputResolution must be one of "+Object.values(xf).join(",")+" but was "+a+"."}),i}return Te(typeof a=="number"&&a<=2&&a>=.1,function(){return"inputResolution must be a string or number between 0.1 and 2, but was "+a}),a}(r);return[eC(n*o,e),eC(s*o,e)]}function Ch(r,e,t,n,s){var o=e[0],a=e[1],i=t[0],l=t[1],u=n[0],h=u[0],d=u[1],c=n[1],f=c[0],p=c[1];return s===void 0&&(s=!1),Vt(function(){var m=wo.resizeBilinear(r,[i,l],!0);return s&&(m=zi(m)),function(g,y,v){var b=y[0],w=y[1],_=v[0],I=_[0],C=_[1],N=v[1],O=N[0],D=N[1];return Vt(function(){var M=Rs(g);return cs(wo.cropAndResize(M,[[I/(b+I+C-1),O/(w+O+D-1),(I+b-1)/(b+I+C-1),(O+w-1)/(w+O+D-1)]],[0],[b,w]),[0])})}(m,[o,a],[[h,d],[f,p]])})}function Fg(r,e){var t=e[0],n=e[1],s=bf(r),o=s[0],a=s[1],i=n/t,l=[0,0,0,0],u=l[0],h=l[1],d=l[2],c=l[3];a/o<i?(u=0,h=0,d=Math.round(.5*(i*o-a)),c=Math.round(.5*(i*o-a))):(u=Math.round(.5*(1/i*a-o)),h=Math.round(.5*(1/i*a-o)),d=0,c=0);var f=Vt(function(){var p=function(m){return m instanceof pr?m:Sm(m)}(r);return p=v_(p,[[u,h],[d,c],[0,0]]),wo.resizeBilinear(p,[t,n])});return{resized:f,padding:{top:u,left:d,right:c,bottom:h}}}function Lg(r){return vr(this,void 0,void 0,function(){return br(this,function(e){return[2,Promise.all(r.map(function(t){return t.buffer()}))]})})}function Pg(r,e,t,n,s){var o=e[0],a=e[1],i=t[0],l=t[1],u=function(h,d,c,f,p){return f===void 0&&(f=0),p===void 0&&(p=0),c===1&&d===1&&f===0&&p===0?h:h.map(function(m){return function(g,y,v,b,w){return b===void 0&&(b=0),w===void 0&&(w=0),{score:g.score,keypoints:g.keypoints.map(function(_){var I=_.score,C=_.part,N=_.position;return{score:I,part:C,position:{x:N.x*v+w,y:N.y*y+b}}})}}(m,d,c,f,p)})}(r,(o+n.top+n.bottom)/i,(a+n.left+n.right)/l,-n.top,-n.left);return s?function(h,d){return d<=0?h:h.map(function(c){return function(f,p){return{score:f.score,keypoints:f.keypoints.map(function(m){var g=m.score,y=m.part,v=m.position;return{score:g,part:y,position:{x:p-1-v.x,y:v.y}}})}}(c,d)})}(u,a):u}var tC={architecture:"MobileNetV1",outputStride:16,quantBytes:4,multiplier:.75},nC=["MobileNetV1","ResNet50"],rC={MobileNetV1:[8,16,32],ResNet50:[32,16]},sC={MobileNetV1:[.5,.75,1],ResNet50:[1]},oC=[1,2,4],jg={flipHorizontal:!1,internalResolution:"medium",segmentationThreshold:.7,maxDetections:10,scoreThreshold:.4,nmsRadius:20},Bg={flipHorizontal:!1,internalResolution:"medium",segmentationThreshold:.7,maxDetections:10,scoreThreshold:.4,nmsRadius:20,minKeypointScore:.3,refineSteps:10};function iC(r){var e=r.segmentationThreshold,t=r.maxDetections,n=r.scoreThreshold,s=r.nmsRadius;if(e<0||e>1)throw new Error("segmentationThreshold "+e+". Should be in range [0.0, 1.0]");if(t<=0)throw new Error("Invalid maxDetections "+t+". Should be > 0");if(n<0||n>1)throw new Error("Invalid scoreThreshold "+n+". Should be in range [0.0, 1.0]");if(s<=0)throw new Error("Invalid nmsRadius "+s+".")}function aC(r){var e=r.segmentationThreshold,t=r.maxDetections,n=r.scoreThreshold,s=r.nmsRadius,o=r.minKeypointScore,a=r.refineSteps;if(e<0||e>1)throw new Error("segmentationThreshold "+e+". Should be in range [0.0, 1.0]");if(t<=0)throw new Error("Invalid maxDetections "+t+". Should be > 0");if(n<0||n>1)throw new Error("Invalid scoreThreshold "+n+". Should be in range [0.0, 1.0]");if(s<=0)throw new Error("Invalid nmsRadius "+s+".");if(o<0||o>1)throw new Error("Invalid minKeypointScore "+o+".Should be in range [0.0, 1.0]");if(a<=0||a>20)throw new Error("Invalid refineSteps "+a+".Should be in range [1, 20]")}var _4=function(){function r(e){this.baseModel=e}return r.prototype.predictForPersonSegmentation=function(e){var t=this.baseModel.predict(e);return{segmentLogits:t.segmentation,heatmapScores:t.heatmapScores,offsets:t.offsets,displacementFwd:t.displacementFwd,displacementBwd:t.displacementBwd}},r.prototype.predictForPersonSegmentationAndPart=function(e){var t=this.baseModel.predict(e);return{segmentLogits:t.segmentation,partHeatmapLogits:t.partHeatmaps,heatmapScores:t.heatmapScores,offsets:t.offsets,displacementFwd:t.displacementFwd,displacementBwd:t.displacementBwd}},r.prototype.predictForMultiPersonInstanceSegmentationAndPart=function(e){var t=this.baseModel.predict(e);return{segmentLogits:t.segmentation,longOffsets:t.longOffsets,heatmapScores:t.heatmapScores,offsets:t.offsets,displacementFwd:t.displacementFwd,displacementBwd:t.displacementBwd,partHeatmaps:t.partHeatmaps}},r.prototype.segmentPersonActivation=function(e,t,n){var s=this;n===void 0&&(n=.5);var o=bf(e),a=o[0],i=o[1],l=Mg(t,this.baseModel.outputStride,[a,i]),u=Fg(e,l),h=u.resized,d=u.padding,c=Vt(function(){var v=s.predictForPersonSegmentation(h),b=v.segmentLogits,w=v.heatmapScores,_=v.offsets,I=v.displacementFwd,C=v.displacementBwd,N=h.shape,O=N[0],D=N[1],M=Ch(b,[a,i],[O,D],[[d.top,d.bottom],[d.left,d.right]],!0);return{segmentation:Dg(cs(M),n),heatmapScores:w,offsets:_,displacementFwd:I,displacementBwd:C}}),f=c.segmentation,p=c.heatmapScores,m=c.offsets,g=c.displacementFwd,y=c.displacementBwd;return h.dispose(),{segmentation:f,heatmapScores:p,offsets:m,displacementFwd:g,displacementBwd:y,padding:d,internalResolutionHeightAndWidth:l}},r.prototype.segmentPerson=function(e,t){return t===void 0&&(t=jg),vr(this,void 0,void 0,function(){var n,s,o,a,i,l,u,h,d,c,f,p,m,g,y,v,b,w;return br(this,function(_){switch(_.label){case 0:return iC(t=eo(eo({},jg),t)),n=this.segmentPersonActivation(e,t.internalResolution,t.segmentationThreshold),s=n.segmentation,o=n.heatmapScores,a=n.offsets,i=n.displacementFwd,l=n.displacementBwd,u=n.padding,h=n.internalResolutionHeightAndWidth,d=s.shape,c=d[0],f=d[1],[4,s.data()];case 1:return p=_.sent(),s.dispose(),[4,Lg([o,a,i,l])];case 2:return m=_.sent(),g=m[0],y=m[1],v=m[2],b=m[3],w=Pg(w=Og(g,y,v,b,this.baseModel.outputStride,t.maxDetections,t.scoreThreshold,t.nmsRadius),[c,f],h,u,!1),o.dispose(),a.dispose(),i.dispose(),l.dispose(),[2,{height:c,width:f,data:p,allPoses:w}]}})})},r.prototype.segmentMultiPerson=function(e,t){return t===void 0&&(t=Bg),vr(this,void 0,void 0,function(){var n,s,o,a,i,l,u,h,d,c,f,p,m,g,y,v,b,w,_,I,C,N=this;return br(this,function(O){switch(O.label){case 0:return aC(t=eo(eo({},Bg),t)),n=bf(e),s=n[0],o=n[1],a=Mg(t.internalResolution,this.baseModel.outputStride,[s,o]),i=Fg(e,a),l=i.resized,u=i.padding,h=Vt(function(){var D,M=N.predictForMultiPersonInstanceSegmentationAndPart(l),P=M.segmentLogits,F=M.longOffsets,B=M.heatmapScores,z=M.offsets,Z=M.displacementFwd,Q=M.displacementBwd,K=Ch(P,[s,o],a,[[u.top,u.bottom],[u.left,u.right]],!0);return D=F,{segmentation:Dg(cs(K),t.segmentationThreshold),longOffsets:D,heatmapScoresRaw:B,offsetsRaw:z,displacementFwdRaw:Z,displacementBwdRaw:Q}}),d=h.segmentation,c=h.longOffsets,f=h.heatmapScoresRaw,p=h.offsetsRaw,m=h.displacementFwdRaw,g=h.displacementBwdRaw,[4,Lg([f,p,m,g])];case 1:return y=O.sent(),v=y[0],b=y[1],w=y[2],_=y[3],I=Pg(I=Og(v,b,w,_,this.baseModel.outputStride,t.maxDetections,t.scoreThreshold,t.nmsRadius),[s,o],a,u,!1),[4,pTe(d,c,I,s,o,this.baseModel.outputStride,a,u,t.scoreThreshold,t.refineSteps,t.minKeypointScore,t.maxDetections)];case 2:return C=O.sent(),l.dispose(),d.dispose(),c.dispose(),f.dispose(),p.dispose(),m.dispose(),g.dispose(),[2,C]}})})},r.prototype.segmentPersonPartsActivation=function(e,t,n){var s=this;n===void 0&&(n=.5);var o=bf(e),a=o[0],i=o[1],l=Mg(t,this.baseModel.outputStride,[a,i]),u=Fg(e,l),h=u.resized,d=u.padding,c=Vt(function(){var v=s.predictForPersonSegmentationAndPart(h),b=v.segmentLogits,w=v.partHeatmapLogits,_=v.heatmapScores,I=v.offsets,C=v.displacementFwd,N=v.displacementBwd,O=h.shape,D=O[0],M=O[1],P=Ch(b,[a,i],[D,M],[[d.top,d.bottom],[d.left,d.right]],!0),F=Ch(w,[a,i],[D,M],[[d.top,d.bottom],[d.left,d.right]],!0);return{partSegmentation:cTe(Dg(cs(P),n),F),heatmapScores:_,offsets:I,displacementFwd:C,displacementBwd:N}}),f=c.partSegmentation,p=c.heatmapScores,m=c.offsets,g=c.displacementFwd,y=c.displacementBwd;return h.dispose(),{partSegmentation:f,heatmapScores:p,offsets:m,displacementFwd:g,displacementBwd:y,padding:d,internalResolutionHeightAndWidth:l}},r.prototype.segmentPersonParts=function(e,t){return t===void 0&&(t=jg),vr(this,void 0,void 0,function(){var n,s,o,a,i,l,u,h,d,c,f,p,m,g,y,v,b,w;return br(this,function(_){switch(_.label){case 0:return iC(t=eo(eo({},jg),t)),n=this.segmentPersonPartsActivation(e,t.internalResolution,t.segmentationThreshold),s=n.partSegmentation,o=n.heatmapScores,a=n.offsets,i=n.displacementFwd,l=n.displacementBwd,u=n.padding,h=n.internalResolutionHeightAndWidth,d=s.shape,c=d[0],f=d[1],[4,s.data()];case 1:return p=_.sent(),s.dispose(),[4,Lg([o,a,i,l])];case 2:return m=_.sent(),g=m[0],y=m[1],v=m[2],b=m[3],w=Pg(w=Og(g,y,v,b,this.baseModel.outputStride,t.maxDetections,t.scoreThreshold,t.nmsRadius),[c,f],h,u,!1),o.dispose(),a.dispose(),i.dispose(),l.dispose(),[2,{height:c,width:f,data:p,allPoses:w}]}})})},r.prototype.segmentMultiPersonParts=function(e,t){return t===void 0&&(t=Bg),vr(this,void 0,void 0,function(){var n,s,o,a,i,l,u,h,d,c,f,p,m,g,y,v,b,w,_,I,C,N,O=this;return br(this,function(D){switch(D.label){case 0:return aC(t=eo(eo({},Bg),t)),n=bf(e),s=n[0],o=n[1],a=Mg(t.internalResolution,this.baseModel.outputStride,[s,o]),i=Fg(e,a),l=i.resized,u=i.padding,h=Vt(function(){var M=O.predictForMultiPersonInstanceSegmentationAndPart(l),P=M.segmentLogits,F=M.longOffsets,B=M.heatmapScores,z=M.offsets,Z=M.displacementFwd,Q=M.displacementBwd,K=M.partHeatmaps,ne=Ch(P,[s,o],a,[[u.top,u.bottom],[u.left,u.right]],!0),re=Ch(K,[s,o],a,[[u.top,u.bottom],[u.left,u.right]],!0),ce=F,be=Dg(cs(ne),t.segmentationThreshold),we=function(ye){var Oe=ye.shape,Se=Oe[0],Ee=Oe[1],j=Oe[2];return Vt(function(){var W=f4(ye),J=Rs(nl(0,j,1,"int32"),1),ie=zn(or(W,J),"int32");return bt(ie,[Se,Ee])})}(re);return{segmentation:be,longOffsets:ce,heatmapScoresRaw:B,offsetsRaw:z,displacementFwdRaw:Z,displacementBwdRaw:Q,partSegmentation:we}}),d=h.segmentation,c=h.longOffsets,f=h.heatmapScoresRaw,p=h.offsetsRaw,m=h.displacementFwdRaw,g=h.displacementBwdRaw,y=h.partSegmentation,[4,Lg([f,p,m,g])];case 1:return v=D.sent(),b=v[0],w=v[1],_=v[2],I=v[3],C=Pg(C=Og(b,w,_,I,this.baseModel.outputStride,t.maxDetections,t.scoreThreshold,t.nmsRadius),[s,o],a,u,!1),[4,mTe(d,c,y,C,s,o,this.baseModel.outputStride,a,u,t.scoreThreshold,t.refineSteps,t.minKeypointScore,t.maxDetections)];case 2:return N=D.sent(),l.dispose(),d.dispose(),c.dispose(),f.dispose(),p.dispose(),m.dispose(),g.dispose(),y.dispose(),[2,N]}})})},r.prototype.dispose=function(){this.baseModel.dispose()},r}();function _Te(r){return vr(this,void 0,void 0,function(){var e,t,n,s,o,a;return br(this,function(i){switch(i.label){case 0:if(e=r.outputStride,t=r.quantBytes,n=r.multiplier,B1==null)throw new Error(`Cannot find TensorFlow.js. If you are using a <script> tag, please also include @tensorflow/tfjs on the page before using this
        model.`);return s=function(l,u,h){var d={1:"100",.75:"075",.5:"050"},c="model-stride"+l+".json";return h===4?JE+"float/"+d[u]+"/"+c:JE+"quant"+h+"/"+d[u]+"/"+c}(e,n,t),[4,Nm(r.modelUrl||s)];case 1:return o=i.sent(),a=new hTe(o,e),[2,new _4(a)]}})})}function TTe(r){return vr(this,void 0,void 0,function(){var e,t,n,s,o;return br(this,function(a){switch(a.label){case 0:if(e=r.outputStride,t=r.quantBytes,B1==null)throw new Error(`Cannot find TensorFlow.js. If you are using a <script> tag, please also include @tensorflow/tfjs on the page before using this
        model.`);return n=function(i,l){var u="model-stride"+i+".json";return l===4?QE+"float/"+u:QE+"quant"+l+"/"+u}(e,t),[4,Nm(r.modelUrl||n)];case 1:return s=a.sent(),o=new wTe(s,e),[2,new _4(o)]}})})}function kTe(r){return r===void 0&&(r=tC),vr(this,void 0,void 0,function(){return br(this,function(e){return(r=function(t){if((t=t||tC).architecture==null&&(t.architecture="MobileNetV1"),nC.indexOf(t.architecture)<0)throw new Error("Invalid architecture "+t.architecture+". Should be one of "+nC);if(t.outputStride==null&&(t.outputStride=16),rC[t.architecture].indexOf(t.outputStride)<0)throw new Error("Invalid outputStride "+t.outputStride+". Should be one of "+rC[t.architecture]+" for architecture "+t.architecture+".");if(t.multiplier==null&&(t.multiplier=1),sC[t.architecture].indexOf(t.multiplier)<0)throw new Error("Invalid multiplier "+t.multiplier+". Should be one of "+sC[t.architecture]+" for architecture "+t.architecture+".");if(t.quantBytes==null&&(t.quantBytes=4),oC.indexOf(t.quantBytes)<0)throw new Error("Invalid quantBytes "+t.quantBytes+". Should be one of "+oC+" for architecture "+t.architecture+".");return t}(r)).architecture==="ResNet50"?[2,TTe(r)]:r.architecture==="MobileNetV1"?[2,_Te(r)]:[2,null]})})}var Lx=["left_face","right_face","left_upper_arm_front","left_upper_arm_back","right_upper_arm_front","right_upper_arm_back","left_lower_arm_front","left_lower_arm_back","right_lower_arm_front","right_lower_arm_back","left_hand","right_hand","torso_front","torso_back","left_upper_leg_front","left_upper_leg_back","right_upper_leg_front","right_upper_leg_back","left_lower_leg_front","left_lower_leg_back","right_lower_leg_front","right_lower_leg_back","left_feet","right_feet"],lC=function(){function r(e){this.mask=e}return r.prototype.toCanvasImageSource=function(){return vr(this,void 0,void 0,function(){return br(this,function(e){return[2,L_(this.mask)]})})},r.prototype.toImageData=function(){return vr(this,void 0,void 0,function(){return br(this,function(e){return[2,this.mask]})})},r.prototype.toTensor=function(){return vr(this,void 0,void 0,function(){return br(this,function(e){return[2,d4(this.mask)]})})},r.prototype.getUnderlyingType=function(){return"imagedata"},r}();function ITe(r){if(z1(r),r!==255)throw new Error("Foreground id must be 255 but got "+r);return"person"}function ETe(r){if(z1(r),r>=Lx.length)throw new Error("Invalid body part value "+r);return Lx[r]}var CTe=function(){function r(e){this.bodyPixModel=e}return r.prototype.segmentPeople=function(e,t){return vr(this,void 0,void 0,function(){var n,s,o,a;return br(this,function(i){switch(i.label){case 0:return e instanceof ImageBitmap&&((n=document.createElement("canvas")).getContext("2d").drawImage(e,0,0),e=n),t.segmentBodyParts?t.multiSegmentation?[4,this.bodyPixModel.segmentMultiPersonParts(e,t)]:[3,2]:[3,5];case 1:return o=i.sent(),[3,4];case 2:return[4,this.bodyPixModel.segmentPersonParts(e,t)];case 3:o=[i.sent()],i.label=4;case 4:return s=o.map(function(l){var u=l.data,h=l.width,d=l.height,c=new Uint8ClampedArray(h*d*4).fill(0);return u.forEach(function(f,p){f===-1?(c[4*p]=Lx.length,c[4*p+3]=0):(c[4*p]=f,c[4*p+3]=255)}),{maskValueToLabel:ETe,mask:new lC(new ImageData(c,h,d))}}),[3,10];case 5:return t.multiSegmentation?[4,this.bodyPixModel.segmentMultiPerson(e,t)]:[3,7];case 6:return a=i.sent(),[3,9];case 7:return[4,this.bodyPixModel.segmentPerson(e,t)];case 8:a=[i.sent()],i.label=9;case 9:s=a.map(function(l){var u=l.data,h=l.width,d=l.height,c=new Uint8ClampedArray(h*d*4).fill(0);return u.forEach(function(f,p){f===0?(c[4*p]=0,c[4*p+3]=0):(c[4*p]=255,c[4*p+3]=255)}),{maskValueToLabel:ITe,mask:new lC(new ImageData(c,h,d))}}),i.label=10;case 10:return[2,s]}})})},r.prototype.dispose=function(){this.bodyPixModel.dispose()},r.prototype.reset=function(){},r}();function $Te(r){return vr(this,void 0,void 0,function(){return br(this,function(e){return[2,kTe(r).then(function(t){return new CTe(t)})]})})}var uC={runtime:"mediapipe",modelType:"general"},NTe=function(){function r(e){this.mask=e}return r.prototype.toCanvasImageSource=function(){return vr(this,void 0,void 0,function(){return br(this,function(e){return[2,this.mask]})})},r.prototype.toImageData=function(){return vr(this,void 0,void 0,function(){return br(this,function(e){return[2,h4(this.mask)]})})},r.prototype.toTensor=function(){return vr(this,void 0,void 0,function(){return br(this,function(e){return[2,d4(this.mask)]})})},r.prototype.getUnderlyingType=function(){return"canvasimagesource"},r}();function ATe(r){return z1(r),"person"}var RTe=function(){function r(e){var t,n=this;this.selfieMode=!1,this.selfieSegmentationSolution=new u4.SelfieSegmentation({locateFile:function(s,o){return e.solutionPath?e.solutionPath.replace(/\/+$/,"")+"/"+s:o+"/"+s}}),e.modelType==="landscape"?t=1:t=0,this.selfieSegmentationSolution.setOptions({modelSelection:t,selfieMode:this.selfieMode}),this.selfieSegmentationSolution.onResults(function(s){n.segmentation=[{maskValueToLabel:ATe,mask:new NTe(s.segmentationMask)}]})}return r.prototype.segmentPeople=function(e,t){return vr(this,void 0,void 0,function(){var n,s;return br(this,function(o){switch(o.label){case 0:return t&&t.flipHorizontal&&t.flipHorizontal!==this.selfieMode&&(this.selfieMode=t.flipHorizontal,this.selfieSegmentationSolution.setOptions({selfieMode:this.selfieMode})),e instanceof pr?(s=ImageData.bind,[4,S1(e)]):[3,2];case 1:return n=new(s.apply(ImageData,[void 0,o.sent(),e.shape[1],e.shape[0]])),[3,3];case 2:n=e,o.label=3;case 3:return e=n,[4,this.selfieSegmentationSolution.send({image:e})];case 4:return o.sent(),[2,this.segmentation]}})})},r.prototype.dispose=function(){this.selfieSegmentationSolution.close()},r.prototype.reset=function(){this.selfieSegmentationSolution.reset(),this.segmentation=null,this.selfieMode=!1},r.prototype.initialize=function(){return this.selfieSegmentationSolution.initialize()},r}();function DTe(r){return vr(this,void 0,void 0,function(){var e,t;return br(this,function(n){switch(n.label){case 0:return e=function(s){if(s==null)return eo({},uC);var o=eo({},s);return o.runtime="mediapipe",o.modelType==null&&(o.modelType=uC.modelType),o}(r),[4,(t=new RTe(e)).initialize()];case 1:return n.sent(),[2,t]}})})}function OTe(r,e,t,n){var s=r.width,o=r.height,a=n?-1:1,i=Math.cos(r.rotation),l=Math.sin(r.rotation),u=r.xCenter,h=r.yCenter,d=1/e,c=1/t,f=new Array(16);return f[0]=s*i*a*d,f[1]=-o*l*d,f[2]=0,f[3]=(-.5*s*i*a+.5*o*l+u)*d,f[4]=s*l*a*c,f[5]=o*i*c,f[6]=0,f[7]=(-.5*o*i-.5*s*l*a+h)*c,f[8]=0,f[9]=0,f[10]=s*d,f[11]=0,f[12]=0,f[13]=0,f[14]=0,f[15]=1,function(p){if(p.length!==16)throw new Error("Array length must be 16 but got "+p.length);return[[p[0],p[1],p[2],p[3]],[p[4],p[5],p[6],p[7]],[p[8],p[9],p[10],p[11]],[p[12],p[13],p[14],p[15]]]}(f)}function T4(r){return r instanceof pr?{height:r.shape[0],width:r.shape[1]}:{height:r.height,width:r.width}}function db(r,e){Te(r.width!==0,function(){return e+" width cannot be 0."}),Te(r.height!==0,function(){return e+" height cannot be 0."})}function MTe(r,e){var t=function(n,s,o,a){var i=s-n,l=a-o;if(i===0)throw new Error("Original min and max are both "+n+", range cannot be 0.");var u=l/i;return{scale:u,offset:o-n*u}}(0,255,e[0],e[1]);return Vt(function(){return xn(Ut(r,t.scale),t.offset)})}function FTe(r,e,t){var n=e.outputTensorSize,s=e.keepAspectRatio,o=e.borderMode,a=e.outputTensorFloatRange,i=T4(r),l=function(c,f){return f?{xCenter:f.xCenter*c.width,yCenter:f.yCenter*c.height,width:f.width*c.width,height:f.height*c.height,rotation:f.rotation}:{xCenter:.5*c.width,yCenter:.5*c.height,width:c.width,height:c.height,rotation:0}}(i,t),u=function(c,f,p){if(p===void 0&&(p=!1),!p)return{top:0,left:0,right:0,bottom:0};var m=f.height,g=f.width;db(f,"targetSize"),db(c,"roi");var y,v,b=m/g,w=c.height/c.width,_=0,I=0;return b>w?(y=c.width,v=c.width*b,I=(1-w/b)/2):(y=c.height/b,v=c.height,_=(1-b/w)/2),c.width=y,c.height=v,{top:I,left:_,right:_,bottom:I}}(l,n,s),h=OTe(l,i.width,i.height,!1),d=Vt(function(){var c,f=(c=r)instanceof pr?c:Sm(c),p=qh(function(y,v,b){return db(b,"inputResolution"),[1/b.width*y[0][0]*v.width,1/b.height*y[0][1]*v.width,y[0][3]*v.width,1/b.width*y[1][0]*v.height,1/b.height*y[1][1]*v.height,y[1][3]*v.height,0,0]}(h,i,n),[1,8]),m=o==="zero"?"constant":"nearest",g=wo.transform(Rs(zn(f,"float32")),p,"bilinear",m,0,[n.height,n.width]);return a!=null?MTe(g,a):g});return{imageTensor:d,padding:u,transformationMatrix:h}}function LTe(r,e,t){return Vt(function(){var n=cs(r,[0]),s=n.shape[2];if(s===1){var o=n;switch(e.activation){case"none":break;case"sigmoid":o=zi(o);break;case"softmax":throw new Error("Softmax activation requires two channels.");default:throw new Error("Activation not supported ("+e.activation+")")}var a=t?wo.resizeBilinear(o,[t.height,t.width]):o;return cs(a,[2])}throw new Error("Unsupported number of tensor channels "+s)})}var cC={runtime:"tfjs",modelType:"general",modelUrl:"https://tfhub.dev/mediapipe/tfjs-model/selfie_segmentation/general/1"},hC={flipHorizontal:!1},PTe={outputTensorSize:{width:256,height:256},keepAspectRatio:!1,borderMode:"zero",outputTensorFloatRange:[0,1]},jTe={outputTensorSize:{width:256,height:144},keepAspectRatio:!1,borderMode:"zero",outputTensorFloatRange:[0,1]},BTe={activation:"none"},UTe=function(){function r(e){this.mask=e}return r.prototype.toCanvasImageSource=function(){return vr(this,void 0,void 0,function(){return br(this,function(e){return[2,L_(this.mask)]})})},r.prototype.toImageData=function(){return vr(this,void 0,void 0,function(){return br(this,function(e){return[2,h4(this.mask)]})})},r.prototype.toTensor=function(){return vr(this,void 0,void 0,function(){return br(this,function(e){return[2,this.mask]})})},r.prototype.getUnderlyingType=function(){return"tensor"},r}();function zTe(r){return z1(r),"person"}var qf,VTe=function(){function r(e,t){this.modelType=e,this.model=t}return r.prototype.segmentPeople=function(e,t){return vr(this,void 0,void 0,function(){var n,s=this;return br(this,function(o){return t=function(a){if(a==null)return eo({},hC);var i=eo({},a);return i.flipHorizontal==null&&(i.flipHorizontal=hC.flipHorizontal),i}(t),e==null?(this.reset(),[2,[]]):(n=Vt(function(){var a=FTe(e,s.modelType==="general"?PTe:jTe).imageTensor,i=Tr(s.model.predict(a),[0,0,0,1],-1),l=T4(e),u=LTe(i,BTe,l),h=Rs(u,2),d=oh(h,[[0,0],[0,0],[0,1]]);return g_(d,[[0,0],[0,0],[0,2]],"symmetric")}),[2,[{maskValueToLabel:zTe,mask:new UTe(n)}]])})})},r.prototype.dispose=function(){this.model.dispose()},r.prototype.reset=function(){},r}();function GTe(r){return vr(this,void 0,void 0,function(){var e,t,n;return br(this,function(s){switch(s.label){case 0:return e=function(o){if(o==null)return eo({},cC);var a=eo({},o);if(a.runtime="tfjs",a.modelType==null&&(a.modelType=cC.modelType),a.modelType!=="general"&&a.modelType!=="landscape")throw new Error("Model type must be one of general or landscape, but got "+a.modelType);return a.modelUrl==null&&(a.modelType==="general"?a.modelUrl="https://tfhub.dev/mediapipe/tfjs-model/selfie_segmentation/general/1":a.modelUrl="https://tfhub.dev/mediapipe/tfjs-model/selfie_segmentation/landscape/1"),a}(r),t=typeof e.modelUrl=="string"&&e.modelUrl.indexOf("https://tfhub.dev")>-1,[4,Nm(e.modelUrl,{fromTFHub:t})];case 1:return n=s.sent(),[2,new VTe(e.modelType,n)]}})})}function WTe(r,e){return vr(this,void 0,void 0,function(){var t,n;return br(this,function(s){switch(r){case qf.MediaPipeSelfieSegmentation:if(t=void 0,(n=e)!=null){if(n.runtime==="tfjs")return[2,GTe(n)];if(n.runtime==="mediapipe")return[2,DTe(n)];t=n.runtime}throw new Error("Expect modelConfig.runtime to be either 'tfjs' or 'mediapipe', but got "+t);case qf.BodyPix:return[2,$Te(n=e)];default:throw new Error(r+" is not a supported model name.")}})})}(function(r){r.BodyPix="BodyPix",r.MediaPipeSelfieSegmentation="MediaPipeSelfieSegmentation"})(qf||(qf={}));function HTe(r,e,t,n,s,o){o===void 0&&(o={r:0,g:255,b:255,a:255});for(var a=-s;a<=s;a++)for(var i=-s;i<=s;i++)if(a!==0&&i!==0){var l=(e+a)*n+(t+i);r[4*l+0]=o.r,r[4*l+1]=o.g,r[4*l+2]=o.b,r[4*l+3]=o.a}}function qTe(r,e,t,n,s,o,a){a===void 0&&(a=1);for(var i=0,l=-a;l<=a;l++)for(var u=-a;u<=a;u++)if(l!==0&&u!==0){var h=(e+l)*n+(t+u);(!s[r[4*h]]||r[4*h+3]<o)&&(i+=1)}return i>0}function XTe(r,e,t,n,s,o){return e===void 0&&(e={r:0,g:0,b:0,a:0}),t===void 0&&(t={r:0,g:0,b:0,a:255}),n===void 0&&(n=!1),s===void 0&&(s=.5),o===void 0&&(o=Array.from(Array(256).keys())),vr(this,void 0,void 0,function(){var a,i,l,u,h,d,c,f,p,m,g,y,v,b;return br(this,function(w){switch(w.label){case 0:return(a=Array.isArray(r)?r:[r]).length===0?[2,null]:[4,Promise.all(a.map(function(_){return _.mask.toImageData()}))];case 1:for(i=w.sent(),l=i[0],u=l.width,h=l.height,d=new Uint8ClampedArray(u*h*4),c=Math.round(255*s),f=new Array(256).fill(!1),o.forEach(function(_){return f[_]=!0}),p=0;p<h;p++)for(m=0;m<u;m++)for(d[4*(g=p*u+m)+0]=t.r,d[4*g+1]=t.g,d[4*g+2]=t.b,d[4*g+3]=t.a,y=0,v=i;y<v.length;y++)b=v[y],f[b.data[4*g]]&&b.data[4*g+3]>=c&&(d[4*g]=e.r,d[4*g+1]=e.g,d[4*g+2]=e.b,d[4*g+3]=e.a,n&&p-1>=0&&p+1<h&&m-1>=0&&m+1<u&&qTe(b.data,p,m,u,f,c)&&HTe(d,p,m,u,1));return[2,new ImageData(d,u,h)]}})})}const KTe=qf.MediaPipeSelfieSegmentation,YTe={type:"general",visualization:"binaryMask"},ZTe=WTe(KTe,{runtime:"mediapipe",modelType:YTe.type,solutionPath:`https://cdn.jsdelivr.net/npm/@mediapipe/selfie_segmentation@${u4.VERSION}`}),QTe=async()=>ZTe;async function dC(r,e){return r.segmentPeople(e,{flipHorizontal:!1,internalResolution:"low",segmentationThreshold:.5}).then(t=>XTe(t))}class JTe{constructor(){Er(this,"constraints",{audio:!1,video:{facingMode:"user"}});Er(this,"video");Er(this,"stream");Er(this,"video_container");Er(this,"container_style",{position:"absolute",visibility:"hidden",height:"0px",width:"0px",overflow:"hidden"});Er(this,"getVideoTrack",()=>{var e,t;return(t=(e=this.stream)==null?void 0:e.getVideoTracks())==null?void 0:t[0]});Er(this,"getCapabilities",()=>{var e;return(e=this.getVideoTrack())==null?void 0:e.getCapabilities()});Er(this,"getSettings",()=>{var e;return(e=this.getVideoTrack())==null?void 0:e.getSettings()});Er(this,"getMaxDimensionsConstraints",()=>{let e=this.getCapabilities();return{width:e==null?void 0:e.width.max,height:e==null?void 0:e.height.max}});this.start(!0)}constructDivs(){this.video=document.createElement("video"),this.video.playsInline=!0,this.video_container=document.createElement("div"),Object.assign(this.video_container.style,this.container_style),this.video_container.append(this.video),document.body.append(this.video_container)}formatVideoFeed(){return this.video.play()}isStopped(){var e,t,n;return(n=(t=(e=this.stream)==null?void 0:e.getTracks())==null?void 0:t.every(s=>s.readyState==="ended"))!=null?n:!0}start(e=!1){navigator.mediaDevices.getUserMedia(this.constraints).then(t=>{e&&this.constructDivs(),this.stream=t,this.video.srcObject=t,this.video.onloadedmetadata=()=>this.formatVideoFeed()}).catch(t=>alert(t))}stop(){this.stream.getTracks().forEach(e=>e.stop())}play(){this.start()}getScaledDimensions(e){let{width:t,height:n}=this.getSettings();return{width:Math.floor(t*e),height:Math.floor(n*e)}}getVideoElement(){return this.video}}class eke{constructor(e){Er(this,"bp");Er(this,"ss");Er(this,"camera");Er(this,"pixels",[[]]);Er(this,"mask_id");Er(this,"mask_frame");Er(this,"previous_mask_frame");Er(this,"previous_frame");Er(this,"current_frame");Er(this,"processing",!1);Er(this,"pixelation",200);Er(this,"pixelation_min",100);Er(this,"CPI",20);Er(this,"freezeframe",!1);Er(this,"getPixelatedPixels",(e,t)=>{if(this.camera.getVideoElement()&&e>0&&t>0)try{if(this.processing&&this.freezeframe)return this.pixels;this.pixels=this.getFrame(e,t)}catch{this.pixels=[[]]}else this.pixels=[[]];return this.pixels});Er(this,"scale_process",!1);Er(this,"scale",.5);switch(this.setPixelation(),this.camera=new JTe,e){case"body-pix":this.initializeBodyPix();break;case"selfie-segmentation":this.initializeSelfieSegmentation();break}}async initializeBodyPix(){this.bp=await uTe()}async initializeSelfieSegmentation(){this.ss=await QTe()}togglePause(){this.isStopped()?this.play():this.stop()}isStopped(){return this.camera.isStopped()}stop(){this.camera.stop()}play(){this.camera.play()}setPixelation(){let e=window.devicePixelRatio,n=96*e,s=document.body.offsetWidth,o=document.body.offsetHeight,a=Math.max(s,o);this.pixelation=Math.min(Math.floor(a*this.CPI/n),this.pixelation_min)}getFrame(e,t){let n=this.getProcessedVideoCanvas(e,t);return Ck(n)}getCroppedFrame(){try{return this.getCroppedVideoCanvas()}catch{return null}}getProcessedVideoCanvas(e,t){let n=U6(this.camera.getVideoElement(),e,t),s=z6(n,e,t);n=null,this.previous_frame=this.current_frame,this.current_frame=s;let o=s;return this.previous_frame&&(this.bp||this.ss)&&(this.processMask(),o=this.maskCanvas(this.mask_frame)),this.finishProcessing(o)}getCroppedVideoCanvas(){return $k(this.previous_frame)}finishProcessing(e){let t=B6(e,this.pixelation,this.pixelation);return $k(t)}maskCanvas(e){let t=L6(e),n=this.maskImageData(t,this.mask_id);return P6(n)}async processMask(){if(this.processing)return;this.processing=!0,this.mask_frame=this.previous_mask_frame,this.previous_mask_frame=this.current_frame;let e;this.scale_process?(j6(this.current_frame,this.scale),this.bp?e=await qE(this.bp,this.camera.getVideoElement()):this.ss&&(e=await dC(this.ss,this.camera.getVideoElement())),this.mask_id=e):(this.bp?e=await qE(this.bp,this.current_frame):this.ss&&(e=await dC(this.ss,this.current_frame)),this.mask_id=e),this.processing=!1}getMirroredPixels(e){return Ck(e).reverse()}maskImageData(e,t){for(let n=0;n<e.data.length;n+=4){let[s,o,a,i]=[n,n+1,n+2,n+3],l=255-t.data[i];e.data[i]=l}return e}addAlphaToVal(e,t){return Math.floor(e*t)}}const fb='@W\xD1$9806532ba4c7?1=~"-;:,. ',tke=1.5,nke="selfie-segmentation",$h=50,Ug=10,rke=[0,0,0],ske=[255,255,255];let Nh;const oke=r=>{let e,t;document.body.style.backgroundColor="black",r.setup=()=>{r.textStyle(r.BOLD),Nh=new eke(nke);let u=window.innerWidth,h=window.innerHeight;r.createCanvas(u,h)},r.draw=()=>{let[u,h]=[document.body.offsetWidth,document.body.offsetHeight];if(Nh){r.resizeCanvas(u,h),r.clear(0,0,0,255),e=rke,t=ske,r.background(e),r.fill(t);let[d,c]=[u-zg[0]*2,h-zg[1]*2],f=Nh.getPixelatedPixels(d,c),[p,m]=[f.length,f[0].length];{let g=Nh.getCroppedFrame();g&&r.drawingContext.drawImage(g,...s(p,m,d,c))}f[0].length>0&&o(r,f)}n(r),r.resetMatrix()},r.mouseClicked=()=>{r.mouseX<Ug+$h&&r.mouseY<Ug+$h&&Nh.togglePause()};function n(u){u.resetMatrix(),u.translate(Ug,Ug),u.fill(255,255,255),u.rect(0,0,$h,$h),u.fill(0,0,0),u.textSize(32),u.textAlign(u.CENTER,u.CENTER),u.text(Nh.isStopped()?"\u25B6":"\u23F8",$h/2,$h/2)}function s(u,h,d,c){let f=Math.min(d/u,c/h),p=u*f,m=h*f,g=(d-p)/2,y=(c-m)/2;return[g,y,p,m]}function o(u,h){u.resetMatrix();let[d,c]=[h.length,h[0].length],[f,p]=[u.width-zg[0]*2,u.height-zg[1]*2],m=Math.min(f/d,p/c),g=(u.width-m*d)/2,y=(u.height-m*c)/2;for(let v=0;v<d;v++)for(let b=0;b<c;b++){let[w,_,I,C]=h[v][b];if(C>0){u.noStroke();let N=v*m+g-1,O=b*m+y-1;u.fill(e),u.square(N,O,m+2)}}for(let v=0;v<d;v++)for(let b=0;b<c;b++){let[w,_,I,C]=h[v][b];if(C>0){let N=Math.floor((w+_+I)/3);u.noStroke();let O=v*m+g,D=b*m+y;{u.fill(a([w,_,I,C]));let M=tke*m;u.textSize(M),u.textAlign(u.CENTER,u.CENTER);let P=fb.length,F;F=fb.length-Math.floor(N/255*P),u.text(fb[F],O+m*.5,D+m*.5)}}}}function a([u,h,d,c]){return l([u,h,d,c])}function i(u,h){return Math.min(u+h,255)}function l([u,h,d,c]){return[u*.8,i(h,50),d*.8,c]}},j_=document.querySelector("#app");j_.style.width="100%";j_.style.height="100%";const zg=[0,0];new O6(oke,j_).frameRate(30);
